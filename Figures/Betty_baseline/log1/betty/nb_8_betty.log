main start at this time 1688412718.4934723
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
Epoch:  0
REG start----................................
Convert a graph into a bidirected graph: 3.176 seconds, peak memory: 34.176 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.176 GB
Metis partitioning: 13.720 seconds, peak memory: 35.451 GB
Split the graph: 2.280 seconds
Construct subgraphs: 0.014 seconds
REG metis partition end ----................................
connection checking time:  21.096611976623535
block generation total time  20.765708684921265
average batch blocks generation time:  2.595713585615158
----------------------------------------before batch input features to device
 Nvidia-smi: 1.34375 GB
    Memory Allocated: 0.000934600830078125  GigaBytes
Max Memory Allocated: 0.000934600830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.529296875 GB
    Memory Allocated: 0.18469715118408203  GigaBytes
Max Memory Allocated: 0.18469715118408203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.529296875 GB
    Memory Allocated: 0.18488597869873047  GigaBytes
Max Memory Allocated: 0.18488597869873047  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.865234375 GB
    Memory Allocated: 0.2065725326538086  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.865234375 GB
    Memory Allocated: 0.33833742141723633  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.865234375 GB
    Memory Allocated: 0.33852624893188477  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.060546875 GB
    Memory Allocated: 0.16962957382202148  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.060546875 GB
    Memory Allocated: 0.3308596611022949  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.060546875 GB
    Memory Allocated: 0.33104848861694336  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.060546875 GB
    Memory Allocated: 0.21489191055297852  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.060546875 GB
    Memory Allocated: 0.38976383209228516  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.060546875 GB
    Memory Allocated: 0.38994550704956055  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.060546875 GB
    Memory Allocated: 0.24356412887573242  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.060546875 GB
    Memory Allocated: 0.4464402198791504  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.060546875 GB
    Memory Allocated: 0.44661903381347656  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.060546875 GB
    Memory Allocated: 0.2852950096130371  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.060546875 GB
    Memory Allocated: 0.5333766937255859  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.060546875 GB
    Memory Allocated: 0.5335545539855957  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.9609375 GB
    Memory Allocated: 0.3444209098815918  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.9609375 GB
    Memory Allocated: 0.5214724540710449  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.9609375 GB
    Memory Allocated: 0.5216512680053711  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.9609375 GB
    Memory Allocated: 0.2878742218017578  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.9609375 GB
    Memory Allocated: 0.495790958404541  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.9609375 GB
    Memory Allocated: 0.495974063873291  GigaBytes
Max Memory Allocated: 17.775959968566895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13908162713050842 |0.07975995540618896 |0.24463161826133728 |0.00013235211372375488 |0.11791223287582397 |0.010439872741699219 |
----------------------------------------------------------pseudo_mini_loss sum 5.1920084953308105
Epoch:  1
REG start----................................
Convert a graph into a bidirected graph: 3.220 seconds, peak memory: 72.619 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.619 GB
Metis partitioning: 14.781 seconds, peak memory: 73.857 GB
Split the graph: 2.172 seconds
Construct subgraphs: 0.696 seconds
REG metis partition end ----................................
connection checking time:  21.00818681716919
block generation total time  20.3717303276062
average batch blocks generation time:  2.546466290950775
----------------------------------------before batch input features to device
 Nvidia-smi: 20.439453125 GB
    Memory Allocated: 0.23220014572143555  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.439453125 GB
    Memory Allocated: 0.40198183059692383  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.439453125 GB
    Memory Allocated: 0.40216064453125  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.580078125 GB
    Memory Allocated: 0.19335222244262695  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.580078125 GB
    Memory Allocated: 0.36649131774902344  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.580078125 GB
    Memory Allocated: 0.36667919158935547  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.580078125 GB
    Memory Allocated: 0.2142953872680664  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.580078125 GB
    Memory Allocated: 0.38141679763793945  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.580078125 GB
    Memory Allocated: 0.3816051483154297  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.75390625 GB
    Memory Allocated: 0.22237634658813477  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.75390625 GB
    Memory Allocated: 0.353670597076416  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.75390625 GB
    Memory Allocated: 0.35385942459106445  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.798828125 GB
    Memory Allocated: 0.20307540893554688  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.798828125 GB
    Memory Allocated: 0.42296552658081055  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.798828125 GB
    Memory Allocated: 0.4231438636779785  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.873046875 GB
    Memory Allocated: 0.30687856674194336  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.873046875 GB
    Memory Allocated: 0.5290079116821289  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.873046875 GB
    Memory Allocated: 0.5291862487792969  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.873046875 GB
    Memory Allocated: 0.32178497314453125  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.873046875 GB
    Memory Allocated: 0.540255069732666  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.873046875 GB
    Memory Allocated: 0.5404329299926758  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.873046875 GB
    Memory Allocated: 0.3327035903930664  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.873046875 GB
    Memory Allocated: 0.5057954788208008  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.873046875 GB
    Memory Allocated: 0.505983829498291  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.14090856909751892 |0.020804941654205322 |0.15617403388023376 |0.00012254714965820312 |0.111998051404953 |0.006137371063232422 |
----------------------------------------------------------pseudo_mini_loss sum 3.4744491577148438
Epoch:  2
REG start----................................
Convert a graph into a bidirected graph: 3.093 seconds, peak memory: 81.921 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 81.921 GB
Metis partitioning: 14.491 seconds, peak memory: 83.234 GB
Split the graph: 1.892 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
connection checking time:  19.324527978897095
block generation total time  14.129960060119629
average batch blocks generation time:  1.7662450075149536
----------------------------------------before batch input features to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.19750213623046875  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.38263940811157227  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.3828244209289551  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.20952653884887695  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.35545921325683594  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.3556480407714844  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.18603944778442383  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.3528299331665039  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.35300779342651367  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.2234048843383789  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.3968491554260254  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.397036075592041  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.24539947509765625  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.46114301681518555  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.26953125 GB
    Memory Allocated: 0.4613213539123535  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.279296875 GB
    Memory Allocated: 0.30172300338745117  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.279296875 GB
    Memory Allocated: 0.5358743667602539  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.279296875 GB
    Memory Allocated: 0.5360560417175293  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.279296875 GB
    Memory Allocated: 0.33548402786254883  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.279296875 GB
    Memory Allocated: 0.520014762878418  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.279296875 GB
    Memory Allocated: 0.5201940536499023  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.279296875 GB
    Memory Allocated: 0.3004298210144043  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.279296875 GB
    Memory Allocated: 0.49576282501220703  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.279296875 GB
    Memory Allocated: 0.49595117568969727  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.14331501722335815 |0.01953136920928955 |0.15043309330940247 |0.00011450052261352539 |0.11924055218696594 |0.0019571781158447266 |
----------------------------------------------------------pseudo_mini_loss sum 2.7284514904022217
Epoch:  3
REG start----................................
Convert a graph into a bidirected graph: 3.289 seconds, peak memory: 84.366 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.366 GB
Metis partitioning: 14.729 seconds, peak memory: 84.366 GB
Split the graph: 2.360 seconds
Construct subgraphs: 0.034 seconds
REG metis partition end ----................................
connection checking time:  21.433260202407837
block generation total time  21.32156538963318
average batch blocks generation time:  2.6651956737041473
block dataloader generation time/epoch 81.81488037109375
----------------------------------------before batch input features to device
 Nvidia-smi: 22.625 GB
    Memory Allocated: 0.21909856796264648  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.625 GB
    Memory Allocated: 0.41335344314575195  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.625 GB
    Memory Allocated: 0.4135417938232422  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.625 GB
    Memory Allocated: 0.22005128860473633  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.625 GB
    Memory Allocated: 0.40890073776245117  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.625 GB
    Memory Allocated: 0.40908002853393555  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.625 GB
    Memory Allocated: 0.22996234893798828  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.625 GB
    Memory Allocated: 0.44878625869750977  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.625 GB
    Memory Allocated: 0.44896507263183594  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.2733607292175293  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.514073371887207  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.5142512321472168  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.31234169006347656  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.46160221099853516  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.46178340911865234  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.23562145233154297  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.4095954895019531  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.40978288650512695  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.2758169174194336  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.46590709686279297  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.4660940170288086  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.30742406845092773  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.4566612243652344  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.45684814453125  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13280901312828064 |0.015754014253616333 |0.15701237320899963 |0.00011643767356872559 |0.13270500302314758 |0.006064891815185547 |
----------------------------------------------------------pseudo_mini_loss sum 2.2361276149749756
Total (block generation + training)time/epoch 85.38161969184875
Training time/epoch 3.56644868850708
Training time without block to device /epoch 3.4404165744781494
Training time without total dataloading part(pure training) /epoch 2.324735403060913
load block tensor time/epoch 1.0624721050262451
block to device time/epoch 0.12603211402893066
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0

Epoch:  4
REG start----................................
Convert a graph into a bidirected graph: 3.175 seconds, peak memory: 84.677 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.677 GB
Metis partitioning: 14.437 seconds, peak memory: 84.677 GB
Split the graph: 1.955 seconds
Construct subgraphs: 0.026 seconds
REG metis partition end ----................................
connection checking time:  20.834287643432617
block generation total time  20.26289415359497
average batch blocks generation time:  2.5328617691993713
block dataloader generation time/epoch 80.44814956188202
----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.17207098007202148  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.39084720611572266  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.3910255432128906  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.24184513092041016  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.42580747604370117  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.4259943962097168  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.22240114212036133  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.38994359970092773  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.3901238441467285  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.21962928771972656  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.4280819892883301  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.42826128005981445  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.27504539489746094  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.46059226989746094  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.46078062057495117  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.26861047744750977  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.43343591690063477  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.43361425399780273  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.2628955841064453  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.4331040382385254  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.43329286575317383  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.2835369110107422  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.4416370391845703  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.44182348251342773  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12915638089179993 |0.016513526439666748 |0.14734402298927307 |0.00011530518531799316 |0.13375183939933777 |0.0037391185760498047 |
----------------------------------------------------------pseudo_mini_loss sum 1.7801142930984497
Total (block generation + training)time/epoch 83.97052085399628
Training time/epoch 3.4777729511260986
Training time without block to device /epoch 3.3456647396087646
Training time without total dataloading part(pure training) /epoch 2.2534284591674805
load block tensor time/epoch 1.0332510471343994
block to device time/epoch 0.13210821151733398
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0

Epoch:  5
REG start----................................
Convert a graph into a bidirected graph: 3.265 seconds, peak memory: 84.937 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.937 GB
Metis partitioning: 14.851 seconds, peak memory: 84.937 GB
Split the graph: 2.214 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
connection checking time:  20.79355001449585
block generation total time  20.81393575668335
average batch blocks generation time:  2.6017419695854187
block dataloader generation time/epoch 80.47496279080708
----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.18224143981933594  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.3694033622741699  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.3695812225341797  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.21143436431884766  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.38297605514526367  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.3831648826599121  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.21155309677124023  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.33854007720947266  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.3387269973754883  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.1809248924255371  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.35534048080444336  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.35552358627319336  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.24473047256469727  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.483273983001709  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 0.48345232009887695  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.32258081436157227  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.5066637992858887  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.5068421363830566  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.28317785263061523  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.4847283363342285  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.48491573333740234  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.3188495635986328  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.4882950782775879  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.4884805679321289  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12547865509986877 |0.015128135681152344 |0.15248265862464905 |0.00012096762657165527 |0.13098078966140747 |0.006054878234863281 |
----------------------------------------------------------pseudo_mini_loss sum 1.5546789169311523
Total (block generation + training)time/epoch 83.98005533218384
Training time/epoch 3.470308780670166
Training time without block to device /epoch 3.3492836952209473
Training time without total dataloading part(pure training) /epoch 2.2747302055358887
load block tensor time/epoch 1.0038292407989502
block to device time/epoch 0.12102508544921875
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0

Epoch:  6
REG start----................................
Convert a graph into a bidirected graph: 3.166 seconds, peak memory: 84.937 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.937 GB
Metis partitioning: 14.893 seconds, peak memory: 84.937 GB
Split the graph: 1.967 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
connection checking time:  20.85669493675232
block generation total time  20.25504994392395
average batch blocks generation time:  2.5318812429904938
block dataloader generation time/epoch 80.29887449741364
----------------------------------------before batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.19340229034423828  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.3630552291870117  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.36324405670166016  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.19288301467895508  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.32462024688720703  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.32480907440185547  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.17034530639648438  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.33653831481933594  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.3367161750793457  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.2202301025390625  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.3958897590637207  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.3960690498352051  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.24520015716552734  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.4186415672302246  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.41882991790771484  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.26014184951782227  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.4751129150390625  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.4752988815307617  GigaBytes
Max Memory Allocated: 18.44727611541748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.326171875 GB
    Memory Allocated: 0.31795835494995117  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.326171875 GB
    Memory Allocated: 0.5203895568847656  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.326171875 GB
    Memory Allocated: 0.52056884765625  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.513671875 GB
    Memory Allocated: 0.3182516098022461  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.513671875 GB
    Memory Allocated: 0.5266008377075195  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.513671875 GB
    Memory Allocated: 0.5267796516418457  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13306549191474915 |0.019410043954849243 |0.1900094747543335 |0.00011530518531799316 |0.13088113069534302 |0.006051778793334961 |
----------------------------------------------------------pseudo_mini_loss sum 1.3989441394805908
Total (block generation + training)time/epoch 83.89127612113953
Training time/epoch 3.854094982147217
Training time without block to device /epoch 3.698814630508423
Training time without total dataloading part(pure training) /epoch 2.574099063873291
load block tensor time/epoch 1.0645239353179932
block to device time/epoch 0.15528035163879395
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0

Epoch:  7
REG start----................................
Convert a graph into a bidirected graph: 3.171 seconds, peak memory: 84.937 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.937 GB
Metis partitioning: 14.755 seconds, peak memory: 84.937 GB
Split the graph: 1.880 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
connection checking time:  16.337196826934814
block generation total time  14.103131294250488
average batch blocks generation time:  1.762891411781311
block dataloader generation time/epoch 78.04428062438964
----------------------------------------before batch input features to device
 Nvidia-smi: 20.60546875 GB
    Memory Allocated: 0.23064899444580078  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.60546875 GB
    Memory Allocated: 0.4537844657897949  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.60546875 GB
    Memory Allocated: 0.4539623260498047  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.60546875 GB
    Memory Allocated: 0.24689340591430664  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.60546875 GB
    Memory Allocated: 0.4745044708251953  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.60546875 GB
    Memory Allocated: 0.4746828079223633  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.609375 GB
    Memory Allocated: 0.2651996612548828  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.609375 GB
    Memory Allocated: 0.4686088562011719  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.609375 GB
    Memory Allocated: 0.46878671646118164  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.609375 GB
    Memory Allocated: 0.25584840774536133  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.609375 GB
    Memory Allocated: 0.4398508071899414  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.609375 GB
    Memory Allocated: 0.44003915786743164  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.2515850067138672  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4146895408630371  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4148678779602051  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.2463841438293457  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4065685272216797  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4067568778991699  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.259521484375  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.44452714920043945  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4447154998779297  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.29918384552001953  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.46944522857666016  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4696340560913086  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.14141017198562622 |0.021766215562820435 |0.12996482849121094 |9.435415267944336e-05 |0.12047925591468811 |0.001497030258178711 |
----------------------------------------------------------pseudo_mini_loss sum 1.2748523950576782
Total (block generation + training)time/epoch 81.5960837841034
Training time/epoch 3.38916277885437
Training time without block to device /epoch 3.2150330543518066
Training time without total dataloading part(pure training) /epoch 2.0058045387268066
load block tensor time/epoch 1.1312813758850098
block to device time/epoch 0.17412972450256348
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0

Epoch:  8
REG start----................................
Convert a graph into a bidirected graph: 3.237 seconds, peak memory: 84.937 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.937 GB
Metis partitioning: 14.631 seconds, peak memory: 84.937 GB
Split the graph: 2.111 seconds
Construct subgraphs: 0.028 seconds
REG metis partition end ----................................
connection checking time:  21.448887825012207
block generation total time  21.03649878501892
average batch blocks generation time:  2.629562348127365
block dataloader generation time/epoch 78.03120350837708
----------------------------------------before batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.1950082778930664  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4148740768432617  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4150528907775879  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.2433795928955078  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4778022766113281  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4779810905456543  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.2711806297302246  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4657435417175293  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.46592140197753906  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.24578619003295898  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4342613220214844  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.591796875 GB
    Memory Allocated: 0.4344496726989746  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.2553730010986328  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.44199371337890625  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.4421815872192383  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.26851367950439453  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.3982887268066406  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.39847612380981445  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.2257223129272461  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.3933281898498535  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.39351654052734375  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.2806096076965332  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.47971439361572266  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.4798927307128906  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.14576193690299988 |0.016335338354110718 |0.1534518003463745 |0.00012040138244628906 |0.11976465582847595 |0.0040853023529052734 |
----------------------------------------------------------pseudo_mini_loss sum 1.178189754486084
Total (block generation + training)time/epoch 81.58404151598613
Training time/epoch 3.557772397994995
Training time without block to device /epoch 3.4270896911621094
Training time without total dataloading part(pure training) /epoch 2.1907801628112793
load block tensor time/epoch 1.166095495223999
block to device time/epoch 0.13068270683288574
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0

Epoch:  9
REG start----................................
Convert a graph into a bidirected graph: 3.072 seconds, peak memory: 84.937 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.937 GB
Metis partitioning: 14.882 seconds, peak memory: 84.937 GB
Split the graph: 1.909 seconds
Construct subgraphs: 0.028 seconds
REG metis partition end ----................................
connection checking time:  13.447893381118774
block generation total time  11.807716369628906
average batch blocks generation time:  1.4759645462036133
block dataloader generation time/epoch 75.76922821998596
----------------------------------------before batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.22118043899536133  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.35112953186035156  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.35131263732910156  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.15324926376342773  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.3636469841003418  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.36382627487182617  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.2492823600769043  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.4429769515991211  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.44316530227661133  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.24875640869140625  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.43731021881103516  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.43749141693115234  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.25919485092163086  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.4809098243713379  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.48108959197998047  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.3062467575073242  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.4993324279785156  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.49951934814453125  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.2917814254760742  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.45794248580932617  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.4581308364868164  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.28121280670166016  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.45096540451049805  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.939453125 GB
    Memory Allocated: 0.4511446952819824  GigaBytes
Max Memory Allocated: 18.638046264648438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1395772099494934 |0.018484681844711304 |0.13675826787948608 |0.00010249018669128418 |0.12088865041732788 |0.00238800048828125 |
----------------------------------------------------------pseudo_mini_loss sum 1.0814359188079834
Total (block generation + training)time/epoch 79.29950049945286
Training time/epoch 3.394648790359497
Training time without block to device /epoch 3.2467713356018066
Training time without total dataloading part(pure training) /epoch 2.0643832683563232
load block tensor time/epoch 1.1166176795959473
block to device time/epoch 0.14787745475769043
input features size transfer per epoch 0.0
blocks size to device per epoch 0.0

