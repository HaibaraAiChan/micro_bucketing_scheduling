main start at this time 1700909671.5794857
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
self._in_src_feats,  100
self._in_dst_feats 100
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.829 seconds, peak memory: 40.429 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.429 GB
Metis partitioning: 14.370 seconds, peak memory: 40.429 GB
Split the graph: 1.251 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  11.821471929550171
pure dgl.metis_partition the time spent:  18.473134994506836

block_gen_time in "generate_blocks_for_one_layer_block"  4.849966287612915


block_gen_time in "generate_blocks_for_one_layer_block"  16.74040198326111

connection checking time:  23.408787488937378
block generation total time  21.590368270874023
generate_dataloader_block spend   78.8998613357544
pure train time  3.931381940841675
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.30078125 GB
    Memory Allocated: 0.6945381164550781  GigaBytes
Max Memory Allocated: 6.44482421875  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.80181622505188
epoch time :  85.27257347106934
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.962 seconds, peak memory: 61.935 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 61.935 GB
Metis partitioning: 17.266 seconds, peak memory: 66.935 GB
Split the graph: 1.187 seconds
Construct subgraphs: 0.724 seconds
REG metis partition end ----................................
REG construction  time spent:  12.931387901306152
pure dgl.metis_partition the time spent:  22.14125657081604

block_gen_time in "generate_blocks_for_one_layer_block"  4.7564942836761475


block_gen_time in "generate_blocks_for_one_layer_block"  16.297438859939575

connection checking time:  22.949275016784668
block generation total time  21.053933143615723
generate_dataloader_block spend   82.70145392417908
pure train time  3.341456890106201
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.33203125 GB
    Memory Allocated: 0.7232098579406738  GigaBytes
Max Memory Allocated: 6.44482421875  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7971105575561523
epoch time :  88.14653491973877
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.093 seconds, peak memory: 70.445 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.445 GB
Metis partitioning: 16.069 seconds, peak memory: 70.445 GB
Split the graph: 1.688 seconds
Construct subgraphs: 0.032 seconds
REG metis partition end ----................................
REG construction  time spent:  12.706778049468994
pure dgl.metis_partition the time spent:  20.884447813034058

block_gen_time in "generate_blocks_for_one_layer_block"  4.916517496109009


block_gen_time in "generate_blocks_for_one_layer_block"  17.117183685302734

connection checking time:  23.86637854576111
block generation total time  22.033701181411743
generate_dataloader_block spend   83.9743812084198
pure train time  3.28647780418396
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.833984375 GB
    Memory Allocated: 0.6997814178466797  GigaBytes
Max Memory Allocated: 6.640560150146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7923672199249268
epoch time :  89.31900930404663
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.977 seconds, peak memory: 73.424 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 73.424 GB
Metis partitioning: 15.795 seconds, peak memory: 73.424 GB
Split the graph: 1.274 seconds
Construct subgraphs: 0.028 seconds
REG metis partition end ----................................
REG construction  time spent:  13.00139856338501
pure dgl.metis_partition the time spent:  20.075535774230957

block_gen_time in "generate_blocks_for_one_layer_block"  5.300477504730225


block_gen_time in "generate_blocks_for_one_layer_block"  15.396922588348389

connection checking time:  22.644827842712402
block generation total time  20.697400093078613
generate_dataloader_block spend   80.80132842063904
pure train time  3.1791772842407227
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.833984375 GB
    Memory Allocated: 0.6182889938354492  GigaBytes
Max Memory Allocated: 6.640560150146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7875452041625977
epoch time :  85.96593022346497
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.951 seconds, peak memory: 74.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.227 GB
Metis partitioning: 17.107 seconds, peak memory: 74.227 GB
Split the graph: 1.735 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  12.818217754364014
pure dgl.metis_partition the time spent:  21.817355155944824

block_gen_time in "generate_blocks_for_one_layer_block"  4.889828681945801


block_gen_time in "generate_blocks_for_one_layer_block"  15.756093740463257

connection checking time:  23.03898525238037
block generation total time  20.645922422409058
generate_dataloader_block spend   82.6387267112732
pure train time  3.2148003578186035
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.83984375 GB
    Memory Allocated: 0.6896572113037109  GigaBytes
Max Memory Allocated: 6.640560150146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.782649278640747
epoch time :  87.84704065322876
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.870 seconds, peak memory: 75.117 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 75.117 GB
Metis partitioning: 17.478 seconds, peak memory: 75.117 GB
Split the graph: 1.656 seconds
Construct subgraphs: 0.028 seconds
REG metis partition end ----................................
REG construction  time spent:  12.813100814819336
pure dgl.metis_partition the time spent:  22.034252405166626

block_gen_time in "generate_blocks_for_one_layer_block"  4.9005138874053955


block_gen_time in "generate_blocks_for_one_layer_block"  15.814408779144287

connection checking time:  23.19525933265686
block generation total time  20.714922666549683
generate_dataloader_block spend   83.23359751701355
pure train time  3.193310022354126
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.4140625 GB
    Memory Allocated: 0.6611833572387695  GigaBytes
Max Memory Allocated: 6.640560150146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7776639461517334
epoch time :  88.53634810447693
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.252 seconds, peak memory: 77.502 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.502 GB
Metis partitioning: 16.781 seconds, peak memory: 77.502 GB
Split the graph: 1.646 seconds
Construct subgraphs: 0.027 seconds
REG metis partition end ----................................
REG construction  time spent:  12.528878450393677
pure dgl.metis_partition the time spent:  21.70851230621338

block_gen_time in "generate_blocks_for_one_layer_block"  4.957669496536255


block_gen_time in "generate_blocks_for_one_layer_block"  15.889886856079102

connection checking time:  23.3315212726593
block generation total time  20.847556352615356
generate_dataloader_block spend   82.74924063682556
pure train time  3.2075886726379395
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.4140625 GB
    Memory Allocated: 0.698387622833252  GigaBytes
Max Memory Allocated: 6.640560150146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7725892066955566
epoch time :  88.15047550201416
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.214 seconds, peak memory: 78.164 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.164 GB
Metis partitioning: 18.289 seconds, peak memory: 78.164 GB
Split the graph: 1.744 seconds
Construct subgraphs: 0.034 seconds
REG metis partition end ----................................
REG construction  time spent:  12.71600079536438
pure dgl.metis_partition the time spent:  23.282976388931274

block_gen_time in "generate_blocks_for_one_layer_block"  4.885481119155884


block_gen_time in "generate_blocks_for_one_layer_block"  16.611563682556152

connection checking time:  23.365584135055542
block generation total time  21.497044801712036
generate_dataloader_block spend   85.28620862960815
pure train time  3.1836018562316895
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.4140625 GB
    Memory Allocated: 0.6967129707336426  GigaBytes
Max Memory Allocated: 6.640560150146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7673940658569336
epoch time :  90.4610641002655
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.007 seconds, peak memory: 78.164 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.164 GB
Metis partitioning: 17.025 seconds, peak memory: 78.164 GB
Split the graph: 1.450 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  12.461079359054565
pure dgl.metis_partition the time spent:  21.503276586532593

block_gen_time in "generate_blocks_for_one_layer_block"  4.776068210601807


block_gen_time in "generate_blocks_for_one_layer_block"  16.466387033462524

connection checking time:  23.402603149414062
block generation total time  21.24245524406433
generate_dataloader_block spend   82.8843183517456
pure train time  3.205265998840332
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.4140625 GB
    Memory Allocated: 0.7062273025512695  GigaBytes
Max Memory Allocated: 6.640560150146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7620463371276855
epoch time :  88.0476348400116
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.127 seconds, peak memory: 78.539 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.539 GB
Metis partitioning: 17.387 seconds, peak memory: 78.539 GB
Split the graph: 1.636 seconds
Construct subgraphs: 0.030 seconds
REG metis partition end ----................................
REG construction  time spent:  12.981203556060791
pure dgl.metis_partition the time spent:  22.181833744049072

block_gen_time in "generate_blocks_for_one_layer_block"  4.970202207565308


block_gen_time in "generate_blocks_for_one_layer_block"  9.535217523574829

connection checking time:  19.3528892993927
block generation total time  14.505419731140137
generate_dataloader_block spend   73.22933173179626
pure train time  2.6154003143310547
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.4140625 GB
    Memory Allocated: 0.6758689880371094  GigaBytes
Max Memory Allocated: 6.640560150146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7565598487854004
epoch time :  77.89718294143677
Total (block generation + training)time/epoch 86.96437864303589
pure train time/epoch 3.1033278703689575

num_input_list  [4987175, 5002324, 5086811, 4899439, 4998485, 5086889, 5133226, 5018683, 5084048, 4971555]
