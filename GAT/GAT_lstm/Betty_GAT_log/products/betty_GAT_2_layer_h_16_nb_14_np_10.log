main start at this time 1700908836.6657999
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
self._in_src_feats,  100
self._in_dst_feats 100
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.236 seconds, peak memory: 40.401 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.401 GB
Metis partitioning: 15.338 seconds, peak memory: 40.401 GB
Split the graph: 1.234 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  12.363583326339722
pure dgl.metis_partition the time spent:  19.828774452209473

block_gen_time in "generate_blocks_for_one_layer_block"  5.0672643184661865


block_gen_time in "generate_blocks_for_one_layer_block"  16.29481554031372

connection checking time:  22.437846660614014
block generation total time  21.362079858779907
generate_dataloader_block spend   79.57824921607971
pure train time  3.400412082672119
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.76953125 GB
    Memory Allocated: 0.6736893653869629  GigaBytes
Max Memory Allocated: 7.052931308746338  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.8018345832824707
epoch time :  85.09274291992188
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.087 seconds, peak memory: 62.064 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 62.064 GB
Metis partitioning: 15.138 seconds, peak memory: 67.064 GB
Split the graph: 1.305 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  12.346086978912354
pure dgl.metis_partition the time spent:  19.553335189819336

block_gen_time in "generate_blocks_for_one_layer_block"  5.023727893829346


block_gen_time in "generate_blocks_for_one_layer_block"  15.01956033706665

connection checking time:  22.26249885559082
block generation total time  20.043288230895996
generate_dataloader_block spend   78.09503030776978
pure train time  2.919707775115967
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.775390625 GB
    Memory Allocated: 0.6471405029296875  GigaBytes
Max Memory Allocated: 7.052931308746338  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7971057891845703
epoch time :  83.00461006164551
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.357 seconds, peak memory: 70.492 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.492 GB
Metis partitioning: 16.510 seconds, peak memory: 70.492 GB
Split the graph: 1.958 seconds
Construct subgraphs: 0.036 seconds
REG metis partition end ----................................
REG construction  time spent:  12.866864204406738
pure dgl.metis_partition the time spent:  21.862754821777344

block_gen_time in "generate_blocks_for_one_layer_block"  4.991041421890259


block_gen_time in "generate_blocks_for_one_layer_block"  15.282087326049805

connection checking time:  22.56217336654663
block generation total time  20.273128747940063
generate_dataloader_block spend   81.37278342247009
pure train time  2.9096193313598633
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.775390625 GB
    Memory Allocated: 0.6534466743469238  GigaBytes
Max Memory Allocated: 7.052931308746338  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7923734188079834
epoch time :  86.288170337677
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.110 seconds, peak memory: 72.633 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.633 GB
Metis partitioning: 16.709 seconds, peak memory: 72.633 GB
Split the graph: 1.838 seconds
Construct subgraphs: 0.028 seconds
REG metis partition end ----................................
REG construction  time spent:  12.856326580047607
pure dgl.metis_partition the time spent:  21.687461614608765

block_gen_time in "generate_blocks_for_one_layer_block"  4.96254563331604


block_gen_time in "generate_blocks_for_one_layer_block"  14.836905479431152

connection checking time:  21.906991481781006
block generation total time  19.799451112747192
generate_dataloader_block spend   80.09848189353943
pure train time  2.882498264312744
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.775390625 GB
    Memory Allocated: 0.6272459030151367  GigaBytes
Max Memory Allocated: 7.052931308746338  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.787545919418335
epoch time :  85.11329221725464
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.160 seconds, peak memory: 73.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 73.227 GB
Metis partitioning: 16.664 seconds, peak memory: 73.227 GB
Split the graph: 1.432 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  12.518284559249878
pure dgl.metis_partition the time spent:  21.279725551605225

block_gen_time in "generate_blocks_for_one_layer_block"  4.951925039291382


block_gen_time in "generate_blocks_for_one_layer_block"  15.817858934402466

connection checking time:  22.45267367362976
block generation total time  20.769783973693848
generate_dataloader_block spend   80.99223303794861
pure train time  2.8946285247802734
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.525390625 GB
    Memory Allocated: 0.6120600700378418  GigaBytes
Max Memory Allocated: 7.2548298835754395  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.782640218734741
epoch time :  86.03684091567993
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.040 seconds, peak memory: 75.612 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 75.612 GB
Metis partitioning: 16.756 seconds, peak memory: 75.612 GB
Split the graph: 1.643 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  12.874916791915894
pure dgl.metis_partition the time spent:  21.464015245437622

block_gen_time in "generate_blocks_for_one_layer_block"  4.9396913051605225


block_gen_time in "generate_blocks_for_one_layer_block"  15.424721479415894

connection checking time:  22.69280242919922
block generation total time  20.364412784576416
generate_dataloader_block spend   81.31798338890076
pure train time  2.90079665184021
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.53125 GB
    Memory Allocated: 0.698333740234375  GigaBytes
Max Memory Allocated: 7.257034778594971  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.777653217315674
epoch time :  86.2263720035553
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.190 seconds, peak memory: 75.899 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 75.899 GB
Metis partitioning: 16.850 seconds, peak memory: 75.899 GB
Split the graph: 1.650 seconds
Construct subgraphs: 0.034 seconds
REG metis partition end ----................................
REG construction  time spent:  12.908647060394287
pure dgl.metis_partition the time spent:  21.72598958015442

block_gen_time in "generate_blocks_for_one_layer_block"  2.9778079986572266


block_gen_time in "generate_blocks_for_one_layer_block"  8.433201551437378

connection checking time:  14.170396327972412
block generation total time  11.411009550094604
generate_dataloader_block spend   63.33360695838928
pure train time  2.3829309940338135
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.53125 GB
    Memory Allocated: 0.6451053619384766  GigaBytes
Max Memory Allocated: 7.257034778594971  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7725768089294434
epoch time :  67.61386156082153
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.147 seconds, peak memory: 76.852 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 76.852 GB
Metis partitioning: 16.625 seconds, peak memory: 76.852 GB
Split the graph: 1.709 seconds
Construct subgraphs: 0.034 seconds
REG metis partition end ----................................
REG construction  time spent:  10.401877403259277
pure dgl.metis_partition the time spent:  21.517210721969604

block_gen_time in "generate_blocks_for_one_layer_block"  3.545870304107666


block_gen_time in "generate_blocks_for_one_layer_block"  9.446730852127075

connection checking time:  14.677407503128052
block generation total time  12.992601156234741
generate_dataloader_block spend   62.58861565589905
pure train time  2.397583246231079
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.5390625 GB
    Memory Allocated: 0.6863856315612793  GigaBytes
Max Memory Allocated: 7.257034778594971  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7673845291137695
epoch time :  67.04395890235901
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.589 seconds, peak memory: 77.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.227 GB
Metis partitioning: 17.086 seconds, peak memory: 77.227 GB
Split the graph: 1.405 seconds
Construct subgraphs: 0.031 seconds
REG metis partition end ----................................
REG construction  time spent:  12.76804518699646
pure dgl.metis_partition the time spent:  21.112487316131592

block_gen_time in "generate_blocks_for_one_layer_block"  4.953111886978149


block_gen_time in "generate_blocks_for_one_layer_block"  9.1976797580719

connection checking time:  18.461138248443604
block generation total time  14.150791645050049
generate_dataloader_block spend   70.35402226448059
pure train time  2.350908041000366
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.560546875 GB
    Memory Allocated: 0.6753993034362793  GigaBytes
Max Memory Allocated: 7.257034778594971  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7620596885681152
epoch time :  74.67046523094177
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.292 seconds, peak memory: 77.758 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.758 GB
Metis partitioning: 17.230 seconds, peak memory: 77.758 GB
Split the graph: 1.679 seconds
Construct subgraphs: 0.045 seconds
REG metis partition end ----................................
REG construction  time spent:  9.48512578010559
pure dgl.metis_partition the time spent:  22.248615980148315

block_gen_time in "generate_blocks_for_one_layer_block"  4.979319334030151


block_gen_time in "generate_blocks_for_one_layer_block"  16.404796361923218

connection checking time:  22.611730813980103
block generation total time  21.38411569595337
generate_dataloader_block spend   79.4772777557373
pure train time  2.8819637298583984
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.560546875 GB
    Memory Allocated: 0.6514778137207031  GigaBytes
Max Memory Allocated: 7.329215049743652  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7565600872039795
epoch time :  84.459068775177
Total (block generation + training)time/epoch 80.55493731498719
pure train time/epoch 2.6348018646240234

num_input_list  [4625821, 4674553, 4732444, 4591778, 4713228, 4834645, 4595785, 4805809, 4764674, 4699471]
