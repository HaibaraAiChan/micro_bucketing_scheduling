main start at this time 1700906240.5347705
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
self._in_src_feats,  100
self._in_dst_feats 100
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.127 seconds, peak memory: 40.456 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.456 GB
Metis partitioning: 14.045 seconds, peak memory: 40.456 GB
Split the graph: 1.881 seconds
Construct subgraphs: 0.007 seconds
REG metis partition end ----................................
REG construction  time spent:  12.233201742172241
pure dgl.metis_partition the time spent:  19.06239604949951

block_gen_time in "generate_blocks_for_one_layer_block"  5.083597660064697


block_gen_time in "generate_blocks_for_one_layer_block"  15.581031322479248

connection checking time:  21.784645557403564
block generation total time  20.664628982543945
generate_dataloader_block spend   77.3121726512909
pure train time  2.5623364448547363
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.158203125 GB
    Memory Allocated: 0.6892070770263672  GigaBytes
Max Memory Allocated: 11.042648792266846  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.8018200397491455
epoch time :  82.24243879318237
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.023 seconds, peak memory: 69.254 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.254 GB
Metis partitioning: 14.226 seconds, peak memory: 69.254 GB
Split the graph: 1.770 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  12.067004919052124
pure dgl.metis_partition the time spent:  19.044456243515015

block_gen_time in "generate_blocks_for_one_layer_block"  4.8688836097717285


block_gen_time in "generate_blocks_for_one_layer_block"  15.004587650299072

connection checking time:  21.177958250045776
block generation total time  19.8734712600708
generate_dataloader_block spend   76.098628282547
pure train time  1.9933767318725586
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.208984375 GB
    Memory Allocated: 0.6588850021362305  GigaBytes
Max Memory Allocated: 11.042648792266846  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7971131801605225
epoch time :  79.98165369033813
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.050 seconds, peak memory: 70.785 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.785 GB
Metis partitioning: 15.535 seconds, peak memory: 70.785 GB
Split the graph: 1.965 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  12.95742917060852
pure dgl.metis_partition the time spent:  20.570570945739746

block_gen_time in "generate_blocks_for_one_layer_block"  4.842819690704346


block_gen_time in "generate_blocks_for_one_layer_block"  15.857670545578003

connection checking time:  21.185408115386963
block generation total time  20.70049023628235
generate_dataloader_block spend   79.38932228088379
pure train time  1.9337363243103027
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.208984375 GB
    Memory Allocated: 0.6763014793395996  GigaBytes
Max Memory Allocated: 11.042648792266846  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.792341947555542
epoch time :  83.28195142745972
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.223 seconds, peak memory: 73.332 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 73.332 GB
Metis partitioning: 15.747 seconds, peak memory: 73.332 GB
Split the graph: 2.216 seconds
Construct subgraphs: 0.024 seconds
REG metis partition end ----................................
REG construction  time spent:  12.289453983306885
pure dgl.metis_partition the time spent:  21.21525001525879

block_gen_time in "generate_blocks_for_one_layer_block"  5.013664245605469


block_gen_time in "generate_blocks_for_one_layer_block"  15.47549557685852

connection checking time:  21.010180234909058
block generation total time  20.48915982246399
generate_dataloader_block spend   79.01981449127197
pure train time  1.9731159210205078
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.208984375 GB
    Memory Allocated: 0.6961865425109863  GigaBytes
Max Memory Allocated: 11.042648792266846  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7875428199768066
epoch time :  82.68313264846802
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.008 seconds, peak memory: 74.820 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.820 GB
Metis partitioning: 16.086 seconds, peak memory: 74.820 GB
Split the graph: 1.695 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  11.175523042678833
pure dgl.metis_partition the time spent:  20.808333158493042

block_gen_time in "generate_blocks_for_one_layer_block"  2.889636516571045


block_gen_time in "generate_blocks_for_one_layer_block"  9.145241737365723

connection checking time:  13.735645532608032
block generation total time  12.034878253936768
generate_dataloader_block spend   60.80386185646057
pure train time  1.5884895324707031
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.208984375 GB
    Memory Allocated: 0.689572811126709  GigaBytes
Max Memory Allocated: 11.042648792266846  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7826523780822754
epoch time :  64.19761347770691
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.116 seconds, peak memory: 77.180 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.180 GB
Metis partitioning: 16.546 seconds, peak memory: 77.180 GB
Split the graph: 2.564 seconds
Construct subgraphs: 0.025 seconds
REG metis partition end ----................................
REG construction  time spent:  10.173728466033936
pure dgl.metis_partition the time spent:  22.25382971763611

block_gen_time in "generate_blocks_for_one_layer_block"  4.919111251831055


block_gen_time in "generate_blocks_for_one_layer_block"  16.41512131690979

connection checking time:  21.605620861053467
block generation total time  21.334232568740845
generate_dataloader_block spend   79.05191493034363
pure train time  1.7757437229156494
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.208984375 GB
    Memory Allocated: 0.6887044906616211  GigaBytes
Max Memory Allocated: 11.042648792266846  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.777670383453369
epoch time :  82.68116855621338
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.170 seconds, peak memory: 78.586 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.586 GB
Metis partitioning: 16.543 seconds, peak memory: 78.586 GB
Split the graph: 2.391 seconds
Construct subgraphs: 0.038 seconds
REG metis partition end ----................................
REG construction  time spent:  12.597397565841675
pure dgl.metis_partition the time spent:  22.143482208251953

block_gen_time in "generate_blocks_for_one_layer_block"  4.843050479888916


block_gen_time in "generate_blocks_for_one_layer_block"  14.830282926559448

connection checking time:  20.995620012283325
block generation total time  19.673333406448364
generate_dataloader_block spend   79.35378527641296
pure train time  1.9591090679168701
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.208984375 GB
    Memory Allocated: 0.6887879371643066  GigaBytes
Max Memory Allocated: 11.042648792266846  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7725846767425537
epoch time :  83.21835088729858
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.217 seconds, peak memory: 79.992 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 79.992 GB
Metis partitioning: 17.174 seconds, peak memory: 79.992 GB
Split the graph: 2.368 seconds
Construct subgraphs: 0.031 seconds
REG metis partition end ----................................
REG construction  time spent:  13.014089345932007
pure dgl.metis_partition the time spent:  22.792222499847412

block_gen_time in "generate_blocks_for_one_layer_block"  4.84965968132019


block_gen_time in "generate_blocks_for_one_layer_block"  16.441645860671997

connection checking time:  21.925622701644897
block generation total time  21.291305541992188
generate_dataloader_block spend   83.0114324092865
pure train time  2.013361692428589
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.208984375 GB
    Memory Allocated: 0.7030754089355469  GigaBytes
Max Memory Allocated: 11.042648792266846  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7673885822296143
epoch time :  87.11632800102234
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.031 seconds, peak memory: 80.211 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.211 GB
Metis partitioning: 16.726 seconds, peak memory: 80.211 GB
Split the graph: 2.022 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  12.494210958480835
pure dgl.metis_partition the time spent:  21.80344557762146

block_gen_time in "generate_blocks_for_one_layer_block"  4.935053110122681


block_gen_time in "generate_blocks_for_one_layer_block"  16.126488208770752

connection checking time:  21.572959661483765
block generation total time  21.061541318893433
generate_dataloader_block spend   81.02448749542236
pure train time  1.9890704154968262
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.73828125 GB
    Memory Allocated: 0.6909823417663574  GigaBytes
Max Memory Allocated: 11.059862613677979  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.762071132659912
epoch time :  84.98652148246765
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.911 seconds, peak memory: 81.986 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 81.986 GB
Metis partitioning: 17.138 seconds, peak memory: 81.986 GB
Split the graph: 2.278 seconds
Construct subgraphs: 0.033 seconds
REG metis partition end ----................................
REG construction  time spent:  12.524419784545898
pure dgl.metis_partition the time spent:  22.361622095108032

block_gen_time in "generate_blocks_for_one_layer_block"  5.400187253952026


block_gen_time in "generate_blocks_for_one_layer_block"  16.14465832710266

connection checking time:  21.619242429733276
block generation total time  21.544845581054688
generate_dataloader_block spend   82.13037633895874
pure train time  1.9464941024780273
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.73828125 GB
    Memory Allocated: 0.665076732635498  GigaBytes
Max Memory Allocated: 11.059862613677979  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7565369606018066
epoch time :  85.8972282409668
Total (block generation + training)time/epoch 81.62863790988922
pure train time/epoch 1.878711422284444

num_input_list  [4016996, 3978845, 3940443, 4030137, 4060866, 3959655, 4053633, 4207150, 3964295, 3966932]
