main start at this time 1700907956.3939674
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
self._in_src_feats,  100
self._in_dst_feats 100
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.832 seconds, peak memory: 40.518 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.518 GB
Metis partitioning: 14.916 seconds, peak memory: 40.518 GB
Split the graph: 1.334 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  12.530746936798096
pure dgl.metis_partition the time spent:  19.102982997894287

block_gen_time in "generate_blocks_for_one_layer_block"  5.155694007873535


block_gen_time in "generate_blocks_for_one_layer_block"  15.787435293197632

connection checking time:  21.900702714920044
block generation total time  20.943129301071167
generate_dataloader_block spend   78.17958378791809
pure train time  3.064788341522217
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.09765625 GB
    Memory Allocated: 0.6583495140075684  GigaBytes
Max Memory Allocated: 7.972846031188965  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.801818609237671
epoch time :  83.29150295257568
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.117 seconds, peak memory: 64.662 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 64.662 GB
Metis partitioning: 14.955 seconds, peak memory: 69.662 GB
Split the graph: 1.642 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  12.479191064834595
pure dgl.metis_partition the time spent:  19.735549688339233

block_gen_time in "generate_blocks_for_one_layer_block"  5.01180624961853


block_gen_time in "generate_blocks_for_one_layer_block"  14.473691463470459

connection checking time:  21.391804933547974
block generation total time  19.48549771308899
generate_dataloader_block spend   77.13137459754944
pure train time  2.5752954483032227
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.09765625 GB
    Memory Allocated: 0.6426758766174316  GigaBytes
Max Memory Allocated: 7.972846031188965  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7971274852752686
epoch time :  81.70126223564148
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.530 seconds, peak memory: 73.102 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 73.102 GB
Metis partitioning: 16.118 seconds, peak memory: 73.102 GB
Split the graph: 2.292 seconds
Construct subgraphs: 0.040 seconds
REG metis partition end ----................................
REG construction  time spent:  12.874904155731201
pure dgl.metis_partition the time spent:  20.981683492660522

block_gen_time in "generate_blocks_for_one_layer_block"  5.202803373336792


block_gen_time in "generate_blocks_for_one_layer_block"  16.548970699310303

connection checking time:  23.16697359085083
block generation total time  21.751774072647095
generate_dataloader_block spend   82.73856019973755
pure train time  2.6313908100128174
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 0.6689677238464355  GigaBytes
Max Memory Allocated: 7.972846031188965  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7923412322998047
epoch time :  87.38326907157898
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.205 seconds, peak memory: 77.682 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.682 GB
Metis partitioning: 15.982 seconds, peak memory: 77.682 GB
Split the graph: 1.825 seconds
Construct subgraphs: 0.024 seconds
REG metis partition end ----................................
REG construction  time spent:  13.092596054077148
pure dgl.metis_partition the time spent:  21.03693413734436

block_gen_time in "generate_blocks_for_one_layer_block"  5.268611669540405


block_gen_time in "generate_blocks_for_one_layer_block"  15.297645568847656

connection checking time:  21.83887767791748
block generation total time  20.56625723838806
generate_dataloader_block spend   80.50483393669128
pure train time  2.8901751041412354
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.69921875 GB
    Memory Allocated: 0.6667156219482422  GigaBytes
Max Memory Allocated: 8.190763473510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7875566482543945
epoch time :  85.31463074684143
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.076 seconds, peak memory: 80.214 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.214 GB
Metis partitioning: 15.902 seconds, peak memory: 80.214 GB
Split the graph: 1.529 seconds
Construct subgraphs: 0.029 seconds
REG metis partition end ----................................
REG construction  time spent:  12.814141035079956
pure dgl.metis_partition the time spent:  20.538403749465942

block_gen_time in "generate_blocks_for_one_layer_block"  4.94865083694458


block_gen_time in "generate_blocks_for_one_layer_block"  15.763752460479736

connection checking time:  22.122843265533447
block generation total time  20.712403297424316
generate_dataloader_block spend   80.22887587547302
pure train time  2.4442107677459717
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.828125 GB
    Memory Allocated: 0.641024112701416  GigaBytes
Max Memory Allocated: 8.190763473510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.782665491104126
epoch time :  84.67176651954651
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.224 seconds, peak memory: 80.214 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.214 GB
Metis partitioning: 16.256 seconds, peak memory: 80.214 GB
Split the graph: 1.460 seconds
Construct subgraphs: 0.028 seconds
REG metis partition end ----................................
REG construction  time spent:  13.004926204681396
pure dgl.metis_partition the time spent:  20.969215869903564

block_gen_time in "generate_blocks_for_one_layer_block"  5.262852191925049


block_gen_time in "generate_blocks_for_one_layer_block"  15.316879749298096

connection checking time:  22.35941195487976
block generation total time  20.579731941223145
generate_dataloader_block spend   80.78076887130737
pure train time  2.595888137817383
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.21484375 GB
    Memory Allocated: 0.6713166236877441  GigaBytes
Max Memory Allocated: 8.190763473510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.777657985687256
epoch time :  85.40507173538208
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.781 seconds, peak memory: 80.214 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.214 GB
Metis partitioning: 16.765 seconds, peak memory: 80.214 GB
Split the graph: 1.820 seconds
Construct subgraphs: 0.031 seconds
REG metis partition end ----................................
REG construction  time spent:  12.932589054107666
pure dgl.metis_partition the time spent:  21.398545503616333

block_gen_time in "generate_blocks_for_one_layer_block"  5.00666880607605


block_gen_time in "generate_blocks_for_one_layer_block"  16.75583052635193

connection checking time:  23.00236940383911
block generation total time  21.76249933242798
generate_dataloader_block spend   83.1219630241394
pure train time  2.576741933822632
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.259765625 GB
    Memory Allocated: 0.6607856750488281  GigaBytes
Max Memory Allocated: 8.190763473510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.772599697113037
epoch time :  87.58376669883728
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.140 seconds, peak memory: 80.214 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.214 GB
Metis partitioning: 17.346 seconds, peak memory: 80.214 GB
Split the graph: 1.839 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  12.908024787902832
pure dgl.metis_partition the time spent:  22.34730339050293

block_gen_time in "generate_blocks_for_one_layer_block"  4.9377827644348145


block_gen_time in "generate_blocks_for_one_layer_block"  13.983001947402954

connection checking time:  20.513700485229492
block generation total time  18.92078471183777
generate_dataloader_block spend   78.8216643333435
pure train time  2.559744358062744
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.259765625 GB
    Memory Allocated: 0.6717338562011719  GigaBytes
Max Memory Allocated: 8.190763473510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.767394542694092
epoch time :  83.3794515132904
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.253 seconds, peak memory: 80.214 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.214 GB
Metis partitioning: 17.129 seconds, peak memory: 80.214 GB
Split the graph: 2.029 seconds
Construct subgraphs: 0.027 seconds
REG metis partition end ----................................
REG construction  time spent:  12.72565746307373
pure dgl.metis_partition the time spent:  22.438823461532593

block_gen_time in "generate_blocks_for_one_layer_block"  4.930352687835693


block_gen_time in "generate_blocks_for_one_layer_block"  15.293681859970093

connection checking time:  22.470643281936646
block generation total time  20.224034547805786
generate_dataloader_block spend   81.68796300888062
pure train time  2.58384370803833
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.505859375 GB
    Memory Allocated: 0.6894865036010742  GigaBytes
Max Memory Allocated: 8.190763473510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7620372772216797
epoch time :  86.2827537059784
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.148 seconds, peak memory: 80.214 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.214 GB
Metis partitioning: 17.417 seconds, peak memory: 80.214 GB
Split the graph: 1.541 seconds
Construct subgraphs: 0.036 seconds
REG metis partition end ----................................
REG construction  time spent:  12.824891805648804
pure dgl.metis_partition the time spent:  22.145378828048706

block_gen_time in "generate_blocks_for_one_layer_block"  4.987112045288086


block_gen_time in "generate_blocks_for_one_layer_block"  16.21669316291809

connection checking time:  22.683934926986694
block generation total time  21.203805208206177
generate_dataloader_block spend   82.93243193626404
pure train time  2.3504374027252197
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.505859375 GB
    Memory Allocated: 0.6810426712036133  GigaBytes
Max Memory Allocated: 8.190763473510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7565574645996094
epoch time :  87.24859833717346
Total (block generation + training)time/epoch 85.22620589733124
pure train time/epoch 2.51847771803538

num_input_list  [4502618, 4350072, 4455706, 4468290, 4471984, 4584113, 4426300, 4438435, 4644180, 4503068]
