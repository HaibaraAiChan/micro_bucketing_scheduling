main start at this time 1700894336.69886
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
self._in_src_feats,  100
self._in_dst_feats 100
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.780 seconds, peak memory: 40.429 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.429 GB
Metis partitioning: 14.132 seconds, peak memory: 40.429 GB
Split the graph: 1.282 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  12.408628225326538
pure dgl.metis_partition the time spent:  18.212852239608765

block_gen_time in "generate_blocks_for_one_layer_block"  5.237378120422363


block_gen_time in "generate_blocks_for_one_layer_block"  17.382380962371826

connection checking time:  22.698009252548218
block generation total time  22.61975908279419
generate_dataloader_block spend   79.26077437400818
pure train time  3.63077712059021
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.890625 GB
    Memory Allocated: 0.6498618125915527  GigaBytes
Max Memory Allocated: 13.775617122650146  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.801708221435547
epoch time :  85.87628054618835
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.993 seconds, peak memory: 69.408 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.408 GB
Metis partitioning: 15.242 seconds, peak memory: 71.502 GB
Split the graph: 1.392 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  12.638513326644897
pure dgl.metis_partition the time spent:  19.64970850944519

block_gen_time in "generate_blocks_for_one_layer_block"  4.965513229370117


block_gen_time in "generate_blocks_for_one_layer_block"  15.289281129837036

connection checking time:  21.92701292037964
block generation total time  20.254794359207153
generate_dataloader_block spend   78.40304851531982
pure train time  2.613246202468872
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.91015625 GB
    Memory Allocated: 0.6402740478515625  GigaBytes
Max Memory Allocated: 13.775617122650146  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.796902656555176
epoch time :  83.98021292686462
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.324 seconds, peak memory: 74.852 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.852 GB
Metis partitioning: 16.566 seconds, peak memory: 74.852 GB
Split the graph: 2.142 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  12.920557260513306
pure dgl.metis_partition the time spent:  22.05563449859619

block_gen_time in "generate_blocks_for_one_layer_block"  5.047122478485107


block_gen_time in "generate_blocks_for_one_layer_block"  16.34298610687256

connection checking time:  22.290329933166504
block generation total time  21.390108585357666
generate_dataloader_block spend   82.55447602272034
pure train time  3.2008917331695557
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.263671875 GB
    Memory Allocated: 0.6554388999938965  GigaBytes
Max Memory Allocated: 14.019371032714844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.792043685913086
epoch time :  88.73911166191101
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.158 seconds, peak memory: 79.276 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 79.276 GB
Metis partitioning: 16.415 seconds, peak memory: 79.276 GB
Split the graph: 1.391 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  11.428767204284668
pure dgl.metis_partition the time spent:  20.985466957092285

block_gen_time in "generate_blocks_for_one_layer_block"  4.976401329040527


block_gen_time in "generate_blocks_for_one_layer_block"  15.057101488113403

connection checking time:  21.935425758361816
block generation total time  20.03350281715393
generate_dataloader_block spend   78.31750273704529
pure train time  3.208652973175049
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.58984375 GB
    Memory Allocated: 0.6603717803955078  GigaBytes
Max Memory Allocated: 14.591249942779541  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.787112236022949
epoch time :  84.32702279090881
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.332 seconds, peak memory: 83.117 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 83.117 GB
Metis partitioning: 15.951 seconds, peak memory: 83.117 GB
Split the graph: 1.620 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  13.289858341217041
pure dgl.metis_partition the time spent:  20.927982330322266

block_gen_time in "generate_blocks_for_one_layer_block"  4.924092054367065


block_gen_time in "generate_blocks_for_one_layer_block"  15.485860109329224

connection checking time:  21.832356691360474
block generation total time  20.40995216369629
generate_dataloader_block spend   80.26082181930542
pure train time  3.044449806213379
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.4375 GB
    Memory Allocated: 0.6362595558166504  GigaBytes
Max Memory Allocated: 14.591249942779541  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7821154594421387
epoch time :  86.19416975975037
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.391 seconds, peak memory: 83.775 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 83.775 GB
Metis partitioning: 17.079 seconds, peak memory: 83.775 GB
Split the graph: 1.652 seconds
Construct subgraphs: 0.031 seconds
REG metis partition end ----................................
REG construction  time spent:  12.924116373062134
pure dgl.metis_partition the time spent:  22.15489959716797

block_gen_time in "generate_blocks_for_one_layer_block"  4.995426654815674


block_gen_time in "generate_blocks_for_one_layer_block"  16.521563291549683

connection checking time:  22.17382836341858
block generation total time  21.516989946365356
generate_dataloader_block spend   82.76207685470581
pure train time  2.966066837310791
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.44921875 GB
    Memory Allocated: 0.6836910247802734  GigaBytes
Max Memory Allocated: 14.591249942779541  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7770233154296875
epoch time :  88.60944557189941
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.076 seconds, peak memory: 83.775 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 83.775 GB
Metis partitioning: 16.769 seconds, peak memory: 83.775 GB
Split the graph: 1.495 seconds
Construct subgraphs: 0.030 seconds
REG metis partition end ----................................
REG construction  time spent:  12.667400598526001
pure dgl.metis_partition the time spent:  21.372034788131714

block_gen_time in "generate_blocks_for_one_layer_block"  4.427178144454956


block_gen_time in "generate_blocks_for_one_layer_block"  15.544260501861572

connection checking time:  21.79139232635498
block generation total time  19.97143864631653
generate_dataloader_block spend   79.56875443458557
pure train time  2.958487033843994
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.46484375 GB
    Memory Allocated: 0.6587080955505371  GigaBytes
Max Memory Allocated: 14.591249942779541  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.771799087524414
epoch time :  85.36071491241455
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.534 seconds, peak memory: 83.775 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 83.775 GB
Metis partitioning: 16.794 seconds, peak memory: 83.775 GB
Split the graph: 1.540 seconds
Construct subgraphs: 0.026 seconds
REG metis partition end ----................................
REG construction  time spent:  13.049541711807251
pure dgl.metis_partition the time spent:  21.89733052253723

block_gen_time in "generate_blocks_for_one_layer_block"  5.012836694717407


block_gen_time in "generate_blocks_for_one_layer_block"  16.116071224212646

connection checking time:  22.105684995651245
block generation total time  21.128907918930054
generate_dataloader_block spend   81.93845462799072
pure train time  2.963669776916504
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.603515625 GB
    Memory Allocated: 0.662203311920166  GigaBytes
Max Memory Allocated: 14.631112098693848  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7664794921875
epoch time :  87.80064368247986
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.268 seconds, peak memory: 84.603 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.603 GB
Metis partitioning: 16.646 seconds, peak memory: 84.603 GB
Split the graph: 1.596 seconds
Construct subgraphs: 0.030 seconds
REG metis partition end ----................................
REG construction  time spent:  12.664371967315674
pure dgl.metis_partition the time spent:  21.541041374206543

block_gen_time in "generate_blocks_for_one_layer_block"  4.988554239273071


block_gen_time in "generate_blocks_for_one_layer_block"  15.763338327407837

connection checking time:  22.538155794143677
block generation total time  20.751892566680908
generate_dataloader_block spend   81.34761309623718
pure train time  2.989706516265869
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.603515625 GB
    Memory Allocated: 0.6903290748596191  GigaBytes
Max Memory Allocated: 14.631112098693848  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.760986328125
epoch time :  87.27874159812927
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.124 seconds, peak memory: 85.047 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 85.047 GB
Metis partitioning: 17.022 seconds, peak memory: 85.047 GB
Split the graph: 1.905 seconds
Construct subgraphs: 0.036 seconds
REG metis partition end ----................................
REG construction  time spent:  12.732854127883911
pure dgl.metis_partition the time spent:  22.089215517044067

block_gen_time in "generate_blocks_for_one_layer_block"  5.051070690155029


block_gen_time in "generate_blocks_for_one_layer_block"  15.311768293380737

connection checking time:  22.18511152267456
block generation total time  20.362838983535767
generate_dataloader_block spend   81.35072708129883
pure train time  2.9514758586883545
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.603515625 GB
    Memory Allocated: 0.6806364059448242  GigaBytes
Max Memory Allocated: 14.631112098693848  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.755312204360962
epoch time :  87.16644287109375
Total (block generation + training)time/epoch 86.5332777261734
pure train time/epoch 2.9789759715398154

num_input_list  [4502618, 4350072, 4455706, 4468290, 4471984, 4503771, 4426300, 4420704, 4644180, 4503068]
