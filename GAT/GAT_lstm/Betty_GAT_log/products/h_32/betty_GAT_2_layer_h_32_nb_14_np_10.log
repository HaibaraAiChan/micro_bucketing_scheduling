main start at this time 1700895230.394209
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
self._in_src_feats,  100
self._in_dst_feats 100
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.895 seconds, peak memory: 40.429 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.429 GB
Metis partitioning: 14.614 seconds, peak memory: 40.429 GB
Split the graph: 1.263 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  12.162791967391968
pure dgl.metis_partition the time spent:  18.792319774627686

block_gen_time in "generate_blocks_for_one_layer_block"  5.046288728713989


block_gen_time in "generate_blocks_for_one_layer_block"  16.09882378578186

connection checking time:  22.82821488380432
block generation total time  21.14511251449585
generate_dataloader_block spend   78.67456912994385
pure train time  3.8570024967193604
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.51171875 GB
    Memory Allocated: 0.6759967803955078  GigaBytes
Max Memory Allocated: 12.361268997192383  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.8017146587371826
epoch time :  85.53972363471985
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.093 seconds, peak memory: 68.804 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 68.804 GB
Metis partitioning: 14.947 seconds, peak memory: 69.586 GB
Split the graph: 1.151 seconds
Construct subgraphs: 0.028 seconds
REG metis partition end ----................................
REG construction  time spent:  12.315382719039917
pure dgl.metis_partition the time spent:  19.22063970565796

block_gen_time in "generate_blocks_for_one_layer_block"  2.949597120285034


block_gen_time in "generate_blocks_for_one_layer_block"  16.523200273513794

connection checking time:  17.96085023880005
block generation total time  19.472797393798828
generate_dataloader_block spend   72.10044479370117
pure train time  3.337263584136963
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.51171875 GB
    Memory Allocated: 0.6477522850036621  GigaBytes
Max Memory Allocated: 12.361268997192383  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7969257831573486
epoch time :  78.55860304832458
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.374 seconds, peak memory: 72.441 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.441 GB
Metis partitioning: 15.904 seconds, peak memory: 72.441 GB
Split the graph: 1.226 seconds
Construct subgraphs: 0.026 seconds
REG metis partition end ----................................
REG construction  time spent:  12.95678186416626
pure dgl.metis_partition the time spent:  20.532506227493286

block_gen_time in "generate_blocks_for_one_layer_block"  4.926964282989502


block_gen_time in "generate_blocks_for_one_layer_block"  15.109161615371704

connection checking time:  22.350393533706665
block generation total time  20.036125898361206
generate_dataloader_block spend   79.69907855987549
pure train time  3.288719415664673
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.4921875 GB
    Memory Allocated: 0.651665210723877  GigaBytes
Max Memory Allocated: 12.361268997192383  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7920405864715576
epoch time :  85.97256016731262
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.123 seconds, peak memory: 76.287 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 76.287 GB
Metis partitioning: 17.012 seconds, peak memory: 76.287 GB
Split the graph: 1.459 seconds
Construct subgraphs: 0.044 seconds
REG metis partition end ----................................
REG construction  time spent:  13.171735525131226
pure dgl.metis_partition the time spent:  21.63993501663208

block_gen_time in "generate_blocks_for_one_layer_block"  3.305497884750366


block_gen_time in "generate_blocks_for_one_layer_block"  8.521100282669067

connection checking time:  14.222339868545532
block generation total time  11.826598167419434
generate_dataloader_block spend   64.012291431427
pure train time  2.918992280960083
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.478515625 GB
    Memory Allocated: 0.643587589263916  GigaBytes
Max Memory Allocated: 12.456403732299805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7871155738830566
epoch time :  69.83498525619507
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.129 seconds, peak memory: 79.900 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 79.900 GB
Metis partitioning: 17.091 seconds, peak memory: 79.900 GB
Split the graph: 1.410 seconds
Construct subgraphs: 0.031 seconds
REG metis partition end ----................................
REG construction  time spent:  8.697182178497314
pure dgl.metis_partition the time spent:  21.662781476974487

block_gen_time in "generate_blocks_for_one_layer_block"  4.929537296295166


block_gen_time in "generate_blocks_for_one_layer_block"  15.90756106376648

connection checking time:  22.70729422569275
block generation total time  20.837098360061646
generate_dataloader_block spend   77.78414392471313
pure train time  3.5372867584228516
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.568359375 GB
    Memory Allocated: 0.6054210662841797  GigaBytes
Max Memory Allocated: 12.948877811431885  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7821125984191895
epoch time :  84.33354806900024
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.753 seconds, peak memory: 80.883 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.883 GB
Metis partitioning: 16.095 seconds, peak memory: 80.883 GB
Split the graph: 1.327 seconds
Construct subgraphs: 0.031 seconds
REG metis partition end ----................................
REG construction  time spent:  12.806792497634888
pure dgl.metis_partition the time spent:  20.208080530166626

block_gen_time in "generate_blocks_for_one_layer_block"  4.971516847610474


block_gen_time in "generate_blocks_for_one_layer_block"  16.033897638320923

connection checking time:  22.709205389022827
block generation total time  21.005414485931396
generate_dataloader_block spend   80.58380937576294
pure train time  3.1603031158447266
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.58984375 GB
    Memory Allocated: 0.6906375885009766  GigaBytes
Max Memory Allocated: 12.948877811431885  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7770416736602783
epoch time :  86.77953767776489
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.107 seconds, peak memory: 80.883 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.883 GB
Metis partitioning: 17.494 seconds, peak memory: 80.883 GB
Split the graph: 1.768 seconds
Construct subgraphs: 0.030 seconds
REG metis partition end ----................................
REG construction  time spent:  9.879202604293823
pure dgl.metis_partition the time spent:  22.401274919509888

block_gen_time in "generate_blocks_for_one_layer_block"  4.941761493682861


block_gen_time in "generate_blocks_for_one_layer_block"  15.96463680267334

connection checking time:  22.332284927368164
block generation total time  20.9063982963562
generate_dataloader_block spend   79.47396111488342
pure train time  3.255842447280884
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.6015625 GB
    Memory Allocated: 0.6373143196105957  GigaBytes
Max Memory Allocated: 12.948877811431885  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7718241214752197
epoch time :  85.66581988334656
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.395 seconds, peak memory: 80.883 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.883 GB
Metis partitioning: 17.311 seconds, peak memory: 80.883 GB
Split the graph: 1.746 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  12.662115812301636
pure dgl.metis_partition the time spent:  22.473591566085815

block_gen_time in "generate_blocks_for_one_layer_block"  4.796016693115234


block_gen_time in "generate_blocks_for_one_layer_block"  15.389566898345947

connection checking time:  22.50549292564392
block generation total time  20.18558359146118
generate_dataloader_block spend   81.69309973716736
pure train time  3.3423142433166504
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.6015625 GB
    Memory Allocated: 0.6869854927062988  GigaBytes
Max Memory Allocated: 12.948877811431885  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.766481637954712
epoch time :  87.96423244476318
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.967 seconds, peak memory: 80.883 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.883 GB
Metis partitioning: 17.502 seconds, peak memory: 80.883 GB
Split the graph: 1.503 seconds
Construct subgraphs: 0.027 seconds
REG metis partition end ----................................
REG construction  time spent:  12.727392196655273
pure dgl.metis_partition the time spent:  22.002309560775757

block_gen_time in "generate_blocks_for_one_layer_block"  5.345492124557495


block_gen_time in "generate_blocks_for_one_layer_block"  15.843590497970581

connection checking time:  22.684524059295654
block generation total time  21.189082622528076
generate_dataloader_block spend   82.66657304763794
pure train time  3.438960313796997
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.603515625 GB
    Memory Allocated: 0.6695671081542969  GigaBytes
Max Memory Allocated: 12.948877811431885  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.760998487472534
epoch time :  89.0316743850708
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.181 seconds, peak memory: 80.883 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.883 GB
Metis partitioning: 17.008 seconds, peak memory: 80.883 GB
Split the graph: 1.410 seconds
Construct subgraphs: 0.039 seconds
REG metis partition end ----................................
REG construction  time spent:  12.730469942092896
pure dgl.metis_partition the time spent:  21.63939332962036

block_gen_time in "generate_blocks_for_one_layer_block"  5.388453483581543


block_gen_time in "generate_blocks_for_one_layer_block"  15.201768636703491

connection checking time:  22.287468910217285
block generation total time  20.590222120285034
generate_dataloader_block spend   81.24657917022705
pure train time  3.4218738079071045
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.603515625 GB
    Memory Allocated: 0.6507611274719238  GigaBytes
Max Memory Allocated: 12.948877811431885  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.755323886871338
epoch time :  87.69918131828308
Total (block generation + training)time/epoch 84.1379830121994
pure train time/epoch 3.359430114428202

num_input_list  [4625821, 4721641, 4732444, 4777423, 4713228, 4834645, 4595785, 4805809, 4764674, 4699471]
