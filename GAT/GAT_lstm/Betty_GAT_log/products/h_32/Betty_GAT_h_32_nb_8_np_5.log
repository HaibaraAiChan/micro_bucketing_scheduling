WARNING:root:The OGB package is out of date. Your version is 1.3.5, while the latest version is 1.3.6.
main start at this time 1700885297.8102558
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
self._in_src_feats,  100
self._in_dst_feats 100
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.795 seconds, peak memory: 40.429 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.429 GB
[04:09:09] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 196571 nodes and 51627842 edges into 8 parts and get 4435724 edge cuts
Metis partitioning: 13.850 seconds, peak memory: 40.429 GB
Split the graph: 1.719 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  12.127601861953735
pure dgl.metis_partition the time spent:  18.383154153823853

block_gen_time in "generate_blocks_for_one_layer_block"  2.8812191486358643


block_gen_time in "generate_blocks_for_one_layer_block"  16.047431230545044

connection checking time:  21.809507846832275
block generation total time  18.928650379180908
generate_dataloader_block spend   74.86353898048401
pure train time  3.930928945541382
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.546875 GB
    Memory Allocated: 0.6931142807006836  GigaBytes
Max Memory Allocated: 19.2976336479187  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.8017256259918213
epoch time :  81.64512968063354
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.873 seconds, peak memory: 70.955 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.955 GB
[04:10:34] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 196571 nodes and 51574468 edges into 8 parts and get 4315138 edge cuts
Metis partitioning: 16.532 seconds, peak memory: 75.955 GB
Split the graph: 1.837 seconds
Construct subgraphs: 0.014 seconds
REG metis partition end ----................................
REG construction  time spent:  12.408238887786865
pure dgl.metis_partition the time spent:  21.259010076522827

block_gen_time in "generate_blocks_for_one_layer_block"  5.016780853271484


block_gen_time in "generate_blocks_for_one_layer_block"  14.883070945739746

connection checking time:  21.26213574409485
block generation total time  19.89985179901123
generate_dataloader_block spend   78.87178111076355
pure train time  2.453596830368042
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.64453125 GB
    Memory Allocated: 0.6603331565856934  GigaBytes
Max Memory Allocated: 19.2976336479187  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.796893358230591
epoch time :  84.02591228485107
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.105 seconds, peak memory: 80.102 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.102 GB
[04:11:59] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 196571 nodes and 51623546 edges into 8 parts and get 4349943 edge cuts
Metis partitioning: 16.310 seconds, peak memory: 80.102 GB
Split the graph: 1.942 seconds
Construct subgraphs: 0.042 seconds
REG metis partition end ----................................
REG construction  time spent:  12.771009922027588
pure dgl.metis_partition the time spent:  21.40178155899048

block_gen_time in "generate_blocks_for_one_layer_block"  4.8629045486450195


block_gen_time in "generate_blocks_for_one_layer_block"  15.544228315353394

connection checking time:  20.16486668586731
block generation total time  20.407132863998413
generate_dataloader_block spend   78.08715653419495
pure train time  2.425304412841797
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.654296875 GB
    Memory Allocated: 0.6733207702636719  GigaBytes
Max Memory Allocated: 19.2976336479187  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7920515537261963
epoch time :  83.3925895690918
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.255 seconds, peak memory: 82.644 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 82.644 GB
[04:13:23] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 196571 nodes and 51517742 edges into 8 parts and get 4220072 edge cuts
Metis partitioning: 17.134 seconds, peak memory: 82.644 GB
Split the graph: 1.961 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  12.583992958068848
pure dgl.metis_partition the time spent:  22.371731519699097

block_gen_time in "generate_blocks_for_one_layer_block"  4.897322177886963


block_gen_time in "generate_blocks_for_one_layer_block"  15.379773378372192

connection checking time:  21.197702646255493
block generation total time  20.277095556259155
generate_dataloader_block spend   80.39204597473145
pure train time  2.4270710945129395
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.654296875 GB
    Memory Allocated: 0.6930127143859863  GigaBytes
Max Memory Allocated: 19.2976336479187  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7871296405792236
epoch time :  85.70861411094666
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.292 seconds, peak memory: 84.090 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.090 GB
[04:14:49] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 196571 nodes and 51616002 edges into 8 parts and get 4494692 edge cuts
Metis partitioning: 17.585 seconds, peak memory: 84.090 GB
Split the graph: 1.788 seconds
Construct subgraphs: 0.042 seconds
REG metis partition end ----................................
REG construction  time spent:  12.670005559921265
pure dgl.metis_partition the time spent:  22.70834517478943

block_gen_time in "generate_blocks_for_one_layer_block"  4.837879419326782


block_gen_time in "generate_blocks_for_one_layer_block"  15.59894323348999

connection checking time:  21.214046716690063
block generation total time  20.436822652816772
generate_dataloader_block spend   81.06606149673462
pure train time  2.464184284210205
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.65625 GB
    Memory Allocated: 0.6832609176635742  GigaBytes
Max Memory Allocated: 19.2976336479187  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7821271419525146
epoch time :  86.51716923713684