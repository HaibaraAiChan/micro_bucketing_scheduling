main start at this time 1700896100.6359966
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
self._in_src_feats,  100
self._in_dst_feats 100
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.583 seconds, peak memory: 40.456 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.456 GB
Metis partitioning: 14.414 seconds, peak memory: 40.456 GB
Split the graph: 1.130 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  12.573132753372192
pure dgl.metis_partition the time spent:  18.146454572677612

block_gen_time in "generate_blocks_for_one_layer_block"  5.160027027130127


block_gen_time in "generate_blocks_for_one_layer_block"  16.713050365447998

connection checking time:  23.690433263778687
block generation total time  21.873077392578125
generate_dataloader_block spend   79.52767086029053
pure train time  4.316619396209717
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.298828125 GB
    Memory Allocated: 0.6964459419250488  GigaBytes
Max Memory Allocated: 11.151762962341309  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.801725149154663
epoch time :  86.97229385375977
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.887 seconds, peak memory: 69.305 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.305 GB
Metis partitioning: 15.787 seconds, peak memory: 69.305 GB
Split the graph: 1.474 seconds
Construct subgraphs: 0.722 seconds
REG metis partition end ----................................
REG construction  time spent:  12.266449928283691
pure dgl.metis_partition the time spent:  20.872177362442017

block_gen_time in "generate_blocks_for_one_layer_block"  4.874282360076904


block_gen_time in "generate_blocks_for_one_layer_block"  16.52866244316101

connection checking time:  22.8701171875
block generation total time  21.402944803237915
generate_dataloader_block spend   81.03662490844727
pure train time  3.7620861530303955
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.306640625 GB
    Memory Allocated: 0.7183423042297363  GigaBytes
Max Memory Allocated: 11.151762962341309  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7968809604644775
epoch time :  87.92461109161377
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.115 seconds, peak memory: 69.332 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.332 GB
Metis partitioning: 17.682 seconds, peak memory: 69.332 GB
Split the graph: 1.710 seconds
Construct subgraphs: 0.024 seconds
REG metis partition end ----................................
REG construction  time spent:  13.219804048538208
pure dgl.metis_partition the time spent:  22.534111261367798

block_gen_time in "generate_blocks_for_one_layer_block"  4.934147596359253


block_gen_time in "generate_blocks_for_one_layer_block"  17.115272998809814

connection checking time:  24.081698179244995
block generation total time  22.049420595169067
generate_dataloader_block spend   86.36733150482178
pure train time  3.5912137031555176
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.306640625 GB
    Memory Allocated: 0.7007675170898438  GigaBytes
Max Memory Allocated: 11.5357027053833  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.792046546936035
epoch time :  93.12897777557373
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.095 seconds, peak memory: 74.459 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.459 GB
Metis partitioning: 16.267 seconds, peak memory: 74.459 GB
Split the graph: 1.419 seconds
Construct subgraphs: 0.026 seconds
REG metis partition end ----................................
REG construction  time spent:  12.918131351470947
pure dgl.metis_partition the time spent:  20.808394193649292

block_gen_time in "generate_blocks_for_one_layer_block"  4.899159908294678


block_gen_time in "generate_blocks_for_one_layer_block"  16.445751190185547

connection checking time:  22.77216649055481
block generation total time  21.344911098480225
generate_dataloader_block spend   82.31571125984192
pure train time  3.777299404144287
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.306640625 GB
    Memory Allocated: 0.6257786750793457  GigaBytes
Max Memory Allocated: 11.5357027053833  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.787130355834961
epoch time :  89.06083822250366
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.056 seconds, peak memory: 75.801 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 75.801 GB
Metis partitioning: 16.149 seconds, peak memory: 75.801 GB
Split the graph: 1.509 seconds
Construct subgraphs: 0.024 seconds
REG metis partition end ----................................
REG construction  time spent:  12.673827409744263
pure dgl.metis_partition the time spent:  20.739499807357788

block_gen_time in "generate_blocks_for_one_layer_block"  4.930206537246704


block_gen_time in "generate_blocks_for_one_layer_block"  15.667516469955444

connection checking time:  22.84244465827942
block generation total time  20.59772300720215
generate_dataloader_block spend   81.16701292991638
pure train time  3.6742196083068848
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.306640625 GB
    Memory Allocated: 0.6915130615234375  GigaBytes
Max Memory Allocated: 11.5357027053833  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.782106399536133
epoch time :  88.00240874290466
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.140 seconds, peak memory: 76.973 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 76.973 GB
Metis partitioning: 16.580 seconds, peak memory: 76.973 GB
Split the graph: 1.727 seconds
Construct subgraphs: 0.030 seconds
REG metis partition end ----................................
REG construction  time spent:  12.941271305084229
pure dgl.metis_partition the time spent:  21.478770971298218

block_gen_time in "generate_blocks_for_one_layer_block"  4.892206430435181


block_gen_time in "generate_blocks_for_one_layer_block"  16.47354483604431

connection checking time:  23.231335878372192
block generation total time  21.365751266479492
generate_dataloader_block spend   83.37276244163513
pure train time  3.6748671531677246
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.451171875 GB
    Memory Allocated: 0.6600241661071777  GigaBytes
Max Memory Allocated: 11.811338424682617  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.777036428451538
epoch time :  90.10041165351868
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.045 seconds, peak memory: 80.654 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.654 GB
Metis partitioning: 16.612 seconds, peak memory: 80.654 GB
Split the graph: 1.486 seconds
Construct subgraphs: 0.032 seconds
REG metis partition end ----................................
REG construction  time spent:  12.6221342086792
pure dgl.metis_partition the time spent:  21.176859855651855

block_gen_time in "generate_blocks_for_one_layer_block"  4.889214038848877


block_gen_time in "generate_blocks_for_one_layer_block"  16.412431240081787

connection checking time:  23.333171367645264
block generation total time  21.301645278930664
generate_dataloader_block spend   82.77920007705688
pure train time  3.676565647125244
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.451171875 GB
    Memory Allocated: 0.6913766860961914  GigaBytes
Max Memory Allocated: 11.811338424682617  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.771827220916748
epoch time :  89.44582962989807
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 4.386 seconds, peak memory: 81.598 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 81.598 GB
Metis partitioning: 18.501 seconds, peak memory: 81.598 GB
Split the graph: 1.708 seconds
Construct subgraphs: 0.035 seconds
REG metis partition end ----................................
REG construction  time spent:  13.530441999435425
pure dgl.metis_partition the time spent:  24.631943225860596

block_gen_time in "generate_blocks_for_one_layer_block"  4.959740400314331


block_gen_time in "generate_blocks_for_one_layer_block"  16.965089559555054

connection checking time:  20.33992052078247
block generation total time  21.924829959869385
generate_dataloader_block spend   84.83909845352173
pure train time  3.6666128635406494
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.6915960311889648  GigaBytes
Max Memory Allocated: 11.811338424682617  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.766470193862915
epoch time :  91.40635323524475
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.582 seconds, peak memory: 81.692 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 81.692 GB
Metis partitioning: 17.500 seconds, peak memory: 81.692 GB
Split the graph: 1.229 seconds
Construct subgraphs: 0.026 seconds
REG metis partition end ----................................
REG construction  time spent:  12.799784898757935
pure dgl.metis_partition the time spent:  22.34076738357544

block_gen_time in "generate_blocks_for_one_layer_block"  4.897180080413818


block_gen_time in "generate_blocks_for_one_layer_block"  16.531773567199707

connection checking time:  23.367279529571533
block generation total time  21.428953647613525
generate_dataloader_block spend   84.28718757629395
pure train time  3.6685519218444824
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.7070188522338867  GigaBytes
Max Memory Allocated: 11.811338424682617  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7610034942626953
epoch time :  90.98339223861694
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.257 seconds, peak memory: 82.110 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 82.110 GB
Metis partitioning: 17.508 seconds, peak memory: 82.110 GB
Split the graph: 1.509 seconds
Construct subgraphs: 0.028 seconds
REG metis partition end ----................................
REG construction  time spent:  13.060137033462524
pure dgl.metis_partition the time spent:  22.304380178451538

block_gen_time in "generate_blocks_for_one_layer_block"  4.901997089385986


block_gen_time in "generate_blocks_for_one_layer_block"  16.875553607940674

connection checking time:  23.289915561676025
block generation total time  21.77755069732666
generate_dataloader_block spend   84.8624255657196
pure train time  3.6054420471191406
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.6760568618774414  GigaBytes
Max Memory Allocated: 11.811338424682617  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.755310535430908
epoch time :  91.44151091575623
Total (block generation + training)time/epoch 89.8466616153717
pure train time/epoch 3.6610432068506875

num_input_list  [4987175, 5002324, 5086811, 4899439, 4998485, 5086889, 5133226, 5018683, 5084048, 4971555]
