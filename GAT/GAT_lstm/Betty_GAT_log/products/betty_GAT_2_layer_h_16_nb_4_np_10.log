main start at this time 1700904578.4126728
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
self._in_src_feats,  100
self._in_dst_feats 100
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.650 seconds, peak memory: 40.401 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.401 GB
Metis partitioning: 13.279 seconds, peak memory: 40.401 GB
Split the graph: 3.174 seconds
Construct subgraphs: 0.011 seconds
REG metis partition end ----................................
REG construction  time spent:  12.48961853981018
pure dgl.metis_partition the time spent:  19.115695238113403

block_gen_time in "generate_blocks_for_one_layer_block"  5.108857870101929


block_gen_time in "generate_blocks_for_one_layer_block"  15.991220951080322

connection checking time:  19.257185459136963
block generation total time  21.10007882118225
generate_dataloader_block spend   75.73322224617004
pure train time  2.0884742736816406
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.07421875 GB
    Memory Allocated: 0.802332878112793  GigaBytes
Max Memory Allocated: 19.314600467681885  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.801818370819092
epoch time :  79.80298900604248
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.291 seconds, peak memory: 69.380 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.380 GB
Metis partitioning: 15.189 seconds, peak memory: 73.814 GB
Split the graph: 3.327 seconds
Construct subgraphs: 0.011 seconds
REG metis partition end ----................................
REG construction  time spent:  12.845401525497437
pure dgl.metis_partition the time spent:  21.822957038879395

block_gen_time in "generate_blocks_for_one_layer_block"  4.882849931716919


block_gen_time in "generate_blocks_for_one_layer_block"  14.666260480880737

connection checking time:  19.366005897521973
block generation total time  19.549110412597656
generate_dataloader_block spend   77.67239236831665
pure train time  1.4007551670074463
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.07421875 GB
    Memory Allocated: 0.741971492767334  GigaBytes
Max Memory Allocated: 19.314600467681885  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.797116994857788
epoch time :  80.85852313041687
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.355 seconds, peak memory: 74.258 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.258 GB
Metis partitioning: 15.742 seconds, peak memory: 74.258 GB
Split the graph: 3.554 seconds
Construct subgraphs: 0.005 seconds
REG metis partition end ----................................
REG construction  time spent:  12.67474627494812
pure dgl.metis_partition the time spent:  22.657593488693237

block_gen_time in "generate_blocks_for_one_layer_block"  4.9429802894592285


block_gen_time in "generate_blocks_for_one_layer_block"  16.079979181289673

connection checking time:  19.448959589004517
block generation total time  21.0229594707489
generate_dataloader_block spend   79.89156436920166
pure train time  1.6642882823944092
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.154296875 GB
    Memory Allocated: 0.7429647445678711  GigaBytes
Max Memory Allocated: 19.607215404510498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.792365312576294
epoch time :  83.31834816932678
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.952 seconds, peak memory: 74.578 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.578 GB
Metis partitioning: 14.580 seconds, peak memory: 74.578 GB
Split the graph: 3.395 seconds
Construct subgraphs: 0.010 seconds
REG metis partition end ----................................
REG construction  time spent:  12.630312204360962
pure dgl.metis_partition the time spent:  20.93877077102661

block_gen_time in "generate_blocks_for_one_layer_block"  5.117677450180054


block_gen_time in "generate_blocks_for_one_layer_block"  13.803926467895508

connection checking time:  18.981757402420044
block generation total time  18.92160391807556
generate_dataloader_block spend   75.43064999580383
pure train time  1.7404470443725586
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.11328125 GB
    Memory Allocated: 0.7131133079528809  GigaBytes
Max Memory Allocated: 19.607215404510498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7875449657440186
epoch time :  78.94826793670654
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.857 seconds, peak memory: 74.578 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.578 GB
Metis partitioning: 15.032 seconds, peak memory: 74.578 GB
Split the graph: 4.155 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  12.944977760314941
pure dgl.metis_partition the time spent:  22.061288833618164

block_gen_time in "generate_blocks_for_one_layer_block"  4.925509452819824


block_gen_time in "generate_blocks_for_one_layer_block"  14.365386009216309

connection checking time:  18.939302444458008
block generation total time  19.290895462036133
generate_dataloader_block spend   77.3385374546051
pure train time  1.3842246532440186
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.21484375 GB
    Memory Allocated: 0.7302942276000977  GigaBytes
Max Memory Allocated: 19.607215404510498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7826483249664307
epoch time :  80.40540194511414
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.452 seconds, peak memory: 74.781 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.781 GB
Metis partitioning: 14.599 seconds, peak memory: 74.781 GB
Split the graph: 3.931 seconds
Construct subgraphs: 0.034 seconds
REG metis partition end ----................................
REG construction  time spent:  12.350005626678467
pure dgl.metis_partition the time spent:  21.01705241203308

block_gen_time in "generate_blocks_for_one_layer_block"  4.872259855270386


block_gen_time in "generate_blocks_for_one_layer_block"  14.573915958404541

connection checking time:  19.574284553527832
block generation total time  19.446175813674927
generate_dataloader_block spend   76.22974801063538
pure train time  1.351048231124878
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.21484375 GB
    Memory Allocated: 0.7348146438598633  GigaBytes
Max Memory Allocated: 19.607215404510498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.777663230895996
epoch time :  79.48118901252747
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.152 seconds, peak memory: 74.781 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.781 GB
Metis partitioning: 14.871 seconds, peak memory: 74.781 GB
Split the graph: 3.189 seconds
Construct subgraphs: 0.011 seconds
REG metis partition end ----................................
REG construction  time spent:  12.404699087142944
pure dgl.metis_partition the time spent:  21.225980520248413

block_gen_time in "generate_blocks_for_one_layer_block"  4.915838956832886


block_gen_time in "generate_blocks_for_one_layer_block"  14.677486419677734

connection checking time:  19.42546510696411
block generation total time  19.59332537651062
generate_dataloader_block spend   76.68919110298157
pure train time  1.3755340576171875
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.21484375 GB
    Memory Allocated: 0.7354588508605957  GigaBytes
Max Memory Allocated: 19.607215404510498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.772571086883545
epoch time :  79.90084266662598
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.010 seconds, peak memory: 74.781 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.781 GB
Metis partitioning: 15.565 seconds, peak memory: 74.781 GB
Split the graph: 3.311 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  12.431281089782715
pure dgl.metis_partition the time spent:  21.9025719165802

block_gen_time in "generate_blocks_for_one_layer_block"  4.8615241050720215


block_gen_time in "generate_blocks_for_one_layer_block"  14.594779014587402

connection checking time:  19.124617099761963
block generation total time  19.456303119659424
generate_dataloader_block spend   76.85686302185059
pure train time  1.4378159046173096
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.93359375 GB
    Memory Allocated: 0.737332820892334  GigaBytes
Max Memory Allocated: 19.607215404510498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7673935890197754
epoch time :  80.05227875709534
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.197 seconds, peak memory: 75.073 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 75.073 GB
Metis partitioning: 14.947 seconds, peak memory: 75.073 GB
Split the graph: 3.199 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  12.388638496398926
pure dgl.metis_partition the time spent:  21.36215853691101

block_gen_time in "generate_blocks_for_one_layer_block"  4.963340759277344


block_gen_time in "generate_blocks_for_one_layer_block"  14.72055196762085

connection checking time:  18.92501926422119
block generation total time  19.683892726898193
generate_dataloader_block spend   76.28410983085632
pure train time  1.3737802505493164
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.068359375 GB
    Memory Allocated: 0.7818393707275391  GigaBytes
Max Memory Allocated: 19.607215404510498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7620632648468018
epoch time :  79.55765342712402
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.011 seconds, peak memory: 75.073 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 75.073 GB
Metis partitioning: 15.043 seconds, peak memory: 75.073 GB
Split the graph: 3.502 seconds
Construct subgraphs: 0.010 seconds
REG metis partition end ----................................
REG construction  time spent:  12.515374660491943
pure dgl.metis_partition the time spent:  21.56775689125061

block_gen_time in "generate_blocks_for_one_layer_block"  5.290600776672363


block_gen_time in "generate_blocks_for_one_layer_block"  14.3245370388031

connection checking time:  19.28860306739807
block generation total time  19.615137815475464
generate_dataloader_block spend   77.00244617462158
pure train time  1.359071969985962
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.068359375 GB
    Memory Allocated: 0.7604670524597168  GigaBytes
Max Memory Allocated: 19.607215404510498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7565600872039795
epoch time :  80.17667150497437
Total (block generation + training)time/epoch 80.25021555423737
pure train time/epoch 1.380245844523112

num_input_list  [3041715, 3053257, 3047944, 3110199, 2982051, 3048964, 3055359, 3047617, 3008063, 2957051]
