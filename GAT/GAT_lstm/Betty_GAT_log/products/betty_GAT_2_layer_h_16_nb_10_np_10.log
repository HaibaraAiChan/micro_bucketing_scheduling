main start at this time 1700907087.8987617
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
self._in_src_feats,  100
self._in_dst_feats 100
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.834 seconds, peak memory: 40.456 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 40.456 GB
Metis partitioning: 15.378 seconds, peak memory: 40.456 GB
Split the graph: 1.468 seconds
Construct subgraphs: 0.028 seconds
REG metis partition end ----................................
REG construction  time spent:  12.587952375411987
pure dgl.metis_partition the time spent:  19.711289405822754

block_gen_time in "generate_blocks_for_one_layer_block"  5.111245632171631


block_gen_time in "generate_blocks_for_one_layer_block"  15.890612125396729

connection checking time:  22.42121720314026
block generation total time  21.00185775756836
generate_dataloader_block spend   79.50198769569397
pure train time  2.746476888656616
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.73828125 GB
    Memory Allocated: 0.7009177207946777  GigaBytes
Max Memory Allocated: 8.967580795288086  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.801823139190674
epoch time :  84.42647814750671
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.046 seconds, peak memory: 56.506 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 56.506 GB
Metis partitioning: 15.136 seconds, peak memory: 61.506 GB
Split the graph: 1.877 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  12.508301019668579
pure dgl.metis_partition the time spent:  20.080748796463013

block_gen_time in "generate_blocks_for_one_layer_block"  4.895828008651733


block_gen_time in "generate_blocks_for_one_layer_block"  15.294764757156372

connection checking time:  21.639238357543945
block generation total time  20.190592765808105
generate_dataloader_block spend   78.39114713668823
pure train time  2.266284465789795
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.59375 GB
    Memory Allocated: 0.6752204895019531  GigaBytes
Max Memory Allocated: 9.087953567504883  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.797098159790039
epoch time :  82.64472723007202
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.165 seconds, peak memory: 68.928 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 68.928 GB
Metis partitioning: 15.654 seconds, peak memory: 68.928 GB
Split the graph: 1.576 seconds
Construct subgraphs: 0.032 seconds
REG metis partition end ----................................
REG construction  time spent:  12.763311862945557
pure dgl.metis_partition the time spent:  20.43009352684021

block_gen_time in "generate_blocks_for_one_layer_block"  4.984708309173584


block_gen_time in "generate_blocks_for_one_layer_block"  16.166980028152466

connection checking time:  21.752413511276245
block generation total time  21.15168833732605
generate_dataloader_block spend   80.14035749435425
pure train time  2.3067429065704346
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.595703125 GB
    Memory Allocated: 0.6521902084350586  GigaBytes
Max Memory Allocated: 9.154990673065186  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.792348623275757
epoch time :  84.43432903289795
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.562 seconds, peak memory: 75.889 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 75.889 GB
Metis partitioning: 15.835 seconds, peak memory: 75.889 GB
Split the graph: 1.372 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  12.850966453552246
pure dgl.metis_partition the time spent:  19.78813147544861

block_gen_time in "generate_blocks_for_one_layer_block"  5.021278619766235


block_gen_time in "generate_blocks_for_one_layer_block"  14.829795122146606

connection checking time:  21.52011513710022
block generation total time  19.851073741912842
generate_dataloader_block spend   78.08102226257324
pure train time  2.2925896644592285
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.595703125 GB
    Memory Allocated: 0.6550393104553223  GigaBytes
Max Memory Allocated: 9.154990673065186  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7875378131866455
epoch time :  82.23983359336853
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.318 seconds, peak memory: 77.644 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.644 GB
Metis partitioning: 16.193 seconds, peak memory: 77.644 GB
Split the graph: 1.574 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  12.912017822265625
pure dgl.metis_partition the time spent:  21.10926055908203

block_gen_time in "generate_blocks_for_one_layer_block"  4.989603757858276


block_gen_time in "generate_blocks_for_one_layer_block"  14.565664768218994

connection checking time:  21.11456322669983
block generation total time  19.55526852607727
generate_dataloader_block spend   78.65639066696167
pure train time  2.256655216217041
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.60546875 GB
    Memory Allocated: 0.6531705856323242  GigaBytes
Max Memory Allocated: 9.158626556396484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.782655715942383
epoch time :  82.83049726486206
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.137 seconds, peak memory: 78.394 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.394 GB
Metis partitioning: 16.416 seconds, peak memory: 78.394 GB
Split the graph: 2.105 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  12.862260580062866
pure dgl.metis_partition the time spent:  21.68295192718506

block_gen_time in "generate_blocks_for_one_layer_block"  4.960055351257324


block_gen_time in "generate_blocks_for_one_layer_block"  15.907485485076904

connection checking time:  21.891908884048462
block generation total time  20.86754083633423
generate_dataloader_block spend   81.27611541748047
pure train time  2.3059425354003906
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.60546875 GB
    Memory Allocated: 0.6762857437133789  GigaBytes
Max Memory Allocated: 9.158626556396484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7776620388031006
epoch time :  85.50049090385437
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 2.914 seconds, peak memory: 79.262 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 79.262 GB
Metis partitioning: 16.244 seconds, peak memory: 79.262 GB
Split the graph: 1.641 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  12.875334024429321
pure dgl.metis_partition the time spent:  20.823670387268066

block_gen_time in "generate_blocks_for_one_layer_block"  5.000386714935303


block_gen_time in "generate_blocks_for_one_layer_block"  14.91361665725708

connection checking time:  21.54243040084839
block generation total time  19.914003372192383
generate_dataloader_block spend   79.12251543998718
pure train time  2.2549471855163574
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.609375 GB
    Memory Allocated: 0.6566400527954102  GigaBytes
Max Memory Allocated: 9.218173503875732  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.772595167160034
epoch time :  83.307199716568
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.086 seconds, peak memory: 80.461 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.461 GB
Metis partitioning: 18.259 seconds, peak memory: 80.461 GB
Split the graph: 2.205 seconds
Construct subgraphs: 0.067 seconds
REG metis partition end ----................................
REG construction  time spent:  9.238981008529663
pure dgl.metis_partition the time spent:  23.61925506591797

block_gen_time in "generate_blocks_for_one_layer_block"  4.943991661071777


block_gen_time in "generate_blocks_for_one_layer_block"  15.848920345306396

connection checking time:  21.790235996246338
block generation total time  20.792912006378174
generate_dataloader_block spend   79.23787426948547
pure train time  2.2439725399017334
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.609375 GB
    Memory Allocated: 0.6805214881896973  GigaBytes
Max Memory Allocated: 9.24948263168335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7674002647399902
epoch time :  83.50318336486816
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.070 seconds, peak memory: 81.297 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 81.297 GB
Metis partitioning: 16.737 seconds, peak memory: 81.297 GB
Split the graph: 2.089 seconds
Construct subgraphs: 0.038 seconds
REG metis partition end ----................................
REG construction  time spent:  12.550908327102661
pure dgl.metis_partition the time spent:  21.934452772140503

block_gen_time in "generate_blocks_for_one_layer_block"  4.961761236190796


block_gen_time in "generate_blocks_for_one_layer_block"  16.073529958724976

connection checking time:  22.44733715057373
block generation total time  21.03529119491577
generate_dataloader_block spend   81.77863597869873
pure train time  2.2884950637817383
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 0.7015557289123535  GigaBytes
Max Memory Allocated: 9.603555679321289  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7620387077331543
epoch time :  85.96159029006958
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 3.026 seconds, peak memory: 83.072 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 83.072 GB
Metis partitioning: 16.226 seconds, peak memory: 83.072 GB
Split the graph: 1.781 seconds
Construct subgraphs: 0.034 seconds
REG metis partition end ----................................
REG construction  time spent:  13.258587837219238
pure dgl.metis_partition the time spent:  21.068641424179077

block_gen_time in "generate_blocks_for_one_layer_block"  5.587682485580444


block_gen_time in "generate_blocks_for_one_layer_block"  14.786849737167358

connection checking time:  22.03074884414673
block generation total time  20.374532222747803
generate_dataloader_block spend   80.72629523277283
pure train time  2.258157730102539
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 0.6392831802368164  GigaBytes
Max Memory Allocated: 9.603555679321289  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7565536499023438
epoch time :  84.95454144477844
Total (block generation + training)time/epoch 83.98028635978699
pure train time/epoch 2.2680283784866333

num_input_list  [4385419, 4245981, 4248605, 4293577, 4183432, 4267026, 4295638, 4229585, 4412675, 4232087]
