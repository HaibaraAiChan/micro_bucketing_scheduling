WARNING:root:The OGB package is out of date. Your version is 1.3.5, while the latest version is 1.3.6.
main start at this time 1700869457.7289922
  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
self._in_src_feats,  500
self._in_dst_feats 500
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.200 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.200 GB
[23:44:29] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 60 nodes and 4 edges into 8 parts and get 2 edge cuts
Metis partitioning: 0.000 seconds, peak memory: 24.200 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007279634475708008
pure dgl.metis_partition the time spent:  0.0056722164154052734

block_gen_time in "generate_blocks_for_one_layer_block"  0.013583183288574219


block_gen_time in "generate_blocks_for_one_layer_block"  0.013883590698242188

connection checking time:  0.03037858009338379
block generation total time  0.027466773986816406
generate_dataloader_block spend   0.10575604438781738
pure train time  1.0879297256469727
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.865234375 GB
    Memory Allocated: 2.031787872314453  GigaBytes
Max Memory Allocated: 3.031787872314453  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1017829179763794
epoch time :  3.1331140995025635
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.149 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.149 GB
[23:44:32] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 60 nodes and 6 edges into 8 parts and get 0 edge cuts
Metis partitioning: 0.000 seconds, peak memory: 27.149 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00417017936706543
pure dgl.metis_partition the time spent:  0.004153013229370117

block_gen_time in "generate_blocks_for_one_layer_block"  0.011623144149780273


block_gen_time in "generate_blocks_for_one_layer_block"  0.013295650482177734

connection checking time:  0.02691054344177246
block generation total time  0.024918794631958008
generate_dataloader_block spend   0.08997511863708496
pure train time  0.7497467994689941
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.865234375 GB
    Memory Allocated: 2.031984329223633  GigaBytes
Max Memory Allocated: 3.122199535369873  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.10101318359375
epoch time :  2.4265475273132324
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.149 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.149 GB
[23:44:34] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 60 nodes and 4 edges into 8 parts and get 0 edge cuts
Metis partitioning: 0.000 seconds, peak memory: 27.149 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0041086673736572266
pure dgl.metis_partition the time spent:  0.004405498504638672

block_gen_time in "generate_blocks_for_one_layer_block"  0.011670827865600586


block_gen_time in "generate_blocks_for_one_layer_block"  0.013530969619750977

connection checking time:  0.023384571075439453
block generation total time  0.025201797485351562
generate_dataloader_block spend   0.0920100212097168
pure train time  0.7150077819824219
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.865234375 GB
    Memory Allocated: 2.0321569442749023  GigaBytes
Max Memory Allocated: 3.1374964714050293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0937975645065308
epoch time :  2.304347515106201
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.149 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.149 GB
[23:44:37] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 60 nodes and 6 edges into 8 parts and get 0 edge cuts
Metis partitioning: 0.000 seconds, peak memory: 27.149 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004101991653442383
pure dgl.metis_partition the time spent:  0.004049777984619141

block_gen_time in "generate_blocks_for_one_layer_block"  0.011589288711547852


block_gen_time in "generate_blocks_for_one_layer_block"  0.013401031494140625

connection checking time:  0.030100584030151367
block generation total time  0.024990320205688477
generate_dataloader_block spend   0.09418153762817383
pure train time  0.7499096393585205
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.865234375 GB
    Memory Allocated: 2.0320229530334473  GigaBytes
Max Memory Allocated: 3.1374964714050293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.101967215538025
epoch time :  2.366281032562256
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.149 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.149 GB
[23:44:39] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 60 nodes and 6 edges into 8 parts and get 0 edge cuts
Metis partitioning: 0.000 seconds, peak memory: 27.149 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004076719284057617
pure dgl.metis_partition the time spent:  0.004038810729980469

block_gen_time in "generate_blocks_for_one_layer_block"  0.011790990829467773


block_gen_time in "generate_blocks_for_one_layer_block"  0.013512134552001953

connection checking time:  0.0340580940246582
block generation total time  0.025303125381469727
generate_dataloader_block spend   0.09299612045288086
pure train time  0.6621630191802979
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.865234375 GB
    Memory Allocated: 2.0317587852478027  GigaBytes
Max Memory Allocated: 3.1405582427978516  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0988504886627197
epoch time :  2.1726229190826416
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.149 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.149 GB
[23:44:41] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 60 nodes and 6 edges into 8 parts and get 0 edge cuts
Metis partitioning: 0.000 seconds, peak memory: 27.149 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0041255950927734375
pure dgl.metis_partition the time spent:  0.004138469696044922

block_gen_time in "generate_blocks_for_one_layer_block"  0.011671781539916992


block_gen_time in "generate_blocks_for_one_layer_block"  0.013523101806640625

connection checking time:  0.02605414390563965
block generation total time  0.025194883346557617
generate_dataloader_block spend   0.09502243995666504
pure train time  0.7118511199951172
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.865234375 GB
    Memory Allocated: 2.031740188598633  GigaBytes
Max Memory Allocated: 3.1437482833862305  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0998997688293457
epoch time :  2.2801284790039062