main start at this time 1700865934.963203
  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

in feats:  500
self._in_src_feats,  500
self._in_dst_feats 500
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.137 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.137 GB
Metis partitioning: 0.000 seconds, peak memory: 24.137 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005585432052612305
pure dgl.metis_partition the time spent:  0.0032775402069091797

block_gen_time in "generate_blocks_for_one_layer_block"  0.00405430793762207


block_gen_time in "generate_blocks_for_one_layer_block"  0.0049707889556884766

connection checking time:  0.007390260696411133
block generation total time  0.009025096893310547
generate_dataloader_block spend   0.030165433883666992
pure train time  0.6533217430114746
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.908203125 GB
    Memory Allocated: 2.03298282623291  GigaBytes
Max Memory Allocated: 3.03298282623291  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1022956371307373
epoch time :  1.6565444469451904
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.273 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.273 GB
Metis partitioning: 0.000 seconds, peak memory: 27.273 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0042591094970703125
pure dgl.metis_partition the time spent:  0.001837015151977539

block_gen_time in "generate_blocks_for_one_layer_block"  0.003432035446166992


block_gen_time in "generate_blocks_for_one_layer_block"  0.004786014556884766

connection checking time:  0.005089759826660156
block generation total time  0.008218050003051758
generate_dataloader_block spend   0.022966861724853516
pure train time  0.2980673313140869
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.908203125 GB
    Memory Allocated: 2.03298282623291  GigaBytes
Max Memory Allocated: 3.3064770698547363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1004951000213623
epoch time :  0.8552508354187012
Total (block generation + training)time/epoch 1.255897045135498
pure train time/epoch nan

num_input_list  [1624, 1650]
