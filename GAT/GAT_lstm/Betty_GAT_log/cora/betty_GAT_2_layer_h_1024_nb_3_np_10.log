main start at this time 1700860452.1109297
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
self._in_src_feats,  1433
self._in_dst_feats 1433
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.090 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.090 GB
Metis partitioning: 0.000 seconds, peak memory: 24.090 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009949445724487305
pure dgl.metis_partition the time spent:  0.004225254058837891

block_gen_time in "generate_blocks_for_one_layer_block"  0.005446910858154297


block_gen_time in "generate_blocks_for_one_layer_block"  0.006749629974365234

connection checking time:  0.009385824203491211
block generation total time  0.012196540832519531
pure train time  0.7328753471374512
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.130859375 GB
    Memory Allocated: 2.0919461250305176  GigaBytes
Max Memory Allocated: 3.0919461250305176  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9524335861206055
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.383 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.383 GB
Metis partitioning: 0.000 seconds, peak memory: 27.383 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0051877498626708984
pure dgl.metis_partition the time spent:  0.002675294876098633

block_gen_time in "generate_blocks_for_one_layer_block"  0.005322694778442383


block_gen_time in "generate_blocks_for_one_layer_block"  0.006773471832275391

connection checking time:  0.006755352020263672
block generation total time  0.012096166610717773
pure train time  0.3821837902069092
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.130859375 GB
    Memory Allocated: 2.0914182662963867  GigaBytes
Max Memory Allocated: 3.3602237701416016  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9521986246109009
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.383 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.383 GB
Metis partitioning: 0.000 seconds, peak memory: 27.383 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005129337310791016
pure dgl.metis_partition the time spent:  0.002655506134033203

block_gen_time in "generate_blocks_for_one_layer_block"  0.005034446716308594


block_gen_time in "generate_blocks_for_one_layer_block"  0.006812572479248047

connection checking time:  0.006806373596191406
block generation total time  0.01184701919555664
pure train time  0.4057731628417969
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.1328125 GB
    Memory Allocated: 2.091716766357422  GigaBytes
Max Memory Allocated: 3.3602237701416016  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9515554904937744
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.383 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.383 GB
Metis partitioning: 0.000 seconds, peak memory: 27.383 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005033016204833984
pure dgl.metis_partition the time spent:  0.002713918685913086

block_gen_time in "generate_blocks_for_one_layer_block"  0.005369663238525391


block_gen_time in "generate_blocks_for_one_layer_block"  0.0067903995513916016

connection checking time:  0.006838798522949219
block generation total time  0.012160062789916992
generate_dataloader_block spend   0.030663490295410156
pure train time  0.4005248546600342
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.1328125 GB
    Memory Allocated: 2.091642379760742  GigaBytes
Max Memory Allocated: 3.3602237701416016  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.952758550643921
epoch time :  1.1930699348449707
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.383 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.383 GB
Metis partitioning: 0.000 seconds, peak memory: 27.383 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005017995834350586
pure dgl.metis_partition the time spent:  0.0026438236236572266

block_gen_time in "generate_blocks_for_one_layer_block"  0.005017995834350586


block_gen_time in "generate_blocks_for_one_layer_block"  0.006778717041015625

connection checking time:  0.0068585872650146484
block generation total time  0.011796712875366211
generate_dataloader_block spend   0.03018927574157715
pure train time  0.41455817222595215
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.134765625 GB
    Memory Allocated: 2.0910873413085938  GigaBytes
Max Memory Allocated: 3.3804574012756348  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9516788721084595
epoch time :  1.2075116634368896
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.383 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.383 GB
Metis partitioning: 0.000 seconds, peak memory: 27.383 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005078792572021484
pure dgl.metis_partition the time spent:  0.0025539398193359375

block_gen_time in "generate_blocks_for_one_layer_block"  0.005056858062744141


block_gen_time in "generate_blocks_for_one_layer_block"  0.00719761848449707

connection checking time:  0.006770610809326172
block generation total time  0.012254476547241211
generate_dataloader_block spend   0.03051304817199707
pure train time  0.39110589027404785
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.134765625 GB
    Memory Allocated: 2.091658115386963  GigaBytes
Max Memory Allocated: 3.3804574012756348  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.951517105102539
epoch time :  1.1852304935455322
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.383 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.383 GB
Metis partitioning: 0.000 seconds, peak memory: 27.383 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005022525787353516
pure dgl.metis_partition the time spent:  0.002559185028076172

block_gen_time in "generate_blocks_for_one_layer_block"  0.0050280094146728516


block_gen_time in "generate_blocks_for_one_layer_block"  0.006739139556884766

connection checking time:  0.006659269332885742
block generation total time  0.011767148971557617