main start at this time 1700860293.7300289
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
self._in_src_feats,  1433
self._in_dst_feats 1433
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.090 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.090 GB
Metis partitioning: 0.001 seconds, peak memory: 24.090 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.011147737503051758
pure dgl.metis_partition the time spent:  0.0059130191802978516

block_gen_time in "generate_blocks_for_one_layer_block"  0.010889291763305664


block_gen_time in "generate_blocks_for_one_layer_block"  0.011219501495361328

connection checking time:  0.011312007904052734
block generation total time  0.022108793258666992
pure train time  1.039945363998413
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.974609375 GB
    Memory Allocated: 2.090268135070801  GigaBytes
Max Memory Allocated: 3.090268135070801  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9525940418243408
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005103588104248047
pure dgl.metis_partition the time spent:  0.004106044769287109

block_gen_time in "generate_blocks_for_one_layer_block"  0.009304523468017578


block_gen_time in "generate_blocks_for_one_layer_block"  0.011259794235229492

connection checking time:  0.009352684020996094
block generation total time  0.02056431770324707
pure train time  0.7016830444335938
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.974609375 GB
    Memory Allocated: 2.0899930000305176  GigaBytes
Max Memory Allocated: 3.241901397705078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9511969089508057
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0049953460693359375
pure dgl.metis_partition the time spent:  0.003828763961791992

block_gen_time in "generate_blocks_for_one_layer_block"  0.009527444839477539


block_gen_time in "generate_blocks_for_one_layer_block"  0.011041879653930664

connection checking time:  0.00942850112915039
block generation total time  0.020569324493408203
pure train time  0.7080845832824707
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.974609375 GB
    Memory Allocated: 2.090268135070801  GigaBytes
Max Memory Allocated: 3.29097318649292  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9511538743972778
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005008220672607422
pure dgl.metis_partition the time spent:  0.003693103790283203

block_gen_time in "generate_blocks_for_one_layer_block"  0.009606361389160156


block_gen_time in "generate_blocks_for_one_layer_block"  0.01105642318725586

connection checking time:  0.009248495101928711
block generation total time  0.020662784576416016
generate_dataloader_block spend   0.04334402084350586
pure train time  0.7078721523284912
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.974609375 GB
    Memory Allocated: 2.0902719497680664  GigaBytes
Max Memory Allocated: 3.29097318649292  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9502663612365723
epoch time :  2.1380691528320312
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004996299743652344
pure dgl.metis_partition the time spent:  0.0037429332733154297

block_gen_time in "generate_blocks_for_one_layer_block"  0.01031184196472168


block_gen_time in "generate_blocks_for_one_layer_block"  0.011143207550048828

connection checking time:  0.00917363166809082
block generation total time  0.021455049514770508
generate_dataloader_block spend   0.04430866241455078
pure train time  0.7170510292053223
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.974609375 GB
    Memory Allocated: 2.089914321899414  GigaBytes
Max Memory Allocated: 3.29097318649292  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9502389430999756
epoch time :  2.1855013370513916
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00541234016418457
pure dgl.metis_partition the time spent:  0.0041768550872802734

block_gen_time in "generate_blocks_for_one_layer_block"  0.009749412536621094


block_gen_time in "generate_blocks_for_one_layer_block"  0.011079788208007812

connection checking time:  0.009173393249511719
block generation total time  0.020829200744628906
generate_dataloader_block spend   0.04460859298706055
pure train time  0.7228848934173584
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.974609375 GB
    Memory Allocated: 2.090263843536377  GigaBytes
Max Memory Allocated: 3.29097318649292  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9537545442581177
epoch time :  2.1528635025024414
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005105257034301758
pure dgl.metis_partition the time spent:  0.004037618637084961

block_gen_time in "generate_blocks_for_one_layer_block"  0.009635448455810547


block_gen_time in "generate_blocks_for_one_layer_block"  0.011017560958862305

connection checking time:  0.009151458740234375
block generation total time  0.02065300941467285
generate_dataloader_block spend   0.043833255767822266
pure train time  0.6972591876983643
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.974609375 GB
    Memory Allocated: 2.0902676582336426  GigaBytes
Max Memory Allocated: 3.29097318649292  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9489037990570068
epoch time :  2.1340181827545166
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004967689514160156
pure dgl.metis_partition the time spent:  0.003881692886352539

block_gen_time in "generate_blocks_for_one_layer_block"  0.009715795516967773


block_gen_time in "generate_blocks_for_one_layer_block"  0.011043787002563477

connection checking time:  0.008999347686767578
block generation total time  0.02075958251953125
generate_dataloader_block spend   0.04339098930358887
pure train time  0.6397976875305176
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.982421875 GB
    Memory Allocated: 2.090270519256592  GigaBytes
Max Memory Allocated: 3.29097318649292  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.947615146636963
epoch time :  2.0801429748535156
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0049550533294677734
pure dgl.metis_partition the time spent:  0.003715991973876953

block_gen_time in "generate_blocks_for_one_layer_block"  0.009601116180419922


block_gen_time in "generate_blocks_for_one_layer_block"  0.011055707931518555

connection checking time:  0.009208440780639648
block generation total time  0.020656824111938477
generate_dataloader_block spend   0.04343390464782715
pure train time  0.6927685737609863
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.982421875 GB
    Memory Allocated: 2.090268135070801  GigaBytes
Max Memory Allocated: 3.29097318649292  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9516687393188477
epoch time :  2.172726631164551
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004853010177612305
pure dgl.metis_partition the time spent:  0.0035314559936523438

block_gen_time in "generate_blocks_for_one_layer_block"  0.009583711624145508


block_gen_time in "generate_blocks_for_one_layer_block"  0.011064767837524414

connection checking time:  0.009124994277954102
block generation total time  0.020648479461669922
generate_dataloader_block spend   0.04304957389831543
pure train time  0.6726036071777344
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.982421875 GB
    Memory Allocated: 2.090270519256592  GigaBytes
Max Memory Allocated: 3.29097318649292  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9495373964309692
epoch time :  2.1504337787628174
Total (block generation + training)time/epoch 2.1448215075901578
pure train time/epoch 0.6903941631317139

num_input_list  [1736, 1792, 1727, 1740, 1791, 1746, 1757, 1709, 1737, 1744]
