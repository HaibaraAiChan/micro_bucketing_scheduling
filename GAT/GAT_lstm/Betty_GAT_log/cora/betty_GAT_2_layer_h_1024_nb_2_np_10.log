main start at this time 1700860172.7260027
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
self._in_src_feats,  1433
self._in_dst_feats 1433
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.121 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.121 GB
Metis partitioning: 0.000 seconds, peak memory: 24.121 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009572029113769531
pure dgl.metis_partition the time spent:  0.003857851028442383

block_gen_time in "generate_blocks_for_one_layer_block"  0.005000114440917969


block_gen_time in "generate_blocks_for_one_layer_block"  0.005632877349853516

connection checking time:  0.008191585540771484
block generation total time  0.010632991790771484
pure train time  0.6598057746887207
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.103515625 GB
    Memory Allocated: 2.091938018798828  GigaBytes
Max Memory Allocated: 3.091938018798828  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9523494243621826
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.477 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.477 GB
Metis partitioning: 0.000 seconds, peak memory: 27.477 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005105018615722656
pure dgl.metis_partition the time spent:  0.002232789993286133

block_gen_time in "generate_blocks_for_one_layer_block"  0.0037767887115478516


block_gen_time in "generate_blocks_for_one_layer_block"  0.005297660827636719

connection checking time:  0.006236076354980469
block generation total time  0.00907444953918457
pure train time  0.3290126323699951
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.37890625 GB
    Memory Allocated: 2.0925521850585938  GigaBytes
Max Memory Allocated: 3.478641986846924  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.95254647731781
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.733 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.733 GB
Metis partitioning: 0.000 seconds, peak memory: 27.733 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005114316940307617
pure dgl.metis_partition the time spent:  0.0024428367614746094

block_gen_time in "generate_blocks_for_one_layer_block"  0.0036382675170898438


block_gen_time in "generate_blocks_for_one_layer_block"  0.005438566207885742

connection checking time:  0.006025791168212891
block generation total time  0.009076833724975586
pure train time  0.33139657974243164
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.37890625 GB
    Memory Allocated: 2.0923118591308594  GigaBytes
Max Memory Allocated: 3.509207248687744  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.951364278793335
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.733 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.733 GB
Metis partitioning: 0.000 seconds, peak memory: 27.733 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0050144195556640625
pure dgl.metis_partition the time spent:  0.002202749252319336

block_gen_time in "generate_blocks_for_one_layer_block"  0.0036115646362304688


block_gen_time in "generate_blocks_for_one_layer_block"  0.005327701568603516

connection checking time:  0.006067991256713867
block generation total time  0.008939266204833984
generate_dataloader_block spend   0.02591538429260254
pure train time  0.31583213806152344
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.37890625 GB
    Memory Allocated: 2.092459201812744  GigaBytes
Max Memory Allocated: 3.5101985931396484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9516863822937012
epoch time :  0.8660247325897217
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.733 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.733 GB
Metis partitioning: 0.000 seconds, peak memory: 27.733 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0049533843994140625
pure dgl.metis_partition the time spent:  0.002386808395385742

block_gen_time in "generate_blocks_for_one_layer_block"  0.0035855770111083984


block_gen_time in "generate_blocks_for_one_layer_block"  0.005308628082275391

connection checking time:  0.006165027618408203
block generation total time  0.008894205093383789
generate_dataloader_block spend   0.0260162353515625
pure train time  0.32039690017700195
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.37890625 GB
    Memory Allocated: 2.092514991760254  GigaBytes
Max Memory Allocated: 3.5101985931396484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9507863521575928
epoch time :  0.8712902069091797
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.733 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.733 GB
Metis partitioning: 0.000 seconds, peak memory: 27.733 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00500035285949707
pure dgl.metis_partition the time spent:  0.002203226089477539

block_gen_time in "generate_blocks_for_one_layer_block"  0.0035746097564697266


block_gen_time in "generate_blocks_for_one_layer_block"  0.005286216735839844

connection checking time:  0.00617527961730957
block generation total time  0.00886082649230957
generate_dataloader_block spend   0.0258023738861084
pure train time  0.3240518569946289
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.37890625 GB
    Memory Allocated: 2.0925445556640625  GigaBytes
Max Memory Allocated: 3.5101985931396484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9494271278381348
epoch time :  0.8736042976379395
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.733 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.733 GB
Metis partitioning: 0.000 seconds, peak memory: 27.733 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004945278167724609
pure dgl.metis_partition the time spent:  0.0023682117462158203

block_gen_time in "generate_blocks_for_one_layer_block"  0.0035948753356933594


block_gen_time in "generate_blocks_for_one_layer_block"  0.005275726318359375

connection checking time:  0.006142139434814453
block generation total time  0.008870601654052734
generate_dataloader_block spend   0.026016950607299805
pure train time  0.31908488273620605
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.37890625 GB
    Memory Allocated: 2.0923118591308594  GigaBytes
Max Memory Allocated: 3.5101985931396484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9498095512390137
epoch time :  0.869443416595459
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.733 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.733 GB
Metis partitioning: 0.000 seconds, peak memory: 27.733 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004984617233276367
pure dgl.metis_partition the time spent:  0.0023331642150878906

block_gen_time in "generate_blocks_for_one_layer_block"  0.0036110877990722656


block_gen_time in "generate_blocks_for_one_layer_block"  0.005742788314819336

connection checking time:  0.0061495304107666016
block generation total time  0.009353876113891602
generate_dataloader_block spend   0.02646017074584961
pure train time  0.33394455909729004
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.37890625 GB
    Memory Allocated: 2.0941596031188965  GigaBytes
Max Memory Allocated: 3.525031089782715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.950196623802185
epoch time :  0.8843104839324951
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.733 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.733 GB
Metis partitioning: 0.000 seconds, peak memory: 27.733 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004987001419067383
pure dgl.metis_partition the time spent:  0.002377748489379883

block_gen_time in "generate_blocks_for_one_layer_block"  0.0031633377075195312


block_gen_time in "generate_blocks_for_one_layer_block"  0.003768444061279297

connection checking time:  0.003989696502685547
block generation total time  0.006931781768798828
generate_dataloader_block spend   0.021724939346313477
pure train time  0.3182210922241211
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.37890625 GB
    Memory Allocated: 2.0941596031188965  GigaBytes
Max Memory Allocated: 3.525031089782715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.947331428527832
epoch time :  0.86956787109375
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.733 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.733 GB
Metis partitioning: 0.000 seconds, peak memory: 27.733 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003439188003540039
pure dgl.metis_partition the time spent:  0.0022208690643310547

block_gen_time in "generate_blocks_for_one_layer_block"  0.0036170482635498047


block_gen_time in "generate_blocks_for_one_layer_block"  0.005284547805786133

connection checking time:  0.006062030792236328
block generation total time  0.008901596069335938
generate_dataloader_block spend   0.024245262145996094
pure train time  0.3126356601715088
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.37890625 GB
    Memory Allocated: 2.0928139686584473  GigaBytes
Max Memory Allocated: 3.525031089782715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9473215341567993
epoch time :  0.8663833141326904
Total (block generation + training)time/epoch 0.8715170792170933
pure train time/epoch 0.3213891585667928

num_input_list  [1483, 1546, 1552, 1557, 1545, 1536, 1514, 1513, 1515, 1538]
