main start at this time 1700860257.7229407
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
self._in_src_feats,  1433
self._in_dst_feats 1433
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.090 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.090 GB
Metis partitioning: 0.001 seconds, peak memory: 24.090 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009088993072509766
pure dgl.metis_partition the time spent:  0.004727840423583984

block_gen_time in "generate_blocks_for_one_layer_block"  0.009250879287719727


block_gen_time in "generate_blocks_for_one_layer_block"  0.009762048721313477

connection checking time:  0.009639263153076172
block generation total time  0.019012928009033203
pure train time  0.9554336071014404
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.041015625 GB
    Memory Allocated: 2.090333938598633  GigaBytes
Max Memory Allocated: 3.090333938598633  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9526448249816895
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.289 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.289 GB
Metis partitioning: 0.001 seconds, peak memory: 27.289 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005910634994506836
pure dgl.metis_partition the time spent:  0.00371551513671875

block_gen_time in "generate_blocks_for_one_layer_block"  0.011755943298339844


block_gen_time in "generate_blocks_for_one_layer_block"  0.009951591491699219

connection checking time:  0.012084722518920898
block generation total time  0.021707534790039062
pure train time  0.5953984260559082
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.041015625 GB
    Memory Allocated: 2.0911359786987305  GigaBytes
Max Memory Allocated: 3.2810301780700684  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.951037883758545
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.289 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.289 GB
Metis partitioning: 0.000 seconds, peak memory: 27.289 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0053195953369140625
pure dgl.metis_partition the time spent:  0.003800630569458008

block_gen_time in "generate_blocks_for_one_layer_block"  0.007822513580322266


block_gen_time in "generate_blocks_for_one_layer_block"  0.010193109512329102

connection checking time:  0.008188486099243164
block generation total time  0.018015623092651367
pure train time  0.6333491802215576
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.044921875 GB
    Memory Allocated: 2.0902652740478516  GigaBytes
Max Memory Allocated: 3.2953991889953613  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.950577735900879
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.289 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.289 GB
Metis partitioning: 0.001 seconds, peak memory: 27.289 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005364894866943359
pure dgl.metis_partition the time spent:  0.0039250850677490234

block_gen_time in "generate_blocks_for_one_layer_block"  0.007912635803222656


block_gen_time in "generate_blocks_for_one_layer_block"  0.01002192497253418

connection checking time:  0.008144140243530273
block generation total time  0.017934560775756836
generate_dataloader_block spend   0.03985142707824707
pure train time  0.6188485622406006
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.044921875 GB
    Memory Allocated: 2.090501308441162  GigaBytes
Max Memory Allocated: 3.299546718597412  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9487099647521973
epoch time :  1.8429059982299805
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.289 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.289 GB
Metis partitioning: 0.001 seconds, peak memory: 27.289 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004937410354614258
pure dgl.metis_partition the time spent:  0.0033032894134521484

block_gen_time in "generate_blocks_for_one_layer_block"  0.007855892181396484


block_gen_time in "generate_blocks_for_one_layer_block"  0.01003718376159668

connection checking time:  0.008094072341918945
block generation total time  0.017893075942993164
generate_dataloader_block spend   0.03850698471069336
pure train time  0.5803234577178955
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.044921875 GB
    Memory Allocated: 2.090268135070801  GigaBytes
Max Memory Allocated: 3.3036513328552246  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9477297067642212
epoch time :  1.7661681175231934
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.289 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.289 GB
Metis partitioning: 0.000 seconds, peak memory: 27.289 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00500798225402832
pure dgl.metis_partition the time spent:  0.0034914016723632812

block_gen_time in "generate_blocks_for_one_layer_block"  0.007855415344238281


block_gen_time in "generate_blocks_for_one_layer_block"  0.009991645812988281

connection checking time:  0.008200645446777344
block generation total time  0.017847061157226562
generate_dataloader_block spend   0.038839101791381836
pure train time  0.6170525550842285
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.044921875 GB
    Memory Allocated: 2.09024715423584  GigaBytes
Max Memory Allocated: 3.3036513328552246  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9499115943908691
epoch time :  1.8878533840179443
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.289 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.289 GB
Metis partitioning: 0.000 seconds, peak memory: 27.289 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004973411560058594
pure dgl.metis_partition the time spent:  0.0033693313598632812

block_gen_time in "generate_blocks_for_one_layer_block"  0.007911920547485352


block_gen_time in "generate_blocks_for_one_layer_block"  0.010071039199829102

connection checking time:  0.008206605911254883
block generation total time  0.017982959747314453
generate_dataloader_block spend   0.038941383361816406
pure train time  0.5963506698608398
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.044921875 GB
    Memory Allocated: 2.090269088745117  GigaBytes
Max Memory Allocated: 3.3036513328552246  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9513072967529297
epoch time :  1.871342658996582
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.289 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.289 GB
Metis partitioning: 0.000 seconds, peak memory: 27.289 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004956722259521484
pure dgl.metis_partition the time spent:  0.003488302230834961

block_gen_time in "generate_blocks_for_one_layer_block"  0.007873296737670898


block_gen_time in "generate_blocks_for_one_layer_block"  0.010031700134277344

connection checking time:  0.008146047592163086
block generation total time  0.017904996871948242
generate_dataloader_block spend   0.038863182067871094
pure train time  0.6132211685180664
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.044921875 GB
    Memory Allocated: 2.090658187866211  GigaBytes
Max Memory Allocated: 3.3036513328552246  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9487919807434082
epoch time :  1.847506046295166
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.289 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.289 GB
Metis partitioning: 0.000 seconds, peak memory: 27.289 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004903554916381836
pure dgl.metis_partition the time spent:  0.0032608509063720703

block_gen_time in "generate_blocks_for_one_layer_block"  0.00789642333984375


block_gen_time in "generate_blocks_for_one_layer_block"  0.010184764862060547

connection checking time:  0.008196592330932617
block generation total time  0.018081188201904297
generate_dataloader_block spend   0.0389094352722168
pure train time  0.6088194847106934
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.044921875 GB
    Memory Allocated: 2.0906567573547363  GigaBytes
Max Memory Allocated: 3.3036513328552246  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9505767822265625
epoch time :  1.843282699584961
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.289 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.289 GB
Metis partitioning: 0.001 seconds, peak memory: 27.289 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004913330078125
pure dgl.metis_partition the time spent:  0.0033190250396728516

block_gen_time in "generate_blocks_for_one_layer_block"  0.007902383804321289


block_gen_time in "generate_blocks_for_one_layer_block"  0.010027885437011719

connection checking time:  0.008232593536376953
block generation total time  0.017930269241333008
generate_dataloader_block spend   0.03879547119140625
pure train time  0.6107091903686523
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.044921875 GB
    Memory Allocated: 2.0904316902160645  GigaBytes
Max Memory Allocated: 3.3036513328552246  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9463261365890503
epoch time :  1.8841769695281982
Total (block generation + training)time/epoch 1.8490331172943115
pure train time/epoch 0.6044127543767294

num_input_list  [1677, 1783, 1739, 1737, 1742, 1741, 1814, 1733, 1781, 1763]
