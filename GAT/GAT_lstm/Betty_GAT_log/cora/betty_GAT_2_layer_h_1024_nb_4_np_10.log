main start at this time 1700860225.3076203
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
self._in_src_feats,  1433
self._in_dst_feats 1433
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.090 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.090 GB
Metis partitioning: 0.000 seconds, peak memory: 24.090 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008385896682739258
pure dgl.metis_partition the time spent:  0.004060506820678711

block_gen_time in "generate_blocks_for_one_layer_block"  0.0072174072265625


block_gen_time in "generate_blocks_for_one_layer_block"  0.008282184600830078

connection checking time:  0.009771347045898438
block generation total time  0.015499591827392578
pure train time  0.8415896892547607
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.05859375 GB
    Memory Allocated: 2.0908150672912598  GigaBytes
Max Memory Allocated: 3.0908150672912598  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.95253324508667
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.320 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.320 GB
Metis partitioning: 0.000 seconds, peak memory: 27.320 GB
Split the graph: 0.003 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005251169204711914
pure dgl.metis_partition the time spent:  0.005280017852783203

block_gen_time in "generate_blocks_for_one_layer_block"  0.006719350814819336


block_gen_time in "generate_blocks_for_one_layer_block"  0.0082855224609375

connection checking time:  0.007724761962890625
block generation total time  0.015004873275756836
pure train time  0.48772239685058594
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.05859375 GB
    Memory Allocated: 2.0906920433044434  GigaBytes
Max Memory Allocated: 3.307313919067383  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9516048431396484
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.320 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.320 GB
Metis partitioning: 0.000 seconds, peak memory: 27.320 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005150318145751953
pure dgl.metis_partition the time spent:  0.0033380985260009766

block_gen_time in "generate_blocks_for_one_layer_block"  0.006433725357055664


block_gen_time in "generate_blocks_for_one_layer_block"  0.008238792419433594

connection checking time:  0.007616519927978516
block generation total time  0.014672517776489258
pure train time  0.49689483642578125
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.060546875 GB
    Memory Allocated: 2.0905370712280273  GigaBytes
Max Memory Allocated: 3.313497543334961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9513111114501953
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.320 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.320 GB
Metis partitioning: 0.000 seconds, peak memory: 27.320 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005071878433227539
pure dgl.metis_partition the time spent:  0.0032639503479003906

block_gen_time in "generate_blocks_for_one_layer_block"  0.006440639495849609


block_gen_time in "generate_blocks_for_one_layer_block"  0.008634090423583984

connection checking time:  0.007543087005615234
block generation total time  0.015074729919433594
generate_dataloader_block spend   0.03508281707763672
pure train time  0.5113174915313721
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.060546875 GB
    Memory Allocated: 2.090787410736084  GigaBytes
Max Memory Allocated: 3.334041118621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.951348066329956
epoch time :  1.4945478439331055
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.320 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.320 GB
Metis partitioning: 0.000 seconds, peak memory: 27.320 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005094766616821289
pure dgl.metis_partition the time spent:  0.0029692649841308594

block_gen_time in "generate_blocks_for_one_layer_block"  0.00650334358215332


block_gen_time in "generate_blocks_for_one_layer_block"  0.008610248565673828

connection checking time:  0.0074880123138427734
block generation total time  0.015113592147827148
generate_dataloader_block spend   0.03476095199584961
pure train time  0.525904655456543
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.060546875 GB
    Memory Allocated: 2.090919017791748  GigaBytes
Max Memory Allocated: 3.334041118621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9514623880386353
epoch time :  1.5503334999084473
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.320 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.320 GB
Metis partitioning: 0.000 seconds, peak memory: 27.320 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005078554153442383
pure dgl.metis_partition the time spent:  0.003093242645263672

block_gen_time in "generate_blocks_for_one_layer_block"  0.006481170654296875


block_gen_time in "generate_blocks_for_one_layer_block"  0.008585691452026367

connection checking time:  0.007371425628662109
block generation total time  0.015066862106323242
generate_dataloader_block spend   0.034697771072387695
pure train time  0.48320460319519043
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.060546875 GB
    Memory Allocated: 2.090263843536377  GigaBytes
Max Memory Allocated: 3.334041118621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9512431621551514
epoch time :  1.4703245162963867
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.320 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.320 GB
Metis partitioning: 0.000 seconds, peak memory: 27.320 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0049359798431396484
pure dgl.metis_partition the time spent:  0.002870321273803711

block_gen_time in "generate_blocks_for_one_layer_block"  0.006418943405151367


block_gen_time in "generate_blocks_for_one_layer_block"  0.00858163833618164

connection checking time:  0.007527351379394531
block generation total time  0.015000581741333008
generate_dataloader_block spend   0.03451037406921387
pure train time  0.49737548828125
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.060546875 GB
    Memory Allocated: 2.0908966064453125  GigaBytes
Max Memory Allocated: 3.334041118621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9517874717712402
epoch time :  1.4756035804748535
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.320 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.320 GB
Metis partitioning: 0.000 seconds, peak memory: 27.320 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005104541778564453
pure dgl.metis_partition the time spent:  0.0030667781829833984

block_gen_time in "generate_blocks_for_one_layer_block"  0.006522417068481445


block_gen_time in "generate_blocks_for_one_layer_block"  0.008623838424682617

connection checking time:  0.007543325424194336
block generation total time  0.015146255493164062
generate_dataloader_block spend   0.03499913215637207
pure train time  0.4904940128326416
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.060546875 GB
    Memory Allocated: 2.090702533721924  GigaBytes
Max Memory Allocated: 3.334041118621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9516404867172241
epoch time :  1.5192127227783203
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.320 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.320 GB
Metis partitioning: 0.000 seconds, peak memory: 27.320 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0049669742584228516
pure dgl.metis_partition the time spent:  0.0029206275939941406

block_gen_time in "generate_blocks_for_one_layer_block"  0.006484031677246094


block_gen_time in "generate_blocks_for_one_layer_block"  0.008603334426879883

connection checking time:  0.0075342655181884766
block generation total time  0.015087366104125977
generate_dataloader_block spend   0.03461456298828125
pure train time  0.5054037570953369
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.060546875 GB
    Memory Allocated: 2.0907888412475586  GigaBytes
Max Memory Allocated: 3.334041118621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.945109248161316
epoch time :  1.5341341495513916
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.320 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.320 GB
Metis partitioning: 0.000 seconds, peak memory: 27.320 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00494694709777832
pure dgl.metis_partition the time spent:  0.0030803680419921875

block_gen_time in "generate_blocks_for_one_layer_block"  0.006459474563598633


block_gen_time in "generate_blocks_for_one_layer_block"  0.008699655532836914

connection checking time:  0.007441043853759766
block generation total time  0.015159130096435547
generate_dataloader_block spend   0.03469133377075195
pure train time  0.5062665939331055
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.060546875 GB
    Memory Allocated: 2.0909295082092285  GigaBytes
Max Memory Allocated: 3.334041118621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9488893747329712
epoch time :  1.4957265853881836
Total (block generation + training)time/epoch 1.5056969097682409
pure train time/epoch 0.5014415184656779

num_input_list  [1657, 1748, 1665, 1674, 1671, 1674, 1720, 1696, 1669, 1665]
