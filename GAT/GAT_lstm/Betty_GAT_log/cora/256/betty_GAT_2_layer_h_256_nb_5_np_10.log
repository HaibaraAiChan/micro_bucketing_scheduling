main start at this time 1700859647.1639678
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
self._in_src_feats,  1433
self._in_dst_feats 1433
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 22.793 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 22.793 GB
Metis partitioning: 0.001 seconds, peak memory: 22.793 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007745027542114258
pure dgl.metis_partition the time spent:  0.004801511764526367

block_gen_time in "generate_blocks_for_one_layer_block"  0.008513212203979492


block_gen_time in "generate_blocks_for_one_layer_block"  0.009826183319091797

connection checking time:  0.00966334342956543
block generation total time  0.01833939552307129
pure train time  0.8297839164733887
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8046875 GB
    Memory Allocated: 0.14928483963012695  GigaBytes
Max Memory Allocated: 0.21178483963012695  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9506434202194214
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.836 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.836 GB
Metis partitioning: 0.000 seconds, peak memory: 23.836 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004932880401611328
pure dgl.metis_partition the time spent:  0.0032634735107421875

block_gen_time in "generate_blocks_for_one_layer_block"  0.006819248199462891


block_gen_time in "generate_blocks_for_one_layer_block"  0.0077686309814453125

connection checking time:  0.005404949188232422
block generation total time  0.014587879180908203
pure train time  0.35106897354125977
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8203125 GB
    Memory Allocated: 0.14911985397338867  GigaBytes
Max Memory Allocated: 0.2608351707458496  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.95094633102417
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.000 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0034666061401367188
pure dgl.metis_partition the time spent:  0.0028429031372070312

block_gen_time in "generate_blocks_for_one_layer_block"  0.005614757537841797


block_gen_time in "generate_blocks_for_one_layer_block"  0.006463527679443359

connection checking time:  0.004556417465209961
block generation total time  0.012078285217285156
pure train time  0.3496396541595459
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8203125 GB
    Memory Allocated: 0.14928340911865234  GigaBytes
Max Memory Allocated: 0.264585018157959  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9510241746902466
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0054874420166015625
pure dgl.metis_partition the time spent:  0.003407716751098633

block_gen_time in "generate_blocks_for_one_layer_block"  0.00595855712890625


block_gen_time in "generate_blocks_for_one_layer_block"  0.0066089630126953125

connection checking time:  0.005101919174194336
block generation total time  0.012567520141601562
generate_dataloader_block spend   0.03098583221435547
pure train time  0.3308894634246826
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8203125 GB
    Memory Allocated: 0.14928627014160156  GigaBytes
Max Memory Allocated: 0.265963077545166  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.94716477394104
epoch time :  0.40364718437194824
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.000 seconds, peak memory: 23.874 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0028994083404541016
pure dgl.metis_partition the time spent:  0.0022907257080078125

block_gen_time in "generate_blocks_for_one_layer_block"  0.0053942203521728516


block_gen_time in "generate_blocks_for_one_layer_block"  0.006430387496948242

connection checking time:  0.004221200942993164
block generation total time  0.011824607849121094
generate_dataloader_block spend   0.024283170700073242
pure train time  0.3238828182220459
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.822265625 GB
    Memory Allocated: 0.14928627014160156  GigaBytes
Max Memory Allocated: 0.266573429107666  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9462199211120605
epoch time :  0.37966275215148926
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005218505859375
pure dgl.metis_partition the time spent:  0.0034401416778564453

block_gen_time in "generate_blocks_for_one_layer_block"  0.006655216217041016


block_gen_time in "generate_blocks_for_one_layer_block"  0.0066623687744140625

connection checking time:  0.0047245025634765625
block generation total time  0.013317584991455078
generate_dataloader_block spend   0.030614614486694336
pure train time  0.35621047019958496
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.822265625 GB
    Memory Allocated: 0.14928340911865234  GigaBytes
Max Memory Allocated: 0.266573429107666  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9510873556137085
epoch time :  0.42542266845703125
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.006185054779052734
pure dgl.metis_partition the time spent:  0.003650188446044922

block_gen_time in "generate_blocks_for_one_layer_block"  0.00652766227722168


block_gen_time in "generate_blocks_for_one_layer_block"  0.0065860748291015625

connection checking time:  0.00558161735534668
block generation total time  0.013113737106323242
generate_dataloader_block spend   0.033458709716796875
pure train time  0.37131810188293457
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.822265625 GB
    Memory Allocated: 0.14928722381591797  GigaBytes
Max Memory Allocated: 0.266573429107666  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9479990005493164
epoch time :  0.4467191696166992
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008228778839111328
pure dgl.metis_partition the time spent:  0.004045724868774414

block_gen_time in "generate_blocks_for_one_layer_block"  0.008089065551757812


block_gen_time in "generate_blocks_for_one_layer_block"  0.010096549987792969

connection checking time:  0.008555173873901367
block generation total time  0.01818561553955078
generate_dataloader_block spend   0.04450583457946777
pure train time  0.4111788272857666
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.822265625 GB
    Memory Allocated: 0.1494431495666504  GigaBytes
Max Memory Allocated: 0.266573429107666  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9508438110351562
epoch time :  0.4970824718475342
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007452487945556641
pure dgl.metis_partition the time spent:  0.004048347473144531

block_gen_time in "generate_blocks_for_one_layer_block"  0.007884740829467773


block_gen_time in "generate_blocks_for_one_layer_block"  0.010174989700317383

connection checking time:  0.008103609085083008
block generation total time  0.018059730529785156
generate_dataloader_block spend   0.04330801963806152
pure train time  0.423675537109375
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.822265625 GB
    Memory Allocated: 0.14944171905517578  GigaBytes
Max Memory Allocated: 0.266573429107666  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9478020668029785
epoch time :  0.5067300796508789
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007156848907470703
pure dgl.metis_partition the time spent:  0.004251718521118164

block_gen_time in "generate_blocks_for_one_layer_block"  0.008270740509033203


block_gen_time in "generate_blocks_for_one_layer_block"  0.010346651077270508

connection checking time:  0.008265018463134766
block generation total time  0.01861739158630371
generate_dataloader_block spend   0.04371953010559082
pure train time  0.3921830654144287
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.822265625 GB
    Memory Allocated: 0.14928627014160156  GigaBytes
Max Memory Allocated: 0.266573429107666  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9455891847610474
epoch time :  0.483501672744751
Total (block generation + training)time/epoch 0.4489650045122419
pure train time/epoch 0.37974147001902264

num_input_list  [1677, 1783, 1739, 1737, 1742, 1741, 1814, 1733, 1781, 1763]
