main start at this time 1700859598.6270819
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
self._in_src_feats,  1433
self._in_dst_feats 1433
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 22.887 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 22.887 GB
Metis partitioning: 0.000 seconds, peak memory: 22.887 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007878303527832031
pure dgl.metis_partition the time spent:  0.0042743682861328125

block_gen_time in "generate_blocks_for_one_layer_block"  0.00396418571472168


block_gen_time in "generate_blocks_for_one_layer_block"  0.005643367767333984

connection checking time:  0.007616519927978516
block generation total time  0.009607553482055664
pure train time  0.5810236930847168
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.8515625 GB
    Memory Allocated: 0.15116596221923828  GigaBytes
Max Memory Allocated: 0.2172412872314453  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9512890577316284
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.898 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.898 GB
Metis partitioning: 0.000 seconds, peak memory: 23.898 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008395195007324219
pure dgl.metis_partition the time spent:  0.002530813217163086

block_gen_time in "generate_blocks_for_one_layer_block"  0.004361152648925781


block_gen_time in "generate_blocks_for_one_layer_block"  0.005367279052734375

connection checking time:  0.006439208984375
block generation total time  0.009728431701660156
pure train time  0.20701980590820312
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.15116643905639648  GigaBytes
Max Memory Allocated: 0.3142819404602051  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9503462314605713
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.936 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.936 GB
Metis partitioning: 0.000 seconds, peak memory: 23.936 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008838891983032227
pure dgl.metis_partition the time spent:  0.0025789737701416016

block_gen_time in "generate_blocks_for_one_layer_block"  0.0041620731353759766


block_gen_time in "generate_blocks_for_one_layer_block"  0.0053844451904296875

connection checking time:  0.0065059661865234375
block generation total time  0.009546518325805664
pure train time  0.2212049961090088
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.15116643905639648  GigaBytes
Max Memory Allocated: 0.3209266662597656  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9500987529754639
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.936 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.936 GB
Metis partitioning: 0.000 seconds, peak memory: 23.936 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007372140884399414
pure dgl.metis_partition the time spent:  0.0024831295013427734

block_gen_time in "generate_blocks_for_one_layer_block"  0.002962350845336914


block_gen_time in "generate_blocks_for_one_layer_block"  0.003875732421875

connection checking time:  0.003734111785888672
block generation total time  0.006838083267211914
generate_dataloader_block spend   0.024897098541259766
pure train time  0.20469117164611816
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.1511693000793457  GigaBytes
Max Memory Allocated: 0.3209266662597656  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.948704719543457
epoch time :  0.2513284683227539
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.936 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.936 GB
Metis partitioning: 0.000 seconds, peak memory: 23.936 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0053272247314453125
pure dgl.metis_partition the time spent:  0.0027191638946533203

block_gen_time in "generate_blocks_for_one_layer_block"  0.0038368701934814453


block_gen_time in "generate_blocks_for_one_layer_block"  0.005532979965209961

connection checking time:  0.006722927093505859
block generation total time  0.009369850158691406
generate_dataloader_block spend   0.028988122940063477
pure train time  0.22064757347106934
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.15116643905639648  GigaBytes
Max Memory Allocated: 0.3209266662597656  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9492930173873901
epoch time :  0.27031874656677246
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.936 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.936 GB
Metis partitioning: 0.000 seconds, peak memory: 23.936 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00810861587524414
pure dgl.metis_partition the time spent:  0.0027284622192382812

block_gen_time in "generate_blocks_for_one_layer_block"  0.0029859542846679688


block_gen_time in "generate_blocks_for_one_layer_block"  0.0038487911224365234

connection checking time:  0.003840923309326172
block generation total time  0.006834745407104492
generate_dataloader_block spend   0.026103734970092773
pure train time  0.22698283195495605
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.1511693000793457  GigaBytes
Max Memory Allocated: 0.3209266662597656  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.944532036781311
epoch time :  0.2700386047363281
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.936 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.936 GB
Metis partitioning: 0.000 seconds, peak memory: 23.936 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.006075382232666016
pure dgl.metis_partition the time spent:  0.0028052330017089844

block_gen_time in "generate_blocks_for_one_layer_block"  0.0044879913330078125


block_gen_time in "generate_blocks_for_one_layer_block"  0.005404233932495117

connection checking time:  0.0065462589263916016
block generation total time  0.00989222526550293
generate_dataloader_block spend   0.030030250549316406
pure train time  0.20639252662658691
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.15116643905639648  GigaBytes
Max Memory Allocated: 0.3209266662597656  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9479317665100098
epoch time :  0.25908589363098145
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.936 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.936 GB
Metis partitioning: 0.000 seconds, peak memory: 23.936 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008713245391845703
pure dgl.metis_partition the time spent:  0.0026721954345703125

block_gen_time in "generate_blocks_for_one_layer_block"  0.004133701324462891


block_gen_time in "generate_blocks_for_one_layer_block"  0.00586700439453125

connection checking time:  0.006647348403930664
block generation total time  0.01000070571899414
generate_dataloader_block spend   0.03287100791931152
pure train time  0.20434093475341797
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.896484375 GB
    Memory Allocated: 0.15209674835205078  GigaBytes
Max Memory Allocated: 0.3264908790588379  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9451038837432861
epoch time :  0.26038146018981934
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.967 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.967 GB
Metis partitioning: 0.000 seconds, peak memory: 23.967 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008384466171264648
pure dgl.metis_partition the time spent:  0.002928018569946289

block_gen_time in "generate_blocks_for_one_layer_block"  0.004261493682861328


block_gen_time in "generate_blocks_for_one_layer_block"  0.005321502685546875

connection checking time:  0.0063703060150146484
block generation total time  0.009582996368408203
generate_dataloader_block spend   0.03244185447692871
pure train time  0.2140519618988037
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.896484375 GB
    Memory Allocated: 0.15195226669311523  GigaBytes
Max Memory Allocated: 0.3264908790588379  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.947556972503662
epoch time :  0.2690401077270508
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.967 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.967 GB
Metis partitioning: 0.000 seconds, peak memory: 23.967 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007599830627441406
pure dgl.metis_partition the time spent:  0.0024170875549316406

block_gen_time in "generate_blocks_for_one_layer_block"  0.003720998764038086


block_gen_time in "generate_blocks_for_one_layer_block"  0.005450010299682617

connection checking time:  0.006517648696899414
block generation total time  0.009171009063720703
generate_dataloader_block spend   0.03069782257080078
pure train time  0.19475674629211426
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.896484375 GB
    Memory Allocated: 0.1517796516418457  GigaBytes
Max Memory Allocated: 0.3264908790588379  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9491147994995117
epoch time :  0.24782180786132812
Total (block generation + training)time/epoch 0.26114320755004883
pure train time/epoch 0.21119542916615805

num_input_list  [1483, 1546, 1552, 1557, 1545, 1536, 1514, 1513, 1515, 1538]
