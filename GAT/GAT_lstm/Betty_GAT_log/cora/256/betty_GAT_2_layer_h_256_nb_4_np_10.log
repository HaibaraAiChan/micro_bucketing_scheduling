main start at this time 1700859630.1194677
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
self._in_src_feats,  1433
self._in_dst_feats 1433
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 22.793 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 22.793 GB
Metis partitioning: 0.000 seconds, peak memory: 22.793 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0067768096923828125
pure dgl.metis_partition the time spent:  0.00430750846862793

block_gen_time in "generate_blocks_for_one_layer_block"  0.007004737854003906


block_gen_time in "generate_blocks_for_one_layer_block"  0.008205890655517578

connection checking time:  0.00915670394897461
block generation total time  0.015210628509521484
pure train time  0.7283258438110352
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.81640625 GB
    Memory Allocated: 0.14939355850219727  GigaBytes
Max Memory Allocated: 0.21189355850219727  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.951930284500122
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.867 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.867 GB
Metis partitioning: 0.001 seconds, peak memory: 23.867 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008115530014038086
pure dgl.metis_partition the time spent:  0.0034928321838378906

block_gen_time in "generate_blocks_for_one_layer_block"  0.0069615840911865234


block_gen_time in "generate_blocks_for_one_layer_block"  0.008270025253295898

connection checking time:  0.007908344268798828
block generation total time  0.015231609344482422
pure train time  0.35881614685058594
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.83203125 GB
    Memory Allocated: 0.1493978500366211  GigaBytes
Max Memory Allocated: 0.26824045181274414  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9509073495864868
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.867 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.867 GB
Metis partitioning: 0.001 seconds, peak memory: 23.867 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008233070373535156
pure dgl.metis_partition the time spent:  0.0037386417388916016

block_gen_time in "generate_blocks_for_one_layer_block"  0.00655674934387207


block_gen_time in "generate_blocks_for_one_layer_block"  0.008313417434692383

connection checking time:  0.00754237174987793
block generation total time  0.014870166778564453
pure train time  0.37613391876220703
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.83203125 GB
    Memory Allocated: 0.14966440200805664  GigaBytes
Max Memory Allocated: 0.26944828033447266  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9497246742248535
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.867 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.867 GB
Metis partitioning: 0.001 seconds, peak memory: 23.867 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008196830749511719
pure dgl.metis_partition the time spent:  0.003653287887573242

block_gen_time in "generate_blocks_for_one_layer_block"  0.0068318843841552734


block_gen_time in "generate_blocks_for_one_layer_block"  0.008894681930541992

connection checking time:  0.0075185298919677734
block generation total time  0.015726566314697266
generate_dataloader_block spend   0.04079151153564453
pure train time  0.33887195587158203
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.83203125 GB
    Memory Allocated: 0.14936590194702148  GigaBytes
Max Memory Allocated: 0.27463769912719727  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9503562450408936
epoch time :  0.41558384895324707
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.867 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.867 GB
Metis partitioning: 0.000 seconds, peak memory: 23.867 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.006766080856323242
pure dgl.metis_partition the time spent:  0.003118276596069336

block_gen_time in "generate_blocks_for_one_layer_block"  0.006566047668457031


block_gen_time in "generate_blocks_for_one_layer_block"  0.008569717407226562

connection checking time:  0.007504463195800781
block generation total time  0.015135765075683594
generate_dataloader_block spend   0.037094831466674805
pure train time  0.3501403331756592
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.83203125 GB
    Memory Allocated: 0.15003061294555664  GigaBytes
Max Memory Allocated: 0.27463769912719727  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9486446380615234
epoch time :  0.4235198497772217
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.867 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.867 GB
Metis partitioning: 0.001 seconds, peak memory: 23.867 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007445812225341797
pure dgl.metis_partition the time spent:  0.003548145294189453

block_gen_time in "generate_blocks_for_one_layer_block"  0.006536722183227539


block_gen_time in "generate_blocks_for_one_layer_block"  0.008620738983154297

connection checking time:  0.007405757904052734
block generation total time  0.015157461166381836
generate_dataloader_block spend   0.03885054588317871
pure train time  0.33089494705200195
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.83203125 GB
    Memory Allocated: 0.14874792098999023  GigaBytes
Max Memory Allocated: 0.27463769912719727  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9513052701950073
epoch time :  0.4083127975463867
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.867 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.867 GB
Metis partitioning: 0.001 seconds, peak memory: 23.867 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008419036865234375
pure dgl.metis_partition the time spent:  0.0036878585815429688

block_gen_time in "generate_blocks_for_one_layer_block"  0.006708621978759766


block_gen_time in "generate_blocks_for_one_layer_block"  0.008728265762329102

connection checking time:  0.007630825042724609
block generation total time  0.015436887741088867
generate_dataloader_block spend   0.04091620445251465
pure train time  0.35492420196533203
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.83203125 GB
    Memory Allocated: 0.14947509765625  GigaBytes
Max Memory Allocated: 0.27463769912719727  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9459400177001953
epoch time :  0.4346344470977783
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.867 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.867 GB
Metis partitioning: 0.000 seconds, peak memory: 23.867 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00527191162109375
pure dgl.metis_partition the time spent:  0.003254413604736328

block_gen_time in "generate_blocks_for_one_layer_block"  0.006424903869628906


block_gen_time in "generate_blocks_for_one_layer_block"  0.008546590805053711

connection checking time:  0.0075528621673583984
block generation total time  0.014971494674682617
generate_dataloader_block spend   0.03520655632019043
pure train time  0.3116300106048584
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.83203125 GB
    Memory Allocated: 0.14978742599487305  GigaBytes
Max Memory Allocated: 0.27463769912719727  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.946803092956543
epoch time :  0.38527679443359375
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.867 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.867 GB
Metis partitioning: 0.000 seconds, peak memory: 23.867 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0050258636474609375
pure dgl.metis_partition the time spent:  0.002680063247680664

block_gen_time in "generate_blocks_for_one_layer_block"  0.006417036056518555


block_gen_time in "generate_blocks_for_one_layer_block"  0.008548259735107422

connection checking time:  0.007399082183837891
block generation total time  0.014965295791625977
generate_dataloader_block spend   0.034090518951416016
pure train time  0.3457376956939697
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.83203125 GB
    Memory Allocated: 0.1494903564453125  GigaBytes
Max Memory Allocated: 0.27463769912719727  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9474154710769653
epoch time :  0.4154829978942871
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.867 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.867 GB
Metis partitioning: 0.000 seconds, peak memory: 23.867 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004857778549194336
pure dgl.metis_partition the time spent:  0.002901792526245117

block_gen_time in "generate_blocks_for_one_layer_block"  0.00640559196472168


block_gen_time in "generate_blocks_for_one_layer_block"  0.008592844009399414

connection checking time:  0.00733494758605957
block generation total time  0.014998435974121094
generate_dataloader_block spend   0.03414487838745117
pure train time  0.3120720386505127
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.83203125 GB
    Memory Allocated: 0.14950799942016602  GigaBytes
Max Memory Allocated: 0.27463769912719727  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9466743469238281
epoch time :  0.38151025772094727
Total (block generation + training)time/epoch 0.40918748719351633
pure train time/epoch 0.33423320452372235

num_input_list  [1657, 1748, 1665, 1674, 1671, 1674, 1720, 1696, 1669, 1665]
