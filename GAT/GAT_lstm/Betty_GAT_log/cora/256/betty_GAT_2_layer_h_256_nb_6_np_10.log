main start at this time 1700859664.4303422
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
self._in_src_feats,  1433
self._in_dst_feats 1433
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 22.793 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 22.793 GB
Metis partitioning: 0.001 seconds, peak memory: 22.793 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.006439208984375
pure dgl.metis_partition the time spent:  0.00510859489440918

block_gen_time in "generate_blocks_for_one_layer_block"  0.009887456893920898


block_gen_time in "generate_blocks_for_one_layer_block"  0.011317014694213867

connection checking time:  0.01256108283996582
block generation total time  0.021204471588134766
pure train time  0.8516781330108643
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.798828125 GB
    Memory Allocated: 0.14865779876708984  GigaBytes
Max Memory Allocated: 0.21115779876708984  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.95067298412323
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.836 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.836 GB
Metis partitioning: 0.001 seconds, peak memory: 23.836 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008306741714477539
pure dgl.metis_partition the time spent:  0.005516767501831055

block_gen_time in "generate_blocks_for_one_layer_block"  0.010019540786743164


block_gen_time in "generate_blocks_for_one_layer_block"  0.01174163818359375

connection checking time:  0.016696929931640625
block generation total time  0.021761178970336914
pure train time  0.5258755683898926
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.814453125 GB
    Memory Allocated: 0.14874505996704102  GigaBytes
Max Memory Allocated: 0.25057220458984375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9514799118041992
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.012140274047851562
pure dgl.metis_partition the time spent:  0.004225254058837891

block_gen_time in "generate_blocks_for_one_layer_block"  0.010875701904296875


block_gen_time in "generate_blocks_for_one_layer_block"  0.012010812759399414

connection checking time:  0.009247064590454102
block generation total time  0.02288651466369629
pure train time  0.4914131164550781
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.818359375 GB
    Memory Allocated: 0.1491856575012207  GigaBytes
Max Memory Allocated: 0.26349496841430664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.950272798538208
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005062103271484375
pure dgl.metis_partition the time spent:  0.0036945343017578125

block_gen_time in "generate_blocks_for_one_layer_block"  0.008346796035766602


block_gen_time in "generate_blocks_for_one_layer_block"  0.008966445922851562

connection checking time:  0.007521152496337891
block generation total time  0.017313241958618164
generate_dataloader_block spend   0.03842878341674805
pure train time  0.46502113342285156
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.818359375 GB
    Memory Allocated: 0.1491093635559082  GigaBytes
Max Memory Allocated: 0.26349496841430664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9509146213531494
epoch time :  0.5436520576477051
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005116939544677734
pure dgl.metis_partition the time spent:  0.004609346389770508

block_gen_time in "generate_blocks_for_one_layer_block"  0.010733842849731445


block_gen_time in "generate_blocks_for_one_layer_block"  0.011994361877441406

connection checking time:  0.009528398513793945
block generation total time  0.02272820472717285
generate_dataloader_block spend   0.048076629638671875
pure train time  0.563225269317627
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.818359375 GB
    Memory Allocated: 0.14849281311035156  GigaBytes
Max Memory Allocated: 0.26349496841430664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9492051601409912
epoch time :  0.6527981758117676
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007467985153198242
pure dgl.metis_partition the time spent:  0.004767894744873047

block_gen_time in "generate_blocks_for_one_layer_block"  0.009194135665893555


block_gen_time in "generate_blocks_for_one_layer_block"  0.00960683822631836

connection checking time:  0.007025957107543945
block generation total time  0.018800973892211914
generate_dataloader_block spend   0.04429483413696289
pure train time  0.505894660949707
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.818359375 GB
    Memory Allocated: 0.1483173370361328  GigaBytes
Max Memory Allocated: 0.26349496841430664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9495041370391846
epoch time :  0.5967667102813721
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004497528076171875
pure dgl.metis_partition the time spent:  0.0032813549041748047

block_gen_time in "generate_blocks_for_one_layer_block"  0.010913372039794922


block_gen_time in "generate_blocks_for_one_layer_block"  0.011975526809692383

connection checking time:  0.009273767471313477
block generation total time  0.022888898849487305
generate_dataloader_block spend   0.04465746879577637
pure train time  0.5443994998931885
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.818359375 GB
    Memory Allocated: 0.14832639694213867  GigaBytes
Max Memory Allocated: 0.26349496841430664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9475733041763306
epoch time :  0.6333129405975342
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007309436798095703
pure dgl.metis_partition the time spent:  0.00475764274597168

block_gen_time in "generate_blocks_for_one_layer_block"  0.010941028594970703


block_gen_time in "generate_blocks_for_one_layer_block"  0.011985063552856445

connection checking time:  0.009411096572875977
block generation total time  0.02292609214782715
generate_dataloader_block spend   0.05068492889404297
pure train time  0.5332834720611572
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.818359375 GB
    Memory Allocated: 0.14907598495483398  GigaBytes
Max Memory Allocated: 0.26349496841430664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9491180181503296
epoch time :  0.6321444511413574
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008649826049804688
pure dgl.metis_partition the time spent:  0.005111217498779297

block_gen_time in "generate_blocks_for_one_layer_block"  0.011147737503051758


block_gen_time in "generate_blocks_for_one_layer_block"  0.01260828971862793

connection checking time:  0.01689887046813965
block generation total time  0.023756027221679688
generate_dataloader_block spend   0.06110334396362305
pure train time  0.5281238555908203
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.818359375 GB
    Memory Allocated: 0.14907360076904297  GigaBytes
Max Memory Allocated: 0.26349496841430664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9462289810180664
epoch time :  0.6372721195220947
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.874 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.874 GB
Metis partitioning: 0.001 seconds, peak memory: 23.874 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005357980728149414
pure dgl.metis_partition the time spent:  0.003855466842651367

block_gen_time in "generate_blocks_for_one_layer_block"  0.009730100631713867


block_gen_time in "generate_blocks_for_one_layer_block"  0.011137247085571289

connection checking time:  0.009000301361083984
block generation total time  0.020867347717285156
generate_dataloader_block spend   0.043951988220214844
pure train time  0.44709038734436035
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.818359375 GB
    Memory Allocated: 0.14862298965454102  GigaBytes
Max Memory Allocated: 0.26349496841430664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9483435153961182
epoch time :  0.5345065593719482
Total (block generation + training)time/epoch 0.6043482848576137
pure train time/epoch 0.5203361908594767

num_input_list  [1736, 1792, 1727, 1740, 1791, 1746, 1757, 1709, 1737, 1744]
