main start at this time 1700859613.9453614
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
self._in_src_feats,  1433
self._in_dst_feats 1433
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 22.856 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 22.856 GB
Metis partitioning: 0.000 seconds, peak memory: 22.856 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008248329162597656
pure dgl.metis_partition the time spent:  0.004273891448974609

block_gen_time in "generate_blocks_for_one_layer_block"  0.004381418228149414


block_gen_time in "generate_blocks_for_one_layer_block"  0.0049626827239990234

connection checking time:  0.006079196929931641
block generation total time  0.009344100952148438
pure train time  0.6620407104492188
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.826171875 GB
    Memory Allocated: 0.15027141571044922  GigaBytes
Max Memory Allocated: 0.21277141571044922  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9513280391693115
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.867 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.867 GB
Metis partitioning: 0.000 seconds, peak memory: 23.867 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.006631135940551758
pure dgl.metis_partition the time spent:  0.0034363269805908203

block_gen_time in "generate_blocks_for_one_layer_block"  0.005517244338989258


block_gen_time in "generate_blocks_for_one_layer_block"  0.006930351257324219

connection checking time:  0.007644176483154297
block generation total time  0.012447595596313477
pure train time  0.2580854892730713
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.841796875 GB
    Memory Allocated: 0.15039539337158203  GigaBytes
Max Memory Allocated: 0.2828865051269531  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.951117753982544
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.905 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.905 GB
Metis partitioning: 0.000 seconds, peak memory: 23.905 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007758378982543945
pure dgl.metis_partition the time spent:  0.0032422542572021484

block_gen_time in "generate_blocks_for_one_layer_block"  0.005105257034301758


block_gen_time in "generate_blocks_for_one_layer_block"  0.0071637630462646484

connection checking time:  0.00670623779296875
block generation total time  0.012269020080566406
pure train time  0.28638792037963867
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.841796875 GB
    Memory Allocated: 0.1511693000793457  GigaBytes
Max Memory Allocated: 0.2828865051269531  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9496898651123047
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.905 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.905 GB
Metis partitioning: 0.000 seconds, peak memory: 23.905 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00789189338684082
pure dgl.metis_partition the time spent:  0.003286600112915039

block_gen_time in "generate_blocks_for_one_layer_block"  0.0050907135009765625


block_gen_time in "generate_blocks_for_one_layer_block"  0.006879091262817383

connection checking time:  0.0071010589599609375
block generation total time  0.011969804763793945
generate_dataloader_block spend   0.03543901443481445
pure train time  0.29698848724365234
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.841796875 GB
    Memory Allocated: 0.15039491653442383  GigaBytes
Max Memory Allocated: 0.2828865051269531  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9492151737213135
epoch time :  0.36093592643737793
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.905 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.905 GB
Metis partitioning: 0.000 seconds, peak memory: 23.905 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008531332015991211
pure dgl.metis_partition the time spent:  0.0034639835357666016

block_gen_time in "generate_blocks_for_one_layer_block"  0.00560760498046875


block_gen_time in "generate_blocks_for_one_layer_block"  0.00777888298034668

connection checking time:  0.007436037063598633
block generation total time  0.01338648796081543
generate_dataloader_block spend   0.03843879699707031
pure train time  0.28224968910217285
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.845703125 GB
    Memory Allocated: 0.15039539337158203  GigaBytes
Max Memory Allocated: 0.2885308265686035  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9477760791778564
epoch time :  0.3547780513763428
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.905 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.905 GB
Metis partitioning: 0.000 seconds, peak memory: 23.905 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005540370941162109
pure dgl.metis_partition the time spent:  0.002644062042236328

block_gen_time in "generate_blocks_for_one_layer_block"  0.004996538162231445


block_gen_time in "generate_blocks_for_one_layer_block"  0.0068018436431884766

connection checking time:  0.006971597671508789
block generation total time  0.011798381805419922
generate_dataloader_block spend   0.03085613250732422
pure train time  0.25196099281311035
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.845703125 GB
    Memory Allocated: 0.15039491653442383  GigaBytes
Max Memory Allocated: 0.2885308265686035  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9475328922271729
epoch time :  0.31014490127563477
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.905 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.905 GB
Metis partitioning: 0.000 seconds, peak memory: 23.905 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008085012435913086
pure dgl.metis_partition the time spent:  0.0030324459075927734

block_gen_time in "generate_blocks_for_one_layer_block"  0.005129098892211914


block_gen_time in "generate_blocks_for_one_layer_block"  0.0072672367095947266

connection checking time:  0.007225751876831055
block generation total time  0.01239633560180664
generate_dataloader_block spend   0.03594231605529785
pure train time  0.2674226760864258
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.845703125 GB
    Memory Allocated: 0.15116643905639648  GigaBytes
Max Memory Allocated: 0.2885308265686035  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9499914646148682
epoch time :  0.3327474594116211
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.905 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.905 GB
Metis partitioning: 0.000 seconds, peak memory: 23.905 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008252382278442383
pure dgl.metis_partition the time spent:  0.003070831298828125

block_gen_time in "generate_blocks_for_one_layer_block"  0.005089759826660156


block_gen_time in "generate_blocks_for_one_layer_block"  0.006890296936035156

connection checking time:  0.0072057247161865234
block generation total time  0.011980056762695312
generate_dataloader_block spend   0.0356595516204834
pure train time  0.27926015853881836
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.84765625 GB
    Memory Allocated: 0.15073347091674805  GigaBytes
Max Memory Allocated: 0.2903308868408203  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9478678703308105
epoch time :  0.3430616855621338
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.905 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.905 GB
Metis partitioning: 0.000 seconds, peak memory: 23.905 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00802755355834961
pure dgl.metis_partition the time spent:  0.0030670166015625

block_gen_time in "generate_blocks_for_one_layer_block"  0.0051801204681396484


block_gen_time in "generate_blocks_for_one_layer_block"  0.007341861724853516

connection checking time:  0.007203578948974609
block generation total time  0.012521982192993164
generate_dataloader_block spend   0.03599238395690918
pure train time  0.26825404167175293
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.84765625 GB
    Memory Allocated: 0.15039443969726562  GigaBytes
Max Memory Allocated: 0.2903308868408203  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9457682371139526
epoch time :  0.3334019184112549
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.905 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.905 GB
Metis partitioning: 0.000 seconds, peak memory: 23.905 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007669925689697266
pure dgl.metis_partition the time spent:  0.0032396316528320312

block_gen_time in "generate_blocks_for_one_layer_block"  0.005156040191650391


block_gen_time in "generate_blocks_for_one_layer_block"  0.006876945495605469

connection checking time:  0.007058382034301758
block generation total time  0.01203298568725586
generate_dataloader_block spend   0.03526616096496582
pure train time  0.2669363021850586
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.84765625 GB
    Memory Allocated: 0.15039491653442383  GigaBytes
Max Memory Allocated: 0.2903308868408203  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.944758653640747
epoch time :  0.3307924270629883
Total (block generation + training)time/epoch 0.33797856739589144
pure train time/epoch 0.26934731006622314

num_input_list  [1559, 1641, 1616, 1610, 1608, 1604, 1590, 1628, 1595, 1588]
