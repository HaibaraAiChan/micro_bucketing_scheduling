main start at this time 1700860332.5937035
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
self._in_src_feats,  1433
self._in_dst_feats 1433
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.090 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.090 GB
Metis partitioning: 0.001 seconds, peak memory: 24.090 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009523868560791016
pure dgl.metis_partition the time spent:  0.005646467208862305

block_gen_time in "generate_blocks_for_one_layer_block"  0.011463642120361328


block_gen_time in "generate_blocks_for_one_layer_block"  0.01275491714477539

connection checking time:  0.013250589370727539
block generation total time  0.02421855926513672
pure train time  1.169064998626709
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.982421875 GB
    Memory Allocated: 2.0899457931518555  GigaBytes
Max Memory Allocated: 3.0899457931518555  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9520690441131592
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0051479339599609375
pure dgl.metis_partition the time spent:  0.004365444183349609

block_gen_time in "generate_blocks_for_one_layer_block"  0.010865926742553711


block_gen_time in "generate_blocks_for_one_layer_block"  0.012894392013549805

connection checking time:  0.013562679290771484
block generation total time  0.023760318756103516
pure train time  0.8407888412475586
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9921875 GB
    Memory Allocated: 2.0896406173706055  GigaBytes
Max Memory Allocated: 3.220114231109619  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.953527808189392
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00512385368347168
pure dgl.metis_partition the time spent:  0.0047838687896728516

block_gen_time in "generate_blocks_for_one_layer_block"  0.01084280014038086


block_gen_time in "generate_blocks_for_one_layer_block"  0.012948274612426758

connection checking time:  0.012284278869628906
block generation total time  0.023791074752807617
pure train time  0.8239128589630127
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9921875 GB
    Memory Allocated: 2.0904016494750977  GigaBytes
Max Memory Allocated: 3.22761869430542  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9503804445266724
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005087137222290039
pure dgl.metis_partition the time spent:  0.004049539566040039

block_gen_time in "generate_blocks_for_one_layer_block"  0.011140823364257812


block_gen_time in "generate_blocks_for_one_layer_block"  0.012820720672607422

connection checking time:  0.013602733612060547
block generation total time  0.023961544036865234
generate_dataloader_block spend   0.05371737480163574
pure train time  0.812258243560791
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.9921875 GB
    Memory Allocated: 2.089900493621826  GigaBytes
Max Memory Allocated: 3.241647720336914  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9499940872192383
epoch time :  2.495603561401367
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.227 GB
Metis partitioning: 0.001 seconds, peak memory: 27.227 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005073070526123047
pure dgl.metis_partition the time spent:  0.003984928131103516

block_gen_time in "generate_blocks_for_one_layer_block"  0.01120305061340332


block_gen_time in "generate_blocks_for_one_layer_block"  0.012674570083618164

connection checking time:  0.013736248016357422
block generation total time  0.023877620697021484
generate_dataloader_block spend   0.05385160446166992
pure train time  0.8018949031829834
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.001953125 GB
    Memory Allocated: 2.089810848236084  GigaBytes
Max Memory Allocated: 3.241647720336914  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9535319805145264
epoch time :  2.4823660850524902
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.265 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.265 GB
Metis partitioning: 0.001 seconds, peak memory: 27.265 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005098104476928711
pure dgl.metis_partition the time spent:  0.004012346267700195

block_gen_time in "generate_blocks_for_one_layer_block"  0.011234045028686523


block_gen_time in "generate_blocks_for_one_layer_block"  0.01261281967163086

connection checking time:  0.012155771255493164
block generation total time  0.023846864700317383
generate_dataloader_block spend   0.05380535125732422
pure train time  0.7947807312011719
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.001953125 GB
    Memory Allocated: 2.090269088745117  GigaBytes
Max Memory Allocated: 3.2422804832458496  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.950591802597046
epoch time :  2.402318000793457
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.265 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.265 GB
Metis partitioning: 0.001 seconds, peak memory: 27.265 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005094289779663086
pure dgl.metis_partition the time spent:  0.004065275192260742

block_gen_time in "generate_blocks_for_one_layer_block"  0.011330127716064453


block_gen_time in "generate_blocks_for_one_layer_block"  0.012660980224609375

connection checking time:  0.013504743576049805
block generation total time  0.023991107940673828
generate_dataloader_block spend   0.05349993705749512
pure train time  0.8161394596099854
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.001953125 GB
    Memory Allocated: 2.090268611907959  GigaBytes
Max Memory Allocated: 3.2422804832458496  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.94925856590271
epoch time :  2.486013412475586
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.265 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.265 GB
Metis partitioning: 0.001 seconds, peak memory: 27.265 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004961967468261719
pure dgl.metis_partition the time spent:  0.004029750823974609

block_gen_time in "generate_blocks_for_one_layer_block"  0.011207103729248047


block_gen_time in "generate_blocks_for_one_layer_block"  0.012613773345947266

connection checking time:  0.013372659683227539
block generation total time  0.023820877075195312
generate_dataloader_block spend   0.05495786666870117
pure train time  0.7718310356140137
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.001953125 GB
    Memory Allocated: 2.090269088745117  GigaBytes
Max Memory Allocated: 3.2422804832458496  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9500254392623901
epoch time :  2.4132165908813477
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.007 seconds, peak memory: 27.265 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.265 GB
Metis partitioning: 0.001 seconds, peak memory: 27.265 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004988670349121094
pure dgl.metis_partition the time spent:  0.010830402374267578

block_gen_time in "generate_blocks_for_one_layer_block"  0.011223793029785156


block_gen_time in "generate_blocks_for_one_layer_block"  0.012555122375488281

connection checking time:  0.010946989059448242
block generation total time  0.023778915405273438
generate_dataloader_block spend   0.05830049514770508
pure train time  0.7483470439910889
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.001953125 GB
    Memory Allocated: 2.0896387100219727  GigaBytes
Max Memory Allocated: 3.2581210136413574  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9502915143966675
epoch time :  2.3178701400756836
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 27.265 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.265 GB
Metis partitioning: 0.001 seconds, peak memory: 27.265 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005222797393798828
pure dgl.metis_partition the time spent:  0.003988742828369141

block_gen_time in "generate_blocks_for_one_layer_block"  0.011956453323364258


block_gen_time in "generate_blocks_for_one_layer_block"  0.012653112411499023

connection checking time:  0.011914730072021484
block generation total time  0.02460956573486328
generate_dataloader_block spend   0.054688453674316406
pure train time  0.7979836463928223
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.001953125 GB
    Memory Allocated: 2.089996814727783  GigaBytes
Max Memory Allocated: 3.2581210136413574  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9480338096618652
epoch time :  2.5145070552825928
Total (block generation + training)time/epoch 2.4445558275495256
pure train time/epoch 0.7884961366653442

num_input_list  [1749, 1828, 1815, 1781, 1825, 1793, 1857, 1751, 1743, 1849]
