main start at this time 1700806377.0896926
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
self._in_src_feats,  602
self._in_dst_feats 602
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.340 seconds, peak memory: 36.495 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.495 GB
Metis partitioning: 9.224 seconds, peak memory: 36.495 GB
Split the graph: 0.646 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  3.969670057296753
pure dgl.metis_partition the time spent:  11.232527256011963

block_gen_time in "generate_blocks_for_one_layer_block"  2.324380874633789

connection checking time:  1.359034776687622
block generation total time  2.324380874633789
pure train time  1.2749269008636475
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.982421875 GB
    Memory Allocated: 0.31520938873291016  GigaBytes
Max Memory Allocated: 8.999208927154541  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.93365478515625
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.305 seconds, peak memory: 57.231 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 57.231 GB
Metis partitioning: 10.963 seconds, peak memory: 61.252 GB
Split the graph: 0.942 seconds
Construct subgraphs: 0.243 seconds
REG metis partition end ----................................
REG construction  time spent:  4.26068115234375
pure dgl.metis_partition the time spent:  13.455303192138672

block_gen_time in "generate_blocks_for_one_layer_block"  1.8666388988494873

connection checking time:  1.327763557434082
block generation total time  1.8666388988494873
pure train time  0.6504557132720947
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.986328125 GB
    Memory Allocated: 0.31312084197998047  GigaBytes
Max Memory Allocated: 9.04487657546997  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.870162010192871
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.305 seconds, peak memory: 62.524 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 62.524 GB
Metis partitioning: 11.370 seconds, peak memory: 62.524 GB
Split the graph: 1.031 seconds
Construct subgraphs: 0.226 seconds
REG metis partition end ----................................
REG construction  time spent:  4.255354642868042
pure dgl.metis_partition the time spent:  13.933844804763794

block_gen_time in "generate_blocks_for_one_layer_block"  1.8412470817565918

connection checking time:  1.3241987228393555
block generation total time  1.8412470817565918
pure train time  0.6333773136138916
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.98828125 GB
    Memory Allocated: 0.31374645233154297  GigaBytes
Max Memory Allocated: 9.04611587524414  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.807301044464111
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.310 seconds, peak memory: 63.320 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 63.320 GB
Metis partitioning: 11.142 seconds, peak memory: 63.320 GB
Split the graph: 1.045 seconds
Construct subgraphs: 0.242 seconds
REG metis partition end ----................................
REG construction  time spent:  4.195728540420532
pure dgl.metis_partition the time spent:  13.740989208221436

block_gen_time in "generate_blocks_for_one_layer_block"  1.8717281818389893

connection checking time:  1.337533950805664
block generation total time  1.8717281818389893
generate_dataloader_block spend   22.11159658432007
pure train time  0.6745243072509766
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.4765625 GB
    Memory Allocated: 0.3210620880126953  GigaBytes
Max Memory Allocated: 9.100608348846436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.7245893478393555
epoch time :  29.28396439552307
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.354 seconds, peak memory: 65.323 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 65.323 GB
Metis partitioning: 9.912 seconds, peak memory: 65.323 GB
Split the graph: 0.847 seconds
Construct subgraphs: 0.222 seconds
REG metis partition end ----................................
REG construction  time spent:  4.433286190032959
pure dgl.metis_partition the time spent:  12.33742356300354

block_gen_time in "generate_blocks_for_one_layer_block"  1.8923261165618896

connection checking time:  1.3593440055847168
block generation total time  1.8923261165618896
generate_dataloader_block spend   20.986034393310547
pure train time  0.6297712326049805
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.478515625 GB
    Memory Allocated: 0.31805944442749023  GigaBytes
Max Memory Allocated: 9.115336418151855  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.597198963165283
epoch time :  28.141312837600708
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.392 seconds, peak memory: 65.882 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 65.882 GB
Metis partitioning: 11.304 seconds, peak memory: 65.882 GB
Split the graph: 0.977 seconds
Construct subgraphs: 0.221 seconds
REG metis partition end ----................................
REG construction  time spent:  4.6755430698394775
pure dgl.metis_partition the time spent:  13.897051095962524

block_gen_time in "generate_blocks_for_one_layer_block"  1.874222755432129

connection checking time:  1.4392120838165283
block generation total time  1.874222755432129
generate_dataloader_block spend   22.846379041671753
pure train time  0.6454198360443115
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.4921875 GB
    Memory Allocated: 0.2928447723388672  GigaBytes
Max Memory Allocated: 9.115336418151855  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.386484622955322
epoch time :  29.984966278076172
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.398 seconds, peak memory: 66.007 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 66.007 GB
Metis partitioning: 11.846 seconds, peak memory: 66.007 GB
Split the graph: 1.006 seconds
Construct subgraphs: 0.233 seconds
REG metis partition end ----................................
REG construction  time spent:  4.394798040390015
pure dgl.metis_partition the time spent:  14.485065221786499

block_gen_time in "generate_blocks_for_one_layer_block"  1.8636126518249512

connection checking time:  1.3240196704864502
block generation total time  1.8636126518249512
generate_dataloader_block spend   23.028032064437866
pure train time  0.6631913185119629
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.5 GB
    Memory Allocated: 0.2922024726867676  GigaBytes
Max Memory Allocated: 9.115336418151855  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.17301607131958
epoch time :  30.22002387046814
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.363 seconds, peak memory: 66.531 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 66.531 GB
Metis partitioning: 11.883 seconds, peak memory: 66.531 GB
Split the graph: 0.955 seconds
Construct subgraphs: 0.229 seconds
REG metis partition end ----................................
REG construction  time spent:  4.3073530197143555
pure dgl.metis_partition the time spent:  14.431931734085083

block_gen_time in "generate_blocks_for_one_layer_block"  1.9052150249481201

connection checking time:  1.347522497177124
block generation total time  1.9052150249481201
generate_dataloader_block spend   22.961299180984497
pure train time  0.693476676940918
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.5 GB
    Memory Allocated: 0.31894588470458984  GigaBytes
Max Memory Allocated: 9.115336418151855  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.018272876739502
epoch time :  30.086690187454224
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.334 seconds, peak memory: 66.648 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 66.648 GB
Metis partitioning: 11.282 seconds, peak memory: 66.648 GB
Split the graph: 0.944 seconds
Construct subgraphs: 0.235 seconds
REG metis partition end ----................................
REG construction  time spent:  4.776332855224609
pure dgl.metis_partition the time spent:  13.797913789749146

block_gen_time in "generate_blocks_for_one_layer_block"  1.9144155979156494

connection checking time:  1.3549284934997559
block generation total time  1.9144155979156494
generate_dataloader_block spend   22.810539960861206
pure train time  0.667550802230835
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.5 GB
    Memory Allocated: 0.3146491050720215  GigaBytes
Max Memory Allocated: 9.115336418151855  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.898369312286377
epoch time :  29.94520092010498
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.366 seconds, peak memory: 66.710 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 66.710 GB
Metis partitioning: 12.048 seconds, peak memory: 66.710 GB
Split the graph: 0.911 seconds
Construct subgraphs: 0.242 seconds
REG metis partition end ----................................
REG construction  time spent:  4.441246509552002
pure dgl.metis_partition the time spent:  14.568608045578003

block_gen_time in "generate_blocks_for_one_layer_block"  1.9131100177764893

connection checking time:  1.3443996906280518
block generation total time  1.9131100177764893
generate_dataloader_block spend   23.26048469543457
pure train time  0.6875283718109131
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.5 GB
    Memory Allocated: 0.31612730026245117  GigaBytes
Max Memory Allocated: 9.115336418151855  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.8070502281188965
epoch time :  30.32578682899475
Total (block generation + training)time/epoch 29.712562595094955
pure train time/epoch 0.6644897063573202

num_input_list  [445824, 443012, 436305, 444854, 439676, 452923, 438414, 442841, 456840, 437860]
