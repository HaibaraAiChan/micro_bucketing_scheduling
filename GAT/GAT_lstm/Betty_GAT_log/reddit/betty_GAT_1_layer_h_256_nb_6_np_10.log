main start at this time 1700805455.2635894
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
self._in_src_feats,  602
self._in_dst_feats 602
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.390 seconds, peak memory: 36.493 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.493 GB
Metis partitioning: 8.818 seconds, peak memory: 36.493 GB
Split the graph: 1.135 seconds
Construct subgraphs: 0.011 seconds
REG metis partition end ----................................
REG construction  time spent:  4.06907844543457
pure dgl.metis_partition the time spent:  11.35567569732666

block_gen_time in "generate_blocks_for_one_layer_block"  2.3468198776245117

connection checking time:  1.2921183109283447
block generation total time  2.3468198776245117
pure train time  2.0536422729492188
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.1015625 GB
    Memory Allocated: 0.41485118865966797  GigaBytes
Max Memory Allocated: 17.763991355895996  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.933745861053467
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.347 seconds, peak memory: 61.710 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 61.710 GB
Metis partitioning: 10.343 seconds, peak memory: 61.710 GB
Split the graph: 1.635 seconds
Construct subgraphs: 0.034 seconds
REG metis partition end ----................................
REG construction  time spent:  4.3617799282073975
pure dgl.metis_partition the time spent:  13.361801624298096

block_gen_time in "generate_blocks_for_one_layer_block"  1.9163124561309814

connection checking time:  1.2537407875061035
block generation total time  1.9163124561309814
pure train time  0.44591450691223145
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 0.40474414825439453  GigaBytes
Max Memory Allocated: 17.763991355895996  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.869899272918701
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.540 seconds, peak memory: 61.968 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 61.968 GB
Metis partitioning: 11.431 seconds, peak memory: 61.968 GB
Split the graph: 1.433 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  4.313527822494507
pure dgl.metis_partition the time spent:  14.420809507369995

block_gen_time in "generate_blocks_for_one_layer_block"  1.8653452396392822

connection checking time:  1.2637465000152588
block generation total time  1.8653452396392822
pure train time  0.42998242378234863
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 0.4195370674133301  GigaBytes
Max Memory Allocated: 17.804118156433105  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.807163238525391
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.288 seconds, peak memory: 67.245 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 67.245 GB
Metis partitioning: 10.823 seconds, peak memory: 67.245 GB
Split the graph: 1.191 seconds
Construct subgraphs: 0.241 seconds
REG metis partition end ----................................
REG construction  time spent:  4.299771547317505
pure dgl.metis_partition the time spent:  13.545712947845459

block_gen_time in "generate_blocks_for_one_layer_block"  1.8773927688598633

connection checking time:  1.3280930519104004
block generation total time  1.8773927688598633
generate_dataloader_block spend   21.997863292694092
pure train time  0.8941314220428467
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.189453125 GB
    Memory Allocated: 0.4265260696411133  GigaBytes
Max Memory Allocated: 17.80891180038452  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.724720001220703
epoch time :  28.97048020362854
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.433 seconds, peak memory: 69.707 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.707 GB
Metis partitioning: 9.558 seconds, peak memory: 69.707 GB
Split the graph: 1.211 seconds
Construct subgraphs: 0.016 seconds
REG metis partition end ----................................
REG construction  time spent:  4.665888547897339
pure dgl.metis_partition the time spent:  12.221243381500244

block_gen_time in "generate_blocks_for_one_layer_block"  1.8933584690093994

connection checking time:  1.2824616432189941
block generation total time  1.8933584690093994
generate_dataloader_block spend   21.049845457077026
pure train time  0.4588024616241455
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.169921875 GB
    Memory Allocated: 0.4237689971923828  GigaBytes
Max Memory Allocated: 17.80891180038452  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.59628963470459
epoch time :  27.95503282546997
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.352 seconds, peak memory: 69.707 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.707 GB
Metis partitioning: 10.674 seconds, peak memory: 69.707 GB
Split the graph: 1.400 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  4.45408296585083
pure dgl.metis_partition the time spent:  13.444636106491089

block_gen_time in "generate_blocks_for_one_layer_block"  1.931483268737793

connection checking time:  1.2836196422576904
block generation total time  1.931483268737793
generate_dataloader_block spend   22.14126992225647
pure train time  0.45583152770996094
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.169921875 GB
    Memory Allocated: 0.4185647964477539  GigaBytes
Max Memory Allocated: 17.80891180038452  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.385782241821289
epoch time :  29.043644428253174
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.359 seconds, peak memory: 70.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.632 GB
Metis partitioning: 10.769 seconds, peak memory: 70.632 GB
Split the graph: 1.378 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  4.325612306594849
pure dgl.metis_partition the time spent:  13.522841453552246

block_gen_time in "generate_blocks_for_one_layer_block"  1.8814523220062256

connection checking time:  1.2778117656707764
block generation total time  1.8814523220062256
generate_dataloader_block spend   22.042471647262573
pure train time  0.44910359382629395
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.169921875 GB
    Memory Allocated: 0.41483211517333984  GigaBytes
Max Memory Allocated: 17.80891180038452  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.172331809997559
epoch time :  28.94676446914673
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.436 seconds, peak memory: 70.789 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.789 GB
Metis partitioning: 10.820 seconds, peak memory: 70.789 GB
Split the graph: 1.557 seconds
Construct subgraphs: 0.012 seconds
REG metis partition end ----................................
REG construction  time spent:  4.570055961608887
pure dgl.metis_partition the time spent:  13.827153205871582

block_gen_time in "generate_blocks_for_one_layer_block"  1.9490966796875

connection checking time:  1.3078417778015137
block generation total time  1.9490966796875
generate_dataloader_block spend   22.713252782821655
pure train time  0.4595518112182617
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.169921875 GB
    Memory Allocated: 0.41651010513305664  GigaBytes
Max Memory Allocated: 17.80891180038452  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.018170356750488
epoch time :  29.606647491455078
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.387 seconds, peak memory: 71.757 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 71.757 GB
Metis partitioning: 11.274 seconds, peak memory: 71.757 GB
Split the graph: 1.283 seconds
Construct subgraphs: 0.012 seconds
REG metis partition end ----................................
REG construction  time spent:  4.2843828201293945
pure dgl.metis_partition the time spent:  13.959019899368286

block_gen_time in "generate_blocks_for_one_layer_block"  1.9127748012542725

connection checking time:  1.2908952236175537
block generation total time  1.9127748012542725
generate_dataloader_block spend   22.480671644210815
pure train time  0.4730980396270752
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.169921875 GB
    Memory Allocated: 0.423983097076416  GigaBytes
Max Memory Allocated: 17.82716178894043  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.8982625007629395
epoch time :  29.41228985786438
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.326 seconds, peak memory: 71.882 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 71.882 GB
Metis partitioning: 11.045 seconds, peak memory: 71.882 GB
Split the graph: 1.348 seconds
Construct subgraphs: 0.012 seconds
REG metis partition end ----................................
REG construction  time spent:  4.365902423858643
pure dgl.metis_partition the time spent:  13.732920408248901

block_gen_time in "generate_blocks_for_one_layer_block"  1.897895097732544

connection checking time:  1.2923924922943115
block generation total time  1.897895097732544
generate_dataloader_block spend   22.285988092422485
pure train time  0.43303942680358887
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.154296875 GB
    Memory Allocated: 0.4279050827026367  GigaBytes
Max Memory Allocated: 17.82716178894043  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.806532382965088
epoch time :  29.288849592208862
Total (block generation + training)time/epoch 29.031957251685007
pure train time/epoch 0.4549044768015544

num_input_list  [383363, 348024, 357177, 358286, 353938, 364290, 350552, 363391, 365199, 360136]
