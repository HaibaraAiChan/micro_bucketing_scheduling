main start at this time 1700807003.4149313
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
self._in_src_feats,  602
self._in_dst_feats 602
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.333 seconds, peak memory: 36.498 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.498 GB
Metis partitioning: 9.963 seconds, peak memory: 36.498 GB
Split the graph: 0.427 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  4.034294128417969
pure dgl.metis_partition the time spent:  11.745510816574097

block_gen_time in "generate_blocks_for_one_layer_block"  2.2480430603027344

connection checking time:  1.392833948135376
block generation total time  2.2480430603027344
pure train time  1.3795368671417236
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.40625 GB
    Memory Allocated: 0.2744479179382324  GigaBytes
Max Memory Allocated: 6.886947154998779  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.933145523071289
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.345 seconds, peak memory: 47.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.712 GB
Metis partitioning: 11.243 seconds, peak memory: 47.712 GB
Split the graph: 0.706 seconds
Construct subgraphs: 0.249 seconds
REG metis partition end ----................................
REG construction  time spent:  4.334510087966919
pure dgl.metis_partition the time spent:  13.545431852340698

block_gen_time in "generate_blocks_for_one_layer_block"  1.2701911926269531

connection checking time:  0.6967756748199463
block generation total time  1.2701911926269531
pure train time  0.713362455368042
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.40625 GB
    Memory Allocated: 0.2801089286804199  GigaBytes
Max Memory Allocated: 6.940645217895508  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.869904041290283
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.344 seconds, peak memory: 48.185 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.185 GB
Metis partitioning: 11.177 seconds, peak memory: 48.185 GB
Split the graph: 0.853 seconds
Construct subgraphs: 0.029 seconds
REG metis partition end ----................................
REG construction  time spent:  4.249313116073608
pure dgl.metis_partition the time spent:  13.403514385223389

block_gen_time in "generate_blocks_for_one_layer_block"  1.9785387516021729

connection checking time:  1.4236564636230469
block generation total time  1.9785387516021729
pure train time  0.7812511920928955
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.408203125 GB
    Memory Allocated: 0.29154253005981445  GigaBytes
Max Memory Allocated: 6.940645217895508  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.806557655334473
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.314 seconds, peak memory: 48.404 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.404 GB
Metis partitioning: 11.203 seconds, peak memory: 48.404 GB
Split the graph: 0.767 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  4.242630481719971
pure dgl.metis_partition the time spent:  13.309653043746948

block_gen_time in "generate_blocks_for_one_layer_block"  1.8914530277252197

connection checking time:  1.4484777450561523
block generation total time  1.8914530277252197
generate_dataloader_block spend   21.96024203300476
pure train time  0.9948329925537109
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.408203125 GB
    Memory Allocated: 0.2862553596496582  GigaBytes
Max Memory Allocated: 6.959796905517578  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.724634647369385
epoch time :  29.342716217041016
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.328 seconds, peak memory: 48.553 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.553 GB
Metis partitioning: 9.972 seconds, peak memory: 48.553 GB
Split the graph: 0.745 seconds
Construct subgraphs: 0.024 seconds
REG metis partition end ----................................
REG construction  time spent:  3.200988292694092
pure dgl.metis_partition the time spent:  12.0719575881958

block_gen_time in "generate_blocks_for_one_layer_block"  1.9093024730682373

connection checking time:  1.3634912967681885
block generation total time  1.9093024730682373
generate_dataloader_block spend   19.559366703033447
pure train time  0.8490080833435059
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 13.865234375 GB
    Memory Allocated: 0.2869095802307129  GigaBytes
Max Memory Allocated: 6.959796905517578  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.595601558685303
epoch time :  26.926825761795044
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.341 seconds, peak memory: 53.220 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 53.220 GB
Metis partitioning: 11.632 seconds, peak memory: 53.220 GB
Split the graph: 0.761 seconds
Construct subgraphs: 0.039 seconds
REG metis partition end ----................................
REG construction  time spent:  4.306996822357178
pure dgl.metis_partition the time spent:  13.776146173477173

block_gen_time in "generate_blocks_for_one_layer_block"  1.8897349834442139

connection checking time:  1.399214267730713
block generation total time  1.8897349834442139
generate_dataloader_block spend   22.429369926452637
pure train time  0.8435428142547607
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 13.865234375 GB
    Memory Allocated: 0.2841639518737793  GigaBytes
Max Memory Allocated: 6.959796905517578  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.385013103485107
epoch time :  29.80855107307434
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.318 seconds, peak memory: 53.225 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 53.225 GB
Metis partitioning: 11.507 seconds, peak memory: 57.241 GB
Split the graph: 0.779 seconds
Construct subgraphs: 0.030 seconds
REG metis partition end ----................................
REG construction  time spent:  4.268679141998291
pure dgl.metis_partition the time spent:  13.636258363723755

block_gen_time in "generate_blocks_for_one_layer_block"  1.8647944927215576

connection checking time:  1.4017612934112549
block generation total time  1.8647944927215576
generate_dataloader_block spend   22.243800401687622
pure train time  0.8001492023468018
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 13.865234375 GB
    Memory Allocated: 0.2825355529785156  GigaBytes
Max Memory Allocated: 6.959796905517578  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.1715898513793945
epoch time :  29.57521414756775
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.294 seconds, peak memory: 57.244 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 57.244 GB
Metis partitioning: 11.895 seconds, peak memory: 57.244 GB
Split the graph: 0.808 seconds
Construct subgraphs: 0.044 seconds
REG metis partition end ----................................
REG construction  time spent:  4.277493715286255
pure dgl.metis_partition the time spent:  14.043246984481812

block_gen_time in "generate_blocks_for_one_layer_block"  1.8740968704223633

connection checking time:  1.3982841968536377
block generation total time  1.8740968704223633
generate_dataloader_block spend   22.64421033859253
pure train time  0.8510806560516357
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 13.865234375 GB
    Memory Allocated: 0.27064085006713867  GigaBytes
Max Memory Allocated: 6.959796905517578  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.017093181610107
epoch time :  29.99158549308777
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.337 seconds, peak memory: 57.291 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 57.291 GB
Metis partitioning: 11.668 seconds, peak memory: 57.291 GB
Split the graph: 0.778 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  4.310688495635986
pure dgl.metis_partition the time spent:  13.802269220352173

block_gen_time in "generate_blocks_for_one_layer_block"  1.8778855800628662

connection checking time:  1.3703453540802002
block generation total time  1.8778855800628662
generate_dataloader_block spend   22.457969665527344
pure train time  0.832716703414917
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 13.865234375 GB
    Memory Allocated: 0.2702021598815918  GigaBytes
Max Memory Allocated: 6.959796905517578  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.8972015380859375
epoch time :  29.800278186798096
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.425 seconds, peak memory: 57.291 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 57.291 GB
Metis partitioning: 11.466 seconds, peak memory: 57.291 GB
Split the graph: 0.554 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  4.242376089096069
pure dgl.metis_partition the time spent:  13.465796947479248

block_gen_time in "generate_blocks_for_one_layer_block"  1.9330811500549316

connection checking time:  0.9909212589263916
block generation total time  1.9330811500549316
generate_dataloader_block spend   21.528262853622437
pure train time  0.7662439346313477
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 13.865234375 GB
    Memory Allocated: 0.27811527252197266  GigaBytes
Max Memory Allocated: 6.959796905517578  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.805301189422607
epoch time :  28.861047983169556
Total (block generation + training)time/epoch 29.186601672853744
pure train time/epoch 0.8237902323404948

num_input_list  [478861, 488956, 485784, 478321, 483045, 487745, 483925, 483712, 479867, 482445]
