main start at this time 1700806689.5654638
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
self._in_src_feats,  602
self._in_dst_feats 602
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.383 seconds, peak memory: 36.496 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.496 GB
Metis partitioning: 9.272 seconds, peak memory: 36.496 GB
Split the graph: 0.484 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  4.067671775817871
pure dgl.metis_partition the time spent:  11.161651611328125

block_gen_time in "generate_blocks_for_one_layer_block"  2.2120821475982666

connection checking time:  1.367626428604126
block generation total time  2.2120821475982666
pure train time  1.267500400543213
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.29671239852905273  GigaBytes
Max Memory Allocated: 7.731826305389404  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.933223247528076
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.392 seconds, peak memory: 59.041 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 59.041 GB
Metis partitioning: 11.243 seconds, peak memory: 59.041 GB
Split the graph: 0.945 seconds
Construct subgraphs: 0.239 seconds
REG metis partition end ----................................
REG construction  time spent:  4.438682556152344
pure dgl.metis_partition the time spent:  13.821627378463745

block_gen_time in "generate_blocks_for_one_layer_block"  1.8872029781341553

connection checking time:  1.3374371528625488
block generation total time  1.8872029781341553
pure train time  0.6236121654510498
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.2893185615539551  GigaBytes
Max Memory Allocated: 7.803101539611816  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.869714260101318
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.338 seconds, peak memory: 60.104 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 60.104 GB
Metis partitioning: 11.679 seconds, peak memory: 64.121 GB
Split the graph: 0.703 seconds
Construct subgraphs: 0.228 seconds
REG metis partition end ----................................
REG construction  time spent:  4.4290759563446045
pure dgl.metis_partition the time spent:  13.949610948562622

block_gen_time in "generate_blocks_for_one_layer_block"  1.9441184997558594

connection checking time:  1.3426384925842285
block generation total time  1.9441184997558594
pure train time  0.6858694553375244
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.33203125 GB
    Memory Allocated: 0.28336048126220703  GigaBytes
Max Memory Allocated: 7.845066070556641  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.806304931640625
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.310 seconds, peak memory: 64.879 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 64.879 GB
Metis partitioning: 11.487 seconds, peak memory: 64.879 GB
Split the graph: 0.797 seconds
Construct subgraphs: 0.173 seconds
REG metis partition end ----................................
REG construction  time spent:  4.252770185470581
pure dgl.metis_partition the time spent:  13.768231868743896

block_gen_time in "generate_blocks_for_one_layer_block"  1.243274211883545

connection checking time:  1.332242488861084
block generation total time  1.243274211883545
generate_dataloader_block spend   21.5616614818573
pure train time  0.5778310298919678
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.33203125 GB
    Memory Allocated: 0.2891683578491211  GigaBytes
Max Memory Allocated: 7.845066070556641  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.724339008331299
epoch time :  28.699720859527588
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.431 seconds, peak memory: 65.479 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 65.479 GB
Metis partitioning: 10.828 seconds, peak memory: 65.479 GB
Split the graph: 0.794 seconds
Construct subgraphs: 0.232 seconds
REG metis partition end ----................................
REG construction  time spent:  3.665039539337158
pure dgl.metis_partition the time spent:  13.287126541137695

block_gen_time in "generate_blocks_for_one_layer_block"  1.8596396446228027

connection checking time:  1.4067857265472412
block generation total time  1.8596396446228027
generate_dataloader_block spend   21.159108877182007
pure train time  0.6922905445098877
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.33203125 GB
    Memory Allocated: 0.2951803207397461  GigaBytes
Max Memory Allocated: 7.845066070556641  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.5953593254089355
epoch time :  28.50404405593872
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.381 seconds, peak memory: 65.776 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 65.776 GB
Metis partitioning: 11.783 seconds, peak memory: 65.776 GB
Split the graph: 0.836 seconds
Construct subgraphs: 0.239 seconds
REG metis partition end ----................................
REG construction  time spent:  4.364543199539185
pure dgl.metis_partition the time spent:  14.240396976470947

block_gen_time in "generate_blocks_for_one_layer_block"  1.8626844882965088

connection checking time:  1.3832054138183594
block generation total time  1.8626844882965088
generate_dataloader_block spend   22.820734977722168
pure train time  0.6741428375244141
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.33203125 GB
    Memory Allocated: 0.293520450592041  GigaBytes
Max Memory Allocated: 7.845066070556641  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.384762763977051
epoch time :  30.04024076461792
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.363 seconds, peak memory: 65.776 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 65.776 GB
Metis partitioning: 11.878 seconds, peak memory: 65.776 GB
Split the graph: 0.892 seconds
Construct subgraphs: 0.224 seconds
REG metis partition end ----................................
REG construction  time spent:  4.584402322769165
pure dgl.metis_partition the time spent:  14.359366416931152

block_gen_time in "generate_blocks_for_one_layer_block"  1.88377046585083

connection checking time:  1.364041805267334
block generation total time  1.88377046585083
generate_dataloader_block spend   23.134491443634033
pure train time  0.6964666843414307
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.337890625 GB
    Memory Allocated: 0.29322242736816406  GigaBytes
Max Memory Allocated: 7.845066070556641  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.171701431274414
epoch time :  30.47689914703369
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.399 seconds, peak memory: 65.998 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 65.998 GB
Metis partitioning: 11.597 seconds, peak memory: 65.998 GB
Split the graph: 0.951 seconds
Construct subgraphs: 0.226 seconds
REG metis partition end ----................................
REG construction  time spent:  4.37241530418396
pure dgl.metis_partition the time spent:  14.175901174545288

block_gen_time in "generate_blocks_for_one_layer_block"  1.897364616394043

connection checking time:  1.368927001953125
block generation total time  1.897364616394043
generate_dataloader_block spend   22.739617109298706
pure train time  0.7000331878662109
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.337890625 GB
    Memory Allocated: 0.2991957664489746  GigaBytes
Max Memory Allocated: 7.845066070556641  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.017740249633789
epoch time :  29.964142560958862
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.420 seconds, peak memory: 66.053 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 66.053 GB
Metis partitioning: 12.050 seconds, peak memory: 66.053 GB
Split the graph: 0.807 seconds
Construct subgraphs: 0.238 seconds
REG metis partition end ----................................
REG construction  time spent:  4.411797046661377
pure dgl.metis_partition the time spent:  14.51753044128418

block_gen_time in "generate_blocks_for_one_layer_block"  1.8347959518432617

connection checking time:  1.3353140354156494
block generation total time  1.8347959518432617
generate_dataloader_block spend   23.11055827140808
pure train time  0.672199010848999
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.337890625 GB
    Memory Allocated: 0.29885339736938477  GigaBytes
Max Memory Allocated: 7.845066070556641  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.897547245025635
epoch time :  30.35400080680847
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.371 seconds, peak memory: 66.108 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 66.108 GB
Metis partitioning: 11.650 seconds, peak memory: 66.108 GB
Split the graph: 0.851 seconds
Construct subgraphs: 0.224 seconds
REG metis partition end ----................................
REG construction  time spent:  4.841335296630859
pure dgl.metis_partition the time spent:  14.098212003707886

block_gen_time in "generate_blocks_for_one_layer_block"  1.9239602088928223

connection checking time:  1.3865320682525635
block generation total time  1.9239602088928223
generate_dataloader_block spend   23.175801038742065
pure train time  0.6842772960662842
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.337890625 GB
    Memory Allocated: 0.2930130958557129  GigaBytes
Max Memory Allocated: 7.845066070556641  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.8063063621521
epoch time :  30.426521062850952
Total (block generation + training)time/epoch 29.780794313975743
pure train time/epoch 0.6865682601928711

num_input_list  [464045, 459380, 460719, 443402, 476372, 454103, 463928, 456373, 461128, 473747]
