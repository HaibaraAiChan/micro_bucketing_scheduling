main start at this time 1700805763.5002108
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
self._in_src_feats,  602
self._in_dst_feats 602
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.330 seconds, peak memory: 36.498 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.498 GB
Metis partitioning: 9.155 seconds, peak memory: 36.498 GB
Split the graph: 0.828 seconds
Construct subgraphs: 0.012 seconds
REG metis partition end ----................................
REG construction  time spent:  3.9704742431640625
pure dgl.metis_partition the time spent:  11.327327966690063

block_gen_time in "generate_blocks_for_one_layer_block"  2.185447931289673

connection checking time:  1.3280298709869385
block generation total time  2.185447931289673
pure train time  1.515162467956543
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.5 GB
    Memory Allocated: 0.3678736686706543  GigaBytes
Max Memory Allocated: 13.431236267089844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.933019161224365
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.374 seconds, peak memory: 63.065 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 63.065 GB
Metis partitioning: 11.163 seconds, peak memory: 63.065 GB
Split the graph: 1.042 seconds
Construct subgraphs: 0.006 seconds
REG metis partition end ----................................
REG construction  time spent:  4.419119119644165
pure dgl.metis_partition the time spent:  13.587578535079956

block_gen_time in "generate_blocks_for_one_layer_block"  1.911064863204956

connection checking time:  1.2934045791625977
block generation total time  1.911064863204956
pure train time  1.4443438053131104
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.5390625 GB
    Memory Allocated: 0.3570065498352051  GigaBytes
Max Memory Allocated: 13.605919361114502  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.870419502258301
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.311 seconds, peak memory: 68.873 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 68.873 GB
Metis partitioning: 11.025 seconds, peak memory: 68.873 GB
Split the graph: 1.159 seconds
Construct subgraphs: 0.216 seconds
REG metis partition end ----................................
REG construction  time spent:  4.331615447998047
pure dgl.metis_partition the time spent:  13.71241307258606

block_gen_time in "generate_blocks_for_one_layer_block"  1.9392144680023193

connection checking time:  1.2797787189483643
block generation total time  1.9392144680023193
pure train time  0.5800833702087402
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.70703125 GB
    Memory Allocated: 0.33720874786376953  GigaBytes
Max Memory Allocated: 13.605919361114502  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.806841850280762
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.330 seconds, peak memory: 68.873 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 68.873 GB
Metis partitioning: 10.863 seconds, peak memory: 68.873 GB
Split the graph: 0.904 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  4.43155837059021
pure dgl.metis_partition the time spent:  13.113510847091675

block_gen_time in "generate_blocks_for_one_layer_block"  1.8815279006958008

connection checking time:  1.253713607788086
block generation total time  1.8815279006958008
generate_dataloader_block spend   21.7079598903656
pure train time  0.8201828002929688
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.708984375 GB
    Memory Allocated: 0.36876773834228516  GigaBytes
Max Memory Allocated: 13.605919361114502  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.724894046783447
epoch time :  28.73444890975952
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.376 seconds, peak memory: 71.110 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 71.110 GB
Metis partitioning: 10.483 seconds, peak memory: 71.110 GB
Split the graph: 1.146 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  4.310766696929932
pure dgl.metis_partition the time spent:  13.030293226242065

block_gen_time in "generate_blocks_for_one_layer_block"  1.9082458019256592

connection checking time:  1.2921819686889648
block generation total time  1.9082458019256592
generate_dataloader_block spend   21.54963493347168
pure train time  0.5467033386230469
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.37109375 GB
    Memory Allocated: 0.3564009666442871  GigaBytes
Max Memory Allocated: 13.605919361114502  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.59544038772583
epoch time :  28.49450421333313
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.358 seconds, peak memory: 71.110 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 71.110 GB
Metis partitioning: 11.204 seconds, peak memory: 71.110 GB
Split the graph: 1.196 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  4.458348035812378
pure dgl.metis_partition the time spent:  13.775900602340698

block_gen_time in "generate_blocks_for_one_layer_block"  1.895444631576538

connection checking time:  1.3076679706573486
block generation total time  1.895444631576538
generate_dataloader_block spend   22.480030298233032
pure train time  0.530320405960083
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.37109375 GB
    Memory Allocated: 0.3589491844177246  GigaBytes
Max Memory Allocated: 13.605919361114502  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.385003566741943
epoch time :  29.447499990463257
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.361 seconds, peak memory: 71.110 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 71.110 GB
Metis partitioning: 11.304 seconds, peak memory: 71.110 GB
Split the graph: 1.139 seconds
Construct subgraphs: 0.016 seconds
REG metis partition end ----................................
REG construction  time spent:  4.460623025894165
pure dgl.metis_partition the time spent:  13.8215012550354

block_gen_time in "generate_blocks_for_one_layer_block"  1.876420259475708

connection checking time:  1.294290542602539
block generation total time  1.876420259475708
generate_dataloader_block spend   22.491246223449707
pure train time  0.5531961917877197
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.11328125 GB
    Memory Allocated: 0.34845972061157227  GigaBytes
Max Memory Allocated: 13.605919361114502  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.172109127044678
epoch time :  29.45188307762146
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.356 seconds, peak memory: 71.110 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 71.110 GB
Metis partitioning: 11.348 seconds, peak memory: 71.110 GB
Split the graph: 1.104 seconds
Construct subgraphs: 0.013 seconds
REG metis partition end ----................................
REG construction  time spent:  4.29756498336792
pure dgl.metis_partition the time spent:  13.822993278503418

block_gen_time in "generate_blocks_for_one_layer_block"  1.9100797176361084

connection checking time:  1.267202377319336
block generation total time  1.9100797176361084
generate_dataloader_block spend   22.34975242614746
pure train time  0.5346033573150635
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.853515625 GB
    Memory Allocated: 0.3524327278137207  GigaBytes
Max Memory Allocated: 13.605919361114502  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.017985820770264
epoch time :  29.265321254730225
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.435 seconds, peak memory: 71.110 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 71.110 GB
Metis partitioning: 11.026 seconds, peak memory: 71.110 GB
Split the graph: 1.100 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  3.6303091049194336
pure dgl.metis_partition the time spent:  13.584137916564941

block_gen_time in "generate_blocks_for_one_layer_block"  1.8833959102630615

connection checking time:  1.3374903202056885
block generation total time  1.8833959102630615
generate_dataloader_block spend   21.472164392471313
pure train time  0.5125179290771484
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.853515625 GB
    Memory Allocated: 0.35434532165527344  GigaBytes
Max Memory Allocated: 13.605919361114502  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.897360324859619
epoch time :  28.377476692199707
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.397 seconds, peak memory: 71.110 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 71.110 GB
Metis partitioning: 11.154 seconds, peak memory: 71.110 GB
Split the graph: 1.246 seconds
Construct subgraphs: 0.016 seconds
REG metis partition end ----................................
REG construction  time spent:  4.57395339012146
pure dgl.metis_partition the time spent:  13.815860033035278

block_gen_time in "generate_blocks_for_one_layer_block"  1.2911083698272705

connection checking time:  0.9254062175750732
block generation total time  1.2911083698272705
generate_dataloader_block spend   21.639864683151245
pure train time  0.5189871788024902
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.853515625 GB
    Memory Allocated: 0.3373584747314453  GigaBytes
Max Memory Allocated: 13.605919361114502  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.805556297302246
epoch time :  28.531314849853516
Total (block generation + training)time/epoch 28.900348288672312
pure train time/epoch 0.5327214002609253

num_input_list  [398182, 394162, 381774, 380334, 381372, 397210, 392297, 383339, 391671, 396493]
