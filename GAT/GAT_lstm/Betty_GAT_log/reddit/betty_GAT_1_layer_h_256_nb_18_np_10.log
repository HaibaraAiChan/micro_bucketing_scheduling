main start at this time 1700807311.585131
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
self._in_src_feats,  602
self._in_dst_feats 602
Epoch 1, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.385 seconds, peak memory: 36.498 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.498 GB
Metis partitioning: 9.832 seconds, peak memory: 36.498 GB
Split the graph: 0.396 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  3.9896345138549805
pure dgl.metis_partition the time spent:  11.636297941207886

block_gen_time in "generate_blocks_for_one_layer_block"  2.2343015670776367

connection checking time:  1.398005723953247
block generation total time  2.2343015670776367
pure train time  1.4154889583587646
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.396484375 GB
    Memory Allocated: 0.26991987228393555  GigaBytes
Max Memory Allocated: 6.064905643463135  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.933544158935547
Epoch 2, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.361 seconds, peak memory: 53.064 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 53.064 GB
Metis partitioning: 11.637 seconds, peak memory: 57.085 GB
Split the graph: 0.693 seconds
Construct subgraphs: 0.236 seconds
REG metis partition end ----................................
REG construction  time spent:  4.336829662322998
pure dgl.metis_partition the time spent:  13.92850112915039

block_gen_time in "generate_blocks_for_one_layer_block"  1.8902459144592285

connection checking time:  1.3602368831634521
block generation total time  1.8902459144592285
pure train time  0.830322265625
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.396484375 GB
    Memory Allocated: 0.27619075775146484  GigaBytes
Max Memory Allocated: 6.115469455718994  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.869910717010498
Epoch 3, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.327 seconds, peak memory: 57.422 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 57.422 GB
Metis partitioning: 11.604 seconds, peak memory: 57.422 GB
Split the graph: 0.567 seconds
Construct subgraphs: 0.247 seconds
REG metis partition end ----................................
REG construction  time spent:  4.233315467834473
pure dgl.metis_partition the time spent:  13.747900485992432

block_gen_time in "generate_blocks_for_one_layer_block"  1.3213772773742676

connection checking time:  1.1899003982543945
block generation total time  1.3213772773742676
pure train time  0.732485294342041
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.396484375 GB
    Memory Allocated: 0.27990007400512695  GigaBytes
Max Memory Allocated: 6.127455711364746  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.807592868804932
Epoch 4, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.394 seconds, peak memory: 57.779 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 57.779 GB
Metis partitioning: 11.659 seconds, peak memory: 57.779 GB
Split the graph: 0.800 seconds
Construct subgraphs: 0.221 seconds
REG metis partition end ----................................
REG construction  time spent:  3.3414032459259033
pure dgl.metis_partition the time spent:  14.075596570968628

block_gen_time in "generate_blocks_for_one_layer_block"  1.2402501106262207

connection checking time:  0.8011865615844727
block generation total time  1.2402501106262207
generate_dataloader_block spend   20.284307718276978
pure train time  0.7379310131072998
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.73046875 GB
    Memory Allocated: 0.2757844924926758  GigaBytes
Max Memory Allocated: 6.204327583312988  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.724930286407471
epoch time :  27.619405031204224
Epoch 5, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.426 seconds, peak memory: 58.484 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 58.484 GB
Metis partitioning: 10.070 seconds, peak memory: 58.484 GB
Split the graph: 0.644 seconds
Construct subgraphs: 0.178 seconds
REG metis partition end ----................................
REG construction  time spent:  4.327283143997192
pure dgl.metis_partition the time spent:  12.319489479064941

block_gen_time in "generate_blocks_for_one_layer_block"  1.8925449848175049

connection checking time:  1.4465339183807373
block generation total time  1.8925449848175049
generate_dataloader_block spend   20.962613105773926
pure train time  1.108044147491455
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.73046875 GB
    Memory Allocated: 0.2794041633605957  GigaBytes
Max Memory Allocated: 6.204327583312988  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.595608234405518
epoch time :  28.390648365020752
Epoch 6, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.276 seconds, peak memory: 58.488 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 58.488 GB
Metis partitioning: 11.643 seconds, peak memory: 58.488 GB
Split the graph: 0.619 seconds
Construct subgraphs: 0.117 seconds
REG metis partition end ----................................
REG construction  time spent:  4.379310607910156
pure dgl.metis_partition the time spent:  13.656528234481812

block_gen_time in "generate_blocks_for_one_layer_block"  1.8666987419128418

connection checking time:  1.3519673347473145
block generation total time  1.8666987419128418
generate_dataloader_block spend   22.089895009994507
pure train time  1.0850143432617188
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.73046875 GB
    Memory Allocated: 0.27105188369750977  GigaBytes
Max Memory Allocated: 6.204327583312988  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.384182453155518
epoch time :  29.507850170135498
Epoch 7, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.408 seconds, peak memory: 58.832 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 58.832 GB
Metis partitioning: 11.221 seconds, peak memory: 58.832 GB
Split the graph: 0.526 seconds
Construct subgraphs: 0.198 seconds
REG metis partition end ----................................
REG construction  time spent:  4.259773254394531
pure dgl.metis_partition the time spent:  13.355249643325806

block_gen_time in "generate_blocks_for_one_layer_block"  1.8738915920257568

connection checking time:  0.8976755142211914
block generation total time  1.8738915920257568
generate_dataloader_block spend   21.194960594177246
pure train time  0.8403265476226807
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.73046875 GB
    Memory Allocated: 0.27371692657470703  GigaBytes
Max Memory Allocated: 6.204327583312988  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.171247959136963
epoch time :  28.627156734466553
Epoch 8, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.328 seconds, peak memory: 58.871 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 58.871 GB
Metis partitioning: 11.409 seconds, peak memory: 58.871 GB
Split the graph: 0.709 seconds
Construct subgraphs: 0.123 seconds
REG metis partition end ----................................
REG construction  time spent:  4.375483274459839
pure dgl.metis_partition the time spent:  13.571166515350342

block_gen_time in "generate_blocks_for_one_layer_block"  1.234381914138794

connection checking time:  0.7147383689880371
block generation total time  1.234381914138794
generate_dataloader_block spend   20.56220507621765
pure train time  0.9667086601257324
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.73046875 GB
    Memory Allocated: 0.28113555908203125  GigaBytes
Max Memory Allocated: 6.204327583312988  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.01711893081665
epoch time :  27.844752550125122
Epoch 9, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.290 seconds, peak memory: 59.135 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 59.135 GB
Metis partitioning: 12.333 seconds, peak memory: 59.135 GB
Split the graph: 0.628 seconds
Construct subgraphs: 0.203 seconds
REG metis partition end ----................................
REG construction  time spent:  4.172520399093628
pure dgl.metis_partition the time spent:  14.456782817840576

block_gen_time in "generate_blocks_for_one_layer_block"  1.8695881366729736

connection checking time:  0.9346106052398682
block generation total time  1.8695881366729736
generate_dataloader_block spend   22.248944520950317
pure train time  1.0132200717926025
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.73046875 GB
    Memory Allocated: 0.2804398536682129  GigaBytes
Max Memory Allocated: 6.204327583312988  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.896330833435059
epoch time :  29.621652364730835
Epoch 10, Learning Rate: 0.001
REG start----................................
Convert a graph into a bidirected graph: 1.216 seconds, peak memory: 59.260 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 59.260 GB
Metis partitioning: 11.263 seconds, peak memory: 59.260 GB
Split the graph: 0.594 seconds
Construct subgraphs: 0.169 seconds
REG metis partition end ----................................
REG construction  time spent:  4.173678159713745
pure dgl.metis_partition the time spent:  13.2429940700531

block_gen_time in "generate_blocks_for_one_layer_block"  1.8696656227111816

connection checking time:  0.9872255325317383
block generation total time  1.8696656227111816
generate_dataloader_block spend   21.134132385253906
pure train time  1.0779821872711182
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.740234375 GB
    Memory Allocated: 0.287142276763916  GigaBytes
Max Memory Allocated: 6.204327583312988  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.805023193359375
epoch time :  28.511313676834106
Total (block generation + training)time/epoch 28.5889675617218
pure train time/epoch 1.0152159929275513

num_input_list  [479132, 474842, 471226, 482155, 481467, 471657, 488682, 475433, 490728, 482261]
