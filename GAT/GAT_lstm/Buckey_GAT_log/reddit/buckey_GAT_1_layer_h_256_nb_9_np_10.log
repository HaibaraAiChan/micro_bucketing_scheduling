main start at this time 1700855920.5282066
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
self._in_src_feats,  602
self._in_dst_feats 602
Epoch 1, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  9
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.03822684288024902
7
9
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0010366439819335938
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013012409210205078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03966474533081055
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.5218245983123779
self.buckets_partition() spend  sec:  0.0526888370513916
check connections block*********************************

the find indices time spent  0.06666278839111328

in edges time spent  0.3124115467071533
local to global src and eids time spent  0.7184090614318848
time gen tails  0.1461348533630371
res  length 9

block_gen_time in "generate_blocks_for_one_layer_block"  1.2150781154632568

block collection to dataloader spend  1.1682510375976562e-05
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.58984375 GB
    Memory Allocated: 0.45834922790527344  GigaBytes
Max Memory Allocated: 12.123498916625977  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.933137893676758
Epoch 2, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  9
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.02536773681640625
7
9
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0004172325134277344
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018733501434326172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.026073932647705078
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.3930506706237793
self.buckets_partition() spend  sec:  0.04481935501098633
check connections block*********************************

the find indices time spent  0.07168364524841309

in edges time spent  0.3158421516418457
local to global src and eids time spent  0.7135646343231201
time gen tails  0.1383218765258789
res  length 9

block_gen_time in "generate_blocks_for_one_layer_block"  1.1468114852905273

block collection to dataloader spend  1.1920928955078125e-05
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.58984375 GB
    Memory Allocated: 0.45778751373291016  GigaBytes
Max Memory Allocated: 12.192101001739502  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.869612693786621
Epoch 3, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  9
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.04300999641418457
7
9
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.00043892860412597656
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012691497802734375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.043760061264038086
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.5211029052734375
self.buckets_partition() spend  sec:  0.056463003158569336
check connections block*********************************

the find indices time spent  0.06805157661437988

in edges time spent  0.32639026641845703
local to global src and eids time spent  0.722200870513916
time gen tails  0.13816332817077637
res  length 9

block_gen_time in "generate_blocks_for_one_layer_block"  0.7545275688171387

block collection to dataloader spend  1.1682510375976562e-05
generate_dataloader_block spend   2.750779628753662
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.58984375 GB
    Memory Allocated: 0.45778560638427734  GigaBytes
Max Memory Allocated: 12.192101001739502  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.8062028884887695
epoch time:  9.549798011779785
Epoch 4, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  9
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.04256772994995117
7
9
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.00046563148498535156
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01264810562133789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04334712028503418
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.5206692218780518
self.buckets_partition() spend  sec:  0.05600714683532715
check connections block*********************************

the find indices time spent  0.06837177276611328

in edges time spent  0.3145029544830322
local to global src and eids time spent  0.7115006446838379
time gen tails  0.13677167892456055
res  length 9

block_gen_time in "generate_blocks_for_one_layer_block"  0.728304386138916

block collection to dataloader spend  1.1444091796875e-05
generate_dataloader_block spend   2.7105305194854736
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.58984375 GB
    Memory Allocated: 0.45780229568481445  GigaBytes
Max Memory Allocated: 12.192704200744629  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.723372936248779
epoch time:  9.496325731277466
Epoch 5, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  9
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.04838752746582031
7
9
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0004763603210449219
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012995481491088867
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04918980598449707
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.5144798755645752
self.buckets_partition() spend  sec:  0.06219744682312012
check connections block*********************************

the find indices time spent  0.06693196296691895

in edges time spent  0.30876731872558594
local to global src and eids time spent  0.7134630680084229
time gen tails  0.1398618221282959
res  length 9

block_gen_time in "generate_blocks_for_one_layer_block"  0.7031829357147217

block collection to dataloader spend  1.1205673217773438e-05
generate_dataloader_block spend   2.6660139560699463
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.58984375 GB
    Memory Allocated: 0.4575638771057129  GigaBytes
Max Memory Allocated: 12.192704200744629  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.5939130783081055
epoch time:  9.501189708709717
Epoch 6, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  9
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.047716379165649414
7
9
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0004343986511230469
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012719154357910156
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04844808578491211
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.5104432106018066
self.buckets_partition() spend  sec:  0.061179161071777344
check connections block*********************************

the find indices time spent  0.06711030006408691

in edges time spent  0.31090521812438965
local to global src and eids time spent  0.7227916717529297
time gen tails  0.14162731170654297
res  length 9

block_gen_time in "generate_blocks_for_one_layer_block"  1.0626940727233887

block collection to dataloader spend  1.1205673217773438e-05
generate_dataloader_block spend   3.0442206859588623
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.58984375 GB
    Memory Allocated: 0.45717811584472656  GigaBytes
Max Memory Allocated: 12.192704200744629  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.38319206237793
epoch time:  9.927661180496216
Epoch 7, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  9
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.048562049865722656
7
9
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.00042819976806640625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018012285232543945
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.049321889877319336
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.5163419246673584
self.buckets_partition() spend  sec:  0.06734609603881836
check connections block*********************************

the find indices time spent  0.06951045989990234

in edges time spent  0.3258025646209717
local to global src and eids time spent  0.7394447326660156
time gen tails  0.13892459869384766
res  length 9

block_gen_time in "generate_blocks_for_one_layer_block"  0.8946683406829834

block collection to dataloader spend  1.1444091796875e-05
generate_dataloader_block spend   2.901677370071411
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.58984375 GB
    Memory Allocated: 0.45719242095947266  GigaBytes
Max Memory Allocated: 12.193261623382568  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.170472621917725
epoch time:  9.771763801574707
Epoch 8, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  9
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.04827594757080078
7
9
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0005512237548828125
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013791084289550781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04915904998779297
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.538231372833252
self.buckets_partition() spend  sec:  0.06296229362487793
check connections block*********************************

the find indices time spent  0.06762933731079102

in edges time spent  0.338137149810791
local to global src and eids time spent  0.7138583660125732
time gen tails  0.1373598575592041
res  length 9

block_gen_time in "generate_blocks_for_one_layer_block"  0.7207746505737305

block collection to dataloader spend  1.0967254638671875e-05
generate_dataloader_block spend   2.7362234592437744
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.58984375 GB
    Memory Allocated: 0.4570131301879883  GigaBytes
Max Memory Allocated: 12.193261623382568  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.016506671905518
epoch time:  9.652181625366211
Epoch 9, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  9
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.03833460807800293
7
9
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0005645751953125
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012659072875976562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03922462463378906
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.5003960132598877
self.buckets_partition() spend  sec:  0.0518951416015625
check connections block*********************************

the find indices time spent  0.07083559036254883

in edges time spent  0.3099691867828369
local to global src and eids time spent  0.7096743583679199
time gen tails  0.13900256156921387
res  length 9

block_gen_time in "generate_blocks_for_one_layer_block"  1.1201121807098389

block collection to dataloader spend  1.1444091796875e-05
generate_dataloader_block spend   3.0659682750701904
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.58984375 GB
    Memory Allocated: 0.45746946334838867  GigaBytes
Max Memory Allocated: 12.193261623382568  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.896162033081055
epoch time:  9.928824424743652
Epoch 10, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  9
G_BUCKET_ID_list [[7], [3, 1], [8], [4, 0], [6], [5], [2]]
Groups_mem_list  [[258], [159, 98], [252], [185, 56], [230], [211], [127], [127]]
G_BUCKET_ID_list length 7
backpack scheduling spend  0.04768037796020508
7
9
current group_mem  0.25802743434906006
current group_mem  0.25778523087501526
current group_mem  0.2524971216917038
current group_mem  0.2418401688337326
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.1275201290845871
batches output list generation spend  0.0004413127899169922
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01755833625793457
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04845142364501953
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.5144004821777344
self.buckets_partition() spend  sec:  0.06602191925048828
check connections block*********************************

the find indices time spent  0.06732726097106934

in edges time spent  0.33924269676208496
local to global src and eids time spent  0.7128517627716064
time gen tails  0.13669347763061523
res  length 9

block_gen_time in "generate_blocks_for_one_layer_block"  0.8933517932891846

block collection to dataloader spend  1.1205673217773438e-05
generate_dataloader_block spend   2.87947416305542
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.58984375 GB
    Memory Allocated: 0.45745038986206055  GigaBytes
Max Memory Allocated: 12.193261623382568  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.805087089538574
epoch time:  9.783241271972656
Total (block generation + training)time/epoch 9.701371967792511
pure train time/epoch 2.387619217236837

num_input_list  [917885, 918044, 917685, 917423, 917806, 917723, 917876, 918065, 917685, 917950]
