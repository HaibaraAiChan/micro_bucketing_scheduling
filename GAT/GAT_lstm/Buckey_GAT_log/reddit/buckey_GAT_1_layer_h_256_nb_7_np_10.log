main start at this time 1700855228.910539
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
self._in_src_feats,  602
self._in_dst_feats 602
Epoch 1, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  7
G_BUCKET_ID_list [[3, 2], [6, 0], [4, 1], [7], [8], [5]]
Groups_mem_list  [[159, 127], [230, 56], [185, 98], [258], [252], [211], [211]]
G_BUCKET_ID_list length 6
backpack scheduling spend  0.03812575340270996
6
7
current group_mem  0.28672854602336884
current group_mem  0.28616340458393097
current group_mem  0.2842661440372467
current group_mem  0.25802743434906006
current group_mem  0.2524971216917038
current group_mem  0.21192803978919983
batches output list generation spend  0.0010356903076171875
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013168811798095703
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0396115779876709
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.4183051586151123
self.buckets_partition() spend  sec:  0.05279421806335449
check connections block*********************************

the find indices time spent  0.06773972511291504

in edges time spent  0.31099796295166016
local to global src and eids time spent  0.6914548873901367
time gen tails  0.13406085968017578
res  length 7

block_gen_time in "generate_blocks_for_one_layer_block"  1.1997706890106201

block collection to dataloader spend  1.0967254638671875e-05
step  0
step  1
step  2
step  3
step  4
step  5
step  6
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3984375 GB
    Memory Allocated: 0.5095577239990234  GigaBytes
Max Memory Allocated: 15.35135793685913  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.93350076675415
Epoch 2, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  7
G_BUCKET_ID_list [[3, 2], [6, 0], [4, 1], [7], [8], [5]]
Groups_mem_list  [[159, 127], [230, 56], [185, 98], [258], [252], [211], [211]]
G_BUCKET_ID_list length 6
backpack scheduling spend  0.024605751037597656
6
7
current group_mem  0.28672854602336884
current group_mem  0.28616340458393097
current group_mem  0.2842661440372467
current group_mem  0.25802743434906006
current group_mem  0.2524971216917038
current group_mem  0.21192803978919983
batches output list generation spend  0.000400543212890625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018528461456298828
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.025312185287475586
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.33055901527404785
self.buckets_partition() spend  sec:  0.043853044509887695
check connections block*********************************

the find indices time spent  0.043196916580200195

in edges time spent  0.24566292762756348
local to global src and eids time spent  0.6861560344696045
time gen tails  0.125244140625
res  length 7

block_gen_time in "generate_blocks_for_one_layer_block"  1.1898081302642822

block collection to dataloader spend  1.1205673217773438e-05
step  0
step  1
step  2
step  3
step  4
step  5
step  6
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3984375 GB
    Memory Allocated: 0.5088562965393066  GigaBytes
Max Memory Allocated: 15.416857719421387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.8699140548706055
Epoch 3, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  7
G_BUCKET_ID_list [[3, 2], [6, 0], [4, 1], [7], [8], [5]]
Groups_mem_list  [[159, 127], [230, 56], [185, 98], [258], [252], [211], [211]]
G_BUCKET_ID_list length 6
backpack scheduling spend  0.02904200553894043
6
7
current group_mem  0.28672854602336884
current group_mem  0.28616340458393097
current group_mem  0.2842661440372467
current group_mem  0.25802743434906006
current group_mem  0.2524971216917038
current group_mem  0.21192803978919983
batches output list generation spend  0.00044155120849609375
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01753544807434082
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.029761314392089844
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.317169189453125
self.buckets_partition() spend  sec:  0.04730963706970215
check connections block*********************************

the find indices time spent  0.0674736499786377

in edges time spent  0.30341124534606934
local to global src and eids time spent  0.6784110069274902
time gen tails  0.1361079216003418
res  length 7

block_gen_time in "generate_blocks_for_one_layer_block"  1.0982990264892578

block collection to dataloader spend  1.049041748046875e-05
generate_dataloader_block spend   2.8125932216644287
step  0
step  1
step  2
step  3
step  4
step  5
step  6
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3984375 GB
    Memory Allocated: 0.5089688301086426  GigaBytes
Max Memory Allocated: 15.417484760284424  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.806468963623047
epoch time:  9.687459230422974
Epoch 4, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  7
G_BUCKET_ID_list [[3, 2], [6, 0], [4, 1], [7], [8], [5]]
Groups_mem_list  [[159, 127], [230, 56], [185, 98], [258], [252], [211], [211]]
G_BUCKET_ID_list length 6
backpack scheduling spend  0.04855513572692871
6
7
current group_mem  0.28672854602336884
current group_mem  0.28616340458393097
current group_mem  0.2842661440372467
current group_mem  0.25802743434906006
current group_mem  0.2524971216917038
current group_mem  0.21192803978919983
batches output list generation spend  0.0007698535919189453
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013871192932128906
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.049652814865112305
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.4424777030944824
self.buckets_partition() spend  sec:  0.06353640556335449
check connections block*********************************

the find indices time spent  0.06892156600952148

in edges time spent  0.32822704315185547
local to global src and eids time spent  0.6971254348754883
time gen tails  0.1308426856994629
res  length 7

block_gen_time in "generate_blocks_for_one_layer_block"  1.318239688873291

block collection to dataloader spend  1.1205673217773438e-05
generate_dataloader_block spend   3.1982905864715576
step  0
step  1
step  2
step  3
step  4
step  5
step  6
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3984375 GB
    Memory Allocated: 0.5090360641479492  GigaBytes
Max Memory Allocated: 15.417495250701904  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.724454879760742
epoch time:  10.073158979415894
Epoch 5, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  7
G_BUCKET_ID_list [[3, 2], [6, 0], [4, 1], [7], [8], [5]]
Groups_mem_list  [[159, 127], [230, 56], [185, 98], [258], [252], [211], [211]]
G_BUCKET_ID_list length 6
backpack scheduling spend  0.04699349403381348
6
7
current group_mem  0.28672854602336884
current group_mem  0.28616340458393097
current group_mem  0.2842661440372467
current group_mem  0.25802743434906006
current group_mem  0.2524971216917038
current group_mem  0.21192803978919983
batches output list generation spend  0.0006906986236572266
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01510763168334961
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04798078536987305
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.42881298065185547
self.buckets_partition() spend  sec:  0.06310319900512695
check connections block*********************************

the find indices time spent  0.07007145881652832

in edges time spent  0.33274388313293457
local to global src and eids time spent  0.6955387592315674
time gen tails  0.12635350227355957
res  length 7

block_gen_time in "generate_blocks_for_one_layer_block"  1.003891944885254

block collection to dataloader spend  1.33514404296875e-05
generate_dataloader_block spend   2.874865770339966
step  0
step  1
step  2
step  3
step  4
step  5
step  6
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3984375 GB
    Memory Allocated: 0.5086531639099121  GigaBytes
Max Memory Allocated: 15.417495250701904  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.595232009887695
epoch time:  9.825469255447388
Epoch 6, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  7
G_BUCKET_ID_list [[3, 2], [6, 0], [4, 1], [7], [8], [5]]
Groups_mem_list  [[159, 127], [230, 56], [185, 98], [258], [252], [211], [211]]
G_BUCKET_ID_list length 6
backpack scheduling spend  0.048180580139160156
6
7
current group_mem  0.28672854602336884
current group_mem  0.28616340458393097
current group_mem  0.2842661440372467
current group_mem  0.25802743434906006
current group_mem  0.2524971216917038
current group_mem  0.21192803978919983
batches output list generation spend  0.0005362033843994141
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012611627578735352
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04901862144470215
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.4238719940185547
self.buckets_partition() spend  sec:  0.06164360046386719
check connections block*********************************

the find indices time spent  0.06966805458068848

in edges time spent  0.32776641845703125
local to global src and eids time spent  0.6911284923553467
time gen tails  0.12805986404418945
res  length 7

block_gen_time in "generate_blocks_for_one_layer_block"  0.9084913730621338

block collection to dataloader spend  1.0251998901367188e-05
generate_dataloader_block spend   2.7644596099853516
step  0
step  1
step  2
step  3
step  4
step  5
step  6
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3984375 GB
    Memory Allocated: 0.5083732604980469  GigaBytes
Max Memory Allocated: 15.421397686004639  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.384634971618652
epoch time:  9.606874465942383
Epoch 7, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  7
G_BUCKET_ID_list [[3, 2], [6, 0], [4, 1], [7], [8], [5]]
Groups_mem_list  [[159, 127], [230, 56], [185, 98], [258], [252], [211], [211]]
G_BUCKET_ID_list length 6
backpack scheduling spend  0.04759550094604492
6
7
current group_mem  0.28672854602336884
current group_mem  0.28616340458393097
current group_mem  0.2842661440372467
current group_mem  0.25802743434906006
current group_mem  0.2524971216917038
current group_mem  0.21192803978919983
batches output list generation spend  0.00045371055603027344
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016550064086914062
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.048360347747802734
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.42768263816833496
self.buckets_partition() spend  sec:  0.06492328643798828
check connections block*********************************

the find indices time spent  0.07060384750366211

in edges time spent  0.33924078941345215
local to global src and eids time spent  0.6900920867919922
time gen tails  0.1275043487548828
res  length 7

block_gen_time in "generate_blocks_for_one_layer_block"  1.096269130706787

block collection to dataloader spend  1.049041748046875e-05
generate_dataloader_block spend   2.9655232429504395
step  0
step  1
step  2
step  3
step  4
step  5
step  6
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3984375 GB
    Memory Allocated: 0.5084991455078125  GigaBytes
Max Memory Allocated: 15.421397686004639  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.1713409423828125
epoch time:  9.82100796699524
Epoch 8, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  7
G_BUCKET_ID_list [[3, 2], [6, 0], [4, 1], [7], [8], [5]]
Groups_mem_list  [[159, 127], [230, 56], [185, 98], [258], [252], [211], [211]]
G_BUCKET_ID_list length 6
backpack scheduling spend  0.04750967025756836
6
7
current group_mem  0.28672854602336884
current group_mem  0.28616340458393097
current group_mem  0.2842661440372467
current group_mem  0.25802743434906006
current group_mem  0.2524971216917038
current group_mem  0.21192803978919983
batches output list generation spend  0.0004432201385498047
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01614856719970703
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04827713966369629
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.42435359954833984
self.buckets_partition() spend  sec:  0.0644376277923584
check connections block*********************************

the find indices time spent  0.06808781623840332

in edges time spent  0.3459055423736572
local to global src and eids time spent  0.6875548362731934
time gen tails  0.12627601623535156
res  length 7

block_gen_time in "generate_blocks_for_one_layer_block"  0.7783482074737549

block collection to dataloader spend  1.1682510375976562e-05
generate_dataloader_block spend   2.6389248371124268
step  0
step  1
step  2
step  3
step  4
step  5
step  6
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3984375 GB
    Memory Allocated: 0.5085725784301758  GigaBytes
Max Memory Allocated: 15.421397686004639  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.017124652862549
epoch time:  9.506203174591064
Epoch 9, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  7
G_BUCKET_ID_list [[3, 2], [6, 0], [4, 1], [7], [8], [5]]
Groups_mem_list  [[159, 127], [230, 56], [185, 98], [258], [252], [211], [211]]
G_BUCKET_ID_list length 6
backpack scheduling spend  0.03018474578857422
6
7
current group_mem  0.28672854602336884
current group_mem  0.28616340458393097
current group_mem  0.2842661440372467
current group_mem  0.25802743434906006
current group_mem  0.2524971216917038
current group_mem  0.21192803978919983
batches output list generation spend  0.0005567073822021484
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014473438262939453
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.031050682067871094
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.2983262538909912
self.buckets_partition() spend  sec:  0.045536041259765625
check connections block*********************************

the find indices time spent  0.0673375129699707

in edges time spent  0.31192946434020996
local to global src and eids time spent  0.6748826503753662
time gen tails  0.12886619567871094
res  length 7

block_gen_time in "generate_blocks_for_one_layer_block"  0.7524309158325195

block collection to dataloader spend  1.049041748046875e-05
generate_dataloader_block spend   2.438553810119629
step  0
step  1
step  2
step  3
step  4
step  5
step  6
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3984375 GB
    Memory Allocated: 0.5092201232910156  GigaBytes
Max Memory Allocated: 15.421397686004639  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.896537780761719
epoch time:  9.324374198913574
Epoch 10, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  7
G_BUCKET_ID_list [[3, 2], [6, 0], [4, 1], [7], [8], [5]]
Groups_mem_list  [[159, 127], [230, 56], [185, 98], [258], [252], [211], [211]]
G_BUCKET_ID_list length 6
backpack scheduling spend  0.02812504768371582
6
7
current group_mem  0.28672854602336884
current group_mem  0.28616340458393097
current group_mem  0.2842661440372467
current group_mem  0.25802743434906006
current group_mem  0.2524971216917038
current group_mem  0.21192803978919983
batches output list generation spend  0.0004494190216064453
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014504432678222656
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.02888631820678711
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.30726170539855957
self.buckets_partition() spend  sec:  0.043402671813964844
check connections block*********************************

the find indices time spent  0.07209086418151855

in edges time spent  0.3185465335845947
local to global src and eids time spent  0.41945528984069824
time gen tails  0.07160043716430664
res  length 7

block_gen_time in "generate_blocks_for_one_layer_block"  1.0485467910766602

block collection to dataloader spend  7.3909759521484375e-06
generate_dataloader_block spend   2.356390953063965
step  0
step  1
step  2
step  3
step  4
step  5
step  6
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3984375 GB
    Memory Allocated: 0.5086822509765625  GigaBytes
Max Memory Allocated: 15.421397686004639  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.805367469787598
epoch time:  9.287821054458618
Total (block generation + training)time/epoch 9.641545116901398
pure train time/epoch 2.3210813999176025

num_input_list  [823481, 823429, 823214, 823135, 823246, 823495, 823304, 823230, 823071, 823216]
