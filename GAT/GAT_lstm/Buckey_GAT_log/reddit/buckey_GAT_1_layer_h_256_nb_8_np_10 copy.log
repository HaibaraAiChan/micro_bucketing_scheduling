main start at this time 1700854034.57048
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
self._in_src_feats,  602
self._in_dst_feats 602
Epoch 1, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  8
G_BUCKET_ID_list [[4, 0], [3, 2], [7, 6], [8, 5], [1]]
Groups_mem_list  [[185, 56], [159, 127], [258, 230], [252, 211], [98], [98]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.044840097427368164
5
8
current group_mem  0.2418401688337326
current group_mem  0.28672854602336884
current group_mem  0.4880400002002716
current group_mem  0.4644251614809036
current group_mem  0.09857681393623352
batches output list generation spend  0.0009970664978027344
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013411521911621094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04624509811401367
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.474245548248291
self.buckets_partition() spend  sec:  0.05966901779174805
check connections block*********************************

the find indices time spent  0.06694746017456055

in edges time spent  0.3106215000152588
local to global src and eids time spent  0.6955516338348389
time gen tails  0.13760137557983398
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  1.1080737113952637

block collection to dataloader spend  1.0967254638671875e-05
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.86328125 GB
    Memory Allocated: 0.4809532165527344  GigaBytes
Max Memory Allocated: 13.860820293426514  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.933614253997803
Epoch 2, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  8
G_BUCKET_ID_list [[4, 0], [3, 2], [7, 6], [8, 5], [1]]
Groups_mem_list  [[185, 56], [159, 127], [258, 230], [252, 211], [98], [98]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.05416297912597656
5
8
current group_mem  0.2418401688337326
current group_mem  0.28672854602336884
current group_mem  0.4880400002002716
current group_mem  0.4644251614809036
current group_mem  0.09857681393623352
batches output list generation spend  0.00040650367736816406
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018037080764770508
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.05486297607421875
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.5007658004760742
self.buckets_partition() spend  sec:  0.07291221618652344
check connections block*********************************

the find indices time spent  0.07245802879333496

in edges time spent  0.32009148597717285
local to global src and eids time spent  0.6930627822875977
time gen tails  0.1322007179260254
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  1.099369764328003

block collection to dataloader spend  1.0967254638671875e-05
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.86328125 GB
    Memory Allocated: 0.48033714294433594  GigaBytes
Max Memory Allocated: 13.928514957427979  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.870088577270508
Epoch 3, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  8
G_BUCKET_ID_list [[4, 0], [3, 2], [7, 6], [8, 5], [1]]
Groups_mem_list  [[185, 56], [159, 127], [258, 230], [252, 211], [98], [98]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.052928924560546875
5
8
current group_mem  0.2418401688337326
current group_mem  0.28672854602336884
current group_mem  0.4880400002002716
current group_mem  0.4644251614809036
current group_mem  0.09857681393623352
batches output list generation spend  0.00035119056701660156
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01268768310546875
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.05359005928039551
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.47866106033325195
self.buckets_partition() spend  sec:  0.06628942489624023
check connections block*********************************

the find indices time spent  0.07096505165100098

in edges time spent  0.334597110748291
local to global src and eids time spent  0.705596923828125
time gen tails  0.1393299102783203
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  0.9897334575653076

block collection to dataloader spend  1.1444091796875e-05
generate_dataloader_block spend   2.926828145980835
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.86328125 GB
    Memory Allocated: 0.4805574417114258  GigaBytes
Max Memory Allocated: 13.928589344024658  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.807058334350586
epoch time:  9.720300674438477
Epoch 4, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  8
G_BUCKET_ID_list [[4, 0], [3, 2], [7, 6], [8, 5], [1]]
Groups_mem_list  [[185, 56], [159, 127], [258, 230], [252, 211], [98], [98]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.052704572677612305
5
8
current group_mem  0.2418401688337326
current group_mem  0.28672854602336884
current group_mem  0.4880400002002716
current group_mem  0.4644251614809036
current group_mem  0.09857681393623352
batches output list generation spend  0.0003688335418701172
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01277780532836914
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.05341529846191406
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.4935488700866699
self.buckets_partition() spend  sec:  0.06620454788208008
check connections block*********************************

the find indices time spent  0.06696748733520508

in edges time spent  0.33099865913391113
local to global src and eids time spent  0.6937017440795898
time gen tails  0.13143014907836914
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  0.7506554126739502

block collection to dataloader spend  1.0728836059570312e-05
generate_dataloader_block spend   2.6797046661376953
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.86328125 GB
    Memory Allocated: 0.4807262420654297  GigaBytes
Max Memory Allocated: 13.928589344024658  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.724266052246094
epoch time:  9.467281579971313
Epoch 5, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  8
G_BUCKET_ID_list [[4, 0], [3, 2], [7, 6], [8, 5], [1]]
Groups_mem_list  [[185, 56], [159, 127], [258, 230], [252, 211], [98], [98]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.05262160301208496
5
8
current group_mem  0.2418401688337326
current group_mem  0.28672854602336884
current group_mem  0.4880400002002716
current group_mem  0.4644251614809036
current group_mem  0.09857681393623352
batches output list generation spend  0.00043010711669921875
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012623786926269531
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.053513526916503906
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.47121143341064453
self.buckets_partition() spend  sec:  0.06615042686462402
check connections block*********************************

the find indices time spent  0.06952452659606934

in edges time spent  0.3351883888244629
local to global src and eids time spent  0.7109229564666748
time gen tails  0.1383814811706543
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  0.8826782703399658

block collection to dataloader spend  1.0967254638671875e-05
generate_dataloader_block spend   2.846626043319702
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.86328125 GB
    Memory Allocated: 0.48029470443725586  GigaBytes
Max Memory Allocated: 13.928589344024658  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.595137119293213
epoch time:  9.759184837341309
Epoch 6, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  8
G_BUCKET_ID_list [[4, 0], [3, 2], [7, 6], [8, 5], [1]]
Groups_mem_list  [[185, 56], [159, 127], [258, 230], [252, 211], [98], [98]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.05282759666442871
5
8
current group_mem  0.2418401688337326
current group_mem  0.28672854602336884
current group_mem  0.4880400002002716
current group_mem  0.4644251614809036
current group_mem  0.09857681393623352
batches output list generation spend  0.00040793418884277344
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.020227432250976562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.053534746170043945
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.4757575988769531
self.buckets_partition() spend  sec:  0.07377457618713379
check connections block*********************************

the find indices time spent  0.0686643123626709

in edges time spent  0.34603142738342285
local to global src and eids time spent  0.7072675228118896
time gen tails  0.14080333709716797
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  1.2592120170593262

block collection to dataloader spend  1.049041748046875e-05
generate_dataloader_block spend   3.2247376441955566
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.86328125 GB
    Memory Allocated: 0.4800224304199219  GigaBytes
Max Memory Allocated: 13.928589344024658  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.384285926818848
epoch time:  10.233698844909668
Epoch 7, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  8
G_BUCKET_ID_list [[4, 0], [3, 2], [7, 6], [8, 5], [1]]
Groups_mem_list  [[185, 56], [159, 127], [258, 230], [252, 211], [98], [98]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.05288290977478027
5
8
current group_mem  0.2418401688337326
current group_mem  0.28672854602336884
current group_mem  0.4880400002002716
current group_mem  0.4644251614809036
current group_mem  0.09857681393623352
batches output list generation spend  0.00041985511779785156
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012860536575317383
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.05361223220825195
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.4709165096282959
self.buckets_partition() spend  sec:  0.06648683547973633
check connections block*********************************

the find indices time spent  0.07616806030273438

in edges time spent  0.35724759101867676
local to global src and eids time spent  0.7129192352294922
time gen tails  0.13635730743408203
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  1.266179084777832

block collection to dataloader spend  1.0728836059570312e-05
generate_dataloader_block spend   3.248288154602051
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.86328125 GB
    Memory Allocated: 0.4802422523498535  GigaBytes
Max Memory Allocated: 13.928589344024658  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.170780658721924
epoch time:  10.10922384262085
Epoch 8, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  8
G_BUCKET_ID_list [[4, 0], [3, 2], [7, 6], [8, 5], [1]]
Groups_mem_list  [[185, 56], [159, 127], [258, 230], [252, 211], [98], [98]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.05337715148925781
5
8
current group_mem  0.2418401688337326
current group_mem  0.28672854602336884
current group_mem  0.4880400002002716
current group_mem  0.4644251614809036
current group_mem  0.09857681393623352
batches output list generation spend  0.0004279613494873047
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014181375503540039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.05413389205932617
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.47161340713500977
self.buckets_partition() spend  sec:  0.06832671165466309
check connections block*********************************

the find indices time spent  0.06840252876281738

in edges time spent  0.3433554172515869
local to global src and eids time spent  0.7007057666778564
time gen tails  0.13602113723754883
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  0.7345442771911621

block collection to dataloader spend  1.1444091796875e-05
generate_dataloader_block spend   2.6658718585968018
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.86328125 GB
    Memory Allocated: 0.480010986328125  GigaBytes
Max Memory Allocated: 13.928730487823486  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.0170722007751465
epoch time:  9.52679705619812
Epoch 9, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  8
G_BUCKET_ID_list [[4, 0], [3, 2], [7, 6], [8, 5], [1]]
Groups_mem_list  [[185, 56], [159, 127], [258, 230], [252, 211], [98], [98]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.05238842964172363
5
8
current group_mem  0.2418401688337326
current group_mem  0.28672854602336884
current group_mem  0.4880400002002716
current group_mem  0.4644251614809036
current group_mem  0.09857681393623352
batches output list generation spend  0.0003619194030761719
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012560367584228516
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.053069114685058594
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.46119141578674316
self.buckets_partition() spend  sec:  0.06564116477966309
check connections block*********************************

the find indices time spent  0.07051396369934082

in edges time spent  0.30706000328063965
local to global src and eids time spent  0.576474666595459
time gen tails  0.10458111763000488
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  1.1214118003845215

block collection to dataloader spend  1.0967254638671875e-05
generate_dataloader_block spend   2.865206480026245
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.86328125 GB
    Memory Allocated: 0.48045969009399414  GigaBytes
Max Memory Allocated: 13.92883014678955  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.896968364715576
epoch time:  9.677558660507202
Epoch 10, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  8
G_BUCKET_ID_list [[4, 0], [3, 2], [7, 6], [8, 5], [1]]
Groups_mem_list  [[185, 56], [159, 127], [258, 230], [252, 211], [98], [98]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.016977310180664062
5
8
current group_mem  0.2418401688337326
current group_mem  0.28672854602336884
current group_mem  0.4880400002002716
current group_mem  0.4644251614809036
current group_mem  0.09857681393623352
batches output list generation spend  0.00029349327087402344
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013282537460327148
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.017554759979248047
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.1724076271057129
self.buckets_partition() spend  sec:  0.030846357345581055
check connections block*********************************

the find indices time spent  0.039125919342041016

in edges time spent  0.19699978828430176
local to global src and eids time spent  0.2711820602416992
time gen tails  0.0692903995513916
res  length 8

block_gen_time in "generate_blocks_for_one_layer_block"  0.637303352355957

block collection to dataloader spend  7.62939453125e-06
generate_dataloader_block spend   1.4833498001098633
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.86328125 GB
    Memory Allocated: 0.48047780990600586  GigaBytes
Max Memory Allocated: 13.92883014678955  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.805325984954834
epoch time:  8.283784866333008
Total (block generation + training)time/epoch 9.597226798534393
pure train time/epoch 2.3777723709742227

num_input_list  [873780, 873287, 873929, 873196, 873310, 873204, 873884, 873779, 873767, 873822]
