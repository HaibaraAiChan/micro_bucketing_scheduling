main start at this time 1700856751.9924428
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
self._in_src_feats,  602
self._in_dst_feats 602
Epoch 1, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  18
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.04061579704284668
9
18
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0010738372802734375
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013358116149902344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04221343994140625
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.9358818531036377
self.buckets_partition() spend  sec:  0.055583953857421875
check connections block*********************************

the find indices time spent  0.06856107711791992

in edges time spent  0.3129310607910156
local to global src and eids time spent  0.8330988883972168
time gen tails  0.18057823181152344
res  length 18

block_gen_time in "generate_blocks_for_one_layer_block"  1.0215198993682861

block collection to dataloader spend  1.8835067749023438e-05
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
step  16
step  17
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.640625 GB
    Memory Allocated: 0.3449697494506836  GigaBytes
Max Memory Allocated: 6.414767742156982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.933612823486328
Epoch 2, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  18
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.044522762298583984
9
18
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0004267692565917969
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017773151397705078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04530143737792969
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.9582655429840088
self.buckets_partition() spend  sec:  0.06308627128601074
check connections block*********************************

the find indices time spent  0.0725247859954834

in edges time spent  0.33097147941589355
local to global src and eids time spent  0.6478705406188965
time gen tails  0.12991070747375488
res  length 18

block_gen_time in "generate_blocks_for_one_layer_block"  1.5946710109710693

block collection to dataloader spend  1.9550323486328125e-05
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
step  16
step  17
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.640625 GB
    Memory Allocated: 0.3446221351623535  GigaBytes
Max Memory Allocated: 6.488093852996826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.8699750900268555
Epoch 3, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  18
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.026488780975341797
9
18
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0004627704620361328
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.022545576095581055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.027291297912597656
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.6616389751434326
self.buckets_partition() spend  sec:  0.049849510192871094
check connections block*********************************

the find indices time spent  0.07434320449829102

in edges time spent  0.2704455852508545
local to global src and eids time spent  0.8752787113189697
time gen tails  0.2006664276123047
res  length 18

block_gen_time in "generate_blocks_for_one_layer_block"  1.36897611618042

block collection to dataloader spend  1.9788742065429688e-05
generate_dataloader_block spend   3.7018232345581055
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
step  16
step  17
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.640625 GB
    Memory Allocated: 0.3439764976501465  GigaBytes
Max Memory Allocated: 6.488093852996826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.80716609954834
epoch time:  10.890289306640625
Epoch 4, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  18
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.015453577041625977
9
18
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0003972053527832031
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01708817481994629
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.016141891479492188
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.33991312980651855
self.buckets_partition() spend  sec:  0.033240318298339844
check connections block*********************************

the find indices time spent  0.041367530822753906

in edges time spent  0.19133615493774414
local to global src and eids time spent  0.3354482650756836
time gen tails  0.09144043922424316
res  length 18

block_gen_time in "generate_blocks_for_one_layer_block"  1.1323740482330322

block collection to dataloader spend  1.33514404296875e-05
generate_dataloader_block spend   2.2495152950286865
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
step  16
step  17
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.640625 GB
    Memory Allocated: 0.34422731399536133  GigaBytes
Max Memory Allocated: 6.488365650177002  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.724648952484131
epoch time:  9.446198225021362
Epoch 5, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  18
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.025445222854614258
9
18
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0006487369537353516
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01631021499633789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.02643418312072754
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.5314130783081055
self.buckets_partition() spend  sec:  0.04275679588317871
check connections block*********************************

the find indices time spent  0.049512386322021484

in edges time spent  0.1887209415435791
local to global src and eids time spent  0.3485722541809082
time gen tails  0.09256362915039062
res  length 18

block_gen_time in "generate_blocks_for_one_layer_block"  1.1026077270507812

block collection to dataloader spend  1.1920928955078125e-05
generate_dataloader_block spend   2.4416890144348145
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
step  16
step  17
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.640625 GB
    Memory Allocated: 0.3438606262207031  GigaBytes
Max Memory Allocated: 6.490095138549805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.595004081726074
epoch time:  9.610839128494263
Epoch 6, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  18
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.04468846321105957
9
18
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.00048160552978515625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018674612045288086
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04555487632751465
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.9352548122406006
self.buckets_partition() spend  sec:  0.06424355506896973
check connections block*********************************

the find indices time spent  0.07019972801208496

in edges time spent  0.3332667350769043
local to global src and eids time spent  0.7411632537841797
time gen tails  0.19287347793579102
res  length 18

block_gen_time in "generate_blocks_for_one_layer_block"  1.1554527282714844

block collection to dataloader spend  2.0265579223632812e-05
generate_dataloader_block spend   3.666168451309204
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
step  16
step  17
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.97265625 GB
    Memory Allocated: 0.34369564056396484  GigaBytes
Max Memory Allocated: 6.490095138549805  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.383810997009277
epoch time:  10.880549192428589
Epoch 7, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  18
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.015171527862548828
9
18
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0003223419189453125
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017706632614135742
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.015758275985717773
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.32680463790893555
self.buckets_partition() spend  sec:  0.03347420692443848
check connections block*********************************

the find indices time spent  0.041620731353759766

in edges time spent  0.19465398788452148
local to global src and eids time spent  0.34208011627197266
time gen tails  0.09775710105895996
res  length 18

block_gen_time in "generate_blocks_for_one_layer_block"  0.7520034313201904

block collection to dataloader spend  1.0013580322265625e-05
generate_dataloader_block spend   1.8761980533599854
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
step  16
step  17
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.97265625 GB
    Memory Allocated: 0.3439459800720215  GigaBytes
Max Memory Allocated: 6.490533828735352  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.170279502868652
epoch time:  9.039064884185791
Epoch 8, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  18
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.015501976013183594
9
18
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.00037169456481933594
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014042854309082031
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.01618027687072754
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.32246971130371094
self.buckets_partition() spend  sec:  0.030231475830078125
check connections block*********************************

the find indices time spent  0.04034304618835449

in edges time spent  0.22181487083435059
local to global src and eids time spent  0.8743188381195068
time gen tails  0.19317340850830078
res  length 18

block_gen_time in "generate_blocks_for_one_layer_block"  1.0725281238555908

block collection to dataloader spend  1.9073486328125e-05
generate_dataloader_block spend   2.9594626426696777
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
step  16
step  17
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.97265625 GB
    Memory Allocated: 0.34354734420776367  GigaBytes
Max Memory Allocated: 6.490533828735352  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.01620626449585
epoch time:  10.176613330841064
Epoch 9, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  18
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.03472566604614258
9
18
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.00041103363037109375
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01846599578857422
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.035474538803100586
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.6846997737884521
self.buckets_partition() spend  sec:  0.05395388603210449
check connections block*********************************

the find indices time spent  0.07042932510375977

in edges time spent  0.22913765907287598
local to global src and eids time spent  0.33648204803466797
time gen tails  0.09563946723937988
res  length 18

block_gen_time in "generate_blocks_for_one_layer_block"  0.8108646869659424

block collection to dataloader spend  1.049041748046875e-05
generate_dataloader_block spend   2.3511664867401123
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
step  16
step  17
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.97265625 GB
    Memory Allocated: 0.34444141387939453  GigaBytes
Max Memory Allocated: 6.490533828735352  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.8961076736450195
epoch time:  9.534617185592651
Epoch 10, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  18
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.017468690872192383
9
18
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0004923343658447266
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016536951065063477
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.018299341201782227
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.5546226501464844
self.buckets_partition() spend  sec:  0.03484940528869629
check connections block*********************************

the find indices time spent  0.07047247886657715

in edges time spent  0.2724320888519287
local to global src and eids time spent  0.5864231586456299
time gen tails  0.14705729484558105
res  length 18

block_gen_time in "generate_blocks_for_one_layer_block"  0.7965612411499023

block collection to dataloader spend  1.8835067749023438e-05
generate_dataloader_block spend   2.674050807952881
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
step  16
step  17
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.97265625 GB
    Memory Allocated: 0.34384632110595703  GigaBytes
Max Memory Allocated: 6.490533828735352  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.804745674133301
epoch time:  9.839723110198975
Total (block generation + training)time/epoch 9.927235960960388
pure train time/epoch 2.4384478330612183

num_input_list  [1155796, 1155488, 1155035, 1154923, 1155590, 1154698, 1155681, 1155618, 1155362, 1155206]
