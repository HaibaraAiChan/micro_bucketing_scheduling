main start at this time 1700856626.483426
success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
in feats:  602
self._in_src_feats,  602
self._in_dst_feats 602
Epoch 1, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  16
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.03976273536682129
9
16
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0010170936584472656
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01293635368347168
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04119396209716797
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.8514845371246338
self.buckets_partition() spend  sec:  0.05414223670959473
check connections block*********************************

the find indices time spent  0.06644606590270996

in edges time spent  0.32012248039245605
local to global src and eids time spent  0.8039422035217285
time gen tails  0.16971397399902344
res  length 16

block_gen_time in "generate_blocks_for_one_layer_block"  1.378692865371704

block collection to dataloader spend  1.7881393432617188e-05
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.8046875 GB
    Memory Allocated: 0.3610849380493164  GigaBytes
Max Memory Allocated: 7.146255970001221  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.933528423309326
Epoch 2, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  16
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.04768037796020508
9
16
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.00048542022705078125
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01832413673400879
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04848742485046387
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.8968169689178467
self.buckets_partition() spend  sec:  0.06682610511779785
check connections block*********************************

the find indices time spent  0.07289886474609375

in edges time spent  0.3327639102935791
local to global src and eids time spent  0.8077151775360107
time gen tails  0.16114044189453125
res  length 16

block_gen_time in "generate_blocks_for_one_layer_block"  1.2343261241912842

block collection to dataloader spend  1.811981201171875e-05
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.806640625 GB
    Memory Allocated: 0.36084461212158203  GigaBytes
Max Memory Allocated: 7.212826251983643  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.870034694671631
Epoch 3, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  16
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.04468274116516113
9
16
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0005636215209960938
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01811361312866211
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04559659957885742
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.8645155429840088
self.buckets_partition() spend  sec:  0.06372237205505371
check connections block*********************************

the find indices time spent  0.07450985908508301

in edges time spent  0.31740331649780273
local to global src and eids time spent  0.833362340927124
time gen tails  0.18591761589050293
res  length 16

block_gen_time in "generate_blocks_for_one_layer_block"  1.3571336269378662

block collection to dataloader spend  2.2411346435546875e-05
generate_dataloader_block spend   3.8899106979370117
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.806640625 GB
    Memory Allocated: 0.3603692054748535  GigaBytes
Max Memory Allocated: 7.212826251983643  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.80679988861084
epoch time:  11.043702363967896
Epoch 4, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  16
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.04967927932739258
9
16
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0005941390991210938
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015152454376220703
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.05061507225036621
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.8633480072021484
self.buckets_partition() spend  sec:  0.0657801628112793
check connections block*********************************

the find indices time spent  0.06984066963195801

in edges time spent  0.35047483444213867
local to global src and eids time spent  0.885688304901123
time gen tails  0.16652154922485352
res  length 16

block_gen_time in "generate_blocks_for_one_layer_block"  1.4008996486663818

block collection to dataloader spend  2.1457672119140625e-05
generate_dataloader_block spend   3.9916670322418213
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.806640625 GB
    Memory Allocated: 0.3606133460998535  GigaBytes
Max Memory Allocated: 7.212826251983643  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.723904609680176
epoch time:  11.173744916915894
Epoch 5, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  16
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.0508875846862793
9
16
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0005381107330322266
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015358209609985352
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.05176973342895508
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.8427331447601318
self.buckets_partition() spend  sec:  0.06714034080505371
check connections block*********************************

the find indices time spent  0.06998109817504883

in edges time spent  0.34856176376342773
local to global src and eids time spent  0.8944809436798096
time gen tails  0.19063591957092285
res  length 16

block_gen_time in "generate_blocks_for_one_layer_block"  1.3485093116760254

block collection to dataloader spend  1.8835067749023438e-05
generate_dataloader_block spend   3.9555861949920654
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.806640625 GB
    Memory Allocated: 0.3601984977722168  GigaBytes
Max Memory Allocated: 7.212826251983643  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.595218658447266
epoch time:  11.144683599472046
Epoch 6, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  16
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.0502779483795166
9
16
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0004935264587402344
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013991355895996094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.05114340782165527
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.8345470428466797
self.buckets_partition() spend  sec:  0.06514835357666016
check connections block*********************************

the find indices time spent  0.06911730766296387

in edges time spent  0.3538541793823242
local to global src and eids time spent  0.819735050201416
time gen tails  0.16070961952209473
res  length 16

block_gen_time in "generate_blocks_for_one_layer_block"  1.3262579441070557

block collection to dataloader spend  1.8596649169921875e-05
generate_dataloader_block spend   3.799304485321045
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.806640625 GB
    Memory Allocated: 0.35994768142700195  GigaBytes
Max Memory Allocated: 7.212826251983643  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.384425163269043
epoch time:  10.99467396736145
Epoch 7, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  16
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.0400996208190918
9
16
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.00047969818115234375
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013886451721191406
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04092597961425781
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.8265285491943359
self.buckets_partition() spend  sec:  0.054824113845825195
check connections block*********************************

the find indices time spent  0.07383942604064941

in edges time spent  0.34101104736328125
local to global src and eids time spent  0.8361191749572754
time gen tails  0.14609360694885254
res  length 16

block_gen_time in "generate_blocks_for_one_layer_block"  1.3437488079071045

block collection to dataloader spend  1.8596649169921875e-05
generate_dataloader_block spend   3.813241958618164
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.806640625 GB
    Memory Allocated: 0.36008739471435547  GigaBytes
Max Memory Allocated: 7.216240882873535  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.171044826507568
epoch time:  10.988340139389038
Epoch 8, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  16
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.04040265083312988
9
16
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.00046133995056152344
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01595473289489746
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.041211605072021484
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.637923002243042
self.buckets_partition() spend  sec:  0.057178497314453125
check connections block*********************************

the find indices time spent  0.041676998138427734

in edges time spent  0.20075035095214844
local to global src and eids time spent  0.5384833812713623
time gen tails  0.16260576248168945
res  length 16

block_gen_time in "generate_blocks_for_one_layer_block"  1.312870740890503

block collection to dataloader spend  1.7881393432617188e-05
generate_dataloader_block spend   3.1345055103302
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.806640625 GB
    Memory Allocated: 0.35968685150146484  GigaBytes
Max Memory Allocated: 7.216240882873535  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.017360687255859
epoch time:  10.289610862731934
Epoch 9, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  16
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.029322147369384766
9
16
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.0005512237548828125
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023987531661987305
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.030228137969970703
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.3722503185272217
self.buckets_partition() spend  sec:  0.054229021072387695
check connections block*********************************

the find indices time spent  0.04713773727416992

in edges time spent  0.2310187816619873
local to global src and eids time spent  0.5906660556793213
time gen tails  0.1646122932434082
res  length 16

block_gen_time in "generate_blocks_for_one_layer_block"  1.1515002250671387

block collection to dataloader spend  1.7881393432617188e-05
generate_dataloader_block spend   2.7816762924194336
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.806640625 GB
    Memory Allocated: 0.3605780601501465  GigaBytes
Max Memory Allocated: 7.216240882873535  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.89628791809082
epoch time:  9.90871262550354
Epoch 10, Learning Rate: 0.001
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.K  16
G_BUCKET_ID_list [[7], [1], [8], [0], [6], [5], [4], [3], [2]]
Groups_mem_list  [[258], [98], [252], [56], [230], [211], [185], [159], [127], [127]]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.04967689514160156
9
16
current group_mem  0.25802743434906006
current group_mem  0.09857681393623352
current group_mem  0.2524971216917038
current group_mem  0.05615083873271942
current group_mem  0.23001256585121155
current group_mem  0.21192803978919983
current group_mem  0.18568933010101318
current group_mem  0.15920841693878174
current group_mem  0.1275201290845871
batches output list generation spend  0.00044846534729003906
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0158843994140625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.05048513412475586
num_output  153431
self.output_nids  153431
output nodes length match
global output equals  True
partition total batch output list spend :  0.8391916751861572
self.buckets_partition() spend  sec:  0.06638240814208984
check connections block*********************************

the find indices time spent  0.06985735893249512

in edges time spent  0.34166908264160156
local to global src and eids time spent  0.8104441165924072
time gen tails  0.13762283325195312
res  length 16

block_gen_time in "generate_blocks_for_one_layer_block"  0.963428258895874

block collection to dataloader spend  2.3126602172851562e-05
generate_dataloader_block spend   3.394473075866699
step  0
step  1
step  2
step  3
step  4
step  5
step  6
step  7
step  8
step  9
step  10
step  11
step  12
step  13
step  14
step  15
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.806640625 GB
    Memory Allocated: 0.35984230041503906  GigaBytes
Max Memory Allocated: 7.216240882873535  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.80488920211792
epoch time:  10.528310060501099
Total (block generation + training)time/epoch 10.758971065282822
pure train time/epoch 2.520323077837626

num_input_list  [1118575, 1118635, 1118405, 1118055, 1118503, 1117998, 1118942, 1117957, 1118397, 1118003]
