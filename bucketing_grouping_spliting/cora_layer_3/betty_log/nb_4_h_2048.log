main start at this time 1689551854.2258747
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.205 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.205 GB
Metis partitioning: 0.000 seconds, peak memory: 24.205 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010023117065429688
pure dgl.metis_partition the time spent:  0.003876209259033203
connection checking time:  0.02151632308959961
block generation total time  0.029028654098510742
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.35546875 GB
    Memory Allocated: 0.8191671371459961  GigaBytes
Max Memory Allocated: 0.8213162422180176  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.35546875 GB
    Memory Allocated: 0.8191690444946289  GigaBytes
Max Memory Allocated: 0.8213162422180176  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.80078125 GB
    Memory Allocated: 1.0526061058044434  GigaBytes
Max Memory Allocated: 1.1912145614624023  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.80078125 GB
    Memory Allocated: 1.052607536315918  GigaBytes
Max Memory Allocated: 1.1912145614624023  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.98828125 GB
    Memory Allocated: 1.107102870941162  GigaBytes
Max Memory Allocated: 1.301483154296875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.98828125 GB
    Memory Allocated: 1.1071043014526367  GigaBytes
Max Memory Allocated: 1.301483154296875  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.98828125 GB
    Memory Allocated: 0.9133200645446777  GigaBytes
Max Memory Allocated: 1.3555989265441895  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.98828125 GB
    Memory Allocated: 0.9133214950561523  GigaBytes
Max Memory Allocated: 1.3555989265441895  GigaBytes

pure train time  1.83131742477417
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.61328125 GB
    Memory Allocated: 1.4653739929199219  GigaBytes
Max Memory Allocated: 1.6528739929199219  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9483317136764526
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.452 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.452 GB
Metis partitioning: 0.000 seconds, peak memory: 26.452 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0037078857421875
pure dgl.metis_partition the time spent:  0.003038644790649414
connection checking time:  0.01983356475830078
block generation total time  0.028768539428710938
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.61328125 GB
    Memory Allocated: 1.819420337677002  GigaBytes
Max Memory Allocated: 1.8212108612060547  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.61328125 GB
    Memory Allocated: 1.8194222450256348  GigaBytes
Max Memory Allocated: 1.8212108612060547  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.67578125 GB
    Memory Allocated: 1.7927770614624023  GigaBytes
Max Memory Allocated: 2.0677032470703125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.67578125 GB
    Memory Allocated: 1.792778491973877  GigaBytes
Max Memory Allocated: 2.0677032470703125  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.8452539443969727  GigaBytes
Max Memory Allocated: 2.0677032470703125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.8452553749084473  GigaBytes
Max Memory Allocated: 2.0677032470703125  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.7177891731262207  GigaBytes
Max Memory Allocated: 2.093658447265625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.7177906036376953  GigaBytes
Max Memory Allocated: 2.093658447265625  GigaBytes

pure train time  1.5120720863342285
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.466444492340088  GigaBytes
Max Memory Allocated: 2.093658447265625  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9491924047470093
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.546 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.546 GB
Metis partitioning: 0.000 seconds, peak memory: 26.546 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005109548568725586
pure dgl.metis_partition the time spent:  0.0030443668365478516
connection checking time:  0.018676280975341797
block generation total time  0.028874874114990234
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.888657569885254  GigaBytes
Max Memory Allocated: 2.093658447265625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.8886594772338867  GigaBytes
Max Memory Allocated: 2.093658447265625  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.7292633056640625  GigaBytes
Max Memory Allocated: 2.136444568634033  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.729264736175537  GigaBytes
Max Memory Allocated: 2.136444568634033  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.7898569107055664  GigaBytes
Max Memory Allocated: 2.136444568634033  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.789858341217041  GigaBytes
Max Memory Allocated: 2.136444568634033  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.717123031616211  GigaBytes
Max Memory Allocated: 2.136444568634033  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.7171244621276855  GigaBytes
Max Memory Allocated: 2.136444568634033  GigaBytes

pure train time  1.5581810474395752
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.466169834136963  GigaBytes
Max Memory Allocated: 2.136444568634033  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.948291301727295
loading full batch data spends  0.009408712387084961
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.546 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.546 GB
Metis partitioning: 0.000 seconds, peak memory: 26.546 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005037546157836914
pure dgl.metis_partition the time spent:  0.0032417774200439453
connection checking time:  0.01936483383178711
block generation total time  0.029854774475097656
generate_dataloader_block spend   0.06267476081848145
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.8904705047607422  GigaBytes
Max Memory Allocated: 2.136444568634033  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.890472412109375  GigaBytes
Max Memory Allocated: 2.136444568634033  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8405733108520508  GigaBytes
Max Memory Allocated: 2.1382946968078613  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8405747413635254  GigaBytes
Max Memory Allocated: 2.1382946968078613  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.725295066833496  GigaBytes
Max Memory Allocated: 2.1382946968078613  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7252964973449707  GigaBytes
Max Memory Allocated: 2.1382946968078613  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.699655532836914  GigaBytes
Max Memory Allocated: 2.1382946968078613  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.6996569633483887  GigaBytes
Max Memory Allocated: 2.1382946968078613  GigaBytes

pure train time  1.5219814777374268
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.4664316177368164  GigaBytes
Max Memory Allocated: 2.1382946968078613  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9483009576797485
loading full batch data spends  0.007155656814575195
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.610 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.610 GB
Metis partitioning: 0.000 seconds, peak memory: 26.610 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0034401416778564453
pure dgl.metis_partition the time spent:  0.002750396728515625
connection checking time:  0.019223451614379883
block generation total time  0.02912139892578125
generate_dataloader_block spend   0.05930805206298828
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.9172582626342773  GigaBytes
Max Memory Allocated: 2.1382946968078613  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.9172601699829102  GigaBytes
Max Memory Allocated: 2.1382946968078613  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.715444564819336  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7154459953308105  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7863287925720215  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.786330223083496  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7461719512939453  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.74617338180542  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

pure train time  1.4133405685424805
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.4670729637145996  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9499964714050293
loading full batch data spends  0.006738185882568359
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.610 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.610 GB
Metis partitioning: 0.000 seconds, peak memory: 26.610 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005114078521728516
pure dgl.metis_partition the time spent:  0.0030727386474609375
connection checking time:  0.0194242000579834
block generation total time  0.029564380645751953
generate_dataloader_block spend   0.062268733978271484
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8818635940551758  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8818655014038086  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.810436725616455  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8104381561279297  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7659602165222168  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7659616470336914  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7177238464355469  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7177252769470215  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

pure train time  1.500960350036621
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.4667282104492188  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.943809986114502
loading full batch data spends  0.007710456848144531
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.610 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.610 GB
Metis partitioning: 0.000 seconds, peak memory: 26.610 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.006134986877441406
pure dgl.metis_partition the time spent:  0.0034470558166503906
connection checking time:  0.020424842834472656
block generation total time  0.031169891357421875
generate_dataloader_block spend   0.06638765335083008
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8861937522888184  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8861956596374512  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.764958381652832  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7649598121643066  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8758530616760254  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8758544921875  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7174468040466309  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7174482345581055  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

pure train time  1.4534287452697754
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.4668879508972168  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9422072172164917
loading full batch data spends  0.0070536136627197266
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.610 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.610 GB
Metis partitioning: 0.000 seconds, peak memory: 26.610 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00501251220703125
pure dgl.metis_partition the time spent:  0.002995729446411133
connection checking time:  0.019583463668823242
block generation total time  0.02972865104675293
generate_dataloader_block spend   0.06233096122741699
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.852221965789795  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8522238731384277  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.752424716949463  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7524261474609375  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.80696439743042  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8069658279418945  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7726025581359863  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.772603988647461  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

pure train time  1.4771568775177002
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.467348575592041  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.94214928150177
loading full batch data spends  0.007071733474731445
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.610 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.610 GB
Metis partitioning: 0.000 seconds, peak memory: 26.610 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0035941600799560547
pure dgl.metis_partition the time spent:  0.0029511451721191406
connection checking time:  0.01940011978149414
block generation total time  0.029758691787719727
generate_dataloader_block spend   0.06059885025024414
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7706289291381836  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7706308364868164  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.6976399421691895  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.697641372680664  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.856715202331543  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8567166328430176  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8380107879638672  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8380122184753418  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

pure train time  1.4707367420196533
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.4686789512634277  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9446616172790527
loading full batch data spends  0.006793022155761719
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.610 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.610 GB
Metis partitioning: 0.000 seconds, peak memory: 26.610 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003427743911743164
pure dgl.metis_partition the time spent:  0.0028417110443115234
connection checking time:  0.01933455467224121
block generation total time  0.029683589935302734
generate_dataloader_block spend   0.06015205383300781
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.882734775543213  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8827366828918457  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8422441482543945  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.8422455787658691  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7378363609313965  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.737837791442871  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7175240516662598  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.7175254821777344  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

pure train time  1.4111011028289795
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.76171875 GB
    Memory Allocated: 1.4666399955749512  GigaBytes
Max Memory Allocated: 2.165541172027588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9414494037628174
Total (block generation + training)time/epoch 1.8609650816236223
pure train time/epoch 1.4544540643692017

num_input_list  [3951, 3940, 3705, 3925, 4018, 3976, 4194, 4047, 3935, 3943]
