main start at this time 1689551079.8029473
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.203 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.203 GB
Metis partitioning: 0.000 seconds, peak memory: 24.203 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009530305862426758
pure dgl.metis_partition the time spent:  0.003320932388305664
connection checking time:  0.018103361129760742
block generation total time  0.019549131393432617
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.6015625 GB
    Memory Allocated: 1.0544114112854004  GigaBytes
Max Memory Allocated: 1.05818510055542  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.6015625 GB
    Memory Allocated: 1.0544142723083496  GigaBytes
Max Memory Allocated: 1.05818510055542  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.048828125 GB
    Memory Allocated: 1.255408763885498  GigaBytes
Max Memory Allocated: 1.4047174453735352  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.048828125 GB
    Memory Allocated: 1.255411148071289  GigaBytes
Max Memory Allocated: 1.4047174453735352  GigaBytes

pure train time  1.4076745510101318
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.861328125 GB
    Memory Allocated: 1.4685029983520508  GigaBytes
Max Memory Allocated: 1.6560029983520508  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9533255100250244
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.689 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.689 GB
Metis partitioning: 0.000 seconds, peak memory: 26.689 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0035686492919921875
pure dgl.metis_partition the time spent:  0.002232074737548828
connection checking time:  0.01578688621520996
block generation total time  0.019734621047973633
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.861328125 GB
    Memory Allocated: 2.1441917419433594  GigaBytes
Max Memory Allocated: 2.1480088233947754  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.861328125 GB
    Memory Allocated: 2.1441946029663086  GigaBytes
Max Memory Allocated: 2.1480088233947754  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 1.9880661964416504  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 1.9880685806274414  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

pure train time  1.0254054069519043
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 1.4687190055847168  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.952418565750122
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.822 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.822 GB
Metis partitioning: 0.000 seconds, peak memory: 26.822 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0035555362701416016
pure dgl.metis_partition the time spent:  0.0022716522216796875
connection checking time:  0.016201496124267578
block generation total time  0.019590377807617188
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 2.08225154876709  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 2.082254409790039  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 2.0768985748291016  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 2.0769009590148926  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

pure train time  0.9881031513214111
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 1.4699950218200684  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.951462745666504
loading full batch data spends  0.0056760311126708984
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.822 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.822 GB
Metis partitioning: 0.000 seconds, peak memory: 26.822 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0035600662231445312
pure dgl.metis_partition the time spent:  0.0023412704467773438
connection checking time:  0.016049861907958984
block generation total time  0.019195556640625
generate_dataloader_block spend   0.04548978805541992
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 2.094308853149414  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 2.0943117141723633  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 2.050011157989502  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 2.050013542175293  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

pure train time  0.9679090976715088
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 1.469991683959961  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.948774814605713
loading full batch data spends  0.0062694549560546875
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.822 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.822 GB
Metis partitioning: 0.000 seconds, peak memory: 26.822 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00672459602355957
pure dgl.metis_partition the time spent:  0.002706289291381836
connection checking time:  0.015920400619506836
block generation total time  0.0199735164642334
generate_dataloader_block spend   0.050347089767456055
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 2.163069725036621  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.986328125 GB
    Memory Allocated: 2.1630725860595703  GigaBytes
Max Memory Allocated: 2.391397476196289  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.9668869972229004  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.9668893814086914  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

pure train time  1.0160188674926758
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.4681153297424316  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9453215599060059
loading full batch data spends  0.0047991275787353516
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.885 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.885 GB
Metis partitioning: 0.000 seconds, peak memory: 26.885 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005156040191650391
pure dgl.metis_partition the time spent:  0.002351522445678711
connection checking time:  0.015974998474121094
block generation total time  0.0200042724609375
generate_dataloader_block spend   0.048020362854003906
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.1264801025390625  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.1264829635620117  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.019979953765869  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.01998233795166  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

pure train time  1.0303559303283691
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.4699897766113281  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.943120002746582
loading full batch data spends  0.004596710205078125
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.885 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.885 GB
Metis partitioning: 0.000 seconds, peak memory: 26.885 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0052297115325927734
pure dgl.metis_partition the time spent:  0.0023713111877441406
connection checking time:  0.01546478271484375
block generation total time  0.019242048263549805
generate_dataloader_block spend   0.046782493591308594
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.0849032402038574  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.0849061012268066  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.041327476501465  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.041329860687256  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

pure train time  1.0125491619110107
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.468630313873291  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9486881494522095
loading full batch data spends  0.00551605224609375
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.885 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.885 GB
Metis partitioning: 0.000 seconds, peak memory: 26.885 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003748178482055664
pure dgl.metis_partition the time spent:  0.002666473388671875
connection checking time:  0.015799283981323242
block generation total time  0.01952338218688965
generate_dataloader_block spend   0.046404123306274414
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.161473274230957  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.1614761352539062  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.9949474334716797  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.9949498176574707  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

pure train time  1.0009167194366455
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.4688072204589844  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9436259269714355
loading full batch data spends  0.004538774490356445
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.885 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.885 GB
Metis partitioning: 0.000 seconds, peak memory: 26.885 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005186557769775391
pure dgl.metis_partition the time spent:  0.00244140625
connection checking time:  0.015554666519165039
block generation total time  0.01941680908203125
generate_dataloader_block spend   0.04703378677368164
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.1658196449279785  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.1658225059509277  GigaBytes
Max Memory Allocated: 2.4102983474731445  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.9721150398254395  GigaBytes
Max Memory Allocated: 2.4130024909973145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.9721174240112305  GigaBytes
Max Memory Allocated: 2.4130024909973145  GigaBytes

pure train time  1.0396881103515625
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.4684371948242188  GigaBytes
Max Memory Allocated: 2.4130024909973145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9425368309020996
loading full batch data spends  0.0053136348724365234
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.885 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.885 GB
Metis partitioning: 0.000 seconds, peak memory: 26.885 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00631403923034668
pure dgl.metis_partition the time spent:  0.0027947425842285156
connection checking time:  0.016254425048828125
block generation total time  0.021296262741088867
generate_dataloader_block spend   0.05155539512634277
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.1671481132507324  GigaBytes
Max Memory Allocated: 2.4130024909973145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 2.1671509742736816  GigaBytes
Max Memory Allocated: 2.4130024909973145  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.9978222846984863  GigaBytes
Max Memory Allocated: 2.414346218109131  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.9978246688842773  GigaBytes
Max Memory Allocated: 2.414346218109131  GigaBytes

pure train time  1.0040655136108398
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.048828125 GB
    Memory Allocated: 1.4699926376342773  GigaBytes
Max Memory Allocated: 2.414346218109131  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9420742988586426
Total (block generation + training)time/epoch 1.2452867371695382
pure train time/epoch 1.0172657171885173

num_input_list  [3010, 3051, 3133, 3094, 2974, 3107, 2931, 3069, 2961, 3093]
