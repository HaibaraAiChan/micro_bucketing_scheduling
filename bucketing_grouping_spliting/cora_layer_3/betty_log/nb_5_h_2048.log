main start at this time 1690925660.2185712
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.217 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.217 GB
Metis partitioning: 0.001 seconds, peak memory: 24.217 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009880304336547852
pure dgl.metis_partition the time spent:  0.00416874885559082
connection checking time:  0.023487091064453125
block generation total time  0.033838510513305664
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.203125 GB
    Memory Allocated: 0.6699028015136719  GigaBytes
Max Memory Allocated: 0.6712479591369629  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.203125 GB
    Memory Allocated: 0.6699047088623047  GigaBytes
Max Memory Allocated: 0.6712479591369629  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.66015625 GB
    Memory Allocated: 1.031721591949463  GigaBytes
Max Memory Allocated: 1.0535335540771484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.66015625 GB
    Memory Allocated: 1.0317230224609375  GigaBytes
Max Memory Allocated: 1.0535335540771484  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.91015625 GB
    Memory Allocated: 0.8979854583740234  GigaBytes
Max Memory Allocated: 1.280545711517334  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.91015625 GB
    Memory Allocated: 0.897986888885498  GigaBytes
Max Memory Allocated: 1.280545711517334  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.91015625 GB
    Memory Allocated: 1.0641469955444336  GigaBytes
Max Memory Allocated: 1.280545711517334  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.91015625 GB
    Memory Allocated: 1.0641484260559082  GigaBytes
Max Memory Allocated: 1.280545711517334  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.91015625 GB
    Memory Allocated: 1.0182247161865234  GigaBytes
Max Memory Allocated: 1.312795639038086  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.91015625 GB
    Memory Allocated: 1.018226146697998  GigaBytes
Max Memory Allocated: 1.312795639038086  GigaBytes

pure train time  2.128661632537842
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.53515625 GB
    Memory Allocated: 1.467264175415039  GigaBytes
Max Memory Allocated: 1.654764175415039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9526278972625732
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.394 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.394 GB
Metis partitioning: 0.001 seconds, peak memory: 26.394 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005248546600341797
pure dgl.metis_partition the time spent:  0.003444671630859375
connection checking time:  0.021451711654663086
block generation total time  0.033860206604003906
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.53515625 GB
    Memory Allocated: 1.760575294494629  GigaBytes
Max Memory Allocated: 1.7620491981506348  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.53515625 GB
    Memory Allocated: 1.7605772018432617  GigaBytes
Max Memory Allocated: 1.7620491981506348  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.59765625 GB
    Memory Allocated: 1.6351995468139648  GigaBytes
Max Memory Allocated: 2.0093464851379395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.59765625 GB
    Memory Allocated: 1.6352009773254395  GigaBytes
Max Memory Allocated: 2.0093464851379395  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.59765625 GB
    Memory Allocated: 1.7267861366271973  GigaBytes
Max Memory Allocated: 2.0093464851379395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.59765625 GB
    Memory Allocated: 1.7267875671386719  GigaBytes
Max Memory Allocated: 2.0093464851379395  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.59765625 GB
    Memory Allocated: 1.803858757019043  GigaBytes
Max Memory Allocated: 2.0093464851379395  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.59765625 GB
    Memory Allocated: 1.8038601875305176  GigaBytes
Max Memory Allocated: 2.0093464851379395  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.772815227508545  GigaBytes
Max Memory Allocated: 2.052705764770508  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.7728166580200195  GigaBytes
Max Memory Allocated: 2.052705764770508  GigaBytes

pure train time  1.6659529209136963
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.4672741889953613  GigaBytes
Max Memory Allocated: 2.052705764770508  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9553616046905518
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.522 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.522 GB
Metis partitioning: 0.001 seconds, peak memory: 26.522 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005070209503173828
pure dgl.metis_partition the time spent:  0.0034132003784179688
connection checking time:  0.0212249755859375
block generation total time  0.03392314910888672
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.808946132659912  GigaBytes
Max Memory Allocated: 2.052705764770508  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.808948040008545  GigaBytes
Max Memory Allocated: 2.052705764770508  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.8155741691589355  GigaBytes
Max Memory Allocated: 2.057755470275879  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.8155755996704102  GigaBytes
Max Memory Allocated: 2.057755470275879  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.6271309852600098  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.6271324157714844  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.7438817024230957  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.7438831329345703  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.6764183044433594  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.676419734954834  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

pure train time  1.5843584537506104
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.4661707878112793  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.953207015991211
loading full batch data spends  0.010489463806152344
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.522 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.522 GB
Metis partitioning: 0.000 seconds, peak memory: 26.522 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0035309791564941406
pure dgl.metis_partition the time spent:  0.0035698413848876953
connection checking time:  0.011996030807495117
block generation total time  0.02510976791381836
generate_dataloader_block spend   0.048796892166137695
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.6280641555786133  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.628066062927246  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.6850919723510742  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.6850934028625488  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.7195720672607422  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.7195734977722168  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.7899537086486816  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.66015625 GB
    Memory Allocated: 1.7899551391601562  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6640625 GB
    Memory Allocated: 1.8278303146362305  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6640625 GB
    Memory Allocated: 1.827831745147705  GigaBytes
Max Memory Allocated: 2.0641846656799316  GigaBytes

pure train time  1.6986894607543945
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.6640625 GB
    Memory Allocated: 1.4675874710083008  GigaBytes
Max Memory Allocated: 2.076387405395508  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9417471885681152
loading full batch data spends  0.00960850715637207
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.522 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.522 GB
Metis partitioning: 0.000 seconds, peak memory: 26.522 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004215717315673828
pure dgl.metis_partition the time spent:  0.003139972686767578
connection checking time:  0.012337207794189453
block generation total time  0.025469064712524414
generate_dataloader_block spend   0.05013298988342285
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6640625 GB
    Memory Allocated: 1.770425796508789  GigaBytes
Max Memory Allocated: 2.076387405395508  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6640625 GB
    Memory Allocated: 1.7704277038574219  GigaBytes
Max Memory Allocated: 2.076387405395508  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6640625 GB
    Memory Allocated: 1.8517494201660156  GigaBytes
Max Memory Allocated: 2.076387405395508  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6640625 GB
    Memory Allocated: 1.8517508506774902  GigaBytes
Max Memory Allocated: 2.076387405395508  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6889128684997559  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6889142990112305  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6997284889221191  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6997299194335938  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6845393180847168  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6845407485961914  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

pure train time  1.6758806705474854
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.4660558700561523  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9472553730010986
loading full batch data spends  0.009155511856079102
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.585 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.585 GB
Metis partitioning: 0.000 seconds, peak memory: 26.585 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0038576126098632812
pure dgl.metis_partition the time spent:  0.002794981002807617
connection checking time:  0.012261390686035156
block generation total time  0.025275468826293945
generate_dataloader_block spend   0.048856496810913086
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.8422112464904785  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.8422131538391113  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.684171199798584  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6841726303100586  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7276439666748047  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7276453971862793  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6735548973083496  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6735563278198242  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7506585121154785  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7506599426269531  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

pure train time  1.5685536861419678
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.4672651290893555  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9465595483779907
loading full batch data spends  0.009477376937866211
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.585 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.585 GB
Metis partitioning: 0.000 seconds, peak memory: 26.585 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004160165786743164
pure dgl.metis_partition the time spent:  0.003214597702026367
connection checking time:  0.012891530990600586
block generation total time  0.02566671371459961
generate_dataloader_block spend   0.05087161064147949
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7638540267944336  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7638559341430664  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.8104639053344727  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.8104653358459473  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7175183296203613  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.717519760131836  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7616596221923828  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7616610527038574  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.683396816253662  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6833982467651367  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

pure train time  1.7056097984313965
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.46661376953125  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9431763887405396
loading full batch data spends  0.009221076965332031
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.585 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.585 GB
Metis partitioning: 0.000 seconds, peak memory: 26.585 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00354766845703125
pure dgl.metis_partition the time spent:  0.0027625560760498047
connection checking time:  0.012096405029296875
block generation total time  0.02516317367553711
generate_dataloader_block spend   0.04809880256652832
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.77238130569458  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.772383213043213  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7953767776489258  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7953782081604004  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.644486904144287  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6444883346557617  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7511568069458008  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7511582374572754  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7181715965270996  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7181730270385742  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

pure train time  1.6934263706207275
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.4666142463684082  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9418728351593018
loading full batch data spends  0.00863790512084961
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.585 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.585 GB
Metis partitioning: 0.000 seconds, peak memory: 26.585 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0034952163696289062
pure dgl.metis_partition the time spent:  0.002624034881591797
connection checking time:  0.012151956558227539
block generation total time  0.02535557746887207
generate_dataloader_block spend   0.04886889457702637
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.8230829238891602  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.823084831237793  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7441177368164062  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7441191673278809  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7465763092041016  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7465777397155762  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7626819610595703  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.762683391571045  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6309280395507812  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6309294700622559  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

pure train time  1.5766985416412354
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.4658279418945312  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9404213428497314
loading full batch data spends  0.009862899780273438
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.585 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.585 GB
Metis partitioning: 0.000 seconds, peak memory: 26.585 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003993511199951172
pure dgl.metis_partition the time spent:  0.0029828548431396484
connection checking time:  0.013143301010131836
block generation total time  0.02599620819091797
generate_dataloader_block spend   0.05090498924255371
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6918587684631348  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.6918606758117676  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.763326644897461  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7633280754089355  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7553529739379883  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.755354404449463  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.8065381050109863  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.806539535522461  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.7731285095214844  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.773129940032959  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

pure train time  1.6221091747283936
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.7265625 GB
    Memory Allocated: 1.4674158096313477  GigaBytes
Max Memory Allocated: 2.100306510925293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9408608675003052
Total (block generation + training)time/epoch 2.1101588862282887
pure train time/epoch 1.6403797070185344

num_input_list  [4328, 4360, 4281, 4125, 4424, 4411, 4601, 4318, 4487, 4783]
