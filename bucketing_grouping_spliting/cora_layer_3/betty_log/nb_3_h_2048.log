main start at this time 1689551107.9100995
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.203 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.203 GB
Metis partitioning: 0.000 seconds, peak memory: 24.203 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010469675064086914
pure dgl.metis_partition the time spent:  0.0038919448852539062
connection checking time:  0.02033686637878418
block generation total time  0.024580001831054688
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.267578125 GB
    Memory Allocated: 0.7352151870727539  GigaBytes
Max Memory Allocated: 0.7374444007873535  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.267578125 GB
    Memory Allocated: 0.7352175712585449  GigaBytes
Max Memory Allocated: 0.7374444007873535  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.802734375 GB
    Memory Allocated: 1.2434606552124023  GigaBytes
Max Memory Allocated: 1.2460060119628906  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.802734375 GB
    Memory Allocated: 1.2434625625610352  GigaBytes
Max Memory Allocated: 1.2460060119628906  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.115234375 GB
    Memory Allocated: 1.117288589477539  GigaBytes
Max Memory Allocated: 1.491147518157959  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.115234375 GB
    Memory Allocated: 1.1172904968261719  GigaBytes
Max Memory Allocated: 1.491147518157959  GigaBytes

pure train time  1.6662309169769287
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.646484375 GB
    Memory Allocated: 1.468717098236084  GigaBytes
Max Memory Allocated: 1.656217098236084  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9551210403442383
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.512 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.512 GB
Metis partitioning: 0.000 seconds, peak memory: 26.512 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0035037994384765625
pure dgl.metis_partition the time spent:  0.0025870800018310547
connection checking time:  0.017782926559448242
block generation total time  0.024295806884765625
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.646484375 GB
    Memory Allocated: 1.8096013069152832  GigaBytes
Max Memory Allocated: 1.812014102935791  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.646484375 GB
    Memory Allocated: 1.8096036911010742  GigaBytes
Max Memory Allocated: 1.812014102935791  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 2.0192489624023438  GigaBytes
Max Memory Allocated: 2.0579142570495605  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 2.0192508697509766  GigaBytes
Max Memory Allocated: 2.0579142570495605  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.808006763458252  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8080086708068848  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

pure train time  1.2239105701446533
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.468083381652832  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9507116079330444
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.699 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.699 GB
Metis partitioning: 0.000 seconds, peak memory: 26.699 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0034537315368652344
pure dgl.metis_partition the time spent:  0.002470731735229492
connection checking time:  0.017498493194580078
block generation total time  0.024132966995239258
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.7778124809265137  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.7778148651123047  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.9406795501708984  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.9406814575195312  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.931291103363037  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.93129301071167  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

pure train time  1.2704293727874756
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.4685683250427246  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9544053077697754
loading full batch data spends  0.0063076019287109375
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.699 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.699 GB
Metis partitioning: 0.000 seconds, peak memory: 26.699 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.006640434265136719
pure dgl.metis_partition the time spent:  0.002948760986328125
connection checking time:  0.018055200576782227
block generation total time  0.02448296546936035
generate_dataloader_block spend   0.05731964111328125
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8302397727966309  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8302421569824219  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8879127502441406  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8879146575927734  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.94218111038208  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.942183017730713  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

pure train time  1.2947783470153809
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.469327449798584  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9516371488571167
loading full batch data spends  0.005719423294067383
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.699 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.699 GB
Metis partitioning: 0.000 seconds, peak memory: 26.699 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003668069839477539
pure dgl.metis_partition the time spent:  0.002622842788696289
connection checking time:  0.0174410343170166
block generation total time  0.024191617965698242
generate_dataloader_block spend   0.05250358581542969
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.7940664291381836  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.7940688133239746  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8750367164611816  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8750386238098145  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.96937894821167  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.9693808555603027  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

pure train time  1.2655541896820068
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.4694890975952148  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9463750123977661
loading full batch data spends  0.005517005920410156
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.699 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.699 GB
Metis partitioning: 0.000 seconds, peak memory: 26.699 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0052890777587890625
pure dgl.metis_partition the time spent:  0.0027251243591308594
connection checking time:  0.018047332763671875
block generation total time  0.025383472442626953
generate_dataloader_block spend   0.05632138252258301
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8218865394592285  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8218889236450195  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8445639610290527  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8445658683776855  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.9990310668945312  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.999032974243164  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

pure train time  1.2500412464141846
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.470778465270996  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9450836181640625
loading full batch data spends  0.0059621334075927734
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.699 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.699 GB
Metis partitioning: 0.000 seconds, peak memory: 26.699 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005933523178100586
pure dgl.metis_partition the time spent:  0.00281524658203125
connection checking time:  0.01873302459716797
block generation total time  0.02517557144165039
generate_dataloader_block spend   0.05744743347167969
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.7938690185546875  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.7938714027404785  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.9631633758544922  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.963165283203125  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.9019522666931152  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.901954174041748  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

pure train time  1.2459561824798584
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.4682531356811523  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.948104739189148
loading full batch data spends  0.006050825119018555
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.699 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.699 GB
Metis partitioning: 0.000 seconds, peak memory: 26.699 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0038826465606689453
pure dgl.metis_partition the time spent:  0.0027925968170166016
connection checking time:  0.018785715103149414
block generation total time  0.02444314956665039
generate_dataloader_block spend   0.05471324920654297
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.84126615524292  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.841268539428711  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.9718952178955078  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.9718971252441406  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8574895858764648  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8574914932250977  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

pure train time  1.2954728603363037
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.4683794975280762  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9447906017303467
loading full batch data spends  0.005731344223022461
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.699 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.699 GB
Metis partitioning: 0.000 seconds, peak memory: 26.699 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003496408462524414
pure dgl.metis_partition the time spent:  0.002557992935180664
connection checking time:  0.01835942268371582
block generation total time  0.024233341217041016
generate_dataloader_block spend   0.05312848091125488
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8403282165527344  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.84765625 GB
    Memory Allocated: 1.8403306007385254  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.849609375 GB
    Memory Allocated: 1.9484357833862305  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.849609375 GB
    Memory Allocated: 1.9484376907348633  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.849609375 GB
    Memory Allocated: 1.8616390228271484  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.849609375 GB
    Memory Allocated: 1.8616409301757812  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

pure train time  1.2654173374176025
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.849609375 GB
    Memory Allocated: 1.4677457809448242  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9422520399093628
loading full batch data spends  0.005868673324584961
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.699 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.699 GB
Metis partitioning: 0.000 seconds, peak memory: 26.699 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0035965442657470703
pure dgl.metis_partition the time spent:  0.002628326416015625
connection checking time:  0.01851677894592285
block generation total time  0.024382591247558594
generate_dataloader_block spend   0.0539240837097168
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.849609375 GB
    Memory Allocated: 1.8684992790222168  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.849609375 GB
    Memory Allocated: 1.8685016632080078  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.849609375 GB
    Memory Allocated: 1.9703855514526367  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.849609375 GB
    Memory Allocated: 1.9703874588012695  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.849609375 GB
    Memory Allocated: 1.8225841522216797  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.849609375 GB
    Memory Allocated: 1.8225860595703125  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

pure train time  1.2633171081542969
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.849609375 GB
    Memory Allocated: 1.467912197113037  GigaBytes
Max Memory Allocated: 2.2671265602111816  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9375402927398682
Total (block generation + training)time/epoch 1.5844647543770927
pure train time/epoch 1.2642931540807087

num_input_list  [3558, 3482, 3553, 3619, 3526, 3650, 3589, 3595, 3495, 3537]
