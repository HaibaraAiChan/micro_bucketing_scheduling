main start at this time 1691280471.308893
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
connection checking time:  0.024835824966430664
block generation total time  0.031830787658691406
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.201171875 GB
    Memory Allocated: 0.6648435592651367  GigaBytes
Max Memory Allocated: 0.6660819053649902  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.201171875 GB
    Memory Allocated: 0.6648454666137695  GigaBytes
Max Memory Allocated: 0.6660819053649902  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.646484375 GB
    Memory Allocated: 0.997626781463623  GigaBytes
Max Memory Allocated: 1.0496912002563477  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.646484375 GB
    Memory Allocated: 0.9976282119750977  GigaBytes
Max Memory Allocated: 1.0496912002563477  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.90625 GB
    Memory Allocated: 1.0383777618408203  GigaBytes
Max Memory Allocated: 1.2467255592346191  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.90625 GB
    Memory Allocated: 1.038379192352295  GigaBytes
Max Memory Allocated: 1.2467255592346191  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.90625 GB
    Memory Allocated: 1.1274523735046387  GigaBytes
Max Memory Allocated: 1.287339210510254  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.90625 GB
    Memory Allocated: 1.1274538040161133  GigaBytes
Max Memory Allocated: 1.287339210510254  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.96875 GB
    Memory Allocated: 1.0657854080200195  GigaBytes
Max Memory Allocated: 1.375917911529541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.96875 GB
    Memory Allocated: 1.0657868385314941  GigaBytes
Max Memory Allocated: 1.375917911529541  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.96875 GB
    Memory Allocated: 0.9675493240356445  GigaBytes
Max Memory Allocated: 1.375917911529541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.96875 GB
    Memory Allocated: 0.9675507545471191  GigaBytes
Max Memory Allocated: 1.375917911529541  GigaBytes

pure train time  2.3108410835266113
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.53125 GB
    Memory Allocated: 1.4658598899841309  GigaBytes
Max Memory Allocated: 1.6533598899841309  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9546113014221191
connection checking time:  0.024759769439697266
block generation total time  0.034090280532836914
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.53125 GB
    Memory Allocated: 1.7132210731506348  GigaBytes
Max Memory Allocated: 1.714310646057129  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.53125 GB
    Memory Allocated: 1.7132229804992676  GigaBytes
Max Memory Allocated: 1.714310646057129  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.59375 GB
    Memory Allocated: 1.784325122833252  GigaBytes
Max Memory Allocated: 1.962106704711914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.59375 GB
    Memory Allocated: 1.7843265533447266  GigaBytes
Max Memory Allocated: 1.962106704711914  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.7692546844482422  GigaBytes
Max Memory Allocated: 2.0329737663269043  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.7692561149597168  GigaBytes
Max Memory Allocated: 2.0329737663269043  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.7917823791503906  GigaBytes
Max Memory Allocated: 2.0329737663269043  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.7917838096618652  GigaBytes
Max Memory Allocated: 2.0329737663269043  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.8054661750793457  GigaBytes
Max Memory Allocated: 2.0400571823120117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.8054676055908203  GigaBytes
Max Memory Allocated: 2.0400571823120117  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.735823154449463  GigaBytes
Max Memory Allocated: 2.0544047355651855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.7358245849609375  GigaBytes
Max Memory Allocated: 2.0544047355651855  GigaBytes

pure train time  1.9345431327819824
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.4672985076904297  GigaBytes
Max Memory Allocated: 2.0544047355651855  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9481568336486816
connection checking time:  0.02605414390563965
block generation total time  0.03284597396850586
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.7806978225708008  GigaBytes
Max Memory Allocated: 2.0544047355651855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.7806997299194336  GigaBytes
Max Memory Allocated: 2.0544047355651855  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.855414867401123  GigaBytes
Max Memory Allocated: 2.0544047355651855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.8554162979125977  GigaBytes
Max Memory Allocated: 2.0544047355651855  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.7485547065734863  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.748556137084961  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.8034448623657227  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.8034462928771973  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.8002185821533203  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.800220012664795  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.6894078254699707  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.6894092559814453  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

pure train time  2.008849620819092
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.4673008918762207  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9851583242416382
loading full batch data spends  0.011265993118286133
connection checking time:  0.013226032257080078
block generation total time  0.024434328079223633
generate_dataloader_block spend   0.053517818450927734
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.8327007293701172  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.83270263671875  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.7938857078552246  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.7938871383666992  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.7551140785217285  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.7551155090332031  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.7328829765319824  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.732884407043457  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.8172526359558105  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.8172540664672852  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.705019474029541  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.7050209045410156  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

pure train time  2.00396466255188
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.4673032760620117  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8638439178466797
loading full batch data spends  0.010272979736328125
connection checking time:  0.013449907302856445
block generation total time  0.023865461349487305
generate_dataloader_block spend   0.052405595779418945
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.7511944770812988  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.7511963844299316  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.8513388633728027  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.8513402938842773  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.7600812911987305  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.72265625 GB
    Memory Allocated: 1.760082721710205  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.724609375 GB
    Memory Allocated: 1.8419766426086426  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.724609375 GB
    Memory Allocated: 1.8419780731201172  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.724609375 GB
    Memory Allocated: 1.6930036544799805  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.724609375 GB
    Memory Allocated: 1.693005084991455  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.724609375 GB
    Memory Allocated: 1.7063679695129395  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.724609375 GB
    Memory Allocated: 1.706369400024414  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

pure train time  1.9365053176879883
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.724609375 GB
    Memory Allocated: 1.46730375289917  GigaBytes
Max Memory Allocated: 2.103384494781494  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8131864070892334
Total (block generation + training)time/epoch 2.5223913192749023
pure train time/epoch 1.9365053176879883

num_input_list  [6328, 6212, 6564, 6325, 6237]
