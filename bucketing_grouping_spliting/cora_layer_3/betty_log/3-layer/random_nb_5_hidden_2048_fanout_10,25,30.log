main start at this time 1691280006.820065
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
connection checking time:  0.02238917350769043
block generation total time  0.03314566612243652
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.265625 GB
    Memory Allocated: 0.7309064865112305  GigaBytes
Max Memory Allocated: 0.7324037551879883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.265625 GB
    Memory Allocated: 0.7309083938598633  GigaBytes
Max Memory Allocated: 0.7324037551879883  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.7109375 GB
    Memory Allocated: 1.0967717170715332  GigaBytes
Max Memory Allocated: 1.1126484870910645  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.7109375 GB
    Memory Allocated: 1.0967731475830078  GigaBytes
Max Memory Allocated: 1.1126484870910645  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.9609375 GB
    Memory Allocated: 1.0255250930786133  GigaBytes
Max Memory Allocated: 1.3455119132995605  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.9609375 GB
    Memory Allocated: 1.025526523590088  GigaBytes
Max Memory Allocated: 1.3455119132995605  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.96484375 GB
    Memory Allocated: 1.0940570831298828  GigaBytes
Max Memory Allocated: 1.3455119132995605  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.96484375 GB
    Memory Allocated: 1.0940585136413574  GigaBytes
Max Memory Allocated: 1.3455119132995605  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.96484375 GB
    Memory Allocated: 1.0863966941833496  GigaBytes
Max Memory Allocated: 1.3455119132995605  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.96484375 GB
    Memory Allocated: 1.0863981246948242  GigaBytes
Max Memory Allocated: 1.3455119132995605  GigaBytes

pure train time  2.203223943710327
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.55859375 GB
    Memory Allocated: 1.4677090644836426  GigaBytes
Max Memory Allocated: 1.6552090644836426  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9514366388320923
connection checking time:  0.022901296615600586
block generation total time  0.028725385665893555
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.55859375 GB
    Memory Allocated: 1.7952351570129395  GigaBytes
Max Memory Allocated: 1.796830177307129  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.55859375 GB
    Memory Allocated: 1.7952370643615723  GigaBytes
Max Memory Allocated: 1.796830177307129  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.62109375 GB
    Memory Allocated: 1.8158540725708008  GigaBytes
Max Memory Allocated: 2.043598175048828  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.62109375 GB
    Memory Allocated: 1.8158555030822754  GigaBytes
Max Memory Allocated: 2.043598175048828  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.854856014251709  GigaBytes
Max Memory Allocated: 2.063809394836426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.8548574447631836  GigaBytes
Max Memory Allocated: 2.063809394836426  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.8119392395019531  GigaBytes
Max Memory Allocated: 2.103588581085205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.8119406700134277  GigaBytes
Max Memory Allocated: 2.103588581085205  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.8077726364135742  GigaBytes
Max Memory Allocated: 2.103588581085205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.8077740669250488  GigaBytes
Max Memory Allocated: 2.103588581085205  GigaBytes

pure train time  1.7487924098968506
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.4674506187438965  GigaBytes
Max Memory Allocated: 2.103588581085205  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9562146663665771
connection checking time:  0.023560762405395508
block generation total time  0.02939748764038086
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.8314104080200195  GigaBytes
Max Memory Allocated: 2.103588581085205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.8314123153686523  GigaBytes
Max Memory Allocated: 2.103588581085205  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.7302236557006836  GigaBytes
Max Memory Allocated: 2.103588581085205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.7302250862121582  GigaBytes
Max Memory Allocated: 2.103588581085205  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.693359375 GB
    Memory Allocated: 1.900106430053711  GigaBytes
Max Memory Allocated: 2.103588581085205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.693359375 GB
    Memory Allocated: 1.9001078605651855  GigaBytes
Max Memory Allocated: 2.103588581085205  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.8417844772338867  GigaBytes
Max Memory Allocated: 2.1486024856567383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.8417859077453613  GigaBytes
Max Memory Allocated: 2.1486024856567383  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.829460620880127  GigaBytes
Max Memory Allocated: 2.1486024856567383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.8294620513916016  GigaBytes
Max Memory Allocated: 2.1486024856567383  GigaBytes

pure train time  1.8378572463989258
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.4681024551391602  GigaBytes
Max Memory Allocated: 2.1486024856567383  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.977682113647461
loading full batch data spends  0.010813236236572266
connection checking time:  0.02288079261779785
block generation total time  0.02897334098815918
generate_dataloader_block spend   0.06611013412475586
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.7870135307312012  GigaBytes
Max Memory Allocated: 2.1486024856567383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.787015438079834  GigaBytes
Max Memory Allocated: 2.1486024856567383  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.7935571670532227  GigaBytes
Max Memory Allocated: 2.1486024856567383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.7935585975646973  GigaBytes
Max Memory Allocated: 2.1486024856567383  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.908576488494873  GigaBytes
Max Memory Allocated: 2.1486024856567383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.9085779190063477  GigaBytes
Max Memory Allocated: 2.1486024856567383  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.8096709251403809  GigaBytes
Max Memory Allocated: 2.156813144683838  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.8096723556518555  GigaBytes
Max Memory Allocated: 2.156813144683838  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.7860050201416016  GigaBytes
Max Memory Allocated: 2.156813144683838  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.7860064506530762  GigaBytes
Max Memory Allocated: 2.156813144683838  GigaBytes

pure train time  1.700608491897583
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.467635154724121  GigaBytes
Max Memory Allocated: 2.156813144683838  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8669425249099731
loading full batch data spends  0.010940074920654297
connection checking time:  0.023173093795776367
block generation total time  0.02935194969177246
generate_dataloader_block spend   0.06672167778015137
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.7318611145019531  GigaBytes
Max Memory Allocated: 2.156813144683838  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.755859375 GB
    Memory Allocated: 1.731863021850586  GigaBytes
Max Memory Allocated: 2.156813144683838  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7578125 GB
    Memory Allocated: 1.9097981452941895  GigaBytes
Max Memory Allocated: 2.156813144683838  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7578125 GB
    Memory Allocated: 1.909799575805664  GigaBytes
Max Memory Allocated: 2.156813144683838  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7578125 GB
    Memory Allocated: 1.8369102478027344  GigaBytes
Max Memory Allocated: 2.158294200897217  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7578125 GB
    Memory Allocated: 1.836911678314209  GigaBytes
Max Memory Allocated: 2.158294200897217  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7578125 GB
    Memory Allocated: 1.768775463104248  GigaBytes
Max Memory Allocated: 2.158294200897217  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7578125 GB
    Memory Allocated: 1.7687768936157227  GigaBytes
Max Memory Allocated: 2.158294200897217  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7578125 GB
    Memory Allocated: 1.8787999153137207  GigaBytes
Max Memory Allocated: 2.158294200897217  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7578125 GB
    Memory Allocated: 1.8788013458251953  GigaBytes
Max Memory Allocated: 2.158294200897217  GigaBytes

pure train time  1.7580082416534424
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.7578125 GB
    Memory Allocated: 1.4679903984069824  GigaBytes
Max Memory Allocated: 2.158294200897217  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8209118843078613
Total (block generation + training)time/epoch 2.2231043577194214
pure train time/epoch 1.7580082416534424

num_input_list  [5567, 5728, 5985, 5792, 5923]
