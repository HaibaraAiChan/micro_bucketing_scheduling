main start at this time 1691280418.3644676
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
connection checking time:  0.011341333389282227
block generation total time  0.017577409744262695
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.30859375 GB
    Memory Allocated: 0.7614531517028809  GigaBytes
Max Memory Allocated: 0.7633485794067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.30859375 GB
    Memory Allocated: 0.7614550590515137  GigaBytes
Max Memory Allocated: 0.7633485794067383  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.7734375 GB
    Memory Allocated: 1.106466293334961  GigaBytes
Max Memory Allocated: 1.1400136947631836  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.7734375 GB
    Memory Allocated: 1.1064677238464355  GigaBytes
Max Memory Allocated: 1.1400136947631836  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.0 GB
    Memory Allocated: 1.226686954498291  GigaBytes
Max Memory Allocated: 1.354382038116455  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.0 GB
    Memory Allocated: 1.2266883850097656  GigaBytes
Max Memory Allocated: 1.354382038116455  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.0625 GB
    Memory Allocated: 1.1786699295043945  GigaBytes
Max Memory Allocated: 1.4748473167419434  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.0625 GB
    Memory Allocated: 1.1786713600158691  GigaBytes
Max Memory Allocated: 1.4748473167419434  GigaBytes

pure train time  1.9601740837097168
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.625 GB
    Memory Allocated: 1.4685564041137695  GigaBytes
Max Memory Allocated: 1.6560564041137695  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9539846181869507
connection checking time:  0.011022329330444336
block generation total time  0.017658710479736328
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.625 GB
    Memory Allocated: 1.843325138092041  GigaBytes
Max Memory Allocated: 1.8452649116516113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.625 GB
    Memory Allocated: 1.8433270454406738  GigaBytes
Max Memory Allocated: 1.8452649116516113  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.75 GB
    Memory Allocated: 1.8365163803100586  GigaBytes
Max Memory Allocated: 2.091859817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.75 GB
    Memory Allocated: 1.8365178108215332  GigaBytes
Max Memory Allocated: 2.091859817504883  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.75 GB
    Memory Allocated: 1.918553352355957  GigaBytes
Max Memory Allocated: 2.091859817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.75 GB
    Memory Allocated: 1.9185547828674316  GigaBytes
Max Memory Allocated: 2.091859817504883  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.75 GB
    Memory Allocated: 1.9043073654174805  GigaBytes
Max Memory Allocated: 2.166271209716797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.75 GB
    Memory Allocated: 1.904308795928955  GigaBytes
Max Memory Allocated: 2.166271209716797  GigaBytes

pure train time  1.621213436126709
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.75 GB
    Memory Allocated: 1.4687294960021973  GigaBytes
Max Memory Allocated: 2.166271209716797  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9678497314453125
connection checking time:  0.011152029037475586
block generation total time  0.016451358795166016
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.75 GB
    Memory Allocated: 1.9466009140014648  GigaBytes
Max Memory Allocated: 2.166271209716797  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.75 GB
    Memory Allocated: 1.9466028213500977  GigaBytes
Max Memory Allocated: 2.166271209716797  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.875960350036621  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.8759617805480957  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.9153876304626465  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.915389060974121  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.843827247619629  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.8438286781311035  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

pure train time  1.5973801612854004
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.468101978302002  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9658944606781006
loading full batch data spends  0.009586572647094727
connection checking time:  0.010851144790649414
block generation total time  0.017627954483032227
generate_dataloader_block spend   0.0382230281829834
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.9203777313232422  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.920379638671875  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.889052391052246  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.8890538215637207  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.8334236145019531  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.8334250450134277  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.8494739532470703  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.849475383758545  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

pure train time  1.6012859344482422
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.4681358337402344  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8604958057403564
loading full batch data spends  0.009752035140991211
connection checking time:  0.011078357696533203
block generation total time  0.017827510833740234
generate_dataloader_block spend   0.03877401351928711
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.9000859260559082  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.900087833404541  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.8867549896240234  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.886756420135498  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.928422451019287  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.9284238815307617  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.809234619140625  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.8092360496520996  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

pure train time  1.6584382057189941
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.8125 GB
    Memory Allocated: 1.4677352905273438  GigaBytes
Max Memory Allocated: 2.194838047027588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8135299682617188
Total (block generation + training)time/epoch 2.013426661491394
pure train time/epoch 1.6584382057189941

num_input_list  [5289, 5078, 5368, 5023, 5161]
