main start at this time 1691287173.7261617
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.209 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.209 GB
Metis partitioning: 0.000 seconds, peak memory: 24.209 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
46
47
47
The batched output nid list before graph partition
connection checking time:  0.023412704467773438
block generation total time  0.027358293533325195
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.416015625 GB
    Memory Allocated: 0.8844656944274902  GigaBytes
Max Memory Allocated: 0.88690185546875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.416015625 GB
    Memory Allocated: 0.8844680786132812  GigaBytes
Max Memory Allocated: 0.88690185546875  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.861328125 GB
    Memory Allocated: 1.220407485961914  GigaBytes
Max Memory Allocated: 1.2566795349121094  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.861328125 GB
    Memory Allocated: 1.2204093933105469  GigaBytes
Max Memory Allocated: 1.2566795349121094  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.048828125 GB
    Memory Allocated: 1.3131208419799805  GigaBytes
Max Memory Allocated: 1.4686131477355957  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.048828125 GB
    Memory Allocated: 1.3131227493286133  GigaBytes
Max Memory Allocated: 1.4686131477355957  GigaBytes

pure train time  1.7080802917480469
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.673828125 GB
    Memory Allocated: 1.471907615661621  GigaBytes
Max Memory Allocated: 1.659407615661621  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9535869359970093
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.518 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.518 GB
Metis partitioning: 0.000 seconds, peak memory: 26.518 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
46
47
47
The batched output nid list before graph partition
connection checking time:  0.020650625228881836
block generation total time  0.027445554733276367
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.716796875 GB
    Memory Allocated: 2.070347785949707  GigaBytes
Max Memory Allocated: 2.073179244995117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.716796875 GB
    Memory Allocated: 2.070350170135498  GigaBytes
Max Memory Allocated: 2.073179244995117  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.904296875 GB
    Memory Allocated: 1.9772958755493164  GigaBytes
Max Memory Allocated: 2.318004608154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.904296875 GB
    Memory Allocated: 1.9772977828979492  GigaBytes
Max Memory Allocated: 2.318004608154297  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.904296875 GB
    Memory Allocated: 1.9394407272338867  GigaBytes
Max Memory Allocated: 2.318004608154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.904296875 GB
    Memory Allocated: 1.9394426345825195  GigaBytes
Max Memory Allocated: 2.318004608154297  GigaBytes

pure train time  1.281224250793457
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.904296875 GB
    Memory Allocated: 1.4710736274719238  GigaBytes
Max Memory Allocated: 2.318004608154297  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9766780138015747
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.768 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.768 GB
Metis partitioning: 0.000 seconds, peak memory: 26.768 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
46
47
47
The batched output nid list before graph partition
connection checking time:  0.02123737335205078
block generation total time  0.02720952033996582
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.904296875 GB
    Memory Allocated: 1.932234287261963  GigaBytes
Max Memory Allocated: 2.318004608154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.904296875 GB
    Memory Allocated: 1.932236671447754  GigaBytes
Max Memory Allocated: 2.318004608154297  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.904296875 GB
    Memory Allocated: 1.9548530578613281  GigaBytes
Max Memory Allocated: 2.318004608154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.904296875 GB
    Memory Allocated: 1.954854965209961  GigaBytes
Max Memory Allocated: 2.318004608154297  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.904296875 GB
    Memory Allocated: 2.1180830001831055  GigaBytes
Max Memory Allocated: 2.318004608154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.904296875 GB
    Memory Allocated: 2.1180849075317383  GigaBytes
Max Memory Allocated: 2.318004608154297  GigaBytes

pure train time  1.3634281158447266
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 1.4726524353027344  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9850974082946777
loading full batch data spends  0.0066759586334228516
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.830 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.830 GB
Metis partitioning: 0.000 seconds, peak memory: 26.830 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
46
47
47
The batched output nid list before graph partition
connection checking time:  0.021582603454589844
block generation total time  0.0290830135345459
generate_dataloader_block spend   0.06180381774902344
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 1.977865219116211  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 1.977867603302002  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 1.9241142272949219  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 1.9241161346435547  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 2.1039319038391113  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 2.103933811187744  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

pure train time  1.3166306018829346
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 1.4724478721618652  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8572323322296143
loading full batch data spends  0.006212472915649414
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.830 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.830 GB
Metis partitioning: 0.000 seconds, peak memory: 26.830 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
46
47
47
The batched output nid list before graph partition
connection checking time:  0.033416032791137695
block generation total time  0.027341604232788086
generate_dataloader_block spend   0.06754827499389648
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 1.9883618354797363  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 1.9883642196655273  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 2.0153961181640625  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 2.0153980255126953  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 2.0144104957580566  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 2.0144124031066895  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

pure train time  1.3788418769836426
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.966796875 GB
    Memory Allocated: 1.4720501899719238  GigaBytes
Max Memory Allocated: 2.365586757659912  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8129522800445557
Total (block generation + training)time/epoch 1.6850963830947876
pure train time/epoch 1.3788418769836426

num_input_list  [4460, 4475, 4555, 4565, 4636]
