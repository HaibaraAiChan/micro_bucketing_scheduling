main start at this time 1691279935.3462272
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
connection checking time:  0.01572585105895996
block generation total time  0.01654505729675293
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.625 GB
    Memory Allocated: 1.074641227722168  GigaBytes
Max Memory Allocated: 1.0783452987670898  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.625 GB
    Memory Allocated: 1.0746440887451172  GigaBytes
Max Memory Allocated: 1.0783452987670898  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.072265625 GB
    Memory Allocated: 1.4093141555786133  GigaBytes
Max Memory Allocated: 1.4258627891540527  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.072265625 GB
    Memory Allocated: 1.4093165397644043  GigaBytes
Max Memory Allocated: 1.4258627891540527  GigaBytes

pure train time  1.4632887840270996
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.884765625 GB
    Memory Allocated: 1.4703354835510254  GigaBytes
Max Memory Allocated: 1.6578354835510254  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9489976167678833
connection checking time:  0.015978097915649414
block generation total time  0.016814708709716797
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.884765625 GB
    Memory Allocated: 2.121126651763916  GigaBytes
Max Memory Allocated: 2.124664306640625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.884765625 GB
    Memory Allocated: 2.1211295127868652  GigaBytes
Max Memory Allocated: 2.124664306640625  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.009765625 GB
    Memory Allocated: 2.181124687194824  GigaBytes
Max Memory Allocated: 2.3685078620910645  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.009765625 GB
    Memory Allocated: 2.1811270713806152  GigaBytes
Max Memory Allocated: 2.3685078620910645  GigaBytes

pure train time  1.0726373195648193
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.009765625 GB
    Memory Allocated: 1.4706206321716309  GigaBytes
Max Memory Allocated: 2.4283299446105957  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9686179161071777
connection checking time:  0.016046762466430664
block generation total time  0.01686573028564453
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.009765625 GB
    Memory Allocated: 2.1358466148376465  GigaBytes
Max Memory Allocated: 2.4283299446105957  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.009765625 GB
    Memory Allocated: 2.1358494758605957  GigaBytes
Max Memory Allocated: 2.4283299446105957  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.009765625 GB
    Memory Allocated: 2.2054200172424316  GigaBytes
Max Memory Allocated: 2.4283299446105957  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.009765625 GB
    Memory Allocated: 2.2054224014282227  GigaBytes
Max Memory Allocated: 2.4283299446105957  GigaBytes

pure train time  1.0603892803192139
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.072265625 GB
    Memory Allocated: 1.471855640411377  GigaBytes
Max Memory Allocated: 2.4526939392089844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9741318225860596
loading full batch data spends  0.007515907287597656
connection checking time:  0.015786409378051758
block generation total time  0.016798019409179688
generate_dataloader_block spend   0.04171586036682129
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.072265625 GB
    Memory Allocated: 2.193988800048828  GigaBytes
Max Memory Allocated: 2.4526939392089844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.072265625 GB
    Memory Allocated: 2.1939916610717773  GigaBytes
Max Memory Allocated: 2.4526939392089844  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.072265625 GB
    Memory Allocated: 2.136570453643799  GigaBytes
Max Memory Allocated: 2.4526939392089844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.072265625 GB
    Memory Allocated: 2.13657283782959  GigaBytes
Max Memory Allocated: 2.4526939392089844  GigaBytes

pure train time  0.9643728733062744
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.072265625 GB
    Memory Allocated: 1.4716248512268066  GigaBytes
Max Memory Allocated: 2.4526939392089844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.853919267654419
loading full batch data spends  0.005752086639404297
connection checking time:  0.0167844295501709
block generation total time  0.017122983932495117
generate_dataloader_block spend   0.047514915466308594
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.072265625 GB
    Memory Allocated: 2.2049455642700195  GigaBytes
Max Memory Allocated: 2.4526939392089844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.072265625 GB
    Memory Allocated: 2.2049484252929688  GigaBytes
Max Memory Allocated: 2.4526939392089844  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.072265625 GB
    Memory Allocated: 2.1588144302368164  GigaBytes
Max Memory Allocated: 2.4526939392089844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.072265625 GB
    Memory Allocated: 2.1588168144226074  GigaBytes
Max Memory Allocated: 2.4526939392089844  GigaBytes

pure train time  1.0710129737854004
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.072265625 GB
    Memory Allocated: 1.4713444709777832  GigaBytes
Max Memory Allocated: 2.4526939392089844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8153061866760254
Total (block generation + training)time/epoch 1.256210207939148
pure train time/epoch 1.0710129737854004

num_input_list  [3375, 3409, 3489, 3489, 3541]
