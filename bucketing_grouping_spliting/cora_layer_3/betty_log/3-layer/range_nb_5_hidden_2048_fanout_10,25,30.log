main start at this time 1691280444.095214
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
connection checking time:  0.023771286010742188
block generation total time  0.02923107147216797
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.255859375 GB
    Memory Allocated: 0.7111964225769043  GigaBytes
Max Memory Allocated: 0.7126102447509766  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.255859375 GB
    Memory Allocated: 0.7111983299255371  GigaBytes
Max Memory Allocated: 0.7126102447509766  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.708984375 GB
    Memory Allocated: 1.0497379302978516  GigaBytes
Max Memory Allocated: 1.0929951667785645  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.708984375 GB
    Memory Allocated: 1.0497393608093262  GigaBytes
Max Memory Allocated: 1.0929951667785645  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.986328125 GB
    Memory Allocated: 1.1109695434570312  GigaBytes
Max Memory Allocated: 1.2986764907836914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.986328125 GB
    Memory Allocated: 1.1109709739685059  GigaBytes
Max Memory Allocated: 1.2986764907836914  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.0 GB
    Memory Allocated: 1.1434683799743652  GigaBytes
Max Memory Allocated: 1.3589706420898438  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.0 GB
    Memory Allocated: 1.1434698104858398  GigaBytes
Max Memory Allocated: 1.3589706420898438  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.0 GB
    Memory Allocated: 1.0868515968322754  GigaBytes
Max Memory Allocated: 1.3920941352844238  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.0 GB
    Memory Allocated: 1.08685302734375  GigaBytes
Max Memory Allocated: 1.3920941352844238  GigaBytes

pure train time  2.2408089637756348
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.59375 GB
    Memory Allocated: 1.4674649238586426  GigaBytes
Max Memory Allocated: 1.6549649238586426  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9474549293518066
connection checking time:  0.023359060287475586
block generation total time  0.02922224998474121
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.59375 GB
    Memory Allocated: 1.7553067207336426  GigaBytes
Max Memory Allocated: 1.756631851196289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.59375 GB
    Memory Allocated: 1.7553086280822754  GigaBytes
Max Memory Allocated: 1.756631851196289  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.851017951965332  GigaBytes
Max Memory Allocated: 2.0040321350097656  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.65625 GB
    Memory Allocated: 1.8510193824768066  GigaBytes
Max Memory Allocated: 2.0040321350097656  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.8216066360473633  GigaBytes
Max Memory Allocated: 2.0986900329589844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.821608066558838  GigaBytes
Max Memory Allocated: 2.0986900329589844  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.8458337783813477  GigaBytes
Max Memory Allocated: 2.0986900329589844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.8458352088928223  GigaBytes
Max Memory Allocated: 2.0986900329589844  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.8596878051757812  GigaBytes
Max Memory Allocated: 2.0986900329589844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.8596892356872559  GigaBytes
Max Memory Allocated: 2.0986900329589844  GigaBytes

pure train time  1.709716796875
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.4683842658996582  GigaBytes
Max Memory Allocated: 2.107908248901367  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9579294919967651
connection checking time:  0.012240886688232422
block generation total time  0.02103710174560547
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.801201343536377  GigaBytes
Max Memory Allocated: 2.107908248901367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.8012032508850098  GigaBytes
Max Memory Allocated: 2.107908248901367  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.91685152053833  GigaBytes
Max Memory Allocated: 2.107908248901367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.71875 GB
    Memory Allocated: 1.9168529510498047  GigaBytes
Max Memory Allocated: 2.107908248901367  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.7236323356628418  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.7236337661743164  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8499107360839844  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.849912166595459  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.77156400680542  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.7715654373168945  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

pure train time  1.8214354515075684
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.467453956604004  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.963358759880066
loading full batch data spends  0.011268138885498047
connection checking time:  0.01240992546081543
block generation total time  0.020905733108520508
generate_dataloader_block spend   0.046386003494262695
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8595399856567383  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.859541893005371  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8387584686279297  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8387598991394043  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.716750144958496  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.7167515754699707  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8352465629577637  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8352479934692383  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.804600715637207  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8046021461486816  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

pure train time  1.7856261730194092
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.4675941467285156  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.857842206954956
loading full batch data spends  0.00881505012512207
connection checking time:  0.01230478286743164
block generation total time  0.02088642120361328
generate_dataloader_block spend   0.04443669319152832
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8372101783752441  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.837212085723877  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8346457481384277  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8346471786499023  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8312463760375977  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8312478065490723  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8138394355773926  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.8138408660888672  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.7629332542419434  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.762934684753418  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

pure train time  1.7917892932891846
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.78125 GB
    Memory Allocated: 1.4672584533691406  GigaBytes
Max Memory Allocated: 2.1652331352233887  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8062232732772827
Total (block generation + training)time/epoch 2.2561148405075073
pure train time/epoch 1.7917892932891846

num_input_list  [5990, 5936, 5717, 5627, 5800]
