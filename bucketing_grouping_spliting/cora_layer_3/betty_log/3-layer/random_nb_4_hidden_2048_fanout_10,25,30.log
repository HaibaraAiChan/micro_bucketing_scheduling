main start at this time 1691279981.3990293
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
connection checking time:  0.021292924880981445
block generation total time  0.02564525604248047
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.337890625 GB
    Memory Allocated: 0.7989587783813477  GigaBytes
Max Memory Allocated: 0.800713062286377  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.337890625 GB
    Memory Allocated: 0.7989606857299805  GigaBytes
Max Memory Allocated: 0.800713062286377  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.783203125 GB
    Memory Allocated: 1.1517186164855957  GigaBytes
Max Memory Allocated: 1.1771836280822754  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.783203125 GB
    Memory Allocated: 1.1517200469970703  GigaBytes
Max Memory Allocated: 1.1771836280822754  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.033203125 GB
    Memory Allocated: 1.1146583557128906  GigaBytes
Max Memory Allocated: 1.4001765251159668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.033203125 GB
    Memory Allocated: 1.1146597862243652  GigaBytes
Max Memory Allocated: 1.4001765251159668  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.033203125 GB
    Memory Allocated: 1.1795110702514648  GigaBytes
Max Memory Allocated: 1.4001765251159668  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.033203125 GB
    Memory Allocated: 1.1795125007629395  GigaBytes
Max Memory Allocated: 1.4001765251159668  GigaBytes

pure train time  2.0574569702148438
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.626953125 GB
    Memory Allocated: 1.4685425758361816  GigaBytes
Max Memory Allocated: 1.6560425758361816  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9565306901931763
connection checking time:  0.011433124542236328
block generation total time  0.019082307815551758
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.626953125 GB
    Memory Allocated: 1.8480234146118164  GigaBytes
Max Memory Allocated: 1.8500175476074219  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.626953125 GB
    Memory Allocated: 1.8480253219604492  GigaBytes
Max Memory Allocated: 1.8500175476074219  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.853945255279541  GigaBytes
Max Memory Allocated: 2.0964765548706055  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.689453125 GB
    Memory Allocated: 1.8539466857910156  GigaBytes
Max Memory Allocated: 2.0964765548706055  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.908735752105713  GigaBytes
Max Memory Allocated: 2.102616786956787  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.9087371826171875  GigaBytes
Max Memory Allocated: 2.102616786956787  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.8692450523376465  GigaBytes
Max Memory Allocated: 2.1572089195251465  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.869246482849121  GigaBytes
Max Memory Allocated: 2.1572089195251465  GigaBytes

pure train time  1.5092618465423584
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.4680542945861816  GigaBytes
Max Memory Allocated: 2.1572089195251465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9522982835769653
connection checking time:  0.012244701385498047
block generation total time  0.019683837890625
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.8643970489501953  GigaBytes
Max Memory Allocated: 2.1572089195251465  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.8643989562988281  GigaBytes
Max Memory Allocated: 2.1572089195251465  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.8919925689697266  GigaBytes
Max Memory Allocated: 2.1572089195251465  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.8919939994812012  GigaBytes
Max Memory Allocated: 2.1572089195251465  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.873915195465088  GigaBytes
Max Memory Allocated: 2.1572089195251465  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.8739166259765625  GigaBytes
Max Memory Allocated: 2.1572089195251465  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.9407920837402344  GigaBytes
Max Memory Allocated: 2.1572089195251465  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.751953125 GB
    Memory Allocated: 1.940793514251709  GigaBytes
Max Memory Allocated: 2.1572089195251465  GigaBytes

pure train time  1.5714178085327148
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.814453125 GB
    Memory Allocated: 1.4700202941894531  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9579721689224243
loading full batch data spends  0.007405519485473633
connection checking time:  0.011907815933227539
block generation total time  0.019651412963867188
generate_dataloader_block spend   0.04286384582519531
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.814453125 GB
    Memory Allocated: 1.873913288116455  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.814453125 GB
    Memory Allocated: 1.873915195465088  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.814453125 GB
    Memory Allocated: 1.9286727905273438  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.814453125 GB
    Memory Allocated: 1.9286742210388184  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.814453125 GB
    Memory Allocated: 1.8533215522766113  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.814453125 GB
    Memory Allocated: 1.853322982788086  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.814453125 GB
    Memory Allocated: 1.90228271484375  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.814453125 GB
    Memory Allocated: 1.9022841453552246  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

pure train time  1.442683458328247
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.814453125 GB
    Memory Allocated: 1.4688630104064941  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8471161127090454
loading full batch data spends  0.006946563720703125
connection checking time:  0.012094974517822266
block generation total time  0.019886255264282227
generate_dataloader_block spend   0.04288029670715332
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.814453125 GB
    Memory Allocated: 1.8313589096069336  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.814453125 GB
    Memory Allocated: 1.8313608169555664  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.81640625 GB
    Memory Allocated: 1.9677753448486328  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.81640625 GB
    Memory Allocated: 1.9677767753601074  GigaBytes
Max Memory Allocated: 2.189173698425293  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.81640625 GB
    Memory Allocated: 1.8490924835205078  GigaBytes
Max Memory Allocated: 2.216057777404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.81640625 GB
    Memory Allocated: 1.8490939140319824  GigaBytes
Max Memory Allocated: 2.216057777404785  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.81640625 GB
    Memory Allocated: 1.9232869148254395  GigaBytes
Max Memory Allocated: 2.216057777404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.81640625 GB
    Memory Allocated: 1.923288345336914  GigaBytes
Max Memory Allocated: 2.216057777404785  GigaBytes

pure train time  1.619631290435791
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.81640625 GB
    Memory Allocated: 1.4686121940612793  GigaBytes
Max Memory Allocated: 2.216057777404785  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7921435832977295
Total (block generation + training)time/epoch 1.9184787273406982
pure train time/epoch 1.619631290435791

num_input_list  [5090, 5013, 5325, 5314, 5292]
