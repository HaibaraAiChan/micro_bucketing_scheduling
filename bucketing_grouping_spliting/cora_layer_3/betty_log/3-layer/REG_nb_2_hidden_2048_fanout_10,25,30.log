main start at this time 1691280527.805078
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.211 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.211 GB
Metis partitioning: 0.000 seconds, peak memory: 24.211 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00924539566040039
pure dgl.metis_partition the time spent:  0.0032062530517578125
connection checking time:  0.017851829528808594
block generation total time  0.019430160522460938
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.55859375 GB
    Memory Allocated: 1.0055036544799805  GigaBytes
Max Memory Allocated: 1.0090770721435547  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.55859375 GB
    Memory Allocated: 1.0055065155029297  GigaBytes
Max Memory Allocated: 1.0090770721435547  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.005859375 GB
    Memory Allocated: 1.315025806427002  GigaBytes
Max Memory Allocated: 1.359703540802002  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.005859375 GB
    Memory Allocated: 1.315028190612793  GigaBytes
Max Memory Allocated: 1.359703540802002  GigaBytes

pure train time  1.3770110607147217
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.818359375 GB
    Memory Allocated: 1.4687657356262207  GigaBytes
Max Memory Allocated: 1.6562657356262207  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9505765438079834
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.671 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.671 GB
Metis partitioning: 0.000 seconds, peak memory: 26.671 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003538846969604492
pure dgl.metis_partition the time spent:  0.002198934555053711
connection checking time:  0.015839099884033203
block generation total time  0.023037195205688477
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.830078125 GB
    Memory Allocated: 2.1296114921569824  GigaBytes
Max Memory Allocated: 2.133340358734131  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.830078125 GB
    Memory Allocated: 2.1296143531799316  GigaBytes
Max Memory Allocated: 2.133340358734131  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.955078125 GB
    Memory Allocated: 2.020829677581787  GigaBytes
Max Memory Allocated: 2.376908779144287  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.955078125 GB
    Memory Allocated: 2.020832061767578  GigaBytes
Max Memory Allocated: 2.376908779144287  GigaBytes

pure train time  1.0521955490112305
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.955078125 GB
    Memory Allocated: 1.4699878692626953  GigaBytes
Max Memory Allocated: 2.376908779144287  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9499664306640625
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.798 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.798 GB
Metis partitioning: 0.000 seconds, peak memory: 26.798 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005090951919555664
pure dgl.metis_partition the time spent:  0.002341747283935547
connection checking time:  0.008893251419067383
block generation total time  0.013829708099365234
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.955078125 GB
    Memory Allocated: 2.193453311920166  GigaBytes
Max Memory Allocated: 2.376908779144287  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.955078125 GB
    Memory Allocated: 2.1934561729431152  GigaBytes
Max Memory Allocated: 2.376908779144287  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 1.9476017951965332  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 1.9476041793823242  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

pure train time  0.9853880405426025
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 1.4680490493774414  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.983353853225708
loading full batch data spends  0.004951953887939453
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.923 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.923 GB
Metis partitioning: 0.000 seconds, peak memory: 26.923 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004694938659667969
pure dgl.metis_partition the time spent:  0.0023927688598632812
connection checking time:  0.016318559646606445
block generation total time  0.02024555206298828
generate_dataloader_block spend   0.048332929611206055
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 2.148007392883301  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 2.14801025390625  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 2.0103421211242676  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 2.0103445053100586  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

pure train time  0.9816739559173584
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 1.4699878692626953  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8640031814575195
loading full batch data spends  0.005315542221069336
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.923 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.923 GB
Metis partitioning: 0.000 seconds, peak memory: 26.923 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003894805908203125
pure dgl.metis_partition the time spent:  0.002362966537475586
connection checking time:  0.01592874526977539
block generation total time  0.01936650276184082
generate_dataloader_block spend   0.04604148864746094
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 2.134096145629883  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 2.134099006652832  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 2.0099878311157227  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 2.0099902153015137  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

pure train time  1.0738255977630615
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.080078125 GB
    Memory Allocated: 1.4699897766113281  GigaBytes
Max Memory Allocated: 2.4405980110168457  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8066799640655518
Total (block generation + training)time/epoch 1.2603604793548584
pure train time/epoch 1.0738255977630615

num_input_list  [2985, 3040, 2981, 3090, 3089]
