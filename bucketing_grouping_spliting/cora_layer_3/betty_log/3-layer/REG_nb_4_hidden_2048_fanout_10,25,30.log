main start at this time 1691280573.3484302
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.211 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.211 GB
Metis partitioning: 0.000 seconds, peak memory: 24.211 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009939908981323242
pure dgl.metis_partition the time spent:  0.005042076110839844
connection checking time:  0.021792888641357422
block generation total time  0.029179096221923828
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.345703125 GB
    Memory Allocated: 0.8141622543334961  GigaBytes
Max Memory Allocated: 0.8162331581115723  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.345703125 GB
    Memory Allocated: 0.8141641616821289  GigaBytes
Max Memory Allocated: 0.8162331581115723  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.791015625 GB
    Memory Allocated: 0.9982771873474121  GigaBytes
Max Memory Allocated: 1.1876602172851562  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.791015625 GB
    Memory Allocated: 0.9982786178588867  GigaBytes
Max Memory Allocated: 1.1876602172851562  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.041015625 GB
    Memory Allocated: 1.0602173805236816  GigaBytes
Max Memory Allocated: 1.2470097541809082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.041015625 GB
    Memory Allocated: 1.0602188110351562  GigaBytes
Max Memory Allocated: 1.2470097541809082  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.041015625 GB
    Memory Allocated: 1.0292339324951172  GigaBytes
Max Memory Allocated: 1.3088278770446777  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.041015625 GB
    Memory Allocated: 1.0292353630065918  GigaBytes
Max Memory Allocated: 1.3088278770446777  GigaBytes

pure train time  1.7673814296722412
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.634765625 GB
    Memory Allocated: 1.4664440155029297  GigaBytes
Max Memory Allocated: 1.6539440155029297  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9487055540084839
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.491 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.491 GB
Metis partitioning: 0.000 seconds, peak memory: 26.491 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005187273025512695
pure dgl.metis_partition the time spent:  0.0032444000244140625
connection checking time:  0.019469022750854492
block generation total time  0.028870582580566406
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.634765625 GB
    Memory Allocated: 1.8383350372314453  GigaBytes
Max Memory Allocated: 1.8401670455932617  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.634765625 GB
    Memory Allocated: 1.8383369445800781  GigaBytes
Max Memory Allocated: 1.8401670455932617  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.829211711883545  GigaBytes
Max Memory Allocated: 2.08693790435791  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.697265625 GB
    Memory Allocated: 1.8292131423950195  GigaBytes
Max Memory Allocated: 2.08693790435791  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.867116928100586  GigaBytes
Max Memory Allocated: 2.08693790435791  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.8671183586120605  GigaBytes
Max Memory Allocated: 2.08693790435791  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.621574878692627  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.6215763092041016  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

pure train time  1.3820278644561768
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.4652690887451172  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9645613431930542
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.554 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.554 GB
Metis partitioning: 0.000 seconds, peak memory: 26.554 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005293607711791992
pure dgl.metis_partition the time spent:  0.0032126903533935547
connection checking time:  0.019186973571777344
block generation total time  0.02890753746032715
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.8357758522033691  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.835777759552002  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.8208584785461426  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.8208599090576172  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.7859745025634766  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.7859759330749512  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.7095394134521484  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.709540843963623  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

pure train time  1.4753777980804443
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.701171875 GB
    Memory Allocated: 1.4656453132629395  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9614394903182983
loading full batch data spends  0.008002042770385742
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.554 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.554 GB
Metis partitioning: 0.000 seconds, peak memory: 26.554 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005805492401123047
pure dgl.metis_partition the time spent:  0.003144979476928711
connection checking time:  0.019475936889648438
block generation total time  0.02977895736694336
generate_dataloader_block spend   0.06330513954162598
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.708984375 GB
    Memory Allocated: 1.884511947631836  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.708984375 GB
    Memory Allocated: 1.8845138549804688  GigaBytes
Max Memory Allocated: 2.1152772903442383  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7109375 GB
    Memory Allocated: 1.7147369384765625  GigaBytes
Max Memory Allocated: 2.132352352142334  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7109375 GB
    Memory Allocated: 1.714738368988037  GigaBytes
Max Memory Allocated: 2.132352352142334  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7109375 GB
    Memory Allocated: 1.74739408493042  GigaBytes
Max Memory Allocated: 2.132352352142334  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7109375 GB
    Memory Allocated: 1.7473955154418945  GigaBytes
Max Memory Allocated: 2.132352352142334  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7109375 GB
    Memory Allocated: 1.8241500854492188  GigaBytes
Max Memory Allocated: 2.132352352142334  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7109375 GB
    Memory Allocated: 1.8241515159606934  GigaBytes
Max Memory Allocated: 2.132352352142334  GigaBytes

pure train time  1.495102882385254
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.7109375 GB
    Memory Allocated: 1.4668631553649902  GigaBytes
Max Memory Allocated: 2.132352352142334  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8688557147979736
loading full batch data spends  0.0068132877349853516
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.554 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.554 GB
Metis partitioning: 0.000 seconds, peak memory: 26.554 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0056111812591552734
pure dgl.metis_partition the time spent:  0.0032961368560791016
connection checking time:  0.020676374435424805
block generation total time  0.030219078063964844
generate_dataloader_block spend   0.06479573249816895
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7109375 GB
    Memory Allocated: 1.906257152557373  GigaBytes
Max Memory Allocated: 2.132352352142334  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7109375 GB
    Memory Allocated: 1.9062590599060059  GigaBytes
Max Memory Allocated: 2.132352352142334  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.732285499572754  GigaBytes
Max Memory Allocated: 2.1546850204467773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.7322869300842285  GigaBytes
Max Memory Allocated: 2.1546850204467773  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.8237051963806152  GigaBytes
Max Memory Allocated: 2.1546850204467773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.8237066268920898  GigaBytes
Max Memory Allocated: 2.1546850204467773  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.760754108428955  GigaBytes
Max Memory Allocated: 2.1546850204467773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.7607555389404297  GigaBytes
Max Memory Allocated: 2.1546850204467773  GigaBytes

pure train time  1.4160792827606201
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.4680228233337402  GigaBytes
Max Memory Allocated: 2.1546850204467773  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8161481618881226
Total (block generation + training)time/epoch 1.854323148727417
pure train time/epoch 1.4160792827606201

num_input_list  [4009, 3931, 3910, 3939, 4302]
