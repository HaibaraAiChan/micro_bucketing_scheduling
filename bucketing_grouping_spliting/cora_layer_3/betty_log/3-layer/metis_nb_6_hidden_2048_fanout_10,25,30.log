main start at this time 1691287251.1646712
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.210 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.210 GB
Metis partitioning: 0.001 seconds, peak memory: 24.210 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
24
24
23
23
24
22
The batched output nid list before graph partition
connection checking time:  0.03047466278076172
block generation total time  0.043061017990112305
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.6010427474975586  GigaBytes
Max Memory Allocated: 0.6019558906555176  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.6010446548461914  GigaBytes
Max Memory Allocated: 0.6019558906555176  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.599609375 GB
    Memory Allocated: 1.0368247032165527  GigaBytes
Max Memory Allocated: 1.0378952026367188  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.599609375 GB
    Memory Allocated: 1.0368261337280273  GigaBytes
Max Memory Allocated: 1.0378952026367188  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.859375 GB
    Memory Allocated: 1.0517611503601074  GigaBytes
Max Memory Allocated: 1.2856945991516113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.859375 GB
    Memory Allocated: 1.051762580871582  GigaBytes
Max Memory Allocated: 1.2856945991516113  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.873046875 GB
    Memory Allocated: 1.0692663192749023  GigaBytes
Max Memory Allocated: 1.300234317779541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.873046875 GB
    Memory Allocated: 1.069267749786377  GigaBytes
Max Memory Allocated: 1.300234317779541  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.876953125 GB
    Memory Allocated: 1.0900754928588867  GigaBytes
Max Memory Allocated: 1.3181514739990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.876953125 GB
    Memory Allocated: 1.0900769233703613  GigaBytes
Max Memory Allocated: 1.3181514739990234  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.939453125 GB
    Memory Allocated: 1.0658149719238281  GigaBytes
Max Memory Allocated: 1.3389225006103516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.939453125 GB
    Memory Allocated: 1.0658164024353027  GigaBytes
Max Memory Allocated: 1.3389225006103516  GigaBytes

pure train time  2.3932433128356934
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.517578125 GB
    Memory Allocated: 1.468040943145752  GigaBytes
Max Memory Allocated: 1.655540943145752  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.950769305229187
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.361 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.361 GB
Metis partitioning: 0.000 seconds, peak memory: 26.361 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
24
24
23
23
24
22
The batched output nid list before graph partition
connection checking time:  0.04141879081726074
block generation total time  0.04229617118835449
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.517578125 GB
    Memory Allocated: 1.824592113494873  GigaBytes
Max Memory Allocated: 1.8259029388427734  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.517578125 GB
    Memory Allocated: 1.8245940208435059  GigaBytes
Max Memory Allocated: 1.8259029388427734  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.7901711463928223  GigaBytes
Max Memory Allocated: 2.073184013366699  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.7901725769042969  GigaBytes
Max Memory Allocated: 2.073184013366699  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.7099618911743164  GigaBytes
Max Memory Allocated: 2.073184013366699  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.709963321685791  GigaBytes
Max Memory Allocated: 2.073184013366699  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.650390625 GB
    Memory Allocated: 1.836662769317627  GigaBytes
Max Memory Allocated: 2.073184013366699  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.650390625 GB
    Memory Allocated: 1.8366641998291016  GigaBytes
Max Memory Allocated: 2.073184013366699  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.650390625 GB
    Memory Allocated: 1.776726245880127  GigaBytes
Max Memory Allocated: 2.085601329803467  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.650390625 GB
    Memory Allocated: 1.7767276763916016  GigaBytes
Max Memory Allocated: 2.085601329803467  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.650390625 GB
    Memory Allocated: 1.6984539031982422  GigaBytes
Max Memory Allocated: 2.085601329803467  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.650390625 GB
    Memory Allocated: 1.6984553337097168  GigaBytes
Max Memory Allocated: 2.085601329803467  GigaBytes

pure train time  1.9149935245513916
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.650390625 GB
    Memory Allocated: 1.4664649963378906  GigaBytes
Max Memory Allocated: 2.085601329803467  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9560763835906982
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.486 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.486 GB
Metis partitioning: 0.000 seconds, peak memory: 26.486 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
24
24
23
23
24
22
The batched output nid list before graph partition
connection checking time:  0.031824350357055664
block generation total time  0.04243111610412598
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.650390625 GB
    Memory Allocated: 1.860395908355713  GigaBytes
Max Memory Allocated: 2.085601329803467  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.650390625 GB
    Memory Allocated: 1.8603978157043457  GigaBytes
Max Memory Allocated: 2.085601329803467  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.7452640533447266  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.7452654838562012  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.7669034004211426  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.7669048309326172  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.7301712036132812  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.7301726341247559  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.8191890716552734  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.819190502166748  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.7197422981262207  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.7197437286376953  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

pure train time  1.9449758529663086
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.4664740562438965  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.020113229751587
loading full batch data spends  0.011726617813110352
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.550 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.550 GB
Metis partitioning: 0.000 seconds, peak memory: 26.550 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
23
23
24
22
24
24
The batched output nid list before graph partition
connection checking time:  0.028105497360229492
block generation total time  0.04311633110046387
generate_dataloader_block spend   0.08032345771789551
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.728515625 GB
    Memory Allocated: 1.8667101860046387  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.728515625 GB
    Memory Allocated: 1.8667120933532715  GigaBytes
Max Memory Allocated: 2.109098434448242  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7401514053344727  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7401528358459473  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7232379913330078  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7232394218444824  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7825098037719727  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7825112342834473  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7800884246826172  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7800898551940918  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7534947395324707  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7534961700439453  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

pure train time  1.997058391571045
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.4674510955810547  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8651748895645142
loading full batch data spends  0.012262582778930664
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.585 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.585 GB
Metis partitioning: 0.000 seconds, peak memory: 26.585 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
23
23
24
22
24
24
The batched output nid list before graph partition
connection checking time:  0.028611183166503906
block generation total time  0.04355025291442871
generate_dataloader_block spend   0.08246088027954102
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.8411130905151367  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.8411149978637695  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7316207885742188  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7316222190856934  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.811842918395996  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.8118443489074707  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7199687957763672  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7199702262878418  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7457098960876465  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.745711326599121  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.79408597946167  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.7940874099731445  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

pure train time  1.9261813163757324
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.73046875 GB
    Memory Allocated: 1.4684185981750488  GigaBytes
Max Memory Allocated: 2.115450859069824  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8150899410247803
Total (block generation + training)time/epoch 2.545201897621155
pure train time/epoch 1.9261813163757324

num_input_list  [6358, 6351, 6473, 6402, 6486]
