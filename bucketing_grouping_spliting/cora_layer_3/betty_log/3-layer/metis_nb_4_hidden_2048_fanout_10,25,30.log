main start at this time 1691287197.7921624
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.218 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.218 GB
Metis partitioning: 0.000 seconds, peak memory: 24.218 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
35
36
36
33
The batched output nid list before graph partition
connection checking time:  0.025501489639282227
block generation total time  0.032569169998168945
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.2578125 GB
    Memory Allocated: 0.7274398803710938  GigaBytes
Max Memory Allocated: 0.7292799949645996  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.2578125 GB
    Memory Allocated: 0.7274417877197266  GigaBytes
Max Memory Allocated: 0.7292799949645996  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.720703125 GB
    Memory Allocated: 1.1531023979187012  GigaBytes
Max Memory Allocated: 1.1550588607788086  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.720703125 GB
    Memory Allocated: 1.1531038284301758  GigaBytes
Max Memory Allocated: 1.1550588607788086  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.978515625 GB
    Memory Allocated: 1.1419177055358887  GigaBytes
Max Memory Allocated: 1.4008965492248535  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.978515625 GB
    Memory Allocated: 1.1419191360473633  GigaBytes
Max Memory Allocated: 1.4008965492248535  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.994140625 GB
    Memory Allocated: 1.2480759620666504  GigaBytes
Max Memory Allocated: 1.4008965492248535  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.994140625 GB
    Memory Allocated: 1.248077392578125  GigaBytes
Max Memory Allocated: 1.4008965492248535  GigaBytes

pure train time  1.9229724407196045
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.587890625 GB
    Memory Allocated: 1.4706740379333496  GigaBytes
Max Memory Allocated: 1.6581740379333496  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9459853172302246
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.425 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.425 GB
Metis partitioning: 0.000 seconds, peak memory: 26.425 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
35
36
35
34
The batched output nid list before graph partition
connection checking time:  0.022837162017822266
block generation total time  0.032242536544799805
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.587890625 GB
    Memory Allocated: 1.835331916809082  GigaBytes
Max Memory Allocated: 1.8371167182922363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.587890625 GB
    Memory Allocated: 1.8353338241577148  GigaBytes
Max Memory Allocated: 1.8371167182922363  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.9146685600280762  GigaBytes
Max Memory Allocated: 2.08402681350708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.712890625 GB
    Memory Allocated: 1.9146699905395508  GigaBytes
Max Memory Allocated: 2.08402681350708  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8403806686401367  GigaBytes
Max Memory Allocated: 2.1630043983459473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8403820991516113  GigaBytes
Max Memory Allocated: 2.1630043983459473  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9089417457580566  GigaBytes
Max Memory Allocated: 2.1630043983459473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9089431762695312  GigaBytes
Max Memory Allocated: 2.1630043983459473  GigaBytes

pure train time  1.6468422412872314
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.469632625579834  GigaBytes
Max Memory Allocated: 2.1630043983459473  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.962578535079956
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.612 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.612 GB
Metis partitioning: 0.000 seconds, peak memory: 26.612 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
35
36
36
33
The batched output nid list before graph partition
connection checking time:  0.023815155029296875
block generation total time  0.033063411712646484
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8860998153686523  GigaBytes
Max Memory Allocated: 2.1630043983459473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8861017227172852  GigaBytes
Max Memory Allocated: 2.1630043983459473  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9079303741455078  GigaBytes
Max Memory Allocated: 2.1630043983459473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9079318046569824  GigaBytes
Max Memory Allocated: 2.1630043983459473  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9423861503601074  GigaBytes
Max Memory Allocated: 2.1630043983459473  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.942387580871582  GigaBytes
Max Memory Allocated: 2.1630043983459473  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8733596801757812  GigaBytes
Max Memory Allocated: 2.1907906532287598  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8733611106872559  GigaBytes
Max Memory Allocated: 2.1907906532287598  GigaBytes

pure train time  1.6650235652923584
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4706635475158691  GigaBytes
Max Memory Allocated: 2.1907906532287598  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9968514442443848
loading full batch data spends  0.008332490921020508
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.612 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.612 GB
Metis partitioning: 0.000 seconds, peak memory: 26.612 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
35
36
36
33
The batched output nid list before graph partition
connection checking time:  0.023246049880981445
block generation total time  0.0321657657623291
generate_dataloader_block spend   0.06364154815673828
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.9759745597839355  GigaBytes
Max Memory Allocated: 2.1907906532287598  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.9759764671325684  GigaBytes
Max Memory Allocated: 2.1907906532287598  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.8483285903930664  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.848330020904541  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.835042953491211  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.8350443840026855  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.8524112701416016  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.8524127006530762  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

pure train time  1.604116678237915
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.468782901763916  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.855592966079712
loading full batch data spends  0.0071773529052734375
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.648 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.648 GB
Metis partitioning: 0.000 seconds, peak memory: 26.648 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
35
36
36
33
The batched output nid list before graph partition
connection checking time:  0.023321866989135742
block generation total time  0.036687612533569336
generate_dataloader_block spend   0.06796073913574219
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.8881688117980957  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.8881707191467285  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.940445899963379  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.9404473304748535  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.8432631492614746  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.8432645797729492  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.8724112510681152  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.8724126815795898  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

pure train time  1.6268377304077148
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.791015625 GB
    Memory Allocated: 1.4706611633300781  GigaBytes
Max Memory Allocated: 2.2242650985717773  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8197104930877686
Total (block generation + training)time/epoch 2.0268542766571045
pure train time/epoch 1.6268377304077148

num_input_list  [5159, 4995, 5405, 5089, 5347]
