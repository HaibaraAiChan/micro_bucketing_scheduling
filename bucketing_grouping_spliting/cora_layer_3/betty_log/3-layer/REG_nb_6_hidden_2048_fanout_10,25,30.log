main start at this time 1691280624.740986
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.209 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.209 GB
Metis partitioning: 0.001 seconds, peak memory: 24.209 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00940084457397461
pure dgl.metis_partition the time spent:  0.0046672821044921875
connection checking time:  0.024851560592651367
block generation total time  0.03856229782104492
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.5965204238891602  GigaBytes
Max Memory Allocated: 0.5976662635803223  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.596522331237793  GigaBytes
Max Memory Allocated: 0.5976662635803223  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.583984375 GB
    Memory Allocated: 0.9839043617248535  GigaBytes
Max Memory Allocated: 0.9872989654541016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.583984375 GB
    Memory Allocated: 0.9839057922363281  GigaBytes
Max Memory Allocated: 0.9872989654541016  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.841796875 GB
    Memory Allocated: 0.9411354064941406  GigaBytes
Max Memory Allocated: 1.2330107688903809  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.841796875 GB
    Memory Allocated: 0.9411368370056152  GigaBytes
Max Memory Allocated: 1.2330107688903809  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.845703125 GB
    Memory Allocated: 0.9904990196228027  GigaBytes
Max Memory Allocated: 1.2330107688903809  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.845703125 GB
    Memory Allocated: 0.9905004501342773  GigaBytes
Max Memory Allocated: 1.2330107688903809  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.84765625 GB
    Memory Allocated: 1.0080313682556152  GigaBytes
Max Memory Allocated: 1.2394375801086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.84765625 GB
    Memory Allocated: 1.0080327987670898  GigaBytes
Max Memory Allocated: 1.2394375801086426  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.84765625 GB
    Memory Allocated: 0.8822188377380371  GigaBytes
Max Memory Allocated: 1.2565884590148926  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.84765625 GB
    Memory Allocated: 0.8822202682495117  GigaBytes
Max Memory Allocated: 1.2565884590148926  GigaBytes

pure train time  2.2554731369018555
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.50390625 GB
    Memory Allocated: 1.464421272277832  GigaBytes
Max Memory Allocated: 1.651921272277832  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9512206315994263
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.364 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.364 GB
Metis partitioning: 0.001 seconds, peak memory: 26.364 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005293607711791992
pure dgl.metis_partition the time spent:  0.003790616989135742
connection checking time:  0.02259087562561035
block generation total time  0.038773536682128906
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.50390625 GB
    Memory Allocated: 1.6057677268981934  GigaBytes
Max Memory Allocated: 1.651921272277832  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.50390625 GB
    Memory Allocated: 1.6057696342468262  GigaBytes
Max Memory Allocated: 1.651921272277832  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.572265625 GB
    Memory Allocated: 1.7525568008422852  GigaBytes
Max Memory Allocated: 1.8550424575805664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.572265625 GB
    Memory Allocated: 1.7525582313537598  GigaBytes
Max Memory Allocated: 1.8550424575805664  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.572265625 GB
    Memory Allocated: 1.7828001976013184  GigaBytes
Max Memory Allocated: 2.001556396484375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.572265625 GB
    Memory Allocated: 1.782801628112793  GigaBytes
Max Memory Allocated: 2.001556396484375  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.7461557388305664  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.746157169342041  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.63670015335083  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6367015838623047  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6574974060058594  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.657498836517334  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

pure train time  1.7982425689697266
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.4656305313110352  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.945198893547058
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.490 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.490 GB
Metis partitioning: 0.001 seconds, peak memory: 26.490 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005921363830566406
pure dgl.metis_partition the time spent:  0.0038785934448242188
connection checking time:  0.023015975952148438
block generation total time  0.03921151161193848
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.7490859031677246  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.7490878105163574  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6674742698669434  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.667475700378418  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.7459959983825684  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.745997428894043  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6852922439575195  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6852936744689941  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.625814437866211  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6258158683776855  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.674880027770996  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6748814582824707  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

pure train time  1.8798019886016846
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.4653711318969727  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.985647201538086
loading full batch data spends  0.012369871139526367
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.490 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.490 GB
Metis partitioning: 0.001 seconds, peak memory: 26.490 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004790306091308594
pure dgl.metis_partition the time spent:  0.0037064552307128906
connection checking time:  0.022457599639892578
block generation total time  0.03876614570617676
generate_dataloader_block spend   0.0754246711730957
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6716289520263672  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.671630859375  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.7311906814575195  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.7311921119689941  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.7797741889953613  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.779775619506836  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6586041450500488  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6586055755615234  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.686525821685791  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6865272521972656  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.5947198867797852  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.5947213172912598  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

pure train time  1.7273695468902588
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.4644198417663574  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8725593090057373
loading full batch data spends  0.00881648063659668
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.490 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.490 GB
Metis partitioning: 0.000 seconds, peak memory: 26.490 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003598451614379883
pure dgl.metis_partition the time spent:  0.0030546188354492188
connection checking time:  0.013142108917236328
block generation total time  0.029118776321411133
generate_dataloader_block spend   0.05385851860046387
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6756134033203125  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6756153106689453  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.647477626800537  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6474790573120117  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.775275707244873  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.7752771377563477  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6611571311950684  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.661158561706543  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.7424015998840332  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.7424030303955078  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.639164924621582  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.6391663551330566  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

pure train time  1.808807373046875
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.64453125 GB
    Memory Allocated: 1.4646539688110352  GigaBytes
Max Memory Allocated: 2.030823230743408  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8221153020858765
Total (block generation + training)time/epoch 2.3224340677261353
pure train time/epoch 1.808807373046875

num_input_list  [4473, 4663, 4455, 4401, 4527]
