main start at this time 1691280598.2695951
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.209 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.209 GB
Metis partitioning: 0.001 seconds, peak memory: 24.209 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009360551834106445
pure dgl.metis_partition the time spent:  0.0045166015625
connection checking time:  0.023874282836914062
block generation total time  0.034754276275634766
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.197265625 GB
    Memory Allocated: 0.6574840545654297  GigaBytes
Max Memory Allocated: 0.6588444709777832  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.197265625 GB
    Memory Allocated: 0.6574859619140625  GigaBytes
Max Memory Allocated: 0.6588444709777832  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.642578125 GB
    Memory Allocated: 0.9733314514160156  GigaBytes
Max Memory Allocated: 1.0424785614013672  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.642578125 GB
    Memory Allocated: 0.9733328819274902  GigaBytes
Max Memory Allocated: 1.0424785614013672  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.892578125 GB
    Memory Allocated: 0.9966707229614258  GigaBytes
Max Memory Allocated: 1.2223310470581055  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.892578125 GB
    Memory Allocated: 0.9966721534729004  GigaBytes
Max Memory Allocated: 1.2223310470581055  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.892578125 GB
    Memory Allocated: 1.0528359413146973  GigaBytes
Max Memory Allocated: 1.2454795837402344  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.892578125 GB
    Memory Allocated: 1.0528373718261719  GigaBytes
Max Memory Allocated: 1.2454795837402344  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.892578125 GB
    Memory Allocated: 0.9806513786315918  GigaBytes
Max Memory Allocated: 1.3012466430664062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.892578125 GB
    Memory Allocated: 0.9806528091430664  GigaBytes
Max Memory Allocated: 1.3012466430664062  GigaBytes

pure train time  2.21663236618042
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.517578125 GB
    Memory Allocated: 1.4657926559448242  GigaBytes
Max Memory Allocated: 1.6532926559448242  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9524637460708618
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.358 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.358 GB
Metis partitioning: 0.001 seconds, peak memory: 26.358 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007052898406982422
pure dgl.metis_partition the time spent:  0.004236698150634766
connection checking time:  0.021812915802001953
block generation total time  0.034810543060302734
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.517578125 GB
    Memory Allocated: 1.7688579559326172  GigaBytes
Max Memory Allocated: 1.770256519317627  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.517578125 GB
    Memory Allocated: 1.76885986328125  GigaBytes
Max Memory Allocated: 1.770256519317627  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.580078125 GB
    Memory Allocated: 1.6882047653198242  GigaBytes
Max Memory Allocated: 2.017353057861328  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.580078125 GB
    Memory Allocated: 1.6882061958312988  GigaBytes
Max Memory Allocated: 2.017353057861328  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.580078125 GB
    Memory Allocated: 1.7204771041870117  GigaBytes
Max Memory Allocated: 2.017353057861328  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.580078125 GB
    Memory Allocated: 1.7204785346984863  GigaBytes
Max Memory Allocated: 2.017353057861328  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.580078125 GB
    Memory Allocated: 1.7777085304260254  GigaBytes
Max Memory Allocated: 2.017353057861328  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.580078125 GB
    Memory Allocated: 1.7777099609375  GigaBytes
Max Memory Allocated: 2.017353057861328  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.7236294746398926  GigaBytes
Max Memory Allocated: 2.0265631675720215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.7236309051513672  GigaBytes
Max Memory Allocated: 2.0265631675720215  GigaBytes

pure train time  1.7077131271362305
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.465369701385498  GigaBytes
Max Memory Allocated: 2.0265631675720215  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9444369077682495
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.487 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.487 GB
Metis partitioning: 0.000 seconds, peak memory: 26.487 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0037384033203125
pure dgl.metis_partition the time spent:  0.003416299819946289
connection checking time:  0.02115654945373535
block generation total time  0.03391432762145996
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.7154126167297363  GigaBytes
Max Memory Allocated: 2.0265631675720215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.7154145240783691  GigaBytes
Max Memory Allocated: 2.0265631675720215  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.6836156845092773  GigaBytes
Max Memory Allocated: 2.0265631675720215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.683617115020752  GigaBytes
Max Memory Allocated: 2.0265631675720215  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.6554737091064453  GigaBytes
Max Memory Allocated: 2.0265631675720215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.642578125 GB
    Memory Allocated: 1.65547513961792  GigaBytes
Max Memory Allocated: 2.0265631675720215  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.677734375 GB
    Memory Allocated: 1.8591833114624023  GigaBytes
Max Memory Allocated: 2.0265631675720215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.677734375 GB
    Memory Allocated: 1.859184741973877  GigaBytes
Max Memory Allocated: 2.0265631675720215  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6796875 GB
    Memory Allocated: 1.743514060974121  GigaBytes
Max Memory Allocated: 2.107175827026367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6796875 GB
    Memory Allocated: 1.7435154914855957  GigaBytes
Max Memory Allocated: 2.107175827026367  GigaBytes

pure train time  1.527047872543335
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.6796875 GB
    Memory Allocated: 1.4665393829345703  GigaBytes
Max Memory Allocated: 2.107175827026367  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9737539291381836
loading full batch data spends  0.008493423461914062
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.519 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.519 GB
Metis partitioning: 0.000 seconds, peak memory: 26.519 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004028797149658203
pure dgl.metis_partition the time spent:  0.003008604049682617
connection checking time:  0.012336969375610352
block generation total time  0.026993274688720703
generate_dataloader_block spend   0.05113720893859863
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6796875 GB
    Memory Allocated: 1.677635669708252  GigaBytes
Max Memory Allocated: 2.107175827026367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6796875 GB
    Memory Allocated: 1.6776375770568848  GigaBytes
Max Memory Allocated: 2.107175827026367  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6796875 GB
    Memory Allocated: 1.6375584602355957  GigaBytes
Max Memory Allocated: 2.107175827026367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6796875 GB
    Memory Allocated: 1.6375598907470703  GigaBytes
Max Memory Allocated: 2.107175827026367  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6796875 GB
    Memory Allocated: 1.6855168342590332  GigaBytes
Max Memory Allocated: 2.107175827026367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6796875 GB
    Memory Allocated: 1.6855182647705078  GigaBytes
Max Memory Allocated: 2.107175827026367  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.8689966201782227  GigaBytes
Max Memory Allocated: 2.107175827026367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.8689980506896973  GigaBytes
Max Memory Allocated: 2.107175827026367  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.7658467292785645  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.765848159790039  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

pure train time  1.6259636878967285
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.465914249420166  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.841543436050415
loading full batch data spends  0.008384466171264648
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.550 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.550 GB
Metis partitioning: 0.000 seconds, peak memory: 26.550 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005051851272583008
pure dgl.metis_partition the time spent:  0.003153085708618164
connection checking time:  0.012590169906616211
block generation total time  0.026642560958862305
generate_dataloader_block spend   0.05217862129211426
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.766362190246582  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.7663640975952148  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.7458868026733398  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.7458882331848145  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.684957504272461  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.6849589347839355  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.7587566375732422  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.7587580680847168  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.7673163414001465  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.767317771911621  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

pure train time  1.6325311660766602
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.6875 GB
    Memory Allocated: 1.467026710510254  GigaBytes
Max Memory Allocated: 2.1171417236328125  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.799242377281189
Total (block generation + training)time/epoch 2.091891884803772
pure train time/epoch 1.6325311660766602

num_input_list  [4240, 4314, 4271, 4193, 4662]
