main start at this time 1691287223.7083304
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.214 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.214 GB
Metis partitioning: 0.000 seconds, peak memory: 24.214 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.002 seconds
28
28
28
28
28
The batched output nid list before graph partition
connection checking time:  0.028235197067260742
block generation total time  0.0378415584564209
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.224609375 GB
    Memory Allocated: 0.6886134147644043  GigaBytes
Max Memory Allocated: 0.6899356842041016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.224609375 GB
    Memory Allocated: 0.6886153221130371  GigaBytes
Max Memory Allocated: 0.6899356842041016  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.69140625 GB
    Memory Allocated: 1.0434918403625488  GigaBytes
Max Memory Allocated: 1.07279634475708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.69140625 GB
    Memory Allocated: 1.0434932708740234  GigaBytes
Max Memory Allocated: 1.07279634475708  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.953125 GB
    Memory Allocated: 1.1308627128601074  GigaBytes
Max Memory Allocated: 1.2921457290649414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.953125 GB
    Memory Allocated: 1.130864143371582  GigaBytes
Max Memory Allocated: 1.2921457290649414  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.955078125 GB
    Memory Allocated: 1.178419589996338  GigaBytes
Max Memory Allocated: 1.3793563842773438  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.955078125 GB
    Memory Allocated: 1.1784210205078125  GigaBytes
Max Memory Allocated: 1.3793563842773438  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.017578125 GB
    Memory Allocated: 1.074256420135498  GigaBytes
Max Memory Allocated: 1.4267096519470215  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.017578125 GB
    Memory Allocated: 1.0742578506469727  GigaBytes
Max Memory Allocated: 1.4267096519470215  GigaBytes

pure train time  2.125793933868408
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.548828125 GB
    Memory Allocated: 1.4678187370300293  GigaBytes
Max Memory Allocated: 1.6553187370300293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9522595405578613
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.396 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.396 GB
Metis partitioning: 0.000 seconds, peak memory: 26.396 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
28
28
28
28
28
The batched output nid list before graph partition
connection checking time:  0.025593042373657227
block generation total time  0.03757429122924805
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.548828125 GB
    Memory Allocated: 1.8737382888793945  GigaBytes
Max Memory Allocated: 1.8754639625549316  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.548828125 GB
    Memory Allocated: 1.8737401962280273  GigaBytes
Max Memory Allocated: 1.8754639625549316  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8063459396362305  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.806347370147705  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8104753494262695  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8104767799377441  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8598065376281738  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8598079681396484  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.764073371887207  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.7640748023986816  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

pure train time  1.7819263935089111
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.467200756072998  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9640825986862183
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.584 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.584 GB
Metis partitioning: 0.000 seconds, peak memory: 26.584 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
28
28
28
28
28
The batched output nid list before graph partition
connection checking time:  0.02601027488708496
block generation total time  0.038120269775390625
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8415327072143555  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8415346145629883  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8007235527038574  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.800724983215332  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.855299949645996  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8553013801574707  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.762216567993164  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.7622179985046387  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8518505096435547  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8518519401550293  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

pure train time  1.7821333408355713
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.467994213104248  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.972694993019104
loading full batch data spends  0.008243322372436523
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.584 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.584 GB
Metis partitioning: 0.000 seconds, peak memory: 26.584 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.005 seconds
28
28
28
28
28
The batched output nid list before graph partition
connection checking time:  0.029349803924560547
block generation total time  0.042138099670410156
generate_dataloader_block spend   0.08632588386535645
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.7798471450805664  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.7798490524291992  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8544049263000488  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8544063568115234  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8100476264953613  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.810049057006836  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.852735996246338  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8527374267578125  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8007216453552246  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8007230758666992  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

pure train time  1.8398170471191406
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.4672069549560547  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8703408241271973
loading full batch data spends  0.007967948913574219
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.584 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.584 GB
Metis partitioning: 0.000 seconds, peak memory: 26.584 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
28
28
28
28
28
The batched output nid list before graph partition
connection checking time:  0.025557518005371094
block generation total time  0.037668466567993164
generate_dataloader_block spend   0.07121491432189941
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.7738370895385742  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.773838996887207  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8137469291687012  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8137483596801758  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.851109504699707  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8511109352111816  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8549323081970215  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.854933738708496  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8213634490966797  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.8213648796081543  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

pure train time  1.8511042594909668
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.736328125 GB
    Memory Allocated: 1.4678092002868652  GigaBytes
Max Memory Allocated: 2.121525287628174  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.823403000831604
Total (block generation + training)time/epoch 2.3450160026550293
pure train time/epoch 1.8511042594909668

num_input_list  [5866, 5794, 5888, 5782, 5939]
