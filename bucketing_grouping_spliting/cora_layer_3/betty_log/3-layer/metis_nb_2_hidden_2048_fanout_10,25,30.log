main start at this time 1691287151.4826484
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.219 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.219 GB
Metis partitioning: 0.000 seconds, peak memory: 24.219 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
70
70
The batched output nid list before graph partition
connection checking time:  0.02230381965637207
block generation total time  0.021712779998779297
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.654296875 GB
    Memory Allocated: 1.103973388671875  GigaBytes
Max Memory Allocated: 1.1077775955200195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.654296875 GB
    Memory Allocated: 1.1039762496948242  GigaBytes
Max Memory Allocated: 1.1077775955200195  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.10546875 GB
    Memory Allocated: 1.4264402389526367  GigaBytes
Max Memory Allocated: 1.4551987648010254  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.10546875 GB
    Memory Allocated: 1.4264426231384277  GigaBytes
Max Memory Allocated: 1.4551987648010254  GigaBytes

pure train time  1.5172860622406006
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.91796875 GB
    Memory Allocated: 1.4721856117248535  GigaBytes
Max Memory Allocated: 1.672935962677002  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.949554443359375
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.767 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.767 GB
Metis partitioning: 0.000 seconds, peak memory: 26.767 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
70
70
The batched output nid list before graph partition
connection checking time:  0.0181276798248291
block generation total time  0.022941112518310547
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.943359375 GB
    Memory Allocated: 2.2061586380004883  GigaBytes
Max Memory Allocated: 2.2100372314453125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.943359375 GB
    Memory Allocated: 2.2061614990234375  GigaBytes
Max Memory Allocated: 2.2100372314453125  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.0703125 GB
    Memory Allocated: 2.128138542175293  GigaBytes
Max Memory Allocated: 2.4531431198120117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.0703125 GB
    Memory Allocated: 2.128140926361084  GigaBytes
Max Memory Allocated: 2.4531431198120117  GigaBytes

pure train time  1.0071158409118652
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.0703125 GB
    Memory Allocated: 1.472142219543457  GigaBytes
Max Memory Allocated: 2.4531431198120117  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9456758499145508
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.931 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.931 GB
Metis partitioning: 0.000 seconds, peak memory: 26.931 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
70
70
The batched output nid list before graph partition
connection checking time:  0.018018007278442383
block generation total time  0.021111249923706055
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.0703125 GB
    Memory Allocated: 2.1219482421875  GigaBytes
Max Memory Allocated: 2.4531431198120117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.0703125 GB
    Memory Allocated: 2.121951103210449  GigaBytes
Max Memory Allocated: 2.4531431198120117  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.0703125 GB
    Memory Allocated: 2.2462286949157715  GigaBytes
Max Memory Allocated: 2.4531431198120117  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.0703125 GB
    Memory Allocated: 2.2462310791015625  GigaBytes
Max Memory Allocated: 2.4531431198120117  GigaBytes

pure train time  1.048628568649292
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.1328125 GB
    Memory Allocated: 1.4721579551696777  GigaBytes
Max Memory Allocated: 2.493014335632324  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9707400798797607
loading full batch data spends  0.00440526008605957
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.993 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.993 GB
Metis partitioning: 0.000 seconds, peak memory: 26.993 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
70
70
The batched output nid list before graph partition
connection checking time:  0.017915010452270508
block generation total time  0.021183490753173828
generate_dataloader_block spend   0.04571676254272461
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.1328125 GB
    Memory Allocated: 2.121065139770508  GigaBytes
Max Memory Allocated: 2.493014335632324  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.1328125 GB
    Memory Allocated: 2.121068000793457  GigaBytes
Max Memory Allocated: 2.493014335632324  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.1328125 GB
    Memory Allocated: 2.237578868865967  GigaBytes
Max Memory Allocated: 2.493014335632324  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.1328125 GB
    Memory Allocated: 2.237581253051758  GigaBytes
Max Memory Allocated: 2.493014335632324  GigaBytes

pure train time  1.0349361896514893
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.1328125 GB
    Memory Allocated: 1.4721570014953613  GigaBytes
Max Memory Allocated: 2.493014335632324  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8587322235107422
loading full batch data spends  0.006880760192871094
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.993 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.993 GB
Metis partitioning: 0.000 seconds, peak memory: 26.993 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
70
70
The batched output nid list before graph partition
connection checking time:  0.01749396324157715
block generation total time  0.020720243453979492
generate_dataloader_block spend   0.047446250915527344
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.1328125 GB
    Memory Allocated: 2.150524616241455  GigaBytes
Max Memory Allocated: 2.493014335632324  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.1328125 GB
    Memory Allocated: 2.1505274772644043  GigaBytes
Max Memory Allocated: 2.493014335632324  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.1328125 GB
    Memory Allocated: 2.158661365509033  GigaBytes
Max Memory Allocated: 2.493014335632324  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.1328125 GB
    Memory Allocated: 2.158663749694824  GigaBytes
Max Memory Allocated: 2.493014335632324  GigaBytes

pure train time  1.0092322826385498
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 4.1328125 GB
    Memory Allocated: 1.472144603729248  GigaBytes
Max Memory Allocated: 2.493014335632324  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8225427865982056
Total (block generation + training)time/epoch 1.2609020471572876
pure train time/epoch 1.0092322826385498

num_input_list  [3500, 3524, 3573, 3509, 3441]
