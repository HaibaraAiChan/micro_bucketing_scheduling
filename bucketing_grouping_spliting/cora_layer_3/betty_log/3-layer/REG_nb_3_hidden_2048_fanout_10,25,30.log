main start at this time 1691280549.8127646
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.210 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.210 GB
Metis partitioning: 0.000 seconds, peak memory: 24.210 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009440183639526367
pure dgl.metis_partition the time spent:  0.0035321712493896484
connection checking time:  0.0197603702545166
block generation total time  0.02442336082458496
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.216796875 GB
    Memory Allocated: 0.6881895065307617  GigaBytes
Max Memory Allocated: 0.6902499198913574  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.216796875 GB
    Memory Allocated: 0.6881918907165527  GigaBytes
Max Memory Allocated: 0.6902499198913574  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.787109375 GB
    Memory Allocated: 1.2367520332336426  GigaBytes
Max Memory Allocated: 1.2393202781677246  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.787109375 GB
    Memory Allocated: 1.2367539405822754  GigaBytes
Max Memory Allocated: 1.2393202781677246  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.1015625 GB
    Memory Allocated: 1.1721115112304688  GigaBytes
Max Memory Allocated: 1.4848356246948242  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.1015625 GB
    Memory Allocated: 1.1721134185791016  GigaBytes
Max Memory Allocated: 1.4848356246948242  GigaBytes

pure train time  1.622544288635254
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.6328125 GB
    Memory Allocated: 1.4674592018127441  GigaBytes
Max Memory Allocated: 1.6549592018127441  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9510037899017334
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.490 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.490 GB
Metis partitioning: 0.000 seconds, peak memory: 26.490 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005023002624511719
pure dgl.metis_partition the time spent:  0.002642393112182617
connection checking time:  0.01800370216369629
block generation total time  0.02446269989013672
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6328125 GB
    Memory Allocated: 1.8932690620422363  GigaBytes
Max Memory Allocated: 1.8957982063293457  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6328125 GB
    Memory Allocated: 1.8932714462280273  GigaBytes
Max Memory Allocated: 1.8957982063293457  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76953125 GB
    Memory Allocated: 1.9379587173461914  GigaBytes
Max Memory Allocated: 2.1414828300476074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76953125 GB
    Memory Allocated: 1.9379606246948242  GigaBytes
Max Memory Allocated: 2.1414828300476074  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76953125 GB
    Memory Allocated: 1.8490118980407715  GigaBytes
Max Memory Allocated: 2.1861186027526855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76953125 GB
    Memory Allocated: 1.8490138053894043  GigaBytes
Max Memory Allocated: 2.1861186027526855  GigaBytes

pure train time  1.2410943508148193
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.76953125 GB
    Memory Allocated: 1.4677386283874512  GigaBytes
Max Memory Allocated: 2.1861186027526855  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9588408470153809
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.616 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.616 GB
Metis partitioning: 0.000 seconds, peak memory: 26.616 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0035173892974853516
pure dgl.metis_partition the time spent:  0.002627849578857422
connection checking time:  0.015596866607666016
block generation total time  0.022474050521850586
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76953125 GB
    Memory Allocated: 1.742067813873291  GigaBytes
Max Memory Allocated: 2.1861186027526855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76953125 GB
    Memory Allocated: 1.742070198059082  GigaBytes
Max Memory Allocated: 2.1861186027526855  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.76953125 GB
    Memory Allocated: 1.9721498489379883  GigaBytes
Max Memory Allocated: 2.1861186027526855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.76953125 GB
    Memory Allocated: 1.972151756286621  GigaBytes
Max Memory Allocated: 2.1861186027526855  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.83203125 GB
    Memory Allocated: 1.9444456100463867  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.83203125 GB
    Memory Allocated: 1.9444475173950195  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

pure train time  1.2258007526397705
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.83203125 GB
    Memory Allocated: 1.4686040878295898  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9861106872558594
loading full batch data spends  0.006559133529663086
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.683 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.683 GB
Metis partitioning: 0.000 seconds, peak memory: 26.683 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005175113677978516
pure dgl.metis_partition the time spent:  0.0027379989624023438
connection checking time:  0.017956972122192383
block generation total time  0.025142908096313477
generate_dataloader_block spend   0.055921077728271484
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.83203125 GB
    Memory Allocated: 1.877840518951416  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.83203125 GB
    Memory Allocated: 1.877842903137207  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.833984375 GB
    Memory Allocated: 1.9687142372131348  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.833984375 GB
    Memory Allocated: 1.9687161445617676  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.833984375 GB
    Memory Allocated: 1.8206062316894531  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.833984375 GB
    Memory Allocated: 1.820608139038086  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

pure train time  1.274226188659668
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.833984375 GB
    Memory Allocated: 1.467453956604004  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.860836386680603
loading full batch data spends  0.006226778030395508
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.683 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.683 GB
Metis partitioning: 0.000 seconds, peak memory: 26.683 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005147695541381836
pure dgl.metis_partition the time spent:  0.0026044845581054688
connection checking time:  0.017412424087524414
block generation total time  0.02387237548828125
generate_dataloader_block spend   0.05383586883544922
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.833984375 GB
    Memory Allocated: 1.8521223068237305  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.833984375 GB
    Memory Allocated: 1.8521246910095215  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.833984375 GB
    Memory Allocated: 1.949028491973877  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.833984375 GB
    Memory Allocated: 1.9490303993225098  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.833984375 GB
    Memory Allocated: 1.8391880989074707  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.833984375 GB
    Memory Allocated: 1.8391900062561035  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

pure train time  1.327864170074463
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.833984375 GB
    Memory Allocated: 1.467453956604004  GigaBytes
Max Memory Allocated: 2.21986722946167  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8100249767303467
Total (block generation + training)time/epoch 1.614359974861145
pure train time/epoch 1.327864170074463

num_input_list  [3511, 3678, 3516, 3659, 3519]
