main start at this time 1690925905.8572288
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.209 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.209 GB
Metis partitioning: 0.001 seconds, peak memory: 24.209 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008168458938598633
pure dgl.metis_partition the time spent:  0.004560708999633789
connection checking time:  0.023953914642333984
block generation total time  0.038754940032958984
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.05859375 GB
    Memory Allocated: 0.5192222595214844  GigaBytes
Max Memory Allocated: 0.5200686454772949  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.05859375 GB
    Memory Allocated: 0.5192241668701172  GigaBytes
Max Memory Allocated: 0.5200686454772949  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.5703125 GB
    Memory Allocated: 1.0298962593078613  GigaBytes
Max Memory Allocated: 1.0320892333984375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.5703125 GB
    Memory Allocated: 1.029897689819336  GigaBytes
Max Memory Allocated: 1.0320892333984375  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.8828125 GB
    Memory Allocated: 0.9927873611450195  GigaBytes
Max Memory Allocated: 1.2777223587036133  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.8828125 GB
    Memory Allocated: 0.9927887916564941  GigaBytes
Max Memory Allocated: 1.2777223587036133  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.8828125 GB
    Memory Allocated: 0.9060468673706055  GigaBytes
Max Memory Allocated: 1.2777223587036133  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.8828125 GB
    Memory Allocated: 0.9060482978820801  GigaBytes
Max Memory Allocated: 1.2777223587036133  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.8828125 GB
    Memory Allocated: 0.9067072868347168  GigaBytes
Max Memory Allocated: 1.2777223587036133  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.8828125 GB
    Memory Allocated: 0.9067087173461914  GigaBytes
Max Memory Allocated: 1.2777223587036133  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.89453125 GB
    Memory Allocated: 1.0584516525268555  GigaBytes
Max Memory Allocated: 1.2777223587036133  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.89453125 GB
    Memory Allocated: 1.05845308303833  GigaBytes
Max Memory Allocated: 1.2777223587036133  GigaBytes

pure train time  2.2406179904937744
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.50390625 GB
    Memory Allocated: 1.466759204864502  GigaBytes
Max Memory Allocated: 1.654259204864502  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9454387426376343
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.359 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.359 GB
Metis partitioning: 0.001 seconds, peak memory: 26.359 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0051038265228271484
pure dgl.metis_partition the time spent:  0.0036940574645996094
connection checking time:  0.023335695266723633
block generation total time  0.038466453552246094
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.50390625 GB
    Memory Allocated: 1.7616333961486816  GigaBytes
Max Memory Allocated: 1.763054370880127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.50390625 GB
    Memory Allocated: 1.7616353034973145  GigaBytes
Max Memory Allocated: 1.763054370880127  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.7370600700378418  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.7370615005493164  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.6698698997497559  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.6698713302612305  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.7226486206054688  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.7226500511169434  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.6579194068908691  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.6579208374023438  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.602452278137207  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.6024537086486816  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

pure train time  1.880791425704956
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.4645962715148926  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9489853382110596
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.485 GB
Metis partitioning: 0.001 seconds, peak memory: 26.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0060350894927978516
pure dgl.metis_partition the time spent:  0.0037720203399658203
connection checking time:  0.02286529541015625
block generation total time  0.03954172134399414
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.699598789215088  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.6996006965637207  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.7929511070251465  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.62890625 GB
    Memory Allocated: 1.792952537536621  GigaBytes
Max Memory Allocated: 2.0102624893188477  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.7780275344848633  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.778028964996338  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6514863967895508  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6514878273010254  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6166605949401855  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6166620254516602  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.5992450714111328  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.5992465019226074  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

pure train time  1.680356502532959
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.463937759399414  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9438533782958984
loading full batch data spends  0.010565757751464844
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.485 GB
Metis partitioning: 0.001 seconds, peak memory: 26.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005626201629638672
pure dgl.metis_partition the time spent:  0.0039653778076171875
connection checking time:  0.0222165584564209
block generation total time  0.039067983627319336
generate_dataloader_block spend   0.07691502571105957
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.610734462738037  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.61073637008667  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.791025161743164  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.7910265922546387  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6163673400878906  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6163687705993652  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.7213397026062012  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.7213411331176758  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.718635082244873  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.7186365127563477  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.640610694885254  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6406121253967285  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

pure train time  1.8153352737426758
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.4649853706359863  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9475445747375488
loading full batch data spends  0.009509086608886719
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.485 GB
Metis partitioning: 0.000 seconds, peak memory: 26.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0034439563751220703
pure dgl.metis_partition the time spent:  0.0037841796875
connection checking time:  0.023136377334594727
block generation total time  0.03853416442871094
generate_dataloader_block spend   0.07490777969360352
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6564393043518066  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6564412117004395  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6684131622314453  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.66841459274292  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.7679228782653809  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.7679243087768555  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6913814544677734  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.691382884979248  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.7603106498718262  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.7603120803833008  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6092815399169922  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6092829704284668  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

pure train time  1.7972350120544434
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.4647350311279297  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9453661441802979
loading full batch data spends  0.009561538696289062
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.485 GB
Metis partitioning: 0.001 seconds, peak memory: 26.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005082845687866211
pure dgl.metis_partition the time spent:  0.0037806034088134766
connection checking time:  0.023804903030395508
block generation total time  0.037940025329589844
generate_dataloader_block spend   0.07640385627746582
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6629719734191895  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6629738807678223  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.7207460403442383  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.720747470855713  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.7833576202392578  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.7833590507507324  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.630195140838623  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6301965713500977  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.677964210510254  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6779656410217285  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6627960205078125  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.662797451019287  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

pure train time  1.7570247650146484
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.4649300575256348  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.945452332496643
loading full batch data spends  0.00932931900024414
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.485 GB
Metis partitioning: 0.001 seconds, peak memory: 26.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0053234100341796875
pure dgl.metis_partition the time spent:  0.0037832260131835938
connection checking time:  0.02285599708557129
block generation total time  0.038466691970825195
generate_dataloader_block spend   0.0764627456665039
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6550383567810059  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6550402641296387  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.6979002952575684  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.630859375 GB
    Memory Allocated: 1.697901725769043  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.7641139030456543  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.764115333557129  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.7064619064331055  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.70646333694458  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.697525978088379  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6975274085998535  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6165351867675781  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6165366172790527  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

pure train time  1.8263614177703857
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.464681625366211  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9486920833587646
loading full batch data spends  0.009529590606689453
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.485 GB
Metis partitioning: 0.001 seconds, peak memory: 26.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005138397216796875
pure dgl.metis_partition the time spent:  0.0037221908569335938
connection checking time:  0.024498462677001953
block generation total time  0.038362979888916016
generate_dataloader_block spend   0.07765054702758789
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6909456253051758  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6909475326538086  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6706972122192383  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.670698642730713  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6881814002990723  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6881828308105469  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6499614715576172  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6499629020690918  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.7240533828735352  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.7240548133850098  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.7181587219238281  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.7181601524353027  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

pure train time  1.9206504821777344
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.4655709266662598  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9397084712982178
loading full batch data spends  0.009171247482299805
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.485 GB
Metis partitioning: 0.001 seconds, peak memory: 26.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005040168762207031
pure dgl.metis_partition the time spent:  0.003729104995727539
connection checking time:  0.022604703903198242
block generation total time  0.038431406021118164
generate_dataloader_block spend   0.07570767402648926
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.67132568359375  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6713275909423828  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.7656974792480469  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.7656989097595215  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6583166122436523  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.658318042755127  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.735236644744873  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.7352380752563477  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6895394325256348  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6895408630371094  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6238322257995605  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6238336563110352  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

pure train time  1.7741968631744385
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.4648489952087402  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.936226487159729
loading full batch data spends  0.009633064270019531
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 26.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 26.485 GB
Metis partitioning: 0.001 seconds, peak memory: 26.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005151510238647461
pure dgl.metis_partition the time spent:  0.003813028335571289
connection checking time:  0.022524356842041016
block generation total time  0.03861069679260254
generate_dataloader_block spend   0.07597947120666504
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6502509117126465  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6502528190612793  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.8101458549499512  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.8101472854614258  GigaBytes
Max Memory Allocated: 2.0417675971984863  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.7159090042114258  GigaBytes
Max Memory Allocated: 2.0587334632873535  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.7159104347229004  GigaBytes
Max Memory Allocated: 2.0587334632873535  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.691601276397705  GigaBytes
Max Memory Allocated: 2.0587334632873535  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6916027069091797  GigaBytes
Max Memory Allocated: 2.0587334632873535  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.697463035583496  GigaBytes
Max Memory Allocated: 2.0587334632873535  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.6974644660949707  GigaBytes
Max Memory Allocated: 2.0587334632873535  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.5713486671447754  GigaBytes
Max Memory Allocated: 2.0587334632873535  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.57135009765625  GigaBytes
Max Memory Allocated: 2.0587334632873535  GigaBytes

pure train time  1.8395922183990479
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.4645910263061523  GigaBytes
Max Memory Allocated: 2.0587334632873535  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.940207600593567
Total (block generation + training)time/epoch 2.3845208372388567
pure train time/epoch 1.8191767930984497

num_input_list  [4545, 4496, 4449, 4302, 4593, 4507, 4502, 4496, 4559, 4550]
