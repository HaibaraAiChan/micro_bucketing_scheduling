main start at this time 1689552255.4346333
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.0001418590545654297
len(bkt)  20
len(bkt)  25
len(bkt)  26
len(bkt)  22
len(bkt)  15
len(bkt)  11
len(bkt)  4
len(bkt)  3
len(bkt)  4
len(bkt)  3
len(bkt)  1
len(bkt)  2
len(bkt)  1
len(bkt)  1
len(bkt)  2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

memory_constraint:  3.8
sum(estimated_mem)
14.19501480460167
15
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3800
 
sorted_dict  {3: 2283, 4: 1878, 2: 1594, 5: 1577, 1: 1374, 14: 1144, 8: 868, 6: 666, 9: 620, 7: 478, 0: 439, 13: 425, 11: 401, 12: 271, 10: 169}

weights after sort [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
res_tmp  [1594  868  666  401  271]

remove bucket_id:  [2, 6, 7, 12, 13]
original bucket_id :,  [2, 8, 6, 11, 12]
remove weights:  [1594  868  666  401  271], 		------------sum 3800

before remove weights,  [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
after remove pre pack weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
res_tmp  [2283  478  439  425  169]

remove bucket_id:  [0, 6, 7, 8, 9]
original bucket_id :,  [3, 7, 0, 13, 10]
remove weights:  [2283  478  439  425  169], 		------------sum 3794

before remove weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
after remove pre pack weights,  [1878, 1577, 1374, 1144, 620]
res_tmp  [1878 1144  620]

remove bucket_id:  [0, 3, 4]
original bucket_id :,  [4, 14, 9]
remove weights:  [1878 1144  620], 		------------sum 3642

before remove weights,  [1878, 1577, 1374, 1144, 620]
after remove pre pack weights,  [1577, 1374]
G_BUCKET_ID_list [[2, 8, 6, 11, 12], [3, 7, 0, 13, 10], [4, 14, 9], [5, 1]]
Groups_mem_list  [[1594, 868, 666, 401, 271], [2283, 478, 439, 425, 169], [1878, 1144, 620], [1577, 1374]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.10994315147399902
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[2, 8, 6, 11, 12]
2
8
6
11
12
current group_mem  3.803140841424465
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[3, 7, 0, 13, 10]
3
7
0
13
10
current group_mem  3.7971936464309692
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[4, 14, 9]
4
14
9
current group_mem  3.6430855840444565
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[5, 1]
5
1
current group_mem  2.9515947327017784
batches output list generation spend  0.0007183551788330078
self.weights_list  [0.2642857142857143, 0.3357142857142857, 0.14285714285714285, 0.2571428571428571]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0014836788177490234
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.11073899269104004
len local_batched_seeds_list  4
partition total batch output list spend :  0.11366558074951172
self.buckets_partition() spend  sec:  0.11225247383117676
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
layer  2
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.818359375 GB
    Memory Allocated: 0.3752002716064453  GigaBytes
Max Memory Allocated: 0.3752002716064453  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.390625 GB
    Memory Allocated: 0.854586124420166  GigaBytes
Max Memory Allocated: 0.8567495346069336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.390625 GB
    Memory Allocated: 0.854588508605957  GigaBytes
Max Memory Allocated: 0.8567495346069336  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.8359375 GB
    Memory Allocated: 0.7399172782897949  GigaBytes
Max Memory Allocated: 1.227489948272705  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.8359375 GB
    Memory Allocated: 1.1941437721252441  GigaBytes
Max Memory Allocated: 1.227489948272705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.8359375 GB
    Memory Allocated: 1.194145679473877  GigaBytes
Max Memory Allocated: 1.227489948272705  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.0234375 GB
    Memory Allocated: 0.7395930290222168  GigaBytes
Max Memory Allocated: 1.441533088684082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.0234375 GB
    Memory Allocated: 1.1779842376708984  GigaBytes
Max Memory Allocated: 1.441533088684082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.0234375 GB
    Memory Allocated: 1.177985668182373  GigaBytes
Max Memory Allocated: 1.441533088684082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.0234375 GB
    Memory Allocated: 0.7393317222595215  GigaBytes
Max Memory Allocated: 1.441533088684082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.0234375 GB
    Memory Allocated: 1.0937724113464355  GigaBytes
Max Memory Allocated: 1.441533088684082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.0234375 GB
    Memory Allocated: 1.0937738418579102  GigaBytes
Max Memory Allocated: 1.441533088684082  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.4685478210449219  GigaBytes
Max Memory Allocated: 1.6560478210449219  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9517686367034912
pure train time :  1.8115577697753906
train time :  2.601121664047241
end to end time :  2.7730541229248047
connection check time:  0.01676201820373535
block generation time  0.04038262367248535
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.00012755393981933594
len(bkt)  20
len(bkt)  25
len(bkt)  26
len(bkt)  22
len(bkt)  15
len(bkt)  11
len(bkt)  4
len(bkt)  3
len(bkt)  4
len(bkt)  3
len(bkt)  1
len(bkt)  2
len(bkt)  1
len(bkt)  1
len(bkt)  2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

memory_constraint:  3.8
sum(estimated_mem)
14.19501480460167
15
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3800
 
sorted_dict  {3: 2283, 4: 1878, 2: 1594, 5: 1577, 1: 1374, 14: 1144, 8: 868, 6: 666, 9: 620, 7: 478, 0: 439, 13: 425, 11: 401, 12: 271, 10: 169}

weights after sort [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
res_tmp  [1594  868  666  401  271]

remove bucket_id:  [2, 6, 7, 12, 13]
original bucket_id :,  [2, 8, 6, 11, 12]
remove weights:  [1594  868  666  401  271], 		------------sum 3800

before remove weights,  [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
after remove pre pack weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
res_tmp  [2283  478  439  425  169]

remove bucket_id:  [0, 6, 7, 8, 9]
original bucket_id :,  [3, 7, 0, 13, 10]
remove weights:  [2283  478  439  425  169], 		------------sum 3794

before remove weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
after remove pre pack weights,  [1878, 1577, 1374, 1144, 620]
res_tmp  [1878 1144  620]

remove bucket_id:  [0, 3, 4]
original bucket_id :,  [4, 14, 9]
remove weights:  [1878 1144  620], 		------------sum 3642

before remove weights,  [1878, 1577, 1374, 1144, 620]
after remove pre pack weights,  [1577, 1374]
G_BUCKET_ID_list [[2, 8, 6, 11, 12], [3, 7, 0, 13, 10], [4, 14, 9], [5, 1]]
Groups_mem_list  [[1594, 868, 666, 401, 271], [2283, 478, 439, 425, 169], [1878, 1144, 620], [1577, 1374]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.10838174819946289
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[2, 8, 6, 11, 12]
2
8
6
11
12
current group_mem  3.803140841424465
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[3, 7, 0, 13, 10]
3
7
0
13
10
current group_mem  3.7971936464309692
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[4, 14, 9]
4
14
9
current group_mem  3.6430855840444565
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[5, 1]
5
1
current group_mem  2.9515947327017784
batches output list generation spend  0.0001456737518310547
self.weights_list  [0.2642857142857143, 0.3357142857142857, 0.14285714285714285, 0.2571428571428571]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0009505748748779297
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.10858440399169922
len local_batched_seeds_list  4
partition total batch output list spend :  0.11056256294250488
self.buckets_partition() spend  sec:  0.10955381393432617
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
layer  2
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.4705352783203125  GigaBytes
Max Memory Allocated: 1.6560478210449219  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.9491806030273438  GigaBytes
Max Memory Allocated: 1.9513449668884277  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.6484375 GB
    Memory Allocated: 1.9491548538208008  GigaBytes
Max Memory Allocated: 1.9513449668884277  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.4692401885986328  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.923835277557373  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.9238371849060059  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.4690608978271484  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.9186463356018066  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.9186477661132812  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.4686279296875  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.8267641067504883  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.826765537261963  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.46867036819458  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9492030143737793
pure train time :  1.4222559928894043
train time :  1.6816015243530273
end to end time :  1.8448173999786377
connection check time:  0.016553163528442383
block generation time  0.03535032272338867
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.00010347366333007812
len(bkt)  20
len(bkt)  25
len(bkt)  26
len(bkt)  22
len(bkt)  15
len(bkt)  11
len(bkt)  4
len(bkt)  3
len(bkt)  4
len(bkt)  3
len(bkt)  1
len(bkt)  2
len(bkt)  1
len(bkt)  1
len(bkt)  2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

memory_constraint:  3.8
sum(estimated_mem)
14.19501480460167
15
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3800
 
sorted_dict  {3: 2283, 4: 1878, 2: 1594, 5: 1577, 1: 1374, 14: 1144, 8: 868, 6: 666, 9: 620, 7: 478, 0: 439, 13: 425, 11: 401, 12: 271, 10: 169}

weights after sort [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
res_tmp  [1594  868  666  401  271]

remove bucket_id:  [2, 6, 7, 12, 13]
original bucket_id :,  [2, 8, 6, 11, 12]
remove weights:  [1594  868  666  401  271], 		------------sum 3800

before remove weights,  [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
after remove pre pack weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
res_tmp  [2283  478  439  425  169]

remove bucket_id:  [0, 6, 7, 8, 9]
original bucket_id :,  [3, 7, 0, 13, 10]
remove weights:  [2283  478  439  425  169], 		------------sum 3794

before remove weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
after remove pre pack weights,  [1878, 1577, 1374, 1144, 620]
res_tmp  [1878 1144  620]

remove bucket_id:  [0, 3, 4]
original bucket_id :,  [4, 14, 9]
remove weights:  [1878 1144  620], 		------------sum 3642

before remove weights,  [1878, 1577, 1374, 1144, 620]
after remove pre pack weights,  [1577, 1374]
G_BUCKET_ID_list [[2, 8, 6, 11, 12], [3, 7, 0, 13, 10], [4, 14, 9], [5, 1]]
Groups_mem_list  [[1594, 868, 666, 401, 271], [2283, 478, 439, 425, 169], [1878, 1144, 620], [1577, 1374]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.08354425430297852
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[2, 8, 6, 11, 12]
2
8
6
11
12
current group_mem  3.803140841424465
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[3, 7, 0, 13, 10]
3
7
0
13
10
current group_mem  3.7971936464309692
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[4, 14, 9]
4
14
9
current group_mem  3.6430855840444565
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[5, 1]
5
1
current group_mem  2.9515947327017784
batches output list generation spend  0.0001423358917236328
self.weights_list  [0.2642857142857143, 0.3357142857142857, 0.14285714285714285, 0.2571428571428571]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0005724430084228516
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.08373904228210449
len local_batched_seeds_list  4
partition total batch output list spend :  0.08538198471069336
self.buckets_partition() spend  sec:  0.08433055877685547
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
layer  2
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.7734375 GB
    Memory Allocated: 1.4705352783203125  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.956247329711914  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.956221580505371  GigaBytes
Max Memory Allocated: 2.1974501609802246  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4692296981811523  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9232845306396484  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9232864379882812  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.469092845916748  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9191503524780273  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.919151782989502  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.468665599822998  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8249516487121582  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8249530792236328  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4687080383300781  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9510442018508911
pure train time :  1.440265417098999
train time :  1.7000782489776611
end to end time :  1.835911750793457
connection check time:  0.0163271427154541
block generation time  0.03338265419006348
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  7.724761962890625e-05
len(bkt)  20
len(bkt)  25
len(bkt)  26
len(bkt)  22
len(bkt)  15
len(bkt)  11
len(bkt)  4
len(bkt)  3
len(bkt)  4
len(bkt)  3
len(bkt)  1
len(bkt)  2
len(bkt)  1
len(bkt)  1
len(bkt)  2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

memory_constraint:  3.8
sum(estimated_mem)
14.19501480460167
15
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3800
 
sorted_dict  {3: 2283, 4: 1878, 2: 1594, 5: 1577, 1: 1374, 14: 1144, 8: 868, 6: 666, 9: 620, 7: 478, 0: 439, 13: 425, 11: 401, 12: 271, 10: 169}

weights after sort [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
res_tmp  [1594  868  666  401  271]

remove bucket_id:  [2, 6, 7, 12, 13]
original bucket_id :,  [2, 8, 6, 11, 12]
remove weights:  [1594  868  666  401  271], 		------------sum 3800

before remove weights,  [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
after remove pre pack weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
res_tmp  [2283  478  439  425  169]

remove bucket_id:  [0, 6, 7, 8, 9]
original bucket_id :,  [3, 7, 0, 13, 10]
remove weights:  [2283  478  439  425  169], 		------------sum 3794

before remove weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
after remove pre pack weights,  [1878, 1577, 1374, 1144, 620]
res_tmp  [1878 1144  620]

remove bucket_id:  [0, 3, 4]
original bucket_id :,  [4, 14, 9]
remove weights:  [1878 1144  620], 		------------sum 3642

before remove weights,  [1878, 1577, 1374, 1144, 620]
after remove pre pack weights,  [1577, 1374]
G_BUCKET_ID_list [[2, 8, 6, 11, 12], [3, 7, 0, 13, 10], [4, 14, 9], [5, 1]]
Groups_mem_list  [[1594, 868, 666, 401, 271], [2283, 478, 439, 425, 169], [1878, 1144, 620], [1577, 1374]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.08381247520446777
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[2, 8, 6, 11, 12]
2
8
6
11
12
current group_mem  3.803140841424465
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[3, 7, 0, 13, 10]
3
7
0
13
10
current group_mem  3.7971936464309692
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[4, 14, 9]
4
14
9
current group_mem  3.6430855840444565
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[5, 1]
5
1
current group_mem  2.9515947327017784
batches output list generation spend  0.00020384788513183594
self.weights_list  [0.2642857142857143, 0.3357142857142857, 0.14285714285714285, 0.2571428571428571]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0005903244018554688
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.08406758308410645
len local_batched_seeds_list  4
partition total batch output list spend :  0.08564352989196777
self.buckets_partition() spend  sec:  0.08467984199523926
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
layer  2
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4705352783203125  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9512109756469727  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9511852264404297  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4692296981811523  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9236054420471191  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.923607349395752  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4690556526184082  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9133987426757812  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9134001731872559  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4685792922973633  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.822310447692871  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8223118782043457  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.468620777130127  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.945252537727356
pure train time :  1.453503131866455
train time :  1.712449550628662
end to end time :  1.8327147960662842
connection check time:  0.009849071502685547
block generation time  0.02408432960510254
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  8.559226989746094e-05
len(bkt)  20
len(bkt)  25
len(bkt)  26
len(bkt)  22
len(bkt)  15
len(bkt)  11
len(bkt)  4
len(bkt)  3
len(bkt)  4
len(bkt)  3
len(bkt)  1
len(bkt)  2
len(bkt)  1
len(bkt)  1
len(bkt)  2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

memory_constraint:  3.8
sum(estimated_mem)
14.19501480460167
15
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3800
 
sorted_dict  {3: 2283, 4: 1878, 2: 1594, 5: 1577, 1: 1374, 14: 1144, 8: 868, 6: 666, 9: 620, 7: 478, 0: 439, 13: 425, 11: 401, 12: 271, 10: 169}

weights after sort [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
res_tmp  [1594  868  666  401  271]

remove bucket_id:  [2, 6, 7, 12, 13]
original bucket_id :,  [2, 8, 6, 11, 12]
remove weights:  [1594  868  666  401  271], 		------------sum 3800

before remove weights,  [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
after remove pre pack weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
res_tmp  [2283  478  439  425  169]

remove bucket_id:  [0, 6, 7, 8, 9]
original bucket_id :,  [3, 7, 0, 13, 10]
remove weights:  [2283  478  439  425  169], 		------------sum 3794

before remove weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
after remove pre pack weights,  [1878, 1577, 1374, 1144, 620]
res_tmp  [1878 1144  620]

remove bucket_id:  [0, 3, 4]
original bucket_id :,  [4, 14, 9]
remove weights:  [1878 1144  620], 		------------sum 3642

before remove weights,  [1878, 1577, 1374, 1144, 620]
after remove pre pack weights,  [1577, 1374]
G_BUCKET_ID_list [[2, 8, 6, 11, 12], [3, 7, 0, 13, 10], [4, 14, 9], [5, 1]]
Groups_mem_list  [[1594, 868, 666, 401, 271], [2283, 478, 439, 425, 169], [1878, 1144, 620], [1577, 1374]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.08444523811340332
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[2, 8, 6, 11, 12]
2
8
6
11
12
current group_mem  3.803140841424465
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[3, 7, 0, 13, 10]
3
7
0
13
10
current group_mem  3.7971936464309692
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[4, 14, 9]
4
14
9
current group_mem  3.6430855840444565
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[5, 1]
5
1
current group_mem  2.9515947327017784
batches output list generation spend  0.000232696533203125
self.weights_list  [0.2642857142857143, 0.3357142857142857, 0.14285714285714285, 0.2571428571428571]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0006041526794433594
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.08474111557006836
len local_batched_seeds_list  4
partition total batch output list spend :  0.08635401725769043
self.buckets_partition() spend  sec:  0.08537125587463379
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
layer  2
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4705352783203125  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9480228424072266  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9479970932006836  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4691600799560547  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9235448837280273  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9235467910766602  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.469130516052246  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9137606620788574  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.913762092590332  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4686174392700195  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8265533447265625  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.826554775238037  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4686598777770996  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.943617343902588
pure train time :  1.4398763179779053
train time :  1.7004094123840332
end to end time :  1.828747034072876
connection check time:  0.010197877883911133
block generation time  0.02400493621826172
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  7.987022399902344e-05
len(bkt)  20
len(bkt)  25
len(bkt)  26
len(bkt)  22
len(bkt)  15
len(bkt)  11
len(bkt)  4
len(bkt)  3
len(bkt)  4
len(bkt)  3
len(bkt)  1
len(bkt)  2
len(bkt)  1
len(bkt)  1
len(bkt)  2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

memory_constraint:  3.8
sum(estimated_mem)
14.19501480460167
15
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3800
 
sorted_dict  {3: 2283, 4: 1878, 2: 1594, 5: 1577, 1: 1374, 14: 1144, 8: 868, 6: 666, 9: 620, 7: 478, 0: 439, 13: 425, 11: 401, 12: 271, 10: 169}

weights after sort [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
res_tmp  [1594  868  666  401  271]

remove bucket_id:  [2, 6, 7, 12, 13]
original bucket_id :,  [2, 8, 6, 11, 12]
remove weights:  [1594  868  666  401  271], 		------------sum 3800

before remove weights,  [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
after remove pre pack weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
res_tmp  [2283  478  439  425  169]

remove bucket_id:  [0, 6, 7, 8, 9]
original bucket_id :,  [3, 7, 0, 13, 10]
remove weights:  [2283  478  439  425  169], 		------------sum 3794

before remove weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
after remove pre pack weights,  [1878, 1577, 1374, 1144, 620]
res_tmp  [1878 1144  620]

remove bucket_id:  [0, 3, 4]
original bucket_id :,  [4, 14, 9]
remove weights:  [1878 1144  620], 		------------sum 3642

before remove weights,  [1878, 1577, 1374, 1144, 620]
after remove pre pack weights,  [1577, 1374]
G_BUCKET_ID_list [[2, 8, 6, 11, 12], [3, 7, 0, 13, 10], [4, 14, 9], [5, 1]]
Groups_mem_list  [[1594, 868, 666, 401, 271], [2283, 478, 439, 425, 169], [1878, 1144, 620], [1577, 1374]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.08365440368652344
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[2, 8, 6, 11, 12]
2
8
6
11
12
current group_mem  3.803140841424465
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[3, 7, 0, 13, 10]
3
7
0
13
10
current group_mem  3.7971936464309692
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[4, 14, 9]
4
14
9
current group_mem  3.6430855840444565
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[5, 1]
5
1
current group_mem  2.9515947327017784
batches output list generation spend  0.0001442432403564453
self.weights_list  [0.2642857142857143, 0.3357142857142857, 0.14285714285714285, 0.2571428571428571]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0005686283111572266
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.08384895324707031
len local_batched_seeds_list  4
partition total batch output list spend :  0.08540892601013184
self.buckets_partition() spend  sec:  0.08444094657897949
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
layer  2
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4705352783203125  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.954226016998291  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.954200267791748  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4691176414489746  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9209551811218262  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.920957088470459  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4689650535583496  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.915544033050537  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9155454635620117  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4686708450317383  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.825718879699707  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8257203102111816  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4687132835388184  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9384695291519165
pure train time :  1.4540929794311523
train time :  1.714310884475708
end to end time :  1.8350932598114014
connection check time:  0.009936809539794922
block generation time  0.024629592895507812
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  7.843971252441406e-05
len(bkt)  20
len(bkt)  25
len(bkt)  26
len(bkt)  22
len(bkt)  15
len(bkt)  11
len(bkt)  4
len(bkt)  3
len(bkt)  4
len(bkt)  3
len(bkt)  1
len(bkt)  2
len(bkt)  1
len(bkt)  1
len(bkt)  2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

memory_constraint:  3.8
sum(estimated_mem)
14.19501480460167
15
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3800
 
sorted_dict  {3: 2283, 4: 1878, 2: 1594, 5: 1577, 1: 1374, 14: 1144, 8: 868, 6: 666, 9: 620, 7: 478, 0: 439, 13: 425, 11: 401, 12: 271, 10: 169}

weights after sort [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
res_tmp  [1594  868  666  401  271]

remove bucket_id:  [2, 6, 7, 12, 13]
original bucket_id :,  [2, 8, 6, 11, 12]
remove weights:  [1594  868  666  401  271], 		------------sum 3800

before remove weights,  [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
after remove pre pack weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
res_tmp  [2283  478  439  425  169]

remove bucket_id:  [0, 6, 7, 8, 9]
original bucket_id :,  [3, 7, 0, 13, 10]
remove weights:  [2283  478  439  425  169], 		------------sum 3794

before remove weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
after remove pre pack weights,  [1878, 1577, 1374, 1144, 620]
res_tmp  [1878 1144  620]

remove bucket_id:  [0, 3, 4]
original bucket_id :,  [4, 14, 9]
remove weights:  [1878 1144  620], 		------------sum 3642

before remove weights,  [1878, 1577, 1374, 1144, 620]
after remove pre pack weights,  [1577, 1374]
G_BUCKET_ID_list [[2, 8, 6, 11, 12], [3, 7, 0, 13, 10], [4, 14, 9], [5, 1]]
Groups_mem_list  [[1594, 868, 666, 401, 271], [2283, 478, 439, 425, 169], [1878, 1144, 620], [1577, 1374]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.08465576171875
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[2, 8, 6, 11, 12]
2
8
6
11
12
current group_mem  3.803140841424465
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[3, 7, 0, 13, 10]
3
7
0
13
10
current group_mem  3.7971936464309692
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[4, 14, 9]
4
14
9
current group_mem  3.6430855840444565
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[5, 1]
5
1
current group_mem  2.9515947327017784
batches output list generation spend  0.00014734268188476562
self.weights_list  [0.2642857142857143, 0.3357142857142857, 0.14285714285714285, 0.2571428571428571]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0005679130554199219
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.08485841751098633
len local_batched_seeds_list  4
partition total batch output list spend :  0.0864253044128418
self.buckets_partition() spend  sec:  0.08544659614562988
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
layer  2
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4705352783203125  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9542183876037598  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9541926383972168  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.469245433807373  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9250340461730957  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9250359535217285  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4691519737243652  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.914708137512207  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9147095680236816  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4687509536743164  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8300118446350098  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8300132751464844  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4687933921813965  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9428988695144653
pure train time :  1.4556200504302979
train time :  1.7155299186706543
end to end time :  1.8521695137023926
connection check time:  0.016323089599609375
block generation time  0.03317117691040039
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.00012874603271484375
len(bkt)  20
len(bkt)  25
len(bkt)  26
len(bkt)  22
len(bkt)  15
len(bkt)  11
len(bkt)  4
len(bkt)  3
len(bkt)  4
len(bkt)  3
len(bkt)  1
len(bkt)  2
len(bkt)  1
len(bkt)  1
len(bkt)  2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

memory_constraint:  3.8
sum(estimated_mem)
14.19501480460167
15
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3800
 
sorted_dict  {3: 2283, 4: 1878, 2: 1594, 5: 1577, 1: 1374, 14: 1144, 8: 868, 6: 666, 9: 620, 7: 478, 0: 439, 13: 425, 11: 401, 12: 271, 10: 169}

weights after sort [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
res_tmp  [1594  868  666  401  271]

remove bucket_id:  [2, 6, 7, 12, 13]
original bucket_id :,  [2, 8, 6, 11, 12]
remove weights:  [1594  868  666  401  271], 		------------sum 3800

before remove weights,  [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
after remove pre pack weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
res_tmp  [2283  478  439  425  169]

remove bucket_id:  [0, 6, 7, 8, 9]
original bucket_id :,  [3, 7, 0, 13, 10]
remove weights:  [2283  478  439  425  169], 		------------sum 3794

before remove weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
after remove pre pack weights,  [1878, 1577, 1374, 1144, 620]
res_tmp  [1878 1144  620]

remove bucket_id:  [0, 3, 4]
original bucket_id :,  [4, 14, 9]
remove weights:  [1878 1144  620], 		------------sum 3642

before remove weights,  [1878, 1577, 1374, 1144, 620]
after remove pre pack weights,  [1577, 1374]
G_BUCKET_ID_list [[2, 8, 6, 11, 12], [3, 7, 0, 13, 10], [4, 14, 9], [5, 1]]
Groups_mem_list  [[1594, 868, 666, 401, 271], [2283, 478, 439, 425, 169], [1878, 1144, 620], [1577, 1374]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.10846543312072754
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[2, 8, 6, 11, 12]
2
8
6
11
12
current group_mem  3.803140841424465
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[3, 7, 0, 13, 10]
3
7
0
13
10
current group_mem  3.7971936464309692
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[4, 14, 9]
4
14
9
current group_mem  3.6430855840444565
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[5, 1]
5
1
current group_mem  2.9515947327017784
batches output list generation spend  0.0001418590545654297
self.weights_list  [0.2642857142857143, 0.3357142857142857, 0.14285714285714285, 0.2571428571428571]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0008449554443359375
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.10866355895996094
len local_batched_seeds_list  4
partition total batch output list spend :  0.11055111885070801
self.buckets_partition() spend  sec:  0.1095268726348877
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
layer  2
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4705352783203125  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9561424255371094  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9561166763305664  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.469202995300293  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9237828254699707  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9237847328186035  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.469264030456543  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9200592041015625  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.920060634613037  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4686646461486816  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8218631744384766  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8218646049499512  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4687061309814453  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9426050186157227
pure train time :  1.4551365375518799
train time :  1.718165397644043
end to end time :  1.8971571922302246
connection check time:  0.03452038764953613
block generation time  0.032929182052612305
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.00013375282287597656
len(bkt)  20
len(bkt)  25
len(bkt)  26
len(bkt)  22
len(bkt)  15
len(bkt)  11
len(bkt)  4
len(bkt)  3
len(bkt)  4
len(bkt)  3
len(bkt)  1
len(bkt)  2
len(bkt)  1
len(bkt)  1
len(bkt)  2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

memory_constraint:  3.8
sum(estimated_mem)
14.19501480460167
15
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3800
 
sorted_dict  {3: 2283, 4: 1878, 2: 1594, 5: 1577, 1: 1374, 14: 1144, 8: 868, 6: 666, 9: 620, 7: 478, 0: 439, 13: 425, 11: 401, 12: 271, 10: 169}

weights after sort [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
res_tmp  [1594  868  666  401  271]

remove bucket_id:  [2, 6, 7, 12, 13]
original bucket_id :,  [2, 8, 6, 11, 12]
remove weights:  [1594  868  666  401  271], 		------------sum 3800

before remove weights,  [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
after remove pre pack weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
res_tmp  [2283  478  439  425  169]

remove bucket_id:  [0, 6, 7, 8, 9]
original bucket_id :,  [3, 7, 0, 13, 10]
remove weights:  [2283  478  439  425  169], 		------------sum 3794

before remove weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
after remove pre pack weights,  [1878, 1577, 1374, 1144, 620]
res_tmp  [1878 1144  620]

remove bucket_id:  [0, 3, 4]
original bucket_id :,  [4, 14, 9]
remove weights:  [1878 1144  620], 		------------sum 3642

before remove weights,  [1878, 1577, 1374, 1144, 620]
after remove pre pack weights,  [1577, 1374]
G_BUCKET_ID_list [[2, 8, 6, 11, 12], [3, 7, 0, 13, 10], [4, 14, 9], [5, 1]]
Groups_mem_list  [[1594, 868, 666, 401, 271], [2283, 478, 439, 425, 169], [1878, 1144, 620], [1577, 1374]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.10826253890991211
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[2, 8, 6, 11, 12]
2
8
6
11
12
current group_mem  3.803140841424465
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[3, 7, 0, 13, 10]
3
7
0
13
10
current group_mem  3.7971936464309692
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[4, 14, 9]
4
14
9
current group_mem  3.6430855840444565
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[5, 1]
5
1
current group_mem  2.9515947327017784
batches output list generation spend  0.00015878677368164062
self.weights_list  [0.2642857142857143, 0.3357142857142857, 0.14285714285714285, 0.2571428571428571]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0008938312530517578
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.1084907054901123
len local_batched_seeds_list  4
partition total batch output list spend :  0.11043405532836914
self.buckets_partition() spend  sec:  0.10940790176391602
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
layer  2
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4705352783203125  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9535579681396484  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9535322189331055  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.469294548034668  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9260187149047852  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.926020622253418  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4691839218139648  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9241929054260254  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9241943359375  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.468595027923584  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.820950984954834  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8209524154663086  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4686365127563477  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.936830997467041
pure train time :  1.454293966293335
train time :  1.7143306732177734
end to end time :  1.8760716915130615
connection check time:  0.017370223999023438
block generation time  0.03303837776184082
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  7.62939453125e-05
len(bkt)  20
len(bkt)  25
len(bkt)  26
len(bkt)  22
len(bkt)  15
len(bkt)  11
len(bkt)  4
len(bkt)  3
len(bkt)  4
len(bkt)  3
len(bkt)  1
len(bkt)  2
len(bkt)  1
len(bkt)  1
len(bkt)  2
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

memory_constraint:  3.8
sum(estimated_mem)
14.19501480460167
15
self.K  4
the grouping_fanout_arxiv called successfully
capacity  3800
 
sorted_dict  {3: 2283, 4: 1878, 2: 1594, 5: 1577, 1: 1374, 14: 1144, 8: 868, 6: 666, 9: 620, 7: 478, 0: 439, 13: 425, 11: 401, 12: 271, 10: 169}

weights after sort [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
res_tmp  [1594  868  666  401  271]

remove bucket_id:  [2, 6, 7, 12, 13]
original bucket_id :,  [2, 8, 6, 11, 12]
remove weights:  [1594  868  666  401  271], 		------------sum 3800

before remove weights,  [2283, 1878, 1594, 1577, 1374, 1144, 868, 666, 620, 478, 439, 425, 401, 271, 169]
after remove pre pack weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
res_tmp  [2283  478  439  425  169]

remove bucket_id:  [0, 6, 7, 8, 9]
original bucket_id :,  [3, 7, 0, 13, 10]
remove weights:  [2283  478  439  425  169], 		------------sum 3794

before remove weights,  [2283, 1878, 1577, 1374, 1144, 620, 478, 439, 425, 169]
after remove pre pack weights,  [1878, 1577, 1374, 1144, 620]
res_tmp  [1878 1144  620]

remove bucket_id:  [0, 3, 4]
original bucket_id :,  [4, 14, 9]
remove weights:  [1878 1144  620], 		------------sum 3642

before remove weights,  [1878, 1577, 1374, 1144, 620]
after remove pre pack weights,  [1577, 1374]
G_BUCKET_ID_list [[2, 8, 6, 11, 12], [3, 7, 0, 13, 10], [4, 14, 9], [5, 1]]
Groups_mem_list  [[1594, 868, 666, 401, 271], [2283, 478, 439, 425, 169], [1878, 1144, 620], [1577, 1374]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.08309102058410645
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[2, 8, 6, 11, 12]
2
8
6
11
12
current group_mem  3.803140841424465
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[3, 7, 0, 13, 10]
3
7
0
13
10
current group_mem  3.7971936464309692
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[4, 14, 9]
4
14
9
current group_mem  3.6430855840444565
[0.4396008476614952, 1.374441683292389, 1.5948124453425407, 2.2839434891939163, 1.8786997273564339, 1.5771530494093895, 0.6665662229061127, 0.4780137687921524, 0.8689616918563843, 0.6201625987887383, 0.16984806954860687, 0.40121957659721375, 0.27158090472221375, 0.42578747123479843, 1.1442232578992844]
[5, 1]
5
1
current group_mem  2.9515947327017784
batches output list generation spend  0.00014472007751464844
self.weights_list  [0.2642857142857143, 0.3357142857142857, 0.14285714285714285, 0.2571428571428571]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0006320476531982422
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.08328771591186523
len local_batched_seeds_list  4
partition total batch output list spend :  0.08490347862243652
self.buckets_partition() spend  sec:  0.08394050598144531
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
layer  2
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4705352783203125  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9542322158813477  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9542064666748047  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4691123962402344  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.922574520111084  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9225764274597168  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4689807891845703  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9207720756530762  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.9207735061645508  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4685320854187012  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.827651023864746  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.8276524543762207  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 3.775390625 GB
    Memory Allocated: 1.4685745239257812  GigaBytes
Max Memory Allocated: 2.204516887664795  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9443962574005127
pure train time :  1.4553637504577637
train time :  1.7149255275726318
end to end time :  1.8496830463409424
connection check time:  0.016120195388793945
block generation time  0.03297066688537598
end to end time  1.9376676082611084
Total (block generation + training)time/epoch 1.9376676082611084
pure train time per /epoch  [1.8115577697753906, 1.4222559928894043, 1.440265417098999, 1.453503131866455, 1.4398763179779053, 1.4540929794311523, 1.4556200504302979, 1.4551365375518799, 1.454293966293335, 1.4553637504577637]
pure train time average  1.4525552477155412
input num list  [5266, 5365, 5389, 5388, 5365, 5375, 5426, 5442, 5400, 5326]
