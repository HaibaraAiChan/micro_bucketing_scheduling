main start at this time 1690865312.738455
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
REG start----................................
Convert a graph into a bidirected graph: 3.111 seconds, peak memory: 34.221 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.221 GB
Metis partitioning: 14.780 seconds, peak memory: 35.510 GB
Split the graph: 1.850 seconds
Construct subgraphs: 0.025 seconds
REG metis partition end ----................................
REG construction  time spent:  10.578581809997559
pure dgl.metis_partition the time spent:  19.811482429504395
connection checking time:  22.011621475219727
block generation total time  21.647624731063843
pure train time  3.4685251712799072
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.984375 GB
    Memory Allocated: 0.28899288177490234  GigaBytes
Max Memory Allocated: 12.79421329498291  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.20932674407959
REG start----................................
Convert a graph into a bidirected graph: 2.461 seconds, peak memory: 77.842 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.842 GB
Metis partitioning: 14.200 seconds, peak memory: 79.082 GB
Split the graph: 1.603 seconds
Construct subgraphs: 0.479 seconds
REG metis partition end ----................................
REG construction  time spent:  12.84074854850769
pure dgl.metis_partition the time spent:  18.768938302993774
connection checking time:  21.872092962265015
block generation total time  21.236551523208618
pure train time  2.9273183345794678
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.0234375 GB
    Memory Allocated: 0.34572410583496094  GigaBytes
Max Memory Allocated: 12.79421329498291  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.894692420959473
REG start----................................
Convert a graph into a bidirected graph: 2.910 seconds, peak memory: 80.109 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 80.109 GB
Metis partitioning: 14.832 seconds, peak memory: 80.109 GB
Split the graph: 1.856 seconds
Construct subgraphs: 0.556 seconds
REG metis partition end ----................................
REG construction  time spent:  13.555521249771118
pure dgl.metis_partition the time spent:  20.181472063064575
connection checking time:  23.276820421218872
block generation total time  21.117772579193115
pure train time  2.7360734939575195
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.51171875 GB
    Memory Allocated: 0.2793722152709961  GigaBytes
Max Memory Allocated: 12.839390754699707  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.596303939819336
loading full batch data spends  0.8965640068054199
REG start----................................
Convert a graph into a bidirected graph: 3.112 seconds, peak memory: 82.140 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 82.140 GB
Metis partitioning: 14.597 seconds, peak memory: 83.421 GB
Split the graph: 1.435 seconds
Construct subgraphs: 0.506 seconds
REG metis partition end ----................................
REG construction  time spent:  13.172621726989746
pure dgl.metis_partition the time spent:  19.67544150352478
connection checking time:  21.695399522781372
block generation total time  20.26187252998352
generate_dataloader_block spend   78.78927803039551
pure train time  2.9366819858551025
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.787109375 GB
    Memory Allocated: 0.32083702087402344  GigaBytes
Max Memory Allocated: 13.022843837738037  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.309733867645264
loading full batch data spends  0.873877763748169
REG start----................................
Convert a graph into a bidirected graph: 3.124 seconds, peak memory: 84.109 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.109 GB
Metis partitioning: 15.041 seconds, peak memory: 84.109 GB
Split the graph: 1.362 seconds
Construct subgraphs: 0.700 seconds
REG metis partition end ----................................
REG construction  time spent:  13.443475008010864
pure dgl.metis_partition the time spent:  20.25557565689087
connection checking time:  22.41542673110962
block generation total time  21.369580268859863
generate_dataloader_block spend   81.85217666625977
pure train time  2.7215542793273926
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.708984375 GB
    Memory Allocated: 0.3148770332336426  GigaBytes
Max Memory Allocated: 13.160833835601807  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.04085111618042
loading full batch data spends  0.888120174407959
REG start----................................
Convert a graph into a bidirected graph: 3.105 seconds, peak memory: 84.109 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.109 GB
Metis partitioning: 15.042 seconds, peak memory: 84.109 GB
Split the graph: 1.443 seconds
Construct subgraphs: 0.694 seconds
REG metis partition end ----................................
REG construction  time spent:  13.545379877090454
pure dgl.metis_partition the time spent:  20.310106992721558
connection checking time:  21.775681495666504
block generation total time  21.218106508255005
generate_dataloader_block spend   81.0584487915039
pure train time  2.7228777408599854
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.708984375 GB
    Memory Allocated: 0.3334360122680664  GigaBytes
Max Memory Allocated: 13.160833835601807  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.8003990650177
loading full batch data spends  0.7584640979766846
REG start----................................
Convert a graph into a bidirected graph: 3.129 seconds, peak memory: 84.109 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.109 GB
Metis partitioning: 15.355 seconds, peak memory: 84.109 GB
Split the graph: 1.514 seconds
Construct subgraphs: 0.504 seconds
REG metis partition end ----................................
REG construction  time spent:  13.187095165252686
pure dgl.metis_partition the time spent:  20.52949619293213
connection checking time:  22.49781894683838
block generation total time  21.042999982833862
generate_dataloader_block spend   81.44727635383606
pure train time  2.7347702980041504
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.921875 GB
    Memory Allocated: 0.29808664321899414  GigaBytes
Max Memory Allocated: 13.160833835601807  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.618529796600342
loading full batch data spends  0.8901145458221436
REG start----................................
Convert a graph into a bidirected graph: 3.065 seconds, peak memory: 84.109 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.109 GB
Metis partitioning: 15.209 seconds, peak memory: 84.109 GB
Split the graph: 1.325 seconds
Construct subgraphs: 0.566 seconds
REG metis partition end ----................................
REG construction  time spent:  13.15417742729187
pure dgl.metis_partition the time spent:  20.193423748016357
connection checking time:  21.96868658065796
block generation total time  20.587977409362793
generate_dataloader_block spend   80.15159964561462
pure train time  2.716639518737793
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.921875 GB
    Memory Allocated: 0.2892918586730957  GigaBytes
Max Memory Allocated: 13.160833835601807  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.492600440979004
loading full batch data spends  0.7359011173248291
REG start----................................
Convert a graph into a bidirected graph: 3.128 seconds, peak memory: 84.109 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.109 GB
Metis partitioning: 15.297 seconds, peak memory: 84.109 GB
Split the graph: 1.416 seconds
Construct subgraphs: 0.672 seconds
REG metis partition end ----................................
REG construction  time spent:  13.737956762313843
pure dgl.metis_partition the time spent:  20.54121708869934
connection checking time:  22.124136924743652
block generation total time  21.04782199859619
generate_dataloader_block spend   81.65083837509155
pure train time  2.5758628845214844
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.921875 GB
    Memory Allocated: 0.31963634490966797  GigaBytes
Max Memory Allocated: 13.160833835601807  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.384256362915039
loading full batch data spends  0.8627030849456787
REG start----................................
Convert a graph into a bidirected graph: 3.082 seconds, peak memory: 84.109 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.109 GB
Metis partitioning: 16.000 seconds, peak memory: 84.109 GB
Split the graph: 1.368 seconds
Construct subgraphs: 0.710 seconds
REG metis partition end ----................................
REG construction  time spent:  13.513493061065674
pure dgl.metis_partition the time spent:  21.189428567886353
connection checking time:  21.419344902038574
block generation total time  20.510775566101074
generate_dataloader_block spend   80.80718278884888
pure train time  2.7187345027923584
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.921875 GB
    Memory Allocated: 0.28248071670532227  GigaBytes
Max Memory Allocated: 13.160833835601807  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.243530750274658
Total (block generation + training)time/epoch 85.72587353842599
pure train time/epoch 2.698406537373861

num_input_list  [4529371, 4523700, 4575082, 4460949, 4494098, 4457895, 4634184, 4489221, 4527558, 4470317]
