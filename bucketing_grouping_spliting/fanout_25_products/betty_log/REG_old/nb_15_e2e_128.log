main start at this time 1690867999.3389187
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
REG start----................................
Convert a graph into a bidirected graph: 3.095 seconds, peak memory: 34.221 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.221 GB
Metis partitioning: 14.855 seconds, peak memory: 35.511 GB
Split the graph: 1.460 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  14.188162565231323
pure dgl.metis_partition the time spent:  19.456310987472534
connection checking time:  17.26925778388977
block generation total time  20.149438858032227
pure train time  3.7152998447418213
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.634765625 GB
    Memory Allocated: 0.29366636276245117  GigaBytes
Max Memory Allocated: 10.647820472717285  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.205620765686035
REG start----................................
Convert a graph into a bidirected graph: 3.133 seconds, peak memory: 82.173 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 82.173 GB
Metis partitioning: 15.448 seconds, peak memory: 83.413 GB
Split the graph: 1.180 seconds
Construct subgraphs: 0.711 seconds
REG metis partition end ----................................
REG construction  time spent:  13.131771326065063
pure dgl.metis_partition the time spent:  20.501586437225342
connection checking time:  22.618813037872314
block generation total time  21.5273015499115
pure train time  3.2592101097106934
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.2916412353515625  GigaBytes
Max Memory Allocated: 10.712378025054932  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.891604900360107
REG start----................................
Convert a graph into a bidirected graph: 3.089 seconds, peak memory: 84.529 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.529 GB
Metis partitioning: 15.613 seconds, peak memory: 84.678 GB
Split the graph: 1.323 seconds
Construct subgraphs: 0.712 seconds
REG metis partition end ----................................
REG construction  time spent:  13.638383388519287
pure dgl.metis_partition the time spent:  20.762810468673706
connection checking time:  22.82925820350647
block generation total time  20.899928092956543
pure train time  3.2560253143310547
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.6484375 GB
    Memory Allocated: 0.2473139762878418  GigaBytes
Max Memory Allocated: 10.712378025054932  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.594292640686035
loading full batch data spends  0.8755662441253662
REG start----................................
Convert a graph into a bidirected graph: 3.034 seconds, peak memory: 85.628 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 85.628 GB
Metis partitioning: 15.193 seconds, peak memory: 85.628 GB
Split the graph: 1.113 seconds
Construct subgraphs: 0.749 seconds
REG metis partition end ----................................
REG construction  time spent:  13.115325927734375
pure dgl.metis_partition the time spent:  20.1164653301239
connection checking time:  23.262333631515503
block generation total time  22.07712411880493
generate_dataloader_block spend   82.7804627418518
pure train time  3.6204447746276855
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 13.98046875 GB
    Memory Allocated: 0.3025388717651367  GigaBytes
Max Memory Allocated: 10.74130392074585  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.304936408996582
loading full batch data spends  0.8691556453704834
REG start----................................
Convert a graph into a bidirected graph: 3.075 seconds, peak memory: 86.390 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 86.390 GB
Metis partitioning: 15.676 seconds, peak memory: 86.390 GB
Split the graph: 1.342 seconds
Construct subgraphs: 0.678 seconds
REG metis partition end ----................................
REG construction  time spent:  13.193487882614136
pure dgl.metis_partition the time spent:  20.799896955490112
connection checking time:  22.85136914253235
block generation total time  21.150947093963623
generate_dataloader_block spend   82.17984175682068
pure train time  3.171090602874756
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.1328125 GB
    Memory Allocated: 0.26430320739746094  GigaBytes
Max Memory Allocated: 10.74130392074585  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.041658878326416
loading full batch data spends  0.7328951358795166
REG start----................................
Convert a graph into a bidirected graph: 3.060 seconds, peak memory: 86.390 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 86.390 GB
Metis partitioning: 15.745 seconds, peak memory: 86.390 GB
Split the graph: 1.198 seconds
Construct subgraphs: 0.703 seconds
REG metis partition end ----................................
REG construction  time spent:  13.08840298652649
pure dgl.metis_partition the time spent:  20.734039783477783
connection checking time:  23.04214859008789
block generation total time  21.331021308898926
generate_dataloader_block spend   82.41138362884521
pure train time  3.2047622203826904
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.1328125 GB
    Memory Allocated: 0.3002901077270508  GigaBytes
Max Memory Allocated: 10.74130392074585  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.802793502807617
loading full batch data spends  0.8997495174407959
REG start----................................
Convert a graph into a bidirected graph: 3.149 seconds, peak memory: 86.390 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 86.390 GB
Metis partitioning: 15.877 seconds, peak memory: 86.390 GB
Split the graph: 1.176 seconds
Construct subgraphs: 0.672 seconds
REG metis partition end ----................................
REG construction  time spent:  13.134228706359863
pure dgl.metis_partition the time spent:  20.902730464935303
connection checking time:  22.540600061416626
block generation total time  21.258925437927246
generate_dataloader_block spend   81.97598528862
pure train time  3.1591618061065674
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.13671875 GB
    Memory Allocated: 0.28965234756469727  GigaBytes
Max Memory Allocated: 10.74130392074585  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.6247341632843018
loading full batch data spends  0.7089767456054688
REG start----................................
Convert a graph into a bidirected graph: 2.541 seconds, peak memory: 86.390 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 86.390 GB
Metis partitioning: 15.835 seconds, peak memory: 86.390 GB
Split the graph: 1.141 seconds
Construct subgraphs: 0.561 seconds
REG metis partition end ----................................
REG construction  time spent:  13.213268756866455
pure dgl.metis_partition the time spent:  20.10760760307312
connection checking time:  22.52299737930298
block generation total time  20.630322456359863
generate_dataloader_block spend   80.62497472763062
pure train time  3.1900739669799805
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.13671875 GB
    Memory Allocated: 0.2588047981262207  GigaBytes
Max Memory Allocated: 10.74130392074585  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4898176193237305
loading full batch data spends  0.821282148361206
REG start----................................
Convert a graph into a bidirected graph: 3.109 seconds, peak memory: 86.390 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 86.390 GB
Metis partitioning: 16.880 seconds, peak memory: 86.390 GB
Split the graph: 1.199 seconds
Construct subgraphs: 0.505 seconds
REG metis partition end ----................................
REG construction  time spent:  12.989515781402588
pure dgl.metis_partition the time spent:  21.722349405288696
connection checking time:  22.869943618774414
block generation total time  21.203264236450195
generate_dataloader_block spend   83.11698508262634
pure train time  3.163667917251587
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.13671875 GB
    Memory Allocated: 0.2582879066467285  GigaBytes
Max Memory Allocated: 10.74130392074585  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3710246086120605
loading full batch data spends  0.7671859264373779
REG start----................................
Convert a graph into a bidirected graph: 3.064 seconds, peak memory: 86.390 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 86.390 GB
Metis partitioning: 16.710 seconds, peak memory: 86.390 GB
Split the graph: 1.677 seconds
Construct subgraphs: 0.572 seconds
REG metis partition end ----................................
REG construction  time spent:  12.96677303314209
pure dgl.metis_partition the time spent:  22.050762176513672
connection checking time:  22.824522018432617
block generation total time  21.2533917427063
generate_dataloader_block spend   83.3207471370697
pure train time  3.1609771251678467
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.13671875 GB
    Memory Allocated: 0.29506349563598633  GigaBytes
Max Memory Allocated: 10.74130392074585  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2369308471679688
Total (block generation + training)time/epoch 87.71428571428571
pure train time/epoch 3.1749556064605713

num_input_list  [4989310, 4892747, 4878924, 5010924, 4876103, 4904743, 4894013, 4872264, 4912860, 4779007]
