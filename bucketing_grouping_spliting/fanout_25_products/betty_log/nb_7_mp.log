main start at this time 1689919411.9634364
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

in feats:  100
loading full batch data spends  0.8022301197052002
REG start----................................
Convert a graph into a bidirected graph: 3.010 seconds, peak memory: 34.201 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.201 GB
Metis partitioning: 13.928 seconds, peak memory: 35.318 GB
Split the graph: 2.473 seconds
Construct subgraphs: 0.014 seconds
REG metis partition end ----................................
REG construction  time spent:  13.320101976394653
pure dgl.metis_partition the time spent:  19.452502250671387
check_connections_block*********************************

the find indices time spent  0.4867408275604248

in edges time spent  0.8668038845062256
local to global src and eids time spent  1.8657257556915283
time gen tails  0.27887558937072754
res  length 7
check_connections_block*********************************

the find indices time spent  0.8459012508392334

in edges time spent  2.9505317211151123
local to global src and eids time spent  5.621448040008545
time gen tails  0.8262186050415039
res  length 7
connection checking time:  15.810705423355103
block generation total time  10.83682370185852
generate_dataloader_block spend   63.50988245010376
pure train time  3.2245240211486816
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.708984375 GB
    Memory Allocated: 0.3567638397216797  GigaBytes
Max Memory Allocated: 21.02843713760376  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.207644462585449
loading full batch data spends  0.8308238983154297
REG start----................................
Convert a graph into a bidirected graph: 3.270 seconds, peak memory: 72.262 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.262 GB
Metis partitioning: 14.106 seconds, peak memory: 73.424 GB
Split the graph: 1.996 seconds
Construct subgraphs: 0.709 seconds
REG metis partition end ----................................
REG construction  time spent:  12.218828678131104
pure dgl.metis_partition the time spent:  20.108100175857544
check_connections_block*********************************

the find indices time spent  0.48229527473449707

in edges time spent  0.9338452816009521
local to global src and eids time spent  1.8163120746612549
time gen tails  0.2515873908996582
res  length 7
check_connections_block*********************************

the find indices time spent  0.9009988307952881

in edges time spent  2.9534754753112793
local to global src and eids time spent  6.141225337982178
time gen tails  0.9008524417877197
res  length 7
connection checking time:  16.409185886383057
block generation total time  11.012564897537231
generate_dataloader_block spend   63.8541316986084
pure train time  2.5155229568481445
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.21484375 GB
    Memory Allocated: 0.3940854072570801  GigaBytes
Max Memory Allocated: 21.23854684829712  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.466026544570923
loading full batch data spends  0.7234885692596436
REG start----................................
Convert a graph into a bidirected graph: 2.634 seconds, peak memory: 82.367 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 82.367 GB
Metis partitioning: 14.525 seconds, peak memory: 83.534 GB
Split the graph: 2.010 seconds
Construct subgraphs: 0.035 seconds
REG metis partition end ----................................
REG construction  time spent:  13.421327829360962
pure dgl.metis_partition the time spent:  19.238680124282837
check_connections_block*********************************

the find indices time spent  0.5217318534851074

in edges time spent  0.8970942497253418
local to global src and eids time spent  1.7870707511901855
time gen tails  0.25742220878601074
res  length 7
check_connections_block*********************************

the find indices time spent  0.9244122505187988

in edges time spent  2.954934597015381
local to global src and eids time spent  5.454984664916992
time gen tails  0.861328125
res  length 7
connection checking time:  15.520660161972046
block generation total time  10.034902572631836
generate_dataloader_block spend   62.53127646446228
pure train time  2.1075034141540527
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.4609375 GB
    Memory Allocated: 0.3696775436401367  GigaBytes
Max Memory Allocated: 21.23854684829712  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.736978054046631
loading full batch data spends  0.837059497833252
REG start----................................
Convert a graph into a bidirected graph: 2.687 seconds, peak memory: 84.853 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.853 GB
Metis partitioning: 14.581 seconds, peak memory: 84.853 GB
Split the graph: 1.947 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  12.94598937034607
pure dgl.metis_partition the time spent:  19.261462450027466
check_connections_block*********************************

the find indices time spent  0.5241215229034424

in edges time spent  0.8817992210388184
local to global src and eids time spent  1.7848703861236572
time gen tails  0.2565579414367676
res  length 7
check_connections_block*********************************

the find indices time spent  0.8873214721679688

in edges time spent  3.040187120437622
local to global src and eids time spent  5.687261581420898
time gen tails  0.8657033443450928
res  length 7
connection checking time:  15.904227256774902
block generation total time  10.353798151016235
generate_dataloader_block spend   62.62424921989441
pure train time  2.119523048400879
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.484375 GB
    Memory Allocated: 0.4022364616394043  GigaBytes
Max Memory Allocated: 21.23854684829712  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.232482433319092
loading full batch data spends  0.8272051811218262
REG start----................................
Convert a graph into a bidirected graph: 3.102 seconds, peak memory: 84.853 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.853 GB
Metis partitioning: 14.686 seconds, peak memory: 84.853 GB
Split the graph: 2.458 seconds
Construct subgraphs: 0.035 seconds
REG metis partition end ----................................
REG construction  time spent:  12.918158769607544
pure dgl.metis_partition the time spent:  20.307857036590576
check_connections_block*********************************

the find indices time spent  0.5173907279968262

in edges time spent  0.911909818649292
local to global src and eids time spent  1.8305153846740723
time gen tails  0.2798032760620117
res  length 7
check_connections_block*********************************

the find indices time spent  0.8554215431213379

in edges time spent  1.7929511070251465
local to global src and eids time spent  3.1689398288726807
time gen tails  0.6147873401641846
res  length 7
connection checking time:  11.385623693466187
block generation total time  9.09153699874878
generate_dataloader_block spend   58.13758158683777
pure train time  1.9214286804199219
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.52734375 GB
    Memory Allocated: 0.37619733810424805  GigaBytes
Max Memory Allocated: 21.23854684829712  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7823216915130615
loading full batch data spends  0.8250501155853271
REG start----................................
Convert a graph into a bidirected graph: 3.274 seconds, peak memory: 84.884 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 84.884 GB
Metis partitioning: 14.907 seconds, peak memory: 84.884 GB
Split the graph: 2.173 seconds
Construct subgraphs: 0.024 seconds
REG metis partition end ----................................
REG construction  time spent:  10.387952327728271
pure dgl.metis_partition the time spent:  20.404122352600098
check_connections_block*********************************

the find indices time spent  0.5215342044830322

in edges time spent  0.9064085483551025
local to global src and eids time spent  1.6469902992248535
time gen tails  0.21876239776611328
res  length 7
check_connections_block*********************************

the find indices time spent  0.7176201343536377

in edges time spent  2.0230162143707275
local to global src and eids time spent  2.8640658855438232
time gen tails  0.5503180027008057
res  length 7
connection checking time:  10.670785903930664
block generation total time  10.465586185455322
generate_dataloader_block spend   55.92650294303894
pure train time  2.0616180896759033
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.548828125 GB
    Memory Allocated: 0.40135765075683594  GigaBytes
Max Memory Allocated: 21.23854684829712  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5533939599990845
loading full batch data spends  0.87186598777771
REG start----................................
Convert a graph into a bidirected graph: 3.055 seconds, peak memory: 85.012 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 85.012 GB
Metis partitioning: 14.867 seconds, peak memory: 85.012 GB
Split the graph: 2.249 seconds
Construct subgraphs: 0.026 seconds
REG metis partition end ----................................
REG construction  time spent:  13.033204555511475
pure dgl.metis_partition the time spent:  20.223448038101196
check_connections_block*********************************

the find indices time spent  0.5019481182098389

in edges time spent  0.9117963314056396
local to global src and eids time spent  1.8068006038665771
time gen tails  0.2661571502685547
res  length 7
check_connections_block*********************************

the find indices time spent  0.8993608951568604

in edges time spent  3.0975189208984375
local to global src and eids time spent  5.691665172576904
time gen tails  0.887089729309082
res  length 7
connection checking time:  16.288662910461426
block generation total time  10.979108810424805
generate_dataloader_block spend   65.02676582336426
pure train time  2.0771102905273438
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.548828125 GB
    Memory Allocated: 0.388089656829834  GigaBytes
Max Memory Allocated: 21.23854684829712  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3951934576034546
loading full batch data spends  0.8252389430999756
REG start----................................
Convert a graph into a bidirected graph: 3.062 seconds, peak memory: 85.106 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 85.106 GB
Metis partitioning: 15.306 seconds, peak memory: 85.106 GB
Split the graph: 1.881 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  13.196773052215576
pure dgl.metis_partition the time spent:  20.30081820487976
check_connections_block*********************************

the find indices time spent  0.5086605548858643

in edges time spent  0.8632359504699707
local to global src and eids time spent  1.8404483795166016
time gen tails  0.27190327644348145
res  length 7
check_connections_block*********************************

the find indices time spent  0.9301028251647949

in edges time spent  3.1223583221435547
local to global src and eids time spent  5.702338457107544
time gen tails  0.9009661674499512
res  length 7
connection checking time:  16.141332149505615
block generation total time  10.902035474777222
generate_dataloader_block spend   64.9134168624878
pure train time  2.09279727935791
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.548828125 GB
    Memory Allocated: 0.3637876510620117  GigaBytes
Max Memory Allocated: 21.23854684829712  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2789136171340942
loading full batch data spends  0.8505964279174805
REG start----................................
Convert a graph into a bidirected graph: 3.108 seconds, peak memory: 85.106 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 85.106 GB
Metis partitioning: 15.259 seconds, peak memory: 85.106 GB
Split the graph: 1.932 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  13.074652671813965
pure dgl.metis_partition the time spent:  20.340492725372314
check_connections_block*********************************

the find indices time spent  0.5191476345062256

in edges time spent  0.8820412158966064
local to global src and eids time spent  1.7997963428497314
time gen tails  0.27069687843322754
res  length 7
check_connections_block*********************************

the find indices time spent  0.905148983001709

in edges time spent  3.096250057220459
local to global src and eids time spent  5.583047151565552
time gen tails  0.8716616630554199
res  length 7
connection checking time:  15.873660564422607
block generation total time  10.75123906135559
generate_dataloader_block spend   64.29074263572693
pure train time  2.073044538497925
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.548828125 GB
    Memory Allocated: 0.37896299362182617  GigaBytes
Max Memory Allocated: 21.23854684829712  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1791037321090698
loading full batch data spends  0.8811030387878418
REG start----................................
Convert a graph into a bidirected graph: 3.035 seconds, peak memory: 85.106 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 85.106 GB
Metis partitioning: 14.739 seconds, peak memory: 85.106 GB
Split the graph: 2.396 seconds
Construct subgraphs: 0.024 seconds
REG metis partition end ----................................
REG construction  time spent:  12.91903018951416
pure dgl.metis_partition the time spent:  20.223363637924194
check_connections_block*********************************

the find indices time spent  0.5118489265441895

in edges time spent  0.8815760612487793
local to global src and eids time spent  1.798654317855835
time gen tails  0.27559924125671387
res  length 7
check_connections_block*********************************

the find indices time spent  0.9280960559844971

in edges time spent  3.1894869804382324
local to global src and eids time spent  5.688303232192993
time gen tails  0.905015230178833
res  length 7
connection checking time:  16.272098779678345
block generation total time  11.702672004699707
generate_dataloader_block spend   65.57372856140137
pure train time  2.0777747631073
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.548828125 GB
    Memory Allocated: 0.36983585357666016  GigaBytes
Max Memory Allocated: 21.23854684829712  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0804111957550049
Total (block generation + training)time/epoch 67.067853307724
pure train time/epoch 2.050628940264384

num_input_list  [3746903, 3801791, 3666187, 3803067, 3772280, 3697754, 3669220, 3820593, 3700177, 3782087]
