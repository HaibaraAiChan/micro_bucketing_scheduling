main start at this time 1688764907.349229
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

self.global_to_local() spend sec:  0.3206515312194824
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275830
remove values openmp spend  0.08989191055297852
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  981753
remove values openmp spend  0.488262414932251
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.705106735229492
6.521662016060751
the split redundant ratio 
[6.521662016060751]
1
average memory estimation for each split fanout bucket batch 16.76610609962285
capacity est:  1.3338939003771522
split fanout degree bucket spend /sec:  3.7056496143341064
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10866713523864746
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.568085733745697
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.5671858693979
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.11946365124628
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.565069794234002
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.560033322381578
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.558557236818416
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.55546507541941
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.553956837540497
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.495647167332706
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.34994067402322
the length of split_batches_nid_list  12
batches output list generation spend  0.0016772747039794922
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026970863342285156
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.8160576820373535
len local_batched_seeds_list  12
partition total batch output list spend :  7.2868287563323975
self.buckets_partition() spend  sec:  3.8430819511413574
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.85546875 GB
    Memory Allocated: 20.87930727005005  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.83203125 GB
    Memory Allocated: 20.86750030517578  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.83203125 GB
    Memory Allocated: 20.459396362304688  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.953125 GB
    Memory Allocated: 20.961812496185303  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.87109375 GB
    Memory Allocated: 20.89730930328369  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.8828125 GB
    Memory Allocated: 20.870521068572998  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.96028709411621  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.925491333007812  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.873311519622803  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.763845920562744  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.212109565734863  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.213406562805176  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 0.5699458122253418  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.857676982879639
pure train time :  3.2429161071777344
train time :  6.74619460105896
end to end time :  94.46122980117798
connection check time:  33.739840030670166
block generation time  46.54988503456116
self.global_to_local() spend sec:  0.3237323760986328
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275698
remove values openmp spend  0.09232187271118164
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  981409
remove values openmp spend  0.5345735549926758
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.732527017593384
6.516802841375331
the split redundant ratio 
[6.516802841375331]
1
average memory estimation for each split fanout bucket batch 16.75361397136908
capacity est:  1.3463860286309206
split fanout degree bucket spend /sec:  3.7329232692718506
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.11052465438842773
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.55559360549193
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.55469374114413
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.106971522992513
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.552577665980234
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.54754119412781
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.546065108564648
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.54297294716564
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.54146470928673
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.483155039078937
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.33744854576945
the length of split_batches_nid_list  12
batches output list generation spend  0.0010993480682373047
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029461383819580078
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.8446125984191895
len local_batched_seeds_list  12
partition total batch output list spend :  7.269032955169678
self.buckets_partition() spend  sec:  3.8741188049316406
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.03125 GB
    Memory Allocated: 20.88991355895996  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.04296875 GB
    Memory Allocated: 20.889187335968018  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.04296875 GB
    Memory Allocated: 20.487768173217773  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.817050457000732  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.791764736175537  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.934958457946777  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.959117889404297  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.912869453430176  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.880499362945557  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.78062629699707  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.31846570968628  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.271262645721436  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 0.5745038986206055  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2391610145568848
pure train time :  2.368746519088745
train time :  5.461127281188965
end to end time :  93.49072885513306
connection check time:  34.08561706542969
block generation time  46.53623056411743
self.global_to_local() spend sec:  0.3336763381958008
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  276283
remove values openmp spend  0.09508967399597168
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  982303
remove values openmp spend  0.4161810874938965
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.596479892730713
6.525234751314382
the split redundant ratio 
[6.525234751314382]
1
average memory estimation for each split fanout bucket batch 16.77529100650406
capacity est:  1.3247089934959426
split fanout degree bucket spend /sec:  3.6006534099578857
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.11816239356994629
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.577270640626907
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.57637077627911
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.12864855812749
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.574254701115212
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.569218229262788
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.567742143699626
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.56464998230062
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.563141744421706
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.504832074213915
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.35912558090443
the length of split_batches_nid_list  12
batches output list generation spend  0.0010917186737060547
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026410818099975586
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.7199692726135254
len local_batched_seeds_list  12
partition total batch output list spend :  7.257811784744263
self.buckets_partition() spend  sec:  3.746426820755005
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.830885887145996  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.88627576828003  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.47308921813965  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.885474681854248  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.886273860931396  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.93744945526123  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.923717498779297  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.969818592071533  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.833988666534424  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.794161796569824  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.157340049743652  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.219388484954834  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 0.5777478218078613  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.547273635864258
pure train time :  2.3397958278656006
train time :  5.4085633754730225
end to end time :  92.27370738983154
connection check time:  33.42403054237366
block generation time  46.064229249954224
self.global_to_local() spend sec:  0.36344456672668457
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275868
remove values openmp spend  0.09866881370544434
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  982382
remove values openmp spend  0.47100210189819336
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.6718220710754395
6.525935287638624
the split redundant ratio 
[6.525935287638624]
1
average memory estimation for each split fanout bucket batch 16.77709196863763
capacity est:  1.3229080313623705
split fanout degree bucket spend /sec:  3.6722347736358643
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10914063453674316
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.57907160276048
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.57817173841268
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.130449520261063
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.576055663248784
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.57101919139636
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.569543105833198
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.56645094443419
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.56494270655528
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.506633036347488
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.360926543038
the length of split_batches_nid_list  12
batches output list generation spend  0.0010001659393310547
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028689146041870117
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.7824437618255615
len local_batched_seeds_list  12
partition total batch output list spend :  6.4516050815582275
self.buckets_partition() spend  sec:  3.8111753463745117
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.869750022888184  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.906763553619385  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.447404861450195  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.853790283203125  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.82582187652588  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.936280727386475  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.957692623138428  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.91869068145752  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.913366317749023  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.81868314743042  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.296515464782715  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.21473789215088  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 0.576045036315918  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.090529680252075
pure train time :  2.2864997386932373
train time :  5.312315225601196
end to end time :  88.75495982170105
connection check time:  33.789737701416016
block generation time  43.095985412597656
self.global_to_local() spend sec:  0.3433411121368408
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275998
remove values openmp spend  0.09502911567687988
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  982116
remove values openmp spend  0.49379539489746094
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.683863401412964
6.522521765185957
the split redundant ratio 
[6.522521765185957]
1
average memory estimation for each split fanout bucket batch 16.76831637133223
capacity est:  1.331683628667772
split fanout degree bucket spend /sec:  3.68434476852417
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10878849029541016
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.570296005455077
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.56939614110728
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.12167392295566
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.567280065943383
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.56224359409096
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.560767508527796
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.55767534712879
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.556167109249877
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.497857439042086
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.3521509457326
the length of split_batches_nid_list  12
batches output list generation spend  0.0010280609130859375
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025722026824951172
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.7942285537719727
len local_batched_seeds_list  12
partition total batch output list spend :  7.269564390182495
self.buckets_partition() spend  sec:  3.820142984390259
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.87788200378418  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.84088706970215  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.48173236846924  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.984375 GB
    Memory Allocated: 20.998186111450195  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.955078125 GB
    Memory Allocated: 20.8947696685791  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.871445655822754  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.863461017608643  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.950387001037598  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.83047914505005  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.777570724487305  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.288795471191406  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.270976543426514  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.578216552734375  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.658360242843628
pure train time :  2.6709959506988525
train time :  5.682698488235474
end to end time :  90.35289859771729
connection check time:  33.64182806015015
block generation time  43.63292145729065
self.global_to_local() spend sec:  0.3691129684448242
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  276231
remove values openmp spend  0.09581875801086426
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  982194
remove values openmp spend  0.4957869052886963
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.6149890422821045
6.52361078074455
the split redundant ratio 
[6.52361078074455]
1
average memory estimation for each split fanout bucket batch 16.77111604883078
capacity est:  1.328883951169221
split fanout degree bucket spend /sec:  3.6154401302337646
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10892009735107422
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.57309568295363
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.57219581860583
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.124473600454213
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.570079743441934
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.56504327158951
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.563567186026347
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.56047502462734
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.558966786748428
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.500657116540637
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.35495062323115
the length of split_batches_nid_list  12
batches output list generation spend  0.0011088848114013672
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02512049674987793
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.7255373001098633
len local_batched_seeds_list  12
partition total batch output list spend :  7.259255886077881
self.buckets_partition() spend  sec:  3.7507035732269287
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.86618423461914  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.978515625 GB
    Memory Allocated: 20.81562328338623  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.978515625 GB
    Memory Allocated: 20.485912799835205  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.8858962059021  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.897313594818115  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.87066888809204  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.961467266082764  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.876830577850342  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.832877159118652  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.778599739074707  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.27328109741211  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.274209022521973  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 0.5738925933837891  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4476399421691895
pure train time :  2.3307082653045654
train time :  5.435700178146362
end to end time :  90.71743893623352
connection check time:  33.471529722213745
block generation time  44.39599394798279
self.global_to_local() spend sec:  0.333052396774292
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  276236
remove values openmp spend  0.09527325630187988
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  983861
remove values openmp spend  0.4877302646636963
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.6191298961639404
6.534481830794368
the split redundant ratio 
[6.534481830794368]
1
average memory estimation for each split fanout bucket batch 16.799063706667187
capacity est:  1.3009362933328141
split fanout degree bucket spend /sec:  3.625326156616211
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.1093130111694336
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.601043340790035
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.600143476442238
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.15242125829062
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.59802740127834
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.592990929425916
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.591514843862754
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.588422682463747
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.586914444584835
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.528604774377044
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.382898281067558
the length of split_batches_nid_list  12
batches output list generation spend  0.0010192394256591797
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.045047760009765625
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.7357232570648193
len local_batched_seeds_list  12
partition total batch output list spend :  7.241892576217651
self.buckets_partition() spend  sec:  3.780816078186035
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.889294147491455  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.88482666015625  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.402989864349365  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.0 GB
    Memory Allocated: 20.850690364837646  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.0 GB
    Memory Allocated: 20.849075317382812  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.0 GB
    Memory Allocated: 20.865787982940674  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 21.017892837524414  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.967775344848633  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.967628955841064  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.73578643798828  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.26336431503296  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.24595308303833  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 0.5739350318908691  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.302002191543579
pure train time :  2.5939810276031494
train time :  5.661211729049683
end to end time :  90.88142228126526
connection check time:  33.387948513031006
block generation time  44.47032952308655
self.global_to_local() spend sec:  0.35201287269592285
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275729
remove values openmp spend  0.0943143367767334
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  982731
remove values openmp spend  0.4805939197540283
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.6028902530670166
6.525941656150661
the split redundant ratio 
[6.525941656150661]
1
average memory estimation for each split fanout bucket batch 16.77710834102066
capacity est:  1.3228916589793407
split fanout degree bucket spend /sec:  3.603360652923584
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10945463180541992
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.57908797514351
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.57818811079571
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.130465892644093
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.576072035631814
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.57103556377939
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.569559478216227
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.56646731681722
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.56495907893831
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.506649408730517
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.36094291542103
the length of split_batches_nid_list  12
batches output list generation spend  0.0010139942169189453
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024913549423217773
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.7139010429382324
len local_batched_seeds_list  12
partition total batch output list spend :  7.22051739692688
self.buckets_partition() spend  sec:  3.7388734817504883
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.792885780334473  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.01953125 GB
    Memory Allocated: 20.85314702987671  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.01953125 GB
    Memory Allocated: 20.513665199279785  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.845357418060303  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.931341648101807  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.977127075195312  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.8929762840271  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.964092254638672  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.950093269348145  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.727797985076904  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.27521324157715  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.30099058151245  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 0.579261302947998  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.194218635559082
pure train time :  2.338226079940796
train time :  5.437558174133301
end to end time :  89.81657004356384
connection check time:  33.17205834388733
block generation time  43.841984272003174
self.global_to_local() spend sec:  0.34823083877563477
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275904
remove values openmp spend  0.0944063663482666
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  982978
remove values openmp spend  0.49059534072875977
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.6873116493225098
6.525890708054353
the split redundant ratio 
[6.525890708054353]
1
average memory estimation for each split fanout bucket batch 16.7769773619564
capacity est:  1.3230226380436
split fanout degree bucket spend /sec:  3.6879003047943115
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.21129560470581055
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.57895699607925
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.578057131731452
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.130334913579834
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.575941056567554
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.57090458471513
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.569428499151968
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.56633633775296
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.56482809987405
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.506518429666258
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.36081193635677
the length of split_batches_nid_list  12
batches output list generation spend  0.0011365413665771484
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025777339935302734
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.900446653366089
len local_batched_seeds_list  12
partition total batch output list spend :  7.414052963256836
self.buckets_partition() spend  sec:  3.926299571990967
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.865506172180176  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.85741376876831  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.467748641967773  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.876157760620117  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.839056491851807  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.978811264038086  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.972137928009033  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.966694831848145  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.871886730194092  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.72205352783203  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.233319759368896  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.24035406112671  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 0.5771632194519043  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0964686870574951
pure train time :  2.320462226867676
train time :  5.407703876495361
end to end time :  90.36885952949524
connection check time:  33.3489191532135
block generation time  44.07076120376587
self.global_to_local() spend sec:  0.3372476100921631
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275937
remove values openmp spend  0.09363961219787598
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  981448
remove values openmp spend  0.4849996566772461
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.718101978302002
6.5170703188809505
the split redundant ratio 
[6.5170703188809505]
1
average memory estimation for each split fanout bucket batch 16.754301611456444
capacity est:  1.345698388543557
split fanout degree bucket spend /sec:  3.7185256481170654
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10852909088134766
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.556281245579292
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.555381381231495
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.107659163079877
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.553265306067598
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.548228834215173
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.54675274865201
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.543660587253004
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.542152349374092
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.4838426791663
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.338136185856815
the length of split_batches_nid_list  12
batches output list generation spend  0.001012563705444336
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027132272720336914
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.828130006790161
len local_batched_seeds_list  12
partition total batch output list spend :  7.312662601470947
self.buckets_partition() spend  sec:  3.85530686378479
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.820992946624756  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.892221450805664  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.44477653503418  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.84020757675171  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.892187118530273  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.920042037963867  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.976149559020996  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.96395206451416  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.9428653717041  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.726227283477783  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.281135082244873  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.21934747695923  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 0.5754356384277344  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0051754713058472
pure train time :  2.321366548538208
train time :  5.323638677597046
end to end time :  90.37743663787842
connection check time:  33.16282510757446
block generation time  44.446322441101074
end to end time  91.21094179153442
Total (block generation + training)time/epoch 91.21094179153442
