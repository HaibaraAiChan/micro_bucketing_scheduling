main start at this time 1688335713.8820648
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

self.global_to_local() spend sec:  0.32309484481811523
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
step end  0

step start 1
step end  1

step start 2
step end  2

step start 3
step end  3

step start 4
step end  4

step start 5
step end  5

step start 6
step end  6

step start 7
step end  7

step start 8
step end  8

step start 9
step end  9

step start 10
step end  10

step start 11
step end  11

all time spend  5.3092241287231445
each batch time  [0.40604066848754883, 0.43341541290283203, 0.4259219169616699, 0.4264030456542969, 0.4326510429382324, 0.44709062576293945, 0.4503791332244873, 0.450916051864624, 0.45289134979248047, 0.45294809341430664, 0.4609413146972656, 0.46145105361938477]
global to local time  0.060817718505859375
in edges time  0.05414271354675293
OrderedDict time  0.9146900177001953
local to global time  1.3767170906066895
remove repeate  dst time  2.661485195159912
dict_nid_2_local = dict(zip(src_nid_list, range(len(src_nid_list))))  0.2616088390350342
num of batch  12
check_connections_block*********************************
step start 0
step end  0

step start 1
step end  1

step start 2
step end  2

step start 3
step end  3

step start 4
step end  4

step start 5
step end  5

step start 6
step end  6

step start 7
step end  7

step start 8
step end  8

step start 9
step end  9

step start 10
step end  10

step start 11
step end  11

all time spend  38.275078535079956
each batch time  [2.828984260559082, 2.9728050231933594, 3.096017360687256, 3.1772003173828125, 3.260901689529419, 3.1282827854156494, 3.220595598220825, 3.2608985900878906, 3.2391536235809326, 3.1927459239959717, 3.5014994144439697, 3.2119858264923096]
global to local time  1.3919451236724854
in edges time  1.2840888500213623
OrderedDict time  9.424575567245483
local to global time  9.080967664718628
remove repeate  dst time  15.745563268661499
dict_nid_2_local = dict(zip(src_nid_list, range(len(src_nid_list))))  0.4040496349334717
generate_K_hop_neighbors time  45.42195010185242
6.521662016060751
6.537532348060836
6.50851103870113
6.50938989336245
6.528444481381815
6.5051675698808875
6.543792595394738
6.512338514436303
6.519999834418687
6.506269322463557
6.531609631864977
6.532575947258202
the split redundant ratio 
[6.521662016060751, 6.537532348060836, 6.50851103870113, 6.50938989336245, 6.528444481381815, 6.5051675698808875, 6.543792595394738, 6.512338514436303, 6.519999834418687, 6.506269322463557, 6.531609631864977, 6.532575947258202]
12
average memory estimation for each split fanout bucket batch 16.76553815981126
capacity est:  1.2769998693393632
split fanout degree bucket spend /sec:  45.422884941101074
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.11388754844665527
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.56751779393411
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.56661792958631
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.118895711434693
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.564501854422414
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.55946538256999
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.557989297006827
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.55489713560782
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.553388897728908
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.495079227521117
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.34937273421163
the length of split_batches_nid_list  12
batches output list generation spend  0.0030608177185058594
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027172565460205078
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  45.53991746902466
len local_batched_seeds_list  12
partition total batch output list spend :  49.10225558280945
self.buckets_partition() spend  sec:  45.56715416908264
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.85546875 GB
    Memory Allocated: 20.87930727005005  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.83203125 GB
    Memory Allocated: 20.86750030517578  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.83203125 GB
    Memory Allocated: 20.459396362304688  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.953125 GB
    Memory Allocated: 20.961812496185303  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.87109375 GB
    Memory Allocated: 20.89730930328369  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.8828125 GB
    Memory Allocated: 20.870521068572998  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.96028709411621  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.925491333007812  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.873311519622803  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.763845920562744  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.212109565734863  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.213406562805176  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 0.5699458122253418  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.857676982879639
train time :  6.595362186431885
connection check time:  51.40347647666931
block generation time  45.188363552093506
