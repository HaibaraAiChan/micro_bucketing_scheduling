main start at this time 1689892796.1699371
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.8858962059021  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.897313594818115  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.87066888809204  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.961467266082764  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.876830577850342  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.832877159118652  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.778599739074707  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.27328109741211  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.274209022521973  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 0.5738925933837891  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.021099805831909
pure train time :  2.3547229766845703
train time :  5.459524393081665
end to end time :  95.96535611152649
connection check time:  33.32570123672485
block generation time  52.83540964126587
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132],                 ------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95],                 ------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46],                 ------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72],                 ------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383],             ------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31],                 ------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362],             ------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331],             ------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281],             ------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.135941743850708
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0009062290191650391
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024886369705200195
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13706636428833008
len local_batched_seeds_list  12
partition total batch output list spend :  3.3086624145507812
self.buckets_partition() spend  sec:  0.1619889736175537
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5225577354431152

in edges time spent  1.032745122909546
open mp src gen time  3.7929344177246094
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.3248591423034668

in edges time spent  6.664694309234619
open mp src gen time  16.4486346244812
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.889294147491455  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.88482666015625  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.402989864349365  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.0 GB
    Memory Allocated: 20.850690364837646  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.0 GB
    Memory Allocated: 20.849075317382812  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.0 GB
    Memory Allocated: 20.865787982940674  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.001953125 GB
    Memory Allocated: 21.017892837524414  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.001953125 GB
    Memory Allocated: 20.967775344848633  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.001953125 GB
    Memory Allocated: 20.967628955841064  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.001953125 GB
    Memory Allocated: 20.73578643798828  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.001953125 GB
    Memory Allocated: 20.26336431503296  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.001953125 GB
    Memory Allocated: 20.24595308303833  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.001953125 GB
    Memory Allocated: 0.5739350318908691  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9200018644332886
pure train time :  2.593485116958618
train time :  5.719843626022339
end to end time :  75.65088176727295
connection check time:  34.25438952445984
block generation time  31.699610948562622
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132],                 ------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95],                 ------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46],                 ------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72],                 ------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383],             ------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31],                 ------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362],             ------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331],             ------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281],             ------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.16157245635986328
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0008311271667480469
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024220943450927734
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.16261744499206543
len local_batched_seeds_list  12
partition total batch output list spend :  3.353989362716675
self.buckets_partition() spend  sec:  0.1868736743927002
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.509437084197998

in edges time spent  0.995161771774292
open mp src gen time  3.551811933517456
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.3153140544891357

in edges time spent  6.674530029296875
open mp src gen time  17.343467712402344
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.792885780334473  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.85314702987671  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.513665199279785  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.845357418060303  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.931341648101807  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.977127075195312  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.8929762840271  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.964092254638672  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.950093269348145  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.727797985076904  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.27521324157715  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.30099058151245  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 0.579261302947998  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7975877523422241
pure train time :  2.323615312576294
train time :  5.408443212509155
end to end time :  97.41503024101257
connection check time:  36.31938171386719
block generation time  51.368788957595825
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132],                 ------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95],                 ------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46],                 ------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72],                 ------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383],             ------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31],                 ------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362],             ------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331],             ------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281],             ------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.3079652786254883
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0009388923645019531
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025559186935424805
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3091464042663574
len local_batched_seeds_list  12
partition total batch output list spend :  3.4991824626922607
self.buckets_partition() spend  sec:  0.3347444534301758
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5101463794708252

in edges time spent  1.0163195133209229
open mp src gen time  3.8032169342041016
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.3478405475616455

in edges time spent  6.1486735343933105
open mp src gen time  16.746352195739746
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.865506172180176  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.85741376876831  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.467748641967773  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.876157760620117  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.839056491851807  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.978811264038086  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.972137928009033  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.966694831848145  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.871886730194092  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.72205352783203  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.233319759368896  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.24035406112671  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 0.5771632194519043  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6927862167358398
pure train time :  2.341834783554077
train time :  5.568711519241333
end to end time :  96.90079712867737
connection check time:  35.41133427619934
block generation time  51.2868127822876
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132],                 ------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95],                 ------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46],                 ------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72],                 ------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383],             ------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31],                 ------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362],             ------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331],             ------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281],             ------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.13983559608459473
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0008356571197509766
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027710437774658203
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.140855073928833
len local_batched_seeds_list  12
partition total batch output list spend :  3.412425994873047
self.buckets_partition() spend  sec:  0.16860222816467285
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5114123821258545

in edges time spent  1.0036041736602783
open mp src gen time  3.4172024726867676
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2848687171936035

in edges time spent  5.5118772983551025
open mp src gen time  16.060546398162842
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.820992946624756  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.892221450805664  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.44477653503418  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.84020757675171  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.892187118530273  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.920042037963867  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.976149559020996  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.96395206451416  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.9428653717041  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.726227283477783  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.281135082244873  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.21934747695923  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 0.5754356384277344  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6206605434417725
pure train time :  2.2460150718688965
train time :  5.322343349456787
end to end time :  96.0990059375763
connection check time:  34.16605043411255
block generation time  52.215248823165894
end to end time  96.69331884384155
Total (block generation + training)time/epoch 96.69331884384155