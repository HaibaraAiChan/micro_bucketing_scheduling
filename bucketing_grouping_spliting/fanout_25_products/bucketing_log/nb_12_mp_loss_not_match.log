main start at this time 1689906400.3092918
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.15251946449279785
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0011234283447265625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02317953109741211
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.153886079788208
len local_batched_seeds_list  12
partition total batch output list spend :  3.2672648429870605
self.buckets_partition() spend  sec:  0.17708754539489746
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.4823875427246094

in edges time spent  0.8938322067260742
open mp src gen time  1.8370163440704346
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2383530139923096

in edges time spent  6.760801076889038
open mp src gen time  10.251290082931519
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.85546875 GB
    Memory Allocated: 20.87930727005005  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.83203125 GB
    Memory Allocated: 20.86750030517578  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.83203125 GB
    Memory Allocated: 20.459396362304688  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.953125 GB
    Memory Allocated: 20.961812496185303  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.87109375 GB
    Memory Allocated: 20.89730930328369  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.8828125 GB
    Memory Allocated: 20.870521068572998  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.96028709411621  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.925491333007812  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.873311519622803  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.763845920562744  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.212109565734863  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.213406562805176  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 0.5699458122253418  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.214949607849121
pure train time :  3.180464029312134
train time :  6.3269031047821045
end to end time :  68.67184042930603
connection check time:  26.665691375732422
block generation time  31.48502016067505
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.13244867324829102
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0005753040313720703
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024991750717163086
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13316750526428223
len local_batched_seeds_list  12
partition total batch output list spend :  3.262899875640869
self.buckets_partition() spend  sec:  0.1581876277923584
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.48328542709350586

in edges time spent  0.9662039279937744
open mp src gen time  3.246396780014038
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2514948844909668

in edges time spent  6.79965353012085
open mp src gen time  18.11255669593811
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.03125 GB
    Memory Allocated: 20.88991355895996  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.04296875 GB
    Memory Allocated: 20.889187335968018  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.04296875 GB
    Memory Allocated: 20.487768173217773  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.817050457000732  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.791764736175537  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.934958457946777  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.959117889404297  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.912869453430176  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.880499362945557  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.78062629699707  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.31846570968628  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.271262645721436  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 0.5745038986206055  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.752910614013672
pure train time :  2.4041547775268555
train time :  5.2422943115234375
end to end time :  81.99868965148926
connection check time:  37.161508560180664
block generation time  35.06769609451294
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.15422654151916504
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0007050037384033203
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02425074577331543
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15509343147277832
len local_batched_seeds_list  12
partition total batch output list spend :  3.301480770111084
self.buckets_partition() spend  sec:  0.1793689727783203
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.495042085647583

in edges time spent  0.9980869293212891
open mp src gen time  3.0010650157928467
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2783801555633545

in edges time spent  6.8087804317474365
open mp src gen time  14.768218994140625
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.830885887145996  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.88627576828003  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.47308921813965  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.885474681854248  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.886273860931396  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.93744945526123  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.923717498779297  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.969818592071533  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.833988666534424  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.794161796569824  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.157340049743652  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.219388484954834  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 0.5777478218078613  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9941253662109375
pure train time :  2.3984503746032715
train time :  5.18090558052063
end to end time :  75.01896500587463
connection check time:  32.77450203895569
block generation time  32.8845157623291
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.155106782913208
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0007216930389404297
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024867773056030273
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1560204029083252
len local_batched_seeds_list  12
partition total batch output list spend :  3.2934699058532715
self.buckets_partition() spend  sec:  0.18091297149658203
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.501502275466919

in edges time spent  1.0304102897644043
open mp src gen time  3.835226058959961
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2744457721710205

in edges time spent  6.657361030578613
open mp src gen time  17.031131505966187
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.869750022888184  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.906763553619385  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.447404861450195  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.853790283203125  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.82582187652588  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.936280727386475  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.957692623138428  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.91869068145752  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.913366317749023  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.81868314743042  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.296515464782715  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.21473789215088  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 0.576045036315918  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.653182029724121
pure train time :  2.2812094688415527
train time :  5.018790006637573
end to end time :  75.87550520896912
connection check time:  35.495829343795776
block generation time  31.189198970794678
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.1538231372833252
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0006659030914306641
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02506852149963379
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15466547012329102
len local_batched_seeds_list  12
partition total batch output list spend :  3.293684959411621
self.buckets_partition() spend  sec:  0.17975974082946777
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.4820590019226074

in edges time spent  1.0114173889160156
open mp src gen time  3.025991201400757
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.263467788696289

in edges time spent  6.721143960952759
open mp src gen time  14.878852605819702
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.87788200378418  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.84088706970215  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.48173236846924  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.984375 GB
    Memory Allocated: 20.998186111450195  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.955078125 GB
    Memory Allocated: 20.8947696685791  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.871445655822754  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.863461017608643  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.950387001037598  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.83047914505005  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.777570724487305  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.288795471191406  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.270976543426514  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.578216552734375  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.270228862762451
pure train time :  2.715282678604126
train time :  5.632208585739136
end to end time :  74.62327289581299
connection check time:  32.68145203590393
block generation time  32.13372182846069
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.15417146682739258
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0006849765777587891
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025258541107177734
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1550276279449463
len local_batched_seeds_list  12
partition total batch output list spend :  3.312648057937622
self.buckets_partition() spend  sec:  0.1803114414215088
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.501152515411377

in edges time spent  1.0357544422149658
open mp src gen time  3.6916122436523438
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  0.9194455146789551

in edges time spent  6.755495548248291
open mp src gen time  18.412315130233765
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.86618423461914  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.978515625 GB
    Memory Allocated: 20.81562328338623  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.978515625 GB
    Memory Allocated: 20.485912799835205  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.8858962059021  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.897313594818115  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.87066888809204  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.961467266082764  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.876830577850342  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.832877159118652  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.778599739074707  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.27328109741211  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.274209022521973  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 0.5738925933837891  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.021099805831909
pure train time :  2.336247205734253
train time :  5.565864086151123
end to end time :  80.54320430755615
connection check time:  37.1503963470459
block generation time  33.37614607810974
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.11193490028381348
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0007555484771728516
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027513742446899414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.11285161972045898
len local_batched_seeds_list  12
partition total batch output list spend :  3.2486751079559326
self.buckets_partition() spend  sec:  0.1403958797454834
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.49567651748657227

in edges time spent  1.0128529071807861
open mp src gen time  3.2818288803100586
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2862815856933594

in edges time spent  6.688934803009033
open mp src gen time  15.399996995925903
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.889294147491455  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.88482666015625  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.402989864349365  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.0 GB
    Memory Allocated: 20.850690364837646  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.0 GB
    Memory Allocated: 20.849075317382812  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.0 GB
    Memory Allocated: 20.865787982940674  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 21.017892837524414  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.967775344848633  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.967628955841064  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.73578643798828  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.26336431503296  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.24595308303833  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 0.5739350318908691  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9200018644332886
pure train time :  2.5825114250183105
train time :  5.435094356536865
end to end time :  77.03818368911743
connection check time:  34.289263010025024
block generation time  33.180609941482544
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.1327500343322754
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0007872581481933594
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027750015258789062
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1336994171142578
len local_batched_seeds_list  12
partition total batch output list spend :  3.2453463077545166
self.buckets_partition() spend  sec:  0.16147947311401367
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5070257186889648

in edges time spent  1.024817705154419
open mp src gen time  3.7692463397979736
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2586123943328857

in edges time spent  6.7270896434783936
open mp src gen time  18.946536540985107
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.792885780334473  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.01953125 GB
    Memory Allocated: 20.85314702987671  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.01953125 GB
    Memory Allocated: 20.513665199279785  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.845357418060303  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.931341648101807  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.977127075195312  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.8929762840271  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.964092254638672  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.950093269348145  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.727797985076904  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.27521324157715  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.30099058151245  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 0.579261302947998  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7975877523422241
pure train time :  2.341808795928955
train time :  5.360232353210449
end to end time :  81.39506793022156
connection check time:  38.722604513168335
block generation time  33.18371367454529
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.301318883895874
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0007517337799072266
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02579665184020996
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.30225324630737305
len local_batched_seeds_list  12
partition total batch output list spend :  3.459059238433838
self.buckets_partition() spend  sec:  0.3280785083770752
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5177385807037354

in edges time spent  0.9949896335601807
open mp src gen time  3.567209243774414
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.3071658611297607

in edges time spent  7.3123486042022705
open mp src gen time  17.096360445022583
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.865506172180176  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.85741376876831  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.467748641967773  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.876157760620117  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.839056491851807  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.978811264038086  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.972137928009033  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.966694831848145  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.871886730194092  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.72205352783203  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.233319759368896  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.24035406112671  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 0.5771632194519043  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6927862167358398
pure train time :  2.336895227432251
train time :  5.184538841247559
end to end time :  78.14799451828003
connection check time:  36.622408628463745
block generation time  32.002479791641235
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.1545398235321045
split_batches_nid_list  12
[15, 10, 5]
current group_mem  0.8019796341228467
[20, 8, 4]
current group_mem  0.8010797697750498
[9, 1, 2]
current group_mem  0.3533575516234331
[21, 7, 3]
current group_mem  0.7989636946111522
[16, 14]
current group_mem  0.7939272227587294
[23, 6, 0]
current group_mem  0.7924511371955659
[17, 13]
current group_mem  0.7893589757965587
[18, 12]
current group_mem  0.7878507379176494
[19, 11]
current group_mem  0.729541067709857
[22]
current group_mem  0.5838345744003708
the length of split_batches_nid_list  12
batches output list generation spend  0.0007357597351074219
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024378061294555664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1554272174835205
len local_batched_seeds_list  12
partition total batch output list spend :  3.29953670501709
self.buckets_partition() spend  sec:  0.17983055114746094
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5005295276641846

in edges time spent  1.0079667568206787
open mp src gen time  2.9065256118774414
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2892403602600098

in edges time spent  6.645542860031128
open mp src gen time  14.952313899993896
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.820992946624756  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.892221450805664  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.44477653503418  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.84020757675171  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.892187118530273  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.920042037963867  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.976149559020996  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.96395206451416  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.9428653717041  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.726227283477783  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.281135082244873  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.21934747695923  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 0.5754356384277344  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6206605434417725
pure train time :  2.3212504386901855
train time :  5.15941309928894
end to end time :  73.80110216140747
connection check time:  33.23989391326904
block generation time  31.240530729293823
end to end time  74.41958117485046
Total (block generation + training)time/epoch 74.41958117485046
