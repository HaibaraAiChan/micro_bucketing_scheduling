main start at this time 1690166972.30036
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.1592264175415039
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0005056858062744141
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.022977352142333984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1599898338317871
len local_batched_seeds_list  12
partition total batch output list spend :  3.3289577960968018
self.buckets_partition() spend  sec:  0.18298983573913574
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5017857551574707

in edges time spent  0.8946342468261719
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.758622407913208
prepare time  1.2172396183013916
src gen time  2.5413382053375244
post sort  time  4.458427429199219e-05
time gen tails  0.5696079730987549
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.3280727863311768

in edges time spent  6.898072719573975
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  15.795098543167114
prepare time  3.2349891662597656
src gen time  12.560041904449463
post sort  time  6.747245788574219e-05
time gen tails  2.698390483856201
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.490234375 GB
    Memory Allocated: 20.4821834564209  GigaBytes
Max Memory Allocated: 20.840962886810303  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.798828125 GB
    Memory Allocated: 20.817519187927246  GigaBytes
Max Memory Allocated: 21.183128356933594  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.484375 GB
    Memory Allocated: 20.515573024749756  GigaBytes
Max Memory Allocated: 21.183128356933594  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 20.941368579864502  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 20.782366275787354  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 20.82846212387085  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 20.87297821044922  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.849356651306152  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.76335048675537  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.74304437637329  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.636141300201416  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.59068489074707  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 0.5749616622924805  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.207270622253418
pure train time :  3.2832252979278564
train time :  6.452617883682251
end to end time :  79.68546414375305
connection check time:  37.627197265625
block generation time  31.384432077407837
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.15822505950927734
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0005319118499755859
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024681806564331055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1589195728302002
len local_batched_seeds_list  12
partition total batch output list spend :  3.3253443241119385
self.buckets_partition() spend  sec:  0.18362832069396973
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.4890155792236328

in edges time spent  0.8828558921813965
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.7369871139526367
prepare time  1.1823952198028564
src gen time  2.5545461177825928
post sort  time  4.57763671875e-05
time gen tails  0.30457568168640137
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.0842208862304688

in edges time spent  6.82341194152832
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  16.837855100631714
prepare time  3.170034170150757
src gen time  13.667785406112671
post sort  time  3.552436828613281e-05
time gen tails  2.650437593460083
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.92578125 GB
    Memory Allocated: 20.522491931915283  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.845337390899658  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.540568351745605  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.809085369110107  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.743722915649414  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.909797191619873  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.88086748123169  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.839290618896484  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.7597336769104  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.754043579101562  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.69738483428955  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.628475666046143  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.5766682624816895  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4853670597076416
pure train time :  2.274209976196289
train time :  4.938061237335205
end to end time :  76.77315020561218
connection check time:  38.21018600463867
block generation time  29.455716848373413
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12997221946716309
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0005748271942138672
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026566743850708008
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1307086944580078
len local_batched_seeds_list  12
partition total batch output list spend :  3.3391478061676025
self.buckets_partition() spend  sec:  0.15730071067810059
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5127496719360352

in edges time spent  0.9668903350830078
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  5.019452095031738
prepare time  1.180490493774414
src gen time  3.838925361633301
post sort  time  3.62396240234375e-05
time gen tails  0.5085082054138184
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2833755016326904

in edges time spent  6.673185348510742
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  17.633812427520752
prepare time  3.148132085800171
src gen time  14.485629558563232
post sort  time  5.078315734863281e-05
time gen tails  2.680881977081299
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.442606925964355  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.803627490997314  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.52885675430298  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.848805904388428  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.808754444122314  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.876534461975098  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.870455265045166  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.927180290222168  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.718180656433105  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.78337812423706  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.576446056365967  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.60564947128296  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.5818228721618652  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7303168773651123
pure train time :  2.3113529682159424
train time :  5.408447742462158
end to end time :  84.9976897239685
connection check time:  41.606223583221436
block generation time  33.52259135246277
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.13189172744750977
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0008127689361572266
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026998281478881836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1328890323638916
len local_batched_seeds_list  12
partition total batch output list spend :  3.392533540725708
self.buckets_partition() spend  sec:  0.1599133014678955
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5579016208648682

in edges time spent  0.9758601188659668
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  6.160110235214233
prepare time  1.2394237518310547
src gen time  4.9206154346466064
post sort  time  7.104873657226562e-05
time gen tails  0.5103468894958496
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.3133506774902344

in edges time spent  6.819122314453125
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  21.802303791046143
prepare time  3.2245779037475586
src gen time  18.577657222747803
post sort  time  6.866455078125e-05
time gen tails  2.614057779312134
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.460910320281982  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.86013650894165  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.50871181488037  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.821038246154785  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.740352153778076  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.88682794570923  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.836345672607422  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.82478141784668  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.806114196777344  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.81434440612793  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.684863090515137  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.602852821350098  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.5798883438110352  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2332026958465576
pure train time :  2.2989277839660645
train time :  5.256280422210693
end to end time :  87.4964370727539
connection check time:  46.39948487281799
block generation time  31.54341411590576
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.13101744651794434
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0006642341613769531
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027288436889648438
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13185429573059082
len local_batched_seeds_list  12
partition total batch output list spend :  3.287313461303711
self.buckets_partition() spend  sec:  0.15916705131530762
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.49100351333618164

in edges time spent  0.9594476222991943
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  5.561235666275024
prepare time  1.1848039627075195
src gen time  4.376399278640747
post sort  time  3.24249267578125e-05
time gen tails  0.5318436622619629
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.3075144290924072

in edges time spent  6.770481586456299
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  19.14220929145813
prepare time  3.194530963897705
src gen time  15.947620868682861
post sort  time  5.745887756347656e-05
time gen tails  2.6274046897888184
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.518486499786377  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.763790130615234  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.53615140914917  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.942652702331543  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.802830696105957  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.837534427642822  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.814737796783447  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.87051248550415  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.702706336975098  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.740561485290527  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.67741870880127  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.62238597869873  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 0.5785946846008301  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.781855821609497
pure train time :  2.3482205867767334
train time :  5.3816704750061035
end to end time :  84.23200273513794
connection check time:  43.37660574913025
block generation time  31.29470729827881
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.1527862548828125
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0007262229919433594
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024129390716552734
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15367913246154785
len local_batched_seeds_list  12
partition total batch output list spend :  3.3399555683135986
self.buckets_partition() spend  sec:  0.17783403396606445
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5017876625061035

in edges time spent  0.9735605716705322
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  6.130391836166382
prepare time  1.2424957752227783
src gen time  4.887859106063843
post sort  time  3.695487976074219e-05
time gen tails  0.5113413333892822
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.3029212951660156

in edges time spent  6.80718469619751
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  20.552942037582397
prepare time  3.188899517059326
src gen time  17.363982677459717
post sort  time  5.984306335449219e-05
time gen tails  2.6650328636169434
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.52705478668213  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.764275550842285  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.52758550643921  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.849661350250244  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.783466339111328  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.838958740234375  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.873351573944092  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.82433795928955  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.70374822616577  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.77718496322632  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.640406131744385  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.655792713165283  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 0.580390453338623  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5537745952606201
pure train time :  2.3222174644470215
train time :  5.285916566848755
end to end time :  86.06125092506409
connection check time:  45.19601225852966
block generation time  31.343801975250244
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.13204622268676758
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0007305145263671875
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02733898162841797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13295364379882812
