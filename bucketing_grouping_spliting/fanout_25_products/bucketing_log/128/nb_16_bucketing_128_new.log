main start at this time 1691635281.8096225
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
11.127620995044708
24
the grouping_fanout_1 called successfully
capacity  951
sorted_dict  {23: 951, 22: 933, 21: 863, 20: 786, 18: 719, 19: 704, 17: 670, 16: 629, 15: 607, 14: 594, 13: 571, 12: 509, 10: 432, 11: 424, 9: 386, 8: 314, 7: 264, 6: 249, 5: 189, 4: 130, 3: 98, 2: 59, 1: 26, 0: 10}

weights after sort [951, 933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 509, 432, 424, 386, 314, 264, 249, 189, 130, 98, 59, 26, 10]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [951], 		------------sum 951

before remove weights,  [951, 933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 509, 432, 424, 386, 314, 264, 249, 189, 130, 98, 59, 26, 10]
after remove pre pack weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 509, 432, 424, 386, 314, 264, 249, 189, 130, 98, 59, 26, 10]

remove bucket_id:  [15, 16, 19, 21]
original bucket_id :,  [7, 6, 3, 1]
remove weights:  [264 249  98  26], 		------------sum 637

before remove weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 509, 432, 424, 386, 314, 264, 249, 189, 130, 98, 59, 26, 10]
after remove pre pack weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 509, 432, 424, 386, 314, 189, 130, 59, 10]

remove bucket_id:  [10, 11, 18]
original bucket_id :,  [12, 10, 0]
remove weights:  [509 432  10], 		------------sum 951

before remove weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 509, 432, 424, 386, 314, 189, 130, 59, 10]
after remove pre pack weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 424, 386, 314, 189, 130, 59]

remove bucket_id:  [13, 14, 15]
original bucket_id :,  [5, 4, 2]
remove weights:  [189 130  59], 		------------sum 378

before remove weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 424, 386, 314, 189, 130, 59]
after remove pre pack weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 424, 386, 314]

remove bucket_id:  [6, 12]
original bucket_id :,  [16, 8]
remove weights:  [629 314], 		------------sum 943

before remove weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 424, 386, 314]
after remove pre pack weights,  [933, 863, 786, 719, 704, 670, 607, 594, 571, 424, 386]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [933], 		------------sum 933

before remove weights,  [933, 863, 786, 719, 704, 670, 607, 594, 571, 424, 386]
after remove pre pack weights,  [863, 786, 719, 704, 670, 607, 594, 571, 424, 386]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [863], 		------------sum 863

before remove weights,  [863, 786, 719, 704, 670, 607, 594, 571, 424, 386]
after remove pre pack weights,  [786, 719, 704, 670, 607, 594, 571, 424, 386]

remove bucket_id:  [7, 8]
original bucket_id :,  [11, 9]
remove weights:  [424 386], 		------------sum 810

before remove weights,  [786, 719, 704, 670, 607, 594, 571, 424, 386]
after remove pre pack weights,  [786, 719, 704, 670, 607, 594, 571]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [786], 		------------sum 786

before remove weights,  [786, 719, 704, 670, 607, 594, 571]
after remove pre pack weights,  [719, 704, 670, 607, 594, 571]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [719], 		------------sum 719

before remove weights,  [719, 704, 670, 607, 594, 571]
after remove pre pack weights,  [704, 670, 607, 594, 571]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [704], 		------------sum 704

before remove weights,  [704, 670, 607, 594, 571]
after remove pre pack weights,  [670, 607, 594, 571]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [670], 		------------sum 670

before remove weights,  [670, 607, 594, 571]
after remove pre pack weights,  [607, 594, 571]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [607], 		------------sum 607

before remove weights,  [607, 594, 571]
after remove pre pack weights,  [594, 571]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [594], 		------------sum 594

before remove weights,  [594, 571]
after remove pre pack weights,  [571]
the last batch value is  571
G_BUCKET_ID_list [[23], [7, 6, 3, 1], [12, 10, 0], [5, 4, 2], [16, 8], [22], [21], [11, 9], [20], [18], [19], [17], [15], [14], [13]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.19237804412841797
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  16
current group_mem  0.9516638517379761
current group_mem  0.6388026773929596
current group_mem  0.9515804350376129
current group_mem  0.37980857491493225
current group_mem  0.9441984593868256
current group_mem  0.9334430694580078
current group_mem  0.8632670938968658
current group_mem  0.8114545941352844
current group_mem  0.7861466109752655
current group_mem  0.7191262543201447
current group_mem  0.7044298946857452
current group_mem  0.6702716946601868
current group_mem  0.6078604459762573
current group_mem  0.594073086977005
current group_mem  0.5714942514896393
batches output list generation spend  0.0004417896270751953
self.weights_list  [0.06159097730590982, 0.0676905545578951, 0.0654928753478387, 0.06527412487091178, 0.06406845363761694, 0.06160623896709077, 0.06132135462504642, 0.06453139069343901, 0.06129083130268453, 0.06128065686189723, 0.06121961021717344, 0.06138240126977021, 0.0614332734737067, 0.061733419476932, 0.06184533832559228, 0.05823849906649506]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02340865135192871
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.19308042526245117
len local_batched_seeds_list  16
partition total batch output list spend :  4.453789710998535
self.buckets_partition() spend  sec:  0.21651053428649902
layer  0
 the number of batches:  16
check_connections_block*********************************

the find indices time spent  0.28666186332702637

in edges time spent  0.9184427261352539
local to global src and eids time spent  2.2991976737976074
time gen tails  0.5675170421600342
res  length 16
layer  1
num of batch  16
check_connections_block*********************************

the find indices time spent  1.9355862140655518

in edges time spent  7.242815732955933
local to global src and eids time spent  16.266777276992798
time gen tails  3.1087167263031006
res  length 16
block collection to dataloader spend  4.00543212890625e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 18.43359375 GB
    Memory Allocated: 16.54069709777832  GigaBytes
Max Memory Allocated: 16.81397819519043  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 18.484375 GB
    Memory Allocated: 16.38853645324707  GigaBytes
Max Memory Allocated: 16.81397819519043  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 19.37109375 GB
    Memory Allocated: 16.550036907196045  GigaBytes
Max Memory Allocated: 16.823103427886963  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 19.37109375 GB
    Memory Allocated: 16.194830417633057  GigaBytes
Max Memory Allocated: 16.823103427886963  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 16.618159770965576  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 16.583938121795654  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 16.551382064819336  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 16.48734188079834  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 16.555742740631104  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 16.44790744781494  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 16.46698760986328  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 16.455610752105713  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 16.417681217193604  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 16.459379196166992  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 16.42851161956787  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 16.02561855316162  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 20.26171875 GB
    Memory Allocated: 0.5321125984191895  GigaBytes
Max Memory Allocated: 16.892138481140137  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.204352855682373
pure train time :  3.090873956680298
train time :  6.918415784835815
end to end time :  79.06996822357178
connection check time:  40.78673005104065
block generation time  26.786511421203613
Total (block generation + training)time/epoch nan
