main start at this time 1690923233.6805584
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.3390989303588867
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  17
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.00047016143798828125
self.weights_list  [0.05817236520137762, 0.06444999516714063, 0.05876756998743456, 0.058157103540196674, 0.06166728561181456, 0.06280682297999196, 0.06324432393384578, 0.05785695753697138, 0.05784678309618407, 0.05778573645146029, 0.0577043409251619, 0.05794852750405706, 0.05799939970799355, 0.0580044869283872, 0.057841695875790425, 0.054875846386293, 0.05487075916589934]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023531436920166016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.34151387214660645
len local_batched_seeds_list  17
partition total batch output list spend :  4.920954465866089
self.buckets_partition() spend  sec:  0.3650684356689453
layer  0
 the number of batches:  17
check_connections_block*********************************

the find indices time spent  0.29972124099731445

in edges time spent  1.0191411972045898
local to global src and eids time spent  2.3173346519470215
time gen tails  0.5671355724334717
res  length 17
layer  1
num of batch  17
check_connections_block*********************************

the find indices time spent  1.9729914665222168

in edges time spent  9.136124610900879
local to global src and eids time spent  17.212560892105103
time gen tails  3.281337022781372
res  length 17
block collection to dataloader spend  4.887580871582031e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 17.6328125 GB
    Memory Allocated: 15.79521656036377  GigaBytes
Max Memory Allocated: 16.053804874420166  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 18.478515625 GB
    Memory Allocated: 15.567692279815674  GigaBytes
Max Memory Allocated: 16.053804874420166  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 19.30859375 GB
    Memory Allocated: 15.753390789031982  GigaBytes
Max Memory Allocated: 16.053804874420166  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 20.140625 GB
    Memory Allocated: 15.795487880706787  GigaBytes
Max Memory Allocated: 16.056340217590332  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 17.703125 GB
    Memory Allocated: 15.851890087127686  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 17.728515625 GB
    Memory Allocated: 15.800551414489746  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.776978969573975  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.68911600112915  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.68061113357544  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.700433731079102  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.638171672821045  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.682322978973389  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.646780967712402  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.579651355743408  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.56764268875122  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.27636432647705  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.256650447845459  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 0.5175790786743164  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.207738399505615
pure train time :  3.210848331451416
train time :  7.138953924179077
end to end time :  83.1738805770874
connection check time:  41.37926626205444
block generation time  29.610901832580566
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.10196495056152344
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  17
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.00046634674072265625
self.weights_list  [0.05817236520137762, 0.06444999516714063, 0.05876756998743456, 0.058157103540196674, 0.06166728561181456, 0.06280682297999196, 0.06324432393384578, 0.05785695753697138, 0.05784678309618407, 0.05778573645146029, 0.0577043409251619, 0.05794852750405706, 0.05799939970799355, 0.0580044869283872, 0.057841695875790425, 0.054875846386293, 0.05487075916589934]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0324399471282959
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1025996208190918
len local_batched_seeds_list  17
partition total batch output list spend :  2.83398175239563
self.buckets_partition() spend  sec:  0.13506841659545898
layer  0
 the number of batches:  17
check_connections_block*********************************

the find indices time spent  0.2962656021118164

in edges time spent  0.9129228591918945
local to global src and eids time spent  2.294987440109253
time gen tails  0.5856060981750488
res  length 17
layer  1
num of batch  17
check_connections_block*********************************

the find indices time spent  2.0821332931518555

in edges time spent  7.401719808578491
local to global src and eids time spent  17.14668107032776
time gen tails  3.19212007522583
res  length 17
block collection to dataloader spend  2.8133392333984375e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.77349328994751  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.525238037109375  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.772608280181885  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.798387050628662  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 17.73046875 GB
    Memory Allocated: 15.823488235473633  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.726369380950928  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.761794090270996  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.768326759338379  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.640657901763916  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.694255828857422  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.639348030090332  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.698112964630127  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.635271072387695  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.598350048065186  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.572890758514404  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.315267086029053  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.278732776641846  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 0.5176863670349121  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4674978256225586
pure train time :  2.656014919281006
train time :  6.094772815704346
end to end time :  75.48489189147949
connection check time:  39.37847900390625
block generation time  27.08375310897827
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.31757378578186035
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  17
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.000804901123046875
self.weights_list  [0.05817236520137762, 0.06444999516714063, 0.05876756998743456, 0.058157103540196674, 0.06166728561181456, 0.06280682297999196, 0.06324432393384578, 0.05785695753697138, 0.05784678309618407, 0.05778573645146029, 0.0577043409251619, 0.05794852750405706, 0.05799939970799355, 0.0580044869283872, 0.057841695875790425, 0.054875846386293, 0.05487075916589934]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02829456329345703
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.31856751441955566
len local_batched_seeds_list  17
partition total batch output list spend :  4.7809669971466064
self.buckets_partition() spend  sec:  0.34688687324523926
layer  0
 the number of batches:  17
check_connections_block*********************************

the find indices time spent  0.30464911460876465

in edges time spent  0.9267904758453369
local to global src and eids time spent  2.277590274810791
time gen tails  0.5860979557037354
res  length 17
layer  1
num of batch  17
check_connections_block*********************************

the find indices time spent  1.9831211566925049

in edges time spent  7.421575546264648
local to global src and eids time spent  16.429450035095215
time gen tails  3.1819026470184326
res  length 17
block collection to dataloader spend  3.528594970703125e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.730233192443848  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.539251804351807  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.735918998718262  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.790669441223145  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.810519218444824  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.782732009887695  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.762286186218262  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.70450496673584  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.700076580047607  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.685985088348389  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.70643424987793  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.66523027420044  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.635128498077393  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.633167266845703  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.492781639099121  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.242076396942139  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.281487464904785  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 0.5167016983032227  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7320494651794434
pure train time :  2.6417453289031982
train time :  6.25310206413269
end to end time :  76.03835868835449
connection check time:  38.0899760723114
block generation time  26.784330129623413
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.09173893928527832
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  17
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0005476474761962891
self.weights_list  [0.05817236520137762, 0.06444999516714063, 0.05876756998743456, 0.058157103540196674, 0.06166728561181456, 0.06280682297999196, 0.06324432393384578, 0.05785695753697138, 0.05784678309618407, 0.05778573645146029, 0.0577043409251619, 0.05794852750405706, 0.05799939970799355, 0.0580044869283872, 0.057841695875790425, 0.054875846386293, 0.05487075916589934]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02609562873840332
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.09244322776794434
len local_batched_seeds_list  17
partition total batch output list spend :  4.10195255279541
self.buckets_partition() spend  sec:  0.11855745315551758
layer  0
 the number of batches:  17
check_connections_block*********************************

the find indices time spent  0.2871549129486084

in edges time spent  0.9260547161102295
local to global src and eids time spent  2.2477071285247803
time gen tails  0.542229413986206
res  length 17
layer  1
num of batch  17
check_connections_block*********************************

the find indices time spent  1.9672982692718506

in edges time spent  7.3331804275512695
local to global src and eids time spent  15.890643835067749
time gen tails  3.111569881439209
res  length 17
block collection to dataloader spend  3.0279159545898438e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.719580173492432  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.546914100646973  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.745432376861572  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.800290584564209  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.80738353729248  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.741695880889893  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.758330345153809  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.7240309715271  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.69609546661377  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.682774543762207  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.63615083694458  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.662205219268799  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.669864654541016  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.644843578338623  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.578996181488037  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.272969245910645  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.283708572387695  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 0.5177731513977051  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.235820770263672
pure train time :  2.6241767406463623
train time :  6.144375562667847
end to end time :  73.13305163383484
connection check time:  36.957361936569214
block generation time  25.837769031524658
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.31723952293395996
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  17
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0005922317504882812
self.weights_list  [0.05817236520137762, 0.06444999516714063, 0.05876756998743456, 0.058157103540196674, 0.06166728561181456, 0.06280682297999196, 0.06324432393384578, 0.05785695753697138, 0.05784678309618407, 0.05778573645146029, 0.0577043409251619, 0.05794852750405706, 0.05799939970799355, 0.0580044869283872, 0.057841695875790425, 0.054875846386293, 0.05487075916589934]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.037169694900512695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3180365562438965
len local_batched_seeds_list  17
partition total batch output list spend :  4.8112852573394775
self.buckets_partition() spend  sec:  0.3552422523498535
layer  0
 the number of batches:  17
check_connections_block*********************************

the find indices time spent  0.31046557426452637

in edges time spent  0.915813684463501
local to global src and eids time spent  2.267345905303955
time gen tails  0.5633902549743652
res  length 17
layer  1
num of batch  17
check_connections_block*********************************

the find indices time spent  2.060018539428711

in edges time spent  7.321766138076782
local to global src and eids time spent  16.402624130249023
time gen tails  3.1830098628997803
res  length 17
block collection to dataloader spend  3.62396240234375e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.723081111907959  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.520149230957031  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.71088695526123  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 17.732421875 GB
    Memory Allocated: 15.7970871925354  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.849757194519043  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.836729526519775  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.775103092193604  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.679611682891846  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.64954423904419  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.647202014923096  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.669182300567627  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.664109230041504  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.624378681182861  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.593106269836426  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.58519172668457  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.23771047592163  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.300665378570557  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 0.5141024589538574  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7773150205612183
pure train time :  2.5628068447113037
train time :  5.865156173706055
end to end time :  77.48580837249756
connection check time:  38.60628533363342
block generation time  28.092491626739502
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.09176063537597656
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  17
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.000698089599609375
self.weights_list  [0.05817236520137762, 0.06444999516714063, 0.05876756998743456, 0.058157103540196674, 0.06166728561181456, 0.06280682297999196, 0.06324432393384578, 0.05785695753697138, 0.05784678309618407, 0.05778573645146029, 0.0577043409251619, 0.05794852750405706, 0.05799939970799355, 0.0580044869283872, 0.057841695875790425, 0.054875846386293, 0.05487075916589934]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024652719497680664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.09260821342468262
len local_batched_seeds_list  17
partition total batch output list spend :  3.7974185943603516
self.buckets_partition() spend  sec:  0.1172795295715332
layer  0
 the number of batches:  17
check_connections_block*********************************

the find indices time spent  0.2896096706390381

in edges time spent  0.9350879192352295
local to global src and eids time spent  2.1222970485687256
time gen tails  0.31881117820739746
res  length 17
layer  1
num of batch  17
check_connections_block*********************************

the find indices time spent  1.7688121795654297

in edges time spent  4.449203014373779
local to global src and eids time spent  11.236189365386963
time gen tails  3.2272651195526123
res  length 17
block collection to dataloader spend  3.337860107421875e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.762296199798584  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.531098365783691  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.733526229858398  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.800593852996826  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.802290439605713  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.779830932617188  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.771611213684082  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.687126636505127  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.648705959320068  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.686312198638916  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.610127925872803  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.652893543243408  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.654173851013184  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.583380699157715  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.576600551605225  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.26343584060669  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.3224458694458  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 0.5172748565673828  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.544273018836975
pure train time :  2.627276659011841
train time :  6.113990068435669
end to end time :  66.62046766281128
connection check time:  29.40381932258606
block generation time  27.208053588867188
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.31948041915893555
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  17
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0007588863372802734
self.weights_list  [0.05817236520137762, 0.06444999516714063, 0.05876756998743456, 0.058157103540196674, 0.06166728561181456, 0.06280682297999196, 0.06324432393384578, 0.05785695753697138, 0.05784678309618407, 0.05778573645146029, 0.0577043409251619, 0.05794852750405706, 0.05799939970799355, 0.0580044869283872, 0.057841695875790425, 0.054875846386293, 0.05487075916589934]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02896738052368164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.32053256034851074
len local_batched_seeds_list  17
partition total batch output list spend :  4.776764154434204
self.buckets_partition() spend  sec:  0.34952521324157715
layer  0
 the number of batches:  17
check_connections_block*********************************

the find indices time spent  0.2845146656036377

in edges time spent  0.9438021183013916
local to global src and eids time spent  2.297529935836792
time gen tails  0.5689313411712646
res  length 17
layer  1
num of batch  17
check_connections_block*********************************

the find indices time spent  2.2270560264587402

in edges time spent  7.5745813846588135
local to global src and eids time spent  9.712714910507202
time gen tails  3.1187214851379395
res  length 17
block collection to dataloader spend  3.528594970703125e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.762780666351318  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.533825874328613  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.734063148498535  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.730288028717041  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.770523071289062  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.770825862884521  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.768098831176758  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.694895267486572  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.714015007019043  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.694247722625732  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.68174695968628  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.710746765136719  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.664175987243652  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.568514347076416  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.526124000549316  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.287374496459961  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.283796787261963  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 0.5139365196228027  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3887763023376465
pure train time :  2.5135064125061035
train time :  6.031872749328613
end to end time :  71.2893431186676
connection check time:  32.380622148513794
block generation time  27.97907829284668
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.10207962989807129
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  17
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0005540847778320312
self.weights_list  [0.05817236520137762, 0.06444999516714063, 0.05876756998743456, 0.058157103540196674, 0.06166728561181456, 0.06280682297999196, 0.06324432393384578, 0.05785695753697138, 0.05784678309618407, 0.05778573645146029, 0.0577043409251619, 0.05794852750405706, 0.05799939970799355, 0.0580044869283872, 0.057841695875790425, 0.054875846386293, 0.05487075916589934]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02622079849243164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1027827262878418
len local_batched_seeds_list  17
partition total batch output list spend :  4.499989032745361
self.buckets_partition() spend  sec:  0.12902307510375977
layer  0
 the number of batches:  17
check_connections_block*********************************

the find indices time spent  0.3159925937652588

in edges time spent  0.9412136077880859
local to global src and eids time spent  2.321859121322632
time gen tails  0.5598204135894775
res  length 17
layer  1
num of batch  17
check_connections_block*********************************

the find indices time spent  1.9651923179626465

in edges time spent  7.293074607849121
local to global src and eids time spent  16.033970832824707
time gen tails  3.193934917449951
res  length 17
block collection to dataloader spend  3.933906555175781e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.699949741363525  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.543325424194336  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.764339923858643  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.795587062835693  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.804155349731445  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.77451229095459  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.769444942474365  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.706319332122803  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.678446292877197  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.690528869628906  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.641681671142578  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.650864124298096  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.673486232757568  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.557514667510986  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.531528949737549  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.317883014678955  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.297376155853271  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 0.5138068199157715  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2720506191253662
pure train time :  2.674938917160034
train time :  6.182227849960327
end to end time :  76.49287796020508
connection check time:  37.690431356430054
block generation time  28.039929151535034
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.3402254581451416
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  17
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0006430149078369141
self.weights_list  [0.05817236520137762, 0.06444999516714063, 0.05876756998743456, 0.058157103540196674, 0.06166728561181456, 0.06280682297999196, 0.06324432393384578, 0.05785695753697138, 0.05784678309618407, 0.05778573645146029, 0.0577043409251619, 0.05794852750405706, 0.05799939970799355, 0.0580044869283872, 0.057841695875790425, 0.054875846386293, 0.05487075916589934]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02484726905822754
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3412039279937744
len local_batched_seeds_list  17
partition total batch output list spend :  4.86050271987915
self.buckets_partition() spend  sec:  0.3660860061645508
layer  0
 the number of batches:  17
check_connections_block*********************************

the find indices time spent  0.2958378791809082

in edges time spent  0.9320785999298096
local to global src and eids time spent  2.0401628017425537
time gen tails  0.5284571647644043
res  length 17
layer  1
num of batch  17
check_connections_block*********************************

the find indices time spent  2.008702039718628

in edges time spent  7.283395051956177
local to global src and eids time spent  16.160969018936157
time gen tails  3.1335978507995605
res  length 17
block collection to dataloader spend  3.528594970703125e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.702242374420166  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.57911491394043  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.73925495147705  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.752065658569336  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.813596248626709  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.77013111114502  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.795289516448975  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.711343765258789  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.674640655517578  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.693547248840332  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.643724918365479  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.683608055114746  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.64709997177124  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.583011627197266  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.531261444091797  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.24885892868042  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.280223846435547  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 0.5134391784667969  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.173300862312317
pure train time :  2.623636484146118
train time :  5.991840362548828
end to end time :  75.22844290733337
connection check time:  37.584248065948486
block generation time  26.675919771194458
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.4813661575317383
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  17
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0008392333984375
self.weights_list  [0.05817236520137762, 0.06444999516714063, 0.05876756998743456, 0.058157103540196674, 0.06166728561181456, 0.06280682297999196, 0.06324432393384578, 0.05785695753697138, 0.05784678309618407, 0.05778573645146029, 0.0577043409251619, 0.05794852750405706, 0.05799939970799355, 0.0580044869283872, 0.057841695875790425, 0.054875846386293, 0.05487075916589934]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029004335403442383
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4824047088623047
len local_batched_seeds_list  17
partition total batch output list spend :  5.030435800552368
self.buckets_partition() spend  sec:  0.5114378929138184
layer  0
 the number of batches:  17
check_connections_block*********************************

the find indices time spent  0.28656911849975586

in edges time spent  0.9104311466217041
local to global src and eids time spent  2.2684197425842285
time gen tails  0.55999755859375
res  length 17
layer  1
num of batch  17
check_connections_block*********************************

the find indices time spent  1.9680371284484863

in edges time spent  9.59099006652832
local to global src and eids time spent  16.270753860473633
time gen tails  3.125511407852173
res  length 17
block collection to dataloader spend  4.792213439941406e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.722742080688477  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.55508041381836  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.710943222045898  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.753779888153076  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.8076171875  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.770270824432373  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.7501859664917  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.692715644836426  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.703144550323486  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.705905437469482  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.704013347625732  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.687287330627441  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.638598442077637  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.578259944915771  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.565181732177734  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.27617597579956  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 15.290205001831055  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 17.81640625 GB
    Memory Allocated: 0.5146045684814453  GigaBytes
Max Memory Allocated: 16.111502647399902  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.079798698425293
pure train time :  2.5961692333221436
train time :  6.014220714569092
end to end time :  78.37805724143982
connection check time:  39.93114638328552
block generation time  27.294337272644043
end to end time  79.17074751853943
Total (block generation + training)time/epoch 79.17074751853943
