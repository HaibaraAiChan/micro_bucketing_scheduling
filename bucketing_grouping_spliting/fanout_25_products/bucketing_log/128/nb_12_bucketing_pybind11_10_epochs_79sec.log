Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 1
0
Thread ID: 4
9Thread ID: Thread ID: 2
Thread ID: 
8
11Thread ID: 
10
3
5
7
6
Time taken by function: 118184 microseconds
Time taken by function: 174062 microseconds
Time taken by function: 189708 microseconds
Time taken by function: 192828 microseconds
Time taken by function: 193063 microseconds
Time taken by function: 193954 microseconds
Time taken by function: 195111 microseconds
Time taken by function: 195590 microseconds
Time taken by function: 202484 microseconds
Time taken by function: 206320 microseconds
Time taken by function: 206384 microseconds
Time taken by function: 209330 microseconds
Openmp Time taken by function: 210105 microseconds
gen-src C++ Time taken by function: 865147 microseconds
Thread ID: 0
Thread ID: 1
Thread ID: 8
Thread ID: Thread ID: 10
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 114
7

Thread ID: 9
2
Thread ID: 5
3
6
Time taken by function: 708865 microseconds
Time taken by function: 773105 microseconds
Time taken by function: 910808 microseconds
Time taken by function: 911963 microseconds
Time taken by function: 921134 microseconds
Time taken by function: 945616 microseconds
Time taken by function: 948597 microseconds
Time taken by function: 974993 microseconds
Time taken by function: 984180 microseconds
Time taken by function: 1010295 microseconds
Time taken by function: 1036390 microseconds
Time taken by function: 1081223 microseconds
Openmp Time taken by function: 1081401 microseconds
gen-src C++ Time taken by function: 2512280 microseconds
main start at this time 1690186128.129192
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.15090560913085938
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0005280971527099609
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02364969253540039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15170669555664062
len local_batched_seeds_list  12
partition total batch output list spend :  3.313992977142334
self.buckets_partition() spend  sec:  0.1753835678100586
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.49097371101379395

in edges time spent  0.9277126789093018
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.1638007164001465
src gen time  3.1637682914733887
post sort  time  3.24249267578125e-05
time gen tails  0.5327506065368652
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.276763677597046

in edges time spent  6.860980033874512
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  13.848289012908936
src gen time  13.848258972167969
post sort  time  2.9802322387695312e-05
time gen tails  2.561525344848633
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.490234375 GB
    Memory Allocated: 20.4821834564209  GigaBytes
Max Memory Allocated: 20.840962886810303  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.798828125 GB
    Memory Allocated: 20.817519187927246  GigaBytes
Max Memory Allocated: 21.183128356933594  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.484375 GB
    Memory Allocated: 20.515573024749756  GigaBytes
Max Memory Allocated: 21.183128356933594  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 20.941368579864502  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 20.782366275787354  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 20.82846212387085  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 20.87297821044922  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes
Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: 810Thread ID: 6
Thread ID: Thread ID: Thread ID: 
Thread ID: 2
5Thread ID: 119
1
47Thread ID: 

3



Time taken by function: 127285 microseconds
Time taken by function: 200147 microseconds
Time taken by function: 202048 microseconds
Time taken by function: 202102 microseconds
Time taken by function: 203059 microseconds
Time taken by function: 207574 microseconds
Time taken by function: 208116 microseconds
Time taken by function: 208263 microseconds
Time taken by function: 210737 microseconds
Time taken by function: 212183 microseconds
Time taken by function: 213042 microseconds
Time taken by function: 231866 microseconds
Openmp Time taken by function: 232598 microseconds
gen-src C++ Time taken by function: 862886 microseconds
Thread ID: 0
Thread ID: Thread ID: 2
Thread ID: Thread ID: 3
6
7Thread ID: 
Thread ID: Thread ID: 1Thread ID: Thread ID: 
Thread ID: 9
48
Thread ID: 
10511


Time taken by function: 686489 microseconds
Time taken by function: 727837 microseconds
Time taken by function: 949267 microseconds
Time taken by function: 954915 microseconds
Time taken by function: 967396 microseconds
Time taken by function: 982058 microseconds
Time taken by function: 990637 microseconds
Time taken by function: 996403 microseconds
Time taken by function: 1006728 microseconds
Time taken by function: 1010262 microseconds
Time taken by function: 1027129 microseconds
Time taken by function: 1048759 microseconds
Openmp Time taken by function: 1049071 microseconds
gen-src C++ Time taken by function: 2466081 microseconds

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.849356651306152  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.76335048675537  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.74304437637329  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.636141300201416  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.59068489074707  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 0.5749616622924805  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.207270622253418
pure train time :  3.2519659996032715
train time :  6.782546520233154
end to end time :  77.83597302436829
connection check time:  34.16520547866821
block generation time  32.51978874206543
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.15201926231384277
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0005431175231933594
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02625751495361328
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1527543067932129
len local_batched_seeds_list  12
partition total batch output list spend :  3.3435449600219727
self.buckets_partition() spend  sec:  0.17903780937194824
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.4901010990142822

in edges time spent  0.8902337551116943
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.0719869136810303
src gen time  3.071950674057007
post sort  time  3.62396240234375e-05
time gen tails  0.5320966243743896
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2932417392730713

in edges time spent  6.952806711196899
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  13.376702070236206
src gen time  13.376672267913818
post sort  time  2.9802322387695312e-05
time gen tails  2.5879011154174805
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.92578125 GB
    Memory Allocated: 20.522491931915283  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.845337390899658  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.540568351745605  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes
Thread ID: 0
Thread ID: Thread ID: Thread ID: 8
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 752693

Thread ID: Thread ID: 11

10

4

Thread ID: 1

Time taken by function: 104352 microseconds
Time taken by function: 168900 microseconds
Time taken by function: 172134 microseconds
Time taken by function: 172436 microseconds
Time taken by function: 178245 microseconds
Time taken by function: 178656 microseconds
Time taken by function: 349597 microseconds
Time taken by function: 466826 microseconds
Time taken by function: 475818 microseconds
Time taken by function: 515825 microseconds
Time taken by function: 671134 microseconds
Time taken by function: 672576 microseconds
Openmp Time taken by function: 673338 microseconds
gen-src C++ Time taken by function: 1268664 microseconds

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.809085369110107  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.743722915649414  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.909797191619873  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.88086748123169  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.839290618896484  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.7597336769104  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.754043579101562  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.69738483428955  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.628475666046143  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.5766682624816895  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4853670597076416
pure train time :  2.3494460582733154
train time :  5.498732566833496
end to end time :  75.79051733016968
connection check time:  33.39441919326782
block generation time  32.38715982437134
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.1522376537322998
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0006427764892578125
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0238797664642334
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15305113792419434
len local_batched_seeds_list  12
partition total batch output list spend :  3.3231053352355957
self.buckets_partition() spend  sec:  0.1769568920135498
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.4987757205963135

in edges time spent  0.9327123165130615
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.471658229827881
src gen time  3.4716238975524902
post sort  time  3.409385681152344e-05
time gen tails  0.5403447151184082
res  length 12
layer  1
num of batch  12
check_connections_block*********************************Thread ID: 0
Thread ID: 9
Thread ID: Thread ID: Thread ID: 6
13

Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 118
75
4


10
Thread ID: 2
Time taken by function: 652439 microseconds
Time taken by function: 687600 microseconds
Time taken by function: 813339 microseconds
Time taken by function: 956298 microseconds
Time taken by function: 982537 microseconds
Time taken by function: 985194 microseconds
Time taken by function: 2609361 microseconds
Time taken by function: 2623057 microseconds
Time taken by function: 2645992 microseconds
Time taken by function: 2829835 microseconds
Time taken by function: 2850516 microseconds
Time taken by function: 2865366 microseconds
Openmp Time taken by function: 2865597 microseconds
gen-src C++ Time taken by function: 4164038 microseconds


the find indices time spent  1.2928133010864258

in edges time spent  6.727892875671387
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  15.040275573730469
src gen time  15.040210485458374
post sort  time  6.4849853515625e-05
time gen tails  2.556971311569214
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.442606925964355  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.803627490997314  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.52885675430298  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.848805904388428  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.808754444122314  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.876534461975098  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.870455265045166  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.927180290222168  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.718180656433105  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.78337812423706  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.576446056365967  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.60564947128296  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.5818228721618652  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7303168773651123
pure train time :  2.3515541553497314
train time :  5.39831805229187
end to end time :  78.12146162986755
connection check time:  35.52384805679321
block generation time  32.9913444519043
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.10861349105834961
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0008378028869628906
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 8Thread ID: 6
Thread ID: 5
Thread ID: 3
Thread ID: 10
7

Thread ID: 91

24

11
Time taken by function: 93787 microseconds
Time taken by function: 131073 microseconds
Time taken by function: 146918 microseconds
Time taken by function: 502628 microseconds
Time taken by function: 512590 microseconds
Time taken by function: 528402 microseconds
Time taken by function: 544178 microseconds
Time taken by function: 558573 microseconds
Time taken by function: 563684 microseconds
Time taken by function: 566484 microseconds
Time taken by function: 593752 microseconds
Time taken by function: 617355 microseconds
Openmp Time taken by function: 618079 microseconds
gen-src C++ Time taken by function: 1219258 microseconds
Thread ID: 0
Thread ID: Thread ID: 5
6
Thread ID: Thread ID: Thread ID: 1
3
Thread ID: 8Thread ID: 10

7
Thread ID: Thread ID: Thread ID: 4
11
9
Thread ID: 2
Time taken by function: 666676 microseconds
Time taken by function: 721826 microseconds
Time taken by function: 852472 microseconds
Time taken by function: 1678978 microseconds
Time taken by function: 1697634 microseconds
Time taken by function: 2232459 microseconds
Time taken by function: 2296869 microseconds
Time taken by function: 2297327 microseconds
Time taken by function: 2321110 microseconds
Time taken by function: 2677377 microseconds
Time taken by function: 2685104 microseconds
Time taken by function: 2725998 microseconds
Openmp Time taken by function: 2726215 microseconds
gen-src C++ Time taken by function: 4014140 microseconds

bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028435230255126953
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.10970139503479004
len local_batched_seeds_list  12
partition total batch output list spend :  3.093696117401123
self.buckets_partition() spend  sec:  0.13816356658935547
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.501934289932251

in edges time spent  0.9348268508911133
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.4081008434295654
src gen time  3.4080708026885986
post sort  time  3.0040740966796875e-05
time gen tails  0.5067417621612549
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2571446895599365

in edges time spent  6.657690763473511
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  14.714420557022095
src gen time  14.71435832977295
post sort  time  6.198883056640625e-05
time gen tails  2.5516018867492676
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.460910320281982  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.86013650894165  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.50871181488037  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.821038246154785  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.740352153778076  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.88682794570923  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.836345672607422  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.82478141784668  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.806114196777344  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.81434440612793  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.684863090515137  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.602852821350098  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.5798883438110352  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2332026958465576
pure train time :  2.3518848419189453
train time :  5.346599340438843
end to end time :  75.52254915237427
connection check time:  34.49259948730469
block generation time  31.432655334472656
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 9Thread ID: 7814Thread ID: 
2
11

Thread ID: 6

Thread ID: 
3
5
10

Time taken by function: 77044 microseconds
Time taken by function: 119533 microseconds
Time taken by function: 143069 microseconds
Time taken by function: 149758 microseconds
Time taken by function: 327369 microseconds
Time taken by function: 335254 microseconds
Time taken by function: 1381009 microseconds
Time taken by function: 1454734 microseconds
Time taken by function: 1456715 microseconds
Time taken by function: 1532593 microseconds
Time taken by function: 1539631 microseconds
Time taken by function: 1558881 microseconds
Openmp Time taken by function: 1559658 microseconds
gen-src C++ Time taken by function: 2155782 microseconds
Thread ID: 0
Thread ID: 3
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 105
1Thread ID: 
11
Thread ID: 4Thread ID: Thread ID: 89


2
Thread ID: 7
6

Time taken by function: 794009 microseconds
Time taken by function: 801646 microseconds
Time taken by function: 822875 microseconds
Time taken by function: 881638 microseconds
Time taken by function: 1736068 microseconds
Time taken by function: 1741880 microseconds
Time taken by function: 4240008 microseconds
Time taken by function: 4257373 microseconds
Time taken by function: 4840976 microseconds
Time taken by function: 4852227 microseconds
Time taken by function: 4893524 microseconds
Time taken by function: 4956802 microseconds
Openmp Time taken by function: 4957115 microseconds
gen-src C++ Time taken by function: 6279575 microseconds

G_BUCKET_ID_list length 12
backpack scheduling spend  0.15198945999145508
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0005984306335449219
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025116682052612305
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15276050567626953
len local_batched_seeds_list  12
partition total batch output list spend :  3.2910194396972656
self.buckets_partition() spend  sec:  0.1779029369354248
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.49149632453918457

in edges time spent  0.9636263847351074
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  4.326807498931885
src gen time  4.326775074005127
post sort  time  3.218650817871094e-05
time gen tails  0.5207557678222656
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.320838212966919

in edges time spent  6.6493871212005615
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  17.040193557739258
src gen time  17.04015827178955
post sort  time  3.504753112792969e-05
time gen tails  2.593971014022827
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.518486499786377  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.763790130615234  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.53615140914917  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.942652702331543  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.802830696105957  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.837534427642822  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.814737796783447  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.87051248550415  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.702706336975098  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.740561485290527  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.67741870880127  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.62238597869873  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 0.5785946846008301  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.781855821609497
pure train time :  2.3831787109375
train time :  5.43425726890564
end to end time :  81.37978076934814
connection check time:  38.91363072395325
block generation time  32.811654806137085
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 1
Thread ID: Thread ID: Thread ID: 10
2457
Thread ID: 

3
11
9
Thread ID: 
86

Time taken by function: 102825 microseconds
Time taken by function: 146182 microseconds
Time taken by function: 159698 microseconds
Time taken by function: 159733 microseconds
Time taken by function: 168241 microseconds
Time taken by function: 168332 microseconds
Time taken by function: 168831 microseconds
Time taken by function: 423149 microseconds
Time taken by function: 441039 microseconds
Time taken by function: 515941 microseconds
Time taken by function: 650283 microseconds
Time taken by function: 657283 microseconds
Openmp Time taken by function: 658024 microseconds
gen-src C++ Time taken by function: 1251570 microseconds
Thread ID: 0
Thread ID: 1
Thread ID: Thread ID: Thread ID: Thread ID: 73
Thread ID: 
11
69Thread ID: 
Thread ID: 8
Thread ID: 2
4
Thread ID: 
10
Thread ID: 5
Time taken by function: 778971 microseconds
Time taken by function: 789484 microseconds
Time taken by function: 834556 microseconds
Time taken by function: 930552 microseconds
Time taken by function: 993447 microseconds
Time taken by function: 1013348 microseconds
Time taken by function: 1042406 microseconds
Time taken by function: 1577781 microseconds
Time taken by function: 1623689 microseconds
Time taken by function: 2140787 microseconds
Time taken by function: 2243713 microseconds
Time taken by function: 2269909 microseconds
Openmp Time taken by function: 2270161 microseconds
gen-src C++ Time taken by function: 3558282 microseconds


before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.1520242691040039
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0006589889526367188
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027216672897338867
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15285062789916992
len local_batched_seeds_list  12
partition total batch output list spend :  3.3105010986328125
self.buckets_partition() spend  sec:  0.18009328842163086
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5069243907928467

in edges time spent  0.9817473888397217
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.443532705307007
src gen time  3.443499803543091
post sort  time  3.266334533691406e-05
time gen tails  0.5327785015106201
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2872483730316162

in edges time spent  6.689905405044556
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  14.339531183242798
src gen time  14.339468479156494
post sort  time  6.270408630371094e-05
time gen tails  2.540952205657959
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.52705478668213  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.764275550842285  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.52758550643921  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.849661350250244  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.783466339111328  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.838958740234375  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.873351573944092  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.82433795928955  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.70374822616577  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.77718496322632  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.640406131744385  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.655792713165283  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 0.580390453338623  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5537745952606201
pure train time :  2.334900379180908
train time :  5.30756950378418
end to end time :  75.54022097587585
connection check time:  34.363933801651
block generation time  31.532657861709595
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights, Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: 7
Thread ID: Thread ID: 9
Thread ID: Thread ID: 3
Thread ID: 111
510
8

2Thread ID: Thread ID: 6
4


Time taken by function: 89527 microseconds
Time taken by function: 150596 microseconds
Time taken by function: 158557 microseconds
Time taken by function: 163674 microseconds
Time taken by function: 347207 microseconds
Time taken by function: 351172 microseconds
Time taken by function: 390646 microseconds
Time taken by function: 397160 microseconds
Time taken by function: 757036 microseconds
Time taken by function: 823539 microseconds
Time taken by function: 827054 microseconds
Time taken by function: 848931 microseconds
Openmp Time taken by function: 849817 microseconds
gen-src C++ Time taken by function: 1432615 microseconds
Thread ID: 0
Thread ID: Thread ID: Thread ID: 7
105

Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 68
1
3
4Thread ID: 2
Thread ID: 

9
11
Time taken by function: 670905 microseconds
Time taken by function: 772289 microseconds
Time taken by function: 777975 microseconds
Time taken by function: 779817 microseconds
Time taken by function: 1671466 microseconds
Time taken by function: 1734451 microseconds
Time taken by function: 1878253 microseconds
Time taken by function: 1896358 microseconds
Time taken by function: 2450937 microseconds
Time taken by function: 2499586 microseconds
Time taken by function: 2568834 microseconds
Time taken by function: 2589927 microseconds
Openmp Time taken by function: 2590163 microseconds
gen-src C++ Time taken by function: 3877543 microseconds
 [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.15206074714660645
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0006082057952880859
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025267839431762695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15283703804016113
len local_batched_seeds_list  12
partition total batch output list spend :  3.3274917602539062
self.buckets_partition() spend  sec:  0.1781303882598877
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.492584228515625

in edges time spent  0.9453995227813721
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.6119821071624756
src gen time  3.611931800842285
post sort  time  5.0067901611328125e-05
time gen tails  0.5501108169555664
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.3136634826660156

in edges time spent  6.586114883422852
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  14.35566759109497
src gen time  14.355634450912476
post sort  time  3.2901763916015625e-05
time gen tails  2.54111385345459
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.48859167098999  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.791831016540527  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.468375205993652  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.844243049621582  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.795564651489258  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.85371208190918  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.904996395111084  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.90229368209839  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.825946807861328  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.722527027130127  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.653709888458252  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.624584197998047  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 0.5806097984313965  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3956142663955688
pure train time :  2.3282833099365234
train time :  5.269526481628418
end to end time :  75.20653986930847
connection check time:  34.459989070892334
block generation time  31.249000310897827
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]Thread ID: Thread ID: Thread ID: 0
Thread ID: Thread ID: 11
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 94

187
52


Thread ID: Thread ID: 
63

10
Time taken by function: 91206 microseconds
Time taken by function: 132833 microseconds
Time taken by function: 138100 microseconds
Time taken by function: 166572 microseconds
Time taken by function: 437246 microseconds
Time taken by function: 438592 microseconds
Time taken by function: 446212 microseconds
Time taken by function: 810389 microseconds
Time taken by function: 1069043 microseconds
Time taken by function: 1086929 microseconds
Time taken by function: 1092767 microseconds
Time taken by function: 1099203 microseconds
Openmp Time taken by function: 1099957 microseconds
gen-src C++ Time taken by function: 1668944 microseconds
Thread ID: 0
Thread ID: 8
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 9
Thread ID: Thread ID: 25
Thread ID: 
43

110

Thread ID: 7
Thread ID: 116

Time taken by function: 651002 microseconds
Time taken by function: 794175 microseconds
Time taken by function: 799530 microseconds
Time taken by function: 878344 microseconds
Time taken by function: 2368836 microseconds
Time taken by function: 2422050 microseconds
Time taken by function: 2444915 microseconds
Time taken by function: 4112201 microseconds
Time taken by function: 4379843 microseconds
Time taken by function: 4416741 microseconds
Time taken by function: 4448260 microseconds
Time taken by function: 4491787 microseconds
Openmp Time taken by function: 4492065 microseconds
gen-src C++ Time taken by function: 5760770 microseconds


remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.13106513023376465
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0006844997406005859
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027675151824951172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13190793991088867
len local_batched_seeds_list  12
partition total batch output list spend :  3.2655768394470215
self.buckets_partition() spend  sec:  0.15960907936096191
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.4933910369873047

in edges time spent  0.938840389251709
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.838162899017334
src gen time  3.838130474090576
post sort  time  3.218650817871094e-05
time gen tails  0.5311036109924316
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2671120166778564

in edges time spent  6.6779773235321045
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  16.170543909072876
src gen time  16.170494318008423
post sort  time  4.935264587402344e-05
time gen tails  2.5489792823791504
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.441866397857666  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.807098865509033  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.551509857177734  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.814242362976074  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.848304271697998  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.91984510421753  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.826319217681885  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.86836290359497  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.801230907440186  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.71453285217285  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.668153285980225  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.664196014404297  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 0.5841488838195801  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2753645181655884
pure train time :  2.339520215988159
train time :  5.241867542266846
end to end time :  77.69624328613281
connection check time:  36.567182779312134
block generation time  31.544782876968384
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--Thread ID: Thread ID: Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: 4Thread ID: Thread ID: 6

Thread ID: 51

87Thread ID: 
Thread ID: 9

11
2
103

Time taken by function: 84629 microseconds
Time taken by function: 130812 microseconds
Time taken by function: 145186 microseconds
Time taken by function: 388574 microseconds
Time taken by function: 414149 microseconds
Time taken by function: 468070 microseconds
Time taken by function: 610768 microseconds
Time taken by function: 611214 microseconds
Time taken by function: 631228 microseconds
Time taken by function: 824996 microseconds
Time taken by function: 828867 microseconds
Time taken by function: 832640 microseconds
Openmp Time taken by function: 833370 microseconds
gen-src C++ Time taken by function: 1416031 microseconds
Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: 110
9

Thread ID: 11
Thread ID: 8
6
Thread ID: 4
Thread ID: Thread ID: Thread ID: 5
Thread ID: 2
7
3
Time taken by function: 726124 microseconds
Time taken by function: 826245 microseconds
Time taken by function: 931928 microseconds
Time taken by function: 1578673 microseconds
Time taken by function: 1614055 microseconds
Time taken by function: 2559182 microseconds
Time taken by function: 2605962 microseconds
Time taken by function: 2630280 microseconds
Time taken by function: 2705846 microseconds
Time taken by function: 2744882 microseconds
Time taken by function: 2750451 microseconds
Time taken by function: 2759571 microseconds
Openmp Time taken by function: 2759873 microseconds
gen-src C++ Time taken by function: 4021937 microseconds

type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.15229582786560059
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0004978179931640625
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023923158645629883
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15310001373291016
len local_batched_seeds_list  12
partition total batch output list spend :  3.297199249267578
self.buckets_partition() spend  sec:  0.17704987525939941
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5051212310791016

in edges time spent  0.9572322368621826
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.564016342163086
src gen time  3.5639846324920654
post sort  time  3.123283386230469e-05
time gen tails  0.5074763298034668
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2605071067810059

in edges time spent  6.676812171936035
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  14.539586544036865
src gen time  14.53954553604126
post sort  time  4.076957702636719e-05
time gen tails  2.6155223846435547
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.4710111618042  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.849597454071045  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.520832061767578  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.87170696258545  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.790159702301025  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.892258644104004  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.876925945281982  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.872235774993896  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.762761116027832  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.72687292098999  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.630507946014404  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.632251262664795  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 0.5820479393005371  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes
Thread ID: 0
Thread ID: Thread ID: 10
Thread ID: Thread ID: 5
Thread ID: Thread ID: Thread ID: 1Thread ID: 
239
8
Thread ID: Thread ID: 
Thread ID: 6
4

711

Time taken by function: 99476 microseconds
Time taken by function: 137133 microseconds
Time taken by function: 151143 microseconds
Time taken by function: 156982 microseconds
Time taken by function: 157621 microseconds
Time taken by function: 363599 microseconds
Time taken by function: 365332 microseconds
Time taken by function: 973881 microseconds
Time taken by function: 1225669 microseconds
Time taken by function: 1270343 microseconds
Time taken by function: 1307281 microseconds
Time taken by function: 1318459 microseconds
Openmp Time taken by function: 1319212 microseconds
gen-src C++ Time taken by function: 1898609 microseconds
Thread ID: 1
Thread ID: 0
Thread ID: 6
Thread ID: Thread ID: 10
Thread ID: 8
Thread ID: Thread ID: 11
4
2
Thread ID: Thread ID: 5Thread ID: 9
7

Thread ID: 3
Time taken by function: 776497 microseconds
Time taken by function: 805541 microseconds
Time taken by function: 865480 microseconds
Time taken by function: 927629 microseconds
Time taken by function: 937731 microseconds
Time taken by function: 1584775 microseconds
Time taken by function: 1665552 microseconds
Time taken by function: 3793034 microseconds
Time taken by function: 4113694 microseconds
Time taken by function: 4147416 microseconds
Time taken by function: 4153108 microseconds
Time taken by function: 4190847 microseconds
Openmp Time taken by function: 4191169 microseconds
gen-src C++ Time taken by function: 5466496 microseconds

----------------------------------------------------------pseudo_mini_loss sum 1.1708565950393677
pure train time :  2.3287041187286377
train time :  5.401960611343384
end to end time :  75.38895201683044
connection check time:  34.6908655166626
block generation time  31.115304946899414
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12983393669128418
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0005826950073242188
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02455282211303711
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1305859088897705
len local_batched_seeds_list  12
partition total batch output list spend :  3.3030807971954346
self.buckets_partition() spend  sec:  0.15516376495361328
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.500441312789917

in edges time spent  0.95418381690979
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  4.036365747451782
src gen time  4.036334991455078
post sort  time  3.0279159545898438e-05
time gen tails  0.5071921348571777
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.3084754943847656

in edges time spent  6.689136028289795
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  16.204018354415894
src gen time  16.20395541191101
post sort  time  6.270408630371094e-05
time gen tails  2.6960606575012207
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.443559646606445  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.84291696548462  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.497313499450684  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.81012487411499  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.778822898864746  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.87532949447632  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.895589351654053  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.876752853393555  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.806666374206543  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.71338129043579  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.663180351257324  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.61901330947876  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 0.5777111053466797  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0828452110290527
pure train time :  2.304875612258911
train time :  5.3744683265686035
end to end time :  79.46613311767578
connection check time:  37.15275454521179
block generation time  32.35232758522034
