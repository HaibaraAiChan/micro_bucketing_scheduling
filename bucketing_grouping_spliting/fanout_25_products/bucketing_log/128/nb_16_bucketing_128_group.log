main start at this time 1691632222.6541715
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.31171393394470215
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  16
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0008234977722167969
self.weights_list  [0.003296518815084626, 0.009574148780847632, 0.0038917236011415724, 0.0032812571539036785, 0.006791439225521567, 0.00793097659369897, 0.008368477547552792, 0.0029811111506783806, 0.0029709367098910825, 0.002909890065167293, 0.0028284945388689074, 0.003072681117764065, 0.0031235533217005562, 0.0031286405420942053, 0.0029658494894974335, 0.05823849906649506]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025987863540649414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.31281352043151855
len local_batched_seeds_list  16
partition total batch output list spend :  4.50865364074707
self.buckets_partition() spend  sec:  0.3388233184814453
layer  0
 the number of batches:  16
check_connections_block*********************************

the find indices time spent  0.2576775550842285

in edges time spent  0.08406400680541992
local to global src and eids time spent  0.21817922592163086
time gen tails  0.054743289947509766
res  length 16
layer  1
num of batch  16
check_connections_block*********************************

the find indices time spent  0.5518014430999756

in edges time spent  0.7862493991851807
local to global src and eids time spent  1.6100437641143799
time gen tails  0.34639477729797363
res  length 16
block collection to dataloader spend  2.574920654296875e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 2.4140625 GB
    Memory Allocated: 0.8614482879638672  GigaBytes
Max Memory Allocated: 0.8753395080566406  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 2.4609375 GB
    Memory Allocated: 0.5054702758789062  GigaBytes
Max Memory Allocated: 0.8753395080566406  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 2.4609375 GB
    Memory Allocated: 0.8036313056945801  GigaBytes
Max Memory Allocated: 0.8753395080566406  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 2.5078125 GB
    Memory Allocated: 0.8715333938598633  GigaBytes
Max Memory Allocated: 0.8861098289489746  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 2.5078125 GB
    Memory Allocated: 0.8745837211608887  GigaBytes
Max Memory Allocated: 0.8861098289489746  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 2.525390625 GB
    Memory Allocated: 0.8226985931396484  GigaBytes
Max Memory Allocated: 0.8861098289489746  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 2.52734375 GB
    Memory Allocated: 0.7802762985229492  GigaBytes
Max Memory Allocated: 0.8861098289489746  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 2.52734375 GB
    Memory Allocated: 0.7411885261535645  GigaBytes
Max Memory Allocated: 0.8861098289489746  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 2.52734375 GB
    Memory Allocated: 0.6598343849182129  GigaBytes
Max Memory Allocated: 0.8861098289489746  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 2.52734375 GB
    Memory Allocated: 0.6531081199645996  GigaBytes
Max Memory Allocated: 0.8861098289489746  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 2.52734375 GB
    Memory Allocated: 0.5878300666809082  GigaBytes
Max Memory Allocated: 0.8861098289489746  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 2.52734375 GB
    Memory Allocated: 0.6180400848388672  GigaBytes
Max Memory Allocated: 0.8861098289489746  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 2.52734375 GB
    Memory Allocated: 0.5731654167175293  GigaBytes
Max Memory Allocated: 0.8861098289489746  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 2.52734375 GB
    Memory Allocated: 0.473482608795166  GigaBytes
Max Memory Allocated: 0.8861098289489746  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 2.52734375 GB
    Memory Allocated: 0.40152788162231445  GigaBytes
Max Memory Allocated: 0.8861098289489746  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 18.12109375 GB
    Memory Allocated: 15.884933948516846  GigaBytes
Max Memory Allocated: 16.15251111984253  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 18.12109375 GB
    Memory Allocated: 0.3965272903442383  GigaBytes
Max Memory Allocated: 16.15251111984253  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6601617932319641
pure train time :  1.3872840404510498
train time :  2.4170987606048584
end to end time :  15.22635531425476
connection check time:  5.009489059448242
block generation time  3.177216053009033
Total (block generation + training)time/epoch nan
