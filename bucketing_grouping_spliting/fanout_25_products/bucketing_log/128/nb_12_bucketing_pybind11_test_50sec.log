Thread ID: Thread ID: 100
Thread ID: Thread ID: 6
Thread ID: 5Thread ID: 
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 11
Thread ID: 
1
83
2
7
4
9

Time taken by function: 117086 microseconds
Time taken by function: 163386 microseconds
Time taken by function: 190586 microseconds
Time taken by function: 192902 microseconds
Time taken by function: 193269 microseconds
Time taken by function: 193210 microseconds
Time taken by function: 194270 microseconds
Time taken by function: 194492 microseconds
Time taken by function: 194510 microseconds
Time taken by function: 203761 microseconds
Time taken by function: 203867 microseconds
Time taken by function: 205462 microseconds
Openmp Time taken by function: 206370 microseconds
gen-src C++ Time taken by function: 858145 microseconds
Thread ID: 0
Thread ID: 6
Thread ID: 2Thread ID: Thread ID: 
108

Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 7113
1Thread ID: Thread ID: 5



49

Time taken by function: 801831 microseconds
Time taken by function: 863021 microseconds
Time taken by function: 864665 microseconds
Time taken by function: 987918 microseconds
Time taken by function: 1018941 microseconds
Time taken by function: 1023485 microseconds
Time taken by function: 1030586 microseconds
Time taken by function: 1042720 microseconds
Time taken by function: 1048494 microseconds
Time taken by function: 1104404 microseconds
Time taken by function: 1108254 microseconds
Time taken by function: 1181077 microseconds
Openmp Time taken by function: 1181333 microseconds
gen-src C++ Time taken by function: 2650008 microseconds
main start at this time 1690184990.772341
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.15178298950195312
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0005109310150146484
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023256540298461914
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15257740020751953
len local_batched_seeds_list  12
partition total batch output list spend :  3.2649340629577637
self.buckets_partition() spend  sec:  0.1758561134338379
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.49513840675354004

in edges time spent  0.8938877582550049
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.078439950942993
src gen time  3.0783989429473877
post sort  time  4.076957702636719e-05
time gen tails  0.5413017272949219
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2713923454284668

in edges time spent  6.705127000808716
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  13.627337217330933
src gen time  13.62729525566101
post sort  time  4.1961669921875e-05
time gen tails  2.738377332687378
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.490234375 GB
    Memory Allocated: 20.4821834564209  GigaBytes
Max Memory Allocated: 20.840962886810303  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.798828125 GB
    Memory Allocated: 20.817519187927246  GigaBytes
Max Memory Allocated: 21.183128356933594  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.484375 GB
    Memory Allocated: 20.515573024749756  GigaBytes
Max Memory Allocated: 21.183128356933594  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 20.941368579864502  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 20.782366275787354  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 20.82846212387085  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 20.87297821044922  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes
Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: 5
3Thread ID: Thread ID: Thread ID: Thread ID: 11
Thread ID: 9210
4
Thread ID: 
7
Thread ID: 

8
1
6
Time taken by function: 117157 microseconds
Time taken by function: 175050 microseconds
Time taken by function: 181139 microseconds
Time taken by function: 184008 microseconds
Time taken by function: 185135 microseconds
Time taken by function: 185330 microseconds
Time taken by function: 188054 microseconds
Time taken by function: 188374 microseconds
Time taken by function: 199754 microseconds
Time taken by function: 229975 microseconds
Time taken by function: 501665 microseconds
Time taken by function: 502716 microseconds
Openmp Time taken by function: 503495 microseconds
gen-src C++ Time taken by function: 1131889 microseconds
Thread ID: 0
Thread ID: 1
Thread ID: 8
Thread ID: Thread ID: Thread ID: 5
10Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 11
3624




97

Time taken by function: 652691 microseconds
Time taken by function: 1003608 microseconds
Time taken by function: 1007363 microseconds
Time taken by function: 1008972 microseconds
Time taken by function: 1010377 microseconds
Time taken by function: 1013593 microseconds
Time taken by function: 1032529 microseconds
Time taken by function: 1038320 microseconds
Time taken by function: 1049518 microseconds
Time taken by function: 1056793 microseconds
Time taken by function: 1931998 microseconds
Time taken by function: 1957904 microseconds
Openmp Time taken by function: 1958286 microseconds
gen-src C++ Time taken by function: 3426689 microseconds

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.849356651306152  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.76335048675537  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.74304437637329  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.636141300201416  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 20.59068489074707  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.91796875 GB
    Memory Allocated: 0.5749616622924805  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.207270622253418
pure train time :  3.2129015922546387
train time :  6.585963487625122
end to end time :  80.16589736938477
connection check time:  35.00118660926819
block generation time  34.155781507492065
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.15938282012939453
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0005068778991699219
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03102707862854004
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1600806713104248
len local_batched_seeds_list  12
partition total batch output list spend :  3.3174185752868652
self.buckets_partition() spend  sec:  0.19113373756408691
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.49362611770629883

in edges time spent  0.9276442527770996
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.3515281677246094
src gen time  3.351498603820801
post sort  time  2.9325485229492188e-05
time gen tails  0.5064489841461182
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.277740240097046

in edges time spent  6.827255725860596
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  14.118879318237305
src gen time  14.118820667266846
post sort  time  5.841255187988281e-05
time gen tails  2.5867457389831543
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.92578125 GB
    Memory Allocated: 20.522491931915283  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.845337390899658  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.540568351745605  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes
Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 3
Thread ID: Thread ID: Thread ID: 856

911
4Thread ID: 
2

Thread ID: 
710
Thread ID: 
1
Time taken by function: 86372 microseconds
Time taken by function: 119748 microseconds
Time taken by function: 132152 microseconds
Time taken by function: 378121 microseconds
Time taken by function: 379845 microseconds
Time taken by function: 715448 microseconds
Time taken by function: 715799 microseconds
Time taken by function: 718636 microseconds
Time taken by function: 728878 microseconds
Time taken by function: 934762 microseconds
Time taken by function: 943460 microseconds
Time taken by function: 951685 microseconds
Openmp Time taken by function: 952447 microseconds
gen-src C++ Time taken by function: 1565147 microseconds

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.809085369110107  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.743722915649414  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.909797191619873  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.88086748123169  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.839290618896484  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.7597336769104  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.754043579101562  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.69738483428955  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.628475666046143  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.5766682624816895  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4853670597076416
pure train time :  2.3577656745910645
train time :  5.47693943977356
end to end time :  76.63847088813782
connection check time:  34.21488070487976
block generation time  32.7443163394928
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12860679626464844
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0006532669067382812
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0242006778717041
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12942218780517578
len local_batched_seeds_list  12
partition total batch output list spend :  3.2583165168762207
self.buckets_partition() spend  sec:  0.15364766120910645
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.507897138595581

in edges time spent  0.9461102485656738
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.756289482116699
src gen time  3.756258010864258
post sort  time  3.147125244140625e-05
time gen tails  0.5305304527282715
res  length 12
layer  1
num of batch  12
check_connections_block*********************************Thread ID: 0
Thread ID: 11
Thread ID: 8
Thread ID: Thread ID: Thread ID: 1
Thread ID: 105

6
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 7
249

3

Time taken by function: 725279 microseconds
Time taken by function: 760451 microseconds
Time taken by function: 817659 microseconds
Time taken by function: 1528718 microseconds
Time taken by function: 1570306 microseconds
Time taken by function: 2632915 microseconds
Time taken by function: 2634673 microseconds
Time taken by function: 2654249 microseconds
Time taken by function: 2790286 microseconds
Time taken by function: 2834573 microseconds
Time taken by function: 2836145 microseconds
Time taken by function: 2883851 microseconds
Openmp Time taken by function: 2884090 microseconds
gen-src C++ Time taken by function: 4186468 microseconds


the find indices time spent  1.2960834503173828

in edges time spent  7.134080171585083
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  15.087134838104248
src gen time  15.087077617645264
post sort  time  5.698204040527344e-05
time gen tails  2.620163679122925
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.442606925964355  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.803627490997314  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.52885675430298  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.848805904388428  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.808754444122314  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.876534461975098  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.870455265045166  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.927180290222168  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.718180656433105  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.78337812423706  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.576446056365967  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.60564947128296  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.5818228721618652  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7303168773651123
pure train time :  2.3036601543426514
train time :  5.458619594573975
end to end time :  78.01268815994263
connection check time:  36.77851176261902
block generation time  31.614750862121582
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.1404428482055664
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0007541179656982422
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: 2Thread ID: Thread ID: Thread ID: 7Thread ID: 1154Thread ID: 
8
Thread ID: 1069


3




Thread ID: 1
Time taken by function: 73708 microseconds
Time taken by function: 126359 microseconds
Time taken by function: 152058 microseconds
Time taken by function: 320387 microseconds
Time taken by function: 341905 microseconds
Time taken by function: 349033 microseconds
Time taken by function: 426938 microseconds
Time taken by function: 436696 microseconds
Time taken by function: 441077 microseconds
Time taken by function: 643045 microseconds
Time taken by function: 650127 microseconds
Time taken by function: 651903 microseconds
Openmp Time taken by function: 652801 microseconds
gen-src C++ Time taken by function: 1060268 microseconds
Thread ID: 0
Thread ID: 6
Thread ID: Thread ID: Thread ID: 1Thread ID: Thread ID: 
7
Thread ID: Thread ID: Thread ID: 104
5311

9


Thread ID: 8
Thread ID: 2
Time taken by function: 685844 microseconds
Time taken by function: 911669 microseconds
Time taken by function: 959618 microseconds
Time taken by function: 1978901 microseconds
Time taken by function: 2014536 microseconds
Time taken by function: 2464480 microseconds
Time taken by function: 2521865 microseconds
Time taken by function: 2526780 microseconds
Time taken by function: 2536211 microseconds
Time taken by function: 2564074 microseconds
Time taken by function: 2594888 microseconds
Time taken by function: 2609317 microseconds
Openmp Time taken by function: 2609647 microseconds
gen-src C++ Time taken by function: 3966563 microseconds

bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027998924255371094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.14148235321044922
len local_batched_seeds_list  12
partition total batch output list spend :  3.2817094326019287
self.buckets_partition() spend  sec:  0.1695103645324707
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.494234561920166

in edges time spent  0.7471694946289062
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  2.2293944358825684
src gen time  2.2293550968170166
post sort  time  3.910064697265625e-05
time gen tails  0.5275359153747559
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2915098667144775

in edges time spent  6.938494443893433
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  14.938602447509766
src gen time  14.938546180725098
post sort  time  5.602836608886719e-05
time gen tails  2.5971367359161377
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.460910320281982  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.86013650894165  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.50871181488037  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.821038246154785  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.740352153778076  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.88682794570923  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.836345672607422  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.82478141784668  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.806114196777344  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.81434440612793  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.684863090515137  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.602852821350098  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.5798883438110352  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2332026958465576
pure train time :  2.253066062927246
train time :  5.411250829696655
end to end time :  75.76172399520874
connection check time:  34.55519199371338
block generation time  31.345701456069946
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 5Thread ID: 10
Thread ID: Thread ID: 
Thread ID: 9118
7
21


Thread ID: 
6
Thread ID: 4
3
Time taken by function: 100572 microseconds
Time taken by function: 135695 microseconds
Time taken by function: 154231 microseconds
Time taken by function: 155216 microseconds
Time taken by function: 305832 microseconds
Time taken by function: 307302 microseconds
Time taken by function: 1142558 microseconds
Time taken by function: 1574153 microseconds
Time taken by function: 1574524 microseconds
Time taken by function: 1591670 microseconds
Time taken by function: 1593133 microseconds
Time taken by function: 1595473 microseconds
Openmp Time taken by function: 1596238 microseconds
gen-src C++ Time taken by function: 2199183 microseconds
Thread ID: 0
Thread ID: 9
Thread ID: Thread ID: 10
Thread ID: 5
6
Thread ID: Thread ID: Thread ID: Thread ID: 13

Thread ID: Thread ID: 411

82

Thread ID: 7
Time taken by function: 719315 microseconds
Time taken by function: 800744 microseconds
Time taken by function: 849066 microseconds
Time taken by function: 878044 microseconds
Time taken by function: 1417983 microseconds
Time taken by function: 1430952 microseconds
Time taken by function: 4283794 microseconds
Time taken by function: 4792566 microseconds
Time taken by function: 4841161 microseconds
Time taken by function: 4893614 microseconds
Time taken by function: 4896131 microseconds
Time taken by function: 4901098 microseconds
Openmp Time taken by function: 4901466 microseconds
gen-src C++ Time taken by function: 6203020 microseconds

G_BUCKET_ID_list length 12
backpack scheduling spend  0.15195894241333008
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0006427764892578125
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029331684112548828
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15279507637023926
len local_batched_seeds_list  12
partition total batch output list spend :  3.313666343688965
self.buckets_partition() spend  sec:  0.18215036392211914
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.487027645111084

in edges time spent  0.9648444652557373
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  4.389754295349121
src gen time  4.389715909957886
post sort  time  3.814697265625e-05
time gen tails  0.5385220050811768
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.3107261657714844

in edges time spent  6.691430568695068
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  16.964500665664673
src gen time  16.964467525482178
post sort  time  3.2901763916015625e-05
time gen tails  2.5542185306549072
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.518486499786377  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.763790130615234  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 20.53615140914917  GigaBytes
Max Memory Allocated: 21.308478355407715  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.942652702331543  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.802830696105957  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.837534427642822  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.021484375 GB
    Memory Allocated: 20.814737796783447  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.87051248550415  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.702706336975098  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.740561485290527  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.67741870880127  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.62238597869873  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 0.5785946846008301  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.781855821609497
pure train time :  2.3431410789489746
train time :  5.319986581802368
end to end time :  79.46829557418823
connection check time:  38.750964879989624
block generation time  31.176652431488037
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 111

Thread ID: 010
94
3Thread ID: 


276
Thread ID: 
Thread ID: 8
5

Time taken by function: 90508 microseconds
Time taken by function: 136537 microseconds
Time taken by function: 148206 microseconds
Time taken by function: 342770 microseconds
Time taken by function: 348449 microseconds
Time taken by function: 414965 microseconds
Time taken by function: 441653 microseconds
Time taken by function: 515991 microseconds
Time taken by function: 538176 microseconds
Time taken by function: 541115 microseconds
Time taken by function: 640763 microseconds
Time taken by function: 648191 microseconds
Openmp Time taken by function: 649007 microseconds
gen-src C++ Time taken by function: 1248260 microseconds
Thread ID: 0
Thread ID: 3
Thread ID: 11
Thread ID: 8
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 5Thread ID: 101
9

Thread ID: 6

2
Thread ID: 47

Time taken by function: 707704 microseconds
Time taken by function: 741358 microseconds
Time taken by function: 916303 microseconds
Time taken by function: 1725983 microseconds
Time taken by function: 1744247 microseconds
Time taken by function: 1879046 microseconds
Time taken by function: 1893292 microseconds
Time taken by function: 2172868 microseconds
Time taken by function: 2200873 microseconds
Time taken by function: 2345063 microseconds
Time taken by function: 2359596 microseconds
Time taken by function: 2368064 microseconds
Openmp Time taken by function: 2368334 microseconds
gen-src C++ Time taken by function: 3721418 microseconds


before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.15206122398376465
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.000743865966796875
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024962425231933594
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15297341346740723
len local_batched_seeds_list  12
partition total batch output list spend :  3.3573665618896484
self.buckets_partition() spend  sec:  0.1779615879058838
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5039613246917725

in edges time spent  0.9941384792327881
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.5015077590942383
src gen time  3.501476287841797
post sort  time  3.123283386230469e-05
time gen tails  0.5144252777099609
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2701597213745117

in edges time spent  6.70506477355957
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  14.637606620788574
src gen time  14.637572288513184
post sort  time  3.409385681152344e-05
time gen tails  2.588197946548462
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.02734375 GB
    Memory Allocated: 20.52705478668213  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.764275550842285  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.52758550643921  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.849661350250244  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.783466339111328  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.838958740234375  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.873351573944092  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.82433795928955  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.70374822616577  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.77718496322632  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.640406131744385  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.655792713165283  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 0.580390453338623  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5537745952606201
pure train time :  2.294624090194702
train time :  5.355044603347778
end to end time :  76.96697759628296
connection check time:  35.74103403091431
block generation time  31.541247367858887
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights, Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 3Thread ID: 8Thread ID: 

52
9

Thread ID: Thread ID: Thread ID: 1
4
10
Thread ID: 116

7
Time taken by function: 87514 microseconds
Time taken by function: 131017 microseconds
Time taken by function: 142033 microseconds
Time taken by function: 152422 microseconds
Time taken by function: 156209 microseconds
Time taken by function: 441800 microseconds
Time taken by function: 466893 microseconds
Time taken by function: 522877 microseconds
Time taken by function: 536152 microseconds
Time taken by function: 543674 microseconds
Time taken by function: 643339 microseconds
Time taken by function: 647395 microseconds
Openmp Time taken by function: 648126 microseconds
gen-src C++ Time taken by function: 1243083 microseconds
Thread ID: 0
Thread ID: 11
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 953
101Thread ID: 2
4

6Thread ID: 



7
8
Time taken by function: 710307 microseconds
Time taken by function: 728398 microseconds
Time taken by function: 763957 microseconds
Time taken by function: 876068 microseconds
Time taken by function: 917901 microseconds
Time taken by function: 1629929 microseconds
Time taken by function: 1634830 microseconds
Time taken by function: 1640432 microseconds
Time taken by function: 1666156 microseconds
Time taken by function: 2489106 microseconds
Time taken by function: 2571455 microseconds
Time taken by function: 2593678 microseconds
Openmp Time taken by function: 2593924 microseconds
gen-src C++ Time taken by function: 3891953 microseconds
 [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.152418851852417
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0006763935089111328
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024831771850585938
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1532745361328125
len local_batched_seeds_list  12
partition total batch output list spend :  3.292794942855835
self.buckets_partition() spend  sec:  0.17813372611999512
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.5054402351379395

in edges time spent  0.924924373626709
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.449099540710449
src gen time  3.4490530490875244
post sort  time  4.6253204345703125e-05
time gen tails  0.5497822761535645
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  1.2608931064605713

in edges time spent  6.555171012878418
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  14.328669309616089
src gen time  14.328636407852173
post sort  time  3.2901763916015625e-05
time gen tails  2.5525872707366943
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.48859167098999  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.791831016540527  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.468375205993652  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.844243049621582  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.795564651489258  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.85371208190918  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.904996395111084  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.90229368209839  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.825946807861328  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.722527027130127  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.653709888458252  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.624584197998047  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 0.5806097984313965  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3956142663955688
pure train time :  2.2749826908111572
train time :  5.226223468780518
end to end time :  74.38203740119934
connection check time:  34.12901568412781
block generation time  30.844238996505737
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 816Thread ID: 10
2
43



5Thread ID: 0

119


7
Time taken by function: 86437 microseconds
Time taken by function: 144460 microseconds
Time taken by function: 151566 microseconds
Time taken by function: 160461 microseconds
Time taken by function: 524325 microseconds
Time taken by function: 529137 microseconds
Time taken by function: 534408 microseconds
Time taken by function: 540721 microseconds
Time taken by function: 907808 microseconds
Time taken by function: 911066 microseconds
Time taken by function: 954803 microseconds
Time taken by function: 981879 microseconds
Openmp Time taken by function: 982632 microseconds
gen-src C++ Time taken by function: 1559245 microseconds
Thread ID: 3
Thread ID: 0
Thread ID: 10
Thread ID: Thread ID: 1
7
Thread ID: Thread ID: Thread ID: 6
9Thread ID: 
54

Thread ID: Thread ID: 82
Thread ID: 
11
Time taken by function: 774687 microseconds
Time taken by function: 779448 microseconds
Time taken by function: 925688 microseconds
Time taken by function: 1060724 microseconds
Time taken by function: 1841003 microseconds
Time taken by function: 1949925 microseconds
Time taken by function: 2028444 microseconds
Time taken by function: 2051126 microseconds
Time taken by function: 2467580 microseconds
Time taken by function: 2503093 microseconds
Time taken by function: 2504996 microseconds
Time taken by function: 2527004 microseconds
Openmp Time taken by function: 2527252 microseconds
gen-src C++ Time taken by function: 3895259 microseconds


remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.1301136016845703
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0006344318389892578
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027532339096069336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13090062141418457
len local_batched_seeds_list  12
partition total batch output list spend :  3.3271291255950928
self.buckets_partition() spend  sec:  0.15845775604248047
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.4931681156158447

in edges time spent  0.9243676662445068
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  3.7836878299713135
src gen time  3.7836267948150635
post sort  time  6.079673767089844e-05
time gen tails  0.5395412445068359
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  0.983546257019043

in edges time spent  5.7116053104400635
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  14.567059993743896
src gen time  14.567006826400757
post sort  time  5.316734313964844e-05
time gen tails  1.6493170261383057
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.048828125 GB
    Memory Allocated: 20.441866397857666  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.807098865509033  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.551509857177734  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.814242362976074  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.848304271697998  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.91984510421753  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.826319217681885  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.86836290359497  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.801230907440186  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.71453285217285  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.668153285980225  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.664196014404297  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 0.5841488838195801  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2753645181655884
pure train time :  2.1736457347869873
train time :  5.234186172485352
end to end time :  65.03041958808899
connection check time:  31.262296199798584
block generation time  24.79486083984375
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: 1Thread ID: Thread ID: Thread ID: 57

10Thread ID: Thread ID: 
9
Thread ID: 8

6
Thread ID: 112
4
3

Time taken by function: 80860 microseconds
Time taken by function: 154017 microseconds
Time taken by function: 155552 microseconds
Time taken by function: 163308 microseconds
Time taken by function: 170150 microseconds
Time taken by function: 353755 microseconds
Time taken by function: 355192 microseconds
Time taken by function: 484850 microseconds
Time taken by function: 504192 microseconds
Time taken by function: 666926 microseconds
Time taken by function: 666942 microseconds
Time taken by function: 689096 microseconds
Openmp Time taken by function: 689929 microseconds
gen-src C++ Time taken by function: 1129980 microseconds
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 916

5
0

Thread ID: Thread ID: 2
Thread ID: 11
10
Thread ID: 7
Thread ID: Thread ID: 4
3
Thread ID: 8
Time taken by function: 766991 microseconds
Time taken by function: 772199 microseconds
Time taken by function: 805579 microseconds
Time taken by function: 879915 microseconds
Time taken by function: 1014041 microseconds
Time taken by function: 1212221 microseconds
Time taken by function: 1283732 microseconds
Time taken by function: 1630205 microseconds
Time taken by function: 1681903 microseconds
Time taken by function: 1927207 microseconds
Time taken by function: 1970309 microseconds
Time taken by function: 1975616 microseconds
Openmp Time taken by function: 1975870 microseconds
gen-src C++ Time taken by function: 2884545 microseconds

type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.043279170989990234
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0006058216094970703
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02402329444885254
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04413890838623047
len local_batched_seeds_list  12
partition total batch output list spend :  1.1471035480499268
self.buckets_partition() spend  sec:  0.06818032264709473
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.41167664527893066

in edges time spent  0.5590205192565918
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  2.054507255554199
src gen time  2.054478406906128
post sort  time  2.86102294921875e-05
time gen tails  0.2801511287689209
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  0.9078369140625

in edges time spent  3.7342443466186523
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  8.111850500106812
src gen time  8.111781597137451
post sort  time  6.866455078125e-05
time gen tails  2.6670539379119873
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.4710111618042  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.849597454071045  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.520832061767578  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.87170696258545  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.790159702301025  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.892258644104004  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.876925945281982  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.872235774993896  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.762761116027832  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.72687292098999  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.630507946014404  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.632251262664795  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 0.5820479393005371  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes
Thread ID: Thread ID: Thread ID: Thread ID: 10
Thread ID: Thread ID: 8
0Thread ID: Thread ID: Thread ID: 25
6

4
11
Thread ID: 7Thread ID: 
Thread ID: 9

1
3
Time taken by function: 81890 microseconds
Time taken by function: 142454 microseconds
Time taken by function: 148997 microseconds
Time taken by function: 155392 microseconds
Time taken by function: 161841 microseconds
Time taken by function: 162320 microseconds
Time taken by function: 360841 microseconds
Time taken by function: 367001 microseconds
Time taken by function: 716758 microseconds
Time taken by function: 940904 microseconds
Time taken by function: 944462 microseconds
Time taken by function: 966474 microseconds
Openmp Time taken by function: 967223 microseconds
gen-src C++ Time taken by function: 1366206 microseconds
Thread ID: 0
Thread ID: Thread ID: Thread ID: Thread ID: Thread ID: 10
218

5

Thread ID: Thread ID: Thread ID: Thread ID: 411

9
7Thread ID: 
Thread ID: 6
3
Time taken by function: 693635 microseconds
Time taken by function: 774003 microseconds
Time taken by function: 818842 microseconds
Time taken by function: 863606 microseconds
Time taken by function: 951646 microseconds
Time taken by function: 984140 microseconds
Time taken by function: 1684561 microseconds
Time taken by function: 1769786 microseconds
Time taken by function: 3345210 microseconds
Time taken by function: 3408378 microseconds
Time taken by function: 3410541 microseconds
Time taken by function: 3480218 microseconds
Openmp Time taken by function: 3480509 microseconds
gen-src C++ Time taken by function: 4401686 microseconds

----------------------------------------------------------pseudo_mini_loss sum 1.1708565950393677
pure train time :  2.2535319328308105
train time :  5.376963138580322
end to end time :  61.55030965805054
connection check time:  22.517828464508057
block generation time  31.367642879486084
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  757
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 18, 20]
original bucket_id :,  [6, 5, 3]
remove weights:  [165 132  72], 		------------sum 369

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]

remove bucket_id:  [2, 16, 20]
original bucket_id :,  [21, 7, 0]
remove weights:  [545 181  31], 		------------sum 757

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]

remove bucket_id:  [13, 15, 17]
original bucket_id :,  [9, 4, 2]
remove weights:  [253  95  46], 		------------sum 394

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]

remove bucket_id:  [7, 9]
original bucket_id :,  [15, 13]
remove weights:  [388 362], 		------------sum 750

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]

remove bucket_id:  [6, 9, 12]
original bucket_id :,  [16, 11, 1]
remove weights:  [410 281  53], 		------------sum 744

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 211, 53]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]

remove bucket_id:  [3, 8]
original bucket_id :,  [18, 10]
remove weights:  [455 280], 		------------sum 735

before remove weights,  [595, 583, 494, 455, 448, 427, 383, 331, 280, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 383, 331, 211]

remove bucket_id:  [5, 6]
original bucket_id :,  [14, 12]
remove weights:  [383 331], 		------------sum 714

before remove weights,  [595, 583, 494, 448, 427, 383, 331, 211]
after remove pre pack weights,  [595, 583, 494, 448, 427, 211]

remove bucket_id:  [2, 5]
original bucket_id :,  [20, 8]
remove weights:  [494 211], 		------------sum 705

before remove weights,  [595, 583, 494, 448, 427, 211]
after remove pre pack weights,  [595, 583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 448, 427]
after remove pre pack weights,  [583, 448, 427]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 448, 427]
after remove pre pack weights,  [448, 427]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427]
after remove pre pack weights,  [427]
the last batch value is  427
G_BUCKET_ID_list [[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
[[6, 5, 3], [21, 7, 0], [9, 4, 2], [15, 13], [16, 11, 1], [18, 10], [14, 12], [20, 8], [23], [22], [19], [17]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.05260419845581055
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  0.37026566935182104
current group_mem  0.7584347588007695
current group_mem  0.39532435116664477
current group_mem  0.7508241428893071
current group_mem  0.7452261945490954
current group_mem  0.7368899614021955
current group_mem  0.715350463860951
current group_mem  0.7056665251740037
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
batches output list generation spend  0.0004222393035888672
self.weights_list  [0.08619277512959694, 0.08423928249843568, 0.08516515661007981, 0.08440207355103245, 0.08466152179110856, 0.08388826429127388, 0.08429524192276582, 0.08365425215316603, 0.08102415920964944, 0.08103942087083038, 0.08065279212091306, 0.08078505985114794]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023807525634765625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.053177833557128906
len local_batched_seeds_list  12
partition total batch output list spend :  1.1577832698822021
self.buckets_partition() spend  sec:  0.07700467109680176
layer  0
 the number of batches:  12
check_connections_block*********************************

the find indices time spent  0.41063356399536133

in edges time spent  0.5439658164978027
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  2.31772780418396
src gen time  2.317700147628784
post sort  time  2.7418136596679688e-05
time gen tails  0.30689191818237305
res  length 12
layer  1
num of batch  12
check_connections_block*********************************

the find indices time spent  0.9202940464019775

in edges time spent  3.7689778804779053
src_gen start--=-=-=-=-=
src_gen end--=-=-=-=-=
local to global src and eids time spent  8.724989175796509
src gen time  8.724960565567017
post sort  time  2.8371810913085938e-05
time gen tails  1.664395809173584
res  length 12
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.443559646606445  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.84291696548462  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.497313499450684  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.81012487411499  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.778822898864746  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.87532949447632  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.895589351654053  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.876752853393555  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.806666374206543  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.71338129043579  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.663180351257324  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 20.61901330947876  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.05078125 GB
    Memory Allocated: 0.5777111053466797  GigaBytes
Max Memory Allocated: 21.309787273406982  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0828452110290527
pure train time :  2.1765453815460205
train time :  5.264073848724365
end to end time :  49.34271764755249
connection check time:  21.14619779586792
block generation time  21.38224983215332
end to end time  50.12007761001587
Total (block generation + training)time/epoch 50.12007761001587
