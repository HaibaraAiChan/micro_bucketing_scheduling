main start at this time 1690919231.9032476
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2330
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [14, 22, 23]
original bucket_id :,  [9, 1, 0]
remove weights:  [928  78  33], 		------------sum 1039

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]

remove bucket_id:  [15, 17, 20]
original bucket_id :,  [7, 5, 2]
remove weights:  [704 455 142], 		------------sum 1301

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]

remove bucket_id:  [12, 13, 17]
original bucket_id :,  [10, 11, 3]
remove weights:  [1067 1028  231], 		------------sum 2326

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]

remove bucket_id:  [3, 14]
original bucket_id :,  [20, 4]
remove weights:  [1920  330], 		------------sum 2250

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]

remove bucket_id:  [7, 11]
original bucket_id :,  [15, 8]
remove weights:  [1464  776], 		------------sum 2240

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [2, 8]
original bucket_id :,  [19, 6]
remove weights:  [1676  540], 		------------sum 2216

before remove weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [2194], 		------------sum 2194

before remove weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1367, 1291, 1283]
after remove pre pack weights,  [1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1367], 		------------sum 1367

before remove weights,  [1367, 1291, 1283]
after remove pre pack weights,  [1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1291], 		------------sum 1291

before remove weights,  [1291, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
[[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.09668302536010742
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  15
current group_mem  1.040612693609038
current group_mem  1.3032115802491386
current group_mem  2.3278822272229815
current group_mem  2.2509819308462244
current group_mem  2.2414117447857853
current group_mem  2.232189497508864
current group_mem  2.223171411479282
current group_mem  2.2171902700236266
current group_mem  2.1946883605045633
current group_mem  1.793769060001223
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.367826536234784
current group_mem  1.291814475094105
current group_mem  1.2832128918560093
batches output list generation spend  0.00039839744567871094
self.weights_list  [0.06745654241978725, 0.0695016050180342, 0.07065640404739254, 0.06744128075860631, 0.06825014880119651, 0.0654928753478387, 0.06547761368665775, 0.06843837595576154, 0.06520799100579434, 0.06516729324264516, 0.06502485107162298, 0.06526903765051813, 0.06562005585767992, 0.06573197470634021, 0.06526395043012448]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026109695434570312
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.09732770919799805
len local_batched_seeds_list  15
partition total batch output list spend :  1.996314287185669
self.buckets_partition() spend  sec:  0.12345123291015625
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5015373229980469

in edges time spent  0.9183366298675537
local to global src and eids time spent  2.305548667907715
time gen tails  0.5569686889648438
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.453505516052246

in edges time spent  7.240946292877197
local to global src and eids time spent  16.516902208328247
time gen tails  3.052147626876831
res  length 15
block collection to dataloader spend  3.886222839355469e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 18.951171875 GB
    Memory Allocated: 17.093188285827637  GigaBytes
Max Memory Allocated: 17.381285667419434  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 19.095703125 GB
    Memory Allocated: 17.177786350250244  GigaBytes
Max Memory Allocated: 17.468268394470215  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 19.328125 GB
    Memory Allocated: 17.43910789489746  GigaBytes
Max Memory Allocated: 17.732256412506104  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 20.2421875 GB
    Memory Allocated: 17.384177684783936  GigaBytes
Max Memory Allocated: 17.732256412506104  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 20.2421875 GB
    Memory Allocated: 17.462950229644775  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 20.2421875 GB
    Memory Allocated: 17.38606548309326  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.16015625 GB
    Memory Allocated: 17.442147731781006  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.16015625 GB
    Memory Allocated: 17.458030700683594  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.4453125 GB
    Memory Allocated: 17.43193531036377  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.4453125 GB
    Memory Allocated: 17.322384357452393  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.4453125 GB
    Memory Allocated: 17.27224349975586  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.4453125 GB
    Memory Allocated: 17.28358554840088  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.4453125 GB
    Memory Allocated: 17.31626844406128  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.4453125 GB
    Memory Allocated: 17.294758796691895  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.4453125 GB
    Memory Allocated: 17.216387271881104  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.4453125 GB
    Memory Allocated: 0.5379481315612793  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.213051795959473
pure train time :  3.377305269241333
train time :  7.022402048110962
end to end time :  74.94477534294128
connection check time:  38.00470447540283
block generation time  27.796475172042847
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2330
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [14, 22, 23]
original bucket_id :,  [9, 1, 0]
remove weights:  [928  78  33], 		------------sum 1039

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]

remove bucket_id:  [15, 17, 20]
original bucket_id :,  [7, 5, 2]
remove weights:  [704 455 142], 		------------sum 1301

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]

remove bucket_id:  [12, 13, 17]
original bucket_id :,  [10, 11, 3]
remove weights:  [1067 1028  231], 		------------sum 2326

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]

remove bucket_id:  [3, 14]
original bucket_id :,  [20, 4]
remove weights:  [1920  330], 		------------sum 2250

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]

remove bucket_id:  [7, 11]
original bucket_id :,  [15, 8]
remove weights:  [1464  776], 		------------sum 2240

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [2, 8]
original bucket_id :,  [19, 6]
remove weights:  [1676  540], 		------------sum 2216

before remove weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [2194], 		------------sum 2194

before remove weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1367, 1291, 1283]
after remove pre pack weights,  [1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1367], 		------------sum 1367

before remove weights,  [1367, 1291, 1283]
after remove pre pack weights,  [1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1291], 		------------sum 1291

before remove weights,  [1291, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
[[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.3328666687011719
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  15
current group_mem  1.040612693609038
current group_mem  1.3032115802491386
current group_mem  2.3278822272229815
current group_mem  2.2509819308462244
current group_mem  2.2414117447857853
current group_mem  2.232189497508864
current group_mem  2.223171411479282
current group_mem  2.2171902700236266
current group_mem  2.1946883605045633
current group_mem  1.793769060001223
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.367826536234784
current group_mem  1.291814475094105
current group_mem  1.2832128918560093
batches output list generation spend  0.0006620883941650391
self.weights_list  [0.06745654241978725, 0.0695016050180342, 0.07065640404739254, 0.06744128075860631, 0.06825014880119651, 0.0654928753478387, 0.06547761368665775, 0.06843837595576154, 0.06520799100579434, 0.06516729324264516, 0.06502485107162298, 0.06526903765051813, 0.06562005585767992, 0.06573197470634021, 0.06526395043012448]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026760578155517578
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.33376407623291016
len local_batched_seeds_list  15
partition total batch output list spend :  4.2465386390686035
self.buckets_partition() spend  sec:  0.3605518341064453
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.48998188972473145

in edges time spent  0.899104118347168
local to global src and eids time spent  2.285736322402954
time gen tails  0.5566260814666748
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3735320568084717

in edges time spent  7.122908353805542
local to global src and eids time spent  16.235349416732788
time gen tails  3.160227060317993
res  length 15
block collection to dataloader spend  2.7179718017578125e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.4453125 GB
    Memory Allocated: 17.128536224365234  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.451171875 GB
    Memory Allocated: 17.17132329940796  GigaBytes
Max Memory Allocated: 17.755867958068848  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 19.853515625 GB
    Memory Allocated: 17.464852809906006  GigaBytes
Max Memory Allocated: 17.758052349090576  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 20.7734375 GB
    Memory Allocated: 17.44191598892212  GigaBytes
Max Memory Allocated: 17.758052349090576  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 20.7734375 GB
    Memory Allocated: 17.366387844085693  GigaBytes
Max Memory Allocated: 17.758052349090576  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 20.7734375 GB
    Memory Allocated: 17.360235691070557  GigaBytes
Max Memory Allocated: 17.758052349090576  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.708984375 GB
    Memory Allocated: 17.489410877227783  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.708984375 GB
    Memory Allocated: 17.439191818237305  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.708984375 GB
    Memory Allocated: 17.425498962402344  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.708984375 GB
    Memory Allocated: 17.34297800064087  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.708984375 GB
    Memory Allocated: 17.294642448425293  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.708984375 GB
    Memory Allocated: 17.340508937835693  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.708984375 GB
    Memory Allocated: 17.3115234375  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 21.708984375 GB
    Memory Allocated: 17.33306121826172  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 21.708984375 GB
    Memory Allocated: 17.233657836914062  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.708984375 GB
    Memory Allocated: 0.5422248840332031  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4706006050109863
pure train time :  2.752268075942993
train time :  6.049420595169067
end to end time :  73.96814918518066
connection check time:  37.093122482299805
block generation time  26.443645000457764
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2330
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [14, 22, 23]
original bucket_id :,  [9, 1, 0]
remove weights:  [928  78  33], 		------------sum 1039

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]

remove bucket_id:  [15, 17, 20]
original bucket_id :,  [7, 5, 2]
remove weights:  [704 455 142], 		------------sum 1301

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]

remove bucket_id:  [12, 13, 17]
original bucket_id :,  [10, 11, 3]
remove weights:  [1067 1028  231], 		------------sum 2326

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]

remove bucket_id:  [3, 14]
original bucket_id :,  [20, 4]
remove weights:  [1920  330], 		------------sum 2250

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]

remove bucket_id:  [7, 11]
original bucket_id :,  [15, 8]
remove weights:  [1464  776], 		------------sum 2240

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [2, 8]
original bucket_id :,  [19, 6]
remove weights:  [1676  540], 		------------sum 2216

before remove weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [2194], 		------------sum 2194

before remove weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1367, 1291, 1283]
after remove pre pack weights,  [1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1367], 		------------sum 1367

before remove weights,  [1367, 1291, 1283]
after remove pre pack weights,  [1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1291], 		------------sum 1291

before remove weights,  [1291, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
[[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.3225874900817871
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  15
current group_mem  1.040612693609038
current group_mem  1.3032115802491386
current group_mem  2.3278822272229815
current group_mem  2.2509819308462244
current group_mem  2.2414117447857853
current group_mem  2.232189497508864
current group_mem  2.223171411479282
current group_mem  2.2171902700236266
current group_mem  2.1946883605045633
current group_mem  1.793769060001223
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.367826536234784
current group_mem  1.291814475094105
current group_mem  1.2832128918560093
batches output list generation spend  0.0006964206695556641
self.weights_list  [0.06745654241978725, 0.0695016050180342, 0.07065640404739254, 0.06744128075860631, 0.06825014880119651, 0.0654928753478387, 0.06547761368665775, 0.06843837595576154, 0.06520799100579434, 0.06516729324264516, 0.06502485107162298, 0.06526903765051813, 0.06562005585767992, 0.06573197470634021, 0.06526395043012448]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023639440536499023
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3234701156616211
len local_batched_seeds_list  15
partition total batch output list spend :  4.348147869110107
self.buckets_partition() spend  sec:  0.3471341133117676
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5159661769866943

in edges time spent  0.9209184646606445
local to global src and eids time spent  2.2346913814544678
time gen tails  0.5506072044372559
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3956515789031982

in edges time spent  7.393113374710083
local to global src and eids time spent  16.809213161468506
time gen tails  3.027092456817627
res  length 15
block collection to dataloader spend  2.765655517578125e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.708984375 GB
    Memory Allocated: 17.06290054321289  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.7109375 GB
    Memory Allocated: 17.176236629486084  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.437315464019775  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.381345748901367  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.435505390167236  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.412009716033936  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.42692470550537  GigaBytes
Max Memory Allocated: 17.782959461212158  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.49362325668335  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.397122859954834  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.418834686279297  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.28772783279419  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.303919315338135  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.298508167266846  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.222707748413086  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.234086990356445  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 0.5442285537719727  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.736602783203125
pure train time :  2.5179402828216553
train time :  5.822999954223633
end to end time :  75.52356743812561
connection check time:  38.54426121711731
block generation time  26.699427604675293
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2330
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [14, 22, 23]
original bucket_id :,  [9, 1, 0]
remove weights:  [928  78  33], 		------------sum 1039

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]

remove bucket_id:  [15, 17, 20]
original bucket_id :,  [7, 5, 2]
remove weights:  [704 455 142], 		------------sum 1301

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]

remove bucket_id:  [12, 13, 17]
original bucket_id :,  [10, 11, 3]
remove weights:  [1067 1028  231], 		------------sum 2326

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]

remove bucket_id:  [3, 14]
original bucket_id :,  [20, 4]
remove weights:  [1920  330], 		------------sum 2250

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]

remove bucket_id:  [7, 11]
original bucket_id :,  [15, 8]
remove weights:  [1464  776], 		------------sum 2240

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [2, 8]
original bucket_id :,  [19, 6]
remove weights:  [1676  540], 		------------sum 2216

before remove weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [2194], 		------------sum 2194

before remove weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1367, 1291, 1283]
after remove pre pack weights,  [1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1367], 		------------sum 1367

before remove weights,  [1367, 1291, 1283]
after remove pre pack weights,  [1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1291], 		------------sum 1291

before remove weights,  [1291, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
[[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.2998640537261963
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  15
current group_mem  1.040612693609038
current group_mem  1.3032115802491386
current group_mem  2.3278822272229815
current group_mem  2.2509819308462244
current group_mem  2.2414117447857853
current group_mem  2.232189497508864
current group_mem  2.223171411479282
current group_mem  2.2171902700236266
current group_mem  2.1946883605045633
current group_mem  1.793769060001223
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.367826536234784
current group_mem  1.291814475094105
current group_mem  1.2832128918560093
batches output list generation spend  0.0006546974182128906
self.weights_list  [0.06745654241978725, 0.0695016050180342, 0.07065640404739254, 0.06744128075860631, 0.06825014880119651, 0.0654928753478387, 0.06547761368665775, 0.06843837595576154, 0.06520799100579434, 0.06516729324264516, 0.06502485107162298, 0.06526903765051813, 0.06562005585767992, 0.06573197470634021, 0.06526395043012448]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026792049407958984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3007078170776367
len local_batched_seeds_list  15
partition total batch output list spend :  4.2508769035339355
self.buckets_partition() spend  sec:  0.327526330947876
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5025949478149414

in edges time spent  0.9152417182922363
local to global src and eids time spent  2.2450292110443115
time gen tails  0.5443859100341797
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.323282241821289

in edges time spent  7.192193269729614
local to global src and eids time spent  15.988879919052124
time gen tails  3.3232264518737793
res  length 15
block collection to dataloader spend  4.076957702636719e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.712890625 GB
    Memory Allocated: 17.068047046661377  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.71484375 GB
    Memory Allocated: 17.195380687713623  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.716796875 GB
    Memory Allocated: 17.46599769592285  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.716796875 GB
    Memory Allocated: 17.411198616027832  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.716796875 GB
    Memory Allocated: 17.391144275665283  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.716796875 GB
    Memory Allocated: 17.352284908294678  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.716796875 GB
    Memory Allocated: 17.477182865142822  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.716796875 GB
    Memory Allocated: 17.472657203674316  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.6328125 GB
    Memory Allocated: 17.42651891708374  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.6328125 GB
    Memory Allocated: 17.28126096725464  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.6328125 GB
    Memory Allocated: 17.32335901260376  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.6328125 GB
    Memory Allocated: 17.373443126678467  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.6328125 GB
    Memory Allocated: 17.33821725845337  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.6328125 GB
    Memory Allocated: 17.26701021194458  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.6328125 GB
    Memory Allocated: 17.252803802490234  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.6328125 GB
    Memory Allocated: 0.5391635894775391  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.231914758682251
pure train time :  2.681870698928833
train time :  5.984321117401123
end to end time :  75.52948212623596
connection check time:  37.633177042007446
block generation time  27.539965867996216
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2330
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [14, 22, 23]
original bucket_id :,  [9, 1, 0]
remove weights:  [928  78  33], 		------------sum 1039

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]

remove bucket_id:  [15, 17, 20]
original bucket_id :,  [7, 5, 2]
remove weights:  [704 455 142], 		------------sum 1301

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]

remove bucket_id:  [12, 13, 17]
original bucket_id :,  [10, 11, 3]
remove weights:  [1067 1028  231], 		------------sum 2326

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]

remove bucket_id:  [3, 14]
original bucket_id :,  [20, 4]
remove weights:  [1920  330], 		------------sum 2250

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]

remove bucket_id:  [7, 11]
original bucket_id :,  [15, 8]
remove weights:  [1464  776], 		------------sum 2240

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [2, 8]
original bucket_id :,  [19, 6]
remove weights:  [1676  540], 		------------sum 2216

before remove weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [2194], 		------------sum 2194

before remove weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1367, 1291, 1283]
after remove pre pack weights,  [1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1367], 		------------sum 1367

before remove weights,  [1367, 1291, 1283]
after remove pre pack weights,  [1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1291], 		------------sum 1291

before remove weights,  [1291, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
[[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.27789759635925293
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  15
current group_mem  1.040612693609038
current group_mem  1.3032115802491386
current group_mem  2.3278822272229815
current group_mem  2.2509819308462244
current group_mem  2.2414117447857853
current group_mem  2.232189497508864
current group_mem  2.223171411479282
current group_mem  2.2171902700236266
current group_mem  2.1946883605045633
current group_mem  1.793769060001223
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.367826536234784
current group_mem  1.291814475094105
current group_mem  1.2832128918560093
batches output list generation spend  0.0007803440093994141
self.weights_list  [0.06745654241978725, 0.0695016050180342, 0.07065640404739254, 0.06744128075860631, 0.06825014880119651, 0.0654928753478387, 0.06547761368665775, 0.06843837595576154, 0.06520799100579434, 0.06516729324264516, 0.06502485107162298, 0.06526903765051813, 0.06562005585767992, 0.06573197470634021, 0.06526395043012448]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029003381729125977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.27886319160461426
len local_batched_seeds_list  15
partition total batch output list spend :  4.273696422576904
self.buckets_partition() spend  sec:  0.3078927993774414
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5135941505432129

in edges time spent  0.933739423751831
local to global src and eids time spent  2.239152193069458
time gen tails  0.5532300472259521
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3847317695617676

in edges time spent  7.091430902481079
local to global src and eids time spent  16.397229433059692
time gen tails  3.010812997817993
res  length 15
block collection to dataloader spend  2.5033950805664062e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.6328125 GB
    Memory Allocated: 17.09970998764038  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.640625 GB
    Memory Allocated: 17.126963138580322  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.47494411468506  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.383048057556152  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.486599445343018  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.426641941070557  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.427698135375977  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.414153575897217  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.389251232147217  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.383697986602783  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.23890733718872  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.34207057952881  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.305452823638916  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.28421401977539  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.249828338623047  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 0.5463380813598633  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7796756029129028
pure train time :  2.5131683349609375
train time :  5.984908819198608
end to end time :  74.83196473121643
connection check time:  37.07235646247864
block generation time  27.392462968826294
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2330
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [14, 22, 23]
original bucket_id :,  [9, 1, 0]
remove weights:  [928  78  33], 		------------sum 1039

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]

remove bucket_id:  [15, 17, 20]
original bucket_id :,  [7, 5, 2]
remove weights:  [704 455 142], 		------------sum 1301

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]

remove bucket_id:  [12, 13, 17]
original bucket_id :,  [10, 11, 3]
remove weights:  [1067 1028  231], 		------------sum 2326

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]

remove bucket_id:  [3, 14]
original bucket_id :,  [20, 4]
remove weights:  [1920  330], 		------------sum 2250

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]

remove bucket_id:  [7, 11]
original bucket_id :,  [15, 8]
remove weights:  [1464  776], 		------------sum 2240

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [2, 8]
original bucket_id :,  [19, 6]
remove weights:  [1676  540], 		------------sum 2216

before remove weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [2194], 		------------sum 2194

before remove weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1367, 1291, 1283]
after remove pre pack weights,  [1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1367], 		------------sum 1367

before remove weights,  [1367, 1291, 1283]
after remove pre pack weights,  [1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1291], 		------------sum 1291

before remove weights,  [1291, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
[[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.27931690216064453
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  15
current group_mem  1.040612693609038
current group_mem  1.3032115802491386
current group_mem  2.3278822272229815
current group_mem  2.2509819308462244
current group_mem  2.2414117447857853
current group_mem  2.232189497508864
current group_mem  2.223171411479282
current group_mem  2.2171902700236266
current group_mem  2.1946883605045633
current group_mem  1.793769060001223
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.367826536234784
current group_mem  1.291814475094105
current group_mem  1.2832128918560093
batches output list generation spend  0.0005271434783935547
self.weights_list  [0.06745654241978725, 0.0695016050180342, 0.07065640404739254, 0.06744128075860631, 0.06825014880119651, 0.0654928753478387, 0.06547761368665775, 0.06843837595576154, 0.06520799100579434, 0.06516729324264516, 0.06502485107162298, 0.06526903765051813, 0.06562005585767992, 0.06573197470634021, 0.06526395043012448]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02809429168701172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.2800328731536865
len local_batched_seeds_list  15
partition total batch output list spend :  4.249606132507324
self.buckets_partition() spend  sec:  0.3081533908843994
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5091750621795654

in edges time spent  0.9142653942108154
local to global src and eids time spent  2.240304946899414
time gen tails  0.5727267265319824
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3245158195495605

in edges time spent  7.060025691986084
local to global src and eids time spent  15.458995342254639
time gen tails  2.9360342025756836
res  length 15
block collection to dataloader spend  3.361701965332031e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.127956867218018  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.156583786010742  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.46771001815796  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.39919662475586  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.404513359069824  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.393900394439697  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.424248695373535  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.46974802017212  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.401862144470215  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.321516513824463  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.248660564422607  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.333725929260254  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.33599328994751  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.261815071105957  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.292444229125977  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 0.5419607162475586  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.551963210105896
pure train time :  2.4816038608551025
train time :  5.691986083984375
end to end time :  71.96086478233337
connection check time:  35.508535861968994
block generation time  26.394810676574707
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2330
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [14, 22, 23]
original bucket_id :,  [9, 1, 0]
remove weights:  [928  78  33], 		------------sum 1039

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]

remove bucket_id:  [15, 17, 20]
original bucket_id :,  [7, 5, 2]
remove weights:  [704 455 142], 		------------sum 1301

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]

remove bucket_id:  [12, 13, 17]
original bucket_id :,  [10, 11, 3]
remove weights:  [1067 1028  231], 		------------sum 2326

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]

remove bucket_id:  [3, 14]
original bucket_id :,  [20, 4]
remove weights:  [1920  330], 		------------sum 2250

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]

remove bucket_id:  [7, 11]
original bucket_id :,  [15, 8]
remove weights:  [1464  776], 		------------sum 2240

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [2, 8]
original bucket_id :,  [19, 6]
remove weights:  [1676  540], 		------------sum 2216

before remove weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [2194], 		------------sum 2194

before remove weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1367, 1291, 1283]
after remove pre pack weights,  [1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1367], 		------------sum 1367

before remove weights,  [1367, 1291, 1283]
after remove pre pack weights,  [1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1291], 		------------sum 1291

before remove weights,  [1291, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
[[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.29795360565185547
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  15
current group_mem  1.040612693609038
current group_mem  1.3032115802491386
current group_mem  2.3278822272229815
current group_mem  2.2509819308462244
current group_mem  2.2414117447857853
current group_mem  2.232189497508864
current group_mem  2.223171411479282
current group_mem  2.2171902700236266
current group_mem  2.1946883605045633
current group_mem  1.793769060001223
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.367826536234784
current group_mem  1.291814475094105
current group_mem  1.2832128918560093
batches output list generation spend  0.0007929801940917969
self.weights_list  [0.06745654241978725, 0.0695016050180342, 0.07065640404739254, 0.06744128075860631, 0.06825014880119651, 0.0654928753478387, 0.06547761368665775, 0.06843837595576154, 0.06520799100579434, 0.06516729324264516, 0.06502485107162298, 0.06526903765051813, 0.06562005585767992, 0.06573197470634021, 0.06526395043012448]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02478313446044922
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.29894256591796875
len local_batched_seeds_list  15
partition total batch output list spend :  2.034578323364258
self.buckets_partition() spend  sec:  0.32375049591064453
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.41670656204223633

in edges time spent  0.671952486038208
local to global src and eids time spent  2.2304141521453857
time gen tails  0.5563092231750488
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3617184162139893

in edges time spent  7.0553858280181885
local to global src and eids time spent  15.985268592834473
time gen tails  2.936915397644043
res  length 15
block collection to dataloader spend  3.695487976074219e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.123382568359375  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.137491703033447  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.429813861846924  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.304834365844727  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.4280104637146  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.397572994232178  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.426779747009277  GigaBytes
Max Memory Allocated: 17.786747455596924  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.517723560333252  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.423855304718018  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.377530574798584  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.350250720977783  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.337392330169678  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.27008819580078  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.290235996246338  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.23486042022705  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 0.5384244918823242  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3945029973983765
pure train time :  2.4227137565612793
train time :  5.682404518127441
end to end time :  69.41800618171692
connection check time:  35.854549407958984
block generation time  25.741188764572144
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2330
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [14, 22, 23]
original bucket_id :,  [9, 1, 0]
remove weights:  [928  78  33], 		------------sum 1039

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]

remove bucket_id:  [15, 17, 20]
original bucket_id :,  [7, 5, 2]
remove weights:  [704 455 142], 		------------sum 1301

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]

remove bucket_id:  [12, 13, 17]
original bucket_id :,  [10, 11, 3]
remove weights:  [1067 1028  231], 		------------sum 2326

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]

remove bucket_id:  [3, 14]
original bucket_id :,  [20, 4]
remove weights:  [1920  330], 		------------sum 2250

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]

remove bucket_id:  [7, 11]
original bucket_id :,  [15, 8]
remove weights:  [1464  776], 		------------sum 2240

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [2, 8]
original bucket_id :,  [19, 6]
remove weights:  [1676  540], 		------------sum 2216

before remove weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [2194], 		------------sum 2194

before remove weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1367, 1291, 1283]
after remove pre pack weights,  [1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1367], 		------------sum 1367

before remove weights,  [1367, 1291, 1283]
after remove pre pack weights,  [1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1291], 		------------sum 1291

before remove weights,  [1291, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
[[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.32023072242736816
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  15
current group_mem  1.040612693609038
current group_mem  1.3032115802491386
current group_mem  2.3278822272229815
current group_mem  2.2509819308462244
current group_mem  2.2414117447857853
current group_mem  2.232189497508864
current group_mem  2.223171411479282
current group_mem  2.2171902700236266
current group_mem  2.1946883605045633
current group_mem  1.793769060001223
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.367826536234784
current group_mem  1.291814475094105
current group_mem  1.2832128918560093
batches output list generation spend  0.0005161762237548828
self.weights_list  [0.06745654241978725, 0.0695016050180342, 0.07065640404739254, 0.06744128075860631, 0.06825014880119651, 0.0654928753478387, 0.06547761368665775, 0.06843837595576154, 0.06520799100579434, 0.06516729324264516, 0.06502485107162298, 0.06526903765051813, 0.06562005585767992, 0.06573197470634021, 0.06526395043012448]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025723934173583984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3209362030029297
len local_batched_seeds_list  15
partition total batch output list spend :  4.252502679824829
self.buckets_partition() spend  sec:  0.34668660163879395
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5020499229431152

in edges time spent  0.9024431705474854
local to global src and eids time spent  2.2377102375030518
time gen tails  0.5517518520355225
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.318161964416504

in edges time spent  7.033475160598755
local to global src and eids time spent  15.954121351242065
time gen tails  2.9326839447021484
res  length 15
block collection to dataloader spend  3.0040740966796875e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.069557666778564  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.161171913146973  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.428911209106445  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.43342876434326  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.369274139404297  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.444851398468018  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.443718433380127  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.48449182510376  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.43364667892456  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.349456787109375  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.34577751159668  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.288476943969727  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.256425380706787  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.346760749816895  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.256248474121094  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 0.5476851463317871  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2746106386184692
pure train time :  2.5441834926605225
train time :  5.624787092208862
end to end time :  71.39460110664368
connection check time:  35.857935667037964
block generation time  25.54960298538208
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2330
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [14, 22, 23]
original bucket_id :,  [9, 1, 0]
remove weights:  [928  78  33], 		------------sum 1039

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]

remove bucket_id:  [15, 17, 20]
original bucket_id :,  [7, 5, 2]
remove weights:  [704 455 142], 		------------sum 1301

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]

remove bucket_id:  [12, 13, 17]
original bucket_id :,  [10, 11, 3]
remove weights:  [1067 1028  231], 		------------sum 2326

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]

remove bucket_id:  [3, 14]
original bucket_id :,  [20, 4]
remove weights:  [1920  330], 		------------sum 2250

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]

remove bucket_id:  [7, 11]
original bucket_id :,  [15, 8]
remove weights:  [1464  776], 		------------sum 2240

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [2, 8]
original bucket_id :,  [19, 6]
remove weights:  [1676  540], 		------------sum 2216

before remove weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [2194], 		------------sum 2194

before remove weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1367, 1291, 1283]
after remove pre pack weights,  [1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1367], 		------------sum 1367

before remove weights,  [1367, 1291, 1283]
after remove pre pack weights,  [1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1291], 		------------sum 1291

before remove weights,  [1291, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
[[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.3432021141052246
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  15
current group_mem  1.040612693609038
current group_mem  1.3032115802491386
current group_mem  2.3278822272229815
current group_mem  2.2509819308462244
current group_mem  2.2414117447857853
current group_mem  2.232189497508864
current group_mem  2.223171411479282
current group_mem  2.2171902700236266
current group_mem  2.1946883605045633
current group_mem  1.793769060001223
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.367826536234784
current group_mem  1.291814475094105
current group_mem  1.2832128918560093
batches output list generation spend  0.0009031295776367188
self.weights_list  [0.06745654241978725, 0.0695016050180342, 0.07065640404739254, 0.06744128075860631, 0.06825014880119651, 0.0654928753478387, 0.06547761368665775, 0.06843837595576154, 0.06520799100579434, 0.06516729324264516, 0.06502485107162298, 0.06526903765051813, 0.06562005585767992, 0.06573197470634021, 0.06526395043012448]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024705171585083008
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3443782329559326
len local_batched_seeds_list  15
partition total batch output list spend :  4.335149526596069
self.buckets_partition() spend  sec:  0.3691439628601074
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.539492130279541

in edges time spent  0.9400813579559326
local to global src and eids time spent  2.0448784828186035
time gen tails  0.5371060371398926
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3615517616271973

in edges time spent  7.1989898681640625
local to global src and eids time spent  16.243462085723877
time gen tails  3.074223041534424
res  length 15
block collection to dataloader spend  2.956390380859375e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.578125 GB
    Memory Allocated: 17.070600509643555  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.17444086074829  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.433249473571777  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.389480113983154  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.45171594619751  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.397645473480225  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.474935054779053  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.45771884918213  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.42917251586914  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.340018272399902  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.285562992095947  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.31587553024292  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.280616283416748  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.252115726470947  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.231021881103516  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 0.5388188362121582  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1750755310058594
pure train time :  2.52136492729187
train time :  5.809023380279541
end to end time :  75.0436782836914
connection check time:  37.42276215553284
block generation time  27.352026224136353
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2330
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [14, 22, 23]
original bucket_id :,  [9, 1, 0]
remove weights:  [928  78  33], 		------------sum 1039

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]

remove bucket_id:  [15, 17, 20]
original bucket_id :,  [7, 5, 2]
remove weights:  [704 455 142], 		------------sum 1301

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 704, 540, 455, 330, 231, 142]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]

remove bucket_id:  [12, 13, 17]
original bucket_id :,  [10, 11, 3]
remove weights:  [1067 1028  231], 		------------sum 2326

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 776, 540, 330, 231]
after remove pre pack weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]

remove bucket_id:  [3, 14]
original bucket_id :,  [20, 4]
remove weights:  [1920  330], 		------------sum 2250

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540, 330]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]

remove bucket_id:  [7, 11]
original bucket_id :,  [15, 8]
remove weights:  [1464  776], 		------------sum 2240

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 776, 540]
after remove pre pack weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]

remove bucket_id:  [2, 8]
original bucket_id :,  [19, 6]
remove weights:  [1676  540], 		------------sum 2216

before remove weights,  [2194, 1793, 1676, 1656, 1599, 1367, 1291, 1283, 540]
after remove pre pack weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [2194], 		------------sum 2194

before remove weights,  [2194, 1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1793, 1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1656, 1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1367, 1291, 1283]
after remove pre pack weights,  [1599, 1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1367, 1291, 1283]
after remove pre pack weights,  [1367, 1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1367], 		------------sum 1367

before remove weights,  [1367, 1291, 1283]
after remove pre pack weights,  [1291, 1283]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1291], 		------------sum 1291

before remove weights,  [1291, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
[[9, 1, 0], [7, 5, 2], [10, 11, 3], [20, 4], [15, 8], [22], [23], [19, 6], [21], [18], [16], [17], [14], [13], [12]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.3238394260406494
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  15
current group_mem  1.040612693609038
current group_mem  1.3032115802491386
current group_mem  2.3278822272229815
current group_mem  2.2509819308462244
current group_mem  2.2414117447857853
current group_mem  2.232189497508864
current group_mem  2.223171411479282
current group_mem  2.2171902700236266
current group_mem  2.1946883605045633
current group_mem  1.793769060001223
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.367826536234784
current group_mem  1.291814475094105
current group_mem  1.2832128918560093
batches output list generation spend  0.0006325244903564453
self.weights_list  [0.06745654241978725, 0.0695016050180342, 0.07065640404739254, 0.06744128075860631, 0.06825014880119651, 0.0654928753478387, 0.06547761368665775, 0.06843837595576154, 0.06520799100579434, 0.06516729324264516, 0.06502485107162298, 0.06526903765051813, 0.06562005585767992, 0.06573197470634021, 0.06526395043012448]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024956703186035156
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.32468247413635254
len local_batched_seeds_list  15
partition total batch output list spend :  4.262855291366577
self.buckets_partition() spend  sec:  0.3496668338775635
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.628739595413208

in edges time spent  0.9505860805511475
local to global src and eids time spent  2.2953295707702637
time gen tails  0.5743706226348877
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.380242109298706

in edges time spent  7.266240835189819
local to global src and eids time spent  16.3527569770813
time gen tails  3.204921007156372
res  length 15
block collection to dataloader spend  3.0517578125e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.07051944732666  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.17213487625122  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.39060068130493  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.38759756088257  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.359261989593506  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.405550003051758  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.423054695129395  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.476059913635254  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.441225051879883  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.38407802581787  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.325257301330566  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.314709186553955  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.274110317230225  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.307783126831055  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 17.245587825775146  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.580078125 GB
    Memory Allocated: 0.5393838882446289  GigaBytes
Max Memory Allocated: 17.810461044311523  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0791789293289185
pure train time :  2.50052809715271
train time :  5.795077085494995
end to end time :  74.86874723434448
connection check time:  38.0964412689209
block generation time  26.60900115966797
end to end time  75.68459868431091
Total (block generation + training)time/epoch 75.68459868431091
