main start at this time 1691636293.6431985
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
11.127620995044708
24
the grouping_fanout_1 called successfully
capacity  951
sorted_dict  {23: 951, 22: 933, 21: 863, 20: 786, 18: 719, 19: 704, 17: 670, 16: 629, 15: 607, 14: 594, 13: 571, 12: 509, 10: 432, 11: 424, 9: 386, 8: 314, 7: 264, 6: 249, 5: 189, 4: 130, 3: 98, 2: 59, 1: 26, 0: 10}

weights after sort [951, 933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 509, 432, 424, 386, 314, 264, 249, 189, 130, 98, 59, 26, 10]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [951], 		------------sum 951

before remove weights,  [951, 933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 509, 432, 424, 386, 314, 264, 249, 189, 130, 98, 59, 26, 10]
after remove pre pack weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 509, 432, 424, 386, 314, 264, 249, 189, 130, 98, 59, 26, 10]

remove bucket_id:  [15, 16, 19, 21]
original bucket_id :,  [7, 6, 3, 1]
remove weights:  [264 249  98  26], 		------------sum 637

before remove weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 509, 432, 424, 386, 314, 264, 249, 189, 130, 98, 59, 26, 10]
after remove pre pack weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 509, 432, 424, 386, 314, 189, 130, 59, 10]

remove bucket_id:  [10, 11, 18]
original bucket_id :,  [12, 10, 0]
remove weights:  [509 432  10], 		------------sum 951

before remove weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 509, 432, 424, 386, 314, 189, 130, 59, 10]
after remove pre pack weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 424, 386, 314, 189, 130, 59]

remove bucket_id:  [13, 14, 15]
original bucket_id :,  [5, 4, 2]
remove weights:  [189 130  59], 		------------sum 378

before remove weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 424, 386, 314, 189, 130, 59]
after remove pre pack weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 424, 386, 314]

remove bucket_id:  [6, 12]
original bucket_id :,  [16, 8]
remove weights:  [629 314], 		------------sum 943

before remove weights,  [933, 863, 786, 719, 704, 670, 629, 607, 594, 571, 424, 386, 314]
after remove pre pack weights,  [933, 863, 786, 719, 704, 670, 607, 594, 571, 424, 386]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [933], 		------------sum 933

before remove weights,  [933, 863, 786, 719, 704, 670, 607, 594, 571, 424, 386]
after remove pre pack weights,  [863, 786, 719, 704, 670, 607, 594, 571, 424, 386]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [863], 		------------sum 863

before remove weights,  [863, 786, 719, 704, 670, 607, 594, 571, 424, 386]
after remove pre pack weights,  [786, 719, 704, 670, 607, 594, 571, 424, 386]

remove bucket_id:  [7, 8]
original bucket_id :,  [11, 9]
remove weights:  [424 386], 		------------sum 810

before remove weights,  [786, 719, 704, 670, 607, 594, 571, 424, 386]
after remove pre pack weights,  [786, 719, 704, 670, 607, 594, 571]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [786], 		------------sum 786

before remove weights,  [786, 719, 704, 670, 607, 594, 571]
after remove pre pack weights,  [719, 704, 670, 607, 594, 571]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [719], 		------------sum 719

before remove weights,  [719, 704, 670, 607, 594, 571]
after remove pre pack weights,  [704, 670, 607, 594, 571]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [704], 		------------sum 704

before remove weights,  [704, 670, 607, 594, 571]
after remove pre pack weights,  [670, 607, 594, 571]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [670], 		------------sum 670

before remove weights,  [670, 607, 594, 571]
after remove pre pack weights,  [607, 594, 571]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [607], 		------------sum 607

before remove weights,  [607, 594, 571]
after remove pre pack weights,  [594, 571]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [594], 		------------sum 594

before remove weights,  [594, 571]
after remove pre pack weights,  [571]
the last batch value is  571
G_BUCKET_ID_list [[23], [7, 6, 3, 1], [12, 10, 0], [5, 4, 2], [16, 8], [22], [21], [11, 9], [20], [18], [19], [17], [15], [14], [13]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.18556475639343262
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  24
current group_mem  0.9516638517379761
current group_mem  0.6388026773929596
current group_mem  0.9515804350376129
current group_mem  0.37980857491493225
current group_mem  0.9441984593868256
current group_mem  0.9334430694580078
current group_mem  0.8632670938968658
current group_mem  0.8114545941352844
current group_mem  0.7861466109752655
current group_mem  0.7191262543201447
current group_mem  0.7044298946857452
current group_mem  0.6702716946601868
current group_mem  0.6078604459762573
current group_mem  0.594073086977005
current group_mem  0.5714942514896393
batches output list generation spend  0.0004279613494873047
self.weights_list  [0.042152708181776556, 0.048252285433761845, 0.04605460622370543, 0.045835855746778516, 0.044630184513483676, 0.04216796984295751, 0.04188308550091316, 0.04509312156930575, 0.04185256217855126, 0.04184238773776396, 0.04178134109304017, 0.04194413214563694, 0.041995004349573435, 0.04229515035279873, 0.042407069201459015, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03884092770551099]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023272991180419922
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.18633556365966797
len local_batched_seeds_list  24
partition total batch output list spend :  6.375838041305542
self.buckets_partition() spend  sec:  0.20963072776794434
layer  0
 the number of batches:  24
check_connections_block*********************************

the find indices time spent  0.28791308403015137

in edges time spent  0.8941812515258789
local to global src and eids time spent  2.2517781257629395
time gen tails  0.5953507423400879
res  length 24
layer  1
num of batch  24
check_connections_block*********************************

the find indices time spent  2.0543875694274902

in edges time spent  9.001562356948853
local to global src and eids time spent  18.20235776901245
time gen tails  3.65069842338562
res  length 24
block collection to dataloader spend  5.8650970458984375e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 13.771484375 GB
    Memory Allocated: 11.98932933807373  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 14.408203125 GB
    Memory Allocated: 11.731564998626709  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 14.408203125 GB
    Memory Allocated: 11.957435607910156  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 14.408203125 GB
    Memory Allocated: 11.586865901947021  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 14.408203125 GB
    Memory Allocated: 11.956355094909668  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 14.42578125 GB
    Memory Allocated: 11.935980796813965  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 14.42578125 GB
    Memory Allocated: 11.93920373916626  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 14.42578125 GB
    Memory Allocated: 11.925502300262451  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 14.42578125 GB
    Memory Allocated: 11.893383979797363  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 14.42578125 GB
    Memory Allocated: 11.857612609863281  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 14.447265625 GB
    Memory Allocated: 11.844511985778809  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 14.455078125 GB
    Memory Allocated: 11.767619609832764  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 14.455078125 GB
    Memory Allocated: 11.814728260040283  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 14.4609375 GB
    Memory Allocated: 11.800436019897461  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 14.47265625 GB
    Memory Allocated: 11.762692928314209  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 14.48046875 GB
    Memory Allocated: 11.399960041046143  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 14.505859375 GB
    Memory Allocated: 11.415297985076904  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  17
----------------------------------------after loss function
 Nvidia-smi: 14.513671875 GB
    Memory Allocated: 11.401369094848633  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  18
----------------------------------------after loss function
 Nvidia-smi: 14.513671875 GB
    Memory Allocated: 11.407987117767334  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  19
----------------------------------------after loss function
 Nvidia-smi: 14.513671875 GB
    Memory Allocated: 11.424094200134277  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  20
----------------------------------------after loss function
 Nvidia-smi: 14.513671875 GB
    Memory Allocated: 11.427224159240723  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  21
----------------------------------------after loss function
 Nvidia-smi: 14.54296875 GB
    Memory Allocated: 11.421936988830566  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  22
----------------------------------------after loss function
 Nvidia-smi: 14.54296875 GB
    Memory Allocated: 11.430712223052979  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

step  23
----------------------------------------after loss function
 Nvidia-smi: 14.54296875 GB
    Memory Allocated: 11.43099308013916  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 14.54296875 GB
    Memory Allocated: 0.43573999404907227  GigaBytes
Max Memory Allocated: 12.1748366355896  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.206910133361816
pure train time :  3.575465679168701
train time :  7.828523874282837
end to end time :  84.60179853439331
connection check time:  42.237324714660645
block generation time  28.03218674659729
Total (block generation + training)time/epoch nan
