main start at this time 1690926808.1357212
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.3111886978149414
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  24
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.00041484832763671875
self.weights_list  [0.04216796984295751, 0.04844559980872051, 0.04276317462901445, 0.042152708181776556, 0.04566289025339445, 0.04680242762157185, 0.04723992857542567, 0.04185256217855126, 0.04184238773776396, 0.04178134109304017, 0.04169994556674179, 0.04194413214563694, 0.041995004349573435, 0.042000091569967084, 0.041837300517370314, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03884092770551099]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025760650634765625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.31191325187683105
len local_batched_seeds_list  24
partition total batch output list spend :  6.491225004196167
self.buckets_partition() spend  sec:  0.33769655227661133
layer  0
 the number of batches:  24
check_connections_block*********************************

the find indices time spent  0.2886338233947754

in edges time spent  0.7725226879119873
local to global src and eids time spent  2.127143383026123
time gen tails  0.6169908046722412
res  length 24
layer  1
num of batch  24
check_connections_block*********************************

the find indices time spent  2.0519423484802246

in edges time spent  7.030553102493286
local to global src and eids time spent  16.34217929840088
time gen tails  2.495053291320801
res  length 24
block collection to dataloader spend  5.984306335449219e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 13.74609375 GB
    Memory Allocated: 11.98142385482788  GigaBytes
Max Memory Allocated: 12.166208744049072  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 14.369140625 GB
    Memory Allocated: 11.688154697418213  GigaBytes
Max Memory Allocated: 12.166208744049072  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 14.369140625 GB
    Memory Allocated: 11.919008731842041  GigaBytes
Max Memory Allocated: 12.166208744049072  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 14.37109375 GB
    Memory Allocated: 11.958951473236084  GigaBytes
Max Memory Allocated: 12.166208744049072  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 14.37109375 GB
    Memory Allocated: 12.00806999206543  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 15.03125 GB
    Memory Allocated: 11.955557346343994  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 15.03125 GB
    Memory Allocated: 11.977319717407227  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 15.03125 GB
    Memory Allocated: 11.900836944580078  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 15.03125 GB
    Memory Allocated: 11.826865196228027  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 15.03125 GB
    Memory Allocated: 11.848368644714355  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 15.05078125 GB
    Memory Allocated: 11.778647422790527  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 15.05859375 GB
    Memory Allocated: 11.813286304473877  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 15.06640625 GB
    Memory Allocated: 11.820684909820557  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 15.06640625 GB
    Memory Allocated: 11.732436656951904  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 15.0703125 GB
    Memory Allocated: 11.670141696929932  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 15.087890625 GB
    Memory Allocated: 11.403194427490234  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 15.08984375 GB
    Memory Allocated: 11.40054178237915  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  17
----------------------------------------after loss function
 Nvidia-smi: 15.12109375 GB
    Memory Allocated: 11.404382705688477  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  18
----------------------------------------after loss function
 Nvidia-smi: 15.12109375 GB
    Memory Allocated: 11.409148216247559  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  19
----------------------------------------after loss function
 Nvidia-smi: 15.12109375 GB
    Memory Allocated: 11.423718929290771  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  20
----------------------------------------after loss function
 Nvidia-smi: 15.12109375 GB
    Memory Allocated: 11.425594806671143  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  21
----------------------------------------after loss function
 Nvidia-smi: 15.14453125 GB
    Memory Allocated: 11.424597263336182  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  22
----------------------------------------after loss function
 Nvidia-smi: 15.14453125 GB
    Memory Allocated: 11.424688816070557  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  23
----------------------------------------after loss function
 Nvidia-smi: 15.14453125 GB
    Memory Allocated: 11.431233882904053  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.14453125 GB
    Memory Allocated: 0.43612194061279297  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.204815864562988
pure train time :  3.3402791023254395
train time :  7.289801359176636
end to end time :  76.11264705657959
connection check time:  36.38122844696045
block generation time  25.825388431549072
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.3143160343170166
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  24
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0004944801330566406
self.weights_list  [0.04216796984295751, 0.04844559980872051, 0.04276317462901445, 0.042152708181776556, 0.04566289025339445, 0.04680242762157185, 0.04723992857542567, 0.04185256217855126, 0.04184238773776396, 0.04178134109304017, 0.04169994556674179, 0.04194413214563694, 0.041995004349573435, 0.042000091569967084, 0.041837300517370314, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03884092770551099]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02588367462158203
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.31505393981933594
len local_batched_seeds_list  24
partition total batch output list spend :  6.581278562545776
self.buckets_partition() spend  sec:  0.3409616947174072
layer  0
 the number of batches:  24
check_connections_block*********************************

the find indices time spent  0.29881906509399414

in edges time spent  0.8847980499267578
local to global src and eids time spent  2.257154703140259
time gen tails  0.5988037586212158
res  length 24
layer  1
num of batch  24
check_connections_block*********************************

the find indices time spent  2.0559074878692627

in edges time spent  8.275421380996704
local to global src and eids time spent  18.318264722824097
time gen tails  3.6289615631103516
res  length 24
block collection to dataloader spend  4.124641418457031e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 15.14453125 GB
    Memory Allocated: 11.94108772277832  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 15.14453125 GB
    Memory Allocated: 11.721113681793213  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 15.14453125 GB
    Memory Allocated: 11.90105390548706  GigaBytes
Max Memory Allocated: 12.192388534545898  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 12.020720481872559  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 12.011278629302979  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.968403339385986  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.979664325714111  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.833551406860352  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.817790031433105  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.845833778381348  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.840124130249023  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.833895683288574  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.770899772644043  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.747273921966553  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.685219287872314  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.396486282348633  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.43421220779419  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  17
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.409342288970947  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  18
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.424306392669678  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  19
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.416395664215088  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  20
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.428213119506836  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  21
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.45690393447876  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  22
----------------------------------------after loss function
 Nvidia-smi: 15.78125 GB
    Memory Allocated: 11.448469638824463  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  23
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.428838729858398  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 0.43596363067626953  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.474153995513916
pure train time :  3.1443216800689697
train time :  6.930756568908691
end to end time :  83.40871262550354
connection check time:  42.69468426704407
block generation time  27.068633317947388
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.37487053871154785
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  24
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0006935596466064453
self.weights_list  [0.04216796984295751, 0.04844559980872051, 0.04276317462901445, 0.042152708181776556, 0.04566289025339445, 0.04680242762157185, 0.04723992857542567, 0.04185256217855126, 0.04184238773776396, 0.04178134109304017, 0.04169994556674179, 0.04194413214563694, 0.041995004349573435, 0.042000091569967084, 0.041837300517370314, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03884092770551099]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029016733169555664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3758211135864258
len local_batched_seeds_list  24
partition total batch output list spend :  6.790208578109741
self.buckets_partition() spend  sec:  0.4048640727996826
layer  0
 the number of batches:  24
check_connections_block*********************************

the find indices time spent  0.29523539543151855

in edges time spent  0.9743659496307373
local to global src and eids time spent  2.037205696105957
time gen tails  0.3951609134674072
res  length 24
layer  1
num of batch  24
check_connections_block*********************************

the find indices time spent  2.0433766841888428

in edges time spent  8.328184366226196
local to global src and eids time spent  17.934494733810425
time gen tails  3.6779720783233643
res  length 24
block collection to dataloader spend  4.649162292480469e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.918212890625  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.713388919830322  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.899953842163086  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 12.012932300567627  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 12.013161659240723  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.960965633392334  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.975189208984375  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.870435237884521  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.85305118560791  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.84751033782959  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.779108047485352  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.8402738571167  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.814236164093018  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.728530883789062  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.695342063903809  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.42833662033081  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.40010404586792  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  17
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.401795864105225  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  18
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.411417484283447  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  19
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.444393634796143  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  20
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.383052349090576  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  21
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.4238600730896  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  22
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.39458703994751  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  23
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.444262027740479  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 0.43813085556030273  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7389168739318848
pure train time :  3.1676642894744873
train time :  6.826130151748657
end to end time :  81.01399874687195
connection check time:  41.39116191864014
block generation time  25.886992692947388
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.3331112861633301
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  24
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0005738735198974609
self.weights_list  [0.04216796984295751, 0.04844559980872051, 0.04276317462901445, 0.042152708181776556, 0.04566289025339445, 0.04680242762157185, 0.04723992857542567, 0.04185256217855126, 0.04184238773776396, 0.04178134109304017, 0.04169994556674179, 0.04194413214563694, 0.041995004349573435, 0.042000091569967084, 0.041837300517370314, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03884092770551099]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028400897979736328
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3339054584503174
len local_batched_seeds_list  24
partition total batch output list spend :  3.375697612762451
self.buckets_partition() spend  sec:  0.3623347282409668
layer  0
 the number of batches:  24
check_connections_block*********************************

the find indices time spent  0.21620893478393555

in edges time spent  0.764880895614624
local to global src and eids time spent  2.2867140769958496
time gen tails  0.5921182632446289
res  length 24
layer  1
num of batch  24
check_connections_block*********************************

the find indices time spent  2.056760549545288

in edges time spent  8.157475233078003
local to global src and eids time spent  11.589008569717407
time gen tails  2.2310760021209717
res  length 24
block collection to dataloader spend  2.8371810913085938e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.913502216339111  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.727435111999512  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.936877250671387  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 12.018946647644043  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.96187686920166  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.983476638793945  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.963204383850098  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.854521751403809  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.824629783630371  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.785530090332031  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.834999084472656  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.826300621032715  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.763139247894287  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.729671478271484  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.673899173736572  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.394841194152832  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.409510612487793  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  17
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.41542911529541  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  18
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.444047451019287  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  19
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.425000190734863  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  20
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.433639526367188  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  21
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.428285598754883  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  22
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.427073001861572  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  23
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.438212871551514  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 0.43751955032348633  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2389206886291504
pure train time :  2.795062780380249
train time :  6.630837440490723
end to end time :  61.236899852752686
connection check time:  30.68386435508728
block generation time  20.438769102096558
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.10074329376220703
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  24
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0004429817199707031
self.weights_list  [0.04216796984295751, 0.04844559980872051, 0.04276317462901445, 0.042152708181776556, 0.04566289025339445, 0.04680242762157185, 0.04723992857542567, 0.04185256217855126, 0.04184238773776396, 0.04178134109304017, 0.04169994556674179, 0.04194413214563694, 0.041995004349573435, 0.042000091569967084, 0.041837300517370314, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03884092770551099]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024745941162109375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.10143542289733887
len local_batched_seeds_list  24
partition total batch output list spend :  2.2884457111358643
self.buckets_partition() spend  sec:  0.12619948387145996
layer  0
 the number of batches:  24
check_connections_block*********************************

the find indices time spent  0.2146759033203125

in edges time spent  0.5355219841003418
local to global src and eids time spent  0.8972060680389404
time gen tails  0.3278634548187256
res  length 24
layer  1
num of batch  24
check_connections_block*********************************

the find indices time spent  1.6431331634521484

in edges time spent  4.865586519241333
local to global src and eids time spent  8.836595058441162
time gen tails  2.2024195194244385
res  length 24
block collection to dataloader spend  3.2901763916015625e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.933893203735352  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.729658126831055  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.88439130783081  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.99291706085205  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 12.010637760162354  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.960095405578613  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.9811110496521  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.901567935943604  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.834399700164795  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.862664699554443  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.821609020233154  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.75507402420044  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.74420166015625  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.73783826828003  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.688054084777832  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.410731315612793  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.395335674285889  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  17
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.402650833129883  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  18
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.429011344909668  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  19
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.413341045379639  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  20
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.430931568145752  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  21
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.42911148071289  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  22
----------------------------------------after loss function
 Nvidia-smi: 15.787109375 GB
    Memory Allocated: 11.432755470275879  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  23
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.433855533599854  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 0.43735742568969727  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7836540937423706
pure train time :  3.0647385120391846
train time :  6.698628902435303
end to end time :  50.651333808898926
connection check time:  21.71159291267395
block generation time  19.885267734527588
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.31403183937072754
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  24
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0005164146423339844
self.weights_list  [0.04216796984295751, 0.04844559980872051, 0.04276317462901445, 0.042152708181776556, 0.04566289025339445, 0.04680242762157185, 0.04723992857542567, 0.04185256217855126, 0.04184238773776396, 0.04178134109304017, 0.04169994556674179, 0.04194413214563694, 0.041995004349573435, 0.042000091569967084, 0.041837300517370314, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03884092770551099]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025994062423706055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.31478381156921387
len local_batched_seeds_list  24
partition total batch output list spend :  6.60528564453125
self.buckets_partition() spend  sec:  0.3408021926879883
layer  0
 the number of batches:  24
check_connections_block*********************************

the find indices time spent  0.3055260181427002

in edges time spent  0.5966572761535645
local to global src and eids time spent  1.44034743309021
time gen tails  0.5373010635375977
res  length 24
layer  1
num of batch  24
check_connections_block*********************************

the find indices time spent  2.0737006664276123

in edges time spent  8.263540267944336
local to global src and eids time spent  17.079718351364136
time gen tails  3.4867777824401855
res  length 24
block collection to dataloader spend  4.601478576660156e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.929783821105957  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.738298892974854  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.893855571746826  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.949593544006348  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.980825424194336  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.958494663238525  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.96890115737915  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.871118068695068  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.83288049697876  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.841529369354248  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.773733139038086  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.819231986999512  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.814150333404541  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.739242553710938  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.663989543914795  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.394575595855713  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.393675804138184  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  17
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.401995182037354  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  18
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.425440311431885  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  19
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.421449184417725  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  20
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.430452346801758  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  21
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.43140983581543  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  22
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.438027381896973  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  23
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.443085193634033  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 0.43999433517456055  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.552270770072937
pure train time :  3.0690431594848633
train time :  6.789283514022827
end to end time :  77.39472460746765
connection check time:  38.84531211853027
block generation time  25.043238878250122
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.3536040782928467
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  24
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0006749629974365234
self.weights_list  [0.04216796984295751, 0.04844559980872051, 0.04276317462901445, 0.042152708181776556, 0.04566289025339445, 0.04680242762157185, 0.04723992857542567, 0.04185256217855126, 0.04184238773776396, 0.04178134109304017, 0.04169994556674179, 0.04194413214563694, 0.041995004349573435, 0.042000091569967084, 0.041837300517370314, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03884092770551099]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026266098022460938
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.35451388359069824
len local_batched_seeds_list  24
partition total batch output list spend :  4.13792085647583
self.buckets_partition() spend  sec:  0.38080549240112305
layer  0
 the number of batches:  24
check_connections_block*********************************

the find indices time spent  0.21042704582214355

in edges time spent  0.6612577438354492
local to global src and eids time spent  1.9584505558013916
time gen tails  0.5620124340057373
res  length 24
layer  1
num of batch  24
check_connections_block*********************************

the find indices time spent  2.0356390476226807

in edges time spent  8.193984508514404
local to global src and eids time spent  17.586263179779053
time gen tails  3.549328327178955
res  length 24
block collection to dataloader spend  3.743171691894531e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.922687530517578  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.724257469177246  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.897050380706787  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.949380874633789  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.967328548431396  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.923275470733643  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.943169593811035  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.888627052307129  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.840546131134033  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.84849214553833  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.773848533630371  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.818167209625244  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.839214324951172  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.742361068725586  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.698391914367676  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.403531551361084  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.4349365234375  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  17
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.412656307220459  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  18
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.415594100952148  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  19
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.414715766906738  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  20
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.41422176361084  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  21
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.432998657226562  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  22
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.435167789459229  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  23
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.436779499053955  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 0.4375643730163574  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3942347764968872
pure train time :  3.091477870941162
train time :  6.732131481170654
end to end time :  76.88876748085022
connection check time:  39.942172050476074
block generation time  25.959644079208374
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.48442888259887695
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  24
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0005750656127929688
self.weights_list  [0.04216796984295751, 0.04844559980872051, 0.04276317462901445, 0.042152708181776556, 0.04566289025339445, 0.04680242762157185, 0.04723992857542567, 0.04185256217855126, 0.04184238773776396, 0.04178134109304017, 0.04169994556674179, 0.04194413214563694, 0.041995004349573435, 0.042000091569967084, 0.041837300517370314, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03884092770551099]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02609992027282715
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4852449893951416
len local_batched_seeds_list  24
partition total batch output list spend :  6.748448133468628
self.buckets_partition() spend  sec:  0.5113720893859863
layer  0
 the number of batches:  24
check_connections_block*********************************

the find indices time spent  0.29299187660217285

in edges time spent  0.9548251628875732
local to global src and eids time spent  2.266838312149048
time gen tails  0.5851035118103027
res  length 24
layer  1
num of batch  24
check_connections_block*********************************

the find indices time spent  2.020888328552246

in edges time spent  9.493306159973145
local to global src and eids time spent  17.602091789245605
time gen tails  3.6231603622436523
res  length 24
block collection to dataloader spend  7.009506225585938e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.912078857421875  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.694983005523682  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.927380084991455  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.953291893005371  GigaBytes
Max Memory Allocated: 12.206128120422363  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 12.035102844238281  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.965693473815918  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.94368314743042  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.859631538391113  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.866609573364258  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.849649429321289  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.760199546813965  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.862536907196045  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.768786430358887  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.71762228012085  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.698498725891113  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.391435146331787  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.404071807861328  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  17
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.423352718353271  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  18
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.399177074432373  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  19
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.40990161895752  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  20
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.41653060913086  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  21
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.439267635345459  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  22
----------------------------------------after loss function
 Nvidia-smi: 15.79296875 GB
    Memory Allocated: 11.433575630187988  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  23
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.432173728942871  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 0.43719005584716797  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2697203159332275
pure train time :  3.2014997005462646
train time :  6.677398204803467
end to end time :  81.77861881256104
connection check time:  42.69195890426636
block generation time  25.53745675086975
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.33537888526916504
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  24
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0005586147308349609
self.weights_list  [0.04216796984295751, 0.04844559980872051, 0.04276317462901445, 0.042152708181776556, 0.04566289025339445, 0.04680242762157185, 0.04723992857542567, 0.04185256217855126, 0.04184238773776396, 0.04178134109304017, 0.04169994556674179, 0.04194413214563694, 0.041995004349573435, 0.042000091569967084, 0.041837300517370314, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03884092770551099]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02629828453063965
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3361639976501465
len local_batched_seeds_list  24
partition total batch output list spend :  6.5992207527160645
self.buckets_partition() spend  sec:  0.3625028133392334
layer  0
 the number of batches:  24
check_connections_block*********************************

the find indices time spent  0.2963886260986328

in edges time spent  0.8052175045013428
local to global src and eids time spent  1.828719139099121
time gen tails  0.6093990802764893
res  length 24
layer  1
num of batch  24
check_connections_block*********************************

the find indices time spent  2.0736091136932373

in edges time spent  7.985026836395264
local to global src and eids time spent  17.853103399276733
time gen tails  3.6393837928771973
res  length 24
block collection to dataloader spend  4.982948303222656e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.917789459228516  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.72116470336914  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.92646598815918  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 12.016983032226562  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.972212314605713  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.96505069732666  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.940174579620361  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.902753829956055  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.821171760559082  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.857234954833984  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.825696468353271  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.841641902923584  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.762564659118652  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.749938011169434  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.674488544464111  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.395089149475098  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.40447187423706  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  17
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.420162677764893  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  18
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.406825542449951  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  19
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.406900882720947  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  20
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.42150068283081  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  21
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.425172805786133  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  22
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.431860446929932  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  23
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.435593128204346  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 0.4373631477355957  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1728925704956055
pure train time :  3.0889134407043457
train time :  6.756512880325317
end to end time :  79.87666964530945
connection check time:  40.28832221031189
block generation time  26.120799779891968
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.37444067001342773
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  24
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  0.0005590915679931641
self.weights_list  [0.04216796984295751, 0.04844559980872051, 0.04276317462901445, 0.042152708181776556, 0.04566289025339445, 0.04680242762157185, 0.04723992857542567, 0.04185256217855126, 0.04184238773776396, 0.04178134109304017, 0.04169994556674179, 0.04194413214563694, 0.041995004349573435, 0.042000091569967084, 0.041837300517370314, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03887145102787288, 0.03884092770551099]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027779102325439453
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3753933906555176
len local_batched_seeds_list  24
partition total batch output list spend :  6.660141468048096
self.buckets_partition() spend  sec:  0.4032104015350342
layer  0
 the number of batches:  24
check_connections_block*********************************

the find indices time spent  0.2857685089111328

in edges time spent  0.890296459197998
local to global src and eids time spent  2.247217893600464
time gen tails  0.5812718868255615
res  length 24
layer  1
num of batch  24
check_connections_block*********************************

the find indices time spent  2.0541961193084717

in edges time spent  8.102721452713013
local to global src and eids time spent  17.143908977508545
time gen tails  3.5245604515075684
res  length 24
block collection to dataloader spend  4.1484832763671875e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.919719696044922  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.689831256866455  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.936624526977539  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.948646545410156  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.96434211730957  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.961274147033691  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.976809024810791  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.834077835083008  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.84790849685669  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.824244976043701  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.77475118637085  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.848602771759033  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.77379560470581  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.762223720550537  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.698548316955566  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.400081634521484  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  16
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.415045261383057  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  17
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.406230926513672  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  18
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.4125075340271  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  19
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.415492057800293  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  20
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.429137706756592  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  21
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.420159339904785  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  22
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.427835464477539  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

step  23
----------------------------------------after loss function
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 11.445838928222656  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.796875 GB
    Memory Allocated: 0.43764591217041016  GigaBytes
Max Memory Allocated: 12.21893310546875  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0821049213409424
pure train time :  3.060577630996704
train time :  6.618816614151001
end to end time :  78.45951390266418
connection check time:  39.93648433685303
block generation time  25.13437843322754
end to end time  79.30474543571472
Total (block generation + training)time/epoch 79.30474543571472
