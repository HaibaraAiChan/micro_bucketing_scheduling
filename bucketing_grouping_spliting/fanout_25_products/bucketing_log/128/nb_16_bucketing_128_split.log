main start at this time 1691631875.165355
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the grouping_fanout_1 called successfully
capacity  2233
sorted_dict  {22: 2232, 23: 2223, 21: 2194, 20: 1920, 18: 1793, 19: 1676, 16: 1656, 17: 1599, 15: 1464, 14: 1367, 13: 1291, 12: 1283, 10: 1067, 11: 1028, 9: 928, 8: 776, 7: 704, 6: 540, 5: 455, 4: 330, 3: 231, 2: 142, 1: 78, 0: 33}

weights after sort [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [2232], 		------------sum 2232

before remove weights,  [2232, 2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]

remove bucket_id:  [16, 17, 19, 21]
original bucket_id :,  [6, 5, 3, 1]
remove weights:  [540 455 231  78], 		------------sum 1304

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 540, 455, 330, 231, 142, 78, 33]
after remove pre pack weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]

remove bucket_id:  [1, 18]
original bucket_id :,  [21, 0]
remove weights:  [2194   33], 		------------sum 2227

before remove weights,  [2223, 2194, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142, 33]
after remove pre pack weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [2223], 		------------sum 2223

before remove weights,  [2223, 1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]

remove bucket_id:  [7, 11]
original bucket_id :,  [13, 9]
remove weights:  [1291  928], 		------------sum 2219

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1291, 1283, 1067, 1028, 928, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]

remove bucket_id:  [6, 11, 13]
original bucket_id :,  [14, 7, 2]
remove weights:  [1367  704  142], 		------------sum 2213

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1367, 1283, 1067, 1028, 776, 704, 330, 142]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]

remove bucket_id:  [7, 9, 10]
original bucket_id :,  [10, 8, 4]
remove weights:  [1067  776  330], 		------------sum 2173

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1067, 1028, 776, 330]
after remove pre pack weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1920], 		------------sum 1920

before remove weights,  [1920, 1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1793], 		------------sum 1793

before remove weights,  [1793, 1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1676, 1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1676], 		------------sum 1676

before remove weights,  [1676, 1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1656, 1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1656], 		------------sum 1656

before remove weights,  [1656, 1599, 1464, 1283, 1028]
after remove pre pack weights,  [1599, 1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1599], 		------------sum 1599

before remove weights,  [1599, 1464, 1283, 1028]
after remove pre pack weights,  [1464, 1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1464], 		------------sum 1464

before remove weights,  [1464, 1283, 1028]
after remove pre pack weights,  [1283, 1028]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1283], 		------------sum 1283

before remove weights,  [1283, 1028]
after remove pre pack weights,  [1028]
the last batch value is  1028
G_BUCKET_ID_list [[22], [6, 5, 3, 1], [21, 0], [23], [13, 9], [14, 7, 2], [10, 8, 4], [20], [18], [19], [16], [17], [15], [12], [11]]
G_BUCKET_ID_list length 15
backpack scheduling spend  0.1000211238861084
len(g_bucket_nids_list)  15
len(local_split_batches_nid_list)  16
current group_mem  2.232189497508864
current group_mem  1.3068242388952873
current group_mem  2.2282285622209037
current group_mem  2.223171411479282
current group_mem  2.2199646769036976
current group_mem  2.2155376024494022
current group_mem  2.1752215580623586
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.6766132844613435
current group_mem  1.6565154083265854
current group_mem  1.5991467489715145
current group_mem  1.4645761989081698
current group_mem  1.2832128918560093
current group_mem  1.0285266294845892
batches output list generation spend  3.528594970703125e-05
self.weights_list  [0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.05823849906649506]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02255725860595703
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.10029339790344238
len local_batched_seeds_list  16
partition total batch output list spend :  3.5996017456054688
self.buckets_partition() spend  sec:  0.1228630542755127
layer  0
 the number of batches:  16
check_connections_block*********************************

the find indices time spent  0.2860391139984131

in edges time spent  0.9010345935821533
local to global src and eids time spent  1.9180192947387695
time gen tails  0.5064563751220703
res  length 16
layer  1
num of batch  16
check_connections_block*********************************

the find indices time spent  1.8701820373535156

in edges time spent  7.365115642547607
local to global src and eids time spent  15.568864583969116
time gen tails  2.9230358600616455
res  length 16
block collection to dataloader spend  4.029273986816406e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 17.923828125 GB
    Memory Allocated: 15.938962936401367  GigaBytes
Max Memory Allocated: 16.206469535827637  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 18.78125 GB
    Memory Allocated: 15.951054573059082  GigaBytes
Max Memory Allocated: 16.22061586380005  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 18.783203125 GB
    Memory Allocated: 15.944018840789795  GigaBytes
Max Memory Allocated: 16.22061586380005  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 18.783203125 GB
    Memory Allocated: 15.933758735656738  GigaBytes
Max Memory Allocated: 16.22061586380005  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 20.494140625 GB
    Memory Allocated: 16.035602569580078  GigaBytes
Max Memory Allocated: 16.30438756942749  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 20.49609375 GB
    Memory Allocated: 15.994222640991211  GigaBytes
Max Memory Allocated: 16.30438756942749  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 20.49609375 GB
    Memory Allocated: 16.00432252883911  GigaBytes
Max Memory Allocated: 16.30438756942749  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 20.498046875 GB
    Memory Allocated: 15.966649532318115  GigaBytes
Max Memory Allocated: 16.30438756942749  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 20.498046875 GB
    Memory Allocated: 16.035836696624756  GigaBytes
Max Memory Allocated: 16.30473232269287  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 20.498046875 GB
    Memory Allocated: 16.00308895111084  GigaBytes
Max Memory Allocated: 16.30473232269287  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 20.505859375 GB
    Memory Allocated: 16.023240566253662  GigaBytes
Max Memory Allocated: 16.30473232269287  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 20.505859375 GB
    Memory Allocated: 16.032339096069336  GigaBytes
Max Memory Allocated: 16.30473232269287  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 20.505859375 GB
    Memory Allocated: 16.023484706878662  GigaBytes
Max Memory Allocated: 16.30473232269287  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 20.505859375 GB
    Memory Allocated: 16.06820249557495  GigaBytes
Max Memory Allocated: 16.337098121643066  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 20.505859375 GB
    Memory Allocated: 16.059832096099854  GigaBytes
Max Memory Allocated: 16.337098121643066  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 20.505859375 GB
    Memory Allocated: 16.018391609191895  GigaBytes
Max Memory Allocated: 16.337098121643066  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 20.505859375 GB
    Memory Allocated: 0.5184106826782227  GigaBytes
Max Memory Allocated: 16.337098121643066  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.840176582336426
pure train time :  2.930955410003662
train time :  6.668485879898071
end to end time :  76.11094331741333
connection check time:  38.55093002319336
block generation time  27.194212913513184
Total (block generation + training)time/epoch nan
