main start at this time 1690259679.224323
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.11769533157348633
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0005106925964355469
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026291608810424805
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.11848855018615723
len local_batched_seeds_list  15
partition total batch output list spend :  4.020728349685669
self.buckets_partition() spend  sec:  0.14482712745666504
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.4888598918914795

in edges time spent  0.897557258605957
local to global src and eids time spent  2.2814574241638184
time gen tails  0.5767254829406738
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.351724624633789

in edges time spent  7.461620092391968
local to global src and eids time spent  16.792763233184814
time gen tails  3.0681564807891846
res  length 15
block collection to dataloader spend  4.2438507080078125e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.15234375 GB
    Memory Allocated: 19.969828128814697  GigaBytes
Max Memory Allocated: 20.558085441589355  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.25390625 GB
    Memory Allocated: 20.032952308654785  GigaBytes
Max Memory Allocated: 20.62508726119995  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.255859375 GB
    Memory Allocated: 19.999154567718506  GigaBytes
Max Memory Allocated: 20.62508726119995  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.255859375 GB
    Memory Allocated: 20.005807876586914  GigaBytes
Max Memory Allocated: 20.62508726119995  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.291015625 GB
    Memory Allocated: 20.07356834411621  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.29296875 GB
    Memory Allocated: 20.027546405792236  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.3046875 GB
    Memory Allocated: 20.025334358215332  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.310546875 GB
    Memory Allocated: 19.99888563156128  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.967864990234375  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.889095783233643  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.873989582061768  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.823554515838623  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.900492668151855  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.802420616149902  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.37135934829712  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 0.5374093055725098  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.390896320343018
pure train time :  4.019588470458984
train time :  8.228193998336792
end to end time :  78.00250554084778
connection check time:  38.18872857093811
block generation time  27.434125185012817
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.13742637634277344
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0005953311920166016
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030268192291259766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13821077346801758
len local_batched_seeds_list  15
partition total batch output list spend :  4.051474332809448
self.buckets_partition() spend  sec:  0.1685788631439209
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.48163652420043945

in edges time spent  0.9311861991882324
local to global src and eids time spent  2.2452025413513184
time gen tails  0.5550243854522705
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3048820495605469

in edges time spent  7.08237886428833
local to global src and eids time spent  16.01105523109436
time gen tails  3.118034839630127
res  length 15
block collection to dataloader spend  3.075599670410156e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 20.022510051727295  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.31640625 GB
    Memory Allocated: 20.00730562210083  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.31640625 GB
    Memory Allocated: 19.99577522277832  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.31640625 GB
    Memory Allocated: 20.034401416778564  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.31640625 GB
    Memory Allocated: 19.975385665893555  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.31640625 GB
    Memory Allocated: 19.9854736328125  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.067371368408203  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.985804080963135  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.958833694458008  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.924574375152588  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.88339138031006  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.872636795043945  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.89017105102539  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.843557834625244  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.400485038757324  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 0.5366005897521973  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.871942520141602
pure train time :  3.262713670730591
train time :  6.8101136684417725
end to end time :  73.88542246818542
connection check time:  36.716002225875854
block generation time  26.17676591873169
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.14169073104858398
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0007631778717041016
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024954795837402344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.14266347885131836
len local_batched_seeds_list  15
partition total batch output list spend :  3.973231792449951
self.buckets_partition() spend  sec:  0.16764116287231445
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.41573357582092285

in edges time spent  0.5117983818054199
local to global src and eids time spent  0.9328639507293701
time gen tails  0.31255269050598145
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  0.9352197647094727

in edges time spent  6.96691107749939
local to global src and eids time spent  15.544336795806885
time gen tails  2.924790382385254
res  length 15
block collection to dataloader spend  3.361701965332031e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.94367742538452  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.05465841293335  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.98225450515747  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.000791549682617  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.050011157989502  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.04021978378296  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.02635431289673  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.056705474853516  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.947765350341797  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.98355722427368  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.883254528045654  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.835423469543457  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.868813514709473  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.72985601425171  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.41578435897827  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 0.5430316925048828  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5988335609436035
pure train time :  3.2631280422210693
train time :  6.8279032707214355
end to end time :  69.3639988899231
connection check time:  32.82328152656555
block generation time  25.633026838302612
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.11926436424255371
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0007750988006591797
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02826380729675293
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12023496627807617
len local_batched_seeds_list  15
partition total batch output list spend :  4.0841310024261475
self.buckets_partition() spend  sec:  0.14852523803710938
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.4979574680328369

in edges time spent  0.9000222682952881
local to global src and eids time spent  2.2747442722320557
time gen tails  0.5492074489593506
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3337056636810303

in edges time spent  6.9841272830963135
local to global src and eids time spent  15.72724437713623
time gen tails  3.1912288665771484
res  length 15
block collection to dataloader spend  2.9802322387695312e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.950594902038574  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.611328125 GB
    Memory Allocated: 20.072162628173828  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.611328125 GB
    Memory Allocated: 19.998833179473877  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.611328125 GB
    Memory Allocated: 20.021885871887207  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.611328125 GB
    Memory Allocated: 19.99949073791504  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.611328125 GB
    Memory Allocated: 19.972397804260254  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.06018590927124  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.03825092315674  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.968717098236084  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.86428451538086  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.926875591278076  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.922136783599854  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.911818504333496  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.791447162628174  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.4367618560791  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 0.5435791015625  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3165149688720703
pure train time :  3.2765421867370605
train time :  6.8382463455200195
end to end time :  73.87241339683533
connection check time:  36.41153812408447
block generation time  26.425178050994873
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.13887548446655273
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0007691383361816406
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02532029151916504
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1398329734802246
len local_batched_seeds_list  15
partition total batch output list spend :  4.064610958099365
self.buckets_partition() spend  sec:  0.1651768684387207
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5127038955688477

in edges time spent  0.9616701602935791
local to global src and eids time spent  2.2502689361572266
time gen tails  0.5778954029083252
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.375206470489502

in edges time spent  7.134766578674316
local to global src and eids time spent  15.117621660232544
time gen tails  1.9568722248077393
res  length 15
block collection to dataloader spend  3.0517578125e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.971352577209473  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.991966247558594  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.00524616241455  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.000821590423584  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.08296251296997  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.059552669525146  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.03388738632202  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.963772773742676  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.936216831207275  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.9483060836792  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.83259391784668  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.87082862854004  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.87364387512207  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.79512357711792  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.42714548110962  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 0.5411033630371094  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.81596040725708
pure train time :  3.26595139503479
train time :  6.861557245254517
end to end time :  69.25842261314392
connection check time:  32.22170829772949
block generation time  26.004900217056274
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.13808393478393555
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0005910396575927734
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02852606773376465
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13889408111572266
len local_batched_seeds_list  15
partition total batch output list spend :  4.078047513961792
self.buckets_partition() spend  sec:  0.16744351387023926
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5173108577728271

in edges time spent  0.8248305320739746
local to global src and eids time spent  1.997330904006958
time gen tails  0.5123372077941895
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.277358055114746

in edges time spent  3.8699357509613037
local to global src and eids time spent  8.235059022903442
time gen tails  2.0164592266082764
res  length 15
block collection to dataloader spend  1.7404556274414062e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.001906871795654  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.020137310028076  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.998640537261963  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.00486421585083  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.04453468322754  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.038071155548096  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.00749158859253  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.0133318901062  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.957335472106934  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.896655082702637  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.851149082183838  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.878872394561768  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.91787338256836  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.77632999420166  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.474948406219482  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 0.5448207855224609  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4591972827911377
pure train time :  3.1644582748413086
train time :  6.639109134674072
end to end time :  54.74679350852966
connection check time:  22.12901782989502
block generation time  21.80637526512146
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.11705732345581055
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0006985664367675781
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027330398559570312
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.11795973777770996
len local_batched_seeds_list  15
partition total batch output list spend :  4.05208420753479
self.buckets_partition() spend  sec:  0.14531445503234863
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5011379718780518

in edges time spent  0.9146099090576172
local to global src and eids time spent  2.235633134841919
time gen tails  0.5524148941040039
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.42799973487854

in edges time spent  7.281099319458008
local to global src and eids time spent  16.651553869247437
time gen tails  3.0561506748199463
res  length 15
block collection to dataloader spend  3.409385681152344e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.01672887802124  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.007521629333496  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.981414794921875  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.906858444213867  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.04460859298706  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.02854871749878  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.024383544921875  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.057644844055176  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.966197967529297  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.954398155212402  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.950953006744385  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.874730587005615  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.839945316314697  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.804775714874268  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.412780284881592  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 0.5386538505554199  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3507753610610962
pure train time :  3.2606873512268066
train time :  6.943828105926514
end to end time :  75.44474506378174
connection check time:  37.79853296279907
block generation time  26.555436849594116
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.13906288146972656
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0005729198455810547
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02525186538696289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13983368873596191
len local_batched_seeds_list  15
partition total batch output list spend :  4.09295916557312
self.buckets_partition() spend  sec:  0.16510939598083496
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.49741554260253906

in edges time spent  0.9059550762176514
local to global src and eids time spent  2.2315032482147217
time gen tails  0.5471508502960205
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.338505506515503

in edges time spent  7.028573751449585
local to global src and eids time spent  15.669818878173828
time gen tails  3.0407865047454834
res  length 15
block collection to dataloader spend  3.0994415283203125e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.9428653717041  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.056993007659912  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.977787017822266  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.033668041229248  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.988911628723145  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.057554244995117  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.02626132965088  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.045716762542725  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.96142864227295  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.922009468078613  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.929582595825195  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.819697380065918  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.821446895599365  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.844889640808105  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.435056686401367  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 0.5393142700195312  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2082663774490356
pure train time :  3.2664921283721924
train time :  6.786759376525879
end to end time :  73.43098330497742
connection check time:  36.21866965293884
block generation time  26.22162938117981
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.1419386863708496
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.000850677490234375
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026874780654907227
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.14299559593200684
len local_batched_seeds_list  15
partition total batch output list spend :  4.142257213592529
self.buckets_partition() spend  sec:  0.16990303993225098
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.4942927360534668

in edges time spent  0.9135024547576904
local to global src and eids time spent  2.2849230766296387
time gen tails  0.5571019649505615
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.316431999206543

in edges time spent  7.334933042526245
local to global src and eids time spent  16.587313175201416
time gen tails  3.0781824588775635
res  length 15
block collection to dataloader spend  2.86102294921875e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.950812816619873  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.047829151153564  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.98669719696045  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.537109375 GB
    Memory Allocated: 20.011582374572754  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.073805809020996  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.0291485786438  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.054773330688477  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.997220993041992  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.968581676483154  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.9201979637146  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.872883796691895  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.849474906921387  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.842861652374268  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.75187921524048  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.413817405700684  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 0.5388145446777344  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1116960048675537
pure train time :  3.3264803886413574
train time :  6.904056072235107
end to end time :  75.57944989204407
connection check time:  38.206764698028564
block generation time  26.2084743976593
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.05003190040588379
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0004363059997558594
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024682998657226562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.05063438415527344
len local_batched_seeds_list  15
partition total batch output list spend :  1.4293498992919922
self.buckets_partition() spend  sec:  0.07535028457641602
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.4094529151916504

in edges time spent  0.5245931148529053
local to global src and eids time spent  0.9234669208526611
time gen tails  0.30468058586120605
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  0.9468111991882324

in edges time spent  3.8638083934783936
local to global src and eids time spent  8.236271858215332
time gen tails  3.0185763835906982
res  length 15
block collection to dataloader spend  4.458427429199219e-05
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.947371006011963  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.04892063140869  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.93155336380005  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.00026798248291  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.965845108032227  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.030179023742676  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.027974128723145  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.045433521270752  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.973723888397217  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.9568829536438  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.920589923858643  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.871398448944092  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.842875957489014  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.816843032836914  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.42951536178589  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 0.5397486686706543  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0503095388412476
pure train time :  3.260831594467163
train time :  6.950837135314941
end to end time :  57.213234424591064
connection check time:  22.931427001953125
block generation time  25.804908275604248
end to end time  58.008511543273926
Total (block generation + training)time/epoch 58.008511543273926
