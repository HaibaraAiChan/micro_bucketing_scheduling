main start at this time 1690258273.514736
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  720
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [17, 19, 20]
original bucket_id :,  [6, 4, 3]
remove weights:  [165  95  72], 		------------sum 332

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 132, 53, 46, 31]

remove bucket_id:  [15, 17, 19]
original bucket_id :,  [8, 5, 2]
remove weights:  [211 132  46], 		------------sum 389

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 132, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 181, 53, 31]

remove bucket_id:  [14, 16, 17]
original bucket_id :,  [9, 1, 0]
remove weights:  [253  53  31], 		------------sum 337

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 181, 53, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 181]

remove bucket_id:  [8, 11]
original bucket_id :,  [15, 12]
remove weights:  [388 331], 		------------sum 719

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 181]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 281, 280, 181]

remove bucket_id:  [6, 10]
original bucket_id :,  [17, 11]
remove weights:  [427 281], 		------------sum 708

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 281, 280, 181]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 410, 383, 362, 280, 181]

remove bucket_id:  [6, 9]
original bucket_id :,  [16, 10]
remove weights:  [410 280], 		------------sum 690

before remove weights,  [595, 583, 545, 494, 455, 448, 410, 383, 362, 280, 181]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 383, 362, 181]

remove bucket_id:  [3, 8]
original bucket_id :,  [20, 7]
remove weights:  [494 181], 		------------sum 675

before remove weights,  [595, 583, 545, 494, 455, 448, 383, 362, 181]
after remove pre pack weights,  [595, 583, 545, 455, 448, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 545, 455, 448, 383, 362]
after remove pre pack weights,  [583, 545, 455, 448, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 545, 455, 448, 383, 362]
after remove pre pack weights,  [545, 455, 448, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [545], 		------------sum 545

before remove weights,  [545, 455, 448, 383, 362]
after remove pre pack weights,  [455, 448, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [455], 		------------sum 455

before remove weights,  [455, 448, 383, 362]
after remove pre pack weights,  [448, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 383, 362]
after remove pre pack weights,  [383, 362]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 362]
after remove pre pack weights,  [362]
the last batch value is  362
G_BUCKET_ID_list [[6, 4, 3], [8, 5, 2], [9, 1, 0], [15, 12], [17, 11], [16, 10], [20, 7], [23], [22], [21], [18], [19], [14], [13]]
[[6, 4, 3], [8, 5, 2], [9, 1, 0], [15, 12], [17, 11], [16, 10], [20, 7], [23], [22], [21], [18], [19], [14], [13]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.15195465087890625
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  14
current group_mem  0.3331707757785066
current group_mem  0.3907251984313622
current group_mem  0.338047537382938
current group_mem  0.72043227246394
current group_mem  0.7083503642067068
current group_mem  0.691435714140292
current group_mem  0.6756244314223621
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5455698065359045
current group_mem  0.45594087203866557
current group_mem  0.4482479429953582
current group_mem  0.3834405979819673
current group_mem  0.36230173630435075
batches output list generation spend  0.0004754066467285156
self.weights_list  [0.07455321486892777, 0.07426833052688342, 0.07189768582344293, 0.0728896938002045, 0.07267603054367125, 0.0726404200009157, 0.07222326792863647, 0.06991875709031342, 0.06993401875149437, 0.06964913440945002, 0.06960843664630083, 0.06954739000157704, 0.0700611992613356, 0.07013242034684669]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02337789535522461
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.15270018577575684
len local_batched_seeds_list  14
partition total batch output list spend :  3.8073790073394775
self.buckets_partition() spend  sec:  0.1761016845703125
layer  0
 the number of batches:  14
check_connections_block*********************************

the find indices time spent  0.5105941295623779

in edges time spent  0.90110182762146
local to global src and eids time spent  2.864901065826416
time gen tails  0.5534031391143799
res  length 14
layer  1
num of batch  14
check_connections_block*********************************

the find indices time spent  1.3603272438049316

in edges time spent  7.06282114982605
local to global src and eids time spent  17.1106219291687
time gen tails  2.8427138328552246
res  length 14
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.130859375 GB
    Memory Allocated: 20.889587879180908  GigaBytes
Max Memory Allocated: 21.512313842773438  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.236328125 GB
    Memory Allocated: 20.98595905303955  GigaBytes
Max Memory Allocated: 21.613636016845703  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.15625 GB
    Memory Allocated: 20.81400442123413  GigaBytes
Max Memory Allocated: 21.613636016845703  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.59375 GB
    Memory Allocated: 21.32761573791504  GigaBytes
Max Memory Allocated: 21.963590621948242  GigaBytes

