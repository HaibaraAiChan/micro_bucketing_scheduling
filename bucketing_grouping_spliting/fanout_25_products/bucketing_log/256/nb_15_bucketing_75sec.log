main start at this time 1690258613.5587363
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.1385490894317627
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0005457401275634766
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02344536781311035
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13944697380065918
len local_batched_seeds_list  15
partition total batch output list spend :  4.061813592910767
self.buckets_partition() spend  sec:  0.1629161834716797
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.49340033531188965

in edges time spent  0.9132535457611084
local to global src and eids time spent  2.967196464538574
time gen tails  0.5662188529968262
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.326904058456421

in edges time spent  7.153501987457275
local to global src and eids time spent  17.533310174942017
time gen tails  3.0263679027557373
res  length 15
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.15234375 GB
    Memory Allocated: 19.969828128814697  GigaBytes
Max Memory Allocated: 20.558085441589355  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.25390625 GB
    Memory Allocated: 20.032952308654785  GigaBytes
Max Memory Allocated: 20.62508726119995  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.255859375 GB
    Memory Allocated: 19.999154567718506  GigaBytes
Max Memory Allocated: 20.62508726119995  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.255859375 GB
    Memory Allocated: 20.005807876586914  GigaBytes
Max Memory Allocated: 20.62508726119995  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.291015625 GB
    Memory Allocated: 20.07356834411621  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.29296875 GB
    Memory Allocated: 20.027546405792236  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.3046875 GB
    Memory Allocated: 20.025334358215332  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.310546875 GB
    Memory Allocated: 19.99888563156128  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.967864990234375  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.889095783233643  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.873989582061768  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.823554515838623  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.900492668151855  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.802420616149902  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 19.37135934829712  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 0.5374093055725098  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.390896320343018
pure train time :  4.01214861869812
train time :  8.489465236663818
end to end time :  78.58892846107483
connection check time:  38.57998466491699
block generation time  27.327199935913086
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.11974048614501953
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0006237030029296875
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030655860900878906
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12055253982543945
len local_batched_seeds_list  15
partition total batch output list spend :  4.020766258239746
self.buckets_partition() spend  sec:  0.15130996704101562
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.4795100688934326

in edges time spent  0.9981226921081543
local to global src and eids time spent  2.9338009357452393
time gen tails  0.584846019744873
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3059852123260498

in edges time spent  7.151116609573364
local to global src and eids time spent  17.919103622436523
time gen tails  3.030895471572876
res  length 15
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.3125 GB
    Memory Allocated: 20.022510051727295  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.31640625 GB
    Memory Allocated: 20.00730562210083  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.31640625 GB
    Memory Allocated: 19.99577522277832  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.31640625 GB
    Memory Allocated: 20.034401416778564  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.31640625 GB
    Memory Allocated: 19.975385665893555  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.31640625 GB
    Memory Allocated: 19.9854736328125  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.067371368408203  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.985804080963135  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.958833694458008  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.924574375152588  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.88339138031006  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.872636795043945  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.89017105102539  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.843557834625244  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.400485038757324  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 0.5366005897521973  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.871942520141602
pure train time :  3.241000175476074
train time :  6.9883270263671875
end to end time :  77.36283087730408
connection check time:  39.42630743980408
block generation time  26.796640157699585
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.14000368118286133
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0005972385406494141
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024569034576416016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.14081621170043945
len local_batched_seeds_list  15
partition total batch output list spend :  4.058557033538818
self.buckets_partition() spend  sec:  0.16541004180908203
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.49847412109375

in edges time spent  0.9204018115997314
local to global src and eids time spent  2.976269483566284
time gen tails  0.5566022396087646
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3729581832885742

in edges time spent  7.3273701667785645
local to global src and eids time spent  18.555999994277954
time gen tails  3.1795477867126465
res  length 15
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.94367742538452  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.05465841293335  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.98225450515747  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.000791549682617  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.050011157989502  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.04021978378296  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.02635431289673  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 20.056705474853516  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.947765350341797  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.98355722427368  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.883254528045654  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.835423469543457  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.868813514709473  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.72985601425171  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.41578435897827  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 0.5430316925048828  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5988335609436035
pure train time :  3.273026943206787
train time :  6.872558355331421
end to end time :  79.1740882396698
connection check time:  40.960732221603394
block generation time  27.170945405960083
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.05060267448425293
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0004839897155761719
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025419950485229492
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.051232337951660156
len local_batched_seeds_list  15
partition total batch output list spend :  2.941723108291626
self.buckets_partition() spend  sec:  0.07666993141174316
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.49156880378723145

in edges time spent  0.9104814529418945
local to global src and eids time spent  2.965287446975708
time gen tails  0.5412003993988037
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3547565937042236

in edges time spent  7.130594730377197
local to global src and eids time spent  17.536226749420166
time gen tails  3.0243260860443115
res  length 15
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.609375 GB
    Memory Allocated: 19.950594902038574  GigaBytes
Max Memory Allocated: 20.664143085479736  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.611328125 GB
    Memory Allocated: 20.072162628173828  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.611328125 GB
    Memory Allocated: 19.998833179473877  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.611328125 GB
    Memory Allocated: 20.021885871887207  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.611328125 GB
    Memory Allocated: 19.99949073791504  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.611328125 GB
    Memory Allocated: 19.972397804260254  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.06018590927124  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.03825092315674  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.968717098236084  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.86428451538086  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.926875591278076  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.922136783599854  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.911818504333496  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.791447162628174  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.4367618560791  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 0.5435791015625  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3165149688720703
pure train time :  3.263061285018921
train time :  6.904848575592041
end to end time :  74.60086345672607
connection check time:  38.73751783370972
block generation time  25.924211502075195
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.1387190818786621
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0006124973297119141
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025754690170288086
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1395258903503418
len local_batched_seeds_list  15
partition total batch output list spend :  4.087857007980347
self.buckets_partition() spend  sec:  0.16530561447143555
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5102345943450928

in edges time spent  0.9208400249481201
local to global src and eids time spent  2.9392988681793213
time gen tails  0.5538938045501709
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3472192287445068

in edges time spent  7.06055474281311
local to global src and eids time spent  17.383085250854492
time gen tails  2.8894705772399902
res  length 15
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.971352577209473  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.991966247558594  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.00524616241455  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.000821590423584  GigaBytes
Max Memory Allocated: 20.66417932510376  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.08296251296997  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.059552669525146  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.03388738632202  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.963772773742676  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.936216831207275  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.9483060836792  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.83259391784668  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.87082862854004  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.87364387512207  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.79512357711792  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.42714548110962  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 0.5411033630371094  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.81596040725708
pure train time :  3.259999990463257
train time :  6.693496465682983
end to end time :  74.39524149894714
connection check time:  37.86979699134827
block generation time  25.637353897094727
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.1377410888671875
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0006136894226074219
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025480985641479492
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13854742050170898
len local_batched_seeds_list  15
partition total batch output list spend :  4.09417462348938
self.buckets_partition() spend  sec:  0.16405177116394043
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5004823207855225

in edges time spent  0.8893280029296875
local to global src and eids time spent  2.787818193435669
time gen tails  0.307234525680542
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  0.8987283706665039

in edges time spent  3.868725061416626
local to global src and eids time spent  11.974188566207886
time gen tails  2.9379689693450928
res  length 15
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.001906871795654  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.020137310028076  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.998640537261963  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.00486421585083  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.04453468322754  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.038071155548096  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.00749158859253  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.0133318901062  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.957335472106934  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.896655082702637  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.851149082183838  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.878872394561768  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.91787338256836  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.77632999420166  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.474948406219482  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 0.5448207855224609  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4591972827911377
pure train time :  3.2221438884735107
train time :  6.818163156509399
end to end time :  66.13498592376709
connection check time:  28.276177406311035
block generation time  26.820078372955322
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.13908743858337402
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0008687973022460938
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025048494338989258
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.140150785446167
len local_batched_seeds_list  15
partition total batch output list spend :  4.070075988769531
self.buckets_partition() spend  sec:  0.16522502899169922
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.50970458984375

in edges time spent  0.9554557800292969
local to global src and eids time spent  3.015216827392578
time gen tails  0.579287052154541
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.342325210571289

in edges time spent  7.1489739418029785
local to global src and eids time spent  17.654494524002075
time gen tails  3.0058233737945557
res  length 15
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.01672887802124  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.007521629333496  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.981414794921875  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.906858444213867  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.04460859298706  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.02854871749878  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.024383544921875  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.057644844055176  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.966197967529297  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.954398155212402  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.950953006744385  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.874730587005615  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.839945316314697  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.804775714874268  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.412780284881592  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 0.5386538505554199  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3507753610610962
pure train time :  3.2832696437835693
train time :  6.883131504058838
end to end time :  76.20283055305481
connection check time:  38.65803050994873
block generation time  26.4802827835083
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.1482396125793457
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0006990432739257812
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024770259857177734
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.14914512634277344
len local_batched_seeds_list  15
partition total batch output list spend :  4.155681848526001
self.buckets_partition() spend  sec:  0.17394351959228516
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5083112716674805

in edges time spent  0.9035756587982178
local to global src and eids time spent  2.9620251655578613
time gen tails  0.5471949577331543
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.3551898002624512

in edges time spent  7.165784597396851
local to global src and eids time spent  17.459920167922974
time gen tails  3.0190627574920654
res  length 15
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.9428653717041  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.056993007659912  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.977787017822266  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.033668041229248  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.988911628723145  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.057554244995117  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.02626132965088  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.045716762542725  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.96142864227295  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.922009468078613  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.929582595825195  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.819697380065918  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.821446895599365  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.844889640808105  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.435056686401367  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 0.5393142700195312  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2082663774490356
pure train time :  3.2665746212005615
train time :  6.783064126968384
end to end time :  75.21394801139832
connection check time:  38.29373598098755
block generation time  25.853552103042603
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.1390540599822998
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0005788803100585938
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024483203887939453
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13980817794799805
len local_batched_seeds_list  15
partition total batch output list spend :  4.109989166259766
self.buckets_partition() spend  sec:  0.16431427001953125
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.4936256408691406

in edges time spent  0.9139626026153564
local to global src and eids time spent  2.9639079570770264
time gen tails  0.5538351535797119
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.325047492980957

in edges time spent  7.067769289016724
local to global src and eids time spent  17.316333055496216
time gen tails  2.9399423599243164
res  length 15
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.950812816619873  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 20.047829151153564  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.53125 GB
    Memory Allocated: 19.98669719696045  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.537109375 GB
    Memory Allocated: 20.011582374572754  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.073805809020996  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.0291485786438  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.054773330688477  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.997220993041992  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.968581676483154  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.9201979637146  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.872883796691895  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.849474906921387  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.842861652374268  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.75187921524048  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.413817405700684  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 0.5388145446777344  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1116960048675537
pure train time :  3.3610341548919678
train time :  6.9381139278411865
end to end time :  74.64529752731323
connection check time:  37.87821888923645
block generation time  25.604255437850952
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  600
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 16, 23]
original bucket_id :,  [15, 7, 0]
remove weights:  [388 181  31], 		------------sum 600

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]

remove bucket_id:  [9, 15, 18]
original bucket_id :,  [13, 6, 3]
remove weights:  [362 165  72], 		------------sum 599

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 280, 253, 211, 165, 132, 95, 72, 53, 46]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]

remove bucket_id:  [2, 16]
original bucket_id :,  [21, 1]
remove weights:  [545  53], 		------------sum 598

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 53, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]

remove bucket_id:  [11, 12, 13]
original bucket_id :,  [9, 8, 5]
remove weights:  [253 211 132], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 253, 211, 132, 95, 46]
after remove pre pack weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]

remove bucket_id:  [3, 11, 12]
original bucket_id :,  [18, 4, 2]
remove weights:  [455  95  46], 		------------sum 596

before remove weights,  [595, 583, 494, 455, 448, 427, 410, 383, 331, 281, 280, 95, 46]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331, 281, 280]

remove bucket_id:  [6, 7]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [494, 448, 427, 410, 383, 331, 281, 280]
after remove pre pack weights,  [494, 448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 383, 331]
after remove pre pack weights,  [448, 427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 383, 331]
after remove pre pack weights,  [427, 410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 383, 331]
after remove pre pack weights,  [410, 383, 331]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 383, 331]
after remove pre pack weights,  [383, 331]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 331]
after remove pre pack weights,  [331]
the last batch value is  331
G_BUCKET_ID_list [[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
[[15, 7, 0], [13, 6, 3], [21, 1], [9, 8, 5], [18, 4, 2], [23], [22], [11, 10], [20], [19], [17], [16], [14], [12]]
G_BUCKET_ID_list length 14
backpack scheduling spend  0.13798975944519043
len(g_bucket_nids_list)  14
len(local_split_batches_nid_list)  15
current group_mem  0.6013873588498214
current group_mem  0.6000592674818113
current group_mem  0.599016251593739
current group_mem  0.5968156304628109
current group_mem  0.5982644539067866
current group_mem  0.5952225418284881
current group_mem  0.5838345744003708
current group_mem  0.5622422140780288
current group_mem  0.494359802184077
current group_mem  0.4482479429953582
current group_mem  0.427057239492208
current group_mem  0.4104866247767621
current group_mem  0.3834405979819673
current group_mem  0.33190986587898375
batches output list generation spend  0.0005946159362792969
self.weights_list  [0.06880465582410426, 0.07138387656368436, 0.0663322667127908, 0.0711803877479384, 0.06933372674504377, 0.06547761368665775, 0.0654928753478387, 0.06833663154788855, 0.06517746768343245, 0.06510624659792136, 0.06526903765051813, 0.06502485107162298, 0.06562005585767992, 0.06532499707484828, 0.06213530988803028]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02475738525390625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13878464698791504
len local_batched_seeds_list  15
partition total batch output list spend :  3.9763717651367188
self.buckets_partition() spend  sec:  0.16356396675109863
layer  0
 the number of batches:  15
check_connections_block*********************************

the find indices time spent  0.5032224655151367

in edges time spent  0.9209394454956055
local to global src and eids time spent  2.9614691734313965
time gen tails  0.5513002872467041
res  length 15
layer  1
num of batch  15
check_connections_block*********************************

the find indices time spent  1.34672212600708

in edges time spent  7.088398694992065
local to global src and eids time spent  17.490292072296143
time gen tails  2.8996663093566895
res  length 15
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.947371006011963  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.04892063140869  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.93155336380005  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.00026798248291  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.965845108032227  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.030179023742676  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.027974128723145  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 20.045433521270752  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.973723888397217  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.9568829536438  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.920589923858643  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.871398448944092  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.842875957489014  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.816843032836914  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 19.42951536178589  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.541015625 GB
    Memory Allocated: 0.5397486686706543  GigaBytes
Max Memory Allocated: 20.67337989807129  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0503095388412476
pure train time :  3.26611590385437
train time :  6.765234708786011
end to end time :  74.37094688415527
connection check time:  38.02740788459778
block generation time  25.499861478805542
end to end time  75.15912413597107
Total (block generation + training)time/epoch 75.15912413597107
