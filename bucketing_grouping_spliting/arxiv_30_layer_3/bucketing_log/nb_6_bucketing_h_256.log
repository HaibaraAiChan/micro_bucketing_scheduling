main start at this time 1689293463.5621932
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
dtype  torch.int64
data type  <class 'torch.Tensor'>
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05002188682556152
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
[tensor([   23,    39,    55,  ..., 15668, 15678, 15680]), tensor([15685, 15693, 15701,  ..., 30961, 30962, 30967]), tensor([30980, 30987, 31012,  ..., 45994, 46026, 46053]), tensor([46068, 46081, 46093,  ..., 61023, 61044, 61045]), tensor([61078, 61088, 61089,  ..., 75419, 75430, 75438]), tensor([75496, 75507, 75514,  ..., 90924, 90929, 90935])]
self.K  6
the grouping_fanout_arxiv called successfully
capacity  14000
sorted_dict  {0: 11091, 1: 7949, 2: 4247, 3: 3767, 4: 3521, 5: 3317, 6: 3113, 7: 2949, 8: 2783, 9: 2690, 10: 2478, 11: 2473, 12: 2424, 13: 2342, 14: 2250, 16: 2139, 15: 2088, 18: 2028, 17: 2014, 20: 1927, 19: 1895, 22: 1802, 21: 1764, 23: 1743, 25: 1678, 24: 1624, 26: 1585, 27: 1557, 28: 1508}

weights after sort [11091, 7949, 4247, 3767, 3521, 3317, 3113, 2949, 2783, 2690, 2478, 2473, 2424, 2342, 2250, 2139, 2088, 2028, 2014, 1927, 1895, 1802, 1764, 1743, 1678, 1624, 1585, 1557, 1508]
res_tmp  [3317 2949 2783 2478 2473]

remove bucket_id:  [5, 7, 8, 10, 11]
original bucket_id :,  [5, 7, 8, 10, 11]
remove weights:  [3317 2949 2783 2478 2473], 		------------sum 14000

before remove weights,  [11091, 7949, 4247, 3767, 3521, 3317, 3113, 2949, 2783, 2690, 2478, 2473, 2424, 2342, 2250, 2139, 2088, 2028, 2014, 1927, 1895, 1802, 1764, 1743, 1678, 1624, 1585, 1557, 1508]
after remove pre pack weights,  [11091, 7949, 4247, 3767, 3521, 3113, 2690, 2424, 2342, 2250, 2139, 2088, 2028, 2014, 1927, 1895, 1802, 1764, 1743, 1678, 1624, 1585, 1557, 1508]
res_tmp  [3767 3113 2690 2342 2088]

remove bucket_id:  [3, 5, 6, 8, 11]
original bucket_id :,  [3, 6, 9, 13, 15]
remove weights:  [3767 3113 2690 2342 2088], 		------------sum 14000

before remove weights,  [11091, 7949, 4247, 3767, 3521, 3113, 2690, 2424, 2342, 2250, 2139, 2088, 2028, 2014, 1927, 1895, 1802, 1764, 1743, 1678, 1624, 1585, 1557, 1508]
after remove pre pack weights,  [11091, 7949, 4247, 3521, 2424, 2250, 2139, 2028, 2014, 1927, 1895, 1802, 1764, 1743, 1678, 1624, 1585, 1557, 1508]
res_tmp  [4247 2139 2028 1927 1895 1764]

remove bucket_id:  [2, 6, 7, 9, 10, 12]
original bucket_id :,  [2, 16, 18, 20, 19, 21]
remove weights:  [4247 2139 2028 1927 1895 1764], 		------------sum 14000

before remove weights,  [11091, 7949, 4247, 3521, 2424, 2250, 2139, 2028, 2014, 1927, 1895, 1802, 1764, 1743, 1678, 1624, 1585, 1557, 1508]
after remove pre pack weights,  [11091, 7949, 3521, 2424, 2250, 2014, 1802, 1743, 1678, 1624, 1585, 1557, 1508]
res_tmp  [7949 2424 2014 1585]

remove bucket_id:  [1, 3, 5, 10]
original bucket_id :,  [1, 12, 17, 26]
remove weights:  [7949 2424 2014 1585], 		------------sum 13972

before remove weights,  [11091, 7949, 3521, 2424, 2250, 2014, 1802, 1743, 1678, 1624, 1585, 1557, 1508]
after remove pre pack weights,  [11091, 3521, 2250, 1802, 1743, 1678, 1624, 1557, 1508]
res_tmp  [3521 2250 1802 1678 1624 1557 1508]

remove bucket_id:  [2, 3, 5, 6, 7, 8]
original bucket_id :,  [14, 22, 25, 24, 27, 28]
remove weights:  [2250 1802 1678 1624 1557 1508], 		------------sum 10419

before remove weights,  [11091, 3521, 2250, 1802, 1743, 1678, 1624, 1557, 1508]
after remove pre pack weights,  [11091, 3521, 1743]
res_tmp  [11091  1743]

remove bucket_id:  [0, 2]
original bucket_id :,  [0, 23]
remove weights:  [11091  1743], 		------------sum 12834

before remove weights,  [11091, 3521, 1743]
after remove pre pack weights,  [3521]
the last batch value is  3521
G_BUCKET_ID_list [[5, 7, 8, 10, 11], [3, 6, 9, 13, 15], [2, 16, 18, 20, 19, 21], [1, 12, 17, 26], [14, 22, 25, 24, 27, 28], [0, 23], [], [], [], [], [], [], [4]]
Groups_mem_list  [[3317, 2949, 2783, 2478, 2473], [3767, 3113, 2690, 2342, 2088], [4247, 2139, 2028, 1927, 1895, 1764], [7949, 2424, 2014, 1585], [2250, 1802, 1678, 1624, 1557, 1508], [11091, 1743], [], [], [], [], [], [], [3521], [3521]]
------------errror-----------------
G_BUCKET_ID_list length 13
backpack scheduling spend  1.6570231914520264
13
6
[5, 7, 8, 10, 11]
current group_mem  14.001344088525427
[3, 6, 9, 13, 15]
current group_mem  14.003051349938403
[2, 16, 18, 20, 19, 21]
current group_mem  14.003075485631658
[1, 12, 17, 26]
current group_mem  13.973659992093964
[14, 22, 25, 24, 27, 28]
current group_mem  10.421641676054763
[0, 23]
current group_mem  12.834885887476915
[]
current group_mem  0
