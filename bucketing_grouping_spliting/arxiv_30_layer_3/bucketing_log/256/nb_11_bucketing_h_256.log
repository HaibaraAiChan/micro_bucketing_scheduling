main start at this time 1689365424.7221084
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
dtype  torch.int64
data type  <class 'torch.Tensor'>
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04657578468322754
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  11
the grouping_fanout_arxiv called successfully
capacity  8000
 
G_BUCKET_ID_list [[0], [1], [2, 4], [3, 5], [6, 7, 20], [8, 9, 10], [11, 12, 13], [14, 16, 15, 28], [18, 17, 19, 22], [21, 23, 25, 24], [26, 27]]
Groups_mem_list  [11091, 7949, 7768, 7084, 7989, 7951, 7239, 7985, 7739, 6809, 3142]
G_BUCKET_ID_list length 11
backpack scheduling spend  0.35547757148742676
11
11
[0]
current group_mem  11.09133707869788
[1]
current group_mem  7.949351660231331
[2, 4]
current group_mem  7.76984250752779
[3, 5]
current group_mem  7.084985542575888
[6, 7, 20]
current group_mem  7.99024774528462
[8, 9, 10]
current group_mem  7.951499921539595
[11, 12, 13]
current group_mem  7.240351491430146
[14, 16, 15, 28]
current group_mem  7.987057778998564
[18, 17, 19, 22]
current group_mem  7.740720913840779
[21, 23, 25, 24]
current group_mem  6.810720823916322
[26, 27]
current group_mem  3.1434549290358977
batches output list generation spend  0.0008568763732910156
self.weights_list  [0.15513354812460825, 0.13619819443375375, 0.17790655479926545, 0.14149833408473625, 0.09801959512211214, 0.09300535512035275, 0.06275497300447543, 0.04881186703467083, 0.0416753719444475, 0.02917276036111325, 0.015823445970464367]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021754026412963867
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.3566570281982422
len local_batched_seeds_list  11
partition total batch output list spend :  0.8034765720367432
self.buckets_partition() spend  sec:  0.37845802307128906
layer  0
 the number of batches:  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.529296875 GB
    Memory Allocated: 0.08779191970825195  GigaBytes
Max Memory Allocated: 0.08779191970825195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.80078125 GB
    Memory Allocated: 12.955834865570068  GigaBytes
Max Memory Allocated: 13.011445045471191  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.80078125 GB
    Memory Allocated: 12.958099842071533  GigaBytes
Max Memory Allocated: 13.011445045471191  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.57421875 GB
    Memory Allocated: 0.10768842697143555  GigaBytes
Max Memory Allocated: 13.011445045471191  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.41796875 GB
    Memory Allocated: 14.263975143432617  GigaBytes
Max Memory Allocated: 14.327852725982666  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.41796875 GB
    Memory Allocated: 14.266049861907959  GigaBytes
Max Memory Allocated: 14.327852725982666  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.27734375 GB
    Memory Allocated: 0.12426519393920898  GigaBytes
Max Memory Allocated: 14.327852725982666  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.84375 GB
    Memory Allocated: 18.04802417755127  GigaBytes
Max Memory Allocated: 18.152076244354248  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.84375 GB
    Memory Allocated: 18.05054235458374  GigaBytes
Max Memory Allocated: 18.152076244354248  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.04296875 GB
    Memory Allocated: 0.14252233505249023  GigaBytes
Max Memory Allocated: 18.152076244354248  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 18.170830249786377  GigaBytes
Max Memory Allocated: 18.26975393295288  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.65234375 GB
    Memory Allocated: 18.173051834106445  GigaBytes
Max Memory Allocated: 18.26975393295288  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.41796875 GB
    Memory Allocated: 0.16014766693115234  GigaBytes
Max Memory Allocated: 18.26975393295288  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.30859375 GB
    Memory Allocated: 19.55716609954834  GigaBytes
Max Memory Allocated: 19.661177158355713  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.30859375 GB
    Memory Allocated: 19.558539867401123  GigaBytes
Max Memory Allocated: 19.661177158355713  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.869140625 GB
    Memory Allocated: 0.17850017547607422  GigaBytes
Max Memory Allocated: 19.661177158355713  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.572265625 GB
    Memory Allocated: 19.84346914291382  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.572265625 GB
    Memory Allocated: 19.8448429107666  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.57421875 GB
    Memory Allocated: 0.19848060607910156  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.794921875 GB
    Memory Allocated: 19.083940029144287  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.794921875 GB
    Memory Allocated: 19.08479118347168  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.796875 GB
    Memory Allocated: 0.21809768676757812  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.767578125 GB
    Memory Allocated: 19.0706205368042  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.767578125 GB
    Memory Allocated: 19.071282863616943  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.76953125 GB
    Memory Allocated: 0.23621177673339844  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.82421875 GB
    Memory Allocated: 18.670358657836914  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.82421875 GB
    Memory Allocated: 18.670924186706543  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.82421875 GB
    Memory Allocated: 0.2553067207336426  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90234375 GB
    Memory Allocated: 17.333409309387207  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.90234375 GB
    Memory Allocated: 17.333805561065674  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.904296875 GB
    Memory Allocated: 0.2661118507385254  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03125 GB
    Memory Allocated: 13.84491777420044  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03125 GB
    Memory Allocated: 13.845132827758789  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 0.2922492027282715  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.9956674575805664
pure train time :  5.604205846786499
train time :  7.4837400913238525
end to end time :  32.279799699783325
connection check time:  9.517934560775757
block generation time  14.449593544006348
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.0527803897857666
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  11
the grouping_fanout_arxiv called successfully
capacity  8000
 
G_BUCKET_ID_list [[0], [1], [2, 4], [3, 5], [6, 7, 20], [8, 9, 10], [11, 12, 13], [14, 16, 15, 28], [18, 17, 19, 22], [21, 23, 25, 24], [26, 27]]
Groups_mem_list  [11091, 7949, 7768, 7084, 7989, 7951, 7239, 7985, 7739, 6809, 3142]
G_BUCKET_ID_list length 11
backpack scheduling spend  0.3690652847290039
11
11
[0]
current group_mem  11.09133707869788
[1]
current group_mem  7.949351660231331
[2, 4]
current group_mem  7.76984250752779
[3, 5]
current group_mem  7.084985542575888
[6, 7, 20]
current group_mem  7.99024774528462
[8, 9, 10]
current group_mem  7.951499921539595
[11, 12, 13]
current group_mem  7.240351491430146
[14, 16, 15, 28]
current group_mem  7.987057778998564
[18, 17, 19, 22]
current group_mem  7.740720913840779
[21, 23, 25, 24]
current group_mem  6.810720823916322
[26, 27]
current group_mem  3.1434549290358977
batches output list generation spend  0.0006082057952880859
self.weights_list  [0.15513354812460825, 0.13619819443375375, 0.17790655479926545, 0.14149833408473625, 0.09801959512211214, 0.09300535512035275, 0.06275497300447543, 0.04881186703467083, 0.0416753719444475, 0.02917276036111325, 0.015823445970464367]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01806163787841797
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.36995363235473633
len local_batched_seeds_list  11
partition total batch output list spend :  0.6913604736328125
self.buckets_partition() spend  sec:  0.3880655765533447
layer  0
 the number of batches:  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 0.11791658401489258  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 12.967686176300049  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 12.956011772155762  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 0.11961221694946289  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 14.415793418884277  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 14.417859554290771  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 0.13565874099731445  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 18.086149215698242  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 18.088560581207275  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 0.15405941009521484  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 18.185519695281982  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 18.187687873840332  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 0.17241382598876953  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 19.799767017364502  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03515625 GB
    Memory Allocated: 19.80128765106201  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.736328125 GB
    Memory Allocated: 0.1917405128479004  GigaBytes
Max Memory Allocated: 19.951279163360596  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.447265625 GB
    Memory Allocated: 19.974979877471924  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.447265625 GB
    Memory Allocated: 19.97635269165039  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.30078125 GB
    Memory Allocated: 0.21136236190795898  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.68359375 GB
    Memory Allocated: 18.973342418670654  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.68359375 GB
    Memory Allocated: 18.974193572998047  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.685546875 GB
    Memory Allocated: 0.23035144805908203  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.01953125 GB
    Memory Allocated: 19.036765098571777  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.01953125 GB
    Memory Allocated: 19.03742742538452  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.021484375 GB
    Memory Allocated: 0.24816608428955078  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.072265625 GB
    Memory Allocated: 18.626099586486816  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.072265625 GB
    Memory Allocated: 18.626665115356445  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.072265625 GB
    Memory Allocated: 0.26466894149780273  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.142578125 GB
    Memory Allocated: 17.157135009765625  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.142578125 GB
    Memory Allocated: 17.157531261444092  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.146484375 GB
    Memory Allocated: 0.2757272720336914  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.2421875 GB
    Memory Allocated: 13.794571876525879  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.2421875 GB
    Memory Allocated: 13.794786930084229  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 0.2899932861328125  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.557847261428833
pure train time :  4.942900896072388
train time :  6.274372100830078
end to end time :  31.487189531326294
connection check time:  9.534911155700684
block generation time  14.960890531539917
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05395650863647461
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  11
the grouping_fanout_arxiv called successfully
capacity  8000
 
G_BUCKET_ID_list [[0], [1], [2, 4], [3, 5], [6, 7, 20], [8, 9, 10], [11, 12, 13], [14, 16, 15, 28], [18, 17, 19, 22], [21, 23, 25, 24], [26, 27]]
Groups_mem_list  [11091, 7949, 7768, 7084, 7989, 7951, 7239, 7985, 7739, 6809, 3142]
G_BUCKET_ID_list length 11
backpack scheduling spend  0.39008069038391113
11
11
[0]
current group_mem  11.09133707869788
[1]
current group_mem  7.949351660231331
[2, 4]
current group_mem  7.76984250752779
[3, 5]
current group_mem  7.084985542575888
[6, 7, 20]
current group_mem  7.99024774528462
[8, 9, 10]
current group_mem  7.951499921539595
[11, 12, 13]
current group_mem  7.240351491430146
[14, 16, 15, 28]
current group_mem  7.987057778998564
[18, 17, 19, 22]
current group_mem  7.740720913840779
[21, 23, 25, 24]
current group_mem  6.810720823916322
[26, 27]
current group_mem  3.1434549290358977
batches output list generation spend  0.0006415843963623047
self.weights_list  [0.15513354812460825, 0.13619819443375375, 0.17790655479926545, 0.14149833408473625, 0.09801959512211214, 0.09300535512035275, 0.06275497300447543, 0.04881186703467083, 0.0416753719444475, 0.02917276036111325, 0.015823445970464367]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01893162727355957
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.39103198051452637
len local_batched_seeds_list  11
partition total batch output list spend :  0.6816585063934326
self.buckets_partition() spend  sec:  0.4100172519683838
layer  0
 the number of batches:  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 0.11709737777709961  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 12.993731498718262  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 12.983667850494385  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 0.11997509002685547  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 14.235066413879395  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 14.23707914352417  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 0.13577556610107422  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 18.12324810028076  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 18.125787258148193  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 0.15405845642089844  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 18.21796989440918  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 18.219984531402588  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24609375 GB
    Memory Allocated: 0.1718769073486328  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.732421875 GB
    Memory Allocated: 19.70107889175415  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.732421875 GB
    Memory Allocated: 19.70242214202881  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.908203125 GB
    Memory Allocated: 0.19062566757202148  GigaBytes
Max Memory Allocated: 20.083070278167725  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.005859375 GB
    Memory Allocated: 19.981610774993896  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.005859375 GB
    Memory Allocated: 19.982954025268555  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 0.21032953262329102  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 19.0654354095459  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 19.06628656387329  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 0.22816705703735352  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 19.05808734893799  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 19.058749675750732  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 0.24710607528686523  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 18.683480739593506  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 18.684046268463135  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 0.2650880813598633  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 17.28449583053589  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 17.284892082214355  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.716796875 GB
    Memory Allocated: 0.2761235237121582  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.759765625 GB
    Memory Allocated: 13.92779541015625  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.759765625 GB
    Memory Allocated: 13.9280104637146  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.29202795028686523  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.327911376953125
pure train time :  4.7755725383758545
train time :  6.182970285415649
end to end time :  31.086069345474243
connection check time:  9.683339595794678
block generation time  14.513238430023193
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05725884437561035
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  11
the grouping_fanout_arxiv called successfully
capacity  8000
 
G_BUCKET_ID_list [[0], [1], [2, 4], [3, 5], [6, 7, 20], [8, 9, 10], [11, 12, 13], [14, 16, 15, 28], [18, 17, 19, 22], [21, 23, 25, 24], [26, 27]]
Groups_mem_list  [11091, 7949, 7768, 7084, 7989, 7951, 7239, 7985, 7739, 6809, 3142]
G_BUCKET_ID_list length 11
backpack scheduling spend  0.38610005378723145
11
11
[0]
current group_mem  11.09133707869788
[1]
current group_mem  7.949351660231331
[2, 4]
current group_mem  7.76984250752779
[3, 5]
current group_mem  7.084985542575888
[6, 7, 20]
current group_mem  7.99024774528462
[8, 9, 10]
current group_mem  7.951499921539595
[11, 12, 13]
current group_mem  7.240351491430146
[14, 16, 15, 28]
current group_mem  7.987057778998564
[18, 17, 19, 22]
current group_mem  7.740720913840779
[21, 23, 25, 24]
current group_mem  6.810720823916322
[26, 27]
current group_mem  3.1434549290358977
batches output list generation spend  0.0006554126739501953
self.weights_list  [0.15513354812460825, 0.13619819443375375, 0.17790655479926545, 0.14149833408473625, 0.09801959512211214, 0.09300535512035275, 0.06275497300447543, 0.04881186703467083, 0.0416753719444475, 0.02917276036111325, 0.015823445970464367]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0171048641204834
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.38707900047302246
len local_batched_seeds_list  11
partition total batch output list spend :  0.8298442363739014
self.buckets_partition() spend  sec:  0.4042501449584961
layer  0
 the number of batches:  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.11752986907958984  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.940950870513916  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.929621696472168  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.11933040618896484  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.3606538772583  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.362578868865967  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.13657474517822266  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.089374542236328  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.09182119369507  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.1539936065673828  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.294196128845215  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.29637098312378  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.17206144332885742  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.715200424194336  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.716726779937744  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.19324684143066406  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.914769649505615  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.916136741638184  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.2138667106628418  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.988812923431396  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.98966407775879  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.2320418357849121  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.034884929656982  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.035547256469727  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.25172996520996094  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.63906717300415  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.63963270187378  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.26950645446777344  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.276902675628662  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.27729892730713  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.2800588607788086  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.848065376281738  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.848280429840088  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.29674530029296875  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2071340084075928
pure train time :  4.785488128662109
train time :  6.031559944152832
end to end time :  30.915518522262573
connection check time:  9.555813550949097
block generation time  14.472518682479858
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05103111267089844
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  11
the grouping_fanout_arxiv called successfully
capacity  8000
 
G_BUCKET_ID_list [[0], [1], [2, 4], [3, 5], [6, 7, 20], [8, 9, 10], [11, 12, 13], [14, 16, 15, 28], [18, 17, 19, 22], [21, 23, 25, 24], [26, 27]]
Groups_mem_list  [11091, 7949, 7768, 7084, 7989, 7951, 7239, 7985, 7739, 6809, 3142]
G_BUCKET_ID_list length 11
backpack scheduling spend  0.26592183113098145
11
11
[0]
current group_mem  11.09133707869788
[1]
current group_mem  7.949351660231331
[2, 4]
current group_mem  7.76984250752779
[3, 5]
current group_mem  7.084985542575888
[6, 7, 20]
current group_mem  7.99024774528462
[8, 9, 10]
current group_mem  7.951499921539595
[11, 12, 13]
current group_mem  7.240351491430146
[14, 16, 15, 28]
current group_mem  7.987057778998564
[18, 17, 19, 22]
current group_mem  7.740720913840779
[21, 23, 25, 24]
current group_mem  6.810720823916322
[26, 27]
current group_mem  3.1434549290358977
batches output list generation spend  0.00066375732421875
self.weights_list  [0.15513354812460825, 0.13619819443375375, 0.17790655479926545, 0.14149833408473625, 0.09801959512211214, 0.09300535512035275, 0.06275497300447543, 0.04881186703467083, 0.0416753719444475, 0.02917276036111325, 0.015823445970464367]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0171506404876709
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.2669081687927246
len local_batched_seeds_list  11
partition total batch output list spend :  0.6985957622528076
self.buckets_partition() spend  sec:  0.28411245346069336
layer  0
 the number of batches:  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.11846065521240234  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.916839599609375  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.905106544494629  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.11910629272460938  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.351279258728027  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.353248119354248  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.13532018661499023  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.106822967529297  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.109318256378174  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.15230369567871094  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.277828216552734  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.279788494110107  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.16998910903930664  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.679180145263672  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.68071222305298  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.19005584716796875  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.919230937957764  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.920513153076172  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.20922374725341797  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.058495044708252  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.059346199035645  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.22813892364501953  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.1349835395813  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.135645866394043  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.2464756965637207  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.653091430664062  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.65365695953369  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.26262521743774414  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.27070665359497  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.271102905273438  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.27364253997802734  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.903448104858398  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.903663158416748  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.2897300720214844  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1655545234680176
pure train time :  4.887568950653076
train time :  6.138962030410767
end to end time :  30.759526252746582
connection check time:  9.391133546829224
block generation time  14.510337591171265
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.048680782318115234
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  11
the grouping_fanout_arxiv called successfully
capacity  8000
 
G_BUCKET_ID_list [[0], [1], [2, 4], [3, 5], [6, 7, 20], [8, 9, 10], [11, 12, 13], [14, 16, 15, 28], [18, 17, 19, 22], [21, 23, 25, 24], [26, 27]]
Groups_mem_list  [11091, 7949, 7768, 7084, 7989, 7951, 7239, 7985, 7739, 6809, 3142]
G_BUCKET_ID_list length 11
backpack scheduling spend  0.2346172332763672
11
11
[0]
current group_mem  11.09133707869788
[1]
current group_mem  7.949351660231331
[2, 4]
current group_mem  7.76984250752779
[3, 5]
current group_mem  7.084985542575888
[6, 7, 20]
current group_mem  7.99024774528462
[8, 9, 10]
current group_mem  7.951499921539595
[11, 12, 13]
current group_mem  7.240351491430146
[14, 16, 15, 28]
current group_mem  7.987057778998564
[18, 17, 19, 22]
current group_mem  7.740720913840779
[21, 23, 25, 24]
current group_mem  6.810720823916322
[26, 27]
current group_mem  3.1434549290358977
batches output list generation spend  0.0007219314575195312
self.weights_list  [0.15513354812460825, 0.13619819443375375, 0.17790655479926545, 0.14149833408473625, 0.09801959512211214, 0.09300535512035275, 0.06275497300447543, 0.04881186703467083, 0.0416753719444475, 0.02917276036111325, 0.015823445970464367]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017557144165039062
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.23560452461242676
len local_batched_seeds_list  11
partition total batch output list spend :  0.6248397827148438
self.buckets_partition() spend  sec:  0.2532052993774414
layer  0
 the number of batches:  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.11762475967407227  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.941048622131348  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.929620742797852  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.11857175827026367  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.286808490753174  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.288773536682129  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.13413333892822266  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.10818576812744  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.110758304595947  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.15101099014282227  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.225865840911865  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.22803783416748  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.16968297958374023  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.667181968688965  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.668559551239014  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.18718481063842773  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.907668590545654  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.909024238586426  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.20673418045043945  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.082542896270752  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.083394050598145  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.22483015060424805  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.082890510559082  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.083552837371826  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.2432694435119629  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.626656532287598  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.627222061157227  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.25959062576293945  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.345194816589355  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.345591068267822  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.27032947540283203  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.752405643463135  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.752620697021484  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.2856478691101074  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0888664722442627
pure train time :  4.74556040763855
train time :  6.006837368011475
end to end time :  30.65853524208069
connection check time:  9.62407112121582
block generation time  14.381008863449097
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.033643245697021484
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  11
the grouping_fanout_arxiv called successfully
capacity  8000
 
G_BUCKET_ID_list [[0], [1], [2, 4], [3, 5], [6, 7, 20], [8, 9, 10], [11, 12, 13], [14, 16, 15, 28], [18, 17, 19, 22], [21, 23, 25, 24], [26, 27]]
Groups_mem_list  [11091, 7949, 7768, 7084, 7989, 7951, 7239, 7985, 7739, 6809, 3142]
G_BUCKET_ID_list length 11
backpack scheduling spend  0.2117018699645996
11
11
[0]
current group_mem  11.09133707869788
[1]
current group_mem  7.949351660231331
[2, 4]
current group_mem  7.76984250752779
[3, 5]
current group_mem  7.084985542575888
[6, 7, 20]
current group_mem  7.99024774528462
[8, 9, 10]
current group_mem  7.951499921539595
[11, 12, 13]
current group_mem  7.240351491430146
[14, 16, 15, 28]
current group_mem  7.987057778998564
[18, 17, 19, 22]
current group_mem  7.740720913840779
[21, 23, 25, 24]
current group_mem  6.810720823916322
[26, 27]
current group_mem  3.1434549290358977
batches output list generation spend  0.0004699230194091797
self.weights_list  [0.15513354812460825, 0.13619819443375375, 0.17790655479926545, 0.14149833408473625, 0.09801959512211214, 0.09300535512035275, 0.06275497300447543, 0.04881186703467083, 0.0416753719444475, 0.02917276036111325, 0.015823445970464367]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01532125473022461
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.21240878105163574
len local_batched_seeds_list  11
partition total batch output list spend :  0.4157090187072754
self.buckets_partition() spend  sec:  0.22777295112609863
layer  0
 the number of batches:  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.1175837516784668  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.938495635986328  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.926775455474854  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.11891651153564453  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.39490270614624  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.39687728881836  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.1346139907836914  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.098076820373535  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.100568294525146  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.1508011817932129  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.259825229644775  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.26187038421631  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.1674647331237793  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.744739055633545  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.746225357055664  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.1870899200439453  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.85841131210327  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.859678268432617  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.20645856857299805  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.01952600479126  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.020377159118652  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.22397708892822266  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.09876585006714  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.099428176879883  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.24276399612426758  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.663415908813477  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.663981437683105  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.2581357955932617  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.249372005462646  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.249768257141113  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.26937341690063477  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.824326992034912  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.824542045593262  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.28455305099487305  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.022345542907715
pure train time :  4.8098156452178955
train time :  6.078123569488525
end to end time :  30.641266584396362
connection check time:  9.698540925979614
block generation time  14.42516827583313
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04947996139526367
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  11
the grouping_fanout_arxiv called successfully
capacity  8000
 
G_BUCKET_ID_list [[0], [1], [2, 4], [3, 5], [6, 7, 20], [8, 9, 10], [11, 12, 13], [14, 16, 15, 28], [18, 17, 19, 22], [21, 23, 25, 24], [26, 27]]
Groups_mem_list  [11091, 7949, 7768, 7084, 7989, 7951, 7239, 7985, 7739, 6809, 3142]
G_BUCKET_ID_list length 11
backpack scheduling spend  0.363400936126709
11
11
[0]
current group_mem  11.09133707869788
[1]
current group_mem  7.949351660231331
[2, 4]
current group_mem  7.76984250752779
[3, 5]
current group_mem  7.084985542575888
[6, 7, 20]
current group_mem  7.99024774528462
[8, 9, 10]
current group_mem  7.951499921539595
[11, 12, 13]
current group_mem  7.240351491430146
[14, 16, 15, 28]
current group_mem  7.987057778998564
[18, 17, 19, 22]
current group_mem  7.740720913840779
[21, 23, 25, 24]
current group_mem  6.810720823916322
[26, 27]
current group_mem  3.1434549290358977
batches output list generation spend  0.0005857944488525391
self.weights_list  [0.15513354812460825, 0.13619819443375375, 0.17790655479926545, 0.14149833408473625, 0.09801959512211214, 0.09300535512035275, 0.06275497300447543, 0.04881186703467083, 0.0416753719444475, 0.02917276036111325, 0.015823445970464367]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016865253448486328
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.36429691314697266
len local_batched_seeds_list  11
partition total batch output list spend :  0.7899270057678223
self.buckets_partition() spend  sec:  0.3812100887298584
layer  0
 the number of batches:  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.11798763275146484  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.93837308883667  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.926637172698975  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.11923551559448242  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.301842212677002  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.303826332092285  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.13588905334472656  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.156949520111084  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.159398078918457  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.15347528457641602  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.23881435394287  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.240755558013916  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.17072391510009766  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.649762630462646  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.651187896728516  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.1902322769165039  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.890464782714844  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.891762256622314  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.20873308181762695  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.989392280578613  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.990243434906006  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.22644758224487305  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.08927631378174  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.089938640594482  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.24388885498046875  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.666592597961426  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.667158126831055  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.2624826431274414  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.291200637817383  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.29159688949585  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.27280712127685547  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.919804573059082  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.920019626617432  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.29028797149658203  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9738407135009766
pure train time :  4.797152996063232
train time :  6.043549060821533
end to end time :  30.629615306854248
connection check time:  9.438959121704102
block generation time  14.314156293869019
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.050928354263305664
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  11
the grouping_fanout_arxiv called successfully
capacity  8000
 
G_BUCKET_ID_list [[0], [1], [2, 4], [3, 5], [6, 7, 20], [8, 9, 10], [11, 12, 13], [14, 16, 15, 28], [18, 17, 19, 22], [21, 23, 25, 24], [26, 27]]
Groups_mem_list  [11091, 7949, 7768, 7084, 7989, 7951, 7239, 7985, 7739, 6809, 3142]
G_BUCKET_ID_list length 11
backpack scheduling spend  0.34557247161865234
11
11
[0]
current group_mem  11.09133707869788
[1]
current group_mem  7.949351660231331
[2, 4]
current group_mem  7.76984250752779
[3, 5]
current group_mem  7.084985542575888
[6, 7, 20]
current group_mem  7.99024774528462
[8, 9, 10]
current group_mem  7.951499921539595
[11, 12, 13]
current group_mem  7.240351491430146
[14, 16, 15, 28]
current group_mem  7.987057778998564
[18, 17, 19, 22]
current group_mem  7.740720913840779
[21, 23, 25, 24]
current group_mem  6.810720823916322
[26, 27]
current group_mem  3.1434549290358977
batches output list generation spend  0.0006213188171386719
self.weights_list  [0.15513354812460825, 0.13619819443375375, 0.17790655479926545, 0.14149833408473625, 0.09801959512211214, 0.09300535512035275, 0.06275497300447543, 0.04881186703467083, 0.0416753719444475, 0.02917276036111325, 0.015823445970464367]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017701387405395508
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.3464632034301758
len local_batched_seeds_list  11
partition total batch output list spend :  0.6296460628509521
self.buckets_partition() spend  sec:  0.3642129898071289
layer  0
 the number of batches:  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.11806344985961914  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.998147010803223  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.986012935638428  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.11849784851074219  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.353119373321533  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.35522985458374  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.13532686233520508  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.19431734085083  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.1968936920166  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.15249919891357422  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.231324672698975  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.233247756958008  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.17080068588256836  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.590231895446777  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.591851711273193  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.18944311141967773  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.89546251296997  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.896836280822754  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.20980310440063477  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.03540849685669  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.036259651184082  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.22817134857177734  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.1228084564209  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.123470783233643  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.24551153182983398  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.643962383270264  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.644527912139893  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.26328134536743164  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.25916337966919  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.259559631347656  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.2754178047180176  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.88542890548706  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.88564395904541  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.2911553382873535  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.922765016555786
pure train time :  4.791168212890625
train time :  6.14308762550354
end to end time :  31.48188018798828
connection check time:  9.89206075668335
block generation time  14.791845798492432
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.031186580657958984
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  11
the grouping_fanout_arxiv called successfully
capacity  8000
 
G_BUCKET_ID_list [[0], [1], [2, 4], [3, 5], [6, 7, 20], [8, 9, 10], [11, 12, 13], [14, 16, 15, 28], [18, 17, 19, 22], [21, 23, 25, 24], [26, 27]]
Groups_mem_list  [11091, 7949, 7768, 7084, 7989, 7951, 7239, 7985, 7739, 6809, 3142]
G_BUCKET_ID_list length 11
backpack scheduling spend  0.22101521492004395
11
11
[0]
current group_mem  11.09133707869788
[1]
current group_mem  7.949351660231331
[2, 4]
current group_mem  7.76984250752779
[3, 5]
current group_mem  7.084985542575888
[6, 7, 20]
current group_mem  7.99024774528462
[8, 9, 10]
current group_mem  7.951499921539595
[11, 12, 13]
current group_mem  7.240351491430146
[14, 16, 15, 28]
current group_mem  7.987057778998564
[18, 17, 19, 22]
current group_mem  7.740720913840779
[21, 23, 25, 24]
current group_mem  6.810720823916322
[26, 27]
current group_mem  3.1434549290358977
batches output list generation spend  0.0005669593811035156
self.weights_list  [0.15513354812460825, 0.13619819443375375, 0.17790655479926545, 0.14149833408473625, 0.09801959512211214, 0.09300535512035275, 0.06275497300447543, 0.04881186703467083, 0.0416753719444475, 0.02917276036111325, 0.015823445970464367]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015736818313598633
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.22181963920593262
len local_batched_seeds_list  11
partition total batch output list spend :  0.37548184394836426
self.buckets_partition() spend  sec:  0.2375965118408203
layer  0
 the number of batches:  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  11
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 11
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.11732149124145508  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.008955478668213  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 12.997801303863525  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.1185145378112793  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.292913913726807  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.295186042785645  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.13481855392456055  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.168248653411865  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.17068576812744  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.15270233154296875  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.191239833831787  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.193296432495117  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.17072725296020508  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.71724557876587  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.718661308288574  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.18951034545898438  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.85327672958374  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.85457420349121  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.208892822265625  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.00703191757202  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.007883071899414  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.22702407836914062  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.04866647720337  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 19.049328804016113  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.24534845352172852  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.669678211212158  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 18.670243740081787  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.2623171806335449  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.25186777114868  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.25226402282715  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.27393293380737305  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.871901512145996  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 13.872116565704346  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.28920841217041016  GigaBytes
Max Memory Allocated: 20.08955478668213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8606393337249756
pure train time :  4.7643773555755615
train time :  6.0886218547821045
end to end time :  26.12710475921631
connection check time:  9.210184097290039
block generation time  10.433096408843994
end to end time  26.301793575286865
Total (block generation + training)time/epoch 26.301793575286865
pure train time per /epoch  [5.604205846786499, 4.942900896072388, 4.7755725383758545, 4.785488128662109, 4.887568950653076, 4.74556040763855, 4.8098156452178955, 4.797152996063232, 4.791168212890625, 4.7643773555755615]
pure train time average  4.79730452810015
input num list  [1634764, 1635501, 1634650, 1633977, 1635083, 1634440, 1633148, 1634216, 1634341, 1634267]
