main start at this time 1689362799.0513437
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
dtype  torch.int64
data type  <class 'torch.Tensor'>
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.046526193618774414
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  9
the grouping_fanout_arxiv called successfully
capacity  9500
 
G_BUCKET_ID_list [[0], [1, 28], [2, 3], [4, 5, 10], [6, 7, 8], [9, 11, 12, 19], [13, 14, 16, 15], [18, 17, 20, 22, 25], [21, 23, 24, 26, 27]]
Groups_mem_list  [11091, 9457, 8014, 9316, 8845, 9482, 8819, 9449, 8273]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.35715746879577637
9
9
[0]
current group_mem  11.09133707869788
[1, 28]
current group_mem  9.457370926738703
[2, 3]
current group_mem  8.0157463174525
[4, 5, 10]
current group_mem  9.317113825174287
[6, 7, 8]
current group_mem  8.846169169120007
[9, 11, 12, 19]
current group_mem  9.48354629400802
[13, 14, 16, 15]
current group_mem  8.821417625897723
[18, 17, 20, 22, 25]
current group_mem  9.450838578764683
[21, 23, 24, 26, 27]
current group_mem  8.276030577225008
batches output list generation spend  0.0008513927459716797
self.weights_list  [0.15679396531817333, 0.1414763418040268, 0.1916407341023301, 0.15530948637028402, 0.12452029337702467, 0.08609977897757887, 0.0626230193202186, 0.04684355791117318, 0.034692822819190464]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021727800369262695
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.358325719833374
len local_batched_seeds_list  9
partition total batch output list spend :  0.7370297908782959
self.buckets_partition() spend  sec:  0.38010334968566895
layer  0
 the number of batches:  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.529296875 GB
    Memory Allocated: 0.08937215805053711  GigaBytes
Max Memory Allocated: 0.08937215805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.69921875 GB
    Memory Allocated: 13.925310134887695  GigaBytes
Max Memory Allocated: 13.985344409942627  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.69921875 GB
    Memory Allocated: 13.927435874938965  GigaBytes
Max Memory Allocated: 13.985344409942627  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.560546875 GB
    Memory Allocated: 0.1113286018371582  GigaBytes
Max Memory Allocated: 13.985344409942627  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.1171875 GB
    Memory Allocated: 16.65581703186035  GigaBytes
Max Memory Allocated: 16.734240531921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.1171875 GB
    Memory Allocated: 16.657942295074463  GigaBytes
Max Memory Allocated: 16.734240531921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.21484375 GB
    Memory Allocated: 0.1310110092163086  GigaBytes
Max Memory Allocated: 16.734240531921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3828125 GB
    Memory Allocated: 18.669504165649414  GigaBytes
Max Memory Allocated: 18.7779860496521  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3828125 GB
    Memory Allocated: 18.672269344329834  GigaBytes
Max Memory Allocated: 18.7779860496521  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.640625 GB
    Memory Allocated: 0.15105390548706055  GigaBytes
Max Memory Allocated: 18.7779860496521  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 21.082472801208496  GigaBytes
Max Memory Allocated: 21.212256908416748  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 21.085100650787354  GigaBytes
Max Memory Allocated: 21.212256908416748  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.275390625 GB
    Memory Allocated: 0.17265748977661133  GigaBytes
Max Memory Allocated: 21.212256908416748  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.61328125 GB
    Memory Allocated: 20.824548721313477  GigaBytes
Max Memory Allocated: 21.212256908416748  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.61328125 GB
    Memory Allocated: 20.82634973526001  GigaBytes
Max Memory Allocated: 21.212256908416748  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.822265625 GB
    Memory Allocated: 0.19330215454101562  GigaBytes
Max Memory Allocated: 21.212256908416748  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.2109375 GB
    Memory Allocated: 21.400272369384766  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.2109375 GB
    Memory Allocated: 21.401448726654053  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.15625 GB
    Memory Allocated: 0.2152867317199707  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.103515625 GB
    Memory Allocated: 20.382153034210205  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.103515625 GB
    Memory Allocated: 20.383002281188965  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.10546875 GB
    Memory Allocated: 0.23474645614624023  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.232421875 GB
    Memory Allocated: 20.165174961090088  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.232421875 GB
    Memory Allocated: 20.165810585021973  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.232421875 GB
    Memory Allocated: 0.2525768280029297  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.232421875 GB
    Memory Allocated: 18.832581520080566  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.232421875 GB
    Memory Allocated: 18.833052158355713  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.232421875 GB
    Memory Allocated: 0.28269481658935547  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.9951794147491455
pure train time :  5.541650056838989
train time :  7.206400394439697
end to end time :  29.51829504966736
connection check time:  8.541527271270752
block generation time  13.00895380973816
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05466437339782715
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  9
the grouping_fanout_arxiv called successfully
capacity  9500
 
G_BUCKET_ID_list [[0], [1, 28], [2, 3], [4, 5, 10], [6, 7, 8], [9, 11, 12, 19], [13, 14, 16, 15], [18, 17, 20, 22, 25], [21, 23, 24, 26, 27]]
Groups_mem_list  [11091, 9457, 8014, 9316, 8845, 9482, 8819, 9449, 8273]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.3675086498260498
9
9
[0]
current group_mem  11.09133707869788
[1, 28]
current group_mem  9.457370926738703
[2, 3]
current group_mem  8.0157463174525
[4, 5, 10]
current group_mem  9.317113825174287
[6, 7, 8]
current group_mem  8.846169169120007
[9, 11, 12, 19]
current group_mem  9.48354629400802
[13, 14, 16, 15]
current group_mem  8.821417625897723
[18, 17, 20, 22, 25]
current group_mem  9.450838578764683
[21, 23, 24, 26, 27]
current group_mem  8.276030577225008
batches output list generation spend  0.0005855560302734375
self.weights_list  [0.15679396531817333, 0.1414763418040268, 0.1916407341023301, 0.15530948637028402, 0.12452029337702467, 0.08609977897757887, 0.0626230193202186, 0.04684355791117318, 0.034692822819190464]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01679062843322754
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.3684110641479492
len local_batched_seeds_list  9
partition total batch output list spend :  0.7562382221221924
self.buckets_partition() spend  sec:  0.385256290435791
layer  0
 the number of batches:  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.232421875 GB
    Memory Allocated: 0.12503433227539062  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.314453125 GB
    Memory Allocated: 13.968742847442627  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.314453125 GB
    Memory Allocated: 13.951986312866211  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.314453125 GB
    Memory Allocated: 0.12283945083618164  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.314453125 GB
    Memory Allocated: 16.664003372192383  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.314453125 GB
    Memory Allocated: 16.66603136062622  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.314453125 GB
    Memory Allocated: 0.14009332656860352  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.314453125 GB
    Memory Allocated: 18.647197246551514  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.314453125 GB
    Memory Allocated: 18.649951934814453  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.939453125 GB
    Memory Allocated: 0.16107892990112305  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.177734375 GB
    Memory Allocated: 21.17456817626953  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.177734375 GB
    Memory Allocated: 21.17720079421997  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.287109375 GB
    Memory Allocated: 0.18286371231079102  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.822265625 GB
    Memory Allocated: 20.974168300628662  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.822265625 GB
    Memory Allocated: 20.975954055786133  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.03125 GB
    Memory Allocated: 0.20325994491577148  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.337890625 GB
    Memory Allocated: 21.333581924438477  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.337890625 GB
    Memory Allocated: 21.334883213043213  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.337890625 GB
    Memory Allocated: 0.22532987594604492  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.64453125 GB
    Memory Allocated: 20.387311935424805  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.64453125 GB
    Memory Allocated: 20.388161182403564  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.064453125 GB
    Memory Allocated: 0.2468738555908203  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.818359375 GB
    Memory Allocated: 20.081037521362305  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.818359375 GB
    Memory Allocated: 20.08167314529419  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.818359375 GB
    Memory Allocated: 0.26520490646362305  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87109375 GB
    Memory Allocated: 18.79618740081787  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.87109375 GB
    Memory Allocated: 18.796658039093018  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.87109375 GB
    Memory Allocated: 0.2862539291381836  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.557069778442383
pure train time :  4.61501932144165
train time :  5.80022931098938
end to end time :  27.64502787590027
connection check time:  8.356386423110962
block generation time  12.704514503479004
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.053444862365722656
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  9
the grouping_fanout_arxiv called successfully
capacity  9500
 
G_BUCKET_ID_list [[0], [1, 28], [2, 3], [4, 5, 10], [6, 7, 8], [9, 11, 12, 19], [13, 14, 16, 15], [18, 17, 20, 22, 25], [21, 23, 24, 26, 27]]
Groups_mem_list  [11091, 9457, 8014, 9316, 8845, 9482, 8819, 9449, 8273]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.38726210594177246
9
9
[0]
current group_mem  11.09133707869788
[1, 28]
current group_mem  9.457370926738703
[2, 3]
current group_mem  8.0157463174525
[4, 5, 10]
current group_mem  9.317113825174287
[6, 7, 8]
current group_mem  8.846169169120007
[9, 11, 12, 19]
current group_mem  9.48354629400802
[13, 14, 16, 15]
current group_mem  8.821417625897723
[18, 17, 20, 22, 25]
current group_mem  9.450838578764683
[21, 23, 24, 26, 27]
current group_mem  8.276030577225008
batches output list generation spend  0.0005686283111572266
self.weights_list  [0.15679396531817333, 0.1414763418040268, 0.1916407341023301, 0.15530948637028402, 0.12452029337702467, 0.08609977897757887, 0.0626230193202186, 0.04684355791117318, 0.034692822819190464]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018956422805786133
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.38820672035217285
len local_batched_seeds_list  9
partition total batch output list spend :  0.5938234329223633
self.buckets_partition() spend  sec:  0.4072401523590088
layer  0
 the number of batches:  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87109375 GB
    Memory Allocated: 0.1257767677307129  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.8828125 GB
    Memory Allocated: 13.980008125305176  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.8828125 GB
    Memory Allocated: 13.962683200836182  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.884765625 GB
    Memory Allocated: 0.12341451644897461  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.884765625 GB
    Memory Allocated: 16.630396366119385  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.884765625 GB
    Memory Allocated: 16.632424354553223  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.884765625 GB
    Memory Allocated: 0.14153242111206055  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.314453125 GB
    Memory Allocated: 18.637866020202637  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.314453125 GB
    Memory Allocated: 18.64052152633667  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.314453125 GB
    Memory Allocated: 0.1615586280822754  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.1796875 GB
    Memory Allocated: 21.07893657684326  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.1796875 GB
    Memory Allocated: 21.08137845993042  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.390625 GB
    Memory Allocated: 0.18323040008544922  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.390625 GB
    Memory Allocated: 21.01356077194214  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.390625 GB
    Memory Allocated: 21.0152587890625  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.390625 GB
    Memory Allocated: 0.20440101623535156  GigaBytes
Max Memory Allocated: 21.523624420166016  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.390625 GB
    Memory Allocated: 21.402565479278564  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.390625 GB
    Memory Allocated: 21.403843879699707  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.630859375 GB
    Memory Allocated: 0.22511911392211914  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.068359375 GB
    Memory Allocated: 20.348097324371338  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.068359375 GB
    Memory Allocated: 20.348946571350098  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.0703125 GB
    Memory Allocated: 0.24491214752197266  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.5078125 GB
    Memory Allocated: 20.177652835845947  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.5078125 GB
    Memory Allocated: 20.178288459777832  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.5078125 GB
    Memory Allocated: 0.26358699798583984  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.5078125 GB
    Memory Allocated: 18.87985849380493  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.5078125 GB
    Memory Allocated: 18.880329132080078  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.5078125 GB
    Memory Allocated: 0.28366947174072266  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.327850818634033
pure train time :  4.454449892044067
train time :  5.593895673751831
end to end time :  27.460811138153076
connection check time:  8.434652328491211
block generation time  12.81388258934021
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05424308776855469
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  9
the grouping_fanout_arxiv called successfully
capacity  9500
 
G_BUCKET_ID_list [[0], [1, 28], [2, 3], [4, 5, 10], [6, 7, 8], [9, 11, 12, 19], [13, 14, 16, 15], [18, 17, 20, 22, 25], [21, 23, 24, 26, 27]]
Groups_mem_list  [11091, 9457, 8014, 9316, 8845, 9482, 8819, 9449, 8273]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.2623629570007324
9
9
[0]
current group_mem  11.09133707869788
[1, 28]
current group_mem  9.457370926738703
[2, 3]
current group_mem  8.0157463174525
[4, 5, 10]
current group_mem  9.317113825174287
[6, 7, 8]
current group_mem  8.846169169120007
[9, 11, 12, 19]
current group_mem  9.48354629400802
[13, 14, 16, 15]
current group_mem  8.821417625897723
[18, 17, 20, 22, 25]
current group_mem  9.450838578764683
[21, 23, 24, 26, 27]
current group_mem  8.276030577225008
batches output list generation spend  0.0006842613220214844
self.weights_list  [0.15679396531817333, 0.1414763418040268, 0.1916407341023301, 0.15530948637028402, 0.12452029337702467, 0.08609977897757887, 0.0626230193202186, 0.04684355791117318, 0.034692822819190464]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018431901931762695
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.2633171081542969
len local_batched_seeds_list  9
partition total batch output list spend :  0.4788520336151123
self.buckets_partition() spend  sec:  0.28180551528930664
layer  0
 the number of batches:  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.5078125 GB
    Memory Allocated: 0.12418937683105469  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.578125 GB
    Memory Allocated: 13.944360256195068  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.578125 GB
    Memory Allocated: 13.927455425262451  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.578125 GB
    Memory Allocated: 0.12264823913574219  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.578125 GB
    Memory Allocated: 16.694481372833252  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.578125 GB
    Memory Allocated: 16.697370529174805  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.578125 GB
    Memory Allocated: 0.14069032669067383  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.578125 GB
    Memory Allocated: 18.74320077896118  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.578125 GB
    Memory Allocated: 18.74580669403076  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.578125 GB
    Memory Allocated: 0.15987062454223633  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.109375 GB
    Memory Allocated: 21.094818592071533  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.109375 GB
    Memory Allocated: 21.097420692443848  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.109375 GB
    Memory Allocated: 0.18157529830932617  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.109375 GB
    Memory Allocated: 20.883258819580078  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.109375 GB
    Memory Allocated: 20.885003566741943  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.109375 GB
    Memory Allocated: 0.20255661010742188  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 21.330430030822754  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 21.33161687850952  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 0.22371816635131836  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 20.40292501449585  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 20.40377426147461  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 0.24573087692260742  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 20.07452964782715  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 20.075165271759033  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 0.2640242576599121  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 18.891530513763428  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 18.892001152038574  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 0.2841205596923828  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.204172372817993
pure train time :  4.299704551696777
train time :  5.445507049560547
end to end time :  27.483216285705566
connection check time:  8.578840494155884
block generation time  12.947039127349854
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05414462089538574
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  9
the grouping_fanout_arxiv called successfully
capacity  9500
 
G_BUCKET_ID_list [[0], [1, 28], [2, 3], [4, 5, 10], [6, 7, 8], [9, 11, 12, 19], [13, 14, 16, 15], [18, 17, 20, 22, 25], [21, 23, 24, 26, 27]]
Groups_mem_list  [11091, 9457, 8014, 9316, 8845, 9482, 8819, 9449, 8273]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.3924727439880371
9
9
[0]
current group_mem  11.09133707869788
[1, 28]
current group_mem  9.457370926738703
[2, 3]
current group_mem  8.0157463174525
[4, 5, 10]
current group_mem  9.317113825174287
[6, 7, 8]
current group_mem  8.846169169120007
[9, 11, 12, 19]
current group_mem  9.48354629400802
[13, 14, 16, 15]
current group_mem  8.821417625897723
[18, 17, 20, 22, 25]
current group_mem  9.450838578764683
[21, 23, 24, 26, 27]
current group_mem  8.276030577225008
batches output list generation spend  0.0006964206695556641
self.weights_list  [0.15679396531817333, 0.1414763418040268, 0.1916407341023301, 0.15530948637028402, 0.12452029337702467, 0.08609977897757887, 0.0626230193202186, 0.04684355791117318, 0.034692822819190464]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017383813858032227
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.39348292350769043
len local_batched_seeds_list  9
partition total batch output list spend :  0.7642688751220703
self.buckets_partition() spend  sec:  0.4109203815460205
layer  0
 the number of batches:  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.232421875 GB
    Memory Allocated: 0.1242227554321289  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.240234375 GB
    Memory Allocated: 13.909721374511719  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.240234375 GB
    Memory Allocated: 13.892625331878662  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 0.1226663589477539  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 16.66712999343872  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 16.66915798187256  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 0.1395554542541504  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 18.740607261657715  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 18.743449687957764  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 0.15947198867797852  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 21.070870876312256  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 21.07347297668457  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 0.18180370330810547  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 20.89865207672119  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 20.900619983673096  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.2421875 GB
    Memory Allocated: 0.2033085823059082  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 21.36531925201416  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 21.36651086807251  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 0.223480224609375  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 20.392574787139893  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 20.393424034118652  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 0.24536705017089844  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 20.142404079437256  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 20.14303970336914  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 0.2636585235595703  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 18.884939193725586  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 18.885409832000732  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 0.28381824493408203  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1653356552124023
pure train time :  4.314984083175659
train time :  5.417893409729004
end to end time :  27.622169256210327
connection check time:  8.611430644989014
block generation time  12.806466579437256
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05212998390197754
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  9
the grouping_fanout_arxiv called successfully
capacity  9500
 
G_BUCKET_ID_list [[0], [1, 28], [2, 3], [4, 5, 10], [6, 7, 8], [9, 11, 12, 19], [13, 14, 16, 15], [18, 17, 20, 22, 25], [21, 23, 24, 26, 27]]
Groups_mem_list  [11091, 9457, 8014, 9316, 8845, 9482, 8819, 9449, 8273]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.3890848159790039
9
9
[0]
current group_mem  11.09133707869788
[1, 28]
current group_mem  9.457370926738703
[2, 3]
current group_mem  8.0157463174525
[4, 5, 10]
current group_mem  9.317113825174287
[6, 7, 8]
current group_mem  8.846169169120007
[9, 11, 12, 19]
current group_mem  9.48354629400802
[13, 14, 16, 15]
current group_mem  8.821417625897723
[18, 17, 20, 22, 25]
current group_mem  9.450838578764683
[21, 23, 24, 26, 27]
current group_mem  8.276030577225008
batches output list generation spend  0.0007104873657226562
self.weights_list  [0.15679396531817333, 0.1414763418040268, 0.1916407341023301, 0.15530948637028402, 0.12452029337702467, 0.08609977897757887, 0.0626230193202186, 0.04684355791117318, 0.034692822819190464]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.019547700881958008
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.3901190757751465
len local_batched_seeds_list  9
partition total batch output list spend :  0.610917329788208
self.buckets_partition() spend  sec:  0.40972304344177246
layer  0
 the number of batches:  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 0.12461185455322266  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 13.939866542816162  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 13.922991275787354  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 0.12350225448608398  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 16.586849689483643  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 16.589089393615723  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 0.1407008171081543  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 18.69612741470337  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 18.6990385055542  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 0.16126012802124023  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 21.062260150909424  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 21.06472110748291  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 0.18294000625610352  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 20.910890579223633  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 20.912676334381104  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.287109375 GB
    Memory Allocated: 0.20294761657714844  GigaBytes
Max Memory Allocated: 21.525707721710205  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.41970205307007  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.42090654373169  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2230391502380371  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.37220048904419  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.37304973602295  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2443089485168457  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.187519073486328  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.188154697418213  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2616291046142578  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.831058502197266  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.831529140472412  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2830033302307129  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0865447521209717
pure train time :  4.333924293518066
train time :  5.584124803543091
end to end time :  27.69459891319275
connection check time:  8.686288118362427
block generation time  12.79105544090271
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05728268623352051
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  9
the grouping_fanout_arxiv called successfully
capacity  9500
 
G_BUCKET_ID_list [[0], [1, 28], [2, 3], [4, 5, 10], [6, 7, 8], [9, 11, 12, 19], [13, 14, 16, 15], [18, 17, 20, 22, 25], [21, 23, 24, 26, 27]]
Groups_mem_list  [11091, 9457, 8014, 9316, 8845, 9482, 8819, 9449, 8273]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.39678025245666504
9
9
[0]
current group_mem  11.09133707869788
[1, 28]
current group_mem  9.457370926738703
[2, 3]
current group_mem  8.0157463174525
[4, 5, 10]
current group_mem  9.317113825174287
[6, 7, 8]
current group_mem  8.846169169120007
[9, 11, 12, 19]
current group_mem  9.48354629400802
[13, 14, 16, 15]
current group_mem  8.821417625897723
[18, 17, 20, 22, 25]
current group_mem  9.450838578764683
[21, 23, 24, 26, 27]
current group_mem  8.276030577225008
batches output list generation spend  0.0007464885711669922
self.weights_list  [0.15679396531817333, 0.1414763418040268, 0.1916407341023301, 0.15530948637028402, 0.12452029337702467, 0.08609977897757887, 0.0626230193202186, 0.04684355791117318, 0.034692822819190464]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016754150390625
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.3978385925292969
len local_batched_seeds_list  9
partition total batch output list spend :  0.7713313102722168
self.buckets_partition() spend  sec:  0.4146461486816406
layer  0
 the number of batches:  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.12524127960205078  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 13.935023784637451  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 13.917803287506104  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.12347173690795898  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 16.715206623077393  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 16.717485427856445  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.1410527229309082  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.70172357559204  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.704479217529297  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.16144990921020508  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.20426654815674  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.20699453353882  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.1826310157775879  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.81523847579956  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.81698226928711  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.20377874374389648  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.391671180725098  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.392893314361572  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.22306585311889648  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.41444969177246  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.41529893875122  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.24521827697753906  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.14721918106079  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.147854804992676  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2636737823486328  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.89338207244873  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.893852710723877  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.28433895111083984  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0205237865448
pure train time :  4.301803350448608
train time :  5.44927716255188
end to end time :  27.320603847503662
connection check time:  8.233549118041992
block generation time  12.838521718978882
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05220508575439453
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  9
the grouping_fanout_arxiv called successfully
capacity  9500
 
G_BUCKET_ID_list [[0], [1, 28], [2, 3], [4, 5, 10], [6, 7, 8], [9, 11, 12, 19], [13, 14, 16, 15], [18, 17, 20, 22, 25], [21, 23, 24, 26, 27]]
Groups_mem_list  [11091, 9457, 8014, 9316, 8845, 9482, 8819, 9449, 8273]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.3712732791900635
9
9
[0]
current group_mem  11.09133707869788
[1, 28]
current group_mem  9.457370926738703
[2, 3]
current group_mem  8.0157463174525
[4, 5, 10]
current group_mem  9.317113825174287
[6, 7, 8]
current group_mem  8.846169169120007
[9, 11, 12, 19]
current group_mem  9.48354629400802
[13, 14, 16, 15]
current group_mem  8.821417625897723
[18, 17, 20, 22, 25]
current group_mem  9.450838578764683
[21, 23, 24, 26, 27]
current group_mem  8.276030577225008
batches output list generation spend  0.0006501674652099609
self.weights_list  [0.15679396531817333, 0.1414763418040268, 0.1916407341023301, 0.15530948637028402, 0.12452029337702467, 0.08609977897757887, 0.0626230193202186, 0.04684355791117318, 0.034692822819190464]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021358489990234375
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.37218284606933594
len local_batched_seeds_list  9
partition total batch output list spend :  0.5729553699493408
self.buckets_partition() spend  sec:  0.39359474182128906
layer  0
 the number of batches:  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.12584686279296875  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 13.941897869110107  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 13.924569606781006  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.12443113327026367  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 16.69407081604004  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 16.696411609649658  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.14122819900512695  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.693063259124756  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.695974349975586  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.16136503219604492  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.089847564697266  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.092164516448975  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.18259811401367188  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.833281993865967  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.83498477935791  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2034287452697754  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.32317876815796  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.324384689331055  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.22517871856689453  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.492878437042236  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.493727684020996  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.24700593948364258  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.118552207946777  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.119187831878662  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2644538879394531  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.886322498321533  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.88679313659668  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.28415775299072266  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9726831912994385
pure train time :  4.271308183670044
train time :  5.4510979652404785
end to end time :  27.157641887664795
connection check time:  8.306355476379395
block generation time  12.797393798828125
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05209994316101074
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  9
the grouping_fanout_arxiv called successfully
capacity  9500
 
G_BUCKET_ID_list [[0], [1, 28], [2, 3], [4, 5, 10], [6, 7, 8], [9, 11, 12, 19], [13, 14, 16, 15], [18, 17, 20, 22, 25], [21, 23, 24, 26, 27]]
Groups_mem_list  [11091, 9457, 8014, 9316, 8845, 9482, 8819, 9449, 8273]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.3847384452819824
9
9
[0]
current group_mem  11.09133707869788
[1, 28]
current group_mem  9.457370926738703
[2, 3]
current group_mem  8.0157463174525
[4, 5, 10]
current group_mem  9.317113825174287
[6, 7, 8]
current group_mem  8.846169169120007
[9, 11, 12, 19]
current group_mem  9.48354629400802
[13, 14, 16, 15]
current group_mem  8.821417625897723
[18, 17, 20, 22, 25]
current group_mem  9.450838578764683
[21, 23, 24, 26, 27]
current group_mem  8.276030577225008
batches output list generation spend  0.0006940364837646484
self.weights_list  [0.15679396531817333, 0.1414763418040268, 0.1916407341023301, 0.15530948637028402, 0.12452029337702467, 0.08609977897757887, 0.0626230193202186, 0.04684355791117318, 0.034692822819190464]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017901182174682617
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.3856995105743408
len local_batched_seeds_list  9
partition total batch output list spend :  0.6050400733947754
self.buckets_partition() spend  sec:  0.403653621673584
layer  0
 the number of batches:  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.12518024444580078  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 13.960570335388184  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 13.943551063537598  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.12421321868896484  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 16.688201427459717  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 16.690229415893555  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.14259862899780273  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.639737606048584  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.642361640930176  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.16189289093017578  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.964619159698486  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.967243194580078  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.18271589279174805  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.91038417816162  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.912131786346436  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.20328140258789062  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.385362148284912  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.386531829833984  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.22330427169799805  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.411795616149902  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.412644863128662  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2441997528076172  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.145472526550293  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.146108150482178  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2627739906311035  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.815404415130615  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.81587505340576  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2833218574523926  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9216341972351074
pure train time :  4.340210914611816
train time :  5.490556955337524
end to end time :  27.805169582366943
connection check time:  8.593831062316895
block generation time  13.084118366241455
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.051183223724365234
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  7479
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

fanout_dst_nids  size  7479
map_output_list size  7479
self.K  9
the grouping_fanout_arxiv called successfully
capacity  9500
 
G_BUCKET_ID_list [[0], [1, 28], [2, 3], [4, 5, 10], [6, 7, 8], [9, 11, 12, 19], [13, 14, 16, 15], [18, 17, 20, 22, 25], [21, 23, 24, 26, 27]]
Groups_mem_list  [11091, 9457, 8014, 9316, 8845, 9482, 8819, 9449, 8273]
G_BUCKET_ID_list length 9
backpack scheduling spend  0.3835108280181885
9
9
[0]
current group_mem  11.09133707869788
[1, 28]
current group_mem  9.457370926738703
[2, 3]
current group_mem  8.0157463174525
[4, 5, 10]
current group_mem  9.317113825174287
[6, 7, 8]
current group_mem  8.846169169120007
[9, 11, 12, 19]
current group_mem  9.48354629400802
[13, 14, 16, 15]
current group_mem  8.821417625897723
[18, 17, 20, 22, 25]
current group_mem  9.450838578764683
[21, 23, 24, 26, 27]
current group_mem  8.276030577225008
batches output list generation spend  0.0007224082946777344
self.weights_list  [0.15679396531817333, 0.1414763418040268, 0.1916407341023301, 0.15530948637028402, 0.12452029337702467, 0.08609977897757887, 0.0626230193202186, 0.04684355791117318, 0.034692822819190464]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01898479461669922
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.3845958709716797
len local_batched_seeds_list  9
partition total batch output list spend :  0.5983402729034424
self.buckets_partition() spend  sec:  0.40366578102111816
layer  0
 the number of batches:  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  1
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
layer  2
num of batch  9
check_connections_block*********************************
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
dtype  None
data type  <class 'list'>
res  length 9
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
dtype  torch.int64
data type  <class 'list'>
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.12460041046142578  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 13.955381870269775  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 13.938639640808105  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.1239471435546875  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 16.70397710800171  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 16.706192016601562  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.14083385467529297  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.663133144378662  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.665932655334473  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.16135025024414062  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.069286823272705  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.071694374084473  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.1826167106628418  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.840279579162598  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.84197759628296  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.20260381698608398  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.30302858352661  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 21.304314613342285  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2235126495361328  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.463448524475098  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.464297771453857  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2449817657470703  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.1067852973938  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 20.107420921325684  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.2627582550048828  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.859702110290527  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 18.860172748565674  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.3515625 GB
    Memory Allocated: 0.28249311447143555  GigaBytes
Max Memory Allocated: 21.54296350479126  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8598365783691406
pure train time :  4.30985951423645
train time :  5.465969800949097
end to end time :  27.951439142227173
connection check time:  8.741944789886475
block generation time  13.118557691574097
end to end time  28.14772653579712
Total (block generation + training)time/epoch 28.14772653579712
pure train time per /epoch  [5.541650056838989, 4.61501932144165, 4.454449892044067, 4.299704551696777, 4.314984083175659, 4.333924293518066, 4.301803350448608, 4.271308183670044, 4.340210914611816, 4.30985951423645]
pure train time average  4.31025641305106
input num list  [1370327, 1370648, 1370166, 1370345, 1370712, 1371034, 1369753, 1369801, 1370008, 1370572]
