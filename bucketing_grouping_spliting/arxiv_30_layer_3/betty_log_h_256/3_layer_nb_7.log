main start at this time 1689287578.9184203
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
loading full batch data spends  0.12382197380065918
REG start----................................
Convert a graph into a bidirected graph: 1.387 seconds, peak memory: 27.723 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.723 GB
Metis partitioning: 6.174 seconds, peak memory: 28.544 GB
Split the graph: 2.854 seconds
Construct subgraphs: 0.026 seconds
REG metis partition end ----................................
REG construction  time spent:  3.3477556705474854
pure dgl.metis_partition the time spent:  10.457732200622559
connection checking time:  5.426214218139648
block generation total time  5.318668603897095
generate_dataloader_block spend   25.315807580947876
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.025390625 GB
    Memory Allocated: 5.387442588806152  GigaBytes
Max Memory Allocated: 5.486899375915527  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.025390625 GB
    Memory Allocated: 5.389580726623535  GigaBytes
Max Memory Allocated: 5.486899375915527  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.517578125 GB
    Memory Allocated: 6.787365913391113  GigaBytes
Max Memory Allocated: 6.927109241485596  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.517578125 GB
    Memory Allocated: 6.789345741271973  GigaBytes
Max Memory Allocated: 6.927109241485596  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.1328125 GB
    Memory Allocated: 6.9578423500061035  GigaBytes
Max Memory Allocated: 7.072771072387695  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.1328125 GB
    Memory Allocated: 6.9598283767700195  GigaBytes
Max Memory Allocated: 7.072771072387695  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.3515625 GB
    Memory Allocated: 9.468424797058105  GigaBytes
Max Memory Allocated: 9.590517520904541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.3515625 GB
    Memory Allocated: 9.470393180847168  GigaBytes
Max Memory Allocated: 9.590517520904541  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.59765625 GB
    Memory Allocated: 9.85235595703125  GigaBytes
Max Memory Allocated: 9.951547622680664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.59765625 GB
    Memory Allocated: 9.854710102081299  GigaBytes
Max Memory Allocated: 9.951547622680664  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.986328125 GB
    Memory Allocated: 17.92754364013672  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.986328125 GB
    Memory Allocated: 17.929511547088623  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  6
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.853515625 GB
    Memory Allocated: 17.489323616027832  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.853515625 GB
    Memory Allocated: 17.491819858551025  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

pure train time  3.9546420574188232
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.853515625 GB
    Memory Allocated: 0.16536664962768555  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.9916200637817383
loading full batch data spends  0.1632232666015625
REG start----................................
Convert a graph into a bidirected graph: 1.492 seconds, peak memory: 73.715 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 73.715 GB
Metis partitioning: 6.478 seconds, peak memory: 74.545 GB
Split the graph: 2.894 seconds
Construct subgraphs: 0.051 seconds
REG metis partition end ----................................
REG construction  time spent:  3.8621320724487305
pure dgl.metis_partition the time spent:  10.931383848190308
connection checking time:  5.441015005111694
block generation total time  5.527521848678589
generate_dataloader_block spend   26.53992009162903
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.853515625 GB
    Memory Allocated: 5.731463432312012  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.853515625 GB
    Memory Allocated: 5.733441352844238  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.853515625 GB
    Memory Allocated: 6.634751796722412  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.853515625 GB
    Memory Allocated: 6.636712074279785  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.857421875 GB
    Memory Allocated: 6.8216166496276855  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.857421875 GB
    Memory Allocated: 6.823574542999268  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 17.79315996170044  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 17.795040130615234  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 17.471434593200684  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 17.47337818145752  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 9.423957824707031  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 9.426546573638916  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  6
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 10.674524784088135  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 10.676551818847656  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

pure train time  3.4392471313476562
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 0.1750802993774414  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.556048631668091
loading full batch data spends  0.16391539573669434
REG start----................................
Convert a graph into a bidirected graph: 1.468 seconds, peak memory: 74.862 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.862 GB
Metis partitioning: 6.778 seconds, peak memory: 74.862 GB
Split the graph: 2.961 seconds
Construct subgraphs: 0.014 seconds
REG metis partition end ----................................
REG construction  time spent:  4.002446413040161
pure dgl.metis_partition the time spent:  11.237261056900024
connection checking time:  4.493588447570801
block generation total time  5.2163615226745605
generate_dataloader_block spend   25.731125116348267
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 5.230077743530273  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 5.232682704925537  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 6.778173923492432  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 6.780196189880371  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 8.246443748474121  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.859375 GB
    Memory Allocated: 8.248565196990967  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 17.915313720703125  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 17.917213916778564  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.42578125 GB
    Memory Allocated: 17.556814193725586  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.42578125 GB
    Memory Allocated: 17.558987140655518  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.4296875 GB
    Memory Allocated: 10.191933631896973  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.4296875 GB
    Memory Allocated: 10.193944454193115  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  6
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.44921875 GB
    Memory Allocated: 8.918833255767822  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.44921875 GB
    Memory Allocated: 8.920815467834473  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

pure train time  3.7055015563964844
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.451171875 GB
    Memory Allocated: 0.1610550880432129  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.3299944400787354
loading full batch data spends  0.1547093391418457
REG start----................................
Convert a graph into a bidirected graph: 1.453 seconds, peak memory: 75.216 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 75.216 GB
Metis partitioning: 6.472 seconds, peak memory: 75.216 GB
Split the graph: 2.618 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  4.057058334350586
pure dgl.metis_partition the time spent:  10.583192348480225
connection checking time:  5.775580644607544
block generation total time  5.761238098144531
generate_dataloader_block spend   27.015385150909424
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.451171875 GB
    Memory Allocated: 5.691406726837158  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.451171875 GB
    Memory Allocated: 5.693465709686279  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.451171875 GB
    Memory Allocated: 7.794078350067139  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.451171875 GB
    Memory Allocated: 7.796045303344727  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.58203125 GB
    Memory Allocated: 6.6247239112854  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.58203125 GB
    Memory Allocated: 6.626690864562988  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.58203125 GB
    Memory Allocated: 8.995073318481445  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.58203125 GB
    Memory Allocated: 8.997074604034424  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.58203125 GB
    Memory Allocated: 11.213199615478516  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.58203125 GB
    Memory Allocated: 11.215200901031494  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.662109375 GB
    Memory Allocated: 17.640100955963135  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.662109375 GB
    Memory Allocated: 17.642070770263672  GigaBytes
Max Memory Allocated: 18.10362482070923  GigaBytes

step  6
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.96484375 GB
    Memory Allocated: 18.047550678253174  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.96484375 GB
    Memory Allocated: 18.04943084716797  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

pure train time  3.463472366333008
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 0.17770147323608398  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2089202404022217
loading full batch data spends  0.17620515823364258
REG start----................................
Convert a graph into a bidirected graph: 1.435 seconds, peak memory: 75.481 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 75.481 GB
Metis partitioning: 6.290 seconds, peak memory: 76.301 GB
Split the graph: 2.850 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  4.0118677616119385
pure dgl.metis_partition the time spent:  10.61148452758789
connection checking time:  5.606122255325317
block generation total time  5.6009392738342285
generate_dataloader_block spend   26.652408361434937
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.536155700683594  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.538129806518555  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.459927558898926  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.4619011878967285  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 7.0518293380737305  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 7.053802013397217  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 10.176167011260986  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 10.1782808303833  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.41260290145874  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.414579391479492  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.663350105285645  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.66532564163208  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  6
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.28829574584961  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.29027795791626  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

pure train time  3.1726179122924805
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 0.17569351196289062  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.163170576095581
loading full batch data spends  0.14949750900268555
REG start----................................
Convert a graph into a bidirected graph: 1.703 seconds, peak memory: 76.637 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 76.637 GB
Metis partitioning: 6.667 seconds, peak memory: 76.637 GB
Split the graph: 2.739 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  4.165111541748047
pure dgl.metis_partition the time spent:  11.145288467407227
connection checking time:  5.536027193069458
block generation total time  5.497865438461304
generate_dataloader_block spend   27.171873569488525
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 5.31472635269165  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 5.317159652709961  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 7.169949531555176  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 7.172001361846924  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.806665897369385  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.808660507202148  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.296430110931396  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.29902458190918  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 10.322644233703613  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 10.324903964996338  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.777238368988037  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.779634475708008  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  6
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.253520011901855  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.25540018081665  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

pure train time  3.1855270862579346
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 0.17145824432373047  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.090998888015747
loading full batch data spends  0.16587305068969727
REG start----................................
Convert a graph into a bidirected graph: 1.492 seconds, peak memory: 76.637 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 76.637 GB
Metis partitioning: 6.446 seconds, peak memory: 76.637 GB
Split the graph: 2.603 seconds
Construct subgraphs: 0.027 seconds
REG metis partition end ----................................
REG construction  time spent:  4.069899320602417
pure dgl.metis_partition the time spent:  10.585288047790527
connection checking time:  5.5628533363342285
block generation total time  5.604568004608154
generate_dataloader_block spend   26.613515853881836
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 5.786799907684326  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 5.7888712882995605  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.620927810668945  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.622891902923584  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 7.040746212005615  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 7.042689323425293  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.779086112976074  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.781835079193115  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 10.777316570281982  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 10.77996826171875  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.39160442352295  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.393784999847412  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  6
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.750455379486084  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.752799034118652  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

pure train time  3.1602954864501953
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 0.1687469482421875  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0211095809936523
loading full batch data spends  0.14699530601501465
REG start----................................
Convert a graph into a bidirected graph: 1.442 seconds, peak memory: 76.637 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 76.637 GB
Metis partitioning: 6.554 seconds, peak memory: 76.637 GB
Split the graph: 2.621 seconds
Construct subgraphs: 0.035 seconds
REG metis partition end ----................................
REG construction  time spent:  4.078110218048096
pure dgl.metis_partition the time spent:  10.669555902481079
connection checking time:  5.667755365371704
block generation total time  5.626611948013306
generate_dataloader_block spend   26.830037355422974
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 5.6940460205078125  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 5.69658899307251  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.862045764923096  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.864010810852051  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 7.383111000061035  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 7.385072231292725  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 10.1004319190979  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 10.10234260559082  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.907931327819824  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.910003185272217  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.76224708557129  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.76431894302368  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  6
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.622015953063965  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.624152660369873  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

pure train time  3.1550967693328857
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 0.16855907440185547  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9708662033081055
loading full batch data spends  0.13161873817443848
REG start----................................
Convert a graph into a bidirected graph: 1.457 seconds, peak memory: 76.637 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 76.637 GB
Metis partitioning: 6.678 seconds, peak memory: 76.637 GB
Split the graph: 3.075 seconds
Construct subgraphs: 0.016 seconds
REG metis partition end ----................................
REG construction  time spent:  4.219721555709839
pure dgl.metis_partition the time spent:  11.243704557418823
connection checking time:  5.7164387702941895
block generation total time  5.687243461608887
generate_dataloader_block spend   27.680988550186157
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 7.755444049835205  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 7.757791996002197  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.992588043212891  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.994558334350586  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 7.012505054473877  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 7.014687538146973  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.2319016456604  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.234023571014404  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.892587184906006  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.895318984985352  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.291561126708984  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.293556690216064  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  6
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.760653972625732  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.762611389160156  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

pure train time  3.164358377456665
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 0.16510915756225586  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9252161979675293
loading full batch data spends  0.12261080741882324
REG start----................................
Convert a graph into a bidirected graph: 1.498 seconds, peak memory: 76.750 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 76.750 GB
Metis partitioning: 6.518 seconds, peak memory: 76.750 GB
Split the graph: 2.931 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  4.081796169281006
pure dgl.metis_partition the time spent:  10.986873149871826
connection checking time:  5.617465257644653
block generation total time  5.49297571182251
generate_dataloader_block spend   27.0645854473114
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 8.599421977996826  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 8.601455211639404  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.799397945404053  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.8013916015625  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.77260684967041  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.774526119232178  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.579416751861572  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 6.581841468811035  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.127658367156982  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 9.129965782165527  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 16.86510419845581  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 16.867000102996826  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

step  6
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.89434003829956  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 17.897075653076172  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

pure train time  3.1448304653167725
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.27734375 GB
    Memory Allocated: 0.16350507736206055  GigaBytes
Max Memory Allocated: 18.21917152404785  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8637208938598633
Total (block generation + training)time/epoch 30.74035987854004
pure train time/epoch 3.1637876828511557

num_input_list  [694050, 697826, 700388, 707768, 703697, 691008, 702304, 709257, 728923, 701334]
