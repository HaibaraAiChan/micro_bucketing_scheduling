main start at this time 1689287167.5749822
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
loading full batch data spends  0.12526416778564453
REG start----................................
Convert a graph into a bidirected graph: 1.424 seconds, peak memory: 27.724 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.724 GB
Metis partitioning: 6.219 seconds, peak memory: 28.545 GB
Split the graph: 2.926 seconds
Construct subgraphs: 0.012 seconds
REG metis partition end ----................................
REG construction  time spent:  3.9850151538848877
pure dgl.metis_partition the time spent:  10.610399961471558
connection checking time:  5.154516220092773
block generation total time  5.134597063064575
generate_dataloader_block spend   25.718050479888916
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.94140625 GB
    Memory Allocated: 6.275422096252441  GigaBytes
Max Memory Allocated: 6.394425392150879  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.94140625 GB
    Memory Allocated: 6.277715682983398  GigaBytes
Max Memory Allocated: 6.394425392150879  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.447265625 GB
    Memory Allocated: 7.699424743652344  GigaBytes
Max Memory Allocated: 7.8578314781188965  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.447265625 GB
    Memory Allocated: 7.7017316818237305  GigaBytes
Max Memory Allocated: 7.8578314781188965  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.68359375 GB
    Memory Allocated: 8.714525699615479  GigaBytes
Max Memory Allocated: 8.84860610961914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.68359375 GB
    Memory Allocated: 8.716789245605469  GigaBytes
Max Memory Allocated: 8.84860610961914  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.041015625 GB
    Memory Allocated: 10.20139455795288  GigaBytes
Max Memory Allocated: 10.330924987792969  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.041015625 GB
    Memory Allocated: 10.203658103942871  GigaBytes
Max Memory Allocated: 10.330924987792969  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.052734375 GB
    Memory Allocated: 18.017332553863525  GigaBytes
Max Memory Allocated: 18.196882724761963  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.052734375 GB
    Memory Allocated: 18.019721031188965  GigaBytes
Max Memory Allocated: 18.196882724761963  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.939453125 GB
    Memory Allocated: 18.701948642730713  GigaBytes
Max Memory Allocated: 18.957337379455566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.939453125 GB
    Memory Allocated: 18.704215049743652  GigaBytes
Max Memory Allocated: 18.957337379455566  GigaBytes

pure train time  3.7352256774902344
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.28125 GB
    Memory Allocated: 0.16452407836914062  GigaBytes
Max Memory Allocated: 18.957337379455566  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.9954047203063965
loading full batch data spends  0.14857268333435059
REG start----................................
Convert a graph into a bidirected graph: 1.476 seconds, peak memory: 70.992 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.992 GB
Metis partitioning: 6.117 seconds, peak memory: 71.833 GB
Split the graph: 3.447 seconds
Construct subgraphs: 0.064 seconds
REG metis partition end ----................................
REG construction  time spent:  3.924649953842163
pure dgl.metis_partition the time spent:  11.122270345687866
connection checking time:  5.085843086242676
block generation total time  5.12603759765625
generate_dataloader_block spend   26.066424131393433
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.005859375 GB
    Memory Allocated: 6.657576084136963  GigaBytes
Max Memory Allocated: 18.957337379455566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.005859375 GB
    Memory Allocated: 6.660070896148682  GigaBytes
Max Memory Allocated: 18.957337379455566  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.080078125 GB
    Memory Allocated: 8.72982120513916  GigaBytes
Max Memory Allocated: 18.957337379455566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.080078125 GB
    Memory Allocated: 8.732774257659912  GigaBytes
Max Memory Allocated: 18.957337379455566  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.1171875 GB
    Memory Allocated: 7.791563987731934  GigaBytes
Max Memory Allocated: 18.957337379455566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.1171875 GB
    Memory Allocated: 7.793862819671631  GigaBytes
Max Memory Allocated: 18.957337379455566  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.1171875 GB
    Memory Allocated: 10.280476570129395  GigaBytes
Max Memory Allocated: 18.957337379455566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.1171875 GB
    Memory Allocated: 10.282822132110596  GigaBytes
Max Memory Allocated: 18.957337379455566  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.841796875 GB
    Memory Allocated: 18.896255493164062  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.841796875 GB
    Memory Allocated: 18.89851140975952  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 16.948904991149902  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 16.95116090774536  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

pure train time  3.0558178424835205
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 0.17268753051757812  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.5564937591552734
loading full batch data spends  0.14401006698608398
REG start----................................
Convert a graph into a bidirected graph: 1.468 seconds, peak memory: 75.878 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 75.878 GB
Metis partitioning: 6.467 seconds, peak memory: 76.689 GB
Split the graph: 3.112 seconds
Construct subgraphs: 0.012 seconds
REG metis partition end ----................................
REG construction  time spent:  4.282841920852661
pure dgl.metis_partition the time spent:  11.075601816177368
connection checking time:  5.451441764831543
block generation total time  5.524760007858276
generate_dataloader_block spend   27.162610292434692
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 6.76206636428833  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 6.764455318450928  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 9.6648850440979  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 9.66731595993042  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 7.617745399475098  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 7.62005615234375  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 11.089834213256836  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 11.092581272125244  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 18.85268259048462  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.416015625 GB
    Memory Allocated: 18.854876041412354  GigaBytes
Max Memory Allocated: 19.16118049621582  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.126953125 GB
    Memory Allocated: 19.461655139923096  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.126953125 GB
    Memory Allocated: 19.464248657226562  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

pure train time  3.2536232471466064
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.1328125 GB
    Memory Allocated: 0.17334413528442383  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.326511859893799
loading full batch data spends  0.1479330062866211
REG start----................................
Convert a graph into a bidirected graph: 1.468 seconds, peak memory: 77.024 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.024 GB
Metis partitioning: 6.398 seconds, peak memory: 77.024 GB
Split the graph: 3.417 seconds
Construct subgraphs: 0.042 seconds
REG metis partition end ----................................
REG construction  time spent:  3.954101324081421
pure dgl.metis_partition the time spent:  11.341919660568237
connection checking time:  5.4781858921051025
block generation total time  5.346164226531982
generate_dataloader_block spend   26.931941270828247
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.966796875 GB
    Memory Allocated: 7.51434850692749  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.966796875 GB
    Memory Allocated: 7.516819477081299  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.08984375 GB
    Memory Allocated: 7.585666179656982  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.08984375 GB
    Memory Allocated: 7.588104724884033  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.091796875 GB
    Memory Allocated: 9.46205472946167  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.091796875 GB
    Memory Allocated: 9.464452743530273  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.091796875 GB
    Memory Allocated: 10.571194648742676  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.091796875 GB
    Memory Allocated: 10.573498249053955  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.2578125 GB
    Memory Allocated: 18.208005905151367  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.2578125 GB
    Memory Allocated: 18.210371494293213  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.60546875 GB
    Memory Allocated: 19.125137329101562  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.60546875 GB
    Memory Allocated: 19.127599239349365  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

pure train time  3.107332706451416
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 0.16964006423950195  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.207955837249756
loading full batch data spends  0.1564183235168457
REG start----................................
Convert a graph into a bidirected graph: 1.430 seconds, peak memory: 77.024 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.024 GB
Metis partitioning: 6.172 seconds, peak memory: 77.024 GB
Split the graph: 3.231 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  4.03438138961792
pure dgl.metis_partition the time spent:  10.86928129196167
connection checking time:  5.143703937530518
block generation total time  5.168501377105713
generate_dataloader_block spend   26.014008283615112
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 6.507530212402344  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 6.510079383850098  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 8.448317050933838  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 8.450862884521484  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 8.030133724212646  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 8.032615661621094  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 10.389289379119873  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 10.391597747802734  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 17.404242038726807  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 17.406550407409668  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 18.892610549926758  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.78515625 GB
    Memory Allocated: 18.89506959915161  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

pure train time  2.9190874099731445
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 0.16572141647338867  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1666502952575684
loading full batch data spends  0.16380929946899414
REG start----................................
Convert a graph into a bidirected graph: 1.481 seconds, peak memory: 77.024 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.024 GB
Metis partitioning: 6.136 seconds, peak memory: 77.024 GB
Split the graph: 2.931 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  4.190441846847534
pure dgl.metis_partition the time spent:  10.596179723739624
connection checking time:  5.1652374267578125
block generation total time  5.144266128540039
generate_dataloader_block spend   25.930970668792725
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 6.811271667480469  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 6.813673973083496  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 8.563633918762207  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 8.565955638885498  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 7.457638263702393  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 7.460177421569824  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 10.714372158050537  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 10.716897964477539  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 17.38008213043213  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 17.382297039031982  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 18.896631240844727  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 18.899003505706787  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

pure train time  2.823909282684326
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 0.1658167839050293  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0904741287231445
loading full batch data spends  0.13207578659057617
REG start----................................
Convert a graph into a bidirected graph: 1.511 seconds, peak memory: 77.076 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.076 GB
Metis partitioning: 7.139 seconds, peak memory: 77.076 GB
Split the graph: 3.100 seconds
Construct subgraphs: 0.036 seconds
REG metis partition end ----................................
REG construction  time spent:  4.108484268188477
pure dgl.metis_partition the time spent:  11.80342173576355
connection checking time:  5.157757759094238
block generation total time  5.205488681793213
generate_dataloader_block spend   27.098517656326294
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 7.1345367431640625  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.4765625 GB
    Memory Allocated: 7.136872291564941  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.498046875 GB
    Memory Allocated: 7.565317153930664  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.498046875 GB
    Memory Allocated: 7.567620754241943  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.498046875 GB
    Memory Allocated: 8.944560050964355  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.498046875 GB
    Memory Allocated: 8.947049617767334  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.498046875 GB
    Memory Allocated: 9.98194408416748  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.498046875 GB
    Memory Allocated: 9.984371662139893  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.498046875 GB
    Memory Allocated: 17.68030023574829  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.498046875 GB
    Memory Allocated: 17.6829776763916  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.498046875 GB
    Memory Allocated: 18.99215793609619  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.498046875 GB
    Memory Allocated: 18.994567394256592  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

pure train time  2.930344581604004
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.193359375 GB
    Memory Allocated: 0.1663517951965332  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0236432552337646
loading full batch data spends  0.1653306484222412
REG start----................................
Convert a graph into a bidirected graph: 1.507 seconds, peak memory: 77.076 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.076 GB
Metis partitioning: 6.476 seconds, peak memory: 77.530 GB
Split the graph: 3.014 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  4.217724084854126
pure dgl.metis_partition the time spent:  11.03676986694336
connection checking time:  5.437166213989258
block generation total time  5.517717599868774
generate_dataloader_block spend   27.05225944519043
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.193359375 GB
    Memory Allocated: 6.1474833488464355  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.193359375 GB
    Memory Allocated: 6.149892330169678  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.193359375 GB
    Memory Allocated: 9.822413921356201  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.193359375 GB
    Memory Allocated: 9.82472848892212  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 7.568978786468506  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 7.571298122406006  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 11.540040493011475  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 11.54248571395874  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 17.852967262268066  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 17.855181217193604  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 19.27707862854004  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 19.279734134674072  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

pure train time  2.985852003097534
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 0.16796493530273438  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9757018089294434
loading full batch data spends  0.14255857467651367
REG start----................................
Convert a graph into a bidirected graph: 1.502 seconds, peak memory: 77.752 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.752 GB
Metis partitioning: 6.672 seconds, peak memory: 77.752 GB
Split the graph: 3.049 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  4.321931600570679
pure dgl.metis_partition the time spent:  11.26442289352417
connection checking time:  5.297919988632202
block generation total time  5.277113437652588
generate_dataloader_block spend   27.00764513015747
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 7.018544673919678  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 7.020955562591553  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 9.351562023162842  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 9.353968620300293  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 7.664427757263184  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 7.666868686676025  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 10.60016393661499  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 10.602476596832275  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 18.480568885803223  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 18.482800006866455  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 18.458287715911865  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 18.460615158081055  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

pure train time  2.8871912956237793
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 0.17492914199829102  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.925804853439331
loading full batch data spends  0.14017462730407715
REG start----................................
Convert a graph into a bidirected graph: 1.504 seconds, peak memory: 77.752 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.752 GB
Metis partitioning: 6.554 seconds, peak memory: 77.752 GB
Split the graph: 3.424 seconds
Construct subgraphs: 0.029 seconds
REG metis partition end ----................................
REG construction  time spent:  4.10593581199646
pure dgl.metis_partition the time spent:  11.532742261886597
connection checking time:  5.1595845222473145
block generation total time  5.133076190948486
generate_dataloader_block spend   26.761411428451538
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 7.013815402984619  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 7.01632833480835  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 7.657182216644287  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 7.659550666809082  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 9.786230087280273  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 9.78865671157837  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 9.132640838623047  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 9.135178089141846  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 18.99790382385254  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 19.000189304351807  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

step  5
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 17.24411916732788  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 17.246312618255615  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

pure train time  2.8605735301971436
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.201171875 GB
    Memory Allocated: 0.17317771911621094  GigaBytes
Max Memory Allocated: 19.712329864501953  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.863914728164673
Total (block generation + training)time/epoch 30.343169379234315
pure train time/epoch 2.901159683863322

num_input_list  [626412, 628980, 650845, 647908, 621317, 622952, 635059, 636658, 643220, 634212]
