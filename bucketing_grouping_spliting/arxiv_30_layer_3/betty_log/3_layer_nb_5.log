main start at this time 1689123147.5601466
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
loading full batch data spends  0.12603354454040527
REG start----................................
Convert a graph into a bidirected graph: 1.384 seconds, peak memory: 27.723 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.723 GB
Metis partitioning: 5.953 seconds, peak memory: 28.544 GB
Split the graph: 3.410 seconds
Construct subgraphs: 0.030 seconds
REG metis partition end ----................................
REG construction  time spent:  4.000008583068848
pure dgl.metis_partition the time spent:  10.811187267303467
connection checking time:  4.820184946060181
block generation total time  4.641978740692139
generate_dataloader_block spend   25.048951864242554
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.46484375 GB
    Memory Allocated: 7.74362325668335  GigaBytes
Max Memory Allocated: 7.889997482299805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.46484375 GB
    Memory Allocated: 7.746381759643555  GigaBytes
Max Memory Allocated: 7.889997482299805  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.98828125 GB
    Memory Allocated: 8.95743989944458  GigaBytes
Max Memory Allocated: 9.144562721252441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.98828125 GB
    Memory Allocated: 8.96017074584961  GigaBytes
Max Memory Allocated: 9.144562721252441  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.83984375 GB
    Memory Allocated: 10.963547229766846  GigaBytes
Max Memory Allocated: 11.126094341278076  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.83984375 GB
    Memory Allocated: 10.966278076171875  GigaBytes
Max Memory Allocated: 11.126094341278076  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.359375 GB
    Memory Allocated: 21.173664093017578  GigaBytes
Max Memory Allocated: 21.478239059448242  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.359375 GB
    Memory Allocated: 21.176559925079346  GigaBytes
Max Memory Allocated: 21.478239059448242  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.474609375 GB
    Memory Allocated: 16.88807487487793  GigaBytes
Max Memory Allocated: 21.478239059448242  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.474609375 GB
    Memory Allocated: 16.890807628631592  GigaBytes
Max Memory Allocated: 21.478239059448242  GigaBytes

pure train time  3.1694962978363037
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.4765625 GB
    Memory Allocated: 0.1756577491760254  GigaBytes
Max Memory Allocated: 21.478239059448242  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.9961023330688477
loading full batch data spends  0.14490914344787598
REG start----................................
Convert a graph into a bidirected graph: 1.424 seconds, peak memory: 69.853 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.853 GB
Metis partitioning: 6.640 seconds, peak memory: 70.703 GB
Split the graph: 3.469 seconds
Construct subgraphs: 0.039 seconds
REG metis partition end ----................................
REG construction  time spent:  4.163813829421997
pure dgl.metis_partition the time spent:  11.58836317062378
connection checking time:  4.869567394256592
block generation total time  4.993490219116211
generate_dataloader_block spend   26.381243467330933
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.591796875 GB
    Memory Allocated: 8.691709995269775  GigaBytes
Max Memory Allocated: 21.478239059448242  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.591796875 GB
    Memory Allocated: 8.694478511810303  GigaBytes
Max Memory Allocated: 21.478239059448242  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 7.863070487976074  GigaBytes
Max Memory Allocated: 21.478239059448242  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 7.865838527679443  GigaBytes
Max Memory Allocated: 21.478239059448242  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 11.179036617279053  GigaBytes
Max Memory Allocated: 21.478239059448242  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 11.181800365447998  GigaBytes
Max Memory Allocated: 21.478239059448242  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 21.26362419128418  GigaBytes
Max Memory Allocated: 21.545361042022705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 21.26637887954712  GigaBytes
Max Memory Allocated: 21.545361042022705  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.15625 GB
    Memory Allocated: 19.28425407409668  GigaBytes
Max Memory Allocated: 21.545361042022705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.15625 GB
    Memory Allocated: 19.286924362182617  GigaBytes
Max Memory Allocated: 21.545361042022705  GigaBytes

pure train time  2.925041675567627
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.46484375 GB
    Memory Allocated: 0.17952775955200195  GigaBytes
Max Memory Allocated: 21.545361042022705  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.552506685256958
loading full batch data spends  0.14255142211914062
REG start----................................
Convert a graph into a bidirected graph: 1.454 seconds, peak memory: 74.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 74.191 GB
Metis partitioning: 6.332 seconds, peak memory: 75.002 GB
Split the graph: 4.205 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  3.9686920642852783
pure dgl.metis_partition the time spent:  12.026173830032349
connection checking time:  4.770698070526123
block generation total time  4.86113166809082
generate_dataloader_block spend   26.426661491394043
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.548828125 GB
    Memory Allocated: 7.5052056312561035  GigaBytes
Max Memory Allocated: 21.545361042022705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.548828125 GB
    Memory Allocated: 7.5082221031188965  GigaBytes
Max Memory Allocated: 21.545361042022705  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.5859375 GB
    Memory Allocated: 8.46713638305664  GigaBytes
Max Memory Allocated: 21.545361042022705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.5859375 GB
    Memory Allocated: 8.469876289367676  GigaBytes
Max Memory Allocated: 21.545361042022705  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.58984375 GB
    Memory Allocated: 10.538186073303223  GigaBytes
Max Memory Allocated: 21.545361042022705  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.58984375 GB
    Memory Allocated: 10.541171550750732  GigaBytes
Max Memory Allocated: 21.545361042022705  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.6171875 GB
    Memory Allocated: 21.566231727600098  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.6171875 GB
    Memory Allocated: 21.56898260116577  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.296875 GB
    Memory Allocated: 17.520443439483643  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.296875 GB
    Memory Allocated: 17.523083686828613  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

pure train time  2.887061834335327
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.44921875 GB
    Memory Allocated: 0.17219257354736328  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.326080083847046
loading full batch data spends  0.14582204818725586
REG start----................................
Convert a graph into a bidirected graph: 1.437 seconds, peak memory: 75.742 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 75.742 GB
Metis partitioning: 6.100 seconds, peak memory: 75.926 GB
Split the graph: 3.416 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  4.084333181381226
pure dgl.metis_partition the time spent:  10.987829208374023
connection checking time:  4.650559902191162
block generation total time  4.489605665206909
generate_dataloader_block spend   25.033381700515747
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.611328125 GB
    Memory Allocated: 8.694021224975586  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.611328125 GB
    Memory Allocated: 8.696806907653809  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.65625 GB
    Memory Allocated: 8.499863147735596  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.65625 GB
    Memory Allocated: 8.502630710601807  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.658203125 GB
    Memory Allocated: 11.335591793060303  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.658203125 GB
    Memory Allocated: 11.338348865509033  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.658203125 GB
    Memory Allocated: 16.948147296905518  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.658203125 GB
    Memory Allocated: 16.950904369354248  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.875 GB
    Memory Allocated: 20.859392642974854  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.875 GB
    Memory Allocated: 20.86244297027588  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

pure train time  2.5036087036132812
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.0859375 GB
    Memory Allocated: 0.16673660278320312  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.205049514770508
loading full batch data spends  0.15459728240966797
REG start----................................
Convert a graph into a bidirected graph: 1.453 seconds, peak memory: 76.248 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 76.248 GB
Metis partitioning: 6.084 seconds, peak memory: 77.037 GB
Split the graph: 3.282 seconds
Construct subgraphs: 0.027 seconds
REG metis partition end ----................................
REG construction  time spent:  4.190780401229858
pure dgl.metis_partition the time spent:  10.863234519958496
connection checking time:  4.968973159790039
block generation total time  5.021022319793701
generate_dataloader_block spend   25.79755687713623
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.0859375 GB
    Memory Allocated: 8.16954755783081  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.0859375 GB
    Memory Allocated: 8.172499179840088  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.0859375 GB
    Memory Allocated: 8.707700252532959  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.0859375 GB
    Memory Allocated: 8.710540771484375  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.0859375 GB
    Memory Allocated: 11.145686626434326  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.0859375 GB
    Memory Allocated: 11.148625373840332  GigaBytes
Max Memory Allocated: 21.882513999938965  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.494140625 GB
    Memory Allocated: 21.631391048431396  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.494140625 GB
    Memory Allocated: 21.63422679901123  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.498046875 GB
    Memory Allocated: 18.114805221557617  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.498046875 GB
    Memory Allocated: 18.117490768432617  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

pure train time  2.736517906188965
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.498046875 GB
    Memory Allocated: 0.1777653694152832  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.168325424194336
loading full batch data spends  0.1073904037475586
REG start----................................
Convert a graph into a bidirected graph: 1.487 seconds, peak memory: 77.354 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 77.354 GB
Metis partitioning: 6.583 seconds, peak memory: 77.380 GB
Split the graph: 4.058 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  4.105454683303833
pure dgl.metis_partition the time spent:  12.16654086112976
connection checking time:  4.90523362159729
block generation total time  5.12983775138855
generate_dataloader_block spend   27.092573881149292
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51953125 GB
    Memory Allocated: 8.625971794128418  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51953125 GB
    Memory Allocated: 8.628729820251465  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.546875 GB
    Memory Allocated: 8.516354084014893  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.546875 GB
    Memory Allocated: 8.520031929016113  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.55078125 GB
    Memory Allocated: 11.218858242034912  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.55078125 GB
    Memory Allocated: 11.222536087036133  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.55078125 GB
    Memory Allocated: 16.904598712921143  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.55078125 GB
    Memory Allocated: 16.907291412353516  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.55078125 GB
    Memory Allocated: 21.3714337348938  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.55078125 GB
    Memory Allocated: 21.37440586090088  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

pure train time  2.6926374435424805
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.767578125 GB
    Memory Allocated: 0.1679520606994629  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0891053676605225
loading full batch data spends  0.10915470123291016
REG start----................................
Convert a graph into a bidirected graph: 1.622 seconds, peak memory: 78.079 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.079 GB
Metis partitioning: 6.866 seconds, peak memory: 78.079 GB
Split the graph: 3.315 seconds
Construct subgraphs: 0.016 seconds
REG metis partition end ----................................
REG construction  time spent:  4.121484994888306
pure dgl.metis_partition the time spent:  11.836822032928467
connection checking time:  4.943160057067871
block generation total time  4.902039051055908
generate_dataloader_block spend   26.592823266983032
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.669921875 GB
    Memory Allocated: 8.311469078063965  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.669921875 GB
    Memory Allocated: 8.314558506011963  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.71875 GB
    Memory Allocated: 8.311068534851074  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.71875 GB
    Memory Allocated: 8.314034938812256  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.71875 GB
    Memory Allocated: 11.513040542602539  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.71875 GB
    Memory Allocated: 11.515805721282959  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.33203125 GB
    Memory Allocated: 21.237656116485596  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.33203125 GB
    Memory Allocated: 21.240421295166016  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.0234375 GB
    Memory Allocated: 17.494173526763916  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.0234375 GB
    Memory Allocated: 17.497087478637695  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

pure train time  2.6832449436187744
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.02734375 GB
    Memory Allocated: 0.17544984817504883  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.021789073944092
loading full batch data spends  0.13616204261779785
REG start----................................
Convert a graph into a bidirected graph: 1.454 seconds, peak memory: 78.079 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 78.079 GB
Metis partitioning: 6.327 seconds, peak memory: 78.079 GB
Split the graph: 3.287 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  4.151028394699097
pure dgl.metis_partition the time spent:  11.103961944580078
connection checking time:  5.027049541473389
block generation total time  4.9584386348724365
generate_dataloader_block spend   26.083005905151367
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.1640625 GB
    Memory Allocated: 8.420740604400635  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.1640625 GB
    Memory Allocated: 8.423655033111572  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.1640625 GB
    Memory Allocated: 7.943975925445557  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.1640625 GB
    Memory Allocated: 7.9469404220581055  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.1640625 GB
    Memory Allocated: 11.693089962005615  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.1640625 GB
    Memory Allocated: 11.695854663848877  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  3
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.513671875 GB
    Memory Allocated: 21.588850021362305  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.513671875 GB
    Memory Allocated: 21.59163808822632  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

step  4
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.173828125 GB
    Memory Allocated: 18.350886344909668  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.173828125 GB
    Memory Allocated: 18.353878498077393  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes

pure train time  2.615264415740967
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.173828125 GB
    Memory Allocated: 0.17596101760864258  GigaBytes
Max Memory Allocated: 21.92216682434082  GigaBytes
