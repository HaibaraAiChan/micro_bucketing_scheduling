main start at this time 1689540994.1858642
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
loading full batch data spends  0.0023627281188964844
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.815 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.815 GB
Metis partitioning: 0.000 seconds, peak memory: 23.815 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009838104248046875
pure dgl.metis_partition the time spent:  0.003203153610229492
connection checking time:  0.003723621368408203
block generation total time  0.0040187835693359375
generate_dataloader_block spend   0.02453756332397461
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.6328125 GB
    Memory Allocated: 0.09250307083129883  GigaBytes
Max Memory Allocated: 0.09505605697631836  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.6328125 GB
    Memory Allocated: 0.09250593185424805  GigaBytes
Max Memory Allocated: 0.09505605697631836  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.1469120979309082  GigaBytes
Max Memory Allocated: 0.21649599075317383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.14691448211669922  GigaBytes
Max Memory Allocated: 0.21649599075317383  GigaBytes

pure train time  0.48282289505004883
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.921875 GB
    Memory Allocated: 0.2519707679748535  GigaBytes
Max Memory Allocated: 0.3457207679748535  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9465503692626953
loading full batch data spends  0.0029561519622802734
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.764 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.764 GB
Metis partitioning: 0.000 seconds, peak memory: 24.764 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007573366165161133
pure dgl.metis_partition the time spent:  0.0030853748321533203
connection checking time:  0.001806020736694336
block generation total time  0.0037610530853271484
generate_dataloader_block spend   0.020214080810546875
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.921875 GB
    Memory Allocated: 0.2785806655883789  GigaBytes
Max Memory Allocated: 0.3457207679748535  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.921875 GB
    Memory Allocated: 0.2785835266113281  GigaBytes
Max Memory Allocated: 0.3457207679748535  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27390289306640625  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27390527725219727  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

pure train time  0.09876513481140137
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.25191736221313477  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9234862327575684
loading full batch data spends  0.0029735565185546875
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007230997085571289
pure dgl.metis_partition the time spent:  0.002449512481689453
connection checking time:  0.001722574234008789
block generation total time  0.004245281219482422
generate_dataloader_block spend   0.01912689208984375
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2746896743774414  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2746925354003906  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2777981758117676  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2778005599975586  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

pure train time  0.07319974899291992
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.25218629837036133  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9032808542251587
loading full batch data spends  0.0035104751586914062
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009187936782836914
pure dgl.metis_partition the time spent:  0.0032410621643066406
connection checking time:  0.001871347427368164
block generation total time  0.004906654357910156
generate_dataloader_block spend   0.0237424373626709
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2757296562194824  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27573251724243164  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27678632736206055  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27678871154785156  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

pure train time  0.10014224052429199
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.25214338302612305  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.879246711730957
loading full batch data spends  0.0040781497955322266
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009181022644042969
pure dgl.metis_partition the time spent:  0.0028274059295654297
connection checking time:  0.00208282470703125
block generation total time  0.004723548889160156
generate_dataloader_block spend   0.023836374282836914
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2796034812927246  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27960634231567383  GigaBytes
Max Memory Allocated: 0.40226316452026367  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2729353904724121  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2729377746582031  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

pure train time  0.06656241416931152
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2519493103027344  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8483901023864746
loading full batch data spends  0.0027692317962646484
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007757425308227539
pure dgl.metis_partition the time spent:  0.002668619155883789
connection checking time:  0.0020208358764648438
block generation total time  0.0038726329803466797
generate_dataloader_block spend   0.020215511322021484
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27704811096191406  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2770509719848633  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2754969596862793  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2754993438720703  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

pure train time  0.10225486755371094
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2519993782043457  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.812382698059082
loading full batch data spends  0.0036437511444091797
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009032487869262695
pure dgl.metis_partition the time spent:  0.002708911895751953
connection checking time:  0.0021839141845703125
block generation total time  0.004300355911254883
generate_dataloader_block spend   0.02260112762451172
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2781834602355957  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2781863212585449  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2743210792541504  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2743234634399414  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

pure train time  0.06446957588195801
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2519407272338867  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7685154676437378
loading full batch data spends  0.0027027130126953125
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.007487773895263672
pure dgl.metis_partition the time spent:  0.002634286880493164
connection checking time:  0.0017452239990234375
block generation total time  0.003961801528930664
generate_dataloader_block spend   0.01989293098449707
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2763404846191406  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27634334564208984  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27637195587158203  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27637434005737305  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

pure train time  0.10640621185302734
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2521328926086426  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7179174423217773
loading full batch data spends  0.003931760787963867
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008733034133911133
pure dgl.metis_partition the time spent:  0.0025746822357177734
connection checking time:  0.0012907981872558594
block generation total time  0.0040874481201171875
generate_dataloader_block spend   0.02058577537536621
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27822399139404297  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2782268524169922  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27431249618530273  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27431488037109375  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

pure train time  0.09447550773620605
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2519564628601074  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7378199100494385
loading full batch data spends  0.002059459686279297
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004685163497924805
pure dgl.metis_partition the time spent:  0.002421855926513672
connection checking time:  0.0016248226165771484
block generation total time  0.004051685333251953
generate_dataloader_block spend   0.015903472900390625
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2774362564086914  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2774391174316406  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27509307861328125  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.27509546279907227  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

pure train time  0.07497715950012207
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.953125 GB
    Memory Allocated: 0.2519512176513672  GigaBytes
Max Memory Allocated: 0.40328073501586914  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.614711046218872
Total (block generation + training)time/epoch 0.2267925262451172
pure train time/epoch 0.08485762278238933

num_input_list  [592, 591, 591, 592, 602, 598, 594, 596, 593, 598]
