main start at this time 1689541046.9628406
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
loading full batch data spends  0.0023086071014404297
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.810 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.810 GB
Metis partitioning: 0.000 seconds, peak memory: 23.810 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009940147399902344
pure dgl.metis_partition the time spent:  0.003549814224243164
connection checking time:  0.0038542747497558594
block generation total time  0.0053675174713134766
generate_dataloader_block spend   0.026514530181884766
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.6171875 GB
    Memory Allocated: 0.0770263671875  GigaBytes
Max Memory Allocated: 0.07836008071899414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.6171875 GB
    Memory Allocated: 0.07702875137329102  GigaBytes
Max Memory Allocated: 0.07836008071899414  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.755859375 GB
    Memory Allocated: 0.1454920768737793  GigaBytes
Max Memory Allocated: 0.2016448974609375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.755859375 GB
    Memory Allocated: 0.1454939842224121  GigaBytes
Max Memory Allocated: 0.2016448974609375  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.818359375 GB
    Memory Allocated: 0.14219093322753906  GigaBytes
Max Memory Allocated: 0.26953840255737305  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.818359375 GB
    Memory Allocated: 0.14219284057617188  GigaBytes
Max Memory Allocated: 0.26953840255737305  GigaBytes

pure train time  0.5001981258392334
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.912109375 GB
    Memory Allocated: 0.25150012969970703  GigaBytes
Max Memory Allocated: 0.34525012969970703  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9465501308441162
loading full batch data spends  0.0015704631805419922
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.763 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.763 GB
Metis partitioning: 0.000 seconds, peak memory: 24.763 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00522923469543457
pure dgl.metis_partition the time spent:  0.002708911895751953
connection checking time:  0.0018184185028076172
block generation total time  0.005215167999267578
generate_dataloader_block spend   0.017917394638061523
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.912109375 GB
    Memory Allocated: 0.267885684967041  GigaBytes
Max Memory Allocated: 0.34525012969970703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.912109375 GB
    Memory Allocated: 0.26788806915283203  GigaBytes
Max Memory Allocated: 0.34525012969970703  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.27114295959472656  GigaBytes
Max Memory Allocated: 0.39243459701538086  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2711448669433594  GigaBytes
Max Memory Allocated: 0.39243459701538086  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26404666900634766  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26404857635498047  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

pure train time  0.09804511070251465
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2513771057128906  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9234862327575684
loading full batch data spends  0.0014576911926269531
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0048007965087890625
pure dgl.metis_partition the time spent:  0.0027115345001220703
connection checking time:  0.0017943382263183594
block generation total time  0.0050923824310302734
generate_dataloader_block spend   0.017197847366333008
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26722145080566406  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2672238349914551  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26928234100341797  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2692842483520508  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2665400505065918  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2665419578552246  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

pure train time  0.09519124031066895
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2515373229980469  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9032809734344482
loading full batch data spends  0.0013766288757324219
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004758596420288086
pure dgl.metis_partition the time spent:  0.002585172653198242
connection checking time:  0.0017766952514648438
block generation total time  0.005666971206665039
generate_dataloader_block spend   0.01749277114868164
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26683664321899414  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26683902740478516  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26770782470703125  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26770973205566406  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2686018943786621  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2686038017272949  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

pure train time  0.08424186706542969
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2515907287597656  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.879246711730957
loading full batch data spends  0.0013921260833740234
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004758358001708984
pure dgl.metis_partition the time spent:  0.002748727798461914
connection checking time:  0.0017621517181396484
block generation total time  0.005048513412475586
generate_dataloader_block spend   0.017064809799194336
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.27048683166503906  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2704892158508301  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2672133445739746  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2672152519226074  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2654142379760742  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26541614532470703  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

pure train time  0.07938551902770996
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.25144147872924805  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8483903408050537
loading full batch data spends  0.0013241767883300781
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004711627960205078
pure dgl.metis_partition the time spent:  0.002508401870727539
connection checking time:  0.0017876625061035156
block generation total time  0.005052089691162109
generate_dataloader_block spend   0.016819477081298828
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26636314392089844  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26636552810668945  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.27022790908813477  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2702298164367676  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2664985656738281  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26650047302246094  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

pure train time  0.08315277099609375
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.25141477584838867  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8123829364776611
loading full batch data spends  0.0016579627990722656
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004705190658569336
pure dgl.metis_partition the time spent:  0.0022902488708496094
connection checking time:  0.0017600059509277344
block generation total time  0.005041837692260742
generate_dataloader_block spend   0.016524314880371094
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26670169830322266  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26670408248901367  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26955175399780273  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26955366134643555  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26680755615234375  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26680946350097656  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

pure train time  0.08784031867980957
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.25140905380249023  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7685151100158691
loading full batch data spends  0.0013890266418457031
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004738569259643555
pure dgl.metis_partition the time spent:  0.0025653839111328125
connection checking time:  0.0018239021301269531
block generation total time  0.005663156509399414
generate_dataloader_block spend   0.01758718490600586
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2694687843322754  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2694711685180664  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26775693893432617  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.267758846282959  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2659778594970703  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2659797668457031  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

pure train time  0.08760905265808105
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.25161218643188477  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7179176807403564
loading full batch data spends  0.001348733901977539
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004681587219238281
pure dgl.metis_partition the time spent:  0.002234935760498047
connection checking time:  0.0017457008361816406
block generation total time  0.005035877227783203
generate_dataloader_block spend   0.01636528968811035
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26794862747192383  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26795101165771484  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2691836357116699  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26918554306030273  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26593494415283203  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26593685150146484  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

pure train time  0.08220982551574707
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2514467239379883  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7378196716308594
loading full batch data spends  0.0013098716735839844
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.795 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.795 GB
Metis partitioning: 0.000 seconds, peak memory: 24.795 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0047070980072021484
pure dgl.metis_partition the time spent:  0.002468585968017578
connection checking time:  0.0018138885498046875
block generation total time  0.005058765411376953
generate_dataloader_block spend   0.016802310943603516
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2678985595703125  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2679009437561035  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2692556381225586  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2692575454711914  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

step  2
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26590871810913086  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.26591062545776367  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

pure train time  0.0843348503112793
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.943359375 GB
    Memory Allocated: 0.2514467239379883  GigaBytes
Max Memory Allocated: 0.3950662612915039  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6147112846374512
Total (block generation + training)time/epoch 0.2475043535232544
pure train time/epoch 0.08408872286478679

num_input_list  [592, 597, 594, 596, 599, 604, 597, 600, 601, 601]
