main start at this time 1698464092.7649727
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.817 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.817 GB
Metis partitioning: 0.001 seconds, peak memory: 23.817 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.011203289031982422
pure dgl.metis_partition the time spent:  0.004072904586791992
graph partitioner: local batch seeds list  [[9, 10, 18, 24, 26, 29, 31, 36, 37, 42, 50, 52, 58, 60, 64, 67, 68, 69, 75, 78, 80, 82, 83, 85, 86, 90, 91, 103, 112, 113, 114, 120, 125, 129, 133, 139], [0, 6, 7, 25, 27, 28, 30, 35, 44, 45, 46, 47, 49, 54, 56, 57, 61, 62, 66, 71, 77, 92, 94, 98, 106, 108, 109, 111, 118, 122, 127, 128, 132, 138], [1, 3, 5, 12, 21, 32, 33, 34, 39, 40, 43, 51, 55, 63, 65, 74, 81, 84, 89, 95, 97, 101, 104, 105, 110, 115, 116, 117, 119, 121, 124, 131, 134, 137], [2, 4, 8, 11, 13, 14, 15, 16, 17, 19, 20, 22, 23, 38, 41, 48, 53, 59, 70, 72, 73, 76, 79, 87, 88, 93, 96, 99, 100, 102, 107, 123, 126, 130, 135, 136]]

block_gen_time in "generate_blocks_for_one_layer_block"  0.007852315902709961


block_gen_time in "generate_blocks_for_one_layer_block"  0.00829458236694336

connection checking time:  0.009510278701782227
block generation total time  0.01614689826965332
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.515625 GB
    Memory Allocated: 0.07020282745361328  GigaBytes
Max Memory Allocated: 0.07020282745361328  GigaBytes

--------------------------m.shape torch.Size([6, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.0757455825805664  GigaBytes
Max Memory Allocated: 0.07574653625488281  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.0757455825805664  GigaBytes
Max Memory Allocated: 0.07574653625488281  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.07581043243408203  GigaBytes
Max Memory Allocated: 0.07581043243408203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.0763249397277832  GigaBytes
Max Memory Allocated: 0.07635736465454102  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([30, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.07661294937133789  GigaBytes
Max Memory Allocated: 0.0766139030456543  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.07661294937133789  GigaBytes
Max Memory Allocated: 0.0766139030456543  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.07693338394165039  GigaBytes
Max Memory Allocated: 0.07693338394165039  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.611328125 GB
    Memory Allocated: 0.08173990249633789  GigaBytes
Max Memory Allocated: 0.08206033706665039  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([32, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.611328125 GB
    Memory Allocated: 0.08209228515625  GigaBytes
Max Memory Allocated: 0.08209371566772461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.611328125 GB
    Memory Allocated: 0.08209228515625  GigaBytes
Max Memory Allocated: 0.08209371566772461  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 1.611328125 GB
    Memory Allocated: 0.08243465423583984  GigaBytes
Max Memory Allocated: 0.08243465423583984  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.62109375 GB
    Memory Allocated: 0.08995389938354492  GigaBytes
Max Memory Allocated: 0.09046649932861328  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.62109375 GB
    Memory Allocated: 0.09046602249145508  GigaBytes
Max Memory Allocated: 0.09046745300292969  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.62109375 GB
    Memory Allocated: 0.09046602249145508  GigaBytes
Max Memory Allocated: 0.09046745300292969  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 1.62109375 GB
    Memory Allocated: 0.09080839157104492  GigaBytes
Max Memory Allocated: 0.09080839157104492  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.634765625 GB
    Memory Allocated: 0.10071992874145508  GigaBytes
Max Memory Allocated: 0.10140323638916016  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([31, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.634765625 GB
    Memory Allocated: 0.10137653350830078  GigaBytes
Max Memory Allocated: 0.10140323638916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.634765625 GB
    Memory Allocated: 0.10137653350830078  GigaBytes
Max Memory Allocated: 0.10140323638916016  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 1.634765625 GB
    Memory Allocated: 0.10170841217041016  GigaBytes
Max Memory Allocated: 0.10170841217041016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.650390625 GB
    Memory Allocated: 0.11363458633422852  GigaBytes
Max Memory Allocated: 0.11446237564086914  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.650390625 GB
    Memory Allocated: 0.1140131950378418  GigaBytes
Max Memory Allocated: 0.11446237564086914  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.650390625 GB
    Memory Allocated: 0.1140131950378418  GigaBytes
Max Memory Allocated: 0.11446237564086914  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 1.650390625 GB
    Memory Allocated: 0.11419534683227539  GigaBytes
Max Memory Allocated: 0.11446237564086914  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.654296875 GB
    Memory Allocated: 0.12201070785522461  GigaBytes
Max Memory Allocated: 0.12255525588989258  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.654296875 GB
    Memory Allocated: 0.12233114242553711  GigaBytes
Max Memory Allocated: 0.12255525588989258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.654296875 GB
    Memory Allocated: 0.12233114242553711  GigaBytes
Max Memory Allocated: 0.12255525588989258  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 1.654296875 GB
    Memory Allocated: 0.12244939804077148  GigaBytes
Max Memory Allocated: 0.12255525588989258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.658203125 GB
    Memory Allocated: 0.12833213806152344  GigaBytes
Max Memory Allocated: 0.12874364852905273  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([12, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.658203125 GB
    Memory Allocated: 0.1287856101989746  GigaBytes
Max Memory Allocated: 0.12878704071044922  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.658203125 GB
    Memory Allocated: 0.1287856101989746  GigaBytes
Max Memory Allocated: 0.12878704071044922  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 1.658203125 GB
    Memory Allocated: 0.12891435623168945  GigaBytes
Max Memory Allocated: 0.12891435623168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.666015625 GB
    Memory Allocated: 0.1362299919128418  GigaBytes
Max Memory Allocated: 0.13674259185791016  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.666015625 GB
    Memory Allocated: 0.13631010055541992  GigaBytes
Max Memory Allocated: 0.13674259185791016  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.666015625 GB
    Memory Allocated: 0.13631010055541992  GigaBytes
Max Memory Allocated: 0.13674259185791016  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 1.666015625 GB
    Memory Allocated: 0.13634252548217773  GigaBytes
Max Memory Allocated: 0.13674259185791016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.66796875 GB
    Memory Allocated: 0.13840484619140625  GigaBytes
Max Memory Allocated: 0.1385493278503418  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([28, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.66796875 GB
    Memory Allocated: 0.13988351821899414  GigaBytes
Max Memory Allocated: 0.13988733291625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.66796875 GB
    Memory Allocated: 0.13988351821899414  GigaBytes
Max Memory Allocated: 0.13988733291625977  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 1.66796875 GB
    Memory Allocated: 0.1401829719543457  GigaBytes
Max Memory Allocated: 0.1401829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.16141557693481445  GigaBytes
Max Memory Allocated: 0.16291046142578125  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1568446159362793  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15703725814819336  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15727615356445312  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1575002670288086  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1575002670288086  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15750598907470703  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15755176544189453  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15755891799926758  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15755891799926758  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15756845474243164  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15771150588989258  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1577301025390625  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1577301025390625  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.157745361328125  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1580810546875  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15808916091918945  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15808916091918945  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1580967903137207  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15831804275512695  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15833377838134766  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15833377838134766  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1583414077758789  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1586160659790039  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1586298942565918  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1586298942565918  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15863561630249023  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15888166427612305  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15888595581054688  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15888595581054688  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1588878631591797  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1589832305908203  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15899133682250977  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15899133682250977  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15899324417114258  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15911531448364258  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1591339111328125  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1591339111328125  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15913772583007812  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1594085693359375  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15941762924194336  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15941762924194336  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15941953659057617  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15956830978393555  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1595907211303711  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1595907211303711  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15959453582763672  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.15991878509521484  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.15993738174438477  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.15993738174438477  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.15993928909301758  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.16022157669067383  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.16024494171142578  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.16024494171142578  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.1602468490600586  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.1605825424194336  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.1603984832763672  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.1603994369506836  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.1603999137878418  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.1604018211364746  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1371927261352539  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

--------------------------m.shape torch.Size([17, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14029693603515625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14029693603515625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14047908782958984  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14193344116210938  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([21, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14206695556640625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14206695556640625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14229202270507812  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1456594467163086  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([20, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14586734771728516  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14586734771728516  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14608097076416016  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.15078067779541016  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([21, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1511225700378418  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1511225700378418  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.15134763717651367  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.15785741806030273  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([19, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.15825223922729492  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.15825223922729492  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.15845537185668945  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.16576099395751953  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.16614007949829102  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.16614007949829102  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.16630029678344727  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17318964004516602  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17333412170410156  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17333412170410156  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1733989715576172  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17661142349243164  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17675018310546875  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17675018310546875  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17679309844970703  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17923927307128906  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17931413650512695  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17931413650512695  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1793360710144043  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18071413040161133  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([8, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18113040924072266  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18113040924072266  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18121623992919922  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18729591369628906  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18495607376098633  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18508291244506836  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1852402687072754  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18537044525146484  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18537044525146484  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18538570404052734  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18550777435302734  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18551397323608398  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18551397323608398  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18552732467651367  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18572759628295898  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18573856353759766  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18573856353759766  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18575000762939453  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18600177764892578  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18601179122924805  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18601179122924805  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1860194206237793  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18624067306518555  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18625640869140625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18625640869140625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1862640380859375  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1865386962890625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18654680252075195  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18654680252075195  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18655061721801758  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18671464920043945  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1867198944091797  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1867198944091797  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1867218017578125  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18681716918945312  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18683385848999023  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18683385848999023  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18683767318725586  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18708181381225586  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18699264526367188  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18699359893798828  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18699312210083008  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1869945526123047  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.13837432861328125  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

--------------------------m.shape torch.Size([8, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14301252365112305  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14301252365112305  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1430983543395996  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1437835693359375  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([18, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14393329620361328  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14393329620361328  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14412593841552734  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14701271057128906  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([23, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14728498458862305  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14728498458862305  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14753103256225586  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15293550491333008  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([30, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15345335006713867  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15345335006713867  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15377378463745117  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16306638717651367  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([28, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16365385055541992  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16365385055541992  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16395330429077148  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17471933364868164  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17521047592163086  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17521047592163086  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17542409896850586  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18460988998413086  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1849517822265625  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1849517822265625  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18508052825927734  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.191497802734375  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19164705276489258  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19164705276489258  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19170045852661133  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19474458694458008  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19476604461669922  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19476604461669922  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1947774887084961  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19547128677368164  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([23, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19669342041015625  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19669342041015625  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19693946838378906  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21438026428222656  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21056747436523438  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21072769165039062  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21092653274536133  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21111249923706055  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21111249923706055  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21111822128295898  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21116399765014648  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21116924285888672  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21116924285888672  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21117687225341797  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21129131317138672  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21130800247192383  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21130800247192383  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21132135391235352  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21161508560180664  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21162796020507812  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21162796020507812  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2116374969482422  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2119140625  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2119288444519043  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2119288444519043  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21193647384643555  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21221113204956055  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21223068237304688  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21223068237304688  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21223831176757812  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21256637573242188  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2125697135925293  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2125697135925293  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2125716209411621  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21266698837280273  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21268939971923828  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21268939971923828  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21269512176513672  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21302127838134766  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2130274772644043  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2130274772644043  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2130293846130371  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2131514549255371  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21316051483154297  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21316051483154297  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21316242218017578  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21329784393310547  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21332120895385742  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21332120895385742  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21332311630249023  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21365880966186523  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21351099014282227  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21351194381713867  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21351146697998047  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21351289749145508  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.13704919815063477  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

--------------------------m.shape torch.Size([14, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1400890350341797  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1400890350341797  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14023876190185547  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1414351463317871  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([27, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1416487693786621  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1416487693786621  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1419377326965332  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14626646041870117  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([32, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14663457870483398  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14663457870483398  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14697694778442383  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1544961929321289  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15494441986083984  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15494441986083984  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15525436401367188  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16423702239990234  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([9, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1643223762512207  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1643223762512207  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16441869735717773  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16788625717163086  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([10, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16815853118896484  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16815853118896484  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16826534271240234  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17285823822021484  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17310380935668945  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17310380935668945  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17318964004516602  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17747116088867188  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([1, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17747116088867188  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17747116088867188  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17748260498046875  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1781005859375  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1781911849975586  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1781911849975586  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17821311950683594  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17959117889404297  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([8, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1800074577331543  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1800074577331543  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18009328842163086  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1861729621887207  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18391942977905273  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1840529441833496  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1842184066772461  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18436098098754883  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18436098098754883  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1843724250793457  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1844639778137207  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18447589874267578  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18447589874267578  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1844930648803711  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18475055694580078  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18475675582885742  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18475675582885742  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18476629257202148  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18497610092163086  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18500614166259766  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18500614166259766  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18502330780029297  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18552112579345703  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18552732467651367  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18552732467651367  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1855330467224121  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18573904037475586  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18574810028076172  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18574810028076172  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18575191497802734  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18591594696044922  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18592119216918945  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18592119216918945  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18592309951782227  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1860184669494629  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1860361099243164  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1860361099243164  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18603801727294922  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1862936019897461  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18619298934936523  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18619394302368164  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18619346618652344  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18619489669799805  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

pure train time  0.8787975311279297
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27176713943481445  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9443055391311646
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.815 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.815 GB
Metis partitioning: 0.000 seconds, peak memory: 24.815 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005623817443847656
pure dgl.metis_partition the time spent:  0.0028197765350341797
graph partitioner: local batch seeds list  [[1, 15, 16, 17, 20, 30, 40, 42, 43, 45, 54, 57, 60, 63, 65, 69, 70, 72, 80, 81, 86, 90, 91, 97, 99, 100, 101, 102, 103, 108, 109, 112, 118, 120, 129, 139], [7, 13, 14, 18, 19, 34, 35, 36, 39, 41, 44, 46, 47, 58, 67, 74, 76, 77, 78, 79, 92, 94, 95, 98, 104, 106, 111, 117, 119, 121, 122, 125, 126, 130, 131], [6, 12, 22, 26, 27, 28, 29, 31, 32, 33, 37, 38, 48, 66, 75, 83, 85, 87, 88, 89, 96, 105, 107, 110, 114, 115, 116, 124, 132, 133, 134, 135, 137, 138], [0, 2, 3, 4, 5, 8, 9, 10, 11, 21, 23, 24, 25, 49, 50, 51, 52, 53, 55, 56, 59, 61, 62, 64, 68, 71, 73, 82, 84, 93, 113, 123, 127, 128, 136]]

block_gen_time in "generate_blocks_for_one_layer_block"  0.007615089416503906


block_gen_time in "generate_blocks_for_one_layer_block"  0.008433103561401367

connection checking time:  0.007983922958374023
block generation total time  0.016048192977905273
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27279233932495117  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

--------------------------m.shape torch.Size([6, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27753734588623047  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27753734588623047  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.2776021957397461  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27811670303344727  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27832984924316406  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27832984924316406  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.2785758972167969  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.2822608947753906  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([30, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.28261852264404297  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.28261852264404297  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.28293895721435547  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.28998851776123047  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.2905116081237793  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.2905116081237793  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.29085397720336914  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3007655143737793  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([29, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.30136871337890625  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.30136871337890625  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3016786575317383  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.31282949447631836  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3131871223449707  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3131871223449707  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.31335878372192383  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.32071447372436523  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3210024833679199  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3210024833679199  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3211092948913574  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3264498710632324  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.32682371139526367  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.32682371139526367  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.32693052291870117  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.33301877975463867  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.33310985565185547  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.33310985565185547  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3331422805786133  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3352046012878418  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([19, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.33680057525634766  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.33680057525634766  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3370037078857422  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3514118194580078  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34755659103393555  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34772634506225586  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34793710708618164  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

--------------------------m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3481264114379883  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3481264114379883  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3481302261352539  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3481607437133789  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34816694259643555  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34816694259643555  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3481745719909668  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34828901290893555  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3483114242553711  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3483114242553711  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3483285903930664  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3487062454223633  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34871721267700195  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34871721267700195  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.348726749420166  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34900331497192383  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3490180969238281  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3490180969238281  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3490257263183594  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3493003845214844  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3493199348449707  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3493199348449707  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34932756423950195  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3496556282043457  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34966564178466797  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34966564178466797  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3496694564819336  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34986019134521484  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3498663902282715  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3498663902282715  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3498682975769043  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3499770164489746  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3499937057495117  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3499937057495117  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34999752044677734  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.35024166107177734  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3502497673034668  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3502497673034668  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3502516746520996  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3503870964050293  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.35039710998535156  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.35039710998535156  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3503990173339844  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.35054779052734375  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3505587577819824  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3505587577819824  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.35056066513061523  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3507227897644043  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3505725860595703  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3505735397338867  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3505687713623047  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3505706787109375  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2722444534301758  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

--------------------------m.shape torch.Size([10, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2758455276489258  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2758455276489258  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2759523391723633  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2768068313598633  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([29, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27706336975097656  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27706336975097656  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2773733139038086  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28201961517333984  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([22, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28221702575683594  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28221702575683594  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2824525833129883  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2876262664794922  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([23, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28799962997436523  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28799962997436523  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28824567794799805  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29536962509155273  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([11, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29554033279418945  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29554033279418945  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29565858840942383  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2998943328857422  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30031585693359375  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30031585693359375  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30047607421875  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30736541748046875  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3076591491699219  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3076591491699219  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3077659606933594  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3131065368652344  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3132667541503906  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3132667541503906  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3133201599121094  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3163642883300781  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31638574600219727  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31638574600219727  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31639719009399414  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3170909881591797  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([17, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3179931640625  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3179931640625  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3181753158569336  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33107948303222656  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32821178436279297  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32834815979003906  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32851743698120117  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32864999771118164  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32864999771118164  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3286614418029785  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3287529945373535  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3287687301635742  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3287687301635742  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32878971099853516  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3291044235229492  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32910585403442383  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32910585403442383  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3291134834289551  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3292813301086426  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32930469512939453  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32930469512939453  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3293180465698242  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32970523834228516  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32971811294555664  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32971811294555664  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3297257423400879  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3300004005432129  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33000850677490234  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33000850677490234  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33001232147216797  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33017635345458984  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33019304275512695  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33019304275512695  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33019495010375977  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33045053482055664  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33035898208618164  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33035993576049805  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33035945892333984  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33036088943481445  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2728004455566406  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

--------------------------m.shape torch.Size([15, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27768373489379883  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27768373489379883  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2778439521789551  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2791256904602051  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([24, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27930212020874023  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27930212020874023  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2795586585998535  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2834038734436035  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([30, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2837562561035156  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2837562561035156  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2840766906738281  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2911262512207031  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([27, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29154300689697266  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29154300689697266  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29183197021484375  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3002004623413086  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30077695846557617  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30077695846557617  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30106592178344727  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31145429611206055  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([19, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3119187355041504  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3119187355041504  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3121218681335449  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3208479881286621  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([7, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32100820541381836  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32100820541381836  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32108354568481445  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3248305320739746  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32504940032958984  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32504940032958984  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32511425018310547  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32877635955810547  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3288402557373047  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3288402557373047  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32886219024658203  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33024024963378906  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([27, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33184146881103516  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33184146881103516  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33213043212890625  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3526182174682617  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3489232063293457  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34909868240356445  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3493165969848633  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3495192527770996  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3495192527770996  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34952497482299805  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34957075119018555  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3495759963989258  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3495759963989258  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34958362579345703  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3496980667114258  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3497176170349121  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3497176170349121  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3497328758239746  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3500685691833496  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35007667541503906  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35007667541503906  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3500843048095703  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35030555725097656  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3503260612487793  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3503260612487793  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35033559799194336  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506789207458496  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506917953491211  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506917953491211  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35069751739501953  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35094356536865234  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35095643997192383  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35095643997192383  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35096025466918945  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3511776924133301  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3511848449707031  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3511848449707031  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35118675231933594  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35130882263183594  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3513178825378418  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3513178825378418  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3513197898864746  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3514552116394043  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35146617889404297  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35146617889404297  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3514680862426758  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35163021087646484  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35164976119995117  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35164976119995117  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.351651668548584  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35193395614624023  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3519573211669922  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3519573211669922  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.351959228515625  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.352294921875  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3521304130554199  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35213136672973633  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3521308898925781  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35213232040405273  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27214908599853516  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

--------------------------m.shape torch.Size([15, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2755732536315918  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2755732536315918  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27573347091674805  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27701520919799805  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([22, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27717018127441406  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27717018127441406  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2774057388305664  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2809333801269531  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([25, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2812161445617676  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2812161445617676  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28148317337036133  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28735780715942383  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([28, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28782224655151367  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28782224655151367  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28812170028686523  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29679441452026367  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([22, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29723215103149414  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29723215103149414  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2974677085876465  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30593347549438477  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3061680793762207  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3061680793762207  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3062863349914551  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31134557723999023  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3115854263305664  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3115854263305664  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31167125701904297  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31595277786254883  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3159956932067871  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3159956932067871  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31601762771606445  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3172450065612793  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31733036041259766  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31733036041259766  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.317352294921875  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31873035430908203  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([11, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3193068504333496  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3193068504333496  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.319425106048584  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32777833938598633  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3251609802246094  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3253002166748047  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3254728317260742  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32563352584838867  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32563352584838867  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.325650691986084  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3257880210876465  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3257913589477539  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3257913589477539  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3258028030395508  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3259744644165039  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32598352432250977  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32598352432250977  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32599306106567383  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3262028694152832  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3262214660644531  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3262214660644531  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32623291015625  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3265647888183594  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3265690803527832  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3265690803527832  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32657289505004883  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32671022415161133  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3267202377319336  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3267202377319336  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3267240524291992  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3268880844116211  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32690000534057617  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32690000534057617  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3269038200378418  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32709455490112305  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3271017074584961  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3271017074584961  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3271036148071289  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3272256851196289  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32723474502563477  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32723474502563477  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3272366523742676  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32737207412719727  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3273954391479492  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3273954391479492  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32739734649658203  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32773303985595703  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32761716842651367  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3276181221008301  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3276176452636719  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3276190757751465  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

pure train time  0.49114060401916504
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27216005325317383  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9172414541244507
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.849 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.849 GB
Metis partitioning: 0.000 seconds, peak memory: 24.849 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005002737045288086
pure dgl.metis_partition the time spent:  0.002874612808227539
graph partitioner: local batch seeds list  [[0, 15, 19, 22, 24, 32, 35, 37, 42, 64, 66, 68, 69, 70, 75, 81, 82, 94, 101, 102, 106, 108, 111, 112, 115, 116, 117, 122, 124, 130, 132, 133, 135, 137, 139], [1, 2, 3, 5, 7, 13, 17, 20, 28, 29, 31, 38, 40, 41, 55, 65, 67, 73, 74, 77, 78, 79, 83, 84, 88, 89, 92, 99, 114, 118, 119, 120, 121, 123, 134, 136], [12, 14, 18, 21, 23, 30, 33, 43, 44, 46, 48, 49, 52, 57, 58, 59, 60, 71, 72, 76, 85, 87, 90, 93, 98, 105, 110, 113, 125, 127, 128, 129, 131, 138], [4, 6, 8, 9, 10, 11, 16, 25, 26, 27, 34, 36, 39, 45, 47, 50, 51, 53, 54, 56, 61, 62, 63, 80, 86, 91, 95, 96, 97, 100, 103, 104, 107, 109, 126]]

block_gen_time in "generate_blocks_for_one_layer_block"  0.008359909057617188


block_gen_time in "generate_blocks_for_one_layer_block"  0.008366823196411133

connection checking time:  0.007468461990356445
block generation total time  0.01672673225402832
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27303647994995117  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

--------------------------m.shape torch.Size([6, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2789630889892578  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2789630889892578  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27902793884277344  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2795424461364746  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([24, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2797665596008301  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2797665596008301  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28002309799194336  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28386831283569336  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([24, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28412485122680664  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28412485122680664  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2843813896179199  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2900209426879883  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([31, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2905550003051758  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2905550003051758  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29088687896728516  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3004941940307617  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([24, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30096912384033203  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30096912384033203  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3012256622314453  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3104538917541504  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3108701705932617  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3108701705932617  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3110523223876953  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31886768341064453  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3190755844116211  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3190755844116211  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31916141510009766  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3234429359436035  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32382726669311523  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32382726669311523  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32393407821655273  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33002233505249023  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33016157150268555  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33016157150268555  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33020448684692383  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33295106887817383  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([30, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33454179763793945  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33454179763793945  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33486223220825195  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35761308670043945  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35251855850219727  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3526883125305176  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35289907455444336  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

--------------------------m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35309600830078125  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35309600830078125  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3530998229980469  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3531303405761719  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35314035415649414  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35314035415649414  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.353151798248291  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35332345962524414  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3533353805541992  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3533353805541992  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3533468246459961  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35359859466552734  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3536200523376465  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3536200523376465  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35363340377807617  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3540205955505371  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35402870178222656  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35402870178222656  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.354034423828125  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35424041748046875  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35425519943237305  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35425519943237305  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3542609214782715  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3545069694519043  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3545112609863281  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3545112609863281  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35451316833496094  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35460853576660156  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35462522506713867  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35462522506713867  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3546290397644043  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3548731803894043  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3548908233642578  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3548908233642578  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35489463806152344  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3551654815673828  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35517454147338867  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35517454147338867  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3551764488220215  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35532522201538086  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35533618927001953  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35533618927001953  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35533809661865234  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3555002212524414  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35551977157592773  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35551977157592773  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35552167892456055  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3558039665222168  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35564517974853516  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35564613342285156  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3556385040283203  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3556404113769531  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2722506523132324  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([14, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27610349655151367  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27610349655151367  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27625322341918945  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2774496078491211  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([28, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27767372131347656  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27767372131347656  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2779731750488281  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2824592590332031  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([31, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.282806396484375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.282806396484375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2831382751464844  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29042673110961914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([27, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29083776473999023  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29083776473999023  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29112672805786133  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29949522018432617  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([23, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29996490478515625  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29996490478515625  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30021095275878906  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3090543746948242  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([13, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30934810638427734  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30934810638427734  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30948734283447266  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31546592712402344  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([14, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3159198760986328  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3159198760986328  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3160696029663086  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3235459327697754  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32359933853149414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32359933853149414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32363176345825195  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3254685401916504  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32550048828125  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32550048828125  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3255119323730469  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3262057304382324  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3267340660095215  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3267340660095215  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.326840877532959  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3344244956970215  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33147668838500977  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3316330909729004  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33182716369628906  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33199214935302734  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33199214935302734  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33200550079345703  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33211231231689453  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33211374282836914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33211374282836914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3321213722229004  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33223581314086914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3322610855102539  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3322610855102539  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33228015899658203  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3326997756958008  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33270978927612305  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33270978927612305  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3327193260192871  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3329958915710449  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3330106735229492  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3330106735229492  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33301830291748047  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33329296112060547  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3333010673522949  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3333010673522949  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33330488204956055  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3334689140319824  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3334808349609375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3334808349609375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3334846496582031  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3336753845214844  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33368539810180664  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33368539810180664  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33368730545043945  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3338494300842285  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33387279510498047  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33387279510498047  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3338747024536133  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3342103958129883  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3340892791748047  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3340902328491211  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3340897560119629  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3340911865234375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2722744941711426  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.276731014251709  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.276731014251709  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27685976028442383  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27788686752319336  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([24, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2780790328979492  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2780790328979492  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2783355712890625  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2821807861328125  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([32, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2825651168823242  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2825651168823242  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28290748596191406  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29042673110961914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([25, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2907896041870117  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2907896041870117  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29105663299560547  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2988004684448242  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([28, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29941463470458984  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29941463470458984  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2997140884399414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31048011779785156  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([19, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31093931198120117  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31093931198120117  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3111424446105957  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3198685646057129  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([7, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32002878189086914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32002878189086914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32010412216186523  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3238511085510254  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32419824600219727  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32419824600219727  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3242945671081543  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3297848701477051  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3298811912536621  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3298811912536621  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3299136161804199  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33197593688964844  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([16, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33281421661376953  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33281421661376953  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33298587799072266  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34513092041015625  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3415961265563965  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3417630195617676  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34197044372558594  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34215879440307617  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34215879440307617  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3421664237976074  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3422274589538574  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3422355651855469  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3422355651855469  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34224700927734375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3424186706542969  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34243059158325195  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34243059158325195  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34244203567504883  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3426938056945801  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34270381927490234  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34270381927490234  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3427114486694336  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34293270111083984  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34294843673706055  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34294843673706055  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3429560661315918  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3432307243347168  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3432445526123047  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3432445526123047  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3432502746582031  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34349632263183594  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34351682662963867  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34351682662963867  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3435225486755371  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34384870529174805  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34386348724365234  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34386348724365234  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34386730194091797  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34411144256591797  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3441281318664551  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3441281318664551  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3441300392150879  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34438562393188477  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3444089889526367  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3444089889526367  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34441089630126953  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34474658966064453  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34459733963012695  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34459829330444336  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34459781646728516  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.34459924697875977  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2722630500793457  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([14, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27611351013183594  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27611351013183594  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2762632369995117  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27745962142944336  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([21, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27760934829711914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27760934829711914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.277834415435791  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2812018394470215  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([20, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28140974044799805  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28140974044799805  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28162336349487305  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28632307052612305  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([27, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28679323196411133  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28679323196411133  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2870821952819824  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29545068740844727  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29570674896240234  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29570674896240234  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2958669662475586  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3016347885131836  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([12, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3019394874572754  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3019394874572754  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30206823348999023  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3075871467590332  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30782175064086914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30782175064086914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3079075813293457  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31218910217285156  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([1, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31218910217285156  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31218910217285156  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31220054626464844  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3128185272216797  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([12, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31345367431640625  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31345367431640625  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3135824203491211  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3226947784423828  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31955575942993164  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31967973709106445  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31983327865600586  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3199653625488281  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3199653625488281  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3199787139892578  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3200855255126953  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.320096492767334  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.320096492767334  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3201136589050293  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.320371150970459  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3203744888305664  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3203744888305664  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32038211822509766  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32054996490478516  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3205695152282715  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3205695152282715  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32058095932006836  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32091283798217773  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3209266662597656  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3209266662597656  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3209342956542969  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3212089538574219  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32122278213500977  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32122278213500977  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3212285041809082  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.321474552154541  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32147884368896484  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32147884368896484  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32148075103759766  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3215761184692383  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32158517837524414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32158517837524414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32158708572387695  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32172250747680664  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32163238525390625  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32163333892822266  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32163286209106445  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32163429260253906  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

pure train time  0.4585878849029541
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27227210998535156  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8978018760681152
loading full batch data spends  0.005288124084472656
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.881 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.881 GB
Metis partitioning: 0.000 seconds, peak memory: 24.881 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.006122112274169922
pure dgl.metis_partition the time spent:  0.0030138492584228516
graph partitioner: local batch seeds list  [[2, 8, 10, 13, 15, 19, 21, 23, 25, 38, 41, 57, 59, 60, 62, 69, 75, 79, 84, 85, 86, 87, 88, 91, 99, 102, 104, 105, 106, 111, 113, 115, 118, 126, 132], [1, 4, 12, 14, 39, 40, 42, 43, 47, 53, 58, 64, 67, 68, 72, 77, 78, 89, 90, 92, 100, 101, 103, 107, 110, 116, 121, 122, 124, 125, 128, 130, 133, 134, 135, 137], [5, 6, 7, 9, 11, 16, 24, 26, 28, 29, 30, 35, 36, 37, 45, 46, 48, 49, 50, 56, 61, 63, 65, 66, 70, 71, 80, 83, 93, 95, 114, 131, 136, 138, 139], [0, 3, 17, 18, 20, 22, 27, 31, 32, 33, 34, 44, 51, 52, 54, 55, 73, 74, 76, 81, 82, 94, 96, 97, 98, 108, 109, 112, 117, 119, 120, 123, 127, 129]]

block_gen_time in "generate_blocks_for_one_layer_block"  0.007041454315185547


block_gen_time in "generate_blocks_for_one_layer_block"  0.009145498275756836

connection checking time:  0.007532596588134766
block generation total time  0.016186952590942383
generate_dataloader_block spend   0.0373232364654541
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2728414535522461  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2778010368347168  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2778010368347168  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27791929244995117  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27886104583740234  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([26, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2790799140930176  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2790799140930176  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2793583869934082  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2835268974304199  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([21, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.283724308013916  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.283724308013916  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2839493751525879  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28888797760009766  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([27, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2893524169921875  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2893524169921875  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2896413803100586  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29800987243652344  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([24, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2985062599182129  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2985062599182129  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29876279830932617  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30799102783203125  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([14, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30831146240234375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30831146240234375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30846118927001953  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31489086151123047  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([13, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31530189514160156  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31530189514160156  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3154411315917969  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32239294052124023  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32279348373413086  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32279348373413086  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32291173934936523  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.329617977142334  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32975149154663086  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32975149154663086  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32979440689086914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33254098892211914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([26, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33413171768188477  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33413171768188477  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3344101905822754  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3541388511657715  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3500528335571289  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3502216339111328  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3504314422607422  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35062170028686523  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35062170028686523  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3506331443786621  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3507246971130371  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35073089599609375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35073089599609375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3507423400878906  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35091400146484375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3509202003479004  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3509202003479004  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35092782974243164  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35109567642211914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3511075973510742  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3511075973510742  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35111522674560547  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3513364791870117  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3513522148132324  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3513522148132324  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35135984420776367  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35163450241088867  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35164833068847656  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35164833068847656  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.351654052734375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3519001007080078  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3519110679626465  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3519110679626465  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3519148826599121  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35210561752319336  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3521127700805664  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3521127700805664  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3521146774291992  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3522367477416992  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35225534439086914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35225534439086914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35225915908813477  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35253000259399414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3525390625  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3525390625  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3525409698486328  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3526897430419922  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35270071029663086  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35270071029663086  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35270261764526367  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35286474227905273  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35288429260253906  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35288429260253906  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3528861999511719  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3531684875488281  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35302019119262695  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35302114486694336  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35301637649536133  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.35301828384399414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2723679542541504  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2763056755065918  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2763056755065918  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27643442153930664  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27746152877807617  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([21, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2776217460632324  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2776217460632324  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2778468132019043  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28121423721313477  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([30, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2815823554992676  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2815823554992676  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2819027900695801  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2889523506164551  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2894115447998047  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2894115447998047  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2897214889526367  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2987041473388672  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([16, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29897642135620117  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29897642135620117  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2991480827331543  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30530643463134766  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([18, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3057975769042969  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3057975769042969  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30599021911621094  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31426525115966797  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31450557708740234  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31450557708740234  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3146018981933594  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31941795349121094  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31954097747802734  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31954097747802734  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3195838928222656  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32203006744384766  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32210493087768555  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32210493087768555  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3221268653869629  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3235049247741699  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([16, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32434844970703125  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32434844970703125  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3245201110839844  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33666515350341797  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33355140686035156  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33370113372802734  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33388710021972656  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3340444564819336  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3340444564819336  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33405017852783203  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33409595489501953  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3341050148010254  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3341050148010254  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33411645889282227  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3342881202697754  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33431148529052734  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33431148529052734  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33433055877685547  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3347501754760742  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.334775447845459  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.334775447845459  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3347926139831543  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33529043197631836  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.335296630859375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.335296630859375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33530235290527344  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3355083465576172  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3355116844177246  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3355116844177246  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3355135917663574  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33559560775756836  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33560848236083984  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33560848236083984  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33561229705810547  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3358030319213867  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33581018447875977  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33581018447875977  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3358120918273926  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3359341621398926  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3359518051147461  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3359518051147461  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3359537124633789  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3362092971801758  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3360919952392578  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3360929489135742  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.336092472076416  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3360939025878906  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27187347412109375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([14, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2761106491088867  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2761106491088867  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2762603759765625  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27745676040649414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([18, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2775745391845703  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2775745391845703  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2777671813964844  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2806539535522461  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2809743881225586  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2809743881225586  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2812528610229492  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2873663902282715  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([24, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28773975372314453  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28773975372314453  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2879962921142578  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29543018341064453  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([22, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29588937759399414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29588937759399414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2961249351501465  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30459070205688477  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([14, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30492162704467773  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30492162704467773  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3050713539123535  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31150102615356445  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([5, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3116130828857422  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3116130828857422  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31166648864746094  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31433677673339844  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3146090507507324  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3146090507507324  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3146843910217285  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3189558982849121  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3189663887023926  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3189663887023926  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31897783279418945  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.319671630859375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([14, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32041358947753906  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32041358947753906  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32056331634521484  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3311796188354492  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3277244567871094  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3278627395629883  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3280344009399414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32820606231689453  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32820606231689453  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3282175064086914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3283090591430664  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32831335067749023  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32831335067749023  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3283228874206543  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32846593856811523  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3284759521484375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3284759521484375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32848548889160156  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32869529724121094  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32871389389038086  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32871389389038086  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32872533798217773  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3290572166442871  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32907581329345703  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32907581329345703  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3290853500366211  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32942867279052734  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32944154739379883  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32944154739379883  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32944726943969727  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3296933174133301  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3297138214111328  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3297138214111328  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32971954345703125  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3300457000732422  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33005189895629883  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33005189895629883  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33005380630493164  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33017587661743164  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3301992416381836  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3301992416381836  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3302011489868164  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3305368423461914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33040714263916016  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33040809631347656  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33040761947631836  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33040904998779297  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2722916603088379  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([9, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27628278732299805  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27628278732299805  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2763791084289551  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27714967727661133  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([31, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.277432918548584  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.277432918548584  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27776479721069336  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28273439407348633  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([29, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2830328941345215  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2830328941345215  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2833428382873535  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2901573181152344  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([30, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29064321517944336  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29064321517944336  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29096364974975586  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30025625228881836  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([25, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3007636070251465  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3007636070251465  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30103063583374023  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31064367294311523  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([14, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3109588623046875  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3109588623046875  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3111085891723633  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3175382614135742  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3178372383117676  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3178372383117676  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3179440498352051  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3232846260070801  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([1, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3232741355895996  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3232741355895996  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3232855796813965  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32390356063842773  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3239459991455078  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3239459991455078  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3239574432373047  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32465124130249023  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([16, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3255000114440918  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3255000114440918  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3256716728210449  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3378167152404785  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33468198776245117  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3348402976989746  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3350367546081543  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3352022171020508  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3352022171020508  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33521175384521484  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33528804779052734  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.335299015045166  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.335299015045166  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3353142738342285  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.335543155670166  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3355560302734375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3355560302734375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3355693817138672  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3358631134033203  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33586835861206055  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33586835861206055  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.335874080657959  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33604001998901367  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33605194091796875  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33605194091796875  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3360576629638672  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33626365661621094  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33628416061401367  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33628416061401367  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3362917900085449  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33661985397338867  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3366250991821289  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3366250991821289  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3366270065307617  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3367490768432617  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3367581367492676  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3367581367492676  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3367600440979004  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3368954658508301  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33690643310546875  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33690643310546875  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33690834045410156  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3370704650878906  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3370938301086426  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3370938301086426  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3370957374572754  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3374314308166504  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33730602264404297  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3373069763183594  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33730649948120117  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3373079299926758  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

pure train time  0.4451868534088135
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27230358123779297  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.872613549232483
loading full batch data spends  0.0031731128692626953
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.881 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.881 GB
Metis partitioning: 0.000 seconds, peak memory: 24.881 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0049877166748046875
pure dgl.metis_partition the time spent:  0.0028238296508789062
graph partitioner: local batch seeds list  [[6, 16, 17, 18, 19, 20, 22, 26, 28, 29, 41, 44, 46, 50, 55, 56, 67, 70, 72, 73, 74, 81, 82, 84, 89, 91, 105, 106, 109, 117, 119, 121, 122, 126, 127, 128], [0, 1, 4, 7, 8, 38, 43, 53, 57, 61, 64, 65, 68, 69, 75, 76, 77, 85, 86, 87, 88, 93, 95, 97, 98, 99, 108, 115, 116, 123, 132, 134, 135], [2, 3, 5, 9, 10, 11, 21, 23, 25, 27, 33, 34, 35, 37, 39, 42, 47, 51, 52, 62, 63, 71, 79, 90, 94, 96, 100, 102, 118, 125, 130, 131, 133, 137, 138, 139], [12, 13, 14, 15, 24, 30, 31, 32, 36, 40, 45, 48, 49, 54, 58, 59, 60, 66, 78, 80, 83, 92, 101, 103, 104, 107, 110, 111, 112, 113, 114, 120, 124, 129, 136]]

block_gen_time in "generate_blocks_for_one_layer_block"  0.006714344024658203


block_gen_time in "generate_blocks_for_one_layer_block"  0.008441686630249023

connection checking time:  0.007483720779418945
block generation total time  0.015156030654907227
generate_dataloader_block spend   0.03438973426818848
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27324962615966797  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2792086601257324  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2792086601257324  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.27933740615844727  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2803645133972168  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([26, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2805781364440918  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2805781364440918  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2808566093444824  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28502511978149414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([29, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28535032272338867  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.28535032272338867  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.2856602668762207  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29247474670410156  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([30, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29296064376831055  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29296064376831055  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.29328107833862305  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30257368087768555  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([26, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30310773849487305  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30310773849487305  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.30338621139526367  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31338977813720703  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([19, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3138594627380371  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3138594627380371  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.31406259536743164  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32278871536254883  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32302379608154297  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32302379608154297  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3231201171875  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32793617248535156  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32827281951904297  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.32827281951904297  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.328369140625  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3338594436645508  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3339557647705078  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3339557647705078  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3339881896972656  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33605051040649414  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([32, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33774280548095703  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.33774280548095703  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.046875 GB
    Memory Allocated: 0.3380851745605469  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3623504638671875  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3579072952270508  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.35809326171875  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3583240509033203  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3585333824157715  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3585333824157715  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.35854291915893555  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.35861921310424805  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3586244583129883  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3586244583129883  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.35863399505615234  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3587770462036133  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.358792781829834  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.358792781829834  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.35880613327026367  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3590998649597168  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3591127395629883  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3591127395629883  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.35912227630615234  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.35939884185791016  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.35941362380981445  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.35941362380981445  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3594212532043457  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3596959114074707  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3597097396850586  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3597097396850586  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.35971546173095703  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.35996150970458984  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3599677085876465  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3599677085876465  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3599696159362793  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3600916862487793  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3601102828979492  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3601102828979492  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36011409759521484  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3603849411010742  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3603940010070801  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3603940010070801  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3603959083557129  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36054468154907227  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36055564880371094  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36055564880371094  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36055755615234375  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3607196807861328  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36073923110961914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36073923110961914  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36074113845825195  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3610234260559082  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36104679107666016  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36104679107666016  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36104869842529297  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36138439178466797  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36121702194213867  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.3612179756164551  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36121034622192383  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.048828125 GB
    Memory Allocated: 0.36121225357055664  GigaBytes
Max Memory Allocated: 0.47292232513427734  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27200841903686523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([15, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2761058807373047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2761058807373047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27626609802246094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27754783630371094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([19, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27767086029052734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27767086029052734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2778739929199219  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2809181213378906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([18, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28110504150390625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28110504150390625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2812976837158203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28553152084350586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([23, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28592634201049805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28592634201049805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28617238998413086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29329633712768555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([17, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2936272621154785  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2936272621154785  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2938094139099121  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3003525733947754  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([13, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3006782531738281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3006782531738281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30081748962402344  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3067960739135742  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([16, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3073244094848633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3073244094848633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3074960708618164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31604909896850586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31604909896850586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31604909896850586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3160710334777832  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31729841232299805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3173356056213379  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3173356056213379  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31734704971313477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3180408477783203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3185691833496094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3185691833496094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3186759948730469  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3262596130371094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32291126251220703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32303905487060547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3231973648071289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32332468032836914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32332468032836914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.323336124420166  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.323427677154541  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32343196868896484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32343196868896484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3234415054321289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32358455657958984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.323606014251709  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.323606014251709  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3236231803894043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32400083541870117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32401561737060547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32401561737060547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32402706146240234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3243589401245117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3243680000305176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3243680000305176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.324373722076416  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32457971572875977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3245830535888672  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3245830535888672  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3245849609375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32466697692871094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3246798515319824  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3246798515319824  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32468366622924805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3248744010925293  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32488250732421875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32488250732421875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32488441467285156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32501983642578125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32493162155151367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3249325752258301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3249320983886719  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3249335289001465  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2725343704223633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([6, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27742433547973633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27742433547973633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27748918533325195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2780036926269531  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([26, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27824926376342773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27824926376342773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27852773666381836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2826962471008301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([37, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28314971923828125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28314971923828125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28354549407958984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2922396659851074  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([37, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2928318977355957  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2928318977355957  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2932276725769043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3046879768371582  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([28, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3052377700805664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3052377700805664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30553722381591797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3163032531738281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([19, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31676244735717773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31676244735717773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31696557998657227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32569169998168945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32581472396850586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32581472396850586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3258795738220215  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32909202575683594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3293585777282715  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3293585777282715  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3294339179992676  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33370542526245117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3338603973388672  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3338603973388672  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33390331268310547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33664989471435547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([20, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33823060989379883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33823060989379883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33844423294067383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35361146926879883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3502683639526367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3504495620727539  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3506746292114258  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3508901596069336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3508901596069336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35089588165283203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35094165802001953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3509488105773926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3509488105773926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35095834732055664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3511013984680176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3511056900024414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3511056900024414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35111141204833984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35123729705810547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35126543045043945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35126543045043945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35128068923950195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35172319412231445  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517303466796875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517303466796875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35173606872558594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3519420623779297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3519625663757324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3519625663757324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35197019577026367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3522982597351074  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3523082733154297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3523082733154297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3523120880126953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35250282287597656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3525242805480957  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3525242805480957  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35253000259399414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3528561592102051  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35287952423095703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35287952423095703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35288524627685547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35325145721435547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35326719284057617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35326719284057617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.353269100189209  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35352468490600586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3535480499267578  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3535480499267578  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3535499572753906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3538856506347656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3537101745605469  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3537111282348633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3537106513977051  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3537120819091797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2720303535461426  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2752342224121094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2752342224121094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2753734588623047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2764859199523926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([28, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2767152786254883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2767152786254883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27701473236083984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28150081634521484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([25, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2817516326904297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2817516326904297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28201866149902344  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28789329528808594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([23, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2882509231567383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2882509231567383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2884969711303711  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2956209182739258  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([19, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2960052490234375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2960052490234375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29620838165283203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3035140037536621  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([10, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30373287200927734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30373287200927734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30383968353271484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30843257904052734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30860376358032227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30860376358032227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3086686134338379  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31188106536865234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31206226348876953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31206226348876953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3121156692504883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31515979766845703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([11, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3157205581665039  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3157205581665039  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3158388137817383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3241920471191406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32175350189208984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3218870162963867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3220524787902832  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32218027114868164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32218027114868164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3221917152404785  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3222832679748535  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3222970962524414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3222970962524414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32231616973876953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3226022720336914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3226132392883301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3226132392883301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32262659072875977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3229203224182129  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3229255676269531  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3229255676269531  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32293128967285156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32309722900390625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3231186866760254  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3231186866760254  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32312822341918945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3234715461730957  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3234844207763672  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3234844207763672  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3234901428222656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32373619079589844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3237452507019043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3237452507019043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3237471580505371  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32390928268432617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3238224983215332  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3238234519958496  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3238229751586914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.323824405670166  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

pure train time  0.4297654628753662
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27203941345214844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.835220456123352
loading full batch data spends  0.003423929214477539
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.881 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.881 GB
Metis partitioning: 0.000 seconds, peak memory: 24.881 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0049495697021484375
pure dgl.metis_partition the time spent:  0.003065824508666992
graph partitioner: local batch seeds list  [[5, 7, 16, 18, 19, 23, 32, 35, 41, 43, 49, 50, 53, 54, 61, 67, 74, 75, 78, 82, 84, 85, 92, 103, 104, 105, 106, 108, 110, 114, 120, 129, 130, 135, 138, 139], [25, 45, 47, 51, 56, 58, 59, 69, 71, 72, 73, 77, 79, 80, 81, 86, 87, 93, 97, 98, 101, 102, 111, 113, 115, 116, 117, 123, 125, 126, 128, 131, 137], [0, 1, 2, 3, 4, 8, 11, 12, 13, 17, 20, 21, 30, 37, 38, 40, 42, 48, 52, 55, 57, 60, 62, 63, 64, 70, 83, 94, 99, 100, 118, 127, 132, 134, 136], [6, 9, 10, 14, 15, 22, 24, 26, 27, 28, 29, 31, 33, 34, 36, 39, 44, 46, 65, 66, 68, 76, 88, 89, 90, 91, 95, 96, 107, 109, 112, 119, 121, 122, 124, 133]]

block_gen_time in "generate_blocks_for_one_layer_block"  0.006606101989746094


block_gen_time in "generate_blocks_for_one_layer_block"  0.008408546447753906

connection checking time:  0.007410764694213867
block generation total time  0.0150146484375
generate_dataloader_block spend   0.03437662124633789
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27306032180786133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([7, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27836132049560547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27836132049560547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27843666076660156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2790365219116211  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2792658805847168  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2792658805847168  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27953290939331055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2835383415222168  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([32, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2839174270629883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2839174270629883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2842597961425781  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2917790412902832  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([31, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2922701835632324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2922701835632324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2926020622253418  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30220937728881836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([25, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30271100997924805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30271100997924805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3029780387878418  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3125910758972168  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31293821334838867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31293821334838867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3130984306335449  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31998777389526367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32024431228637695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32024431228637695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.320340633392334  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32515668869018555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32553577423095703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32553577423095703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32564258575439453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33173084259033203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33187007904052734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33187007904052734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3319129943847656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3346595764160156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([31, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33629322052001953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33629322052001953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3366250991821289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36014556884765625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35601282119750977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35619306564331055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.356417179107666  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3566274642944336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3566274642944336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35663318634033203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35667896270751953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35668420791625977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35668420791625977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.356691837310791  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35680627822875977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3568229675292969  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3568229675292969  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35683631896972656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3571300506591797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3571467399597168  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3571467399597168  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35715818405151367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35749006271362305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35750389099121094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35750389099121094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3575115203857422  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3577861785888672  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3578000068664551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3578000068664551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3578057289123535  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35805177688598633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35805606842041016  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35805606842041016  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35805797576904297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3581533432006836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3581700325012207  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3581700325012207  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35817384719848633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35841798782348633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35843563079833984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35843563079833984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35843944549560547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35871028900146484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3587193489074707  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3587193489074707  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3587212562561035  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3588700294494629  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35889244079589844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35889244079589844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35889625549316406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3592205047607422  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3592391014099121  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3592391014099121  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3592410087585449  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35952329635620117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35935306549072266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35935401916503906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35934925079345703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35935115814208984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27307844161987305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27683496475219727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27683496475219727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2769637107849121  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27799081802368164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([24, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2781829833984375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2781829833984375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2784395217895508  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2822847366333008  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([32, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2826690673828125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2826690673828125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28301143646240234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2905306816101074  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([26, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29091501235961914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29091501235961914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29119348526000977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2992520332336426  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([23, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2997269630432129  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2997269630432129  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2999730110168457  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30881643295288086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([13, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.309110164642334  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.309110164642334  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3092494010925293  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3152279853820801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3155698776245117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3155698776245117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3156881332397461  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32157087326049805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([1, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32155466079711914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32155466079711914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.321566104888916  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32218408584594727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32222652435302734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32222652435302734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3222379684448242  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32293176651000977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([14, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32367372512817383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32367372512817383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3238234519958496  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.334439754486084  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33151769638061523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.331667423248291  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33185338973999023  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33200597763061523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33200597763061523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3320155143737793  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3320918083190918  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33209705352783203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33209705352783203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3321065902709961  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33224964141845703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33227109909057617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33227109909057617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3322882652282715  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33266592025756836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33268070220947266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33268070220947266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33269214630126953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3330240249633789  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33303308486938477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33303308486938477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3330388069152832  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33324480056762695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3332538604736328  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3332538604736328  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33325767517089844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3334217071533203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33342885971069336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33342885971069336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33343076705932617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33355283737182617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33356189727783203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33356189727783203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33356380462646484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33369922637939453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3337225914001465  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3337225914001465  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3337244987487793  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3340601921081543  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33394670486450195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33394765853881836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33394718170166016  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33394861221313477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2730712890625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([14, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2780036926269531  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2780036926269531  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2781534194946289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27934980392456055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27952051162719727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27952051162719727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2797665596008301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28345155715942383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([30, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28380918502807617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28380918502807617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28412961959838867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29117918014526367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2916383743286133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2916383743286133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2919483184814453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3009309768676758  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([29, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30155038833618164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30155038833618164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30186033248901367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31301116943359375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([23, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31359291076660156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31359291076660156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3138389587402344  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32440185546875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3246903419494629  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3246903419494629  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32480859756469727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3306913375854492  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33101701736450195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33101701736450195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.331113338470459  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33660364151000977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3366999626159668  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3366999626159668  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3367323875427246  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3387947082519531  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([18, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3397397994995117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3397397994995117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3399324417114258  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3535957336425781  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35118770599365234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3513679504394531  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3515920639038086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517932891845703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517932891845703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35179901123046875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35184478759765625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3518519401550293  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3518519401550293  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35186147689819336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3520045280456543  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35201454162597656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35201454162597656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3520240783691406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35223388671875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3522486686706543  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3522486686706543  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35225820541381836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35253477096557617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3525543212890625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3525543212890625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35256385803222656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3529071807861328  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35292577743530273  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35292577743530273  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.352933406829834  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35326147079467773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35327816009521484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35327816009521484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3532838821411133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35356998443603516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35358285903930664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35358285903930664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35358667373657227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3538041114807129  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35381126403808594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35381126403808594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35381317138671875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35393524169921875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35395288467407227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35395288467407227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3539547920227051  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35421037673950195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3542337417602539  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3542337417602539  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3542356491088867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3545713424682617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35440921783447266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35441017150878906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35440969467163086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35441112518310547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2717599868774414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27425670623779297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27425670623779297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2743959426879883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27550840377807617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27570581436157227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27570581436157227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.275972843170166  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27997827529907227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([12, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28003740310668945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28003740310668945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2801661491394043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2829899787902832  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([23, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.283416748046875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.283416748046875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2836627960205078  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2907867431640625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([13, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29101085662841797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29101085662841797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2911500930786133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2961554527282715  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([9, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2963743209838867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2963743209838867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29647064208984375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3006124496459961  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([5, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3007512092590332  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3007512092590332  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30080461502075195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30347490310668945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30353403091430664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30353403091430664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.303555965423584  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30478334426879883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([9, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3052530288696289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3052530288696289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30534934997558594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31218814849853516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31031036376953125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31041622161865234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3105478286743164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3106660842895508  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3106660842895508  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3106832504272461  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3108205795288086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3108334541320801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3108334541320801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.310854434967041  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3111691474914551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3111734390258789  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3111734390258789  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31118297576904297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31139278411865234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31140756607055664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31140756607055664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3114171028137207  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3116936683654785  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3117036819458008  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3117036819458008  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3117094039916992  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31191539764404297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31192445755004883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31192445755004883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31192827224731445  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31209230422973633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31209850311279297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31209850311279297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3121004104614258  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3122091293334961  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3121356964111328  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3121366500854492  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.312136173248291  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3121376037597656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

pure train time  0.4642922878265381
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27176713943481445  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8109333515167236
loading full batch data spends  0.0037605762481689453
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.881 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.881 GB
Metis partitioning: 0.000 seconds, peak memory: 24.881 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004972219467163086
pure dgl.metis_partition the time spent:  0.0029840469360351562
graph partitioner: local batch seeds list  [[8, 9, 21, 23, 24, 25, 28, 31, 37, 38, 53, 54, 57, 61, 66, 70, 71, 77, 80, 81, 82, 90, 91, 93, 95, 98, 101, 102, 105, 108, 114, 116, 118, 126, 128], [7, 10, 22, 30, 35, 36, 40, 41, 42, 43, 49, 52, 56, 58, 59, 60, 65, 68, 78, 84, 85, 86, 87, 92, 100, 107, 109, 110, 113, 119, 120, 125, 134, 136], [0, 2, 4, 6, 12, 13, 14, 15, 16, 18, 19, 20, 27, 33, 34, 39, 44, 45, 51, 55, 62, 63, 64, 69, 79, 96, 106, 123, 124, 127, 130, 132, 133, 135, 137, 139], [1, 3, 5, 11, 17, 26, 29, 32, 46, 47, 48, 50, 67, 72, 73, 74, 75, 76, 83, 88, 89, 94, 97, 99, 103, 104, 111, 112, 115, 117, 121, 122, 129, 131, 138]]

block_gen_time in "generate_blocks_for_one_layer_block"  0.006671905517578125


block_gen_time in "generate_blocks_for_one_layer_block"  0.008409500122070312

connection checking time:  0.0074462890625
block generation total time  0.015081405639648438
generate_dataloader_block spend   0.03461265563964844
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2729306221008301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([7, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2777714729309082  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2777714729309082  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2778468132019043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27844667434692383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27867603302001953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27867603302001953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2789430618286133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28294849395751953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([35, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28337574005126953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28337574005126953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2837495803833008  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2919740676879883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2924065589904785  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2924065589904785  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29271650314331055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.301699161529541  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3022651672363281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3022651672363281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3025541305541992  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3129425048828125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3133106231689453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3133106231689453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31348228454589844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32083797454833984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32105112075805664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32105112075805664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3211369514465332  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32541847229003906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([8, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3257174491882324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3257174491882324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.325803279876709  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33068418502807617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33083391189575195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33083391189575195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33087682723999023  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33362340927124023  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([23, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33521413803100586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33521413803100586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33546018600463867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35290098190307617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3489551544189453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34912872314453125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34934425354003906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34953880310058594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34953880310058594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3495445251464844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3495903015136719  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3495936393737793  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3495936393737793  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34959936141967773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3496851921081543  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34970855712890625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34970855712890625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34972572326660156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35010337829589844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3501105308532715  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3501105308532715  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35011816024780273  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.350339412689209  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35035037994384766  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35035037994384766  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3503561019897461  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35056209564208984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3505825996398926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3505825996398926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35059022903442383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3509182929992676  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.350921630859375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.350921630859375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3509235382080078  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35101890563964844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3510441780090332  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3510441780090332  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35104990005493164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35141611099243164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35143280029296875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35143280029296875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3514366149902344  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35170745849609375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517165184020996  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517165184020996  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517184257507324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3518671989440918  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35188961029052734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35188961029052734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35189342498779297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3522176742553711  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35206127166748047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3520622253417969  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35205793380737305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35205984115600586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2732067108154297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.277101993560791  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.277101993560791  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27724123001098633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2783536911010742  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([27, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27857255935668945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27857255935668945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27886152267456055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2831902503967285  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([20, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28336620330810547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28336620330810547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28357982635498047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28827953338623047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([26, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2887282371520996  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2887282371520996  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28900671005249023  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29706525802612305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29732656478881836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29732656478881836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2974867820739746  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3032546043395996  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([13, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.303591251373291  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.303591251373291  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30373048782348633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3097090721130371  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3100132942199707  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3100132942199707  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3101201057434082  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3154606819152832  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31562089920043945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31562089920043945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3156743049621582  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31871843338012695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3187880516052246  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3187880516052246  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31880998611450195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.320188045501709  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([20, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3217892646789551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3217892646789551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3220028877258301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3371701240539551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33405208587646484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3341960906982422  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33437490463256836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3345193862915039  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3345193862915039  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3345308303833008  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3346223831176758  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33463430404663086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33463430404663086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33465147018432617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33490896224975586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3349151611328125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3349151611328125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33492469787597656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33513450622558594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.335141658782959  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.335141658782959  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3351473808288574  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3353133201599121  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33533477783203125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33533477783203125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3353443145751953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33568763732910156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33570051193237305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33570051193237305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3357062339782715  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3359522819519043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33596324920654297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33596324920654297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3359670639038086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33615779876708984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33617639541625977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33617639541625977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3361783027648926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33646059036254883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33635711669921875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33635807037353516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33635759353637695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33635902404785156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27294111251831055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([10, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2769160270690918  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2769160270690918  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2770228385925293  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2778773307800293  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27806949615478516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27806949615478516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27831554412841797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2820005416870117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([22, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2822299003601074  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2822299003601074  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28246545791625977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28763914108276367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([31, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28818368911743164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28818368911743164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.288515567779541  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2981228828430176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.298677921295166  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.298677921295166  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2989668846130371  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3093552589416504  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3096914291381836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3096914291381836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30985164642333984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3167409896850586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31688547134399414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31688547134399414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31695032119750977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3201627731323242  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3203868865966797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3203868865966797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3204517364501953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3241138458251953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.324129581451416  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.324129581451416  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3241410255432129  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32483482360839844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([16, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32568359375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32568359375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3258552551269531  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3380002975463867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3348379135131836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3349876403808594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3351736068725586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3353581428527832  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3353581428527832  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33536386489868164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33540964126586914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3354225158691406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3354225158691406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3354377746582031  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3356666564941406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33567094802856445  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33567094802856445  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3356785774230957  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3358464241027832  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33586978912353516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33586978912353516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33588314056396484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3362703323364258  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33628320693969727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33628320693969727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3362908363342285  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3365654945373535  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33658504486083984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33658504486083984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3365926742553711  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33692073822021484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33694028854370117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33694028854370117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3369460105895996  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33727216720581055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3372783660888672  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3372783660888672  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3372802734375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33740234375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33741140365600586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33741140365600586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33741331100463867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33754873275756836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3375720977783203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3375720977783203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3375740051269531  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3379096984863281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3377652168273926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.337766170501709  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3377656936645508  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3377671241760254  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2732210159301758  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([16, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2771267890930176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2771267890930176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2772984504699707  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2786674499511719  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([22, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27881669998168945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27881669998168945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2790522575378418  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2825798988342285  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([32, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2829747200012207  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2829747200012207  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28331708908081055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2908363342285156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.291135311126709  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.291135311126709  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29137086868286133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2981905937194824  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([22, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2986602783203125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2986602783203125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29889583587646484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3073616027832031  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3077883720397949  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3077883720397949  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3079705238342285  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31578588485717773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3161435127258301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3161435127258301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3162722587585449  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3226895332336426  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3227963447570801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3227963447570801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32283926010131836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3252854347229004  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32531213760375977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32531213760375977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32532358169555664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3260173797607422  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([13, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3267059326171875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3267059326171875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3268451690673828  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3367166519165039  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3336935043334961  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3338470458984375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33403778076171875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3341946601867676  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3341946601867676  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3342099189758301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3343319892883301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3343343734741211  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3343343734741211  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33434391021728516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3344869613647461  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.334505558013916  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.334505558013916  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3345208168029785  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3348565101623535  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33487987518310547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33487987518310547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33489513397216797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33533763885498047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3353447914123535  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3353447914123535  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33535051345825195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3355565071105957  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33556079864501953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33556079864501953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33556270599365234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33565807342529297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3356757164001465  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3356757164001465  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3356776237487793  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33593320846557617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3359565734863281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3359565734863281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33595848083496094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33629417419433594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3361811637878418  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3361821174621582  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.336181640625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3361830711364746  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

pure train time  0.4358205795288086
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27323293685913086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7858014106750488
loading full batch data spends  0.003850698471069336
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.881 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.881 GB
Metis partitioning: 0.000 seconds, peak memory: 24.881 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005116939544677734
pure dgl.metis_partition the time spent:  0.002884387969970703
graph partitioner: local batch seeds list  [[0, 4, 11, 13, 16, 17, 28, 30, 35, 37, 51, 55, 57, 71, 72, 73, 75, 80, 81, 84, 90, 91, 92, 93, 101, 104, 105, 106, 114, 117, 126, 135, 136, 137], [2, 3, 5, 8, 12, 15, 20, 31, 32, 33, 34, 38, 42, 44, 48, 58, 59, 61, 66, 70, 74, 78, 79, 85, 86, 88, 100, 103, 108, 112, 113, 121, 124, 131, 133], [7, 9, 10, 21, 23, 24, 27, 36, 39, 40, 41, 43, 45, 46, 52, 60, 62, 68, 69, 76, 77, 82, 83, 87, 89, 98, 107, 110, 115, 123, 125, 127, 128, 132, 134, 138], [1, 6, 14, 18, 19, 22, 25, 26, 29, 47, 49, 50, 53, 54, 56, 63, 64, 65, 67, 94, 95, 96, 97, 99, 102, 109, 111, 116, 118, 119, 120, 122, 129, 130, 139]]

block_gen_time in "generate_blocks_for_one_layer_block"  0.006639242172241211


block_gen_time in "generate_blocks_for_one_layer_block"  0.008389711380004883

connection checking time:  0.007509946823120117
block generation total time  0.015028953552246094
generate_dataloader_block spend   0.034620046615600586
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2729339599609375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([6, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27723073959350586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27723073959350586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2772955894470215  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27781009674072266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([24, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2780342102050781  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2780342102050781  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2782907485961914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2821359634399414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([21, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28234434127807617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28234434127807617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28256940841674805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2875080108642578  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([26, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2879509925842285  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2879509925842285  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28822946548461914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29628801345825195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([23, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29676294326782227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29676294326782227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2970089912414551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30585241317749023  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([12, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30611419677734375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30611419677734375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3062429428100586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31176185607910156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31210899353027344  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31210899353027344  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3122272491455078  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31810998916625977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3184356689453125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3184356689453125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31853199005126953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3240222930908203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32411861419677734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32411861419677734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32415103912353516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32621335983276367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([21, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32780933380126953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32780933380126953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3280344009399414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34397125244140625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3404350280761719  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34058380126953125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34076833724975586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3409419059753418  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3409419059753418  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3409457206726074  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3409762382507324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3409862518310547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3409862518310547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34099769592285156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3411693572998047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34118127822875977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34118127822875977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34119272232055664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3414444923400879  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3414621353149414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3414621353149414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3414735794067383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34180545806884766  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34181928634643555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34181928634643555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3418269157409668  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3421015739440918  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3421154022216797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3421154022216797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3421211242675781  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34236717224121094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3423781394958496  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3423781394958496  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34238195419311523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3425726890563965  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3425884246826172  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3425884246826172  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3425922393798828  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3428363800048828  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34284448623657227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34284448623657227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3428463935852051  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34298181533813477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34299182891845703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34299182891845703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34299373626708984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3431425094604492  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3431534767150879  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3431534767150879  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3431553840637207  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34331750869750977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34318113327026367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3431820869445801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34317445755004883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34317636489868164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2732076644897461  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([9, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2777867317199707  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2777867317199707  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27788305282592773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.278653621673584  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([32, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2789473533630371  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2789473533630371  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27928972244262695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28441667556762695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([34, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2847900390625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2847900390625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2851533889770508  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29314279556274414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([33, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29366588592529297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29366588592529297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2940187454223633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30424022674560547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([23, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30467796325683594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30467796325683594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30492401123046875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3137674331665039  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31418895721435547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31418895721435547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31437110900878906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3221864700317383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3225069046020508  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3225069046020508  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32262516021728516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3285079002380371  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3285346031188965  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3285346031188965  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32855653762817383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32978391647338867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32991743087768555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32991743087768555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32994985580444336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3320121765136719  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([20, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33360815048217773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33360815048217773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33382177352905273  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34898900985717773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34534168243408203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3455171585083008  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3457350730895996  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3459205627441406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3459205627441406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3459320068359375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3460235595703125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3460354804992676  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3460354804992676  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3460526466369629  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3463101387023926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3463163375854492  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3463163375854492  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3463258743286133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34653568267822266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34654664993286133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34654664993286133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3465542793273926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34677553176879883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3467864990234375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3467864990234375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34679222106933594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3469982147216797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34700727462768555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34700727462768555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34701108932495117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34717512130737305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3471803665161133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3471803665161133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3471822738647461  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3472776412963867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34728574752807617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34728574752807617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.347287654876709  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.347409725189209  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34741878509521484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34741878509521484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34742069244384766  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34755611419677734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.347567081451416  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.347567081451416  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34756898880004883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3477311134338379  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3477506637573242  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3477506637573242  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34775257110595703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3480348587036133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34805822372436523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34805822372436523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34806013107299805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34839582443237305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3482522964477539  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3482532501220703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3482527732849121  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3482542037963867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27294206619262695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27729177474975586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27729177474975586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2774205207824707  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27844762802124023  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2786288261413574  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2786288261413574  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27887487411499023  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.282559871673584  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([33, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28296566009521484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28296566009521484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28331851959228516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2910728454589844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([28, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29149436950683594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29149436950683594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2917938232421875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30046653747558594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([25, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30098438262939453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30098438262939453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3012514114379883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3108644485473633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3113718032836914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3113718032836914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3115854263305664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3207712173461914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3208889961242676  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3208889961242676  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3209538459777832  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32416629791259766  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([8, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3244757652282715  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3244757652282715  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32456159591674805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32944250106811523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.329495906829834  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.329495906829834  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32951784133911133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33089590072631836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([16, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3317394256591797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3317394256591797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3319110870361328  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3440561294555664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34061670303344727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34078168869018555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3409867286682129  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34119272232055664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34119272232055664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3412003517150879  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3412613868713379  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3412637710571289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3412637710571289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34126949310302734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3413553237915039  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34137582778930664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34137582778930664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34139108657836914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34172677993774414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3417387008666992  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3417387008666992  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3417482376098633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3420248031616211  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3420395851135254  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3420395851135254  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34204721450805664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34232187271118164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3423471450805664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3423471450805664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34235668182373047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34276676177978516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3427853584289551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3427853584289551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3427910804748535  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34311723709106445  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3431234359741211  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3431234359741211  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3431253433227539  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3432474136352539  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34325647354125977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34325647354125977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3432583808898926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34339380264282227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3434114456176758  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3434114456176758  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3434133529663086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34366893768310547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3436923027038574  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3436923027038574  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34369421005249023  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34402990341186523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34386491775512695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34386587142944336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34386539459228516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34386682510375977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27205991744995117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([19, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27523183822631836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27523183822631836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2754349708557129  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27705860137939453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([19, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2771601676940918  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2771601676940918  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27736330032348633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2804074287414551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([22, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2806582450866699  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2806582450866699  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28089380264282227  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28606748580932617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([24, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28646230697631836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28646230697631836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28671884536743164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29415273666381836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29442501068115234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29442501068115234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2945852279663086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3003530502319336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([10, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30059337615966797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30059337615966797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30070018768310547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30529308319091797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3055763244628906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3055763244628906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30567264556884766  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3104887008666992  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31056880950927734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31056880950927734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31060123443603516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3124380111694336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([13, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31311607360839844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31311607360839844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31325531005859375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32312679290771484  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3207101821899414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32083797454833984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3209962844848633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32111644744873047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32111644744873047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32113170623779297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32125377655029297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3212599754333496  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3212599754333496  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3212733268737793  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3214735984802246  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3214874267578125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3214874267578125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3215007781982422  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3217945098876953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32181501388549805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32181501388549805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32182836532592773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32221555709838867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32222843170166016  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32222843170166016  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3222360610961914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3225107192993164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3225131034851074  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3225131034851074  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32251501083374023  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32259702682495117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3226032257080078  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3226032257080078  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3226051330566406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32270050048828125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32262325286865234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32262420654296875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32262372970581055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32262516021728516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

pure train time  0.4531717300415039
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27206897735595703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7830512523651123
loading full batch data spends  0.0039386749267578125
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.881 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.881 GB
Metis partitioning: 0.000 seconds, peak memory: 24.881 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004906892776489258
pure dgl.metis_partition the time spent:  0.0027506351470947266
graph partitioner: local batch seeds list  [[3, 4, 10, 11, 16, 28, 32, 37, 38, 42, 43, 54, 56, 59, 61, 68, 70, 71, 79, 82, 84, 93, 94, 95, 100, 103, 104, 113, 114, 116, 123, 124, 127, 129, 134, 135], [0, 21, 27, 35, 36, 41, 48, 50, 51, 53, 65, 66, 72, 73, 76, 77, 85, 86, 89, 96, 102, 109, 115, 117, 118, 119, 120, 125, 126, 128, 130, 132, 137, 138, 139], [1, 2, 5, 7, 13, 14, 22, 25, 44, 45, 46, 47, 49, 57, 58, 60, 62, 63, 64, 74, 80, 81, 90, 91, 92, 97, 98, 101, 108, 110, 112, 121, 122, 131, 133], [6, 8, 9, 12, 15, 17, 18, 19, 20, 23, 24, 26, 29, 30, 31, 33, 34, 39, 40, 52, 55, 67, 69, 75, 78, 83, 87, 88, 99, 105, 106, 107, 111, 136]]

block_gen_time in "generate_blocks_for_one_layer_block"  0.006616115570068359


block_gen_time in "generate_blocks_for_one_layer_block"  0.00837850570678711

connection checking time:  0.007281064987182617
block generation total time  0.014994621276855469
generate_dataloader_block spend   0.03379058837890625
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2729320526123047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([7, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27800893783569336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27800893783569336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27808427810668945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.278684139251709  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([28, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2789454460144043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2789454460144043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27924489974975586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28373098373413086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([27, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2840137481689453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2840137481689453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2843027114868164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2906513214111328  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29119014739990234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29119014739990234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2915325164794922  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30144405364990234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([26, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30196714401245117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30196714401245117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3022456169128418  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31224918365478516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3126544952392578  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3126544952392578  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3128366470336914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3206520080566406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([7, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32082271575927734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32082271575927734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32089805603027344  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3246450424194336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32503461837768555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32503461837768555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32514142990112305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33122968673706055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33136892318725586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33136892318725586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33141183853149414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33415842056274414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([27, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33574914932250977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33574914932250977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33603811264038086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35652589797973633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3524456024169922  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35262203216552734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3528413772583008  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3530430793762207  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3530430793762207  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35304689407348633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35307741165161133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3530874252319336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3530874252319336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35309886932373047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3532705307006836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35328245162963867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35328245162963867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35329389572143555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3535456657409668  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35356712341308594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35356712341308594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3535804748535156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35396766662597656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35398054122924805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35398054122924805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3539881706237793  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3542628288269043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3542766571044922  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3542766571044922  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3542823791503906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35452842712402344  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35453271865844727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35453271865844727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3545346260070801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3546299934387207  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3546466827392578  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3546466827392578  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35465049743652344  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35489463806152344  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35491228103637695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35491228103637695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3549160957336426  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35518693923950195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3551959991455078  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3551959991455078  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3551979064941406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3553466796875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35535764694213867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35535764694213867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3553595542907715  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35552167892456055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3555412292480469  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3555412292480469  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3555431365966797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35582542419433594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35566282272338867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3556637763977051  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35565900802612305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35566091537475586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2720475196838379  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([9, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2761721611022949  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2761721611022949  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27626848220825195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2770390510559082  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([22, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27722597122192383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27722597122192383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27746152877807617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2809891700744629  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([24, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28125619888305664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28125619888305664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2815127372741699  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2871522903442383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2877073287963867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2877073287963867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28804969787597656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2979612350463867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2985110282897949  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2985110282897949  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.298799991607666  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3091883659362793  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([13, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3094606399536133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3094606399536133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3095998764038086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3155784606933594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3158078193664551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3158078193664551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31589365005493164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3201751708984375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3203887939453125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3203887939453125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3204536437988281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3241157531738281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32413148880004883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32413148880004883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3241429328918457  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32483673095703125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([18, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3257923126220703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3257923126220703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3259849548339844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3396482467651367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3363370895385742  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3364896774291992  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33667898178100586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3368654251098633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3368654251098633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33687496185302734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33695125579833984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3369565010070801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3369565010070801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33696603775024414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3371090888977051  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3371133804321289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3371133804321289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33711910247802734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33724498748779297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3372654914855957  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3372654914855957  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3372769355773926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33760881423950195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3376274108886719  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3376274108886719  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33763694763183594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3379802703857422  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33800458908081055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33800458908081055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3380141258239746  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3384242057800293  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3384428024291992  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3384428024291992  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33844852447509766  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3387746810913086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33878087997436523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33878087997436523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33878278732299805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33890485763549805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3389139175415039  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3389139175415039  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3389158248901367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3390512466430664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33907461166381836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33907461166381836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33907651901245117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33941221237182617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3392667770385742  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3392677307128906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3392672538757324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33926868438720703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27294111251831055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([16, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2770233154296875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2770233154296875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2771949768066406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2785639762878418  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([27, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2787666320800781  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2787666320800781  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2790555953979492  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2833843231201172  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([30, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2837204933166504  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2837204933166504  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2840409278869629  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2910904884338379  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([24, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29144287109375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29144287109375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2916994094848633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29913330078125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([20, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29953908920288086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29953908920288086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29975271224975586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30744314193725586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([19, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30794525146484375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30794525146484375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3081483840942383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31687450408935547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31714677810668945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31714677810668945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31725358963012695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32259416580200195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32262659072875977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32262659072875977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3226485252380371  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32387590408325195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3239612579345703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3239612579345703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32398319244384766  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3253612518310547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([17, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32625818252563477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32625818252563477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32644033432006836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33934450149536133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33615636825561523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3363156318664551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3365135192871094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33668088912963867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33668088912963867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33669614791870117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33681821823120117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.336822509765625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.336822509765625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3368339538574219  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.337005615234375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3370203971862793  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3370203971862793  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.337033748626709  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3373274803161621  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3373403549194336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3373403549194336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33734989166259766  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33762645721435547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33763647079467773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33763647079467773  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33764219284057617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3378481864929199  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3378572463989258  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3378572463989258  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3378610610961914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3380250930786133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3380303382873535  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3380303382873535  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33803224563598633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33812761306762695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3381357192993164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3381357192993164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3381376266479492  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3382596969604492  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33827733993530273  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33827733993530273  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33827924728393555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3385348320007324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3385581970214844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3385581970214844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3385601043701172  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3388957977294922  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3387722969055176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.338773250579834  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3387727737426758  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3387742042541504  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2719588279724121  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2751431465148926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2751431465148926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2752823829650879  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2763948440551758  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([19, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27652835845947266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27652835845947266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2767314910888672  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27977561950683594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([25, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2800745964050293  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2800745964050293  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28034162521362305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28621625900268555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([21, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2865314483642578  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2865314483642578  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2867565155029297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29326629638671875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([17, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2936077117919922  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2936077117919922  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2937898635864258  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30033302307128906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([13, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3006587028503418  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3006587028503418  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3007979393005371  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3067765235900879  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30711841583251953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30711841583251953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3072366714477539  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31311941146850586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31327390670776367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31327390670776367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3133273124694824  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31637144088745117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3163928985595703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3163928985595703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3164043426513672  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31709814071655273  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([8, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3175196647644043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3175196647644043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31760549545288086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3236851692199707  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3212437629699707  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32137060165405273  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32152795791625977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3216562271118164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3216562271118164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32166576385498047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32174205780029297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32175302505493164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32175302505493164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32176828384399414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32199716567993164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3220186233520508  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3220186233520508  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3220376968383789  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32245731353759766  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3224635124206543  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3224635124206543  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32247114181518555  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3226923942565918  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32270336151123047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32270336151123047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3227090835571289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32291507720947266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3229184150695801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3229184150695801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3229203224182129  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32300233840942383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3230152130126953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3230152130126953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32301902770996094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3232097625732422  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32321977615356445  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32321977615356445  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32322168350219727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32338380813598633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32329463958740234  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32329559326171875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32329511642456055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32329654693603516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

pure train time  0.4875619411468506
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27196788787841797  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.710403323173523
loading full batch data spends  0.003996849060058594
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.881 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.881 GB
Metis partitioning: 0.000 seconds, peak memory: 24.881 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0050771236419677734
pure dgl.metis_partition the time spent:  0.003027200698852539
graph partitioner: local batch seeds list  [[2, 12, 17, 19, 29, 30, 31, 32, 40, 41, 53, 54, 55, 57, 58, 59, 61, 65, 68, 69, 71, 73, 75, 76, 77, 81, 82, 84, 90, 98, 99, 104, 108, 111, 131], [3, 4, 5, 6, 10, 11, 22, 23, 24, 28, 35, 43, 47, 56, 62, 72, 79, 83, 85, 87, 89, 95, 100, 101, 102, 105, 106, 110, 113, 116, 119, 124, 127, 132, 133], [1, 18, 25, 33, 34, 37, 38, 39, 42, 44, 50, 51, 63, 64, 67, 70, 86, 88, 93, 94, 96, 97, 107, 112, 118, 123, 125, 126, 128, 129, 130, 134, 136, 139], [0, 7, 8, 9, 13, 14, 15, 16, 20, 21, 26, 27, 36, 45, 46, 48, 49, 52, 60, 66, 74, 78, 80, 91, 92, 103, 109, 114, 115, 117, 120, 121, 122, 135, 137, 138]]

block_gen_time in "generate_blocks_for_one_layer_block"  0.006922006607055664


block_gen_time in "generate_blocks_for_one_layer_block"  0.008531332015991211

connection checking time:  0.007544517517089844
block generation total time  0.015453338623046875
generate_dataloader_block spend   0.03535771369934082
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2729310989379883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2776174545288086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2776174545288086  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27773571014404297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27867746353149414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([21, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2788429260253906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2788429260253906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2790679931640625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28243541717529297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28273963928222656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28273963928222656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2830181121826172  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28913164138793945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([26, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2895479202270508  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2895479202270508  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2898263931274414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2978849411010742  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([26, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29843997955322266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29843997955322266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2987184524536133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30872201919555664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3090634346008301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3090634346008301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30922365188598633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3161129951477051  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3163318634033203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3163318634033203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3164176940917969  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32069921493530273  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([8, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3209981918334961  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3209981918334961  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32108402252197266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32596492767333984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3260664939880371  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3260664939880371  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3260989189147949  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32816123962402344  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([26, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3297572135925293  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3297572135925293  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3300356864929199  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.349764347076416  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3459134101867676  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34607553482055664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34627676010131836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3464627265930176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3464627265930176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34647226333618164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34654855728149414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34654998779296875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34654998779296875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3465557098388672  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34664154052734375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3466677665710449  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3466677665710449  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34668684005737305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3471064567565918  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3471088409423828  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3471088409423828  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34711456298828125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34728050231933594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3473019599914551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3473019599914551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34731149673461914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3476548194885254  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3476676940917969  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3476676940917969  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3476734161376953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3479194641113281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34792566299438477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34792566299438477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3479275703430176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3480496406555176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3480682373046875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3480682373046875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3480720520019531  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3483428955078125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34835195541381836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34835195541381836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34835386276245117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34850263595581055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3485136032104492  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3485136032104492  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34851551055908203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3486776351928711  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3486971855163574  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3486971855163574  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34869909286499023  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3489813804626465  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34883642196655273  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34883737564086914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3488326072692871  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3488345146179199  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2722196578979492  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([6, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27672433853149414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27672433853149414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27678918838500977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27730369567871094  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([21, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2774958610534668  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2774958610534668  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27772092819213867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28108835220336914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([30, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28145647048950195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28145647048950195  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28177690505981445  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28882646560668945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2893495559692383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2893495559692383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2896919250488281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2996034622192383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([24, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30007314682006836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30007314682006836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30032968521118164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3095579147338867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3100705146789551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3100705146789551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3102841377258301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3194699287414551  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.319699764251709  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.319699764251709  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.319796085357666  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3246121406555176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3248629570007324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3248629570007324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3249382972717285  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3292098045349121  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3292684555053711  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3292684555053711  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32929039001464844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33066844940185547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([19, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33226966857910156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33226966857910156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3324728012084961  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3468809127807617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34322357177734375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3433856964111328  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34358692169189453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3437924385070801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3437924385070801  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3437962532043457  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3438267707824707  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34383487701416016  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34383487701416016  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3438444137573242  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34398746490478516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34400033950805664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34400033950805664  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3440117835998535  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34426355361938477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3442850112915039  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3442850112915039  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3442983627319336  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34468555450439453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.344693660736084  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.344693660736084  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3446993827819824  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34490537643432617  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3449258804321289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3449258804321289  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34493350982666016  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3452615737915039  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34526491165161133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34526491165161133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34526681900024414  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34536218643188477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3453845977783203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3453845977783203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34539031982421875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3457164764404297  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34572267532348633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34572267532348633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34572458267211914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34584665298461914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.345855712890625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.345855712890625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3458576202392578  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3459930419921875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.346010684967041  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.346010684967041  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34601259231567383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3462681770324707  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34629154205322266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34629154205322266  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34629344940185547  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34662914276123047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34646177291870117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3464627265930176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3464622497558594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.346463680267334  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27294111251831055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([17, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27653074264526367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27653074264526367  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27671289443969727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2781672477722168  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([24, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2783327102661133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2783327102661133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27858924865722656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28243446350097656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([31, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2828030586242676  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2828030586242676  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28313493728637695  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2904233932495117  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2908768653869629  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2908768653869629  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2911868095397949  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3001694679260254  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([19, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3005218505859375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3005218505859375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30072498321533203  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3080306053161621  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([12, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30831384658813477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30831384658813477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3084425926208496  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3139615058898926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3143458366394043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3143458366394043  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31447458267211914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3208918571472168  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32091331481933594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32091331481933594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3209352493286133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3221626281738281  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([11, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3227391242980957  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3227391242980957  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3228573799133301  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3312106132507324  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32849836349487305  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32864809036254883  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32883405685424805  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32899045944213867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32899045944213867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32900381088256836  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32911062240600586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3291139602661133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3291139602661133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32912349700927734  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3292665481567383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.329282283782959  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.329282283782959  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32929563522338867  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3295893669128418  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3296060562133789  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3296060562133789  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3296175003051758  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32994937896728516  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.329958438873291  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.329958438873291  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32996416091918945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3301701545715332  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3301849365234375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3301849365234375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33019065856933594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33043670654296875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3304409980773926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3304409980773926  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3304429054260254  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.330538272857666  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3305492401123047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3305492401123047  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3305511474609375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33071327209472656  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3307366371154785  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3307366371154785  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33073854446411133  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33107423782348633  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3309597969055176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.330960750579834  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3309602737426758  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3309617042541504  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2732200622558594  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27698707580566406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27698707580566406  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2771158218383789  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27814292907714844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([30, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2783989906311035  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2783989906311035  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.278719425201416  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2835259437561035  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([20, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28368616104125977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28368616104125977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28389978408813477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28859949111938477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([25, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28902673721313477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28902673721313477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2892937660217285  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29703760147094727  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([20, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2974381446838379  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2974381446838379  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2976517677307129  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3053421974182129  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3055877685546875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3055877685546875  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3057060241699219  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31076526641845703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3110051155090332  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3110051155090332  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31109094619750977  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3153724670410156  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3155860900878906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3155860900878906  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31565093994140625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31931304931640625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.319425106048584  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.319425106048584  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3194575309753418  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3215198516845703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([16, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3223581314086914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3223581314086914  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32252979278564453  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3346748352050781  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33170032501220703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3318443298339844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33202314376831055  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33215904235839844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33215904235839844  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3321704864501953  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3322620391845703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33227968215942383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33227968215942383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3323025703430176  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33264589309692383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3326435089111328  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3326435089111328  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33264923095703125  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3327751159667969  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3327956199645996  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3327956199645996  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3328070640563965  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33313894271850586  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33315277099609375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33315277099609375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.333160400390625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33343505859375  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.333437442779541  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.333437442779541  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33343935012817383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33352136611938477  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33353424072265625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33353424072265625  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3335380554199219  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3337287902832031  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33374452590942383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33374452590942383  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33374834060668945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33399248123168945  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33389759063720703  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33389854431152344  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33389806747436523  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33389949798583984  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

pure train time  0.4678914546966553
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27323007583618164  GigaBytes
Max Memory Allocated: 0.4774031639099121  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6381680965423584
Total (block generation + training)time/epoch 0.5780319486345563
pure train time/epoch 0.4564172426859538

num_input_list  [1625, 1748, 1675, 1650, 1735, 1674, 1691, 1672, 1655, 1668]
