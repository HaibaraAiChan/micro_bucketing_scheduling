main start at this time 1697832333.0816166
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
random partition time  0.00051116943359375

block_gen_time in "generate_blocks_for_one_layer_block"  0.007834672927856445


block_gen_time in "generate_blocks_for_one_layer_block"  0.0091552734375

connection checking time:  0.006030559539794922
block generation total time  0.0091552734375
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.515625 GB
    Memory Allocated: 0.07021808624267578  GigaBytes
Max Memory Allocated: 0.07021808624267578  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.07556772232055664  GigaBytes
Max Memory Allocated: 0.07556867599487305  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.07556772232055664  GigaBytes
Max Memory Allocated: 0.07556867599487305  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.07568597793579102  GigaBytes
Max Memory Allocated: 0.07568597793579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.07662773132324219  GigaBytes
Max Memory Allocated: 0.07668685913085938  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([38, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.07697439193725586  GigaBytes
Max Memory Allocated: 0.07697582244873047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.07697439193725586  GigaBytes
Max Memory Allocated: 0.07697582244873047  GigaBytes

 h.shape torch.Size([1, 38, 1433]), torch.Size([1, 38, 1433])
----------------------------------------3
 Nvidia-smi: 1.607421875 GB
    Memory Allocated: 0.07738065719604492  GigaBytes
Max Memory Allocated: 0.07738065719604492  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.61328125 GB
    Memory Allocated: 0.08346891403198242  GigaBytes
Max Memory Allocated: 0.08387470245361328  GigaBytes

rst.shape  torch.Size([1, 38, 1433])
--------------------------m.shape torch.Size([32, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.61328125 GB
    Memory Allocated: 0.08377838134765625  GigaBytes
Max Memory Allocated: 0.08387470245361328  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.61328125 GB
    Memory Allocated: 0.08377838134765625  GigaBytes
Max Memory Allocated: 0.08387470245361328  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 1.61328125 GB
    Memory Allocated: 0.0841207504272461  GigaBytes
Max Memory Allocated: 0.0841207504272461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.623046875 GB
    Memory Allocated: 0.09163999557495117  GigaBytes
Max Memory Allocated: 0.09215259552001953  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.623046875 GB
    Memory Allocated: 0.09215211868286133  GigaBytes
Max Memory Allocated: 0.09215354919433594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.623046875 GB
    Memory Allocated: 0.09215211868286133  GigaBytes
Max Memory Allocated: 0.09215354919433594  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 1.623046875 GB
    Memory Allocated: 0.09249448776245117  GigaBytes
Max Memory Allocated: 0.09249448776245117  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.63671875 GB
    Memory Allocated: 0.10240602493286133  GigaBytes
Max Memory Allocated: 0.1030893325805664  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([31, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.63671875 GB
    Memory Allocated: 0.10306262969970703  GigaBytes
Max Memory Allocated: 0.1030893325805664  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.63671875 GB
    Memory Allocated: 0.10306262969970703  GigaBytes
Max Memory Allocated: 0.1030893325805664  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 1.63671875 GB
    Memory Allocated: 0.1033945083618164  GigaBytes
Max Memory Allocated: 0.1033945083618164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.65234375 GB
    Memory Allocated: 0.11532068252563477  GigaBytes
Max Memory Allocated: 0.11614847183227539  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.65234375 GB
    Memory Allocated: 0.11566734313964844  GigaBytes
Max Memory Allocated: 0.11614847183227539  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.65234375 GB
    Memory Allocated: 0.11566734313964844  GigaBytes
Max Memory Allocated: 0.11614847183227539  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 1.65234375 GB
    Memory Allocated: 0.11583900451660156  GigaBytes
Max Memory Allocated: 0.11614847183227539  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.65625 GB
    Memory Allocated: 0.12319469451904297  GigaBytes
Max Memory Allocated: 0.12370729446411133  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.65625 GB
    Memory Allocated: 0.12348270416259766  GigaBytes
Max Memory Allocated: 0.12370729446411133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.65625 GB
    Memory Allocated: 0.12348270416259766  GigaBytes
Max Memory Allocated: 0.12370729446411133  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 1.65625 GB
    Memory Allocated: 0.12358951568603516  GigaBytes
Max Memory Allocated: 0.12370729446411133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.66015625 GB
    Memory Allocated: 0.12893009185791016  GigaBytes
Max Memory Allocated: 0.1293039321899414  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.66015625 GB
    Memory Allocated: 0.12917566299438477  GigaBytes
Max Memory Allocated: 0.1293039321899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.66015625 GB
    Memory Allocated: 0.12917566299438477  GigaBytes
Max Memory Allocated: 0.1293039321899414  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 1.66015625 GB
    Memory Allocated: 0.12925100326538086  GigaBytes
Max Memory Allocated: 0.1293039321899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6640625 GB
    Memory Allocated: 0.13352251052856445  GigaBytes
Max Memory Allocated: 0.1338214874267578  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.6640625 GB
    Memory Allocated: 0.13358116149902344  GigaBytes
Max Memory Allocated: 0.1338214874267578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6640625 GB
    Memory Allocated: 0.13358116149902344  GigaBytes
Max Memory Allocated: 0.1338214874267578  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 1.6640625 GB
    Memory Allocated: 0.13360309600830078  GigaBytes
Max Memory Allocated: 0.1338214874267578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6640625 GB
    Memory Allocated: 0.1349811553955078  GigaBytes
Max Memory Allocated: 0.13507747650146484  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([28, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.6640625 GB
    Memory Allocated: 0.13646507263183594  GigaBytes
Max Memory Allocated: 0.13646888732910156  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6640625 GB
    Memory Allocated: 0.13646507263183594  GigaBytes
Max Memory Allocated: 0.13646888732910156  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 1.6640625 GB
    Memory Allocated: 0.1367645263671875  GigaBytes
Max Memory Allocated: 0.1367645263671875  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15799713134765625  GigaBytes
Max Memory Allocated: 0.15949201583862305  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1536717414855957  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1538691520690918  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1541142463684082  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15432977676391602  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15432977676391602  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15433740615844727  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15439844131469727  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15440654754638672  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15440654754638672  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1544179916381836  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15458965301513672  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1546015739440918  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1546015739440918  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15461301803588867  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15486478805541992  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1548786163330078  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1548786163330078  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15488815307617188  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1551647186279297  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15517473220825195  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15517473220825195  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1551804542541504  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15538644790649414  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1553955078125  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1553955078125  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15539932250976562  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1555633544921875  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15556859970092773  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15556859970092773  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15557050704956055  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15566587448120117  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15567302703857422  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15567302703857422  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15567493438720703  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.15578365325927734  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1557917594909668  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1557917594909668  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.1557936668395996  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.1559157371520996  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15593433380126953  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15593433380126953  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15593814849853516  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15620899200439453  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.1562180519104004  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.1562180519104004  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.1562199592590332  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15636873245239258  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15637969970703125  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15637969970703125  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15638160705566406  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15654373168945312  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15659093856811523  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15659093856811523  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15659475326538086  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15726613998413086  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.1570897102355957  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.1570906639099121  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.1570911407470703  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.6875 GB
    Memory Allocated: 0.15709304809570312  GigaBytes
Max Memory Allocated: 0.1611618995666504  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1366405487060547  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

--------------------------m.shape torch.Size([9, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.14005422592163086  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.14005422592163086  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1401505470275879  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.14092111587524414  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.14111852645874023  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.14111852645874023  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.14136457443237305  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1450495719909668  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([19, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1452312469482422  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1452312469482422  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.14543437957763672  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.14989900588989258  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([24, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.15031003952026367  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.15031003952026367  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.15056657791137695  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.15800046920776367  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.15827274322509766  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.15827274322509766  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1584329605102539  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1642007827758789  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([14, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.16456937789916992  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.16456937789916992  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1647191047668457  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.17114877700805664  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1713728904724121  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1713728904724121  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.17145872116088867  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.17574024200439453  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1758255958557129  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1758255958557129  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1758580207824707  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.17769479751586914  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.17772674560546875  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.17772674560546875  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.17773818969726562  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.17843198776245117  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([17, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.17933416366577148  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.17933416366577148  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.17951631546020508  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19242048263549805  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1896805763244629  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.18980741500854492  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.18996477127075195  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19008779525756836  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19008779525756836  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1900954246520996  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1901564598083496  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19017410278320312  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19017410278320312  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19019508361816406  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19050979614257812  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1905198097229004  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1905198097229004  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19053316116333008  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1908268928527832  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19084739685058594  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19084739685058594  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19086074829101562  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19124794006347656  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19125127792358398  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19125127792358398  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1912550926208496  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.1913924217224121  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19140243530273438  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19140243530273438  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19140625  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19157028198242188  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19158220291137695  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19158220291137695  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19158601760864258  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19177675247192383  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19169187545776367  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19169282913208008  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19169235229492188  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.82421875 GB
    Memory Allocated: 0.19169378280639648  GigaBytes
Max Memory Allocated: 0.2788810729980469  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.13780736923217773  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.14335393905639648  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.14335393905639648  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.14348268508911133  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.14450979232788086  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([13, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.14458465576171875  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.14458465576171875  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.14472389221191406  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.14680957794189453  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([23, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.1471085548400879  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.1471085548400879  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.1473546028137207  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.15275907516479492  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([35, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.15338373184204102  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.15338373184204102  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.15375757217407227  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.16459894180297852  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([29, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.16518640518188477  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.16518640518188477  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.1654963493347168  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.17664718627929688  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.17713308334350586  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.17713308334350586  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.17734670639038086  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.18653249740600586  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([13, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.18691158294677734  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.18691158294677734  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.18705081939697266  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.19400262832641602  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.19436025619506836  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.19436025619506836  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.19446706771850586  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.20055532455444336  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.20055007934570312  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.20055007934570312  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.2005615234375  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.20125532150268555  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([33, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.20301151275634766  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.20301151275634766  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 1.88671875 GB
    Memory Allocated: 0.20336437225341797  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22838878631591797  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22465848922729492  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2248387336730957  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22506284713745117  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

--------------------------m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22523880004882812  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22523880004882812  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2252521514892578  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2253589630126953  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2253584861755371  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2253584861755371  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22536420822143555  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2254500389099121  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22545623779296875  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22545623779296875  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2254619598388672  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2255878448486328  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22560834884643555  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22560834884643555  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22561979293823242  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2259516716003418  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2259845733642578  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2259845733642578  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2259998321533203  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2265491485595703  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22655916213989258  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22655916213989258  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22656488418579102  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22681093215942383  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22681522369384766  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22681522369384766  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22681713104248047  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2269124984741211  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2269272804260254  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2269272804260254  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22693109512329102  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22714853286743164  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2271566390991211  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2271566390991211  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2271585464477539  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2272939682006836  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22731351852416992  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22731351852416992  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22731542587280273  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22759771347045898  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.2274646759033203  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22746562957763672  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22746515274047852  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.888671875 GB
    Memory Allocated: 0.22746658325195312  GigaBytes
Max Memory Allocated: 0.31192445755004883  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.13718891143798828  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.1416616439819336  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.1416616439819336  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.1418008804321289  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.1429133415222168  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.14308929443359375  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.14308929443359375  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.14333534240722656  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.1470203399658203  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([35, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.14745807647705078  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.14745807647705078  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.14783191680908203  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.15605640411376953  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([28, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.15646743774414062  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.15646743774414062  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.1567668914794922  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.16543960571289062  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([21, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.16585063934326172  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.16585063934326172  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.1660757064819336  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.17415666580200195  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.17468500137329102  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.17468500137329102  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.17489862442016602  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.18408441543579102  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.1842021942138672  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.1842021942138672  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.1842670440673828  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.18747949600219727  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.18761825561523438  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.18761825561523438  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.18766117095947266  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.1901073455810547  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.19032621383666992  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.19032621383666992  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.19037961959838867  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.19379758834838867  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([20, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.19577836990356445  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.19577836990356445  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.19599199295043945  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.21115922927856445  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20759296417236328  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20775985717773438  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20796728134155273  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20813512802124023  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20813512802124023  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2081446647644043  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2082209587097168  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20822620391845703  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20822620391845703  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2082357406616211  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20837879180908203  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2084031105041504  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2084031105041504  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20842218399047852  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20884180068969727  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2088479995727539  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2088479995727539  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20885562896728516  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2090768814086914  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20908308029174805  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20908308029174805  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20908689498901367  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20922422409057617  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2092456817626953  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2092456817626953  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20925331115722656  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2095813751220703  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20960378646850586  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20960378646850586  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2096095085144043  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2099757194519043  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20998477935791016  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20998477935791016  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.20998668670654297  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.21014881134033203  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.21016645431518555  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.21016645431518555  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.21016836166381836  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.21042394638061523  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2102971076965332  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2102980613708496  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.2102975845336914  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.892578125 GB
    Memory Allocated: 0.21029901504516602  GigaBytes
Max Memory Allocated: 0.3446187973022461  GigaBytes

pure train time  0.9370489120483398
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.27234315872192383  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9435241222381592
random partition time  0.00014638900756835938

block_gen_time in "generate_blocks_for_one_layer_block"  0.007721662521362305


block_gen_time in "generate_blocks_for_one_layer_block"  0.009285926818847656

connection checking time:  0.00590205192565918
block generation total time  0.009285926818847656
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.27231264114379883  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

--------------------------m.shape torch.Size([15, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.27704668045043945  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.27704668045043945  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.2772068977355957  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.2784886360168457  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([21, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.27863311767578125  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.27863311767578125  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.2788581848144531  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.2822256088256836  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([34, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.2826576232910156  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.2826576232910156  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.2830209732055664  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.29101037979125977  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.29151201248168945  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.29151201248168945  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.2918543815612793  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.30176591873168945  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([21, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3021554946899414  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3021554946899414  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3023805618286133  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.31046152114868164  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([18, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3109259605407715  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3109259605407715  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.31111860275268555  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3193936347961426  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([5, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.31948423385620117  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.31948423385620117  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3195376396179199  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3222079277038574  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3224802017211914  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3224802017211914  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3225555419921875  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3268270492553711  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3269820213317871  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3269820213317871  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3270249366760254  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3297715187072754  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([24, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.33103132247924805  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.33103132247924805  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.33128786087036133  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3494877815246582  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34568071365356445  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.345853328704834  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3460679054260254  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34624719619750977  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34624719619750977  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34625864028930664  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34635019302368164  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34635448455810547  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34635448455810547  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34636402130126953  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34650707244873047  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34651994705200195  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34651994705200195  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34653139114379883  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3467831611633301  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3468046188354492  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3468046188354492  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3468179702758789  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34720516204833984  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3472132682800293  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3472132682800293  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34721899032592773  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3474249839782715  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34743404388427734  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34743404388427734  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34743785858154297  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34760189056396484  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3476071357727051  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3476071357727051  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3476090431213379  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3477044105529785  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3477191925048828  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3477191925048828  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34772300720214844  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34794044494628906  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3479475975036621  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3479475975036621  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3479495048522949  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3480715751647949  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34808921813964844  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34808921813964844  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34809112548828125  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3483467102050781  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34836626052856445  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34836626052856445  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34836816787719727  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3486504554748535  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.348513126373291  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.3485140800476074  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.34850645065307617  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.986328125 GB
    Memory Allocated: 0.348508358001709  GigaBytes
Max Memory Allocated: 0.36609315872192383  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2724146842956543  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

--------------------------m.shape torch.Size([9, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2772393226623535  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2772393226623535  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.27733564376831055  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2781062126159668  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([30, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2783784866333008  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2783784866333008  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2786989212036133  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2835054397583008  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([27, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.28377771377563477  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.28377771377563477  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.28406667709350586  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.29041528701782227  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2908902168273926  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2908902168273926  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2912001609802246  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3001828193664551  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([25, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.30069541931152344  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.30069541931152344  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3009624481201172  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3105754852294922  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([18, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3110189437866211  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3110189437866211  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.31121158599853516  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3194866180419922  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.31961488723754883  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.31961488723754883  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.31967973709106445  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3228921890258789  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.323030948638916  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.323030948638916  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3230738639831543  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.32552003860473633  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.32564306259155273  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.32564306259155273  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.32567548751831055  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.32773780822753906  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([29, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3292698860168457  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3292698860168457  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.32957983016967773  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.35157155990600586  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3476104736328125  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3477821350097656  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3479952812194824  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34816741943359375  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34816741943359375  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3481769561767578  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3482532501220703  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3482661247253418  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3482661247253418  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3482832908630371  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3485407829284668  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3485441207885742  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3485441207885742  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34855175018310547  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34871959686279297  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3487238883972168  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3487238883972168  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3487277030944824  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34883832931518555  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34885597229003906  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34885597229003906  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3488636016845703  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3491382598876953  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34915781021118164  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34915781021118164  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3491654396057129  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34949350357055664  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34949684143066406  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34949684143066406  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3494987487792969  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3495941162109375  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34960126876831055  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34960126876831055  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34960317611694336  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34971189498901367  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3497285842895508  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3497285842895508  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3497323989868164  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3499765396118164  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34998464584350586  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34998464584350586  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34998655319213867  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.35012197494506836  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3501319885253906  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3501319885253906  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.35013389587402344  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3502826690673828  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3502936363220215  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3502936363220215  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3502955436706543  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.35045766830444336  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3503265380859375  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3503274917602539  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3503270149230957  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3503284454345703  GigaBytes
Max Memory Allocated: 0.46680545806884766  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2729191780090332  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.27846622467041016  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.27846622467041016  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.278594970703125  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.27962207794189453  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([21, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2797822952270508  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2797822952270508  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.28000736236572266  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2833747863769531  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2836790084838867  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2836790084838867  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.28395748138427734  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2900710105895996  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([37, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2907218933105469  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.2907218933105469  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.29111766815185547  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3025779724121094  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3031010627746582  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3031010627746582  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3033900260925293  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3137784004211426  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([21, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.31430673599243164  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.31430673599243164  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3145318031311035  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.32418394088745117  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([15, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3246321678161621  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3246321678161621  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.32479238510131836  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.33280324935913086  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.333193302154541  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.333193302154541  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3333115577697754  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34001779556274414  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.340054988861084  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.340054988861084  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34007692337036133  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.34145498275756836  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([27, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3429131507873535  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3429131507873535  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3432021141052246  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3636898994445801  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3591341972351074  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.35932397842407227  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3595595359802246  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3597531318664551  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3597531318664551  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.35976457595825195  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.35985612869262695  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3598604202270508  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3598604202270508  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.35986995697021484  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3600130081176758  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36002588272094727  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36002588272094727  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36003732681274414  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3602890968322754  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36031055450439453  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36031055450439453  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3603239059448242  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36071109771728516  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36072397232055664  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36072397232055664  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3607316017150879  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3610062599182129  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3610086441040039  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3610086441040039  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3610105514526367  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36109256744384766  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3610987663269043  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3610987663269043  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3611006736755371  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36119604110717773  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3612041473388672  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3612041473388672  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3612060546875  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.361328125  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36133718490600586  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36133718490600586  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36133909225463867  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36147451400756836  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36148548126220703  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36148548126220703  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36148738861083984  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.3616495132446289  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.361696720123291  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.361696720123291  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36170053482055664  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36237192153930664  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36221933364868164  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36222028732299805  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36221981048583984  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.017578125 GB
    Memory Allocated: 0.36222124099731445  GigaBytes
Max Memory Allocated: 0.46813297271728516  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27191591262817383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([10, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27566003799438477  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27566003799438477  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27576684951782227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27662134170532227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([26, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27684593200683594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27684593200683594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27712440490722656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2812929153442383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([28, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2816023826599121  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2816023826599121  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28190183639526367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2884812355041504  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([20, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2887587547302246  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2887587547302246  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2889723777770996  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2951674461364746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([23, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29567480087280273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29567480087280273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29592084884643555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3047642707824707  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([12, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3050260543823242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3050260543823242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30515480041503906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31067371368408203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31098318099975586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31098318099975586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31108999252319336  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31643056869506836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31650543212890625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31650543212890625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31653785705566406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3183746337890625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([18, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3193197250366211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3193197250366211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31951236724853516  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3331756591796875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.330197811126709  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3303408622741699  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3305182456970215  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3306608200073242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3306608200073242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33066654205322266  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33071231842041016  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.330721378326416  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.330721378326416  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3307328224182129  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.330904483795166  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33092784881591797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33092784881591797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3309469223022461  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33136653900146484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33138036727905273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33138036727905273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3313918113708496  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.331723690032959  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3317375183105469  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3317375183105469  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3317451477050781  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3320198059082031  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33203935623168945  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33203935623168945  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3320469856262207  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33237504959106445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3323783874511719  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3323783874511719  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3323802947998047  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3324756622314453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33248472213745117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33248472213745117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.332486629486084  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33262205123901367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3325185775756836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33251953125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3325190544128418  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3325204849243164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

pure train time  0.538189172744751
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2719278335571289  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9207661151885986
random partition time  0.00026297569274902344

block_gen_time in "generate_blocks_for_one_layer_block"  0.008683443069458008


block_gen_time in "generate_blocks_for_one_layer_block"  0.009165525436401367

connection checking time:  0.006159305572509766
block generation total time  0.009165525436401367
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2723712921142578  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([8, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27708959579467773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27708959579467773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2771754264831543  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2778606414794922  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([20, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2780313491821289  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2780313491821289  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2782449722290039  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2814493179321289  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([35, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2819032669067383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2819032669067383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28227710723876953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29050159454345703  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2909979820251465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2909979820251465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29134035110473633  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3012518882751465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([28, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30182838439941406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30182838439941406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3021278381347656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3128938674926758  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([18, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3133211135864258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3133211135864258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31351375579833984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3217887878417969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32202911376953125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32202911376953125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3221254348754883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32694149017333984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32706451416015625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32706451416015625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32710742950439453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32955360412597656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32967662811279297  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32967662811279297  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3297090530395508  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3317713737487793  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([22, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3337254524230957  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3337254524230957  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33396100997924805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35065698623657227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34682798385620117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3469986915588379  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3472108840942383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34738779067993164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34738779067993164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3473954200744629  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3474564552307129  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3474588394165039  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3474588394165039  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34746456146240234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3475503921508789  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3475651741027832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3475651741027832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3475766181945801  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34782838821411133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34784984588623047  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34784984588623047  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34786319732666016  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3482503890991211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34827280044555664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34827280044555664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3482842445373535  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.348696231842041  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34871387481689453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34871387481689453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3487215042114258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34904956817626953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3490595817565918  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3490595817565918  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3490633964538574  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34925413131713867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3492612838745117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3492612838745117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34926319122314453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34938526153564453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3493943214416504  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3493943214416504  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3493962287902832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3495316505432129  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3495492935180664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3495492935180664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3495512008666992  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3498067855834961  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3496699333190918  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3496708869934082  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34966325759887695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34966516494750977  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2722153663635254  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([14, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27632904052734375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27632904052734375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27647876739501953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27767515182495117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([30, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2779207229614258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2779207229614258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2782411575317383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2830476760864258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([15, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2831277847290039  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2831277847290039  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28328800201416016  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28681278228759766  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([26, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28728818893432617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28728818893432617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2875666618347168  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2956252098083496  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2958865165710449  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2958865165710449  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29604673385620117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30181455612182617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3022470474243164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3022470474243164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30241870880126953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30977439880371094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31010007858276367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31010007858276367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31021833419799805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31610107421875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31621313095092773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31621313095092773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.316256046295166  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31870222091674805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3187289237976074  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3187289237976074  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3187403678894043  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31943416595458984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([24, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3207097053527832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3207097053527832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3209662437438965  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33916616439819336  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33583974838256836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33598852157592773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33617305755615234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33631086349487305  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33631086349487305  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33632612228393555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33644819259643555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3364601135253906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3364601135253906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33647918701171875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3367652893066406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3367648124694824  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3367648124694824  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33677053451538086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3368964195251465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3369283676147461  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3369283676147461  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3369455337524414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33744335174560547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3374447822570801  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3374447822570801  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3374485969543457  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3375859260559082  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33759117126464844  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33759117126464844  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33759307861328125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3376884460449219  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33769750595092773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33769750595092773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33769941329956055  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33783483505249023  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33785438537597656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33785438537597656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3378562927246094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3381385803222656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3380436897277832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3380446434020996  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3380441665649414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.338045597076416  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27263355255126953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27774763107299805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27774763107299805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2778763771057129  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2789034843444824  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([16, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2790102958679199  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2790102958679199  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27918195724487305  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28174829483032227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([25, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28206300735473633  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28206300735473633  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2823300361633301  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2882046699523926  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2887544631958008  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2887544631958008  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2890968322753906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2990083694458008  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([29, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29961156845092773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29961156845092773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29992151260375977  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31107234954833984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31155824661254883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31155824661254883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31177186965942383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32095766067504883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32118749618530273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32118749618530273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32128381729125977  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32609987258911133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3265218734741211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3265218734741211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32664012908935547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3333463668823242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33338356018066406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33338356018066406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3334054946899414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33478355407714844  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([26, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33616065979003906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33616065979003906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3364391326904297  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3561677932739258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3519597053527832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35213327407836914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35234880447387695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35252857208251953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35252857208251953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3525381088256836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3526144027709961  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35262155532836914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35262155532836914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.352632999420166  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35280466079711914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35281944274902344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35281944274902344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3528327941894531  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35312652587890625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3531317710876465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3531317710876465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3531374931335449  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3533034324645996  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35332489013671875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35332489013671875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3533344268798828  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35367774963378906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.353696346282959  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.353696346282959  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35370397567749023  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.354032039642334  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3540458679199219  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3540458679199219  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3540496826171875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3542938232421875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35430192947387695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35430192947387695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35430383682250977  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35443925857543945  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3544502258300781  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3544502258300781  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35445213317871094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3546142578125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35463762283325195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35463762283325195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35463953018188477  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35497522354125977  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35483646392822266  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35483741760253906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35483694076538086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35483837127685547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2724752426147461  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2773551940917969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2773551940917969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2774839401245117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27851104736328125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([31, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.278778076171875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.278778076171875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2791099548339844  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28407955169677734  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([40, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28455448150634766  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28455448150634766  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 40, 1433]), torch.Size([1, 40, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28498172760009766  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29438114166259766  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 40, 1433])
--------------------------m.shape torch.Size([26, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2947230339050293  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2947230339050293  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2950015068054199  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30306005477905273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([26, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30361509323120117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30361509323120117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3038935661315918  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31389713287353516  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3142704963684082  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3142704963684082  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31444215774536133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32179784774780273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3220486640930176  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3220486640930176  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3221449851989746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32696104049682617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3272976875305176  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3272976875305176  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3273940086364746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3328843116760254  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3329324722290039  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3329324722290039  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33295440673828125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3343324661254883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([22, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3354959487915039  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3354959487915039  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33573150634765625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35242748260498047  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34929943084716797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3494834899902344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34971189498901367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3499011993408203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3499011993408203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34990692138671875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34995269775390625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3499617576599121  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3499617576599121  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.349973201751709  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3501448631286621  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35016822814941406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35016822814941406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3501873016357422  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35060691833496094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35060930252075195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35060930252075195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3506150245666504  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3507809638977051  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3507881164550781  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3507881164550781  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35079193115234375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35092926025390625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35094499588012695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35094499588012695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3509507179260254  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3511967658996582  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35120105743408203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35120105743408203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35120296478271484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35129833221435547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.351320743560791  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.351320743560791  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35132646560668945  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3516526222229004  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35165882110595703  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35165882110595703  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35166072845458984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35178279876708984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517928123474121  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517928123474121  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517947196960449  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3519434928894043  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35195446014404297  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35195446014404297  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3519563674926758  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35211849212646484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3521418571472168  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3521418571472168  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3521437644958496  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3524794578552246  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3523292541503906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35233020782470703  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35232973098754883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35233116149902344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

pure train time  0.5244266986846924
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.272489070892334  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8938000202178955
loading full batch data spends  0.00506901741027832
random partition time  0.00017452239990234375

block_gen_time in "generate_blocks_for_one_layer_block"  0.008099555969238281


block_gen_time in "generate_blocks_for_one_layer_block"  0.00899505615234375

connection checking time:  0.0061037540435791016
block generation total time  0.00899505615234375
generate_dataloader_block spend   0.028720855712890625
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27265501022338867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([8, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27789783477783203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27789783477783203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2779836654663086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2786688804626465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([31, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2789573669433594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2789573669433594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27928924560546875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2842588424682617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([27, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28452539443969727  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28452539443969727  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28481435775756836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29116296768188477  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([38, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29183006286621094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29183006286621094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 38, 1433]), torch.Size([1, 38, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.292236328125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30400657653808594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 38, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30452442169189453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30452442169189453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3048133850097656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3152017593383789  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([19, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31566619873046875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31566619873046875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3158693313598633  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32459545135498047  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3249053955078125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3249053955078125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3250236511230469  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33090639114379883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([8, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3311891555786133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3311891555786133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33127498626708984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33615589141845703  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3363056182861328  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3363056182861328  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3363485336303711  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3390951156616211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([24, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34082555770874023  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34082555770874023  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3410820960998535  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3592820167541504  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35501575469970703  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35520362854003906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3554368019104004  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35562849044799805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35562849044799805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35563039779663086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35564565658569336  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35565853118896484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35565853118896484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35567188262939453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35587215423583984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3558831214904785  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3558831214904785  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3558945655822754  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35614633560180664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35616016387939453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35616016387939453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3561697006225586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3564462661743164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3564753532409668  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3564753532409668  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3564887046813965  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35696935653686523  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35697460174560547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35697460174560547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3569784164428711  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35714244842529297  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35715436935424805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35715436935424805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35715818405151367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3573489189147949  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3573646545410156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3573646545410156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35736846923828125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35761260986328125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3576207160949707  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3576207160949707  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3576226234436035  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3577580451965332  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3577690124511719  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3577690124511719  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3577709197998047  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35793304443359375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3579564094543457  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3579564094543457  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3579583168029785  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3582940101623535  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3581395149230957  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3581404685974121  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35813283920288086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35813474655151367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27233266830444336  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([10, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2766609191894531  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2766609191894531  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2767677307128906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2776222229003906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([16, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2777400016784668  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2777400016784668  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2779116630554199  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28047800064086914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([30, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28087282180786133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28087282180786133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28119325637817383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28824281692504883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([23, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2885737419128418  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2885737419128418  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2888197898864746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2959437370300293  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([14, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29619455337524414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29619455337524414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2963442802429199  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.301727294921875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30213308334350586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30213308334350586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3022933006286621  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30918264389038086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([7, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30936431884765625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30936431884765625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30943965911865234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3131866455078125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.313234806060791  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.313234806060791  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31325674057006836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3144841194152832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31456947326660156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31456947326660156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3145914077758789  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31596946716308594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([27, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3173999786376953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3173999786376953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3176889419555664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3381767272949219  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33454465866088867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.334683895111084  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3348565101623535  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.334989070892334  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.334989070892334  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33500051498413086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33509206771850586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3350982666015625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3350982666015625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3351097106933594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3352813720703125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33530473709106445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33530473709106445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3353238105773926  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33574342727661133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3357572555541992  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3357572555541992  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3357686996459961  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33610057830810547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.336118221282959  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.336118221282959  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33612585067749023  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.336453914642334  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33646392822265625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33646392822265625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3364677429199219  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3366584777832031  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33666563034057617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33666563034057617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.336667537689209  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.336789608001709  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.336698055267334  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3366990089416504  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3366985321044922  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3366999626159668  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2722749710083008  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([17, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27683305740356445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27683305740356445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27701520919799805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2784695625305176  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([22, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2786135673522949  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2786135673522949  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27884912490844727  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.282376766204834  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([29, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28272342681884766  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28272342681884766  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2830333709716797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28984785079956055  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([30, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29033374786376953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29033374786376953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29065418243408203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29994678497314453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3005075454711914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3005075454711914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3007965087890625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3111848831176758  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3115530014038086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3115530014038086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3117246627807617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3190803527832031  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3193683624267578  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3193683624267578  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3194751739501953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3248157501220703  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([8, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3251042366027832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3251042366027832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32519006729125977  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33007097244262695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3300762176513672  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3300762176513672  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33008766174316406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3307814598083496  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([19, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33180809020996094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33180809020996094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33201122283935547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3464193344116211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34281444549560547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3429851531982422  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3431973457336426  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3433651924133301  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3433651924133301  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3433823585510254  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3435196876525879  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3435211181640625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3435211181640625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34353065490722656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3436737060546875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34368085861206055  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34368085861206055  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3436884880065918  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3438563346862793  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3438720703125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3438720703125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34388160705566406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3441581726074219  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34417295455932617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34417295455932617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3441805839538574  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3444552421569824  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34447479248046875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34447479248046875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.344482421875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34481048583984375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.344815731048584  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.344815731048584  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3448176383972168  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3449397087097168  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3449583053588867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3449583053588867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34496212005615234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3452329635620117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34525537490844727  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34525537490844727  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3452572822570801  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3455929756164551  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34546995162963867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3454709053039551  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3454704284667969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3454718589782715  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27280616760253906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2781987190246582  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2781987190246582  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2783169746398926  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27925872802734375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([29, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2795095443725586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2795095443725586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2798194885253906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2844657897949219  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([29, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2847752571105957  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2847752571105957  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28508520126342773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2918996810913086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([26, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2923002243041992  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2923002243041992  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29257869720458984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30063724517822266  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([29, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3012723922729492  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3012723922729492  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30158233642578125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31273317337036133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([22, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31328296661376953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31328296661376953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3135185241699219  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32363033294677734  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32392406463623047  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32392406463623047  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32404232025146484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3299250602722168  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33025074005126953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33025074005126953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33034706115722656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33583736419677734  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33588552474975586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33588552474975586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3359074592590332  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33728551864624023  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([29, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33889293670654297  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33889293670654297  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.339202880859375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3611946105957031  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3567681312561035  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35695600509643555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3571891784667969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3573780059814453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3573780059814453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35738563537597656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35744667053222656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35745668411254883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35745668411254883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3574700355529785  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35767030715942383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3576812744140625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3576812744140625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3576927185058594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3579444885253906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35796213150024414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35796213150024414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.357973575592041  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3583054542541504  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3583192825317383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3583192825317383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35832691192626953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35860157012939453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35860395431518555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35860395431518555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35860586166381836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3586878776550293  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35871028900146484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35871028900146484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3587160110473633  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3590421676635742  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35905027389526367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35905027389526367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3590521812438965  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35920095443725586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35921192169189453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35921192169189453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35921382904052734  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3593759536743164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3593935966491699  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3593935966491699  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35939550399780273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3596510887145996  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35967063903808594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35967063903808594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35967254638671875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.359954833984375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3598060607910156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35980701446533203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35980653762817383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35980796813964844  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

pure train time  0.5018265247344971
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27281999588012695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8749650716781616
loading full batch data spends  0.0055217742919921875
random partition time  0.00017023086547851562

block_gen_time in "generate_blocks_for_one_layer_block"  0.007566213607788086


block_gen_time in "generate_blocks_for_one_layer_block"  0.008939027786254883

connection checking time:  0.006689548492431641
block generation total time  0.008939027786254883
generate_dataloader_block spend   0.028655052185058594
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27204036712646484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2766685485839844  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2766685485839844  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27678680419921875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2777285575866699  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2779364585876465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2779364585876465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27820348739624023  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2822089195251465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([27, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28250789642333984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28250789642333984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28279685974121094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28914546966552734  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2896842956542969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2896842956542969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2900266647338867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2999382019042969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([29, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30054140090942383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30054140090942383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30085134506225586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31200218200683594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31232786178588867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31232786178588867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3124880790710449  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31937742233276367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([13, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31978321075439453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31978321075439453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31992244720458984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3268742561340332  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32706117630004883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32706117630004883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32712602615356445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33078813552856445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33080387115478516  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33080387115478516  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33081531524658203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3315091133117676  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([19, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3325357437133789  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3325357437133789  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33273887634277344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34714698791503906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34343481063842773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34360456466674805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34381532669067383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34400415420532227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34400415420532227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34401369094848633  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34408998489379883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34409141540527344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34409141540527344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3440971374511719  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34418296813964844  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3441920280456543  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3441920280456543  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34419965744018555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34436750411987305  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3443946838378906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3443946838378906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3444099426269531  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3448524475097656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3448786735534668  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3448786735534668  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3448920249938965  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34537267684936523  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34537792205810547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34537792205810547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3453817367553711  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34554576873779297  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3455510139465332  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3455510139465332  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.345552921295166  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34564828872680664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34566307067871094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34566307067871094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34566688537597656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3458843231201172  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34589242935180664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34589242935180664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34589433670043945  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34602975845336914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3460407257080078  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3460407257080078  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3460426330566406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3462047576904297  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34622812271118164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34622812271118164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34623003005981445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34656572341918945  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3464179039001465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3464188575744629  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34641122817993164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34641313552856445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2721691131591797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2763857841491699  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2763857841491699  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2765040397644043  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27744579315185547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([20, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2776002883911133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2776002883911133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2778139114379883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2810182571411133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([24, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2812962532043457  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2812962532043457  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.281552791595459  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28719234466552734  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28768348693847656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28768348693847656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2879934310913086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29697608947753906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([20, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29735517501831055  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29735517501831055  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29756879806518555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30525922775268555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.305696964263916  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.305696964263916  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3058791160583496  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31369447708129883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3139772415161133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3139772415161133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3140840530395508  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3194246292114258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3196702003479004  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3196702003479004  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3197455406188965  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3240170478820801  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3241238594055176  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3241238594055176  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3241562843322754  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3262186050415039  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([18, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3271636962890625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3271636962890625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32735633850097656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3410196304321289  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33762407302856445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33777570724487305  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3379640579223633  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3381161689758301  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3381161689758301  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33812761306762695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33821916580200195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3382291793823242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3382291793823242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3382444381713867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3384733200073242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3384833335876465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3384833335876465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33849477767944336  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3387465476989746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3387565612792969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3387565612792969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3387641906738281  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3389854431152344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33899641036987305  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33899641036987305  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3390021324157715  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33920812606811523  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33922290802001953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33922290802001953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33922863006591797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3394746780395508  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33948564529418945  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33948564529418945  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3394894599914551  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33968019485473633  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3396873474121094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3396873474121094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3396892547607422  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3398113250732422  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33982038497924805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33982038497924805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33982229232788086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33995771408081055  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3399686813354492  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3399686813354492  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33997058868408203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3401327133178711  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34002256393432617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3400235176086426  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3400230407714844  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.340024471282959  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27263641357421875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([14, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27765989303588867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27765989303588867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27780961990356445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2790060043334961  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27919816970825195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27919816970825195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2794651985168457  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28347063064575195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([35, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28389787673950195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28389787673950195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2842717170715332  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2924962043762207  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29292869567871094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29292869567871094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29323863983154297  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30222129821777344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([25, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3027338981628418  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3027338981628418  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30300092697143555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31261396408081055  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([14, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3129291534423828  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3129291534423828  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3130788803100586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31950855255126953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.319732666015625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.319732666015625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31981849670410156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3241000175476074  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3243560791015625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3243560791015625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3244314193725586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3287029266357422  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3288578987121582  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3288578987121582  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3289008140563965  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3316473960876465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([28, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33362865447998047  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33362865447998047  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33392810821533203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3551607131958008  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.351104736328125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3512849807739258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35150909423828125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35168027877807617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35168027877807617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3516879081726074  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517489433288574  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517627716064453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517627716064453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517799377441406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3520374298095703  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35205793380737305  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35205793380737305  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35207700729370117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3524966239929199  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35249900817871094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35249900817871094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3525047302246094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35267066955566406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35268259048461914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35268259048461914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3526883125305176  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35289430618286133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35289764404296875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35289764404296875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35289955139160156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3529815673828125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35298776626586914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35298776626586914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35298967361450195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3530850410461426  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3531017303466797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3531017303466797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3531055450439453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3533496856689453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35336828231811523  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35336828231811523  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35337018966674805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3536524772644043  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35367584228515625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35367584228515625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35367774963378906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35401344299316406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3538823127746582  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3538832664489746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3538827896118164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.353884220123291  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2724771499633789  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([10, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2771897315979004  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2771897315979004  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2772965431213379  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2781510353088379  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([30, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27841806411743164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27841806411743164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27873849868774414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28354501724243164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([27, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2838172912597656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2838172912597656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2841062545776367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2904548645019531  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29092979431152344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29092979431152344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29123973846435547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30022239685058594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([23, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30068159103393555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30068159103393555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30092763900756836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3097710609436035  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([22, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31035280227661133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31035280227661133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31058835983276367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32070016860961914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32073211669921875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32073211669921875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32077503204345703  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3229207992553711  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32315587997436523  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32315587997436523  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32322072982788086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32688283920288086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3269467353820801  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3269467353820801  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3269686698913574  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32834672927856445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([26, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3297238349914551  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3297238349914551  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3300023078918457  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3497309684753418  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34589624404907227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.346066951751709  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3462791442871094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3464546203613281  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3464546203613281  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3464641571044922  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3465404510498047  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3465456962585449  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3465456962585449  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.346555233001709  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3466982841491699  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3467111587524414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3467111587524414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3467226028442383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34697437286376953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34699583053588867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34699583053588867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34700918197631836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3473963737487793  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3473997116088867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3473997116088867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34740352630615234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34754085540771484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3475680351257324  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3475680351257324  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3475775718688965  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34798765182495117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3479909896850586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3479909896850586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3479928970336914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3481016159057617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34810972213745117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34810972213745117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.348111629486084  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.348233699798584  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34824275970458984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34824275970458984  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34824466705322266  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34838008880615234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3483901023864746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3483901023864746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3483920097351074  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3485407829284668  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3485584259033203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3485584259033203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3485603332519531  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34881591796875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3486814498901367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3486824035644531  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3486819267272949  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.34868335723876953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

pure train time  0.5450961589813232
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2724900245666504  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.846999168395996
loading full batch data spends  0.005361080169677734
random partition time  0.0001728534698486328

block_gen_time in "generate_blocks_for_one_layer_block"  0.0072743892669677734


block_gen_time in "generate_blocks_for_one_layer_block"  0.009047985076904297

connection checking time:  0.006045103073120117
block generation total time  0.009047985076904297
generate_dataloader_block spend   0.02782750129699707
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2719860076904297  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27583837509155273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27583837509155273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2759671211242676  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2769942283630371  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([28, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27722883224487305  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27722883224487305  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2775282859802246  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2820143699645996  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([27, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28229713439941406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28229713439941406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28258609771728516  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28893470764160156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([27, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2893671989440918  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2893671989440918  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2896561622619629  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29802465438842773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([21, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29844093322753906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29844093322753906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29866600036621094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3067469596862793  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([13, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3070511817932129  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3070511817932129  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3071904182434082  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.313169002532959  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3132491111755371  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3132491111755371  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3132920265197754  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31543779373168945  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3156728744506836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3156728744506836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3157377243041992  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3193998336791992  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3194155693054199  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3194155693054199  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3194270133972168  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32012081146240234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([18, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3210763931274414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3210763931274414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32126903533935547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3349323272705078  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3318929672241211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3320426940917969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3322286605834961  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33237743377685547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33237743377685547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33238887786865234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33248043060302734  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3324885368347168  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3324885368347168  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3325018882751465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3327021598815918  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3327188491821289  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3327188491821289  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3327341079711914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3330698013305664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3330817222595215  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3330817222595215  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33309125900268555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33336782455444336  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33336830139160156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33336830139160156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3333702087402344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3334388732910156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33345556259155273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33345556259155273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33346128463745117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.333707332611084  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33372020721435547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33372020721435547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3337240219116211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3339414596557617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33394861221313477  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33394861221313477  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3339505195617676  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3340725898742676  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3340911865234375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3340911865234375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3340950012207031  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3343658447265625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3342580795288086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.334259033203125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33425140380859375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33425331115722656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2728428840637207  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27830982208251953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27830982208251953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27844905853271484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27956151962280273  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2797374725341797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2797374725341797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2799835205078125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28366851806640625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([27, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2839779853820801  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2839779853820801  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28426694869995117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2906155586242676  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([33, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29117584228515625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29117584228515625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29152870178222656  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30175018310546875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([30, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30237483978271484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30237483978271484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30269527435302734  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31423091888427734  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3147115707397461  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3147115707397461  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3149251937866211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3241109848022461  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3244156837463379  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3244156837463379  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32453393936157227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3304166793823242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33057117462158203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33057117462158203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3306245803833008  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33366870880126953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3337864875793457  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3337864875793457  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3338189125061035  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33588123321533203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([32, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3375735282897949  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3375735282897949  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33791589736938477  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3621811866760254  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35817766189575195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.358365535736084  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3585987091064453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35878849029541016  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35878849029541016  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3587980270385742  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3588743209838867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35887765884399414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35887765884399414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3588852882385254  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35899972915649414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3590106964111328  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3590106964111328  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3590202331542969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35923004150390625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3592562675476074  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3592562675476074  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3592715263366699  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3597140312194824  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3597402572631836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3597402572631836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3597536087036133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36023426055908203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36023378372192383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36023378372192383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36023569107055664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3603177070617676  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3603239059448242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3603239059448242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36032581329345703  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36042118072509766  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3604292869567871  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3604292869567871  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3604311943054199  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3605532646179199  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3605623245239258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3605623245239258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3605642318725586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3606996536254883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3607192039489746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3607192039489746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3607211112976074  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36100339889526367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3610267639160156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3610267639160156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36102867126464844  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36136436462402344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36121559143066406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36121654510498047  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36121606826782227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3612174987792969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27257776260375977  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([9, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27753686904907227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27753686904907227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2776331901550293  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27840375900268555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([19, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27855873107910156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27855873107910156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2787618637084961  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28180599212646484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([22, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2820568084716797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2820568084716797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28229236602783203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28746604919433594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([33, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.288053035736084  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.288053035736084  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2884058952331543  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2986273765563965  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([29, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2992253303527832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2992253303527832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29953527450561523  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3106861114501953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([18, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3111081123352051  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3111081123352051  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31130075454711914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31957578659057617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([16, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32007741928100586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32007741928100586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.320249080657959  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32880210876464844  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32901525497436523  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32901525497436523  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32909059524536133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3333621025085449  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3333725929260254  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3333725929260254  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33338403701782227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3340778350830078  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([24, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33535337448120117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33535337448120117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33560991287231445  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35380983352661133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3497300148010254  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3498997688293457  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3501105308532715  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35027599334716797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35027599334716797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35028553009033203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35036182403564453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35036706924438477  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35036706924438477  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35037660598754883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35051965713500977  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35053253173828125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35053253173828125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3505439758300781  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3507957458496094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3508133888244629  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3508133888244629  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35082483291625977  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35115671157836914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35117530822753906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35117530822753906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3511848449707031  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3515281677246094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3515353202819824  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3515353202819824  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35153913497924805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517031669616699  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.351715087890625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.351715087890625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517189025878906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3519096374511719  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3519158363342285  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3519158363342285  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35191774368286133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35202646255493164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3520345687866211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3520345687866211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3520364761352539  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3521585464477539  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35218095779418945  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35218095779418945  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3521847724914551  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3525090217590332  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3523836135864258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3523845672607422  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.352384090423584  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3523855209350586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2727022171020508  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2777738571166992  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2777738571166992  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27790260314941406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2789297103881836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([28, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27916431427001953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27916431427001953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2794637680053711  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2839498519897461  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([38, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2844090461730957  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2844090461730957  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 38, 1433]), torch.Size([1, 38, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28481531143188477  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2937445640563965  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 38, 1433])
--------------------------m.shape torch.Size([27, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29411840438842773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29411840438842773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29440736770629883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30277585983276367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([22, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3032188415527344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3032188415527344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3034543991088867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.311920166015625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([19, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3124113082885742  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3124113082885742  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31261444091796875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32134056091308594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32146358489990234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32146358489990234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32152843475341797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3247408866882324  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32509326934814453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32509326934814453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32518959045410156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33067989349365234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3308720588684082  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3308720588684082  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33092546463012695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33434343338012695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([26, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3357048034667969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3357048034667969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3359832763671875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3557119369506836  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3516068458557129  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3517899513244629  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3520174026489258  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3521995544433594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3521995544433594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3522071838378906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3522682189941406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3522820472717285  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3522820472717285  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35229921340942383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3525567054748535  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3525686264038086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3525686264038086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3525819778442383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3528757095336914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35288095474243164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35288095474243164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3528866767883301  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35305261611938477  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3530597686767578  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3530597686767578  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35306358337402344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35320091247558594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3532280921936035  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3532280921936035  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3532376289367676  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35364770889282227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3536500930786133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3536500930786133  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3536520004272461  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3537473678588867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35375547409057617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35375547409057617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.353757381439209  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.353879451751709  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35388946533203125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35388946533203125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35389137268066406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35404014587402344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35405778884887695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35405778884887695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35405969619750977  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.35431528091430664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3543386459350586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3543386459350586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3543405532836914  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3546762466430664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3545341491699219  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3545351028442383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3545346260070801  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3545360565185547  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

pure train time  0.5141506195068359
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27271604537963867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8042380809783936
loading full batch data spends  0.005884885787963867
random partition time  0.00017523765563964844

block_gen_time in "generate_blocks_for_one_layer_block"  0.0076520442962646484


block_gen_time in "generate_blocks_for_one_layer_block"  0.009691476821899414

connection checking time:  0.006010293960571289
block generation total time  0.009691476821899414
generate_dataloader_block spend   0.02883458137512207
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2725667953491211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([18, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.276702880859375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.276702880859375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27689552307128906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27843523025512695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([24, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2785954475402832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2785954475402832  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2788519859313965  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2826972007751465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2829856872558594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2829856872558594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28326416015625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28937768936157227  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([18, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2896232604980469  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2896232604980469  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28981590270996094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2953968048095703  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([24, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2959413528442383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2959413528442383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29619789123535156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30542612075805664  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30577850341796875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.30577850341796875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.305938720703125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31282806396484375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.313046932220459  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.313046932220459  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31313276290893555  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3174142837524414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3176279067993164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3176279067993164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31769275665283203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32135486602783203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32146692276000977  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32146692276000977  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3214993476867676  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3235616683959961  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([12, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3241863250732422  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3241863250732422  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32431507110595703  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33342742919921875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3301534652709961  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33030033111572266  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33048248291015625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3306293487548828  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3306293487548828  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3306465148925781  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3307838439941406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33078718185424805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33078718185424805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3307986259460449  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33097028732299805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3309793472290039  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3309793472290039  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33098888397216797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33119869232177734  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3312058448791504  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3312058448791504  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33121156692504883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3313775062561035  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3313941955566406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3313941955566406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3314018249511719  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3316764831542969  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33168458938598633  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33168458938598633  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33168840408325195  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33185243606567383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3318643569946289  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3318643569946289  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33186817169189453  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3320589065551758  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33207273483276367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33207273483276367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3320765495300293  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3322939872741699  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3323097229003906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3323097229003906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33231353759765625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33255767822265625  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33245372772216797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3324546813964844  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3324470520019531  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33244895935058594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27367448806762695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([8, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2792649269104004  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2792649269104004  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.27935075759887695  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28003597259521484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28023862838745117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28023862838745117  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.280484676361084  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.28416967391967773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([37, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2846393585205078  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2846393585205078  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2850351333618164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.293729305267334  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([35, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2942790985107422  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2942790985107422  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.29465293884277344  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3054943084716797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3060283660888672  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3060283660888672  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3063173294067383  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.31670570373535156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([21, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3172340393066406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3172340393066406  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3174591064453125  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32711124420166016  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3273353576660156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3273353576660156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.32743167877197266  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3322477340698242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.332456111907959  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.332456111907959  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3325209617614746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3361830711364746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33629512786865234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33629512786865234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33632755279541016  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.33838987350463867  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([33, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3401355743408203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3401355743408203  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3404884338378906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3655128479003906  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3609476089477539  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36114025115966797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36137914657592773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

--------------------------m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36157751083374023  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36157751083374023  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36158132553100586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36161184310913086  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36162376403808594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36162376403808594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3616371154785156  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36183738708496094  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36185121536254883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36185121536254883  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3618645668029785  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36215829849243164  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3621673583984375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3621673583984375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36217498779296875  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.362396240234375  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36241674423217773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36241674423217773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3624262809753418  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36276960372924805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36278247833251953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36278247833251953  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36278820037841797  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3630342483520508  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3630385398864746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3630385398864746  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3630404472351074  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36313581466674805  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3631429672241211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3631429672241211  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3631448745727539  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3632535934448242  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36326169967651367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36326169967651367  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3632636070251465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3633856773376465  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36339473724365234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36339473724365234  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36339664459228516  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36353206634521484  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3635430335998535  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3635430335998535  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36354494094848633  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3637070655822754  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3637247085571289  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3637247085571289  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3637266159057617  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3639822006225586  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3640017509460449  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.3640017509460449  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36400365829467773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.364285945892334  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36412572860717773  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36412668228149414  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36412620544433594  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.36412763595581055  GigaBytes
Max Memory Allocated: 0.4797983169555664  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27262306213378906  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

--------------------------m.shape torch.Size([9, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2777585983276367  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2777585983276367  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27785491943359375  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27862548828125  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([29, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2788872718811035  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2788872718811035  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27919721603393555  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2838435173034668  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([24, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2840733528137207  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2840733528137207  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.284329891204834  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28996944427490234  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([30, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2904820442199707  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2904820442199707  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2908024787902832  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3000950813293457  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3006558418273926  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3006558418273926  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30094480514526367  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31133317947387695  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31170129776000977  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31170129776000977  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3118729591369629  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3192286491394043  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.319516658782959  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.319516658782959  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3196234703063965  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3249640464782715  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32533788681030273  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32533788681030273  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32544469833374023  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33153295516967773  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.331575870513916  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.331575870513916  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33159780502319336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3329758644104004  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([29, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33482885360717773  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33482885360717773  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33513879776000977  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3571305274963379  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35293054580688477  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35310792922973633  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35332822799682617  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35350704193115234  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35350704193115234  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3535146713256836  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3535757064819336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35358572006225586  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35358572006225586  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35359907150268555  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35379934310913086  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35381603240966797  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35381603240966797  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35383129119873047  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35416698455810547  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35418272018432617  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35418272018432617  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35419416427612305  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3545260429382324  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3545351028442383  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3545351028442383  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3545408248901367  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35474681854248047  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3547501564025879  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3547501564025879  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3547520637512207  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35483407974243164  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3548402786254883  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3548402786254883  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3548421859741211  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3549375534057617  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35494565963745117  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35494565963745117  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.354947566986084  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.355069637298584  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35507869720458984  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35507869720458984  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35508060455322266  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35521602630615234  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3552260398864746  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3552260398864746  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3552279472351074  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3553767204284668  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35538768768310547  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35538768768310547  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3553895950317383  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35555171966552734  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3555750846862793  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3555750846862793  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3555769920349121  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3559126853942871  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35577392578125  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3557748794555664  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3557744026184082  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3557758331298828  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27241039276123047  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2768993377685547  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2768993377685547  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27701759338378906  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27795934677124023  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([22, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2781352996826172  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2781352996826172  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27837085723876953  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28189849853515625  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([27, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2822132110595703  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2822132110595703  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2825021743774414  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2888507843017578  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([35, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28945398330688477  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28945398330688477  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.289827823638916  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30066919326782227  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([20, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30101633071899414  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30101633071899414  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30122995376586914  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30892038345336914  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([18, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3093905448913574  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3093905448913574  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3095831871032715  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3178582191467285  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3180985450744629  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3180985450744629  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3181948661804199  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3230109214782715  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32317638397216797  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32317638397216797  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3232297897338867  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32627391815185547  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3263435363769531  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3263435363769531  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32636547088623047  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3277435302734375  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([22, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3289070129394531  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3289070129394531  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32914257049560547  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3458385467529297  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3422126770019531  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3423757553100586  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3425784111022949  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3427410125732422  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3427410125732422  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34275054931640625  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34282684326171875  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.342832088470459  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.342832088470459  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34284162521362305  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.342984676361084  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34299755096435547  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34299755096435547  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34300899505615234  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3432607650756836  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.343289852142334  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.343289852142334  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3433070182800293  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34380483627319336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34381103515625  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34381103515625  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34381675720214844  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3440227508544922  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34404897689819336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34404897689819336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3440585136413574  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3444685935974121  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34447383880615234  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34447383880615234  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34447574615478516  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34461116790771484  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446345329284668  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446345329284668  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446364402770996  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3449721336364746  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3448505401611328  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3448514938354492  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.344851016998291  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3448524475097656  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

pure train time  0.5445859432220459
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27242326736450195  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7920713424682617
loading full batch data spends  0.005564689636230469
random partition time  0.0001914501190185547

block_gen_time in "generate_blocks_for_one_layer_block"  0.00718235969543457


block_gen_time in "generate_blocks_for_one_layer_block"  0.009116888046264648

connection checking time:  0.00623774528503418
block generation total time  0.009116888046264648
generate_dataloader_block spend   0.02805352210998535
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2722315788269043  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27640438079833984  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27640438079833984  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27654361724853516  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27765607833862305  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([24, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27784299850463867  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27784299850463867  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27809953689575195  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28194475173950195  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([37, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2824091911315918  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2824091911315918  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2828049659729004  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29149913787841797  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([18, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2916860580444336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2916860580444336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29187870025634766  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29745960235595703  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([20, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2978973388671875  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2978973388671875  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2981109619140625  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3058013916015625  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30633544921875  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30633544921875  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.306549072265625  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31573486328125  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3157777786254883  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3157777786254883  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31582069396972656  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3179664611816406  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3180732727050781  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3180732727050781  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31810569763183594  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3199424743652344  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3200225830078125  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3200225830078125  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32004451751708984  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3214225769042969  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([23, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32302427291870117  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32302427291870117  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.323270320892334  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3407111167907715  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3373689651489258  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3375253677368164  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3377194404602051  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3378725051879883  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3378725051879883  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33788013458251953  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33794116973876953  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33794546127319336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33794546127319336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3379530906677246  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33806753158569336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3380928039550781  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3380928039550781  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33811187744140625  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.338531494140625  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3385491371154785  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3385491371154785  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3385624885559082  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33894968032836914  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3389625549316406  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3389625549316406  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3389701843261719  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3392448425292969  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33925294876098633  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33925294876098633  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33925676345825195  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33942079544067383  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33942604064941406  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33942604064941406  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3394279479980469  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3395233154296875  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33953046798706055  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33953046798706055  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33953237533569336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33964109420776367  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3396492004394531  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3396492004394531  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33965110778808594  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33977317810058594  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3397831916809082  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3397831916809082  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.339785099029541  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3399338722229004  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33982086181640625  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33982181549072266  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3398141860961914  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3398160934448242  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2728438377380371  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

--------------------------m.shape torch.Size([9, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27875471115112305  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27875471115112305  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2788510322570801  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27962160110473633  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([26, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27985143661499023  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27985143661499023  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28012990951538086  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2842984199523926  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2845759391784668  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2845759391784668  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2848544120788574  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2909679412841797  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([47, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29186105728149414  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29186105728149414  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29236364364624023  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3070077896118164  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([37, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30774450302124023  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30774450302124023  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30814027786254883  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32236671447753906  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([21, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3228416442871094  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3228416442871094  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32306671142578125  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3327188491821289  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3330550193786621  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3330550193786621  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33318376541137695  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3396010398864746  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([8, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33987855911254883  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33987855911254883  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3399643898010254  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3448452949523926  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34494686126708984  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34494686126708984  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34497928619384766  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34704160690307617  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([28, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34852027893066406  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34852027893066406  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3488197326660156  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3700523376464844  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36520910263061523  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3654160499572754  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3656730651855469  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36588191986083984  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36588191986083984  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3658933639526367  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3659849166870117  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36599302291870117  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36599302291870117  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36600637435913086  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36620664596557617  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3662090301513672  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3662090301513672  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3662147521972656  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36634063720703125  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3663496971130371  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3663496971130371  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36635541915893555  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36652135848999023  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3665332794189453  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3665332794189453  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36653900146484375  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3667449951171875  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36676549911499023  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36676549911499023  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3667731285095215  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36710119247436523  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36710453033447266  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36710453033447266  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36710643768310547  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3672018051147461  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3672165870666504  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3672165870666504  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.367220401763916  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36743783950805664  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36745357513427734  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36745357513427734  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36745738983154297  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36770153045654297  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3677096366882324  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3677096366882324  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36771154403686523  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3678469657897949  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3678579330444336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3678579330444336  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3678598403930664  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36802196502685547  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3680415153503418  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3680415153503418  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3680434226989746  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36832571029663086  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3683490753173828  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3683490753173828  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3683509826660156  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3686866760253906  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36851978302001953  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36852073669433594  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36852025985717773  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36852169036865234  GigaBytes
Max Memory Allocated: 0.4810795783996582  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27237415313720703  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([16, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27692174911499023  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27692174911499023  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27709341049194336  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27846240997314453  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2786221504211426  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2786221504211426  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2788681983947754  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28255319595336914  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([29, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2828946113586426  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2828946113586426  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2832045555114746  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29001903533935547  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([24, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2903766632080078  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2903766632080078  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2906332015991211  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2980670928955078  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([17, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29839277267456055  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29839277267456055  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29857492446899414  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3051180839538574  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([14, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30547571182250977  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30547571182250977  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30562543869018555  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3120551109313965  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3123917579650879  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3123917579650879  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31251001358032227  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3183927536010742  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31871843338012695  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31871843338012695  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.318814754486084  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32430505752563477  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3243532180786133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3243532180786133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3243751525878906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32575321197509766  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([25, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32707691192626953  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32707691192626953  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3273439407348633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34630298614501953  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3426241874694824  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3427863121032715  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3429875373840332  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3431525230407715  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3431525230407715  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34316587448120117  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34327268600463867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3432760238647461  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3432760238647461  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34328556060791016  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3434286117553711  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34345006942749023  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34345006942749023  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34346723556518555  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3438448905944824  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3438558578491211  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3438558578491211  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34386539459228516  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34414196014404297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34415197372436523  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34415197372436523  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34415769577026367  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3443636894226074  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3443784713745117  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3443784713745117  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34438419342041016  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34463024139404297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446345329284668  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446345329284668  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446364402770996  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34473180770874023  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34474945068359375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34474945068359375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34475135803222656  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34500694274902344  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3450303077697754  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3450303077697754  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3450322151184082  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3453679084777832  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3452458381652832  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3452467918395996  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3452463150024414  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.345247745513916  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27265310287475586  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([8, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.277435302734375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.277435302734375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27752113342285156  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27820634841918945  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([26, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2784414291381836  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2784414291381836  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2787199020385742  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28288841247558594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([23, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28311777114868164  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28311777114868164  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28336381912231445  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28876829147338867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([30, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28928613662719727  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28928613662719727  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28960657119750977  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29889917373657227  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([20, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2992730140686035  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2992730140686035  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2994866371154785  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3071770668029785  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3075828552246094  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3075828552246094  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3077545166015625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3151102066040039  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3154730796813965  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3154730796813965  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31560182571411133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.322019100189209  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3222537040710449  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3222537040710449  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.322329044342041  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3266005516052246  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3266592025756836  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3266592025756836  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32668113708496094  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32805919647216797  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([28, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3295431137084961  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3295431137084961  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32984256744384766  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3510751724243164  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34711265563964844  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3472766876220703  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34748029708862305  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3476409912109375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3476409912109375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34764671325683594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34769248962402344  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34770727157592773  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34770727157592773  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34772443771362305  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34798192977905273  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34798526763916016  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34798526763916016  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3479928970336914  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3481607437133789  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34818410873413086  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34818410873413086  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34819746017456055  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3485846519470215  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.348602294921875  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.348602294921875  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34861183166503906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3489551544189453  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34896230697631836  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34896230697631836  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.348966121673584  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34913015365600586  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3491353988647461  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3491353988647461  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3491373062133789  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34923267364501953  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.349240779876709  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.349240779876709  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3492426872253418  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3493647575378418  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3493833541870117  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3493833541870117  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34938716888427734  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3496580123901367  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.349668025970459  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.349668025970459  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3496699333190918  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34983205795288086  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34971046447753906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34971141815185547  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34971094131469727  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3497123718261719  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

pure train time  0.5383710861206055
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27266597747802734  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7500123977661133
loading full batch data spends  0.0059642791748046875
random partition time  0.0001747608184814453

block_gen_time in "generate_blocks_for_one_layer_block"  0.0074956417083740234


block_gen_time in "generate_blocks_for_one_layer_block"  0.00899815559387207

connection checking time:  0.005938529968261719
block generation total time  0.00899815559387207
generate_dataloader_block spend   0.027964353561401367
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2723660469055176  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27681732177734375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27681732177734375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2769355773925781  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2778773307800293  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([22, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27805328369140625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27805328369140625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2782888412475586  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2818164825439453  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([34, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2822432518005371  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2822432518005371  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2826066017150879  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29059600830078125  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([31, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29107666015625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29107666015625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2914085388183594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30101585388183594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([17, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3013038635253906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3013038635253906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3014860153198242  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3080291748046875  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30848264694213867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30848264694213867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30866479873657227  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3164801597595215  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31661367416381836  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31661367416381836  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.316678524017334  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31989097595214844  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32002973556518555  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32002973556518555  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32007265090942383  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32251882553100586  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3226900100708008  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3226900100708008  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32273292541503906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32547950744628906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([24, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3267393112182617  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3267393112182617  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.326995849609375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3451957702636719  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34159135818481445  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3417534828186035  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34195470809936523  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3421187400817871  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3421187400817871  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34212827682495117  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34220457077026367  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34220409393310547  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34220409393310547  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3422079086303711  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34226512908935547  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34228944778442383  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34228944778442383  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34230661392211914  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.342684268951416  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34270286560058594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34270286560058594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3427162170410156  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34310340881347656  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.343106746673584  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.343106746673584  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3431105613708496  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3432478904724121  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3432750701904297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3432750701904297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34328460693359375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34369468688964844  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34369707107543945  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34369707107543945  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34369897842407227  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3437943458557129  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34381961822509766  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34381961822509766  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3438253402709961  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3441915512084961  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34419965744018555  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34419965744018555  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34420156478881836  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34435033798217773  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34422731399536133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34422826766967773  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3442206382751465  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3442225456237793  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27207231521606445  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27613306045532227  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27613306045532227  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27625131607055664  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2771930694580078  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([31, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2774653434753418  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2774653434753418  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27779722213745117  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28276681900024414  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([32, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2831134796142578  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2831134796142578  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28345584869384766  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29097509384155273  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([26, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29135942459106445  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29135942459106445  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2916378974914551  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2996964454650879  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([30, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30035829544067383  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30035829544067383  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30067873001098633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31221437454223633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31253480911254883  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31253480911254883  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3126950263977051  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31958436965942383  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3198409080505371  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3198409080505371  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31993722915649414  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3247532844543457  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3249187469482422  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3249187469482422  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32497215270996094  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3280162811279297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32803773880004883  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32803773880004883  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3280491828918457  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32874298095703125  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([12, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3293781280517578  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3293781280517578  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32950687408447266  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3386192321777344  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3354787826538086  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33564281463623047  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3358464241027832  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33600473403930664  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33600473403930664  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3360104560852051  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3360562324523926  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3360729217529297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3360729217529297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3360919952392578  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3363780975341797  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33638620376586914  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33638620376586914  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.336397647857666  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33664941787719727  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3366670608520508  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3366670608520508  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33667850494384766  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33701038360595703  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.337033748626709  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.337033748626709  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33704519271850586  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33745718002319336  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33745861053466797  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33745861053466797  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3374605178833008  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3375558853149414  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33756303787231445  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33756303787231445  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33756494522094727  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3376736640930176  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33768272399902344  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33768272399902344  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33768463134765625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33782005310058594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3378434181213379  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3378434181213379  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3378453254699707  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3381810188293457  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3380618095397949  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33806276321411133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3380622863769531  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33806371688842773  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27259397506713867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2776761054992676  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2776761054992676  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2778048515319824  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27883195877075195  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27901315689086914  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27901315689086914  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27925920486450195  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2829442024230957  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([21, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2831578254699707  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2831578254699707  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2833828926086426  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28832149505615234  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([28, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2888069152832031  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2888069152832031  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2891063690185547  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2977790832519531  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([30, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2984304428100586  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2984304428100586  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2987508773803711  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3102865219116211  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([18, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3107032775878906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3107032775878906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3108959197998047  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3191709518432617  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31952333450317383  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31952333450317383  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31965208053588867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32606935501098633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32617616653442383  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32617616653442383  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3262190818786621  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32866525650024414  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32874011993408203  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32874011993408203  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3287620544433594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3301401138305664  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([31, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3320627212524414  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3320627212524414  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3323945999145508  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3559150695800781  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35170698165893555  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3518795967102051  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3520941734313965  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35226964950561523  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35226964950561523  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3522810935974121  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3523726463317871  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35237884521484375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35237884521484375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3523902893066406  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35256195068359375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35257387161254883  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35257387161254883  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3525853157043457  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35283708572387695  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35285091400146484  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35285091400146484  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3528604507446289  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3531370162963867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35315656661987305  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35315656661987305  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3531661033630371  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35350942611694336  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35351085662841797  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35351085662841797  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3535127639770508  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3535947799682617  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3536076545715332  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3536076545715332  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35361146926879883  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3538022041320801  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3538093566894531  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3538093566894531  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35381126403808594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35393333435058594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3539423942565918  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3539423942565918  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3539443016052246  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3540797233581543  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35409069061279297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35409069061279297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3540925979614258  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35425472259521484  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3542780876159668  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3542780876159668  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3542799949645996  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3546156883239746  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35448217391967773  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35448312759399414  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35448265075683594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35448408126831055  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27273988723754883  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2779717445373535  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2779717445373535  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2780900001525879  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27903175354003906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([21, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27919721603393555  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27919721603393555  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2794222831726074  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2827897071838379  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2830939292907715  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2830939292907715  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2833724021911621  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2894859313964844  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([31, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2900090217590332  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2900090217590332  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2903409004211426  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29994821548461914  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([21, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30034303665161133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30034303665161133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3005681037902832  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30864906311035156  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3091773986816406  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3091773986816406  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3093910217285156  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3185768127441406  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3188438415527344  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3188438415527344  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3189506530761719  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3242912292480469  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([12, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3247504234313965  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3247504234313965  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32487916946411133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33219480514526367  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3322267532348633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3322267532348633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3322486877441406  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33362674713134766  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([30, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3352174758911133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3352174758911133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3355379104614258  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3582887649536133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3542909622192383  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35446643829345703  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35468435287475586  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3548712730407715  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3548712730407715  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35488271713256836  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35497426986694336  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3549823760986328  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3549823760986328  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3549957275390625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3551959991455078  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35520410537719727  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35520410537719727  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35521364212036133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3554234504699707  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3554344177246094  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3554344177246094  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3554420471191406  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3556632995605469  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3556694984436035  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3556694984436035  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35567331314086914  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35581064224243164  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3558378219604492  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3558378219604492  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3558473587036133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35625743865966797  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35626840591430664  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35626840591430664  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35627222061157227  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3564896583557129  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35649776458740234  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35649776458740234  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35649967193603516  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35663509368896484  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3566460609436035  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3566460609436035  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35664796829223633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3568100929260254  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3568277359008789  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3568277359008789  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3568296432495117  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3570852279663086  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3571047782897949  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3571047782897949  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35710668563842773  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.357388973236084  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35724401473999023  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35724496841430664  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35724449157714844  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35724592208862305  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

pure train time  0.53045654296875
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2727537155151367  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6946642398834229
loading full batch data spends  0.006505250930786133
random partition time  0.0001747608184814453

block_gen_time in "generate_blocks_for_one_layer_block"  0.008124113082885742


block_gen_time in "generate_blocks_for_one_layer_block"  0.009011507034301758

connection checking time:  0.006432533264160156
block generation total time  0.009011507034301758
generate_dataloader_block spend   0.029088735580444336
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2720980644226074  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([8, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2760891914367676  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2760891914367676  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27617502212524414  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27686023712158203  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([30, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27713775634765625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27713775634765625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27745819091796875  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28226470947265625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([31, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28260135650634766  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28260135650634766  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28293323516845703  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2902216911315918  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([24, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29056835174560547  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29056835174560547  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29082489013671875  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29825878143310547  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([20, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29866456985473633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29866456985473633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29887819290161133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30656862258911133  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([10, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30678224563598633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30678224563598633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30688905715942383  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31148195266723633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.311765193939209  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.311765193939209  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.311861515045166  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3166775703430176  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3169283866882324  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3169283866882324  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3170037269592285  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3212752342224121  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3212857246398926  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3212857246398926  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32129716873168945  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.321990966796875  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([19, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32301759719848633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32301759719848633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32322072982788086  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3376288414001465  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33443641662597656  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33458805084228516  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3347764015197754  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33493566513061523  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33493566513061523  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3349432945251465  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3350043296813965  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33501625061035156  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33501625061035156  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33503150939941406  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33526039123535156  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3352789878845215  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3352789878845215  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3352961540222168  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33567380905151367  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3356809616088867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3356809616088867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33568859100341797  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3359098434448242  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33593034744262695  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33593034744262695  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.335939884185791  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33628320693969727  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3362903594970703  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3362903594970703  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33629417419433594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3364582061767578  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33646535873413086  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33646535873413086  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33646726608276367  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33658933639526367  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33659934997558594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33659934997558594  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33660125732421875  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3367500305175781  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3367733955383301  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3367733955383301  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3367753028869629  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3371109962463379  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3369917869567871  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3369927406311035  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33698511123657227  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3369870185852051  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27272462844848633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2774696350097656  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2774696350097656  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27760887145996094  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27872133255004883  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([21, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27887630462646484  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27887630462646484  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2791013717651367  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2824687957763672  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([23, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28272485733032227  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28272485733032227  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2829709053039551  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2883753776550293  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28887176513671875  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28887176513671875  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2891817092895508  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29816436767578125  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([29, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2987837791442871  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2987837791442871  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29909372329711914  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3102445602416992  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3107304573059082  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3107304573059082  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3109440803527832  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3201298713684082  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([7, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3202848434448242  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3202848434448242  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3203601837158203  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32410717010498047  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3242831230163574  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3242831230163574  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32433652877807617  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3273806571960449  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3274984359741211  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3274984359741211  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3275308609008789  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3295931816101074  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([25, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33091163635253906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33091163635253906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3311786651611328  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35013771057128906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34627246856689453  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3464393615722656  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.346646785736084  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3468170166015625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3468170166015625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34682655334472656  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34690284729003906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3469119071960449  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3469119071960449  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3469252586364746  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3471255302429199  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3471336364746094  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3471336364746094  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34714317321777344  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3473529815673828  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34737539291381836  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34737539291381836  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34738874435424805  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.347775936126709  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34778881072998047  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34778881072998047  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3477964401245117  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3480710983276367  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3480849266052246  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3480849266052246  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34809064865112305  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34833669662475586  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3483419418334961  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3483419418334961  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3483438491821289  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3484525680541992  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34846067428588867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34846067428588867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3484625816345215  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3485846519470215  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34859561920166016  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34859561920166016  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34859752655029297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34875965118408203  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.348783016204834  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.348783016204834  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3487849235534668  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3491206169128418  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34899139404296875  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34899234771728516  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34899187088012695  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34899330139160156  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2721552848815918  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([15, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2764887809753418  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2764887809753418  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27664899826049805  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27793073654174805  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([27, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2781391143798828  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2781391143798828  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2784280776977539  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2827568054199219  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([24, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28299713134765625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28299713134765625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28325366973876953  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2888932228088379  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([25, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28929901123046875  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28929901123046875  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2895660400390625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29730987548828125  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([20, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2977104187011719  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2977104187011719  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2979240417480469  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3056144714355469  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30605220794677734  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30605220794677734  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30623435974121094  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31404972076416016  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3143324851989746  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3143324851989746  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3144392967224121  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3197798728942871  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31994009017944336  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31994009017944336  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3199934959411621  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32303762435913086  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32305908203125  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32305908203125  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3230705261230469  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3237643241882324  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([23, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3251309394836426  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3251309394836426  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3253769874572754  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3428177833557129  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3393421173095703  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33950138092041016  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33969926834106445  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3398566246032715  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3398566246032715  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33986997604370117  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33997678756713867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3399820327758789  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3399820327758789  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3399934768676758  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3401651382446289  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.340177059173584  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.340177059173584  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34018850326538086  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3404402732849121  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3404579162597656  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3404579162597656  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3404693603515625  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3408012390136719  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34081029891967773  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34081029891967773  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34081602096557617  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3410220146179199  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3410367965698242  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3410367965698242  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34104251861572266  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34128856658935547  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3412928581237793  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3412928581237793  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3412947654724121  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34139013290405273  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34140872955322266  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34140872955322266  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3414125442504883  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34168338775634766  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34170007705688477  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34170007705688477  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3417019844055176  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34195756912231445  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3418431282043457  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3418440818786621  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3418436050415039  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3418450355529785  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2728152275085449  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([10, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2784538269042969  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2784538269042969  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2785606384277344  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2794151306152344  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([20, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2795753479003906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2795753479003906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2797889709472656  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2829933166503906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([33, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2834153175354004  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2834153175354004  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2837681770324707  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2915225028991699  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([39, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2921791076660156  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2921791076660156  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 39, 1433]), torch.Size([1, 39, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29259586334228516  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3046760559082031  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 39, 1433])
--------------------------m.shape torch.Size([26, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3051619529724121  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3051619529724121  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30544042587280273  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3154439926147461  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([21, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3159775733947754  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3159775733947754  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31620264053344727  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3258547782897949  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3261909484863281  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3261909484863281  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32631969451904297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3327369689941406  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3330998420715332  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3330998420715332  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3332066535949707  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3392949104309082  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3394341468811035  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3394341468811035  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3394770622253418  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3422236442565918  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([28, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34369707107543945  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34369707107543945  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.343996524810791  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36522912979125977  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3608732223510742  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3610668182373047  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36130714416503906  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36150503158569336  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36150503158569336  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3615126609802246  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3615736961364746  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36157798767089844  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36157798767089844  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3615856170654297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36170005798339844  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36171388626098633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36171388626098633  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3617253303527832  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36197710037231445  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36199092864990234  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36199092864990234  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3620004653930664  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3622770309448242  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3622870445251465  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3622870445251465  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3622927665710449  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36249876022338867  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36251354217529297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36251354217529297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3625192642211914  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3627653121948242  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36278295516967773  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36278295516967773  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36278867721557617  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36307477951049805  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36308765411376953  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36308765411376953  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36309146881103516  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3633089065551758  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3633246421813965  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3633246421813965  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3633284568786621  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3635725975036621  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36358070373535156  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36358070373535156  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3635826110839844  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36371803283691406  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36372900009155273  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36372900009155273  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36373090744018555  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3638930320739746  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36391258239746094  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36391258239746094  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36391448974609375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36419677734375  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36403894424438477  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36403989791870117  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36403942108154297  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3640408515930176  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

pure train time  0.5090246200561523
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2728300094604492  GigaBytes
Max Memory Allocated: 0.4856562614440918  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6307921409606934
Total (block generation + training)time/epoch 0.6384869303022113
pure train time/epoch 0.5302808284759521

num_input_list  [2065, 2042, 2068, 2138, 1997, 2144, 2076, 2143, 2080, 2029]
