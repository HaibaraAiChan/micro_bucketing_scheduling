main start at this time 1697832602.0067627
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.826 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.826 GB
Metis partitioning: 0.001 seconds, peak memory: 23.826 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008800983428955078
pure dgl.metis_partition the time spent:  0.0038018226623535156

block_gen_time in "generate_blocks_for_one_layer_block"  0.005995988845825195


block_gen_time in "generate_blocks_for_one_layer_block"  0.006584882736206055

connection checking time:  0.0063266754150390625
block generation total time  0.01258087158203125
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.515625 GB
    Memory Allocated: 0.07020282745361328  GigaBytes
Max Memory Allocated: 0.07020282745361328  GigaBytes

--------------------------m.shape torch.Size([6, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.0757455825805664  GigaBytes
Max Memory Allocated: 0.07574653625488281  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.0757455825805664  GigaBytes
Max Memory Allocated: 0.07574653625488281  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.07581043243408203  GigaBytes
Max Memory Allocated: 0.07581043243408203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.0763249397277832  GigaBytes
Max Memory Allocated: 0.07635736465454102  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([30, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.07661294937133789  GigaBytes
Max Memory Allocated: 0.0766139030456543  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.07661294937133789  GigaBytes
Max Memory Allocated: 0.0766139030456543  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.07693338394165039  GigaBytes
Max Memory Allocated: 0.07693338394165039  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.611328125 GB
    Memory Allocated: 0.08173990249633789  GigaBytes
Max Memory Allocated: 0.08206033706665039  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([32, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.611328125 GB
    Memory Allocated: 0.08209228515625  GigaBytes
Max Memory Allocated: 0.08209371566772461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.611328125 GB
    Memory Allocated: 0.08209228515625  GigaBytes
Max Memory Allocated: 0.08209371566772461  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 1.611328125 GB
    Memory Allocated: 0.08243465423583984  GigaBytes
Max Memory Allocated: 0.08243465423583984  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.62109375 GB
    Memory Allocated: 0.08995389938354492  GigaBytes
Max Memory Allocated: 0.09046649932861328  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.62109375 GB
    Memory Allocated: 0.09046602249145508  GigaBytes
Max Memory Allocated: 0.09046745300292969  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.62109375 GB
    Memory Allocated: 0.09046602249145508  GigaBytes
Max Memory Allocated: 0.09046745300292969  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 1.62109375 GB
    Memory Allocated: 0.09080839157104492  GigaBytes
Max Memory Allocated: 0.09080839157104492  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.634765625 GB
    Memory Allocated: 0.10071992874145508  GigaBytes
Max Memory Allocated: 0.10140323638916016  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([31, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.634765625 GB
    Memory Allocated: 0.10137653350830078  GigaBytes
Max Memory Allocated: 0.10140323638916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.634765625 GB
    Memory Allocated: 0.10137653350830078  GigaBytes
Max Memory Allocated: 0.10140323638916016  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 1.634765625 GB
    Memory Allocated: 0.10170841217041016  GigaBytes
Max Memory Allocated: 0.10170841217041016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.650390625 GB
    Memory Allocated: 0.11363458633422852  GigaBytes
Max Memory Allocated: 0.11446237564086914  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.650390625 GB
    Memory Allocated: 0.1140131950378418  GigaBytes
Max Memory Allocated: 0.11446237564086914  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.650390625 GB
    Memory Allocated: 0.1140131950378418  GigaBytes
Max Memory Allocated: 0.11446237564086914  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 1.650390625 GB
    Memory Allocated: 0.11419534683227539  GigaBytes
Max Memory Allocated: 0.11446237564086914  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.654296875 GB
    Memory Allocated: 0.12201070785522461  GigaBytes
Max Memory Allocated: 0.12255525588989258  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.654296875 GB
    Memory Allocated: 0.12233114242553711  GigaBytes
Max Memory Allocated: 0.12255525588989258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.654296875 GB
    Memory Allocated: 0.12233114242553711  GigaBytes
Max Memory Allocated: 0.12255525588989258  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 1.654296875 GB
    Memory Allocated: 0.12244939804077148  GigaBytes
Max Memory Allocated: 0.12255525588989258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.658203125 GB
    Memory Allocated: 0.12833213806152344  GigaBytes
Max Memory Allocated: 0.12874364852905273  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([12, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.658203125 GB
    Memory Allocated: 0.1287856101989746  GigaBytes
Max Memory Allocated: 0.12878704071044922  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.658203125 GB
    Memory Allocated: 0.1287856101989746  GigaBytes
Max Memory Allocated: 0.12878704071044922  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 1.658203125 GB
    Memory Allocated: 0.12891435623168945  GigaBytes
Max Memory Allocated: 0.12891435623168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.666015625 GB
    Memory Allocated: 0.1362299919128418  GigaBytes
Max Memory Allocated: 0.13674259185791016  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.666015625 GB
    Memory Allocated: 0.13631010055541992  GigaBytes
Max Memory Allocated: 0.13674259185791016  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.666015625 GB
    Memory Allocated: 0.13631010055541992  GigaBytes
Max Memory Allocated: 0.13674259185791016  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 1.666015625 GB
    Memory Allocated: 0.13634252548217773  GigaBytes
Max Memory Allocated: 0.13674259185791016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.66796875 GB
    Memory Allocated: 0.13840484619140625  GigaBytes
Max Memory Allocated: 0.1385493278503418  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([28, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.66796875 GB
    Memory Allocated: 0.13988351821899414  GigaBytes
Max Memory Allocated: 0.13988733291625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.66796875 GB
    Memory Allocated: 0.13988351821899414  GigaBytes
Max Memory Allocated: 0.13988733291625977  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 1.66796875 GB
    Memory Allocated: 0.1401829719543457  GigaBytes
Max Memory Allocated: 0.1401829719543457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.16141557693481445  GigaBytes
Max Memory Allocated: 0.16291046142578125  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1568446159362793  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15703725814819336  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15727615356445312  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1575002670288086  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1575002670288086  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15750598907470703  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15755176544189453  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15755891799926758  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15755891799926758  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15756845474243164  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15771150588989258  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1577301025390625  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1577301025390625  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.157745361328125  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1580810546875  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15808916091918945  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15808916091918945  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1580967903137207  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15831804275512695  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15833377838134766  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15833377838134766  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1583414077758789  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1586160659790039  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1586298942565918  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1586298942565918  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15863561630249023  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15888166427612305  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15888595581054688  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15888595581054688  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1588878631591797  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1589832305908203  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15899133682250977  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15899133682250977  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15899324417114258  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15911531448364258  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1591339111328125  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1591339111328125  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15913772583007812  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1594085693359375  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15941762924194336  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15941762924194336  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15941953659057617  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15956830978393555  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1595907211303711  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1595907211303711  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15959453582763672  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.15991878509521484  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.15993738174438477  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.15993738174438477  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.15993928909301758  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.16022157669067383  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.16024494171142578  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.16024494171142578  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.1602468490600586  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.1605825424194336  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.1603984832763672  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.1603994369506836  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.1603999137878418  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.69140625 GB
    Memory Allocated: 0.1604018211364746  GigaBytes
Max Memory Allocated: 0.16450023651123047  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1371927261352539  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

--------------------------m.shape torch.Size([17, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14029693603515625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14029693603515625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14047908782958984  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14193344116210938  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([21, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14206695556640625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14206695556640625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14229202270507812  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1456594467163086  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([20, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14586734771728516  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14586734771728516  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.14608097076416016  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.15078067779541016  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([21, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1511225700378418  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1511225700378418  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.15134763717651367  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.15785741806030273  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([19, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.15825223922729492  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.15825223922729492  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.15845537185668945  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.16576099395751953  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.16614007949829102  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.16614007949829102  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.16630029678344727  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17318964004516602  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17333412170410156  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17333412170410156  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1733989715576172  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17661142349243164  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17675018310546875  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17675018310546875  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17679309844970703  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17923927307128906  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17931413650512695  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.17931413650512695  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1793360710144043  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18071413040161133  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([8, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18113040924072266  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18113040924072266  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18121623992919922  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18729591369628906  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18495607376098633  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18508291244506836  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1852402687072754  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18537044525146484  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18537044525146484  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18538570404052734  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18550777435302734  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18551397323608398  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18551397323608398  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18552732467651367  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18572759628295898  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18573856353759766  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18573856353759766  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18575000762939453  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18600177764892578  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18601179122924805  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18601179122924805  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1860194206237793  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18624067306518555  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18625640869140625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18625640869140625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1862640380859375  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1865386962890625  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18654680252075195  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18654680252075195  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18655061721801758  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18671464920043945  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1867198944091797  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1867198944091797  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1867218017578125  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18681716918945312  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18683385848999023  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18683385848999023  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18683767318725586  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18708181381225586  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18699264526367188  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18699359893798828  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.18699312210083008  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.1869945526123047  GigaBytes
Max Memory Allocated: 0.2829904556274414  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.13837432861328125  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

--------------------------m.shape torch.Size([8, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14301252365112305  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14301252365112305  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1430983543395996  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1437835693359375  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([18, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14393329620361328  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14393329620361328  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14412593841552734  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14701271057128906  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([23, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14728498458862305  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14728498458862305  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14753103256225586  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15293550491333008  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([30, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15345335006713867  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15345335006713867  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15377378463745117  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16306638717651367  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([28, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16365385055541992  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16365385055541992  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16395330429077148  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17471933364868164  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17521047592163086  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17521047592163086  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17542409896850586  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18460988998413086  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1849517822265625  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1849517822265625  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18508052825927734  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.191497802734375  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19164705276489258  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19164705276489258  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19170045852661133  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19474458694458008  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19476604461669922  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19476604461669922  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1947774887084961  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19547128677368164  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([23, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19669342041015625  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19669342041015625  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.19693946838378906  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21438026428222656  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21056747436523438  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21072769165039062  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21092653274536133  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21111249923706055  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21111249923706055  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21111822128295898  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21116399765014648  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21116924285888672  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21116924285888672  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21117687225341797  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21129131317138672  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21130800247192383  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21130800247192383  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21132135391235352  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21161508560180664  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21162796020507812  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21162796020507812  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2116374969482422  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2119140625  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2119288444519043  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2119288444519043  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21193647384643555  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21221113204956055  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21223068237304688  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21223068237304688  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21223831176757812  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21256637573242188  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2125697135925293  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2125697135925293  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2125716209411621  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21266698837280273  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21268939971923828  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21268939971923828  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21269512176513672  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21302127838134766  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2130274772644043  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2130274772644043  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2130293846130371  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.2131514549255371  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21316051483154297  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21316051483154297  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21316242218017578  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21329784393310547  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21332120895385742  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21332120895385742  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21332311630249023  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21365880966186523  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21351099014282227  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21351194381713867  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21351146697998047  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.21351289749145508  GigaBytes
Max Memory Allocated: 0.3083052635192871  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.13704919815063477  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

--------------------------m.shape torch.Size([14, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1400890350341797  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1400890350341797  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14023876190185547  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1414351463317871  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([27, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1416487693786621  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1416487693786621  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1419377326965332  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14626646041870117  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([32, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14663457870483398  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14663457870483398  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.14697694778442383  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1544961929321289  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15494441986083984  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15494441986083984  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.15525436401367188  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16423702239990234  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([9, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1643223762512207  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1643223762512207  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16441869735717773  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16788625717163086  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([10, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16815853118896484  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16815853118896484  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.16826534271240234  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17285823822021484  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17310380935668945  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17310380935668945  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17318964004516602  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17747116088867188  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([1, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17747116088867188  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17747116088867188  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17748260498046875  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1781005859375  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1781911849975586  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1781911849975586  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17821311950683594  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.17959117889404297  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([8, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1800074577331543  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1800074577331543  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18009328842163086  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1861729621887207  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18391942977905273  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1840529441833496  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1842184066772461  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18436098098754883  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18436098098754883  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1843724250793457  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1844639778137207  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18447589874267578  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18447589874267578  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1844930648803711  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18475055694580078  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18475675582885742  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18475675582885742  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18476629257202148  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18497610092163086  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18500614166259766  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18500614166259766  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18502330780029297  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18552112579345703  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18552732467651367  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18552732467651367  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1855330467224121  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18573904037475586  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18574810028076172  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18574810028076172  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18575191497802734  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18591594696044922  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18592119216918945  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18592119216918945  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18592309951782227  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1860184669494629  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1860361099243164  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1860361099243164  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18603801727294922  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.1862936019897461  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18619298934936523  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18619394302368164  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18619346618652344  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.890625 GB
    Memory Allocated: 0.18619489669799805  GigaBytes
Max Memory Allocated: 0.3318915367126465  GigaBytes

pure train time  0.9339923858642578
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27176713943481445  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9443055391311646
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.828 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.828 GB
Metis partitioning: 0.000 seconds, peak memory: 24.828 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.003575563430786133
pure dgl.metis_partition the time spent:  0.0029497146606445312

block_gen_time in "generate_blocks_for_one_layer_block"  0.006718873977661133


block_gen_time in "generate_blocks_for_one_layer_block"  0.008496522903442383

connection checking time:  0.008085250854492188
block generation total time  0.015215396881103516
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27279233932495117  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

--------------------------m.shape torch.Size([6, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27753734588623047  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27753734588623047  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.2776021957397461  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27811670303344727  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27832984924316406  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.27832984924316406  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.2785758972167969  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.2822608947753906  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([30, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.28261852264404297  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.28261852264404297  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.28293895721435547  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.28998851776123047  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.2905116081237793  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.2905116081237793  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.29085397720336914  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3007655143737793  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([29, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.30136871337890625  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.30136871337890625  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3016786575317383  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.31282949447631836  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3131871223449707  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3131871223449707  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.31335878372192383  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.32071447372436523  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3210024833679199  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3210024833679199  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3211092948913574  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3264498710632324  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.32682371139526367  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.32682371139526367  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.32693052291870117  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.33301877975463867  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.33310985565185547  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.33310985565185547  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3331422805786133  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3352046012878418  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([19, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.33680057525634766  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.33680057525634766  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3370037078857422  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3514118194580078  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34755659103393555  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34772634506225586  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34793710708618164  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

--------------------------m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3481264114379883  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3481264114379883  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3481302261352539  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3481607437133789  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34816694259643555  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34816694259643555  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3481745719909668  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34828901290893555  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3483114242553711  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3483114242553711  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3483285903930664  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3487062454223633  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34871721267700195  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34871721267700195  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.348726749420166  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34900331497192383  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3490180969238281  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3490180969238281  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3490257263183594  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3493003845214844  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3493199348449707  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3493199348449707  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34932756423950195  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3496556282043457  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34966564178466797  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34966564178466797  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3496694564819336  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34986019134521484  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3498663902282715  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3498663902282715  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3498682975769043  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3499770164489746  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3499937057495117  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3499937057495117  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.34999752044677734  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.35024166107177734  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3502497673034668  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3502497673034668  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3502516746520996  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3503870964050293  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.35039710998535156  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.35039710998535156  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3503990173339844  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.35054779052734375  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3505587577819824  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3505587577819824  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.35056066513061523  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3507227897644043  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3505725860595703  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3505735397338867  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3505687713623047  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.984375 GB
    Memory Allocated: 0.3505706787109375  GigaBytes
Max Memory Allocated: 0.36551713943481445  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2722444534301758  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

--------------------------m.shape torch.Size([10, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2758455276489258  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2758455276489258  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2759523391723633  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2768068313598633  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([29, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27706336975097656  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27706336975097656  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2773733139038086  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28201961517333984  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([22, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28221702575683594  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28221702575683594  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2824525833129883  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2876262664794922  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([23, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28799962997436523  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28799962997436523  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28824567794799805  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29536962509155273  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([11, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29554033279418945  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29554033279418945  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29565858840942383  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2998943328857422  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30031585693359375  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30031585693359375  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30047607421875  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30736541748046875  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3076591491699219  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3076591491699219  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3077659606933594  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3131065368652344  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3132667541503906  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3132667541503906  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3133201599121094  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3163642883300781  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31638574600219727  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31638574600219727  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31639719009399414  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3170909881591797  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([17, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3179931640625  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3179931640625  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3181753158569336  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33107948303222656  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32821178436279297  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32834815979003906  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32851743698120117  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32864999771118164  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32864999771118164  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3286614418029785  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3287529945373535  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3287687301635742  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3287687301635742  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32878971099853516  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3291044235229492  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32910585403442383  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32910585403442383  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3291134834289551  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3292813301086426  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32930469512939453  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32930469512939453  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3293180465698242  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32970523834228516  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32971811294555664  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32971811294555664  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3297257423400879  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3300004005432129  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33000850677490234  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33000850677490234  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33001232147216797  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33017635345458984  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33019304275512695  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33019304275512695  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33019495010375977  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33045053482055664  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33035898208618164  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33035993576049805  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33035945892333984  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33036088943481445  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2728004455566406  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

--------------------------m.shape torch.Size([15, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27768373489379883  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27768373489379883  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2778439521789551  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2791256904602051  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([24, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27930212020874023  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27930212020874023  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2795586585998535  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2834038734436035  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([30, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2837562561035156  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2837562561035156  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2840766906738281  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2911262512207031  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([27, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29154300689697266  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29154300689697266  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29183197021484375  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3002004623413086  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30077695846557617  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30077695846557617  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30106592178344727  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31145429611206055  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([19, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3119187355041504  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3119187355041504  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3121218681335449  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3208479881286621  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([7, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32100820541381836  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32100820541381836  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32108354568481445  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3248305320739746  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32504940032958984  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32504940032958984  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32511425018310547  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32877635955810547  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3288402557373047  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3288402557373047  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32886219024658203  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33024024963378906  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([27, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33184146881103516  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33184146881103516  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33213043212890625  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3526182174682617  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3489232063293457  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34909868240356445  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3493165969848633  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3495192527770996  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3495192527770996  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34952497482299805  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34957075119018555  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3495759963989258  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3495759963989258  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34958362579345703  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3496980667114258  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3497176170349121  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3497176170349121  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3497328758239746  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3500685691833496  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35007667541503906  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35007667541503906  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3500843048095703  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35030555725097656  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3503260612487793  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3503260612487793  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35033559799194336  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506789207458496  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506917953491211  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506917953491211  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35069751739501953  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35094356536865234  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35095643997192383  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35095643997192383  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35096025466918945  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3511776924133301  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3511848449707031  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3511848449707031  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35118675231933594  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35130882263183594  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3513178825378418  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3513178825378418  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3513197898864746  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3514552116394043  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35146617889404297  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35146617889404297  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3514680862426758  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35163021087646484  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35164976119995117  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35164976119995117  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.351651668548584  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35193395614624023  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3519573211669922  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3519573211669922  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.351959228515625  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.352294921875  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3521304130554199  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35213136672973633  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3521308898925781  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35213232040405273  GigaBytes
Max Memory Allocated: 0.4693145751953125  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27214908599853516  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

--------------------------m.shape torch.Size([15, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2755732536315918  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2755732536315918  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27573347091674805  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27701520919799805  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([22, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27717018127441406  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27717018127441406  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2774057388305664  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2809333801269531  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([25, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2812161445617676  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2812161445617676  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28148317337036133  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28735780715942383  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([28, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28782224655151367  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28782224655151367  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28812170028686523  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29679441452026367  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([22, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29723215103149414  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29723215103149414  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2974677085876465  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30593347549438477  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3061680793762207  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3061680793762207  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3062863349914551  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31134557723999023  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3115854263305664  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3115854263305664  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31167125701904297  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31595277786254883  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3159956932067871  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3159956932067871  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31601762771606445  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3172450065612793  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31733036041259766  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31733036041259766  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.317352294921875  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31873035430908203  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([11, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3193068504333496  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3193068504333496  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.319425106048584  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32777833938598633  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3251609802246094  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3253002166748047  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3254728317260742  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32563352584838867  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32563352584838867  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.325650691986084  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3257880210876465  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3257913589477539  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3257913589477539  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3258028030395508  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3259744644165039  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32598352432250977  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32598352432250977  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32599306106567383  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3262028694152832  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3262214660644531  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3262214660644531  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32623291015625  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3265647888183594  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3265690803527832  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3265690803527832  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32657289505004883  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32671022415161133  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3267202377319336  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3267202377319336  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3267240524291992  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3268880844116211  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32690000534057617  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32690000534057617  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3269038200378418  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32709455490112305  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3271017074584961  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3271017074584961  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3271036148071289  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3272256851196289  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32723474502563477  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32723474502563477  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3272366523742676  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32737207412719727  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3273954391479492  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3273954391479492  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32739734649658203  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32773303985595703  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32761716842651367  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3276181221008301  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3276176452636719  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3276190757751465  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

pure train time  0.5306389331817627
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27216005325317383  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9172414541244507
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.859 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.859 GB
Metis partitioning: 0.000 seconds, peak memory: 24.859 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0058934688568115234
pure dgl.metis_partition the time spent:  0.003167390823364258

block_gen_time in "generate_blocks_for_one_layer_block"  0.006859540939331055


block_gen_time in "generate_blocks_for_one_layer_block"  0.008550643920898438

connection checking time:  0.007682085037231445
block generation total time  0.015410184860229492
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2727961540222168  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

--------------------------m.shape torch.Size([7, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27770233154296875  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27770233154296875  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27777767181396484  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2783775329589844  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([22, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27857494354248047  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27857494354248047  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2788105010986328  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28233814239501953  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([23, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2825889587402344  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2825889587402344  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2828350067138672  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2882394790649414  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([33, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2888212203979492  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2888212203979492  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28917407989501953  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2993955612182617  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([36, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30018043518066406  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30018043518066406  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 36, 1433]), torch.Size([1, 36, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3005657196044922  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31441450119018555  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 36, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31473445892333984  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31473445892333984  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31490612030029297  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3222618103027344  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3225126266479492  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3225126266479492  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32260894775390625  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3274250030517578  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3278470039367676  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3278470039367676  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32796525955200195  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3346714973449707  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33470869064331055  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33470869064331055  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3347306251525879  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3361086845397949  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([21, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.337709903717041  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.337709903717041  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3379349708557129  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35387182235717773  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34986066818237305  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35003232955932617  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35024547576904297  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

--------------------------m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3504490852355957  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3504490852355957  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3504509925842285  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.350466251373291  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3504772186279297  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3504772186279297  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35048866271972656  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506603240966797  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506779670715332  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506779670715332  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506932258605957  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3510289192199707  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35103702545166016  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35103702545166016  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3510446548461914  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35126590728759766  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3512721061706543  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3512721061706543  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3512759208679199  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3514132499694824  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3514404296875  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3514404296875  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35144996643066406  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35186004638671875  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35186243057250977  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35186243057250977  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3518643379211426  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3519597053527832  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35198211669921875  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35198211669921875  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3519878387451172  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3523139953613281  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35232019424438477  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35232019424438477  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3523221015930176  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3524441719055176  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3524627685546875  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3524627685546875  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3524665832519531  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3527374267578125  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35274744033813477  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35274744033813477  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3527493476867676  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35291147232055664  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3529348373413086  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3529348373413086  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3529367446899414  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3532724380493164  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3531060218811035  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3531069755554199  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35309934616088867  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3531012535095215  GigaBytes
Max Memory Allocated: 0.4696683883666992  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2721705436706543  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27588987350463867  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27588987350463867  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27600812911987305  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2769498825073242  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([27, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2771792411804199  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2771792411804199  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.277468204498291  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.281796932220459  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([37, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2822451591491699  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2822451591491699  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2826409339904785  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2913351058959961  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([26, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29169273376464844  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29169273376464844  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29197120666503906  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3000297546386719  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([14, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3002643585205078  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3002643585205078  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3004140853881836  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30579710006713867  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([14, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3061709403991699  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3061709403991699  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3063206672668457  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31275033950805664  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31308698654174805  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31308698654174805  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3132052421569824  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3190879821777344  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3192000389099121  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3192000389099121  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3192429542541504  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3216891288757324  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3217639923095703  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3217639923095703  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32178592681884766  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3231639862060547  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([12, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.323793888092041  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.323793888092041  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32392263412475586  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3330349922180176  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33016061782836914  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33031129837036133  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33049821853637695  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33066511154174805  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33066511154174805  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3306765556335449  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3307681083679199  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33077239990234375  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33077239990234375  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3307819366455078  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33092498779296875  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33094358444213867  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33094358444213867  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33095884323120117  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33129453659057617  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3313140869140625  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3313140869140625  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3313274383544922  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3317146301269531  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3317275047302246  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3317275047302246  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33173513412475586  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33200979232788086  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3320178985595703  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3320178985595703  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33202171325683594  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3321857452392578  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33219099044799805  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33219099044799805  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33219289779663086  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3322882652282715  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.332305908203125  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.332305908203125  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3323078155517578  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3325634002685547  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33258676528930664  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33258676528930664  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33258867263793945  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33292436599731445  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33279943466186523  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33280038833618164  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33279991149902344  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33280134201049805  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27280330657958984  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

--------------------------m.shape torch.Size([9, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2776494026184082  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2776494026184082  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27774572372436523  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2785162925720215  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([31, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27879953384399414  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27879953384399414  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2791314125061035  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2841010093688965  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([33, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28446388244628906  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28446388244628906  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2848167419433594  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2925710678100586  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2930140495300293  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2930140495300293  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29332399368286133  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3023066520690918  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([23, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3027658462524414  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3027658462524414  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3030118942260742  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3118553161621094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31227684020996094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31227684020996094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31245899200439453  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32027435302734375  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([5, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3203701972961426  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3203701972961426  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32042360305786133  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32309389114379883  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32328081130981445  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32328081130981445  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3233342170715332  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32637834548950195  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32654428482055664  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32654428482055664  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3265872001647949  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3293337821960449  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([28, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33092451095581055  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33092451095581055  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3312239646911621  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35245656967163086  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34876203536987305  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3489375114440918  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3491554260253906  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3493475914001465  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3493475914001465  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3493533134460449  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3493990898132324  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3494119644165039  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3494119644165039  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3494272232055664  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3496561050415039  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34966325759887695  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34966325759887695  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.349672794342041  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3498826026916504  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34989356994628906  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.34989356994628906  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3499011993408203  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35012245178222656  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35013818740844727  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35013818740844727  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3501458168029785  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3504204750061035  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3504343032836914  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3504343032836914  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35044002532958984  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35068607330322266  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506903648376465  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506903648376465  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3506922721862793  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3507876396179199  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3508129119873047  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3508129119873047  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3508186340332031  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3511848449707031  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35119199752807617  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35119199752807617  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.351193904876709  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35132932662963867  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35133934020996094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35133934020996094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35134124755859375  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3514900207519531  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3515009880065918  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3515009880065918  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3515028953552246  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35166501998901367  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3516845703125  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3516845703125  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3516864776611328  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35196876525878906  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35181570053100586  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35181665420532227  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35181617736816406  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35181760787963867  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2719268798828125  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

--------------------------m.shape torch.Size([19, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27497434616088867  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27497434616088867  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2751774787902832  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27680110931396484  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([17, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27688121795654297  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27688121795654297  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27706336975097656  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27978992462158203  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([16, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2799553871154785  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2799553871154785  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28012704849243164  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2838907241821289  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([20, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28423213958740234  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28423213958740234  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28444576263427734  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29064083099365234  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([17, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2909879684448242  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2909879684448242  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2911701202392578  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2977132797241211  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([14, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29807090759277344  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29807090759277344  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2982206344604492  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30465030670166016  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3050241470336914  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3050241470336914  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.30515289306640625  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3115701675415039  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3116340637207031  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3116340637207031  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31166648864746094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3135032653808594  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([9, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3139677047729492  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3139677047729492  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31406402587890625  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32090282440185547  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3185920715332031  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3187131881713867  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3188638687133789  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

--------------------------m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3189849853515625  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3189849853515625  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3190040588378906  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3191566467285156  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31915903091430664  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31915903091430664  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3191704750061035  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31934213638305664  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3193511962890625  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3193511962890625  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31936073303222656  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31957054138183594  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3195929527282715  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3195929527282715  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31960630416870117  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3199934959411621  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3200111389160156  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3200111389160156  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3200206756591797  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32036399841308594  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32036542892456055  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32036542892456055  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32036733627319336  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3204493522644043  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32045555114746094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32045555114746094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32045745849609375  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3205528259277344  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3204765319824219  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3204774856567383  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3204770088195801  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3204784393310547  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

pure train time  0.5095746517181396
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27193498611450195  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.901986837387085
loading full batch data spends  0.005422353744506836
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.859 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.859 GB
Metis partitioning: 0.000 seconds, peak memory: 24.859 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005269289016723633
pure dgl.metis_partition the time spent:  0.003062009811401367

block_gen_time in "generate_blocks_for_one_layer_block"  0.005701303482055664


block_gen_time in "generate_blocks_for_one_layer_block"  0.00674748420715332

connection checking time:  0.005350351333618164
block generation total time  0.012448787689208984
generate_dataloader_block spend   0.03017592430114746
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27300071716308594  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

--------------------------m.shape torch.Size([7, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2789325714111328  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2789325714111328  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2790079116821289  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.27960777282714844  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([27, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2798585891723633  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2798585891723633  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2801475524902344  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28447628021240234  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([25, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2847323417663574  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2847323417663574  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.28499937057495117  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.29087400436401367  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([30, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2913813591003418  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2913813591003418  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.2917017936706543  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3009943962097168  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([26, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3015284538269043  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3015284538269043  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3018069267272949  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3118104934692383  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31221580505371094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31221580505371094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.31239795684814453  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32021331787109375  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32045888900756836  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32045888900756836  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3205552101135254  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32537126541137695  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32575035095214844  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32575035095214844  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.32585716247558594  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33194541931152344  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33208465576171875  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33208465576171875  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33212757110595703  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33487415313720703  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([31, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33650779724121094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.33650779724121094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3368396759033203  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.36036014556884766  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35592174530029297  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35609912872314453  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3563194274902344  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

--------------------------m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3565239906311035  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3565239906311035  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35652780532836914  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35655832290649414  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3565683364868164  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3565683364868164  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3565797805786133  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3567514419555664  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3567633628845215  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3567633628845215  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35677480697631836  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3570265769958496  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3570442199707031  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3570442199707031  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3570556640625  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3573875427246094  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35740137100219727  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35740137100219727  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3574090003967285  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3576836585998535  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3576974868774414  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3576974868774414  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35770320892333984  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35794925689697266  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35796022415161133  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35796022415161133  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35796403884887695  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3581547737121582  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3581705093383789  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3581705093383789  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35817432403564453  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35841846466064453  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35843610763549805  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35843610763549805  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35843992233276367  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35871076583862305  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3587198257446289  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3587198257446289  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3587217330932617  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3588705062866211  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35888147354125977  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35888147354125977  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3588833808898926  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35904550552368164  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35906505584716797  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35906505584716797  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3590669631958008  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35934925079345703  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35918378829956055  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35918474197387695  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.3591804504394531  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.015625 GB
    Memory Allocated: 0.35918235778808594  GigaBytes
Max Memory Allocated: 0.4713573455810547  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27201366424560547  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

--------------------------m.shape torch.Size([16, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2761101722717285  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2761101722717285  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27628183364868164  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2776508331298828  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27783203125  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27783203125  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27809906005859375  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2821044921875  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([24, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28235578536987305  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28235578536987305  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28261232376098633  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2882518768310547  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([24, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2886362075805664  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2886362075805664  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2888927459716797  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2963266372680664  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([21, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29675912857055664  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29675912857055664  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2969841957092285  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3050651550292969  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([8, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3052091598510742  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3052091598510742  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3052949905395508  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3089771270751953  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([14, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30945777893066406  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30945777893066406  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30960750579833984  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31708383560180664  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([1, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31705188751220703  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31705188751220703  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3170633316040039  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31768131256103516  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([11, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31826305389404297  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31826305389404297  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31838130950927734  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3267345428466797  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3234405517578125  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.323577880859375  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3237481117248535  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

--------------------------m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32388973236083984  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32388973236083984  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32390308380126953  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32400989532470703  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3240208625793457  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3240208625793457  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.324038028717041  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3242955207824707  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32430458068847656  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32430458068847656  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32431602478027344  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3245677947998047  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3245816230773926  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3245816230773926  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32459115982055664  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32486772537231445  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32488250732421875  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32488250732421875  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32489013671875  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.325164794921875  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.325167179107666  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.325167179107666  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32516908645629883  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32525110244750977  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32526206970214844  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32526206970214844  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32526397705078125  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3254261016845703  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32544946670532227  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32544946670532227  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3254513740539551  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3257870674133301  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3256864547729492  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3256874084472656  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3256869316101074  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32568836212158203  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27225589752197266  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2765793800354004  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2765793800354004  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27669763565063477  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27763938903808594  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([21, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2778048515319824  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2778048515319824  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2780299186706543  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28139734268188477  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([31, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2817816734313965  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2817816734313965  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28211355209350586  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2894020080566406  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([28, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28983402252197266  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28983402252197266  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2901334762573242  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29880619049072266  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([28, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2994041442871094  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2994041442871094  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29970359802246094  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3104696273803711  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([18, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3108968734741211  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3108968734741211  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31108951568603516  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3193645477294922  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31949281692504883  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31949281692504883  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31955766677856445  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3227701187133789  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3232078552246094  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3232078552246094  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32332611083984375  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3300323486328125  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33006954193115234  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33006954193115234  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3300914764404297  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3314695358276367  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([14, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33220624923706055  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33220624923706055  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33235597610473633  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3429722785949707  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33954858779907227  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33971071243286133  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33991193771362305  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34009218215942383  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34009218215942383  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3401017189025879  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3401780128479004  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3401775360107422  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3401775360107422  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3401813507080078  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3402385711669922  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34026288986206055  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34026288986206055  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34028005599975586  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34065771102905273  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3406686782836914  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3406686782836914  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34067821502685547  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3409547805786133  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3409743309020996  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3409743309020996  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34098386764526367  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3413271903991699  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3413400650024414  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3413400650024414  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34134578704833984  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34159183502197266  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3416123390197754  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3416123390197754  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34161806106567383  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34194421768188477  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34195899963378906  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34195899963378906  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3419628143310547  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3422069549560547  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34222936630249023  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34222936630249023  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34223127365112305  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34256696701049805  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34242773056030273  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34242868423461914  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34242820739746094  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.34242963790893555  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2720484733581543  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27559661865234375  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27559661865234375  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2757253646850586  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2767524719238281  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([24, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.276944637298584  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.276944637298584  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27720117568969727  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28104639053344727  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([29, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28138256072998047  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28138256072998047  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2816925048828125  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28850698471069336  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([28, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28894996643066406  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28894996643066406  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2892494201660156  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29792213439941406  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([13, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29811954498291016  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29811954498291016  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29825878143310547  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30326414108276367  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.303739070892334  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.303739070892334  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3039212226867676  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3117365837097168  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31194448471069336  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31194448471069336  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3120303153991699  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3163118362426758  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([1, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3163118362426758  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3163118362426758  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31632328033447266  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3169412612915039  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3170318603515625  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3170318603515625  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31705379486083984  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3184318542480469  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([14, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3191685676574707  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3191685676574707  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3193182945251465  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32993459701538086  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32717323303222656  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3273143768310547  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32748937606811523  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32764387130737305  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32764387130737305  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3276553153991699  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3277468681335449  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3277568817138672  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3277568817138672  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3277721405029297  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3280010223388672  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32800817489624023  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32800817489624023  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3280177116394043  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32822751998901367  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3282461166381836  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3282461166381836  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32825756072998047  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32858943939208984  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32859373092651367  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32859373092651367  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3285975456237793  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3287348747253418  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32875633239746094  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32875633239746094  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3287639617919922  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32909202575683594  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3291020393371582  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3291020393371582  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32910585403442383  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3292965888977051  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32930469512939453  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32930469512939453  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32930660247802734  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32944202423095703  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32945966720581055  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32945966720581055  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32946157455444336  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32971715927124023  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3296046257019043  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3296055793762207  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3296051025390625  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3296065330505371  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

pure train time  0.5050010681152344
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2720603942871094  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.880591869354248
loading full batch data spends  0.006669521331787109
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.891 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.891 GB
Metis partitioning: 0.000 seconds, peak memory: 24.891 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004523277282714844
pure dgl.metis_partition the time spent:  0.003144502639770508

block_gen_time in "generate_blocks_for_one_layer_block"  0.006788730621337891


block_gen_time in "generate_blocks_for_one_layer_block"  0.00853729248046875

connection checking time:  0.0075588226318359375
block generation total time  0.01532602310180664
generate_dataloader_block spend   0.03482484817504883
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27289724349975586  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

--------------------------m.shape torch.Size([8, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27819347381591797  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27819347381591797  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27827930450439453  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2789645195007324  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([29, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27923154830932617  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27923154830932617  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2795414924621582  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28418779373168945  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([31, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2845296859741211  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2845296859741211  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28486156463623047  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29215002059936523  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2926673889160156  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2926673889160156  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29300975799560547  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3029212951660156  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([30, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30355119705200195  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30355119705200195  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30387163162231445  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31540727615356445  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31575965881347656  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31575965881347656  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3159313201904297  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3232870101928711  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32361268997192383  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32361268997192383  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3237309455871582  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32961368560791016  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3299393653869629  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3299393653869629  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3300356864929199  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3355259895324707  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33562231063842773  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33562231063842773  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33565473556518555  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33771705627441406  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([27, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3393130302429199  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3393130302429199  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.339601993560791  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3600897789001465  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35574865341186523  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35593557357788086  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3561673164367676  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3563833236694336  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3563833236694336  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35638904571533203  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35643482208251953  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35644006729125977  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35644006729125977  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.356447696685791  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35656213760375977  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3565845489501953  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3565845489501953  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3566017150878906  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3569793701171875  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35698652267456055  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35698652267456055  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3569941520690918  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35721540451049805  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3572359085083008  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3572359085083008  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35724544525146484  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3575887680053711  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.357607364654541  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.357607364654541  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35761499404907227  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.357943058013916  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35794830322265625  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35794830322265625  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35795021057128906  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35807228088378906  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.358090877532959  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.358090877532959  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3580946922302246  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.358365535736084  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35837459564208984  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35837459564208984  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35837650299072266  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35852527618408203  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3585362434387207  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3585362434387207  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3585381507873535  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3587002754211426  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3587198257446289  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3587198257446289  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3587217330932617  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35900402069091797  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3590273857116699  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3590273857116699  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35902929306030273  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35936498641967773  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3591890335083008  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3591899871826172  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35918235778808594  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.35918426513671875  GigaBytes
Max Memory Allocated: 0.4755425453186035  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2721385955810547  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2760124206542969  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2760124206542969  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2761516571044922  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2772641181945801  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27746152877807617  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27746152877807617  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2777285575866699  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28173398971557617  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([30, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28208112716674805  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28208112716674805  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28240156173706055  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28945112228393555  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([27, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2898678779602051  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2898678779602051  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29015684127807617  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.298525333404541  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([22, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2989683151245117  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2989683151245117  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29920387268066406  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30766963958740234  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([13, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3079686164855957  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3079686164855957  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.308107852935791  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3140864372253418  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3142414093017578  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3142414093017578  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31430625915527344  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3175187110900879  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31774282455444336  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31774282455444336  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.317807674407959  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.321469783782959  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3214855194091797  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3214855194091797  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32149696350097656  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3221907615661621  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([16, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32303953170776367  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32303953170776367  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3232111930847168  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3353562355041504  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3323225975036621  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3324742317199707  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33266258239746094  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3328371047973633  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3328371047973633  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33284854888916016  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33294010162353516  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3329463005065918  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3329463005065918  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33295774459838867  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3331294059753418  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3331441879272461  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3331441879272461  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3331575393676758  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3334512710571289  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33345651626586914  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33345651626586914  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3334622383117676  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33362817764282227  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3336353302001953  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3336353302001953  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33363914489746094  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33377647399902344  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33379220962524414  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33379220962524414  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3337979316711426  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3340439796447754  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3340482711791992  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3340482711791992  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33405017852783203  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33414554595947266  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3341679573059082  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3341679573059082  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33417367935180664  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3344998359680176  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3345060348510742  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3345060348510742  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33450794219970703  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33463001251220703  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3346409797668457  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3346409797668457  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3346428871154785  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3348050117492676  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33482837677001953  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33482837677001953  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33483028411865234  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33516597747802734  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33503246307373047  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3350334167480469  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33503293991088867  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3350343704223633  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2729024887084961  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

--------------------------m.shape torch.Size([12, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2763538360595703  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2763538360595703  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27648258209228516  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2775096893310547  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([20, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27765893936157227  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27765893936157227  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27787256240844727  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28107690811157227  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([23, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2813386917114258  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2813386917114258  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2815847396850586  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2869892120361328  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([23, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2873573303222656  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2873573303222656  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28760337829589844  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2947273254394531  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([18, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29508495330810547  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29508495330810547  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29527759552001953  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30220556259155273  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([14, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30255794525146484  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30255794525146484  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3027076721191406  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30913734436035156  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3093991279602051  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3093991279602051  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3094954490661621  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31431150436401367  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3144345283508301  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3144345283508301  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31447744369506836  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3169236183166504  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3169984817504883  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3169984817504883  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3170204162597656  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31839847564697266  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([13, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31908178329467773  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31908178329467773  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31922101974487305  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32909250259399414  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32637929916381836  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3265109062194824  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3266739845275879  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32681846618652344  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32681846618652344  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3268280029296875  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.326904296875  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32691335678100586  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32691335678100586  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32692670822143555  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32712697982788086  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3271322250366211  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3271322250366211  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32713985443115234  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32730770111083984  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3273310661315918  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3273310661315918  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3273444175720215  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3277316093444824  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32775402069091797  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32775402069091797  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32776546478271484  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32817745208740234  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3281893730163574  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3281893730163574  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32819509506225586  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32844114303588867  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32845211029052734  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32845211029052734  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32845592498779297  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3286466598510742  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32865381240844727  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32865381240844727  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3286557197570801  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3287777900695801  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32867431640625  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3286752700805664  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3286747932434082  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3286762237548828  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27325868606567383  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2772231101989746  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2772231101989746  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2773623466491699  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2784748077392578  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2786722183227539  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2786722183227539  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27893924713134766  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2829446792602539  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([23, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28317975997924805  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28317975997924805  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28342580795288086  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2888302803039551  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([30, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28934812545776367  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28934812545776367  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28966856002807617  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29896116256713867  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([21, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2993617057800293  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2993617057800293  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29958677291870117  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30766773223876953  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([18, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3081321716308594  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3081321716308594  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30832481384277344  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31659984588623047  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3168773651123047  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3168773651123047  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3169841766357422  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3223247528076172  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32244253158569336  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32244253158569336  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32248544692993164  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32493162155151367  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32500648498535156  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32500648498535156  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3250284194946289  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32640647888183594  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([14, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32714319229125977  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32714319229125977  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32729291915893555  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3379092216491699  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33480215072631836  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33495473861694336  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33514404296875  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3352952003479004  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3352952003479004  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33530664443969727  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33539819717407227  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33540821075439453  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33540821075439453  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33542346954345703  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33565235137939453  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3356623649597168  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3356623649597168  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33567380905151367  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3359255790710449  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3359508514404297  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3359508514404297  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3359661102294922  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3364086151123047  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3364109992980957  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3364109992980957  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33641481399536133  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33655214309692383  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33655643463134766  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33655643463134766  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33655834197998047  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3366403579711914  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33664655685424805  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33664655685424805  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33664846420288086  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3367438316345215  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33675193786621094  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33675193786621094  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33675384521484375  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33687591552734375  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3368849754333496  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3368849754333496  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3368868827819824  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3370223045349121  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3370399475097656  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3370399475097656  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33704185485839844  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3372974395751953  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3371882438659668  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3371891975402832  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.337188720703125  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3371901512145996  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

pure train time  0.5469012260437012
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2732706069946289  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8554491996765137
loading full batch data spends  0.00765681266784668
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.891 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.891 GB
Metis partitioning: 0.001 seconds, peak memory: 24.891 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.006173849105834961
pure dgl.metis_partition the time spent:  0.00344085693359375

block_gen_time in "generate_blocks_for_one_layer_block"  0.006991386413574219


block_gen_time in "generate_blocks_for_one_layer_block"  0.008802175521850586

connection checking time:  0.007430076599121094
block generation total time  0.015793561935424805
generate_dataloader_block spend   0.037198543548583984
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.27317047119140625  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

--------------------------m.shape torch.Size([6, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2790985107421875  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2790985107421875  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2791633605957031  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2796778678894043  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([22, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2798805236816406  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2798805236816406  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28011608123779297  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2836437225341797  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([28, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28397464752197266  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.28397464752197266  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2842741012573242  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29085350036621094  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([32, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29138708114624023  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.29138708114624023  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.2917294502258301  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30164098739624023  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([31, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30229759216308594  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.30229759216308594  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3026294708251953  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31455564498901367  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31487035751342773  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.31487035751342773  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.315030574798584  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32191991806030273  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3222513198852539  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3222513198852539  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3223695755004883  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32825231552124023  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32862043380737305  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32862043380737305  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.32872724533081055  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33481550216674805  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33500242233276367  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.33500242233276367  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3350558280944824  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3384737968444824  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([33, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3402090072631836  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3402090072631836  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3405618667602539  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3655862808227539  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36113739013671875  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36132144927978516  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36154985427856445  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

--------------------------m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3617582321166992  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3617582321166992  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36176204681396484  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36179256439208984  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3618006706237793  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3618006706237793  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36181020736694336  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3619532585144043  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.361968994140625  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.361968994140625  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3619823455810547  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3622760772705078  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3622889518737793  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3622889518737793  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36229848861694336  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36257505416870117  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3625946044921875  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3625946044921875  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36260414123535156  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3629474639892578  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3629603385925293  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3629603385925293  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36296606063842773  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36321210861206055  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3632164001464844  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3632164001464844  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3632183074951172  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3633136749267578  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3633389472961426  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3633389472961426  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.363344669342041  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.363710880279541  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3637275695800781  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3637275695800781  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36373138427734375  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3640022277832031  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.364011287689209  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.364011287689209  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3640131950378418  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36416196823120117  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36417293548583984  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36417293548583984  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36417484283447266  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3643369674682617  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36435651779174805  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36435651779174805  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36435842514038086  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3646407127380371  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.364471435546875  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.3644723892211914  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36446475982666016  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.05078125 GB
    Memory Allocated: 0.36446666717529297  GigaBytes
Max Memory Allocated: 0.4764218330383301  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2724428176879883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27633237838745117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27633237838745117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2764716148376465  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2775840759277344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([27, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2778029441833496  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2778029441833496  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2780919075012207  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28242063522338867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([38, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2828850746154785  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2828850746154785  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 38, 1433]), torch.Size([1, 38, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2832913398742676  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2922205924987793  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 38, 1433])
--------------------------m.shape torch.Size([30, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29265832901000977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29265832901000977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29297876358032227  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30227136611938477  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([20, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.302645206451416  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.302645206451416  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.302858829498291  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.310549259185791  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3109869956970215  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3109869956970215  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3111691474914551  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3189845085144043  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3192300796508789  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3192300796508789  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31932640075683594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3241424560546875  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32418012619018555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32418012619018555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3242020606994629  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32542943954467773  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3254666328430176  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3254666328430176  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32547807693481445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.326171875  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([12, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32680702209472656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32680702209472656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3269357681274414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3360481262207031  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33307409286499023  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3332352638244629  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3334355354309082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3336033821105957  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3336033821105957  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3336148262023926  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3337063789367676  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3337125778198242  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3337125778198242  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3337240219116211  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3338956832885742  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33391904830932617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33391904830932617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3339381217956543  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33435773849487305  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3343791961669922  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3343791961669922  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3343944549560547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3348369598388672  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3348393440246582  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3348393440246582  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33484315872192383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33498048782348633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33498477935791016  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33498477935791016  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33498668670654297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3350687026977539  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3350796699523926  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3350796699523926  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3350815773010254  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33524370193481445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33526134490966797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33526134490966797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3352632522583008  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33551883697509766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3355422019958496  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3355422019958496  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3355441093444824  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3358798027038574  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3357548713684082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3357558250427246  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3357553482055664  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.335756778717041  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2719106674194336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([14, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2755441665649414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2755441665649414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2756938934326172  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27689027786254883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([18, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.277008056640625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.277008056640625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27720069885253906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2800874710083008  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([20, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28031158447265625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28031158447265625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28052520751953125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28522491455078125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([27, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28569507598876953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28569507598876953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2859840393066406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29435253143310547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([25, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2948756217956543  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2948756217956543  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29514265060424805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30475568771362305  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3049745559692383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3049745559692383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30509281158447266  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3101520538330078  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3102426528930664  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3102426528930664  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3102855682373047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31243133544921875  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31270885467529297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31270885467529297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31278419494628906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31705570220947266  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3170661926269531  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3170661926269531  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31707763671875  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31777143478393555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([16, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3186202049255371  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3186202049255371  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31879186630249023  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33093690872192383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3280630111694336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3281993865966797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3283686637878418  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3285384178161621  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3285384178161621  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32854604721069336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32860708236694336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3286094665527344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3286094665527344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3286151885986328  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3287010192871094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32871294021606445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32871294021606445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3287224769592285  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3289322853088379  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32895851135253906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32895851135253906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32897377014160156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32941627502441406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32943296432495117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32943296432495117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32944250106811523  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3297858238220215  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3298044204711914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3298044204711914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32981204986572266  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3301401138305664  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3301520347595215  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3301520347595215  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3301558494567871  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33037328720092773  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3303804397583008  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3303804397583008  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3303823471069336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3305044174194336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33052778244018555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33052778244018555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33052968978881836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33086538314819336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3307337760925293  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3307347297668457  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3307342529296875  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3307356834411621  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27245521545410156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2761096954345703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2761096954345703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2762489318847656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2773613929748535  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([30, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27761220932006836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27761220932006836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27793264389038086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28273916244506836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([18, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.282867431640625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.282867431640625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28306007385253906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2872939109802246  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28766775131225586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28766775131225586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2879033088684082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2947230339050293  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29500579833984375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29500579833984375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.295166015625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.300933837890625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30136632919311523  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30136632919311523  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30153799057006836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30889368057250977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30925655364990234  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30925655364990234  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3093852996826172  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31580257415771484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31586647033691406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31586647033691406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3158988952636719  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3177356719970703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3177676200866699  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3177676200866699  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3177790641784668  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31847286224365234  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([11, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31905460357666016  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31905460357666016  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31917285919189453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3275260925292969  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32464122772216797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32477569580078125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32494258880615234  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32507896423339844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32507896423339844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32509422302246094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32521629333496094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32523012161254883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32523012161254883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32525110244750977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32556581497192383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32556724548339844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32556724548339844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3255748748779297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3257427215576172  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3257431983947754  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3257431983947754  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3257451057434082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32580041885375977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32581424713134766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32581424713134766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3258199691772461  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32602596282958984  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32604074478149414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32604074478149414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3260464668273926  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3262925148010254  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3263101577758789  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3263101577758789  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32631587982177734  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3266019821166992  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32660722732543945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32660722732543945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32660913467407227  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3267178535461426  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32672691345214844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32672691345214844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32672882080078125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32686424255371094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3267707824707031  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32677173614501953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32677125930786133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32677268981933594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

pure train time  0.5414862632751465
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2724642753601074  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8078281879425049
loading full batch data spends  0.004812717437744141
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.891 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.891 GB
Metis partitioning: 0.000 seconds, peak memory: 24.891 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005006313323974609
pure dgl.metis_partition the time spent:  0.0029976367950439453

block_gen_time in "generate_blocks_for_one_layer_block"  0.006655693054199219


block_gen_time in "generate_blocks_for_one_layer_block"  0.008440256118774414

connection checking time:  0.007508754730224609
block generation total time  0.015095949172973633
generate_dataloader_block spend   0.034616947174072266
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2736949920654297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([7, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2785358428955078  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2785358428955078  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2786111831665039  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27921104431152344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27944040298461914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27944040298461914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2797074317932129  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28371286392211914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([35, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28414011001586914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28414011001586914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2845139503479004  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2927384376525879  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2931709289550781  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2931709289550781  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29348087310791016  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3024635314941406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30302953720092773  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30302953720092773  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30331850051879883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3137068748474121  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3140749931335449  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3140749931335449  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31424665451049805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32160234451293945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32181549072265625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32181549072265625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3219013214111328  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32618284225463867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([8, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32648181915283203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32648181915283203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3265676498413086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3314485549926758  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33159828186035156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33159828186035156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33164119720458984  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33438777923583984  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([23, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33597850799560547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33597850799560547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3362245559692383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3536653518676758  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3497195243835449  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34989309310913086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35010862350463867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35030317306518555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35030317306518555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.350308895111084  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3503546714782715  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3503580093383789  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3503580093383789  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35036373138427734  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3504495620727539  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35047292709350586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35047292709350586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35049009323120117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35086774826049805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3508749008178711  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3508749008178711  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35088253021240234  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3511037826538086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35111474990844727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35111474990844727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3511204719543457  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35132646560668945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3513469696044922  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3513469696044922  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35135459899902344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3516826629638672  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3516860008239746  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3516860008239746  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3516879081726074  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35178327560424805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3518085479736328  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3518085479736328  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35181427001953125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35218048095703125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35219717025756836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35219717025756836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.352200984954834  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35247182846069336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3524808883666992  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3524808883666992  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35248279571533203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3526315689086914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35265398025512695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35265398025512695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3526577949523926  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3529820442199707  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3528256416320801  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3528265953063965  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35282182693481445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35282373428344727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2724428176879883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([13, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2763381004333496  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2763381004333496  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2764773368835449  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2775897979736328  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([27, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27780866622924805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27780866622924805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27809762954711914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2824263572692871  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([20, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28260231018066406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28260231018066406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28281593322753906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28751564025878906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([26, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2879643440246582  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2879643440246582  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28824281692504883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29630136489868164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29656267166137695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29656267166137695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2967228889465332  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3024907112121582  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([13, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3028273582458496  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3028273582458496  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3029665946960449  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3089451789855957  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3092494010925293  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3092494010925293  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3093562126159668  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3146967887878418  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31485700607299805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31485700607299805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3149104118347168  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31795454025268555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3180241584777832  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3180241584777832  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31804609298706055  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3194241523742676  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([20, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32102537155151367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32102537155151367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32123899459838867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33640623092651367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33328819274902344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3334321975708008  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33361101150512695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3337554931640625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3337554931640625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3337669372558594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3338584899902344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33387041091918945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33387041091918945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33388757705688477  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33414506912231445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3341512680053711  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3341512680053711  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33416080474853516  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33437061309814453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3343777656555176  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3343777656555176  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.334383487701416  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3345494270324707  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33457088470458984  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33457088470458984  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3345804214477539  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33492374420166016  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33493661880493164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33493661880493164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3349423408508301  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3351883888244629  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33519935607910156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33519935607910156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3352031707763672  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33539390563964844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33541250228881836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33541250228881836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33541440963745117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3356966972351074  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33559322357177734  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33559417724609375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33559370040893555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33559513092041016  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27203893661499023  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([10, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2760138511657715  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2760138511657715  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.276120662689209  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.276975154876709  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27716732025146484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27716732025146484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27741336822509766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2810983657836914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([22, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2813277244567871  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2813277244567871  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28156328201293945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28673696517944336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([31, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28728151321411133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28728151321411133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2876133918762207  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29722070693969727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2977757453918457  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2977757453918457  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2980647087097168  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3084530830383301  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([15, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3087892532348633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3087892532348633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30894947052001953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3158388137817383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31598329544067383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31598329544067383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31604814529418945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3192605972290039  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3194847106933594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3194847106933594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.319549560546875  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.323211669921875  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3232274055480957  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3232274055480957  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3232388496398926  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3239326477050781  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([16, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3247814178466797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3247814178466797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3249530792236328  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3370981216430664  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3339357376098633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33408546447753906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3342714309692383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3344559669494629  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3344559669494629  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33446168899536133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33450746536254883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3345203399658203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3345203399658203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3345355987548828  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3347644805908203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33476877212524414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33476877212524414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3347764015197754  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3349442481994629  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33496761322021484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33496761322021484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33498096466064453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33536815643310547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33538103103637695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33538103103637695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3353886604309082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3356633186340332  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33568286895751953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33568286895751953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3356904983520508  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33601856231689453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33603811264038086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33603811264038086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3360438346862793  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33636999130249023  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3363761901855469  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3363761901855469  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3363780975341797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3365001678466797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33650922775268555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33650922775268555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33651113510131836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33664655685424805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.336669921875  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.336669921875  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3366718292236328  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3370075225830078  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33686304092407227  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33686399459838867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33686351776123047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3368649482727051  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2724571228027344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([16, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27636289596557617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27636289596557617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2765345573425293  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27790355682373047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([22, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27805280685424805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27805280685424805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2782883644104004  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2818160057067871  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([32, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2822108268737793  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2822108268737793  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28255319595336914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2900724411010742  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2903714179992676  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2903714179992676  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2906069755554199  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.297426700592041  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([22, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2978963851928711  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2978963851928711  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29813194274902344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3065977096557617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3070244789123535  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3070244789123535  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3072066307067871  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31502199172973633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31537961959838867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31537961959838867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3155083656311035  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32192564010620117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([4, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32203245162963867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32203245162963867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32207536697387695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.324521541595459  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32454824447631836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32454824447631836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32455968856811523  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3252534866333008  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([13, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3259420394897461  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3259420394897461  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3260812759399414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3359527587890625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3329296112060547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3330831527709961  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33327388763427734  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33343076705932617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33343076705932617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33344602584838867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33356809616088867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3335704803466797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3335704803466797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33358001708984375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3337230682373047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3337416648864746  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3337416648864746  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3337569236755371  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3340926170349121  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33411598205566406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33411598205566406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33413124084472656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33457374572753906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3345808982849121  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3345808982849121  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33458662033081055  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3347926139831543  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3347969055175781  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3347969055175781  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33479881286621094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33489418029785156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3349118232727051  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3349118232727051  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3349137306213379  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33516931533813477  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3351926803588867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3351926803588867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33519458770751953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33553028106689453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3354172706604004  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3354182243347168  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3354177474975586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3354191780090332  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

pure train time  0.5030407905578613
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27246904373168945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7970378398895264
loading full batch data spends  0.006052494049072266
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.891 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.891 GB
Metis partitioning: 0.000 seconds, peak memory: 24.891 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005797624588012695
pure dgl.metis_partition the time spent:  0.0029888153076171875

block_gen_time in "generate_blocks_for_one_layer_block"  0.0055637359619140625


block_gen_time in "generate_blocks_for_one_layer_block"  0.006509542465209961

connection checking time:  0.0054247379302978516
block generation total time  0.012073278427124023
generate_dataloader_block spend   0.030537128448486328
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2736988067626953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([8, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27871179580688477  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27871179580688477  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27879762649536133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2794828414916992  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([36, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27982473373413086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27982473373413086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 36, 1433]), torch.Size([1, 36, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.280210018157959  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2859807014465332  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 36, 1433])
--------------------------m.shape torch.Size([40, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28642892837524414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28642892837524414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 40, 1433]), torch.Size([1, 40, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28685617446899414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29625558853149414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 40, 1433])
--------------------------m.shape torch.Size([37, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2968320846557617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2968320846557617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2972278594970703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3086881637573242  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([20, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3090243339538574  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3090243339538574  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3092379570007324  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3169283866882324  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3173341751098633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3173341751098633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3175058364868164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3248615264892578  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32518720626831055  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32518720626831055  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3253054618835449  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3311882019042969  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3313426971435547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3313426971435547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33139610290527344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3344402313232422  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3346538543701172  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3346538543701172  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33470726013183594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33812522888183594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([22, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33971071243286133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33971071243286133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33994626998901367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3566422462463379  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.352632999420166  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35282373428344727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.353060245513916  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35326719284057617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35326719284057617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35327672958374023  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35335302352905273  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3533658981323242  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3533658981323242  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35338306427001953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3536405563354492  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3536553382873535  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3536553382873535  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.353670597076416  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.354006290435791  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3540067672729492  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3540067672729492  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35401058197021484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35412120819091797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35413408279418945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35413408279418945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3541398048400879  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35434579849243164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35434913635253906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35434913635253906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3543510437011719  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3544330596923828  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35443925857543945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35443925857543945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35444116592407227  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3545365333557129  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35455322265625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35455322265625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3545570373535156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3548011779785156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3548092842102051  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3548092842102051  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3548111915588379  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3549466133117676  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35495758056640625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35495758056640625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35495948791503906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3551216125488281  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35513925552368164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35513925552368164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35514116287231445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35539674758911133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35541629791259766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35541629791259766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35541820526123047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3557004928588867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35572385787963867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35572385787963867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3557257652282715  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3560614585876465  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3558964729309082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3558974266052246  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35588979721069336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35589170455932617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2717456817626953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([24, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2745037078857422  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2745037078857422  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27476024627685547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2768111228942871  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([20, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27689647674560547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27689647674560547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27711009979248047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28031444549560547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([15, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28044795989990234  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28044795989990234  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2806081771850586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2841329574584961  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28452301025390625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28452301025390625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2847585678100586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2915782928466797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([16, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2918877601623535  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2918877601623535  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29205942153930664  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2982177734375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([12, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29851675033569336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29851675033569336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2986454963684082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30416440963745117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([8, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3043990135192871  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3043990135192871  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30448484420776367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30876636505126953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3088517189025879  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3088517189025879  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3088841438293457  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31072092056274414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([6, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31102514266967773  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31102514266967773  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31108999252319336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31565141677856445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31366634368896484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31378650665283203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3139357566833496  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3140525817871094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3140525817871094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3140716552734375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3142242431640625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31422853469848633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31422853469848633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.314241886138916  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31444215774536133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3144502639770508  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3144502639770508  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31445980072021484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3146696090698242  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31468820571899414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31468820571899414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.314699649810791  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3150315284729004  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3150501251220703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3150501251220703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3150596618652344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3154029846191406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31541013717651367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31541013717651367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3154139518737793  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31557798385620117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3155050277709961  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3155059814453125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3155055046081543  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3155069351196289  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2729344367980957  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([7, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2778029441833496  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2778029441833496  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2778782844543457  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27847814559936523  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([23, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2786860466003418  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2786860466003418  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2789320945739746  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28261709213256836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2829108238220215  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2829108238220215  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2831892967224121  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2893028259277344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([26, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2897191047668457  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2897191047668457  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28999757766723633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29805612564086914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([28, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29866456985473633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29866456985473633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2989640235900879  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30973005294799805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31022119522094727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31022119522094727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31043481826782227  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31962060928344727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([13, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31999969482421875  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31999969482421875  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32013893127441406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3270907402038574  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3273200988769531  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3273200988769531  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3273954391479492  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3316669464111328  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3317255973815918  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3317255973815918  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33174753189086914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33312559127807617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([24, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33472681045532227  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33472681045532227  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33498334884643555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3531832695007324  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34917306900024414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34934091567993164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3495492935180664  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34973621368408203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34973621368408203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34974002838134766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34977054595947266  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3497805595397949  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3497805595397949  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3497920036315918  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3499636650085449  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3499755859375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3499755859375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3499870300292969  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3502388000488281  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35026025772094727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35026025772094727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35027360916137695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3506608009338379  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3506641387939453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3506641387939453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35066795349121094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35080528259277344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.350832462310791  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.350832462310791  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3508419990539551  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35125207901000977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35126781463623047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35126781463623047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3512735366821289  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3515596389770508  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3515658378601074  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3515658378601074  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35156774520874023  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35168981552124023  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35170841217041016  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35170841217041016  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3517122268676758  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35198307037353516  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.351992130279541  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.351992130279541  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35199403762817383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3521428108215332  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3521537780761719  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3521537780761719  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3521556854248047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35231781005859375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3521699905395508  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3521709442138672  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.352170467376709  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3521718978881836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2720317840576172  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([7, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2758469581604004  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2758469581604004  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2759222984313965  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.276522159576416  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([18, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27667713165283203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27667713165283203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2768697738647461  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2797565460205078  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([27, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.280092716217041  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.280092716217041  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2803816795349121  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2867302894592285  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([24, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28709840774536133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28709840774536133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2873549461364746  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29478883743286133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([24, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2953014373779297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2953014373779297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29555797576904297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30478620529174805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3050103187561035  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3050103187561035  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3051285743713379  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31018781661987305  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31035327911376953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31035327911376953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31041812896728516  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3136305809020996  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31389713287353516  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31389713287353516  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31397247314453125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31824398040771484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3182544708251953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3182544708251953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3182659149169922  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31895971298217773  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([19, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3201451301574707  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3201451301574707  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32034826278686523  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33475637435913086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3316535949707031  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3317909240722656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33196115493774414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33213281631469727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33213281631469727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3321385383605957  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3321843147277832  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3321876525878906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3321876525878906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33219337463378906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3322792053222656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33229684829711914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33229684829711914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33231019973754883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33260393142700195  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3326244354248047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3326244354248047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3326377868652344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3330249786376953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33304262161254883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33304262161254883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3330521583557129  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33339548110961914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3334083557128906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3334083557128906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33341407775878906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3336601257324219  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3336806297302246  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3336806297302246  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33368635177612305  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.334012508392334  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3340187072753906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3340187072753906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33402061462402344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33414268493652344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3341660499572754  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3341660499572754  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3341679573059082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3345036506652832  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3343691825866699  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33437013626098633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3343696594238281  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33437108993530273  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

pure train time  0.49297499656677246
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27204370498657227  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7551666498184204
loading full batch data spends  0.007761955261230469
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.891 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.891 GB
Metis partitioning: 0.000 seconds, peak memory: 24.891 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004352569580078125
pure dgl.metis_partition the time spent:  0.0034856796264648438

block_gen_time in "generate_blocks_for_one_layer_block"  0.006930351257324219


block_gen_time in "generate_blocks_for_one_layer_block"  0.008632898330688477

connection checking time:  0.00770115852355957
block generation total time  0.015563249588012695
generate_dataloader_block spend   0.03543686866760254
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27292871475219727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27734804153442383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27734804153442383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2774662971496582  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2784080505371094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([14, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27849864959716797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27849864959716797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27864837646484375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28089141845703125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([24, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2812013626098633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2812013626098633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28145790100097656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2870974540710449  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([30, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2876100540161133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2876100540161133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2879304885864258  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2972230911254883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([23, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29767704010009766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29767704010009766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29792308807373047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3067665100097656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30699586868286133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30699586868286133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3071141242980957  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31217336654663086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3124508857727051  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3124508857727051  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3125472068786621  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31736326217651367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31774234771728516  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31774234771728516  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31784915924072266  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32393741607666016  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32402849197387695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32402849197387695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32406091690063477  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3261232376098633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([23, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32771921157836914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32771921157836914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32796525955200195  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34540605545043945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34177494049072266  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34192562103271484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34211254119873047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34229421615600586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34229421615600586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34230756759643555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34241437911987305  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34241580963134766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34241580963134766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3424234390258789  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34253787994384766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34255456924438477  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34255456924438477  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34256792068481445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3428616523742676  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34287071228027344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34287071228027344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3428783416748047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34309959411621094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34311532974243164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34311532974243164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3431229591369629  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3433976173400879  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3434114456176758  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3434114456176758  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3434171676635742  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34366321563720703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34366941452026367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34366941452026367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3436713218688965  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3437933921813965  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3438119888305664  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3438119888305664  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34381580352783203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3440866470336914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34410810470581055  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34410810470581055  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34411191940307617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3444361686706543  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3444547653198242  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3444547653198242  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34445667266845703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3447389602661133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34460020065307617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446011543273926  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34459352493286133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34459543228149414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27321290969848633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([9, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27759456634521484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27759456634521484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2776908874511719  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2784614562988281  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([27, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2787017822265625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2787017822265625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2789907455444336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28331947326660156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([31, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28367185592651367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28367185592651367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28400373458862305  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2912921905517578  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([25, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2916603088378906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2916603088378906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2919273376464844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2996711730957031  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3002586364746094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3002586364746094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30054759979248047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31093597412109375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31133604049682617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31133604049682617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31151819229125977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.319333553314209  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([3, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3193550109863281  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3193550109863281  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31938743591308594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3209986686706543  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([8, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32132434844970703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32132434844970703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3214101791381836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3262910842895508  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.326296329498291  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.326296329498291  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3263077735900879  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32700157165527344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([22, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32860803604125977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32860803604125977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3288435935974121  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34553956985473633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34200429916381836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3421664237976074  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34236764907836914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3425564765930176  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3425564765930176  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.342562198638916  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3426079750061035  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34261512756347656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34261512756347656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3426246643066406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34276771545410156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34278345108032227  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34278345108032227  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34279680252075195  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3430905342102051  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34310340881347656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34310340881347656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3431129455566406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34338951110839844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34340429306030273  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34340429306030273  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.343411922454834  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.343686580657959  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3437061309814453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3437061309814453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34371376037597656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3440418243408203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34404516220092773  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34404516220092773  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34404706954956055  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34414243698120117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3441648483276367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3441648483276367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34417057037353516  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3444967269897461  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34450292587280273  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34450292587280273  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34450483322143555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34462690353393555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446369171142578  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446369171142578  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446388244628906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34478759765625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34481096267700195  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34481096267700195  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34481287002563477  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34514856338500977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.344998836517334  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3449997901916504  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3449993133544922  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3450007438659668  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2729358673095703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([10, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2770228385925293  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2770228385925293  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2771296501159668  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2779841423034668  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([27, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27821922302246094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27821922302246094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27850818634033203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2828369140625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([27, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2831249237060547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2831249237060547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2834138870239258  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2897624969482422  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([28, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29021596908569336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29021596908569336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2905154228210449  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29918813705444336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([14, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29941225051879883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29941225051879883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2995619773864746  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3049449920654297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([20, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3055109977722168  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3055109977722168  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3057246208190918  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3149104118347168  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([13, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3152894973754883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3152894973754883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3154287338256836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32238054275512695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32243919372558594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32243919372558594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32247161865234375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3243083953857422  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3243403434753418  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3243403434753418  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32435178756713867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3250455856323242  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([18, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3260011672973633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3260011672973633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32619380950927734  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3398571014404297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3365945816040039  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3367481231689453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33693885803222656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33708858489990234  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33708858489990234  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33709239959716797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33712291717529297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33713674545288086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33713674545288086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33715200424194336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33738088607788086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3373994827270508  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3373994827270508  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3374166488647461  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33779430389404297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33782434463500977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33782434463500977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3378434181213379  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3383965492248535  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3383970260620117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3383970260620117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33840084075927734  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33853816986083984  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33854246139526367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33854246139526367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3385443687438965  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3386263847351074  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33863258361816406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33863258361816406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3386344909667969  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3387298583984375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33873891830444336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33873891830444336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33874082565307617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33887624740600586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3388938903808594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3388938903808594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3388957977294922  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33915138244628906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33903980255126953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33904075622558594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33904027938842773  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33904170989990234  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2722434997558594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([15, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2761702537536621  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2761702537536621  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27633047103881836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27761220932006836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([28, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2778310775756836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2778310775756836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27813053131103516  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28261661529541016  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([29, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2829313278198242  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2829313278198242  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28324127197265625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2900557518005371  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([28, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2904987335205078  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2904987335205078  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2907981872558594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2994709014892578  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([26, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3000154495239258  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3000154495239258  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3002939224243164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31029748916625977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3106708526611328  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3106708526611328  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31084251403808594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31819820404052734  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3185238838195801  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3185238838195801  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31864213943481445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3245248794555664  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([2, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3245515823364258  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3245515823364258  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3245735168457031  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32580089569091797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32593441009521484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32593441009521484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32596683502197266  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32802915573120117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32854700088500977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32854700088500977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32865381240844727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33623743057250977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33324146270751953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3334016799926758  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3336005210876465  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33376359939575195  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33376359939575195  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33377885818481445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33390092849731445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3339090347290039  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3339090347290039  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3339242935180664  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3341531753540039  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3341546058654785  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3341546058654785  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33416032791137695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3342862129211426  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33429527282714844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33429527282714844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3343009948730469  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33446693420410156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3344883918762207  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3344883918762207  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33449792861938477  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.334841251373291  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3348541259765625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3348541259765625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33485984802246094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33510589599609375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3351168632507324  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3351168632507324  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33512067794799805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3353114128112793  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3353271484375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3353271484375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3353309631347656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3355751037597656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33559751510620117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33559751510620117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.335599422454834  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.335935115814209  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3358159065246582  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3358168601989746  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3358163833618164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.335817813873291  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

pure train time  0.5420513153076172
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27225542068481445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6966705322265625
loading full batch data spends  0.0049533843994140625
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.891 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.891 GB
Metis partitioning: 0.000 seconds, peak memory: 24.891 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005058765411376953
pure dgl.metis_partition the time spent:  0.003222227096557617

block_gen_time in "generate_blocks_for_one_layer_block"  0.006691694259643555


block_gen_time in "generate_blocks_for_one_layer_block"  0.008424043655395508

connection checking time:  0.00738978385925293
block generation total time  0.015115737915039062
generate_dataloader_block spend   0.034940242767333984
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27304697036743164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([8, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27898454666137695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27898454666137695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2790703773498535  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2797555923461914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([27, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.280001163482666  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.280001163482666  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2802901268005371  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2846188545227051  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([34, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2850189208984375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2850189208984375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2853822708129883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29337167739868164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([29, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2938094139099121  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2938094139099121  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29411935806274414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3031020164489746  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([27, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3036680221557617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3036680221557617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3039569854736328  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3143453598022461  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([16, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3147134780883789  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3147134780883789  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31488513946533203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32224082946777344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.322603702545166  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.322603702545166  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32273244857788086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3291497230529785  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.329470157623291  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.329470157623291  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32956647872924805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33505678176879883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33515310287475586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33515310287475586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33518552780151367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3372478485107422  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([30, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33884382247924805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33884382247924805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33916425704956055  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36191511154174805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35691213607788086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3570981025695801  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3573288917541504  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35754871368408203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35754871368408203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35755443572998047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35760021209716797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3576054573059082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3576054573059082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35761308670043945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3577275276184082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35775279998779297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35775279998779297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3577718734741211  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35819149017333984  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3581976890563965  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3581976890563965  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35820531845092773  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.358426570892334  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3584423065185547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3584423065185547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35844993591308594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35872459411621094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35873842239379883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35873842239379883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35874414443969727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3589901924133301  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3589963912963867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3589963912963867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35899829864501953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35912036895751953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35913896560668945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35913896560668945  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3591427803039551  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35941362380981445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3594226837158203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3594226837158203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3594245910644531  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3595733642578125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35959577560424805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35959577560424805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35959959030151367  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3599238395690918  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3599424362182617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3599424362182617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.35994434356689453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3602266311645508  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36024999618530273  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36024999618530273  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36025190353393555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36058759689331055  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36040782928466797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3604087829589844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3604011535644531  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.36040306091308594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27194976806640625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([18, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2761220932006836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2761220932006836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27631473541259766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27785444259643555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([22, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27799320220947266  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27799320220947266  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.278228759765625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2817564010620117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([23, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28200721740722656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28200721740722656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2822532653808594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2876577377319336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([25, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2880687713623047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2880687713623047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28833580017089844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2960796356201172  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([18, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29642677307128906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29642677307128906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2966194152832031  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30354738235473633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([17, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30399560928344727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30399560928344727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30417776107788086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3119931221008301  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([9, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3122386932373047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3122386932373047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3123350143432617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3171510696411133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3172311782836914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3172311782836914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3172636032104492  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31910037994384766  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31913232803344727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31913232803344727  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31914377212524414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3198375701904297  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([9, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3203125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3203125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32040882110595703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32724761962890625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32390451431274414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32404279708862305  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32421445846557617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3243575096130371  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3243575096130371  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3243727684020996  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3244948387145996  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32449913024902344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32449913024902344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3245105743408203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32468223571777344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3246884346008301  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3246884346008301  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32469606399536133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32486391067504883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32488346099853516  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32488346099853516  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32489490509033203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3252267837524414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32524538040161133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32524538040161133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3252549171447754  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32559823989868164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3256111145019531  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3256111145019531  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32561683654785156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3258628845214844  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3258671760559082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3258671760559082  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.325869083404541  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32596445083618164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3259725570678711  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3259725570678711  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3259744644165039  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3260965347290039  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32610559463500977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32610559463500977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3261075019836426  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32624292373657227  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3261427879333496  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.326143741607666  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3261432647705078  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3261446952819824  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  2
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2722506523132324  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([9, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2766752243041992  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2766752243041992  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27677154541015625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2775421142578125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([20, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.277707576751709  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.277707576751709  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.277921199798584  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.281125545501709  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([25, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2814192771911621  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2814192771911621  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28168630599975586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28756093978881836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([30, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2880682945251465  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2880682945251465  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.288388729095459  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2976813316345215  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([31, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29834890365600586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29834890365600586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29868078231811523  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3106069564819336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([14, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31088972091674805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31088972091674805  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31103944778442383  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31746912002563477  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([6, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31761884689331055  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31761884689331055  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31768369674682617  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3208961486816406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32124853134155273  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32124853134155273  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32134485244750977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32683515548706055  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32688331604003906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32688331604003906  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3269052505493164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32828330993652344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([20, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32988452911376953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32988452911376953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.33009815216064453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34526538848876953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3416776657104492  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34183597564697266  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34203243255615234  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34221935272216797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34221935272216797  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3422269821166992  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3422880172729492  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34229040145874023  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34229040145874023  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34229612350463867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34238195419311523  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3423938751220703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3423938751220703  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3424034118652344  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34261322021484375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3426394462585449  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3426394462585449  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3426547050476074  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3430972099304199  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.343109130859375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.343109130859375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34311676025390625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34339141845703125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.343416690826416  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.343416690826416  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3434262275695801  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34383630752563477  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3438549041748047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3438549041748047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3438606262207031  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34418678283691406  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34420156478881836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34420156478881836  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.344205379486084  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.344449520111084  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34447193145751953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34447193145751953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34447383880615234  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.34480953216552734  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446626663208008  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446636199951172  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.344663143157959  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3446645736694336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

step  3
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2721371650695801  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([11, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2754230499267578  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2754230499267578  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2755413055419922  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27648305892944336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([28, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27672290802001953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27672290802001953  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2770223617553711  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2815084457397461  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([25, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28175926208496094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28175926208496094  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2820262908935547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2879009246826172  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([25, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2883014678955078  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2883014678955078  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.28856849670410156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2963123321533203  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([14, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2965526580810547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.2965526580810547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.29670238494873047  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30208539962768555  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30236291885375977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30236291885375977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30248117446899414  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3075404167175293  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([10, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30785512924194336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30785512924194336  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.30796194076538086  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31330251693725586  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31337738037109375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31337738037109375  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31340980529785156  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31524658203125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3153266906738281  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3153266906738281  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31534862518310547  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3167266845703125  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([11, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3173031806945801  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3173031806945801  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.31742143630981445  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3257746696472168  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3232431411743164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3233766555786133  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32354211807250977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

--------------------------m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3236708641052246  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3236708641052246  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32368040084838867  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32375669479370117  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3237752914428711  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3237752914428711  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32379817962646484  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3241415023803711  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32415056228637695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32415056228637695  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32416391372680664  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32445764541625977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3244667053222656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3244667053222656  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3244743347167969  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3246955871582031  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32470178604125977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32470178604125977  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3247056007385254  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3248429298400879  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3248615264892578  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3248615264892578  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32486724853515625  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3251533508300781  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32516908645629883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32516908645629883  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32517099380493164  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.3254265785217285  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32533693313598633  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32533788681030273  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32533740997314453  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.32533884048461914  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

pure train time  0.5296175479888916
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.0546875 GB
    Memory Allocated: 0.27214622497558594  GigaBytes
Max Memory Allocated: 0.48051023483276367  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6568458080291748
Total (block generation + training)time/epoch 0.6353423595428467
pure train time/epoch 0.5260120232899984

num_input_list  [1625, 1748, 1682, 1641, 1671, 1684, 1691, 1663, 1669, 1653]
