main start at this time 1697831472.847714
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
random partition time  0.0019297599792480469

block_gen_time in "generate_blocks_for_one_layer_block"  0.004714012145996094


block_gen_time in "generate_blocks_for_one_layer_block"  0.005655527114868164

connection checking time:  0.004940986633300781
block generation total time  0.005655527114868164
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.515625 GB
    Memory Allocated: 0.07154178619384766  GigaBytes
Max Memory Allocated: 0.07154178619384766  GigaBytes

--------------------------m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.07969999313354492  GigaBytes
Max Memory Allocated: 0.07970094680786133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.07969999313354492  GigaBytes
Max Memory Allocated: 0.07970094680786133  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.07991361618041992  GigaBytes
Max Memory Allocated: 0.07991361618041992  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.607421875 GB
    Memory Allocated: 0.08162260055541992  GigaBytes
Max Memory Allocated: 0.08172941207885742  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([61, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.607421875 GB
    Memory Allocated: 0.08216714859008789  GigaBytes
Max Memory Allocated: 0.0821685791015625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.607421875 GB
    Memory Allocated: 0.08216714859008789  GigaBytes
Max Memory Allocated: 0.0821685791015625  GigaBytes

 h.shape torch.Size([1, 61, 1433]), torch.Size([1, 61, 1433])
----------------------------------------3
 Nvidia-smi: 1.607421875 GB
    Memory Allocated: 0.08281850814819336  GigaBytes
Max Memory Allocated: 0.08281850814819336  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.630859375 GB
    Memory Allocated: 0.09318399429321289  GigaBytes
Max Memory Allocated: 0.09383535385131836  GigaBytes

rst.shape  torch.Size([1, 61, 1433])
--------------------------m.shape torch.Size([50, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.630859375 GB
    Memory Allocated: 0.0936594009399414  GigaBytes
Max Memory Allocated: 0.09383535385131836  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.630859375 GB
    Memory Allocated: 0.0936594009399414  GigaBytes
Max Memory Allocated: 0.09383535385131836  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 1.630859375 GB
    Memory Allocated: 0.0941934585571289  GigaBytes
Max Memory Allocated: 0.0941934585571289  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.634765625 GB
    Memory Allocated: 0.1059427261352539  GigaBytes
Max Memory Allocated: 0.10674381256103516  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([56, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.634765625 GB
    Memory Allocated: 0.1068716049194336  GigaBytes
Max Memory Allocated: 0.10687446594238281  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.634765625 GB
    Memory Allocated: 0.1068716049194336  GigaBytes
Max Memory Allocated: 0.10687446594238281  GigaBytes

 h.shape torch.Size([1, 56, 1433]), torch.Size([1, 56, 1433])
----------------------------------------3
 Nvidia-smi: 1.634765625 GB
    Memory Allocated: 0.10746955871582031  GigaBytes
Max Memory Allocated: 0.10746955871582031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.65625 GB
    Memory Allocated: 0.12484073638916016  GigaBytes
Max Memory Allocated: 0.1260366439819336  GigaBytes

rst.shape  torch.Size([1, 56, 1433])
--------------------------m.shape torch.Size([44, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.65625 GB
    Memory Allocated: 0.1257162094116211  GigaBytes
Max Memory Allocated: 0.1260366439819336  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.65625 GB
    Memory Allocated: 0.1257162094116211  GigaBytes
Max Memory Allocated: 0.1260366439819336  GigaBytes

 h.shape torch.Size([1, 44, 1433]), torch.Size([1, 44, 1433])
----------------------------------------3
 Nvidia-smi: 1.65625 GB
    Memory Allocated: 0.12618637084960938  GigaBytes
Max Memory Allocated: 0.12618637084960938  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.673828125 GB
    Memory Allocated: 0.14310503005981445  GigaBytes
Max Memory Allocated: 0.14427947998046875  GigaBytes

rst.shape  torch.Size([1, 44, 1433])
--------------------------m.shape torch.Size([30, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.67578125 GB
    Memory Allocated: 0.1438312530517578  GigaBytes
Max Memory Allocated: 0.14427947998046875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.67578125 GB
    Memory Allocated: 0.1438312530517578  GigaBytes
Max Memory Allocated: 0.14427947998046875  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 1.67578125 GB
    Memory Allocated: 0.1441516876220703  GigaBytes
Max Memory Allocated: 0.14427947998046875  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.1579303741455078  GigaBytes
Max Memory Allocated: 0.1588916778564453  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([17, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15840578079223633  GigaBytes
Max Memory Allocated: 0.1588916778564453  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15840578079223633  GigaBytes
Max Memory Allocated: 0.1588916778564453  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 1.689453125 GB
    Memory Allocated: 0.15858793258666992  GigaBytes
Max Memory Allocated: 0.1588916778564453  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.69921875 GB
    Memory Allocated: 0.16767549514770508  GigaBytes
Max Memory Allocated: 0.16831111907958984  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.69921875 GB
    Memory Allocated: 0.16801166534423828  GigaBytes
Max Memory Allocated: 0.16831111907958984  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.69921875 GB
    Memory Allocated: 0.16801166534423828  GigaBytes
Max Memory Allocated: 0.16831111907958984  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 1.69921875 GB
    Memory Allocated: 0.16811847686767578  GigaBytes
Max Memory Allocated: 0.16831111907958984  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.705078125 GB
    Memory Allocated: 0.17420673370361328  GigaBytes
Max Memory Allocated: 0.17463397979736328  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.705078125 GB
    Memory Allocated: 0.17429780960083008  GigaBytes
Max Memory Allocated: 0.17463397979736328  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.705078125 GB
    Memory Allocated: 0.17429780960083008  GigaBytes
Max Memory Allocated: 0.17463397979736328  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 1.705078125 GB
    Memory Allocated: 0.1743302345275879  GigaBytes
Max Memory Allocated: 0.17463397979736328  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.70703125 GB
    Memory Allocated: 0.1763925552368164  GigaBytes
Max Memory Allocated: 0.17653703689575195  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([36, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.70703125 GB
    Memory Allocated: 0.1782984733581543  GigaBytes
Max Memory Allocated: 0.17830276489257812  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.70703125 GB
    Memory Allocated: 0.1782984733581543  GigaBytes
Max Memory Allocated: 0.17830276489257812  GigaBytes

 h.shape torch.Size([1, 36, 1433]), torch.Size([1, 36, 1433])
----------------------------------------3
 Nvidia-smi: 1.70703125 GB
    Memory Allocated: 0.17868375778198242  GigaBytes
Max Memory Allocated: 0.17868375778198242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20599603652954102  GigaBytes
Max Memory Allocated: 0.2079181671142578  GigaBytes

rst.shape  torch.Size([1, 36, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.19951486587524414  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.19982671737670898  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20021390914916992  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20054054260253906  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20054054260253906  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20055580139160156  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20067787170410156  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([17, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20070314407348633  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20070314407348633  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20073556900024414  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20122194290161133  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 17, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20124340057373047  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20124340057373047  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20126819610595703  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.2018136978149414  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20184755325317383  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20184755325317383  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20187044143676758  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20253419876098633  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.2025470733642578  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.2025470733642578  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20255661010742188  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20289993286132812  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20291852951049805  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20291852951049805  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.2029261589050293  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20325422286987305  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20327091217041016  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20327091217041016  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.2032766342163086  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20356273651123047  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.2035679817199707  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.2035679817199707  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20356988906860352  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20367860794067383  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20368671417236328  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20368671417236328  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.2036886215209961  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.2038106918334961  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20382928848266602  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20382928848266602  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20383310317993164  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20410394668579102  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20411300659179688  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20411300659179688  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.2041149139404297  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20426368713378906  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20427465438842773  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20427465438842773  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20427656173706055  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.2044386863708496  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20448589324951172  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20448589324951172  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20448970794677734  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.736328125 GB
    Memory Allocated: 0.20516109466552734  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.73828125 GB
    Memory Allocated: 0.20491266250610352  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.73828125 GB
    Memory Allocated: 0.20491456985473633  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.73828125 GB
    Memory Allocated: 0.20491552352905273  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.73828125 GB
    Memory Allocated: 0.20491838455200195  GigaBytes
Max Memory Allocated: 0.21104049682617188  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.14033079147338867  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

--------------------------m.shape torch.Size([25, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.14999628067016602  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.14999628067016602  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.15026330947875977  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.15239953994750977  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([36, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.1526508331298828  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.1526508331298828  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 36, 1433]), torch.Size([1, 36, 1433])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.15303611755371094  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.15880680084228516  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 36, 1433])
--------------------------m.shape torch.Size([57, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.15952730178833008  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.15952730178833008  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.16013669967651367  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.17472600936889648  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([62, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.17574548721313477  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.17574548721313477  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 62, 1433]), torch.Size([1, 62, 1433])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.1764082908630371  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.19646310806274414  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 62, 1433])
--------------------------m.shape torch.Size([50, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.19746637344360352  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.19746637344360352  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.19800043106079102  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.21816492080688477  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([39, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2191472053527832  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2191472053527832  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 39, 1433]), torch.Size([1, 39, 1433])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.21956396102905273  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.23747587203979492  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 39, 1433])
--------------------------m.shape torch.Size([19, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2379775047302246  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2379775047302246  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.23818063735961914  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.24832725524902344  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([14, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2488236427307129  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2488236427307129  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.24897336959838867  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.25749635696411133  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([6, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.25770998001098633  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.25770998001098633  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.25777482986450195  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2618865966796875  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([48, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2644166946411133  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2644166946411133  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 48, 1433]), torch.Size([1, 48, 1433])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.26492977142333984  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.3016834259033203  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 48, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29381370544433594  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29415321350097656  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2945747375488281  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

--------------------------m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2949070930480957  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2949070930480957  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29492998123168945  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29511308670043945  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2951173782348633  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2951173782348633  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2951326370239258  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2953615188598633  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2953915596008301  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2953915596008301  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29541635513305664  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.295961856842041  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2959880828857422  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2959880828857422  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2960071563720703  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29656028747558594  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([10, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2965989112854004  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2965989112854004  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2966179847717285  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.297304630279541  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2973356246948242  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2973356246948242  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2973489761352539  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29792308807373047  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29792356491088867  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29792356491088867  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2979254722595215  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2980208396911621  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2980356216430664  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2980356216430664  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29803943634033203  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29825687408447266  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.298281192779541  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.298281192779541  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29828691482543945  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29865312576293945  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2986602783203125  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2986602783203125  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2986621856689453  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.298797607421875  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29880857467651367  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29880857467651367  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2988104820251465  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29897260665893555  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29899024963378906  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29899024963378906  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2989921569824219  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29924774169921875  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2992672920227051  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2992672920227051  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2992691993713379  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29955148696899414  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2993021011352539  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2993040084838867  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.2993030548095703  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.873046875 GB
    Memory Allocated: 0.29930543899536133  GigaBytes
Max Memory Allocated: 0.3237433433532715  GigaBytes

pure train time  0.7271709442138672
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.2754092216491699  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.944645643234253
random partition time  0.0002307891845703125

block_gen_time in "generate_blocks_for_one_layer_block"  0.005081653594970703


block_gen_time in "generate_blocks_for_one_layer_block"  0.005900382995605469

connection checking time:  0.0048449039459228516
block generation total time  0.005900382995605469
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.2748990058898926  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

--------------------------m.shape torch.Size([24, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.2839231491088867  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.2839231491088867  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.2841796875  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.28623056411743164  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([51, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.28664684295654297  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.28664684295654297  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.28719139099121094  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.2966756820678711  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([59, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.2973484992980957  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.2973484992980957  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

 h.shape torch.Size([1, 59, 1433]), torch.Size([1, 59, 1433])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.29797887802124023  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3123493194580078  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

rst.shape  torch.Size([1, 59, 1433])
--------------------------m.shape torch.Size([60, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.31331539154052734  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.31331539154052734  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

 h.shape torch.Size([1, 60, 1433]), torch.Size([1, 60, 1433])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.31395626068115234  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.33295297622680664  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

rst.shape  torch.Size([1, 60, 1433])
--------------------------m.shape torch.Size([45, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3338336944580078  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3338336944580078  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.33431434631347656  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.35161781311035156  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
--------------------------m.shape torch.Size([34, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3524665832519531  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3524665832519531  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3528299331665039  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.36844539642333984  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.36867523193359375  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.36867523193359375  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3687934875488281  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3746762275695801  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.37508726119995117  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.37508726119995117  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.37520551681518555  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3819117546081543  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([7, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3821892738342285  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3821892738342285  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3822646141052246  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.38706064224243164  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([46, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3894786834716797  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3894786834716797  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.3899698257446289  GigaBytes
Max Memory Allocated: 0.4119381904602051  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4249086380004883  GigaBytes
Max Memory Allocated: 0.4273643493652344  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.41764259338378906  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.41797447204589844  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.41838645935058594  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

--------------------------m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.41872215270996094  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.41872215270996094  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4187431335449219  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4189109802246094  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([14, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4189276695251465  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4189276695251465  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.41895437240600586  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4193549156188965  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4193706512451172  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4193706512451172  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4193897247314453  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.41980934143066406  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.41983461380004883  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.41983461380004883  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.41985177993774414  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4203495979309082  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42037487030029297  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42037487030029297  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42038822174072266  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4208688735961914  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4208970069885254  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4208970069885254  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42090845108032227  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4214005470275879  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42140865325927734  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42140865325927734  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42141246795654297  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4216032028198242  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42162466049194336  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42162466049194336  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4216303825378418  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42195653915405273  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4219799041748047  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4219799041748047  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4219856262207031  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4223518371582031  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42235898971557617  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42235898971557617  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.422360897064209  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42249631881713867  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42250633239746094  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42250633239746094  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42250823974609375  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4226570129394531  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4226679801940918  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4226679801940918  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4226698875427246  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42283201217651367  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4228496551513672  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4228496551513672  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4228515625  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4231071472167969  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4231266975402832  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4231266975402832  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.423128604888916  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42341089248657227  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.4231572151184082  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.423159122467041  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42314767837524414  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.029296875 GB
    Memory Allocated: 0.42315053939819336  GigaBytes
Max Memory Allocated: 0.4302363395690918  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.27538585662841797  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

--------------------------m.shape torch.Size([22, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2839827537536621  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2839827537536621  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28421831130981445  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.286099910736084  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([47, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2864842414855957  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2864842414855957  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2869868278503418  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29546260833740234  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([51, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29602813720703125  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29602813720703125  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2965726852416992  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30946826934814453  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([55, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31037044525146484  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31037044525146484  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3109579086303711  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3279886245727539  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([48, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3289761543273926  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3289761543273926  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 48, 1433]), torch.Size([1, 48, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32948923110961914  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34800195693969727  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 48, 1433])
--------------------------m.shape torch.Size([32, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3487706184387207  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3487706184387207  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34911298751831055  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36380910873413086  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([23, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36449766159057617  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36449766159057617  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.364743709564209  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3770260810852051  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([14, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3775010108947754  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3775010108947754  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37765073776245117  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38617372512817383  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38619518280029297  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38619518280029297  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3862171173095703  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38759517669677734  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([37, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3895597457885742  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3895597457885742  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3899555206298828  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4180126190185547  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4111199378967285  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.411435604095459  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41182756423950195  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41214942932128906  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41214942932128906  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4121665954589844  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4123039245605469  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41231679916381836  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41231679916381836  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4123377799987793  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41265249252319336  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([16, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4126882553100586  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4126882553100586  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4127187728881836  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4133901596069336  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 16, 256])
--------------------------m.shape torch.Size([13, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4134249687194824  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4134249687194824  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.413449764251709  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4141688346862793  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41419506072998047  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41419506072998047  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41421031951904297  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41475963592529297  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4147810935974121  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4147810935974121  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41479063034057617  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41520071029663086  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4152097702026367  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4152097702026367  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41521358489990234  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4154043197631836  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41541147232055664  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41541147232055664  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41541337966918945  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41553544998168945  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4155540466308594  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4155540466308594  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.415557861328125  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4158287048339844  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41583871841430664  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41583871841430664  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41584062576293945  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4160027503967285  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4160499572753906  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4160499572753906  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41605377197265625  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41672515869140625  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41648244857788086  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41648435592651367  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41648340225219727  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4164857864379883  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

pure train time  0.31656384468078613
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2754073143005371  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.92094087600708
random partition time  0.00018548965454101562

block_gen_time in "generate_blocks_for_one_layer_block"  0.00527191162109375


block_gen_time in "generate_blocks_for_one_layer_block"  0.005950212478637695

connection checking time:  0.004798412322998047
block generation total time  0.005950212478637695
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2747383117675781  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

--------------------------m.shape torch.Size([22, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28304052352905273  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28304052352905273  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2832760810852051  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2851576805114746  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([50, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28557395935058594  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28557395935058594  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28610801696777344  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29572057723999023  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([48, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2962226867675781  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2962226867675781  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 48, 1433]), torch.Size([1, 48, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2967357635498047  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3081212043762207  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 48, 1433])
--------------------------m.shape torch.Size([56, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30906057357788086  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30906057357788086  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 56, 1433]), torch.Size([1, 56, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3096585273742676  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3279080390930176  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 56, 1433])
--------------------------m.shape torch.Size([39, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32865047454833984  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32865047454833984  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 39, 1433]), torch.Size([1, 39, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3290672302246094  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34406328201293945  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 39, 1433])
--------------------------m.shape torch.Size([32, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3448801040649414  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3448801040649414  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34522247314453125  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35991859436035156  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([20, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36049509048461914  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36049509048461914  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36070871353149414  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37138986587524414  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([8, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3716249465942383  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3716249465942383  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37171077728271484  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37659168243408203  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3767414093017578  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3767414093017578  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3767843246459961  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3795309066772461  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([41, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3816986083984375  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3816986083984375  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 41, 1433]), torch.Size([1, 41, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3821372985839844  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4132413864135742  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 41, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40656185150146484  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40686702728271484  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40724611282348633  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

--------------------------m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4075489044189453  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4075489044189453  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40757179260253906  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40775489807128906  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40776872634887695  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40776872634887695  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4077935218811035  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40816545486450195  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40817928314208984  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40817928314208984  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40819644927978516  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40857410430908203  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([16, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4086270332336426  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4086270332336426  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4086575508117676  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4095425605773926  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 16, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40956592559814453  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40956592559814453  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.40958118438720703  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41013050079345703  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41014623641967773  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41014623641967773  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.410153865814209  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41048192977905273  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41049861907958984  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41049861907958984  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4105043411254883  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41079044342041016  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4107966423034668  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4107966423034668  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4107985496520996  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4109206199645996  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41093921661376953  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41093921661376953  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41094303131103516  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41121387481689453  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41123056411743164  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41123056411743164  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41123247146606445  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41148805618286133  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41150760650634766  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41150760650634766  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41150951385498047  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4117918014526367  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4115719795227051  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.4115738868713379  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.411562442779541  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.12890625 GB
    Memory Allocated: 0.41156530380249023  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2753868103027344  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

--------------------------m.shape torch.Size([24, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.28457212448120117  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.28457212448120117  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.28482866287231445  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2868795394897461  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([47, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.28725337982177734  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.28725337982177734  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.28775596618652344  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2956547737121582  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([64, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2964286804199219  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2964286804199219  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 64, 1433]), torch.Size([1, 64, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.29711246490478516  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3121471405029297  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 64, 1433])
--------------------------m.shape torch.Size([57, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.31304121017456055  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.31304121017456055  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.31365060806274414  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3316812515258789  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([52, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3327646255493164  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3327646255493164  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 52, 1433]), torch.Size([1, 52, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.33332061767578125  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3533148765563965  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 52, 1433])
--------------------------m.shape torch.Size([32, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3540620803833008  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3540620803833008  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3544044494628906  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.36910057067871094  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([18, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3696022033691406  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3696022033691406  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3697948455810547  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.37941694259643555  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([16, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3800039291381836  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3800039291381836  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3801755905151367  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3899259567260742  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3900327682495117  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3900327682495117  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.39007568359375  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.392822265625  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([41, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3949899673461914  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3949899673461914  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 41, 1433]), torch.Size([1, 41, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3954286575317383  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4265327453613281  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 41, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41982030868530273  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42015886306762695  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4205794334411621  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4209327697753906  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4209327697753906  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4209480285644531  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4210700988769531  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42108583450317383  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42108583450317383  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4211087226867676  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42145204544067383  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([17, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4214897155761719  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4214897155761719  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4215221405029297  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42223548889160156  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 17, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4222426414489746  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4222426414489746  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4222540855407715  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42258596420288086  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42261409759521484  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42261409759521484  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42262744903564453  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4231081008911133  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4231419563293457  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4231419563293457  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4231553077697754  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42372941970825195  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42372989654541016  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42372989654541016  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42373180389404297  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4238271713256836  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42384958267211914  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42384958267211914  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4238553047180176  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4241814613342285  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42420482635498047  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42420482635498047  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4242105484008789  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4245767593383789  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42458391189575195  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42458391189575195  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42458581924438477  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42472124099731445  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4247312545776367  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4247312545776367  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42473316192626953  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4248819351196289  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42490434646606445  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42490434646606445  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4249081611633301  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4252324104309082  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4252786636352539  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4252786636352539  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42528247833251953  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42595386505126953  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42567873001098633  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42568063735961914  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42567968368530273  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.42568206787109375  GigaBytes
Max Memory Allocated: 0.5360474586486816  GigaBytes

pure train time  0.310915470123291
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2754092216491699  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.902919054031372
loading full batch data spends  0.004979133605957031
random partition time  0.00016546249389648438

block_gen_time in "generate_blocks_for_one_layer_block"  0.005620479583740234


block_gen_time in "generate_blocks_for_one_layer_block"  0.005935192108154297

connection checking time:  0.004845380783081055
block generation total time  0.005935192108154297
generate_dataloader_block spend   0.020851612091064453
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2749791145324707  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

--------------------------m.shape torch.Size([18, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.28360795974731445  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.28360795974731445  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2838006019592285  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2853403091430664  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([46, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2857351303100586  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2857351303100586  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2862262725830078  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.29424238204956055  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([53, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2948460578918457  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.2948460578918457  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.295412540435791  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3082132339477539  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([61, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3092327117919922  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3092327117919922  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 61, 1433]), torch.Size([1, 61, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.30988407135009766  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.32927608489990234  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 61, 1433])
--------------------------m.shape torch.Size([40, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3300185203552246  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3300185203552246  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 40, 1433]), torch.Size([1, 40, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3304457664489746  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3458266258239746  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 40, 1433])
--------------------------m.shape torch.Size([33, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.34667015075683594  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.34667015075683594  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.34702301025390625  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3621788024902344  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([18, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.36267518997192383  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.36267518997192383  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3628678321838379  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.37248992919921875  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3728208541870117  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3728208541870117  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3729276657104492  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3790159225463867  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.37920284271240234  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.37920284271240234  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3792562484741211  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3826742172241211  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([43, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.38494300842285156  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.38494300842285156  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 43, 1433]), torch.Size([1, 43, 1433])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.3854026794433594  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4180107116699219  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 43, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4110121726989746  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41132402420043945  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4117112159729004  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

--------------------------m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41202354431152344  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41202354431152344  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4120368957519531  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4121437072753906  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41216230392456055  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41216230392456055  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4121870994567871  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41255903244018555  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([16, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41259288787841797  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41259288787841797  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41262340545654297  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41329479217529297  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 16, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41332197189331055  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41332197189331055  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4133429527282715  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41395139694213867  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4139747619628906  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4139747619628906  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4139881134033203  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41446876525878906  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41449689865112305  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41449689865112305  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4145083427429199  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41500043869018555  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4150218963623047  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4150218963623047  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41502952575683594  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41541099548339844  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.415433406829834  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.415433406829834  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4154391288757324  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4158053398132324  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41581249237060547  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41581249237060547  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4158143997192383  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41594982147216797  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41596078872680664  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41596078872680664  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41596269607543945  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4161248207092285  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41614818572998047  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41614818572998047  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4161500930786133  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4164857864379883  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41625165939331055  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.41625356674194336  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4162421226501465  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.1328125 GB
    Memory Allocated: 0.4162449836730957  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2753868103027344  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

--------------------------m.shape torch.Size([28, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2846522331237793  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2846522331237793  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28495168685913086  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28734445571899414  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([51, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28773927688598633  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28773927688598633  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2882838249206543  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29742431640625  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([55, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2980332374572754  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2980332374572754  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29862070083618164  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3120293617248535  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([55, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3129100799560547  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3129100799560547  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31349754333496094  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.331268310546875  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([55, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3324427604675293  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3324427604675293  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33303022384643555  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3541717529296875  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([36, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35503149032592773  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35503149032592773  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 36, 1433]), torch.Size([1, 36, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35541677474975586  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37195825576782227  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 36, 1433])
--------------------------m.shape torch.Size([20, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3725132942199707  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3725132942199707  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3727269172668457  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3834080696105957  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([16, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3839845657348633  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3839845657348633  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3841562271118164  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3939065933227539  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3939652442932129  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3939652442932129  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3939976692199707  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3960599899291992  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([40, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3981795310974121  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3981795310974121  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 40, 1433]), torch.Size([1, 40, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3986067771911621  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4289412498474121  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 40, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42232418060302734  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4226665496826172  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4230918884277344  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

--------------------------m.shape torch.Size([13, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42343711853027344  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42343711853027344  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4234619140625  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4236602783203125  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42367124557495117  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42367124557495117  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4236941337585449  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42403745651245117  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4240550994873047  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4240550994873047  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4240741729736328  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42449378967285156  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4245266914367676  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4245266914367676  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4245476722717285  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4251561164855957  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4251842498779297  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4251842498779297  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4251995086669922  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4257488250732422  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42577028274536133  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42577028274536133  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4257798194885254  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4261898994445801  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42620849609375  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42620849609375  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42621421813964844  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4265403747558594  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.426546573638916  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.426546573638916  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42654848098754883  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42667055130004883  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42668914794921875  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42668914794921875  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4266929626464844  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42696380615234375  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4269728660583496  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4269728660583496  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4269747734069824  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4271235466003418  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42713451385498047  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42713451385498047  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4271364212036133  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42729854583740234  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42731618881225586  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42731618881225586  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42731809616088867  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42757368087768555  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4275932312011719  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4275932312011719  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4275951385498047  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42787742614746094  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4279007911682129  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4279007911682129  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4279026985168457  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4282383918762207  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4279770851135254  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4279789924621582  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4279780387878418  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4279804229736328  GigaBytes
Max Memory Allocated: 0.5372815132141113  GigaBytes

pure train time  0.3209114074707031
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2754092216491699  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8712646961212158
loading full batch data spends  0.004012107849121094
random partition time  0.0001785755157470703

block_gen_time in "generate_blocks_for_one_layer_block"  0.004009246826171875


block_gen_time in "generate_blocks_for_one_layer_block"  0.0058820247650146484

connection checking time:  0.004717826843261719
block generation total time  0.0058820247650146484
generate_dataloader_block spend   0.019181489944458008
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2745680809020996  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([22, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2829728126525879  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2829728126525879  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28320837020874023  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28508996963500977  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([44, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2854423522949219  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2854423522949219  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 44, 1433]), torch.Size([1, 44, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28591251373291016  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29296207427978516  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 44, 1433])
--------------------------m.shape torch.Size([51, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29354381561279297  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29354381561279297  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29408836364746094  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30771541595458984  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([60, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30872440338134766  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30872440338134766  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 60, 1433]), torch.Size([1, 60, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30936527252197266  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.32827138900756836  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 60, 1433])
--------------------------m.shape torch.Size([48, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.32923221588134766  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.32923221588134766  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 48, 1433]), torch.Size([1, 48, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3297452926635742  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34825706481933594  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 48, 1433])
--------------------------m.shape torch.Size([30, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34896183013916016  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34896183013916016  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34928226470947266  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36306095123291016  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([23, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36376047134399414  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36376047134399414  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36400651931762695  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37628889083862305  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([12, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.376678466796875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.376678466796875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37680721282958984  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3841228485107422  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38425111770629883  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38425111770629883  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3842940330505371  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3870406150817871  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([33, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3887810707092285  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3887810707092285  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38913393020629883  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41415834426879883  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4074583053588867  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40777015686035156  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4081573486328125  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40848255157470703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40848255157470703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40850353240966797  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40867137908935547  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40868234634399414  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40868234634399414  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4087033271789551  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40901803970336914  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40903663635253906  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40903663635253906  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4090557098388672  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40947532653808594  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4095120429992676  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4095120429992676  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40953493118286133  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4101986885070801  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([10, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4102354049682617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4102354049682617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41025447845458984  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41094112396240234  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41096067428588867  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41096067428588867  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41097021102905273  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4113802909851074  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4113960266113281  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4113960266113281  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41140174865722656  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41168785095214844  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4117007255554199  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4117007255554199  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41170454025268555  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41192197799682617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4119291305541992  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4119291305541992  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41193103790283203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41205310821533203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41207170486450195  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41207170486450195  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4120755195617676  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41234636306762695  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4123678207397461  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4123678207397461  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4123716354370117  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41269588470458984  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4127182960510254  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4127182960510254  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4127202033996582  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4130558967590332  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4128127098083496  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4128146171569824  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41280317306518555  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41280603408813477  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2753868103027344  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([24, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2845025062561035  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2845025062561035  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2847590446472168  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28680992126464844  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([55, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28726911544799805  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28726911544799805  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2878565788269043  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2974247932434082  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([58, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29805994033813477  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29805994033813477  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 58, 1433]), torch.Size([1, 58, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29867982864379883  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31236934661865234  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 58, 1433])
--------------------------m.shape torch.Size([57, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3132767677307129  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3132767677307129  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3138861656188965  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3315415382385254  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([45, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33243799209594727  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33243799209594727  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.332918643951416  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.350222110748291  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
--------------------------m.shape torch.Size([34, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35114526748657227  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35114526748657227  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35150861740112305  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.367124080657959  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36739110946655273  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36739110946655273  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3675198554992676  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37393712997436523  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([13, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37442827224731445  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37442827224731445  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37456750869750977  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3824925422668457  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([6, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38271141052246094  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38271141052246094  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38277626037597656  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3868880271911621  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([47, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38936471939086914  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38936471939086914  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38986730575561523  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42630958557128906  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4189629554748535  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4192976951599121  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41971349716186523  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4200472831726074  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4200472831726074  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42006444931030273  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42020177841186523  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([14, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42022037506103516  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42022037506103516  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42024707794189453  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42064762115478516  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([16, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42068052291870117  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42068052291870117  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42071104049682617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42138242721557617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 16, 256])
--------------------------m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4214057922363281  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4214057922363281  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42142486572265625  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4219779968261719  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42199277877807617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42199277877807617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42200231552124023  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4223456382751465  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4223756790161133  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4223756790161133  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42238712310791016  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4228792190551758  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4228806495666504  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4228806495666504  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4228825569152832  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42297792434692383  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4229850769042969  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4229850769042969  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4229869842529297  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.423095703125  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42312097549438477  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42312097549438477  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4231266975402832  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4234929084777832  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42350006103515625  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42350006103515625  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42350196838378906  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42363739013671875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.423647403717041  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.423647403717041  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42364931106567383  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4237980842590332  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4238157272338867  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4238157272338867  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42381763458251953  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4240732192993164  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42409276962280273  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42409276962280273  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42409467697143555  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4243769645690918  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42440032958984375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42440032958984375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42440223693847656  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42473793029785156  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4244842529296875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4244861602783203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4244852066040039  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4244875907897949  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

pure train time  0.30904269218444824
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2754092216491699  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.834397315979004
loading full batch data spends  0.003206968307495117
random partition time  0.0001316070556640625

block_gen_time in "generate_blocks_for_one_layer_block"  0.0038733482360839844


block_gen_time in "generate_blocks_for_one_layer_block"  0.0059282779693603516

connection checking time:  0.004907846450805664
block generation total time  0.0059282779693603516
generate_dataloader_block spend   0.01829838752746582
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.27489376068115234  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([25, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.283538818359375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.283538818359375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28380584716796875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28594207763671875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([51, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28635311126708984  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28635311126708984  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2868976593017578  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2963871955871582  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([51, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29693174362182617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29693174362182617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29747629165649414  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30994272232055664  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([57, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31088781356811523  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31088781356811523  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31149721145629883  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.32971906661987305  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([47, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33066892623901367  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33066892623901367  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33117151260375977  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3492431640625  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([31, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34998512268066406  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34998512268066406  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35031700134277344  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3645620346069336  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([15, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3649568557739258  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3649568557739258  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36511707305908203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37312793731689453  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3735179901123047  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3735179901123047  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37363624572753906  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3803424835205078  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3804759979248047  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3804759979248047  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38051891326904297  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38326549530029297  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([43, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38553953170776367  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38553953170776367  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 43, 1433]), torch.Size([1, 43, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3859992027282715  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.418607234954834  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 43, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41167211532592773  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41199159622192383  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41238832473754883  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41271257400512695  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41271257400512695  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4127335548400879  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4129014015197754  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41291236877441406  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41291236877441406  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.412933349609375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41324806213378906  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41327524185180664  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41327524185180664  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4133000373840332  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4138455390930176  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([13, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4138832092285156  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4138832092285156  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4139080047607422  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4146270751953125  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41465330123901367  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41465330123901367  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41466856002807617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41521787643432617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4152336120605469  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4152336120605469  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4152412414550781  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4155693054199219  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4155726432800293  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4155726432800293  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4155745506286621  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41566991806030273  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41568470001220703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41568470001220703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41568851470947266  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4159059524536133  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.415921688079834  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.415921688079834  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4159255027770996  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4161696434020996  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4161968231201172  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4161968231201172  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4162025451660156  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4166088104248047  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4166264533996582  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4166264533996582  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.416628360748291  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41691064834594727  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4169340133666992  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4169340133666992  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41693592071533203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41727161407470703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41702938079833984  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41703128814697266  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4170198440551758  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.417022705078125  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2753868103027344  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([21, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28461503982543945  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28461503982543945  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28484010696411133  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2866363525390625  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([47, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28702592849731445  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28702592849731445  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28752851486206055  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29536867141723633  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([57, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29603052139282227  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29603052139282227  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29663991928100586  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31030797958374023  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([58, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31124210357666016  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31124210357666016  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 58, 1433]), torch.Size([1, 58, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3118619918823242  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.32982730865478516  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 58, 1433])
--------------------------m.shape torch.Size([47, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33077192306518555  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33077192306518555  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33127450942993164  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3493771553039551  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([33, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35018301010131836  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35018301010131836  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35053586959838867  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3656916618347168  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([22, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36633777618408203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36633777618408203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3665733337402344  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37833118438720703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([14, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3788113594055176  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3788113594055176  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37896108627319336  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.387484073638916  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([6, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.387697696685791  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.387697696685791  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38776254653930664  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3918743133544922  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([43, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3941373825073242  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3941373825073242  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 43, 1433]), torch.Size([1, 43, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.39459705352783203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42720508575439453  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 43, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41973447799682617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42006635665893555  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42047834396362305  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42081165313720703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42081165313720703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42082881927490234  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42096614837646484  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([14, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42098474502563477  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42098474502563477  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42101144790649414  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42141199111938477  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4214363098144531  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4214363098144531  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4214611053466797  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42200660705566406  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4220290184020996  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4220290184020996  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4220461845397949  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.422544002532959  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42256927490234375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42256927490234375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42258262634277344  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4230632781982422  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4230971336364746  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4230971336364746  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4231104850769043  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42368459701538086  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42369842529296875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42369842529296875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4237041473388672  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42399024963378906  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4239954948425293  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4239954948425293  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4239974021911621  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4241061210632324  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42412281036376953  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42412281036376953  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42412662506103516  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42437076568603516  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.424379825592041  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.424379825592041  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42438173294067383  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4245305061340332  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42455291748046875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42455291748046875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4245567321777344  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4248809814453125  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4248976707458496  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4248976707458496  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4248995780944824  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4251551628112793  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42517852783203125  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42517852783203125  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42518043518066406  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42551612854003906  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4252629280090332  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.425264835357666  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4252638816833496  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4252662658691406  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

pure train time  0.30529069900512695
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2754092216491699  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7829606533050537
loading full batch data spends  0.0051381587982177734
random partition time  0.00015687942504882812

block_gen_time in "generate_blocks_for_one_layer_block"  0.004712343215942383


block_gen_time in "generate_blocks_for_one_layer_block"  0.005883455276489258

connection checking time:  0.005047798156738281
block generation total time  0.005883455276489258
generate_dataloader_block spend   0.019992351531982422
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.27473926544189453  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([26, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2833366394042969  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2833366394042969  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2836151123046875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28583860397338867  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([46, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2861905097961426  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2861905097961426  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2866816520690918  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2949376106262207  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([61, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29591989517211914  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29591989517211914  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 61, 1433]), torch.Size([1, 61, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2965712547302246  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3116755485534668  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 61, 1433])
--------------------------m.shape torch.Size([51, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31243896484375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31243896484375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31298351287841797  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.32877540588378906  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([49, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.32981109619140625  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.32981109619140625  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3303346633911133  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34917593002319336  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([32, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34995174407958984  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34995174407958984  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3502941131591797  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.364990234375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([16, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3654170036315918  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3654170036315918  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3655886650085449  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3741416931152344  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3744831085205078  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3744831085205078  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3745899200439453  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3806781768798828  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([6, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38091325759887695  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38091325759887695  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3809781074523926  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3850898742675781  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([39, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38713979721069336  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38713979721069336  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 39, 1433]), torch.Size([1, 39, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3875565528869629  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4171319007873535  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 39, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4102768898010254  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4105973243713379  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4109950065612793  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41132545471191406  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41132545471191406  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.411346435546875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4115142822265625  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4115290641784668  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4115290641784668  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41155385971069336  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4119257926940918  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41194820404052734  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41194820404052734  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4119710922241211  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4124746322631836  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4124903678894043  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4124903678894043  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.412503719329834  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4128909111022949  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41292762756347656  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41292762756347656  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4129447937011719  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4135627746582031  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41358327865600586  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41358327865600586  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4135928153991699  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4140028953552246  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4140186309814453  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4140186309814453  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41402435302734375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4143104553222656  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41433095932006836  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41433095932006836  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4143366813659668  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41466283798217773  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4146862030029297  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4146862030029297  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4146919250488281  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4150581359863281  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41506528854370117  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41506528854370117  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.415067195892334  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41520261764526367  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41521358489990234  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41521358489990234  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41521549224853516  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4153776168823242  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41539525985717773  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41539525985717773  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41539716720581055  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4156527519226074  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41567230224609375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41567230224609375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41567420959472656  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4159564971923828  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.415708065032959  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4157099723815918  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4156985282897949  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41570138931274414  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.27538585662841797  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2842121124267578  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2842121124267578  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2844257354736328  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2861347198486328  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([51, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2865724563598633  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2865724563598633  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28711700439453125  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2955636978149414  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([47, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29604434967041016  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29604434967041016  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29654693603515625  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3078441619873047  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([63, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30893850326538086  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30893850326538086  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 63, 1433]), torch.Size([1, 63, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30961179733276367  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.329498291015625  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 63, 1433])
--------------------------m.shape torch.Size([47, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.330416202545166  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.330416202545166  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3309187889099121  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34899044036865234  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([33, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3497962951660156  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3497962951660156  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35014915466308594  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36530494689941406  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([19, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36583852767944336  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36583852767944336  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3660416603088379  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3761882781982422  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([15, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3767275810241699  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3767275810241699  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37688779830932617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3860201835632324  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38613271713256836  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38613271713256836  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38617563247680664  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38892221450805664  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([39, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.39098310470581055  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.39098310470581055  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 39, 1433]), torch.Size([1, 39, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3913998603820801  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4209752082824707  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 39, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41387033462524414  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41419267654418945  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4145927429199219  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4149198532104492  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4149198532104492  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41493701934814453  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41507434844970703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41508913040161133  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41508913040161133  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4151120185852051  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41545534133911133  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([14, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4154844284057617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4154844284057617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4155111312866211  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41609859466552734  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([15, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41614294052124023  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41614294052124023  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4161715507507324  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41700124740600586  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41701602935791016  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41701602935791016  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41702747344970703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41743946075439453  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4174685478210449  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4174685478210449  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4174799919128418  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4179720878601074  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41797351837158203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41797351837158203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41797542572021484  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41807079315185547  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4180788993835449  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4180788993835449  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41808080673217773  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41820287704467773  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41822147369384766  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41822147369384766  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4182252883911133  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41849613189697266  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4185051918029785  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4185051918029785  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41850709915161133  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4186558723449707  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4186668395996094  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4186668395996094  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4186687469482422  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41883087158203125  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41887807846069336  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41887807846069336  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.418881893157959  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.419553279876709  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41930532455444336  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41930723190307617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41930627822875977  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4193086624145508  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

pure train time  0.30585455894470215
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2754073143005371  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7691640853881836
loading full batch data spends  0.005083560943603516
random partition time  0.00016069412231445312

block_gen_time in "generate_blocks_for_one_layer_block"  0.004842042922973633


block_gen_time in "generate_blocks_for_one_layer_block"  0.006003141403198242

connection checking time:  0.005047321319580078
block generation total time  0.006003141403198242
generate_dataloader_block spend   0.02031421661376953
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2751297950744629  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([22, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28459882736206055  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28459882736206055  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2848343849182129  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2867159843444824  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([50, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28713226318359375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28713226318359375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28766632080078125  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2968263626098633  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([61, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29753637313842773  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29753637313842773  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 61, 1433]), torch.Size([1, 61, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2981877326965332  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3127894401550293  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 61, 1433])
--------------------------m.shape torch.Size([65, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31385183334350586  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31385183334350586  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 65, 1433]), torch.Size([1, 65, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3145461082458496  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3352847099304199  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 65, 1433])
--------------------------m.shape torch.Size([55, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33640575408935547  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33640575408935547  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3369932174682617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35813474655151367  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([40, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35912227630615234  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35912227630615234  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 40, 1433]), torch.Size([1, 40, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35954952239990234  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37792110443115234  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 40, 1433])
--------------------------m.shape torch.Size([16, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37830543518066406  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37830543518066406  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3784770965576172  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38703012466430664  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38741445541381836  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38741445541381836  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38753271102905273  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3942389488220215  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.39442014694213867  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.39442014694213867  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3944735527038574  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3978915214538574  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([42, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40010738372802734  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40010738372802734  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 42, 1433]), torch.Size([1, 42, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4005565643310547  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4324054718017578  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 42, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4248075485229492  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4251575469970703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42559242248535156  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

--------------------------m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42593860626220703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42593860626220703  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42595767974853516  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42611026763916016  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42612218856811523  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42612218856811523  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42614316940307617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42645788192749023  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4264850616455078  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4264850616455078  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4265098571777344  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42705535888671875  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4270815849304199  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4270815849304199  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42710065841674805  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42765378952026367  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42767810821533203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42767810821533203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4276914596557617  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42817211151123047  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42820024490356445  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42820024490356445  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42821168899536133  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42870378494262695  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4287118911743164  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4287118911743164  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42871570587158203  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4289064407348633  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4289278984069824  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4289278984069824  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42893362045288086  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4292597770690918  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42928314208984375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42928314208984375  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4292888641357422  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4296550750732422  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42966222763061523  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42966222763061523  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42966413497924805  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42979955673217773  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4298095703125  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4298095703125  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4298114776611328  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4299602508544922  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42997121810913086  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42997121810913086  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42997312545776367  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43013525009155273  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43015480041503906  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43015480041503906  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4301567077636719  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4304389953613281  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4304623603820801  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4304623603820801  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4304642677307129  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4307999610900879  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43053483963012695  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43053674697875977  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4305253028869629  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4305281639099121  GigaBytes
Max Memory Allocated: 0.5397629737854004  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.27538585662841797  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

--------------------------m.shape torch.Size([24, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2840733528137207  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2840733528137207  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.284329891204834  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2863807678222656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
--------------------------m.shape torch.Size([49, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.286776065826416  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.286776065826416  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28729963302612305  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29580116271972656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([50, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2963404655456543  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2963404655456543  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2968745231628418  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3086237907409668  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([50, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30942487716674805  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30942487716674805  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30995893478393555  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.32544660568237305  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([36, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3261408805847168  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3261408805847168  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 36, 1433]), torch.Size([1, 36, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3265261650085449  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3403749465942383  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 36, 1433])
--------------------------m.shape torch.Size([29, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3411111831665039  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3411111831665039  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34142112731933594  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3547401428222656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([22, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35540771484375  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35540771484375  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35564327239990234  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.367401123046875  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([15, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36792421340942383  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36792421340942383  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3680844306945801  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37721681594848633  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37728118896484375  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37728118896484375  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37731361389160156  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3793759346008301  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([47, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.381868839263916  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.381868839263916  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3823714256286621  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4190177917480469  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4119601249694824  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41227006912231445  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4126548767089844  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

--------------------------m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4129676818847656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4129676818847656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41298675537109375  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41313934326171875  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([14, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41315698623657227  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41315698623657227  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41318368911743164  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41358423233032227  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4136085510253906  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4136085510253906  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4136333465576172  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41417884826660156  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.414212703704834  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.414212703704834  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41423559188842773  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4148993492126465  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41492652893066406  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41492652893066406  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41494178771972656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41549110412597656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4155125617980957  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4155125617980957  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41552209854125977  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41593217849731445  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4159412384033203  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4159412384033203  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41594505310058594  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4161357879638672  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41614294052124023  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41614294052124023  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41614484786987305  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41626691818237305  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41628551483154297  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41628551483154297  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4162893295288086  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41656017303466797  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41657018661499023  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41657018661499023  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41657209396362305  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4167342185974121  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4167518615722656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4167518615722656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41675376892089844  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4170093536376953  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41703271865844727  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41703271865844727  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4170346260070801  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4173703193664551  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41713857650756836  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41714048385620117  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.41713953018188477  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4171419143676758  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

pure train time  0.31602978706359863
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2754073143005371  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7538440227508545
loading full batch data spends  0.004790782928466797
random partition time  0.00017142295837402344

block_gen_time in "generate_blocks_for_one_layer_block"  0.004874467849731445


block_gen_time in "generate_blocks_for_one_layer_block"  0.006657838821411133

connection checking time:  0.004824638366699219
block generation total time  0.006657838821411133
generate_dataloader_block spend   0.020803451538085938
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2746257781982422  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

--------------------------m.shape torch.Size([22, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2825918197631836  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2825918197631836  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28282737731933594  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28470897674560547  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([53, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2851572036743164  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2851572036743164  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2857236862182617  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2955460548400879  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([63, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29627180099487305  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29627180099487305  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 63, 1433]), torch.Size([1, 63, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29694509506225586  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3119516372680664  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 63, 1433])
--------------------------m.shape torch.Size([54, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31276845932006836  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31276845932006836  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 54, 1433]), torch.Size([1, 54, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31334543228149414  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3301868438720703  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 54, 1433])
--------------------------m.shape torch.Size([44, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3310728073120117  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3310728073120117  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 44, 1433]), torch.Size([1, 44, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33154296875  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3484616279602051  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 44, 1433])
--------------------------m.shape torch.Size([29, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3491554260253906  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3491554260253906  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34946537017822266  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36278438568115234  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([14, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36315298080444336  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36315298080444336  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36330270767211914  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37077903747558594  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([8, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3710460662841797  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3710460662841797  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37113189697265625  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37601280212402344  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37621021270751953  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37621021270751953  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3762636184692383  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3796815872192383  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([33, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38141679763793945  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38141679763793945  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38176965713500977  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40679407119750977  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40052127838134766  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4008312225341797  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4012160301208496  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40152692794799805  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40152692794799805  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40154218673706055  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40166425704956055  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40167999267578125  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40167999267578125  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.401702880859375  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40204620361328125  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40207815170288086  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40207815170288086  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40210676193237305  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40273618698120117  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([13, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4027719497680664  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4027719497680664  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40279674530029297  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4035158157348633  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40354204177856445  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40354204177856445  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40355730056762695  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40410661697387695  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4041280746459961  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4041280746459961  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40413761138916016  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40454769134521484  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4045567512512207  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4045567512512207  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40456056594848633  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4047513008117676  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4047574996948242  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4047574996948242  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40475940704345703  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40486812591552734  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4048933982849121  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4048933982849121  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40489912033081055  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40526533126831055  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4052724838256836  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4052724838256836  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4052743911743164  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4054098129272461  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40541982650756836  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40541982650756836  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40542173385620117  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40557050704956055  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4055938720703125  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4055938720703125  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4055957794189453  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4059314727783203  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4056997299194336  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4057016372680664  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40569019317626953  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40569305419921875  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2753868103027344  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

--------------------------m.shape torch.Size([23, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28504180908203125  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28504180908203125  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28528785705566406  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28725337982177734  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([44, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2876005172729492  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2876005172729492  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 44, 1433]), torch.Size([1, 44, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2880706787109375  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2951202392578125  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 44, 1433])
--------------------------m.shape torch.Size([45, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2956061363220215  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2956061363220215  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29608678817749023  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30666112899780273  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
--------------------------m.shape torch.Size([57, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30763816833496094  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30763816833496094  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30824756622314453  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3260064125061035  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([49, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3270096778869629  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3270096778869629  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3275332450866699  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3473391532897949  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([37, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3482627868652344  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3482627868652344  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34865856170654297  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36565113067626953  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([22, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3662757873535156  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3662757873535156  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36651134490966797  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3782691955566406  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([16, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37883472442626953  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37883472442626953  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37900638580322266  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38875675201416016  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38886356353759766  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38886356353759766  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38890647888183594  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.39165306091308594  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([52, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3944077491760254  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3944077491760254  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 52, 1433]), torch.Size([1, 52, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.39496374130249023  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43515920639038086  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 52, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4272308349609375  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4275636672973633  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4279770851135254  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

--------------------------m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42832517623901367  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42832517623901367  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4283480644226074  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4285311698913574  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4285449981689453  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4285449981689453  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4285697937011719  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4289417266845703  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42896127700805664  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42896127700805664  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4289822578430176  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4294438362121582  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42946815490722656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42946815490722656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4294853210449219  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.42998313903808594  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4300084114074707  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4300084114074707  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4300217628479004  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43050241470336914  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4305305480957031  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4305305480957031  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4305419921875  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4310340881347656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4310421943664551  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4310421943664551  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4310460090637207  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43123674392700195  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43125057220458984  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43125057220458984  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43125438690185547  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4314718246459961  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43147897720336914  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43147897720336914  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43148088455200195  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43160295486450195  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4316215515136719  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4316215515136719  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4316253662109375  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4318962097167969  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.431917667388916  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.431917667388916  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43192148208618164  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43224573135375977  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4322624206542969  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4322624206542969  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4322643280029297  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43251991271972656  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4325394630432129  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4325394630432129  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4325413703918457  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.43282365798950195  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4328470230102539  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4328470230102539  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4328489303588867  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4331846237182617  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4329195022583008  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4329214096069336  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4329204559326172  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4329228401184082  GigaBytes
Max Memory Allocated: 0.5427250862121582  GigaBytes

pure train time  0.32595300674438477
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2754092216491699  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7443008422851562
loading full batch data spends  0.004163980484008789
random partition time  0.0001811981201171875

block_gen_time in "generate_blocks_for_one_layer_block"  0.004713296890258789


block_gen_time in "generate_blocks_for_one_layer_block"  0.005860090255737305

connection checking time:  0.004696369171142578
block generation total time  0.005860090255737305
generate_dataloader_block spend   0.019739389419555664
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2745351791381836  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

--------------------------m.shape torch.Size([21, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28251171112060547  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28251171112060547  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28273677825927734  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2845330238342285  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([51, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28496503829956055  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28496503829956055  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2855095863342285  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29535675048828125  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([52, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2959175109863281  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2959175109863281  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 52, 1433]), torch.Size([1, 52, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.29647350311279297  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30869245529174805  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 52, 1433])
--------------------------m.shape torch.Size([51, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30950355529785156  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.30950355529785156  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31004810333251953  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3267707824707031  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([47, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.32775306701660156  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.32775306701660156  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.32825565338134766  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34634876251220703  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([27, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34696245193481445  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34696245193481445  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.34725141525268555  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35965967178344727  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([15, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3600759506225586  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3600759506225586  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36023616790771484  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36824703216552734  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([12, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3686795234680176  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3686795234680176  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3688082695007324  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.37612390518188477  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3762521743774414  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3762521743774414  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3762950897216797  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3790416717529297  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([35, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3808889389038086  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3808889389038086  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38126277923583984  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4078054428100586  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40145206451416016  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4017524719238281  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40212583541870117  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40244102478027344  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40244102478027344  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40245819091796875  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40259552001953125  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([15, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.402616024017334  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.402616024017334  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40264463424682617  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.403073787689209  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([14, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40310001373291016  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40310001373291016  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40312671661376953  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4037141799926758  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40374326705932617  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40374326705932617  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4037642478942871  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4043726921081543  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4044055938720703  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4044055938720703  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4044227600097656  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4050407409667969  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4050612449645996  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4050612449645996  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40507078170776367  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40548086166381836  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4054841995239258  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4054841995239258  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4054861068725586  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4055948257446289  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.405611515045166  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.405611515045166  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40561532974243164  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40585947036743164  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4058685302734375  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4058685302734375  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4058704376220703  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4060192108154297  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40603017807006836  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40603017807006836  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40603208541870117  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40619421005249023  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40624141693115234  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40624141693115234  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40624523162841797  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40691661834716797  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4066805839538574  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40668249130249023  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.40667104721069336  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.4066739082336426  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2753868103027344  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

--------------------------m.shape torch.Size([25, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2846999168395996  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2846999168395996  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28496694564819336  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.28710317611694336  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([46, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2874608039855957  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2874608039855957  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2879519462585449  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2956724166870117  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([56, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2963237762451172  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2963237762451172  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 56, 1433]), torch.Size([1, 56, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.2969217300415039  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31047964096069336  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 56, 1433])
--------------------------m.shape torch.Size([63, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3115262985229492  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3115262985229492  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 63, 1433]), torch.Size([1, 63, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.31219959259033203  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3317136764526367  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 63, 1433])
--------------------------m.shape torch.Size([44, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3326683044433594  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3326683044433594  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 44, 1433]), torch.Size([1, 44, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.33313846588134766  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35005712509155273  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 44, 1433])
--------------------------m.shape torch.Size([35, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35094356536865234  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.35094356536865234  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3513174057006836  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36739253997802734  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([21, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36799049377441406  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36799049377441406  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.36821556091308594  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3794388771057129  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([13, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3798818588256836  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3798818588256836  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3800210952758789  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38794612884521484  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38811683654785156  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.38811683654785156  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3881702423095703  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3915882110595703  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([45, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3939638137817383  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.3939638137817383  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 2.134765625 GB
    Memory Allocated: 0.39444446563720703  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4285707473754883  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4210543632507324  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42139101028442383  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42180919647216797  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

--------------------------m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4221501350402832  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4221501350402832  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42217111587524414  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42233896255493164  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4223480224609375  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4223480224609375  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4223670959472656  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4226531982421875  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42267847061157227  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42267847061157227  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.422701358795166  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4232048988342285  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4232358932495117  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4232358932495117  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42325687408447266  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42386531829833984  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42388391494750977  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42388391494750977  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42389535903930664  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42430734634399414  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42433643341064453  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42433643341064453  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4243478775024414  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42483997344970703  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42486143112182617  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42486143112182617  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4248690605163574  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4252505302429199  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.425262451171875  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.425262451171875  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4252662658691406  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42548370361328125  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42549943923950195  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42549943923950195  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4255032539367676  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4257473945617676  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42577457427978516  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.42577457427978516  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.138671875 GB
    Memory Allocated: 0.4257802963256836  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.42618656158447266  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4261956214904785  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4261956214904785  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.42619752883911133  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4263596534729004  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4263772964477539  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4263772964477539  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4263792037963867  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4266347885131836  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4266543388366699  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4266543388366699  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.42665624618530273  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.426938533782959  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4266796112060547  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4266815185546875  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4266805648803711  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.140625 GB
    Memory Allocated: 0.4266829490661621  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

pure train time  0.3158230781555176
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.14453125 GB
    Memory Allocated: 0.2754092216491699  GigaBytes
Max Memory Allocated: 0.5447788238525391  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6799876689910889
Total (block generation + training)time/epoch 0.3822105612073626
pure train time/epoch 0.3129989703496297

num_input_list  [1767, 1748, 1749, 1802, 1712, 1800, 1710, 1831, 1776, 1709]
