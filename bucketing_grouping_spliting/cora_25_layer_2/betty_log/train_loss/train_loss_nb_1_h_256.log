main start at this time 1697828990.607836
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
connection checking time:  0
block generation total time  0
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.515625 GB
    Memory Allocated: 0.07446956634521484  GigaBytes
Max Memory Allocated: 0.07446956634521484  GigaBytes

--------------------------m.shape torch.Size([45, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.611328125 GB
    Memory Allocated: 0.09038782119750977  GigaBytes
Max Memory Allocated: 0.09042692184448242  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.611328125 GB
    Memory Allocated: 0.09038782119750977  GigaBytes
Max Memory Allocated: 0.09042692184448242  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 1.611328125 GB
    Memory Allocated: 0.09086847305297852  GigaBytes
Max Memory Allocated: 0.09086847305297852  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.625 GB
    Memory Allocated: 0.09471368789672852  GigaBytes
Max Memory Allocated: 0.09495401382446289  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
--------------------------m.shape torch.Size([96, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.625 GB
    Memory Allocated: 0.09549856185913086  GigaBytes
Max Memory Allocated: 0.09550094604492188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.625 GB
    Memory Allocated: 0.09549856185913086  GigaBytes
Max Memory Allocated: 0.09550094604492188  GigaBytes

 h.shape torch.Size([1, 96, 1433]), torch.Size([1, 96, 1433])
----------------------------------------3
 Nvidia-smi: 1.626953125 GB
    Memory Allocated: 0.09652376174926758  GigaBytes
Max Memory Allocated: 0.09652376174926758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.650390625 GB
    Memory Allocated: 0.11228084564208984  GigaBytes
Max Memory Allocated: 0.11330604553222656  GigaBytes

rst.shape  torch.Size([1, 96, 1433])
--------------------------m.shape torch.Size([103, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.650390625 GB
    Memory Allocated: 0.1134181022644043  GigaBytes
Max Memory Allocated: 0.11342191696166992  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.650390625 GB
    Memory Allocated: 0.1134181022644043  GigaBytes
Max Memory Allocated: 0.11342191696166992  GigaBytes

 h.shape torch.Size([1, 103, 1433]), torch.Size([1, 103, 1433])
----------------------------------------3
 Nvidia-smi: 1.650390625 GB
    Memory Allocated: 0.11451864242553711  GigaBytes
Max Memory Allocated: 0.11451864242553711  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.67578125 GB
    Memory Allocated: 0.13930130004882812  GigaBytes
Max Memory Allocated: 0.14095115661621094  GigaBytes

rst.shape  torch.Size([1, 103, 1433])
--------------------------m.shape torch.Size([111, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.67578125 GB
    Memory Allocated: 0.14112138748168945  GigaBytes
Max Memory Allocated: 0.1411266326904297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.67578125 GB
    Memory Allocated: 0.14112138748168945  GigaBytes
Max Memory Allocated: 0.1411266326904297  GigaBytes

 h.shape torch.Size([1, 111, 1433]), torch.Size([1, 111, 1433])
----------------------------------------3
 Nvidia-smi: 1.67578125 GB
    Memory Allocated: 0.14230680465698242  GigaBytes
Max Memory Allocated: 0.14230680465698242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.720703125 GB
    Memory Allocated: 0.1772465705871582  GigaBytes
Max Memory Allocated: 0.17961692810058594  GigaBytes

rst.shape  torch.Size([1, 111, 1433])
--------------------------m.shape torch.Size([82, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.720703125 GB
    Memory Allocated: 0.17884302139282227  GigaBytes
Max Memory Allocated: 0.17961692810058594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.720703125 GB
    Memory Allocated: 0.17884302139282227  GigaBytes
Max Memory Allocated: 0.17961692810058594  GigaBytes

 h.shape torch.Size([1, 82, 1433]), torch.Size([1, 82, 1433])
----------------------------------------3
 Nvidia-smi: 1.720703125 GB
    Memory Allocated: 0.1797194480895996  GigaBytes
Max Memory Allocated: 0.1797194480895996  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.74609375 GB
    Memory Allocated: 0.21124935150146484  GigaBytes
Max Memory Allocated: 0.2134385108947754  GigaBytes

rst.shape  torch.Size([1, 82, 1433])
--------------------------m.shape torch.Size([60, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.74609375 GB
    Memory Allocated: 0.21273326873779297  GigaBytes
Max Memory Allocated: 0.2134385108947754  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.74609375 GB
    Memory Allocated: 0.21273326873779297  GigaBytes
Max Memory Allocated: 0.2134385108947754  GigaBytes

 h.shape torch.Size([1, 60, 1433]), torch.Size([1, 60, 1433])
----------------------------------------3
 Nvidia-smi: 1.74609375 GB
    Memory Allocated: 0.21337413787841797  GigaBytes
Max Memory Allocated: 0.2134385108947754  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.76953125 GB
    Memory Allocated: 0.24191522598266602  GigaBytes
Max Memory Allocated: 0.2438373565673828  GigaBytes

rst.shape  torch.Size([1, 60, 1433])
--------------------------m.shape torch.Size([34, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.76953125 GB
    Memory Allocated: 0.24286556243896484  GigaBytes
Max Memory Allocated: 0.2438373565673828  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.76953125 GB
    Memory Allocated: 0.24286556243896484  GigaBytes
Max Memory Allocated: 0.2438373565673828  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 1.76953125 GB
    Memory Allocated: 0.24322891235351562  GigaBytes
Max Memory Allocated: 0.2438373565673828  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.791015625 GB
    Memory Allocated: 0.2613863945007324  GigaBytes
Max Memory Allocated: 0.26265716552734375  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([22, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.791015625 GB
    Memory Allocated: 0.2621445655822754  GigaBytes
Max Memory Allocated: 0.26265716552734375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.791015625 GB
    Memory Allocated: 0.2621445655822754  GigaBytes
Max Memory Allocated: 0.26265716552734375  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 1.791015625 GB
    Memory Allocated: 0.26238012313842773  GigaBytes
Max Memory Allocated: 0.26265716552734375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.802734375 GB
    Memory Allocated: 0.2757840156555176  GigaBytes
Max Memory Allocated: 0.27672386169433594  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([8, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.802734375 GB
    Memory Allocated: 0.27605104446411133  GigaBytes
Max Memory Allocated: 0.27672386169433594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.802734375 GB
    Memory Allocated: 0.27605104446411133  GigaBytes
Max Memory Allocated: 0.27672386169433594  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 1.802734375 GB
    Memory Allocated: 0.2761368751525879  GigaBytes
Max Memory Allocated: 0.27672386169433594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.806640625 GB
    Memory Allocated: 0.2816171646118164  GigaBytes
Max Memory Allocated: 0.28200197219848633  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([66, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.826171875 GB
    Memory Allocated: 0.285097599029541  GigaBytes
Max Memory Allocated: 0.28510570526123047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.826171875 GB
    Memory Allocated: 0.285097599029541  GigaBytes
Max Memory Allocated: 0.28510570526123047  GigaBytes

 h.shape torch.Size([1, 66, 1433]), torch.Size([1, 66, 1433])
----------------------------------------3
 Nvidia-smi: 1.828125 GB
    Memory Allocated: 0.28580236434936523  GigaBytes
Max Memory Allocated: 0.28580236434936523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3364100456237793  GigaBytes
Max Memory Allocated: 0.3399333953857422  GigaBytes

rst.shape  torch.Size([1, 66, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3237590789794922  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3243570327758789  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3250999450683594  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

--------------------------m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3257412910461426  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3257412910461426  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.32577943801879883  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.32608461380004883  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 20, 256])
--------------------------m.shape torch.Size([25, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3261137008666992  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3261137008666992  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.32616138458251953  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3268766403198242  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 25, 256])
--------------------------m.shape torch.Size([26, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.32692813873291016  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.32692813873291016  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3269777297973633  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.32806873321533203  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 26, 256])
--------------------------m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3281288146972656  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3281288146972656  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3281707763671875  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3293876647949219  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 22, 256])
--------------------------m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3294391632080078  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3294391632080078  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 1.875 GB
    Memory Allocated: 0.3294677734375  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.33049774169921875  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3305473327636719  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3305473327636719  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3305683135986328  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3314704895019531  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.33148717880249023  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.33148717880249023  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3314948081970215  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.331876277923584  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3318958282470703  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3318958282470703  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.33190155029296875  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3322277069091797  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3322596549987793  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3322596549987793  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.33226728439331055  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.33275556564331055  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.3327808380126953  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.3327808380126953  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.33278656005859375  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.3331928253173828  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.33320093154907227  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.33320093154907227  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.3332028388977051  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.33335161209106445  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.3333740234375  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.3333740234375  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.3333778381347656  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.33370208740234375  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.33371877670288086  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.33371877670288086  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.33372068405151367  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.33397626876831055  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.3339958190917969  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.3339958190917969  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.87890625 GB
    Memory Allocated: 0.3339977264404297  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.33428001403808594  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.33432722091674805  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.33432722091674805  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.33433103561401367  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.33500242233276367  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.3345208168029785  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.33452463150024414  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.33452701568603516  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.880859375 GB
    Memory Allocated: 0.3345317840576172  GigaBytes
Max Memory Allocated: 0.3461008071899414  GigaBytes

pure train time  0.6014719009399414
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.27687644958496094  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9441255331039429
connection checking time:  0
block generation total time  0
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.2769036293029785  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

--------------------------m.shape torch.Size([46, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.29282712936401367  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.29282712936401367  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.2933182716369629  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.29876136779785156  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([97, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.29955148696899414  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.29955148696899414  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

 h.shape torch.Size([1, 97, 1433]), torch.Size([1, 97, 1433])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.30058717727661133  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.31612253189086914  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

rst.shape  torch.Size([1, 97, 1433])
--------------------------m.shape torch.Size([103, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.31795644760131836  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.31795644760131836  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

 h.shape torch.Size([1, 103, 1433]), torch.Size([1, 103, 1433])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.31905698776245117  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.34325599670410156  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

rst.shape  torch.Size([1, 103, 1433])
--------------------------m.shape torch.Size([107, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.34499073028564453  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.34499073028564453  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

 h.shape torch.Size([1, 107, 1433]), torch.Size([1, 107, 1433])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.3461332321166992  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.37926578521728516  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

rst.shape  torch.Size([1, 107, 1433])
--------------------------m.shape torch.Size([84, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.3809370994567871  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.3809370994567871  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

 h.shape torch.Size([1, 84, 1433]), torch.Size([1, 84, 1433])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.3818345069885254  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.41426706314086914  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

rst.shape  torch.Size([1, 84, 1433])
--------------------------m.shape torch.Size([59, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.4157085418701172  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.4157085418701172  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

 h.shape torch.Size([1, 59, 1433]), torch.Size([1, 59, 1433])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.4163389205932617  GigaBytes
Max Memory Allocated: 0.44267940521240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.44528675079345703  GigaBytes
Max Memory Allocated: 0.4471769332885742  GigaBytes

rst.shape  torch.Size([1, 59, 1433])
--------------------------m.shape torch.Size([33, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.44620513916015625  GigaBytes
Max Memory Allocated: 0.4471769332885742  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.44620513916015625  GigaBytes
Max Memory Allocated: 0.4471769332885742  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.44655799865722656  GigaBytes
Max Memory Allocated: 0.4471769332885742  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.46418094635009766  GigaBytes
Max Memory Allocated: 0.46541452407836914  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([22, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.46494436264038086  GigaBytes
Max Memory Allocated: 0.46541452407836914  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.46494436264038086  GigaBytes
Max Memory Allocated: 0.46541452407836914  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.4651799201965332  GigaBytes
Max Memory Allocated: 0.46541452407836914  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.47858381271362305  GigaBytes
Max Memory Allocated: 0.4795236587524414  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([8, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.4788508415222168  GigaBytes
Max Memory Allocated: 0.4795236587524414  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.4788508415222168  GigaBytes
Max Memory Allocated: 0.4795236587524414  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.47893667221069336  GigaBytes
Max Memory Allocated: 0.4795236587524414  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.4844169616699219  GigaBytes
Max Memory Allocated: 0.4848017692565918  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([67, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.48795080184936523  GigaBytes
Max Memory Allocated: 0.4879589080810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.48795080184936523  GigaBytes
Max Memory Allocated: 0.4879589080810547  GigaBytes

 h.shape torch.Size([1, 67, 1433]), torch.Size([1, 67, 1433])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.48866701126098633  GigaBytes
Max Memory Allocated: 0.48866701126098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.540407657623291  GigaBytes
Max Memory Allocated: 0.5439844131469727  GigaBytes

rst.shape  torch.Size([1, 67, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5277457237243652  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5283427238464355  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5290842056274414  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

--------------------------m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5297255516052246  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5297255516052246  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5297636985778809  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5300688743591309  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 20, 256])
--------------------------m.shape torch.Size([25, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5300979614257812  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5300979614257812  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5301456451416016  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5308609008789062  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 25, 256])
--------------------------m.shape torch.Size([26, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5309123992919922  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5309123992919922  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5309619903564453  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5320529937744141  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 26, 256])
--------------------------m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5321130752563477  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5321130752563477  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5321550369262695  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5333719253540039  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 22, 256])
--------------------------m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5334234237670898  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5334234237670898  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.533452033996582  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5344820022583008  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5345315933227539  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5345315933227539  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5345525741577148  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5354547500610352  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5354714393615723  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5354714393615723  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5354790687561035  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.535860538482666  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5358800888061523  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5358800888061523  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5358858108520508  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5362119674682617  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5362439155578613  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5362439155578613  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5362515449523926  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5367398262023926  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5367650985717773  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5367650985717773  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5367708206176758  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5371770858764648  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5371851921081543  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5371851921081543  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5371870994567871  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5373358726501465  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.537358283996582  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.537358283996582  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5373620986938477  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5376863479614258  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5377030372619629  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5377030372619629  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5377049446105957  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5379605293273926  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5379800796508789  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5379800796508789  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5379819869995117  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.538264274597168  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5383114814758301  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5383114814758301  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5383152961730957  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5389866828918457  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5385050773620605  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5385088920593262  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.538489818572998  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.173828125 GB
    Memory Allocated: 0.5384945869445801  GigaBytes
Max Memory Allocated: 0.550076961517334  GigaBytes

pure train time  0.1876540184020996
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.27692413330078125  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9224432706832886
connection checking time:  0
block generation total time  0
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.27698373794555664  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

--------------------------m.shape torch.Size([46, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.292966365814209  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.292966365814209  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.2934575080871582  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.29826784133911133  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([96, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.29904747009277344  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.29904747009277344  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 96, 1433]), torch.Size([1, 96, 1433])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.30007266998291016  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.3155965805053711  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 96, 1433])
--------------------------m.shape torch.Size([104, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.31674957275390625  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.31674957275390625  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 104, 1433]), torch.Size([1, 104, 1433])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.31786060333251953  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.34229469299316406  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 104, 1433])
--------------------------m.shape torch.Size([108, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.34404563903808594  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.34404563903808594  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 108, 1433]), torch.Size([1, 108, 1433])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.3451995849609375  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.3786468505859375  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 108, 1433])
--------------------------m.shape torch.Size([85, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.3803391456604004  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.3803391456604004  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 85, 1433]), torch.Size([1, 85, 1433])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.38124704360961914  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.4139242172241211  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 85, 1433])
--------------------------m.shape torch.Size([60, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.4153923988342285  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.4153923988342285  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 60, 1433]), torch.Size([1, 60, 1433])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.4160332679748535  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.44458436965942383  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 60, 1433])
--------------------------m.shape torch.Size([35, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.4455718994140625  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.4455718994140625  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.44594573974609375  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.46463775634765625  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([23, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.46561574935913086  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.46561574935913086  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.46586179733276367  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.47986364364624023  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([8, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.48012542724609375  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.48012542724609375  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.4802112579345703  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.48569154739379883  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([67, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.4892253875732422  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.4892253875732422  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 67, 1433]), torch.Size([1, 67, 1433])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.4899415969848633  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5426063537597656  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 67, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5299172401428223  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.530519962310791  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5312685966491699  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

--------------------------m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5319099426269531  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5319099426269531  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5319480895996094  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5322532653808594  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 20, 256])
--------------------------m.shape torch.Size([25, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5322823524475098  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5322823524475098  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5323300361633301  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5330452919006348  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 25, 256])
--------------------------m.shape torch.Size([26, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5330967903137207  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5330967903137207  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5331463813781738  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5342373847961426  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 26, 256])
--------------------------m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5342974662780762  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5342974662780762  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.534339427947998  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5355563163757324  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 22, 256])
--------------------------m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5356078147888184  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5356078147888184  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5356364250183105  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5366663932800293  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5367159843444824  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5367159843444824  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5367369651794434  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5376391410827637  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5376558303833008  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5376558303833008  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.537663459777832  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5380449295043945  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5380644798278809  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5380644798278809  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5380702018737793  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5383963584899902  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5384283065795898  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5384283065795898  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5384359359741211  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5389242172241211  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5389494895935059  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5389494895935059  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5389552116394043  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5393614768981934  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5393695831298828  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5393695831298828  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5393714904785156  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.539520263671875  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5395426750183105  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5395426750183105  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5395464897155762  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5398707389831543  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5398874282836914  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5398874282836914  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5398893356323242  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5401449203491211  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5401644706726074  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5401644706726074  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5401663780212402  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5404486656188965  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5404958724975586  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5404958724975586  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5404996871948242  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5411710739135742  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5406894683837891  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5406932830810547  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5406742095947266  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.20703125 GB
    Memory Allocated: 0.5406789779663086  GigaBytes
Max Memory Allocated: 0.6412038803100586  GigaBytes

pure train time  0.18259310722351074
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2770042419433594  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9045649766921997
loading full batch data spends  0.0024797916412353516
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   3.8623809814453125e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2769632339477539  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

--------------------------m.shape torch.Size([46, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29299497604370117  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29299497604370117  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2934861183166504  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29827451705932617  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([96, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2990541458129883  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2990541458129883  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 96, 1433]), torch.Size([1, 96, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.300079345703125  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3155984878540039  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 96, 1433])
--------------------------m.shape torch.Size([104, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31675148010253906  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31675148010253906  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 104, 1433]), torch.Size([1, 104, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31786251068115234  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3422966003417969  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 104, 1433])
--------------------------m.shape torch.Size([108, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.34404754638671875  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.34404754638671875  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 108, 1433]), torch.Size([1, 108, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3452014923095703  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3786487579345703  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 108, 1433])
--------------------------m.shape torch.Size([84, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.38031435012817383  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.38031435012817383  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 84, 1433]), torch.Size([1, 84, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3812117576599121  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.41350412368774414  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 84, 1433])
--------------------------m.shape torch.Size([59, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4149456024169922  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4149456024169922  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 59, 1433]), torch.Size([1, 59, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4155759811401367  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4442873001098633  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 59, 1433])
--------------------------m.shape torch.Size([35, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4452800750732422  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4452800750732422  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.44565391540527344  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46434593200683594  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([23, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46532392501831055  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46532392501831055  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46556997299194336  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4795718193054199  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([8, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.47983360290527344  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.47983360290527344  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.47991943359375  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4853997230529785  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([69, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4890403747558594  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4890403747558594  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 69, 1433]), torch.Size([1, 69, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4897775650024414  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5428428649902344  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 69, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.530095100402832  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5306978225708008  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5314464569091797  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

--------------------------m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5320878028869629  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5320878028869629  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5321259498596191  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5324311256408691  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 20, 256])
--------------------------m.shape torch.Size([25, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5324602127075195  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5324602127075195  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5325078964233398  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5332231521606445  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 25, 256])
--------------------------m.shape torch.Size([26, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5332746505737305  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5332746505737305  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5333242416381836  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5344152450561523  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 26, 256])
--------------------------m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5344753265380859  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5344753265380859  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5345172882080078  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5357341766357422  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 22, 256])
--------------------------m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5357856750488281  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5357856750488281  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5358142852783203  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5368442535400391  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5368938446044922  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5368938446044922  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5369148254394531  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5378170013427734  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5378336906433105  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5378336906433105  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5378413200378418  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382227897644043  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382423400878906  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382423400878906  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382480621337891  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.53857421875  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5386061668395996  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5386061668395996  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5386137962341309  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5391020774841309  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5391273498535156  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5391273498535156  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5391330718994141  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5395393371582031  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5395474433898926  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5395474433898926  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5395493507385254  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5396981239318848  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5397205352783203  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5397205352783203  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5397243499755859  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5400485992431641  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5400652885437012  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5400652885437012  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.540067195892334  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5403227806091309  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5403423309326172  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5403423309326172  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.54034423828125  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5406265258789062  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5406737327575684  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5406737327575684  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.540677547454834  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.541348934173584  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5408673286437988  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5408711433410645  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5408520698547363  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5408568382263184  GigaBytes
Max Memory Allocated: 0.6424150466918945  GigaBytes

pure train time  0.18618202209472656
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.27698469161987305  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8774527311325073
loading full batch data spends  0.002501964569091797
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   3.695487976074219e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.27698469161987305  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

--------------------------m.shape torch.Size([46, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2930111885070801  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2930111885070801  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2935023307800293  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29826974868774414  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([98, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2990708351135254  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2990708351135254  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 98, 1433]), torch.Size([1, 98, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.30011796951293945  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31643056869506836  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 98, 1433])
--------------------------m.shape torch.Size([103, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31799840927124023  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31799840927124023  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 103, 1433]), torch.Size([1, 103, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31909894943237305  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.34329795837402344  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 103, 1433])
--------------------------m.shape torch.Size([109, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3450756072998047  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3450756072998047  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 109, 1433]), torch.Size([1, 109, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3462400436401367  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.37999725341796875  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 109, 1433])
--------------------------m.shape torch.Size([85, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3816843032836914  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3816843032836914  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 85, 1433]), torch.Size([1, 85, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.38259220123291016  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4153881072998047  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 85, 1433])
--------------------------m.shape torch.Size([60, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4168562889099121  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4168562889099121  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 60, 1433]), torch.Size([1, 60, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4174971580505371  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4459724426269531  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 60, 1433])
--------------------------m.shape torch.Size([34, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.44692277908325195  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.44692277908325195  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.44728612899780273  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46544361114501953  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([23, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46629810333251953  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46629810333251953  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46654415130615234  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4805459976196289  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([8, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4808077812194824  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4808077812194824  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.480893611907959  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4863739013671875  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([68, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4899611473083496  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4899611473083496  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 68, 1433]), torch.Size([1, 68, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.49068784713745117  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5435538291931152  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 68, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5308265686035156  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5314311981201172  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5321822166442871  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

--------------------------m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5328235626220703  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5328235626220703  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5328617095947266  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5331668853759766  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 20, 256])
--------------------------m.shape torch.Size([25, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.533195972442627  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.533195972442627  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5332436561584473  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.533958911895752  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 25, 256])
--------------------------m.shape torch.Size([26, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5340104103088379  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5340104103088379  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.534060001373291  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5351510047912598  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 26, 256])
--------------------------m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5352110862731934  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5352110862731934  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5352530479431152  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5364699363708496  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 22, 256])
--------------------------m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5365214347839355  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5365214347839355  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5365500450134277  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5375800132751465  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5376296043395996  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5376296043395996  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5376505851745605  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385527610778809  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.538569450378418  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.538569450378418  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385770797729492  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5389585494995117  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.538978099822998  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.538978099822998  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5389838218688965  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5393099784851074  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.539341926574707  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.539341926574707  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5393495559692383  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5398378372192383  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.539863109588623  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.539863109588623  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5398688316345215  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5402750968933105  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.540283203125  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.540283203125  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5402851104736328  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5404338836669922  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5404562950134277  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5404562950134277  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5404601097106934  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5407843589782715  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5408010482788086  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5408010482788086  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5408029556274414  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5410585403442383  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5410780906677246  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5410780906677246  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5410799980163574  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5413622856140137  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5414094924926758  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5414094924926758  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5414133071899414  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5420846939086914  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5416030883789062  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5416069030761719  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5415878295898438  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5415925979614258  GigaBytes
Max Memory Allocated: 0.6429009437561035  GigaBytes

pure train time  0.18740081787109375
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2770061492919922  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8485015630722046
loading full batch data spends  0.002790212631225586
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   3.361701965332031e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2769465446472168  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

--------------------------m.shape torch.Size([46, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2929081916809082  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2929081916809082  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2933993339538574  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29827260971069336  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([96, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29905223846435547  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29905223846435547  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 96, 1433]), torch.Size([1, 96, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3000774383544922  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3155965805053711  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 96, 1433])
--------------------------m.shape torch.Size([102, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31671762466430664  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31671762466430664  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 102, 1433]), torch.Size([1, 102, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3178067207336426  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3417668342590332  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 102, 1433])
--------------------------m.shape torch.Size([109, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3435502052307129  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3435502052307129  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 109, 1433]), torch.Size([1, 109, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3447146415710449  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.37847185134887695  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 109, 1433])
--------------------------m.shape torch.Size([86, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3801851272583008  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3801851272583008  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 86, 1433]), torch.Size([1, 86, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.381103515625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.41443443298339844  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 86, 1433])
--------------------------m.shape torch.Size([58, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4158329963684082  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4158329963684082  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 58, 1433]), torch.Size([1, 58, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.41645288467407227  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4432835578918457  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 58, 1433])
--------------------------m.shape torch.Size([34, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.444244384765625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.444244384765625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4446077346801758  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4627652168273926  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([22, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46352338790893555  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46352338790893555  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4637589454650879  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.47716283798217773  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([8, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4774298667907715  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4774298667907715  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.47751569747924805  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.48299598693847656  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([69, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4866366386413574  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4866366386413574  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 69, 1433]), torch.Size([1, 69, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.48737382888793945  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5406851768493652  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 69, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5279965400695801  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.528597354888916  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5293436050415039  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

--------------------------m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5299849510192871  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5299849510192871  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5300230979919434  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5303282737731934  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 20, 256])
--------------------------m.shape torch.Size([25, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5303573608398438  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5303573608398438  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5304050445556641  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5311203002929688  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 25, 256])
--------------------------m.shape torch.Size([26, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5311717987060547  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5311717987060547  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5312213897705078  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5323123931884766  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 26, 256])
--------------------------m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5323724746704102  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5323724746704102  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.532414436340332  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5336313247680664  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 22, 256])
--------------------------m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5336828231811523  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5336828231811523  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5337114334106445  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5347414016723633  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5347909927368164  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5347909927368164  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5348119735717773  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5357141494750977  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5357308387756348  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5357308387756348  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.535738468170166  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5361199378967285  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5361394882202148  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5361394882202148  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5361452102661133  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5364713668823242  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5365033149719238  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5365033149719238  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5365109443664551  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5369992256164551  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5370244979858398  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5370244979858398  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5370302200317383  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5374364852905273  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5374445915222168  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5374445915222168  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5374464988708496  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.537595272064209  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5376176834106445  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5376176834106445  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5376214981079102  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5379457473754883  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5379624366760254  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5379624366760254  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5379643440246582  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382199287414551  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382394790649414  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382394790649414  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382413864135742  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385236740112305  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385708808898926  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385708808898926  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385746955871582  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5392460823059082  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.538764476776123  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5387682914733887  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5387492179870605  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5387539863586426  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

pure train time  0.1741483211517334
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.27696704864501953  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8181418180465698
loading full batch data spends  0.0027570724487304688
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   3.528594970703125e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.27698373794555664  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

--------------------------m.shape torch.Size([46, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2929239273071289  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2929239273071289  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2934150695800781  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29826784133911133  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([96, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29904747009277344  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29904747009277344  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 96, 1433]), torch.Size([1, 96, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.30007266998291016  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3155965805053711  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 96, 1433])
--------------------------m.shape torch.Size([105, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31676578521728516  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31676578521728516  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 105, 1433]), torch.Size([1, 105, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3178873062133789  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3425564765930176  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 105, 1433])
--------------------------m.shape torch.Size([107, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3442807197570801  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3442807197570801  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 107, 1433]), torch.Size([1, 107, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.34542322158813477  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3785557746887207  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 107, 1433])
--------------------------m.shape torch.Size([87, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3803067207336426  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3803067207336426  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 87, 1433]), torch.Size([1, 87, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.38123559951782227  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.41562891006469727  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 87, 1433])
--------------------------m.shape torch.Size([60, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4170866012573242  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4170866012573242  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 60, 1433]), torch.Size([1, 60, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4177274703979492  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.44595813751220703  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 60, 1433])
--------------------------m.shape torch.Size([34, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.44690847396850586  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.44690847396850586  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.44727182388305664  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46542930603027344  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([23, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4664015769958496  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4664015769958496  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4666476249694824  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.480649471282959  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([8, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4809112548828125  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4809112548828125  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.48099708557128906  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4864773750305176  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([66, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4899578094482422  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4899578094482422  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 66, 1433]), torch.Size([1, 66, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4906625747680664  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.540959358215332  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 66, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5283193588256836  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5289220809936523  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5296707153320312  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

--------------------------m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5303120613098145  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5303120613098145  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5303502082824707  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5306553840637207  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 20, 256])
--------------------------m.shape torch.Size([25, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5306844711303711  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5306844711303711  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5307321548461914  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5314474105834961  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 25, 256])
--------------------------m.shape torch.Size([26, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.531498908996582  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.531498908996582  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5315485000610352  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5326395034790039  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 26, 256])
--------------------------m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5326995849609375  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5326995849609375  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5327415466308594  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5339584350585938  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 22, 256])
--------------------------m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5340099334716797  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5340099334716797  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5340385437011719  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5350685119628906  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5351181030273438  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5351181030273438  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5351390838623047  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.536041259765625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5360579490661621  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5360579490661621  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5360655784606934  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5364470481872559  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5364665985107422  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5364665985107422  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5364723205566406  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5367984771728516  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5368304252624512  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5368304252624512  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5368380546569824  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5373263359069824  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5373516082763672  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5373516082763672  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5373573303222656  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5377635955810547  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5377717018127441  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5377717018127441  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.537773609161377  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5379223823547363  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5379447937011719  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5379447937011719  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5379486083984375  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382728576660156  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382895469665527  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382895469665527  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382914543151855  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385470390319824  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385665893554688  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385665893554688  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385684967041016  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5388507843017578  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5388979911804199  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5388979911804199  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5389018058776855  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5395731925964355  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5390915870666504  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.539095401763916  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5390763282775879  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5390810966491699  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

pure train time  0.1836259365081787
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2770042419433594  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8021183013916016
loading full batch data spends  0.0025734901428222656
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   4.124641418457031e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.27695703506469727  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

--------------------------m.shape torch.Size([46, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29292917251586914  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29292917251586914  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29342031478881836  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29827260971069336  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([97, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29906272888183594  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29906272888183594  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 97, 1433]), torch.Size([1, 97, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3000984191894531  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3157029151916504  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 97, 1433])
--------------------------m.shape torch.Size([106, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3168830871582031  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3168830871582031  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 106, 1433]), torch.Size([1, 106, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31801509857177734  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.34291505813598633  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 106, 1433])
--------------------------m.shape torch.Size([109, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3446769714355469  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3446769714355469  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 109, 1433]), torch.Size([1, 109, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3458414077758789  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3805708885192871  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 109, 1433])
--------------------------m.shape torch.Size([83, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.382204532623291  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.382204532623291  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 83, 1433]), torch.Size([1, 83, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.38309144973754883  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.41503381729125977  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 83, 1433])
--------------------------m.shape torch.Size([59, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.41648054122924805  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.41648054122924805  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 59, 1433]), torch.Size([1, 59, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4171109199523926  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4446864128112793  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 59, 1433])
--------------------------m.shape torch.Size([35, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4456791877746582  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4456791877746582  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.44605302810668945  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46474504470825195  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([22, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4654979705810547  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4654979705810547  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.46573352813720703  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4791374206542969  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([8, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4794044494628906  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4794044494628906  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4794902801513672  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4849705696105957  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([68, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4885578155517578  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4885578155517578  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 68, 1433]), torch.Size([1, 68, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4892845153808594  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5421504974365234  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 68, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5294718742370605  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5300755500793457  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5308256149291992  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

--------------------------m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5314669609069824  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5314669609069824  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5315051078796387  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5318102836608887  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 20, 256])
--------------------------m.shape torch.Size([25, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5318393707275391  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5318393707275391  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5318870544433594  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5326023101806641  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 25, 256])
--------------------------m.shape torch.Size([26, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.53265380859375  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.53265380859375  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5327033996582031  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5337944030761719  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 26, 256])
--------------------------m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5338544845581055  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5338544845581055  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5338964462280273  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5351133346557617  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 22, 256])
--------------------------m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5351648330688477  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5351648330688477  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5351934432983398  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5362234115600586  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5362730026245117  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5362730026245117  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5362939834594727  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.537196159362793  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5372128486633301  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5372128486633301  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5372204780578613  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5376019477844238  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5376214981079102  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5376214981079102  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5376272201538086  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5379533767700195  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5379853248596191  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5379853248596191  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5379929542541504  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5384812355041504  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385065078735352  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385065078735352  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385122299194336  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5389184951782227  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5389266014099121  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5389266014099121  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5389285087585449  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5390772819519043  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5390996932983398  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5390996932983398  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5391035079956055  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5394277572631836  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5394444465637207  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5394444465637207  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5394463539123535  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5397019386291504  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5397214889526367  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5397214889526367  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5397233963012695  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5400056838989258  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5400528907775879  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5400528907775879  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5400567054748535  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5407280921936035  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5402464866638184  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.540250301361084  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5402312278747559  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5402359962463379  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

pure train time  0.17563557624816895
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2769775390625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7370895147323608
loading full batch data spends  0.0026710033416748047
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   4.57763671875e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.27698373794555664  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

--------------------------m.shape torch.Size([45, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29297733306884766  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.29297733306884766  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2934579849243164  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2973031997680664  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
--------------------------m.shape torch.Size([95, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2981605529785156  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2981605529785156  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 95, 1433]), torch.Size([1, 95, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.2991752624511719  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.31458330154418945  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 95, 1433])
--------------------------m.shape torch.Size([103, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3158078193664551  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3158078193664551  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 103, 1433]), torch.Size([1, 103, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3169083595275879  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.34163570404052734  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 103, 1433])
--------------------------m.shape torch.Size([107, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3433704376220703  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.3433704376220703  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 107, 1433]), torch.Size([1, 107, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.344512939453125  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.37764549255371094  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 107, 1433])
--------------------------m.shape torch.Size([85, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.37934350967407227  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.37934350967407227  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 85, 1433]), torch.Size([1, 85, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.380251407623291  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.41382265090942383  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 85, 1433])
--------------------------m.shape torch.Size([60, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.41529083251953125  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.41529083251953125  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 60, 1433]), torch.Size([1, 60, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.41593170166015625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.44453001022338867  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 60, 1433])
--------------------------m.shape torch.Size([34, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4454803466796875  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4454803466796875  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4458436965942383  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4640011787414551  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([23, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4650707244873047  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4650707244873047  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4653167724609375  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.47931861877441406  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([8, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4795804023742676  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4795804023742676  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.47966623306274414  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.48514652252197266  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([69, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4887871742248535  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.4887871742248535  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 69, 1433]), torch.Size([1, 69, 1433])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.48952436447143555  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5428242683410645  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 69, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5300922393798828  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5306921005249023  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5314373970031738  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

--------------------------m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.532078742980957  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.532078742980957  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5321168899536133  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5324220657348633  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 20, 256])
--------------------------m.shape torch.Size([25, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5324511528015137  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5324511528015137  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.532498836517334  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5332140922546387  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 25, 256])
--------------------------m.shape torch.Size([26, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5332655906677246  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5332655906677246  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5333151817321777  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5344061851501465  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 26, 256])
--------------------------m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5344662666320801  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5344662666320801  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.534508228302002  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5357251167297363  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 22, 256])
--------------------------m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5357766151428223  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5357766151428223  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5358052253723145  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5368351936340332  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5368847846984863  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5368847846984863  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5369057655334473  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5378079414367676  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5378246307373047  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5378246307373047  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5378322601318359  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382137298583984  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382332801818848  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382332801818848  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5382390022277832  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385651588439941  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385971069335938  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5385971069335938  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.538604736328125  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.539093017578125  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5391182899475098  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5391182899475098  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5391240119934082  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5395302772521973  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5395383834838867  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5395383834838867  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5395402908325195  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5396890640258789  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5397114753723145  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5397114753723145  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5397152900695801  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5400395393371582  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5400562286376953  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5400562286376953  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5400581359863281  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.540313720703125  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5403332710266113  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5403332710266113  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5403351783752441  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5406174659729004  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5406646728515625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5406646728515625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5406684875488281  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5413398742675781  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.540858268737793  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5408620834350586  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5408430099487305  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.208984375 GB
    Memory Allocated: 0.5408477783203125  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

pure train time  0.18154573440551758
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.2770042419433594  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7207854986190796
loading full batch data spends  0.0026595592498779297
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   3.4332275390625e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.27685022354125977  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

--------------------------m.shape torch.Size([46, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.2927584648132324  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.2927584648132324  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.29324960708618164  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.29827260971069336  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([96, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.29905223846435547  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.29905223846435547  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 96, 1433]), torch.Size([1, 96, 1433])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.3000774383544922  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.3155965805053711  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 96, 1433])
--------------------------m.shape torch.Size([104, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.31674957275390625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.31674957275390625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 104, 1433]), torch.Size([1, 104, 1433])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.31786060333251953  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.34229469299316406  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 104, 1433])
--------------------------m.shape torch.Size([109, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.3440670967102051  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.3440670967102051  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 109, 1433]), torch.Size([1, 109, 1433])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.3452315330505371  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.37898874282836914  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 109, 1433])
--------------------------m.shape torch.Size([85, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.3806757926940918  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.3806757926940918  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 85, 1433]), torch.Size([1, 85, 1433])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.38158369064331055  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.4142608642578125  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 85, 1433])
--------------------------m.shape torch.Size([57, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.4156327247619629  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.4156327247619629  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.4162421226501465  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.4440932273864746  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([35, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.445096492767334  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.445096492767334  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 35, 1433]), torch.Size([1, 35, 1433])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.44547033309936523  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.46416234970092773  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 35, 1433])
--------------------------m.shape torch.Size([23, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.46499013900756836  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.46499013900756836  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.46523618698120117  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.47923803329467773  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([8, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.47949981689453125  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.47949981689453125  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.4795856475830078  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.48506593704223633  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([67, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.4885997772216797  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.4885997772216797  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 67, 1433]), torch.Size([1, 67, 1433])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.4893159866333008  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.542381763458252  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 67, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5297565460205078  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5303573608398438  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5311036109924316  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

--------------------------m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5317449569702148  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5317449569702148  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5317831039428711  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5320882797241211  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 20, 256])
--------------------------m.shape torch.Size([25, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5321173667907715  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5321173667907715  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5321650505065918  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5328803062438965  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 25, 256])
--------------------------m.shape torch.Size([26, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5329318046569824  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5329318046569824  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5329813957214355  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5340723991394043  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 26, 256])
--------------------------m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5341324806213379  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5341324806213379  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5341744422912598  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5353913307189941  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 22, 256])
--------------------------m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5354428291320801  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5354428291320801  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5354714393615723  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.536501407623291  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5365509986877441  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5365509986877441  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5365719795227051  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5374741554260254  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5374908447265625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5374908447265625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5374984741210938  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5378799438476562  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5378994941711426  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5378994941711426  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.537905216217041  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.538231372833252  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5382633209228516  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5382633209228516  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5382709503173828  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5387592315673828  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5387845039367676  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5387845039367676  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.538790225982666  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5391964912414551  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5392045974731445  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5392045974731445  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5392065048217773  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5393552780151367  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5393776893615723  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5393776893615723  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5393815040588379  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.539705753326416  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5397224426269531  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5397224426269531  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5397243499755859  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5399799346923828  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5399994850158691  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5399994850158691  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.540001392364502  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5402836799621582  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5403308868408203  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5403308868408203  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5403347015380859  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5410060882568359  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5405244827270508  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5405282974243164  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5405092239379883  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.5405139923095703  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

pure train time  0.1905686855316162
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.2109375 GB
    Memory Allocated: 0.2768707275390625  GigaBytes
Max Memory Allocated: 0.6434698104858398  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6201462745666504
Total (block generation + training)time/epoch 0.2106508527483259
pure train time/epoch 0.18215417861938477

num_input_list  [1347, 1356, 1371, 1367, 1358, 1364, 1358, 1366, 1349, 1346]
