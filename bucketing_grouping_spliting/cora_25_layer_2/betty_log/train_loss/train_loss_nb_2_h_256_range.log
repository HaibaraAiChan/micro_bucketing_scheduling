main start at this time 1697830157.4633427
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
range parition 
range partition time  0.00016069412231445312

block_gen_time in "generate_blocks_for_one_layer_block"  0.005405902862548828


block_gen_time in "generate_blocks_for_one_layer_block"  0.003993034362792969

connection checking time:  0.002707958221435547
block generation total time  0.003993034362792969
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.515625 GB
    Memory Allocated: 0.07157373428344727  GigaBytes
Max Memory Allocated: 0.07157373428344727  GigaBytes

--------------------------m.shape torch.Size([27, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.07947540283203125  GigaBytes
Max Memory Allocated: 0.07947635650634766  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.07947540283203125  GigaBytes
Max Memory Allocated: 0.07947635650634766  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.07976436614990234  GigaBytes
Max Memory Allocated: 0.07976436614990234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.607421875 GB
    Memory Allocated: 0.08207321166992188  GigaBytes
Max Memory Allocated: 0.08221769332885742  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([43, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.607421875 GB
    Memory Allocated: 0.08238792419433594  GigaBytes
Max Memory Allocated: 0.08238935470581055  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.607421875 GB
    Memory Allocated: 0.08238792419433594  GigaBytes
Max Memory Allocated: 0.08238935470581055  GigaBytes

 h.shape torch.Size([1, 43, 1433]), torch.Size([1, 43, 1433])
----------------------------------------3
 Nvidia-smi: 1.609375 GB
    Memory Allocated: 0.08284759521484375  GigaBytes
Max Memory Allocated: 0.08284759521484375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6171875 GB
    Memory Allocated: 0.0897369384765625  GigaBytes
Max Memory Allocated: 0.09019613265991211  GigaBytes

rst.shape  torch.Size([1, 43, 1433])
--------------------------m.shape torch.Size([62, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.6171875 GB
    Memory Allocated: 0.0905003547668457  GigaBytes
Max Memory Allocated: 0.09050273895263672  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6171875 GB
    Memory Allocated: 0.0905003547668457  GigaBytes
Max Memory Allocated: 0.09050273895263672  GigaBytes

 h.shape torch.Size([1, 62, 1433]), torch.Size([1, 62, 1433])
----------------------------------------3
 Nvidia-smi: 1.6171875 GB
    Memory Allocated: 0.09116315841674805  GigaBytes
Max Memory Allocated: 0.09116315841674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.638671875 GB
    Memory Allocated: 0.10573196411132812  GigaBytes
Max Memory Allocated: 0.10685539245605469  GigaBytes

rst.shape  torch.Size([1, 62, 1433])
--------------------------m.shape torch.Size([49, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.638671875 GB
    Memory Allocated: 0.10652399063110352  GigaBytes
Max Memory Allocated: 0.10685539245605469  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.638671875 GB
    Memory Allocated: 0.10652399063110352  GigaBytes
Max Memory Allocated: 0.10685539245605469  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 1.638671875 GB
    Memory Allocated: 0.10704755783081055  GigaBytes
Max Memory Allocated: 0.10704755783081055  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.662109375 GB
    Memory Allocated: 0.12306737899780273  GigaBytes
Max Memory Allocated: 0.1241140365600586  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([34, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.662109375 GB
    Memory Allocated: 0.12371349334716797  GigaBytes
Max Memory Allocated: 0.1241140365600586  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.662109375 GB
    Memory Allocated: 0.12371349334716797  GigaBytes
Max Memory Allocated: 0.1241140365600586  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 1.662109375 GB
    Memory Allocated: 0.12407684326171875  GigaBytes
Max Memory Allocated: 0.1241140365600586  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.677734375 GB
    Memory Allocated: 0.13715028762817383  GigaBytes
Max Memory Allocated: 0.13805818557739258  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([34, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.677734375 GB
    Memory Allocated: 0.13805770874023438  GigaBytes
Max Memory Allocated: 0.1380605697631836  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.677734375 GB
    Memory Allocated: 0.13805770874023438  GigaBytes
Max Memory Allocated: 0.1380605697631836  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 1.677734375 GB
    Memory Allocated: 0.13842105865478516  GigaBytes
Max Memory Allocated: 0.13842105865478516  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.693359375 GB
    Memory Allocated: 0.1540365219116211  GigaBytes
Max Memory Allocated: 0.15512561798095703  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([18, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.6953125 GB
    Memory Allocated: 0.1545276641845703  GigaBytes
Max Memory Allocated: 0.15512561798095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6953125 GB
    Memory Allocated: 0.1545276641845703  GigaBytes
Max Memory Allocated: 0.15512561798095703  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 1.6953125 GB
    Memory Allocated: 0.15472030639648438  GigaBytes
Max Memory Allocated: 0.15512561798095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.703125 GB
    Memory Allocated: 0.16434240341186523  GigaBytes
Max Memory Allocated: 0.16501522064208984  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([12, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.703125 GB
    Memory Allocated: 0.16475868225097656  GigaBytes
Max Memory Allocated: 0.16501522064208984  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.703125 GB
    Memory Allocated: 0.16475868225097656  GigaBytes
Max Memory Allocated: 0.16501522064208984  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 1.703125 GB
    Memory Allocated: 0.1648874282836914  GigaBytes
Max Memory Allocated: 0.16501522064208984  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.708984375 GB
    Memory Allocated: 0.17220306396484375  GigaBytes
Max Memory Allocated: 0.1727156639099121  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.708984375 GB
    Memory Allocated: 0.1723313331604004  GigaBytes
Max Memory Allocated: 0.1727156639099121  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.708984375 GB
    Memory Allocated: 0.1723313331604004  GigaBytes
Max Memory Allocated: 0.1727156639099121  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 1.708984375 GB
    Memory Allocated: 0.17237424850463867  GigaBytes
Max Memory Allocated: 0.1727156639099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7109375 GB
    Memory Allocated: 0.17512083053588867  GigaBytes
Max Memory Allocated: 0.17531347274780273  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([32, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.7109375 GB
    Memory Allocated: 0.17680788040161133  GigaBytes
Max Memory Allocated: 0.17681169509887695  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7109375 GB
    Memory Allocated: 0.17680788040161133  GigaBytes
Max Memory Allocated: 0.17681169509887695  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 1.712890625 GB
    Memory Allocated: 0.17715024948120117  GigaBytes
Max Memory Allocated: 0.17715024948120117  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.2014155387878418  GigaBytes
Max Memory Allocated: 0.2031240463256836  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19518423080444336  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19548463821411133  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19585800170898438  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19616174697875977  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19616174697875977  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19617891311645508  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19631624221801758  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19632720947265625  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19632720947265625  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19634628295898438  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19663238525390625  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19666624069213867  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19666624069213867  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19669485092163086  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19732427597045898  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([13, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19736003875732422  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19736003875732422  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19738483428955078  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.1981039047241211  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19813013076782227  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19813013076782227  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19814538955688477  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19869470596313477  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19872760772705078  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19872760772705078  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19874095916748047  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19931507110595703  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19932222366333008  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19932222366333008  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.1993260383605957  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19951677322387695  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.1995229721069336  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.1995229721069336  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.1995248794555664  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19963359832763672  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19965028762817383  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19965028762817383  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19965410232543945  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19989824295043945  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19991588592529297  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.19991588592529297  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.1999197006225586  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.20019054412841797  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.20020723342895508  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.20020723342895508  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.2002091407775879  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.20046472549438477  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.2002410888671875  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.2002429962158203  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.20024394989013672  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.740234375 GB
    Memory Allocated: 0.20024681091308594  GigaBytes
Max Memory Allocated: 0.20628929138183594  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.13994979858398438  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

--------------------------m.shape torch.Size([18, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.15031194686889648  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.15031194686889648  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.15050458908081055  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.15204429626464844  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([53, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.15251398086547852  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.15251398086547852  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.15308046340942383  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.1627359390258789  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([47, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.16320562362670898  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.16320562362670898  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.16370820999145508  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.17570972442626953  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([67, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.17688941955566406  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.17688941955566406  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 67, 1433]), torch.Size([1, 67, 1433])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.17760562896728516  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.19928693771362305  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 67, 1433])
--------------------------m.shape torch.Size([56, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2004237174987793  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2004237174987793  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 56, 1433]), torch.Size([1, 56, 1433])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.20102167129516602  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2225480079650879  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 56, 1433])
--------------------------m.shape torch.Size([31, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.22324228286743164  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.22324228286743164  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.22357416152954102  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.23781919479370117  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([18, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2383260726928711  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2383260726928711  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.23851871490478516  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.24814081192016602  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([14, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2486424446105957  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2486424446105957  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.24879217147827148  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.25731515884399414  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2574806213378906  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2574806213378906  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2575340270996094  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2609519958496094  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([51, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.26364803314208984  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.26364803314208984  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2641925811767578  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3033323287963867  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2951693534851074  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29551267623901367  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29593896865844727  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

--------------------------m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.296292781829834  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.296292781829834  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2963137626647949  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2964816093444824  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([15, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29650020599365234  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29650020599365234  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29652881622314453  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29695796966552734  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29697561264038086  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29697561264038086  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2969965934753418  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2974581718444824  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2974824905395508  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2974824905395508  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2974996566772461  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29799747467041016  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2980227470397949  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2980227470397949  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2980360984802246  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29851675033569336  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29853343963623047  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29853343963623047  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2985410690307617  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29886913299560547  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29887914657592773  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29887914657592773  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29888296127319336  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2990736961364746  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2990875244140625  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2990875244140625  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2990913391113281  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29930877685546875  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29932451248168945  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29932451248168945  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2993283271789551  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2995724678039551  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29958057403564453  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29958057403564453  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29958248138427734  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29971790313720703  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2997279167175293  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2997279167175293  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2997298240661621  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.2998785972595215  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29990100860595703  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29990100860595703  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.29990482330322266  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3002290725708008  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3002476692199707  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3002476692199707  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3002495765686035  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.30053186416625977  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3005790710449219  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3005790710449219  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3005828857421875  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3012542724609375  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3009815216064453  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3009834289550781  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.3009824752807617  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.876953125 GB
    Memory Allocated: 0.30098485946655273  GigaBytes
Max Memory Allocated: 0.319643497467041  GigaBytes

pure train time  0.7302711009979248
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.27468109130859375  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9441065788269043
range parition 
range partition time  8.296966552734375e-05

block_gen_time in "generate_blocks_for_one_layer_block"  0.004103422164916992


block_gen_time in "generate_blocks_for_one_layer_block"  0.004130840301513672

connection checking time:  0.002609729766845703
block generation total time  0.004130840301513672
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.27401018142700195  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

--------------------------m.shape torch.Size([27, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.2822542190551758  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.2822542190551758  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.2825431823730469  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.2848520278930664  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([47, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.28520965576171875  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.28520965576171875  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.28571224212646484  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.29343318939208984  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([56, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.2940788269042969  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.2940788269042969  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

 h.shape torch.Size([1, 56, 1433]), torch.Size([1, 56, 1433])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.2946767807006836  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3085360527038574  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

rst.shape  torch.Size([1, 56, 1433])
--------------------------m.shape torch.Size([55, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.30941152572631836  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.30941152572631836  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3099989891052246  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.32770538330078125  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([44, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3285861015319824  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3285861015319824  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

 h.shape torch.Size([1, 44, 1433]), torch.Size([1, 44, 1433])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3290562629699707  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3459749221801758  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

rst.shape  torch.Size([1, 44, 1433])
--------------------------m.shape torch.Size([36, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.346893310546875  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.346893310546875  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

 h.shape torch.Size([1, 36, 1433]), torch.Size([1, 36, 1433])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3472785949707031  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.36382007598876953  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

rst.shape  torch.Size([1, 36, 1433])
--------------------------m.shape torch.Size([14, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3641510009765625  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3641510009765625  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3643007278442383  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3717770576477051  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3720870018005371  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3720870018005371  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.37218332290649414  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3776736259460449  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.37781810760498047  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.37781810760498047  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.37786102294921875  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.38060760498046875  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([36, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3825082778930664  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.3825082778930664  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

 h.shape torch.Size([1, 36, 1433]), torch.Size([1, 36, 1433])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.38289356231689453  GigaBytes
Max Memory Allocated: 0.41159582138061523  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4102058410644531  GigaBytes
Max Memory Allocated: 0.4121279716491699  GigaBytes

rst.shape  torch.Size([1, 36, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40368175506591797  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4039945602416992  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40438270568847656  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

--------------------------m.shape torch.Size([13, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40469884872436523  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40469884872436523  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4047236442565918  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4049220085144043  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4049348831176758  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4049348831176758  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40495967864990234  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4053316116333008  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4053483009338379  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4053483009338379  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.405367374420166  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40578699111938477  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4058198928833008  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4058198928833008  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4058408737182617  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4064493179321289  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4064774513244629  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4064774513244629  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4064927101135254  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4070420265197754  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4070749282836914  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4070749282836914  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4070882797241211  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40766239166259766  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4076695442199707  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4076695442199707  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40767335891723633  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4078640937805176  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4078702926635742  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4078702926635742  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40787220001220703  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40798091888427734  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40799760818481445  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40799760818481445  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4080014228820801  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4082455635070801  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40825462341308594  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40825462341308594  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40825653076171875  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4084053039550781  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40845251083374023  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40845251083374023  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40845632553100586  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40912771224975586  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40889453887939453  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40889644622802734  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.40888500213623047  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.033203125 GB
    Memory Allocated: 0.4088878631591797  GigaBytes
Max Memory Allocated: 0.4152674674987793  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2746586799621582  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

--------------------------m.shape torch.Size([19, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28401994705200195  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28401994705200195  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2842230796813965  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2858467102050781  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([51, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28628969192504883  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28628969192504883  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2868342399597168  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2950625419616699  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([52, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2956233024597168  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2956233024597168  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 52, 1433]), torch.Size([1, 52, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.29617929458618164  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.30852317810058594  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 52, 1433])
--------------------------m.shape torch.Size([57, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3094625473022461  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3094625473022461  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3100719451904297  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.32820796966552734  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([52, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.32929134368896484  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.32929134368896484  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 52, 1433]), torch.Size([1, 52, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3298473358154297  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3498415946960449  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 52, 1433])
--------------------------m.shape torch.Size([31, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3505687713623047  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3505687713623047  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.35090065002441406  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3651456832885742  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([22, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3658022880554199  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3658022880554199  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.36603784561157227  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3777956962585449  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([16, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.37836122512817383  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.37836122512817383  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.37853288650512695  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.38828325271606445  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.38843774795532227  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.38843774795532227  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.388491153717041  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.391909122467041  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([45, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.394284725189209  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.394284725189209  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.39476537704467773  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.428891658782959  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4212784767150879  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4216122627258301  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4220266342163086  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

--------------------------m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4223666191101074  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4223666191101074  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4223799705505371  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4224867820739746  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4225034713745117  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4225034713745117  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42252635955810547  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4228696823120117  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([16, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42290449142456055  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42290449142456055  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42293500900268555  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42360639572143555  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 16, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4236335754394531  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4236335754394531  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42365455627441406  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42426300048828125  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4242863655090332  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4242863655090332  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4242997169494629  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42478036880493164  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42479705810546875  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42479705810546875  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4248046875  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42513275146484375  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.425142765045166  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.425142765045166  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42514657974243164  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4253373146057129  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4253511428833008  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4253511428833008  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4253549575805664  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42557239532470703  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42558813095092773  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42558813095092773  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42559194564819336  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42583608627319336  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42586326599121094  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42586326599121094  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4258689880371094  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42627525329589844  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42629575729370117  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42629575729370117  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4262995719909668  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4266238212585449  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42664051055908203  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42664051055908203  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42664241790771484  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4268980026245117  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42691755294799805  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42691755294799805  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42691946029663086  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4272017478942871  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4269399642944336  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4269418716430664  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42694091796875  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.426943302154541  GigaBytes
Max Memory Allocated: 0.5225419998168945  GigaBytes

pure train time  0.2880897521972656
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.27468109130859375  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9196040630340576
range parition 
range partition time  7.486343383789062e-05

block_gen_time in "generate_blocks_for_one_layer_block"  0.0037033557891845703


block_gen_time in "generate_blocks_for_one_layer_block"  0.004290342330932617

connection checking time:  0.0032494068145751953
block generation total time  0.004290342330932617
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2745990753173828  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

--------------------------m.shape torch.Size([16, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2841315269470215  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2841315269470215  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2843031883239746  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2856721878051758  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([49, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28610992431640625  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28610992431640625  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2866334915161133  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.29616832733154297  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([61, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.29688358306884766  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.29688358306884766  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 61, 1433]), torch.Size([1, 61, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2975349426269531  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3121647834777832  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 61, 1433])
--------------------------m.shape torch.Size([62, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.31316328048706055  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.31316328048706055  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 62, 1433]), torch.Size([1, 62, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3138260841369629  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.33303022384643555  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 62, 1433])
--------------------------m.shape torch.Size([49, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.33400678634643555  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.33400678634643555  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3345303535461426  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.35344648361206055  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([39, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3544340133666992  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3544340133666992  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 39, 1433]), torch.Size([1, 39, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.35485076904296875  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.37276268005371094  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 39, 1433])
--------------------------m.shape torch.Size([25, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3734889030456543  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3734889030456543  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.37375593185424805  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.38710737228393555  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.38744401931762695  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.38744401931762695  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.38756227493286133  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3942685127258301  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.39440202713012695  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.39440202713012695  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.39444494247436523  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.39719152450561523  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([44, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3995189666748047  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3995189666748047  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 44, 1433]), torch.Size([1, 44, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.39998912811279297  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43335628509521484  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 44, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4256153106689453  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42595863342285156  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42638492584228516  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42673492431640625  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42673492431640625  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42675209045410156  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42688941955566406  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([17, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4269137382507324  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4269137382507324  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42694616317749023  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4274325370788574  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 17, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4274454116821289  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4274454116821289  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42746448516845703  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4278841018676758  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42789793014526367  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42789793014526367  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42790937423706055  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4282412528991699  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42827892303466797  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42827892303466797  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4282960891723633  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42891407012939453  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4289402961730957  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4289402961730957  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4289517402648926  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4294438362121582  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4294586181640625  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4294586181640625  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42946434020996094  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4297504425048828  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42977094650268555  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42977094650268555  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.429776668548584  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4301028251647949  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43010902404785156  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43010902404785156  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4301109313964844  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4302330017089844  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43024206161499023  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43024206161499023  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43024396896362305  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43037939071655273  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4304018020629883  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4304018020629883  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4304056167602539  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43072986602783203  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43074655532836914  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43074655532836914  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43074846267700195  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43100404739379883  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43102359771728516  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43102359771728516  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43102550506591797  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4313077926635742  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43133115768432617  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43133115768432617  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.431333065032959  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.431668758392334  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.431398868560791  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43140077590942383  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43138933181762695  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43139219284057617  GigaBytes
Max Memory Allocated: 0.5391678810119629  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2746577262878418  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

--------------------------m.shape torch.Size([30, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28314781188964844  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28314781188964844  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28346824645996094  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28603172302246094  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([49, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2863950729370117  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2863950729370117  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28691864013671875  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2957592010498047  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([49, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2962822914123535  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2962822914123535  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.29680585861206055  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3089766502380371  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([54, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.30986833572387695  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.30986833572387695  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 54, 1433]), torch.Size([1, 54, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.31044530868530273  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.32717180252075195  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 54, 1433])
--------------------------m.shape torch.Size([46, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3282794952392578  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3282794952392578  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.32877063751220703  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3464517593383789  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([30, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3471674919128418  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3471674919128418  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3474879264831543  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3612666130065918  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([11, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.36151790618896484  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.36151790618896484  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3616361618041992  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.36751890182495117  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([15, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.368100643157959  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.368100643157959  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.36826086044311523  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3773932456970215  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3775057792663574  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3775057792663574  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3775486946105957  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3802952766418457  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([42, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.38251638412475586  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.38251638412475586  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 42, 1433]), torch.Size([1, 42, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3829655647277832  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41481447219848633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 42, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.40804004669189453  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4083547592163086  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.40874528884887695  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

--------------------------m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.40905284881591797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.40905284881591797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4090738296508789  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4092416763305664  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.40924692153930664  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.40924692153930664  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.40926218032836914  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.40949106216430664  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([16, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4095296859741211  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4095296859741211  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4095602035522461  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4102315902709961  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 16, 256])
--------------------------m.shape torch.Size([16, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4102778434753418  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4102778434753418  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4103083610534668  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4111933708190918  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 16, 256])
--------------------------m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4112071990966797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4112071990966797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41121864318847656  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41163063049316406  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.411653995513916  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.411653995513916  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4116635322570801  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41207361221313477  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4120759963989258  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4120759963989258  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4120779037475586  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4121732711791992  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.412198543548584  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.412198543548584  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4122042655944824  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4125704765319824  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41258716583251953  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41258716583251953  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41259098052978516  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41286182403564453  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4128708839416504  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4128708839416504  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4128727912902832  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4130215644836426  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41304492950439453  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41304492950439453  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41304683685302734  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41338253021240234  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41315698623657227  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4131588935852051  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.41315793991088867  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4131603240966797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

pure train time  0.30642008781433105
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.27467918395996094  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8955039978027344
loading full batch data spends  0.004354238510131836
range parition 
range partition time  9.72747802734375e-05

block_gen_time in "generate_blocks_for_one_layer_block"  0.003659963607788086


block_gen_time in "generate_blocks_for_one_layer_block"  0.00424504280090332

connection checking time:  0.002810955047607422
block generation total time  0.00424504280090332
generate_dataloader_block spend   0.01404261589050293
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2743535041809082  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

--------------------------m.shape torch.Size([17, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28375244140625  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.28375244140625  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2839345932006836  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2853889465332031  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([47, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2857999801635742  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2857999801635742  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2863025665283203  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.29482460021972656  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([48, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.29534244537353516  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.29534244537353516  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 48, 1433]), torch.Size([1, 48, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.2958555221557617  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.30750274658203125  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 48, 1433])
--------------------------m.shape torch.Size([59, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.30850648880004883  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.30850648880004883  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 59, 1433]), torch.Size([1, 59, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.30913686752319336  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.327484130859375  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 59, 1433])
--------------------------m.shape torch.Size([53, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3285837173461914  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3285837173461914  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3291501998901367  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3495292663574219  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([38, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3504633903503418  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3504633903503418  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 38, 1433]), torch.Size([1, 38, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.35086965560913086  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.36832189559936523  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 38, 1433])
--------------------------m.shape torch.Size([19, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.36882877349853516  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.36882877349853516  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3690319061279297  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.379178524017334  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([18, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.37984609603881836  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.37984609603881836  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3800387382507324  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3910079002380371  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.39110422134399414  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.39110422134399414  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3911471366882324  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3938937187194824  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([44, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3962211608886719  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.3962211608886719  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 44, 1433]), torch.Size([1, 44, 1433])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.39669132232666016  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.43005847930908203  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 44, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42238616943359375  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4227170944213867  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4231281280517578  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42348146438598633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42348146438598633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42349863052368164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42363595962524414  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4236469268798828  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4236469268798828  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42366600036621094  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4239521026611328  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42397451400756836  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42397451400756836  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4239954948425293  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4244570732116699  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42449283599853516  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42449283599853516  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4245157241821289  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42517948150634766  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42520666122436523  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42520666122436523  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42522192001342773  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42577123641967773  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([8, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4258098602294922  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4258098602294922  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4258251190185547  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4264812469482422  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.426480770111084  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.426480770111084  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4264826774597168  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4265780448913574  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4265928268432617  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4265928268432617  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42659664154052734  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42681407928466797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42683839797973633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42683839797973633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42684412002563477  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42721033096313477  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4272270202636719  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4272270202636719  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4272308349609375  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4275016784667969  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.427523136138916  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.427523136138916  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42752695083618164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42785120010375977  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4278678894042969  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4278678894042969  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4278697967529297  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42812538146972656  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4281487464904785  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4281487464904785  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42815065383911133  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42848634719848633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42821311950683594  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.42821502685546875  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4282035827636719  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.099609375 GB
    Memory Allocated: 0.4282064437866211  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2746567726135254  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

--------------------------m.shape torch.Size([29, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.28287363052368164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.28287363052368164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.28318357467651367  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2856616973876953  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([49, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.28603029251098633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.28603029251098633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.28655385971069336  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2946147918701172  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([62, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2953462600708008  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2953462600708008  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 62, 1433]), torch.Size([1, 62, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2960090637207031  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3109469413757324  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 62, 1433])
--------------------------m.shape torch.Size([52, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.31172609329223633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.31172609329223633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 52, 1433]), torch.Size([1, 52, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.31228208541870117  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3292965888977051  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 52, 1433])
--------------------------m.shape torch.Size([39, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3300600051879883  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3300600051879883  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 39, 1433]), torch.Size([1, 39, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3304767608642578  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3454728126525879  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 39, 1433])
--------------------------m.shape torch.Size([27, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3461294174194336  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3461294174194336  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3464183807373047  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3588266372680664  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([19, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3593921661376953  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3593921661376953  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.35959529876708984  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.36974191665649414  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.36989688873291016  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.36989688873291016  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3699617385864258  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3736238479614258  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.37383174896240234  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.37383174896240234  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3738851547241211  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3773031234741211  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([40, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3794121742248535  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3794121742248535  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 40, 1433]), torch.Size([1, 40, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3798394203186035  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4101738929748535  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 40, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40366649627685547  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4039793014526367  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40436744689941406  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

--------------------------m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40467309951782227  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40467309951782227  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4046940803527832  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4048619270324707  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([15, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4048805236816406  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4048805236816406  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4049091339111328  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4053382873535156  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.405367374420166  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.405367374420166  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4053959846496582  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40602540969848633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4060497283935547  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4060497283935547  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4060688018798828  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40662193298339844  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4066462516784668  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4066462516784668  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4066596031188965  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40714025497436523  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4071512222290039  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4071512222290039  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40715694427490234  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40740299224853516  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40742063522338867  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40742063522338867  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4074263572692871  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.407712459564209  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4077177047729492  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4077177047729492  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40771961212158203  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40782833099365234  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4078364372253418  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4078364372253418  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4078383445739746  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4079604148864746  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40796947479248047  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40796947479248047  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4079713821411133  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40810680389404297  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40811681747436523  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40811681747436523  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40811872482299805  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4082674980163574  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40828704833984375  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40828704833984375  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40828895568847656  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4085712432861328  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40859460830688477  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40859460830688477  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4085965156555176  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4089322090148926  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4087085723876953  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4087104797363281  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.4087095260620117  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.40871191024780273  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

pure train time  0.3095107078552246
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2746772766113281  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8789738416671753
loading full batch data spends  0.0031671524047851562
range parition 
range partition time  6.031990051269531e-05

block_gen_time in "generate_blocks_for_one_layer_block"  0.002997875213623047


block_gen_time in "generate_blocks_for_one_layer_block"  0.0040950775146484375

connection checking time:  0.0026776790618896484
block generation total time  0.0040950775146484375
generate_dataloader_block spend   0.012429475784301758
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2743053436279297  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

--------------------------m.shape torch.Size([25, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2838115692138672  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2838115692138672  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.28407859802246094  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.28621482849121094  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([45, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2865619659423828  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2865619659423828  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.28704261779785156  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2942523956298828  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
--------------------------m.shape torch.Size([65, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.29516124725341797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.29516124725341797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 65, 1433]), torch.Size([1, 65, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.2958555221557617  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.31246280670166016  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 65, 1433])
--------------------------m.shape torch.Size([62, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.31343984603881836  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.31343984603881836  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 62, 1433]), torch.Size([1, 62, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3141026496887207  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.33417177200317383  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 62, 1433])
--------------------------m.shape torch.Size([44, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.33515501022338867  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.33515501022338867  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 44, 1433]), torch.Size([1, 44, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.33562517166137695  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.35254383087158203  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 44, 1433])
--------------------------m.shape torch.Size([39, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3535580635070801  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3535580635070801  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 39, 1433]), torch.Size([1, 39, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3539748191833496  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3718867301940918  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 39, 1433])
--------------------------m.shape torch.Size([15, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3722391128540039  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3722391128540039  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.37239933013916016  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.38041019439697266  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([16, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3810133934020996  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3810133934020996  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.38118505477905273  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.39093542098999023  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([6, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.39113807678222656  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.39113807678222656  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.3912029266357422  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.39531469345092773  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([45, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.39768457412719727  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.39768457412719727  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 2.1015625 GB
    Memory Allocated: 0.398165225982666  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.43229150772094727  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42462968826293945  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4249749183654785  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4254035949707031  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

--------------------------m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4257650375366211  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4257650375366211  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4257841110229492  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4259366989135742  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42594480514526367  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42594480514526367  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.425961971282959  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42621946334838867  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42624855041503906  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42624855041503906  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4262733459472656  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42681884765625  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4268488883972168  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4268488883972168  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42686986923217773  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4274783134460449  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4275016784667969  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4275016784667969  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42751502990722656  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4279956817626953  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42802953720092773  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42802953720092773  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4280428886413574  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.428617000579834  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4286174774169922  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4286174774169922  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.428619384765625  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4287147521972656  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42873716354370117  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42873716354370117  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4287428855895996  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42906904220581055  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4290924072265625  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4290924072265625  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42909812927246094  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42946434020996094  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42948102951049805  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42948102951049805  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42948484420776367  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.42975568771362305  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4297647476196289  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4297647476196289  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4297666549682617  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4299154281616211  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4299330711364746  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4299330711364746  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4299349784851074  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4301905632019043  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4302101135253906  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4302101135253906  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.43021202087402344  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.4304943084716797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.43051767349243164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.43051767349243164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.43051958084106445  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.43085527420043945  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.430574893951416  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.43057680130004883  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.43056535720825195  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.115234375 GB
    Memory Allocated: 0.43056821823120117  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.2746567726135254  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

--------------------------m.shape torch.Size([21, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.28279876708984375  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.28279876708984375  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.2830238342285156  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.2848200798034668  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([54, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.28528451919555664  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.28528451919555664  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 54, 1433]), torch.Size([1, 54, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.2858614921569824  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.2945132255554199  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 54, 1433])
--------------------------m.shape torch.Size([42, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.29489755630493164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.29489755630493164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 42, 1433]), torch.Size([1, 42, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.295346736907959  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.30521583557128906  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 42, 1433])
--------------------------m.shape torch.Size([53, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3061404228210449  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3061404228210449  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.30670690536499023  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.32395124435424805  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([47, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3249225616455078  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3249225616455078  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3254251480102539  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.34375953674316406  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([26, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3443412780761719  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3443412780761719  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3446197509765625  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3565683364868164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([21, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.35721397399902344  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.35721397399902344  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3574390411376953  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.36866235733032227  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3688488006591797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3688488006591797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3689241409301758  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3731956481933594  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3733024597167969  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3733024597167969  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3733348846435547  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3753972053527832  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([41, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.37757015228271484  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.37757015228271484  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 41, 1433]), torch.Size([1, 41, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3780088424682617  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40911293029785156  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 41, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4025602340698242  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4028606414794922  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40323400497436523  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

--------------------------m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4035301208496094  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4035301208496094  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4035491943359375  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4037017822265625  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([16, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40372323989868164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40372323989868164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40375375747680664  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40421152114868164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 16, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4042339324951172  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4042339324951172  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40425872802734375  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4048042297363281  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4048342704772949  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4048342704772949  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40485525131225586  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40546369552612305  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40549182891845703  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40549182891845703  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40550708770751953  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40605640411376953  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40607213973999023  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40607213973999023  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4060797691345215  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40640783309936523  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40642452239990234  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40642452239990234  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4064302444458008  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40671634674072266  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4067225456237793  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4067225456237793  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4067244529724121  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4068465232849121  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40685558319091797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40685558319091797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4068574905395508  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40699291229248047  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.407015323638916  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.407015323638916  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40701913833618164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40734338760375977  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4073657989501953  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4073657989501953  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4073677062988281  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4077033996582031  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4074883460998535  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40749025344848633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4074892997741699  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.40749168395996094  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

pure train time  0.27269721031188965
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.2746772766113281  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8508561849594116
loading full batch data spends  0.002425670623779297
range parition 
range partition time  5.078315734863281e-05

block_gen_time in "generate_blocks_for_one_layer_block"  0.0026280879974365234


block_gen_time in "generate_blocks_for_one_layer_block"  0.003463268280029297

connection checking time:  0.0021572113037109375
block generation total time  0.003463268280029297
generate_dataloader_block spend   0.010425329208374023
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.2745828628540039  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

--------------------------m.shape torch.Size([26, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.28419017791748047  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.28419017791748047  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.2844686508178711  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.28669214248657227  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([53, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.28711891174316406  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.28711891174316406  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.2876853942871094  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.29732751846313477  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([51, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.29786109924316406  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.29786109924316406  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.29840564727783203  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3112306594848633  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([64, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.31232500076293945  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.31232500076293945  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 64, 1433]), torch.Size([1, 64, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.31300878524780273  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.33324670791625977  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 64, 1433])
--------------------------m.shape torch.Size([57, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3344264030456543  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3344264030456543  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3350358009338379  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3569526672363281  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([36, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3578014373779297  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3578014373779297  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 36, 1433]), torch.Size([1, 36, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3581867218017578  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3747282028198242  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 36, 1433])
--------------------------m.shape torch.Size([15, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.37509632110595703  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.37509632110595703  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3752565383911133  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3832674026489258  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.38365745544433594  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.38365745544433594  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3837757110595703  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.39048194885253906  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([8, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3908076286315918  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3908076286315918  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.39089345932006836  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3963737487792969  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([46, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3987865447998047  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3987865447998047  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.3992776870727539  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.43496084213256836  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42722463607788086  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42757463455200195  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4280095100402832  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

--------------------------m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4283580780029297  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4283580780029297  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42838096618652344  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42856407165527344  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([15, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42858171463012695  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42858171463012695  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42861032485961914  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42903947830200195  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42905712127685547  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42905712127685547  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4290781021118164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42953968048095703  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42955636978149414  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42955636978149414  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42956972122192383  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42995691299438477  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42996978759765625  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.42996978759765625  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4299774169921875  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4302520751953125  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4302830696105957  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4302830696105957  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4302945137023926  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4307866096496582  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.43080806732177734  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.43080806732177734  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4308156967163086  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4311971664428711  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.43120908737182617  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.43120908737182617  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4312129020690918  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4314303398132324  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.43146324157714844  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.43146324157714844  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4314708709716797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4319591522216797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.431978702545166  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.431978702545166  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.43198251724243164  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.43230676651000977  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4323234558105469  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4323234558105469  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4323253631591797  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.43258094787597656  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4326004981994629  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4326004981994629  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4326024055480957  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.43288469314575195  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4329080581665039  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4329080581665039  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4329099655151367  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4332456588745117  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4329800605773926  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4329819679260254  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.4329705238342285  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.119140625 GB
    Memory Allocated: 0.43297338485717773  GigaBytes
Max Memory Allocated: 0.5433239936828613  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2746567726135254  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

--------------------------m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28299570083618164  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28299570083618164  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28320932388305664  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28491830825805664  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([45, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2852921485900879  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2852921485900879  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28577280044555664  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2929825782775879  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
--------------------------m.shape torch.Size([58, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2936711311340332  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2936711311340332  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 58, 1433]), torch.Size([1, 58, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29429101943969727  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.30871152877807617  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 58, 1433])
--------------------------m.shape torch.Size([49, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.30955076217651367  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.30955076217651367  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3100743293762207  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.32541799545288086  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([40, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.32622432708740234  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.32622432708740234  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 40, 1433]), torch.Size([1, 40, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.32665157318115234  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.34203243255615234  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 40, 1433])
--------------------------m.shape torch.Size([28, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3427157402038574  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3427157402038574  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.343015193939209  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.35587453842163086  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([21, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3565096855163574  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3565096855163574  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3567347526550293  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36795806884765625  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([14, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36844348907470703  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36844348907470703  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3685932159423828  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37711620330810547  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3770895004272461  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3770895004272461  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37710094451904297  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3777947425842285  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([42, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3800315856933594  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3800315856933594  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 42, 1433]), torch.Size([1, 42, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3804807662963867  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41232967376708984  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 42, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40558671951293945  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40588998794555664  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4062666893005371  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4065728187561035  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4065728187561035  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.406588077545166  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.406710147857666  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4067220687866211  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4067220687866211  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4067411422729492  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4070272445678711  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4070611000061035  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4070611000061035  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4070897102355957  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40771913528442383  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([15, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4077625274658203  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4077625274658203  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4077911376953125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40862083435058594  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4086594581604004  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4086594581604004  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40868043899536133  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4094357490539551  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.409454345703125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.409454345703125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40946388244628906  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40987396240234375  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40987730026245117  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40987730026245117  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.409879207611084  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4099879264831543  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4100160598754883  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4100160598754883  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4100217819213867  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4104280471801758  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41043615341186523  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41043615341186523  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41043806076049805  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4105868339538574  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4106101989746094  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4106101989746094  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4106121063232422  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4109477996826172  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4107208251953125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4107227325439453  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4107217788696289  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4107241630554199  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

pure train time  0.23221945762634277
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2746772766113281  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8129613399505615
loading full batch data spends  0.004040241241455078
range parition 
range partition time  6.556510925292969e-05

block_gen_time in "generate_blocks_for_one_layer_block"  0.003449678421020508


block_gen_time in "generate_blocks_for_one_layer_block"  0.003828763961791992

connection checking time:  0.0028989315032958984
block generation total time  0.003828763961791992
generate_dataloader_block spend   0.013011455535888672
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.27426815032958984  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

--------------------------m.shape torch.Size([28, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2834959030151367  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2834959030151367  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2837953567504883  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28618812561035156  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([46, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.286529541015625  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.286529541015625  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2870206832885742  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29467010498046875  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([59, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29536962509155273  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29536962509155273  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 59, 1433]), torch.Size([1, 59, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29600000381469727  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3112354278564453  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 59, 1433])
--------------------------m.shape torch.Size([60, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.31220149993896484  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.31220149993896484  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 60, 1433]), torch.Size([1, 60, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.31284236907958984  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3318181037902832  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 60, 1433])
--------------------------m.shape torch.Size([51, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3328590393066406  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3328590393066406  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3334035873413086  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.35300731658935547  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([38, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.35395240783691406  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.35395240783691406  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 38, 1433]), torch.Size([1, 38, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3543586730957031  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3718109130859375  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 38, 1433])
--------------------------m.shape torch.Size([18, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3722805976867676  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3722805976867676  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37247323989868164  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3820953369140625  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([13, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3825545310974121  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3825545310974121  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3826937675476074  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39061880111694336  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([6, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3908376693725586  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3908376693725586  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3909025192260742  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39501428604125977  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([39, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.397064208984375  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.397064208984375  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 39, 1433]), torch.Size([1, 39, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39748096466064453  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42705631256103516  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 39, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41969966888427734  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4200410842895508  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42046499252319336  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

--------------------------m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4208049774169922  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4208049774169922  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4208240509033203  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4209766387939453  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([14, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42099428176879883  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42099428176879883  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4210209846496582  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42142152786254883  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42144012451171875  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42144012451171875  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4214611053466797  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4219226837158203  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4219508171081543  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4219508171081543  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4219698905944824  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42252302169799805  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([10, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4225616455078125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4225616455078125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4225807189941406  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4232673645019531  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4232754707336426  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4232754707336426  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.423281192779541  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42352724075317383  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4235382080078125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4235382080078125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4235420227050781  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4237327575683594  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4237542152404785  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4237542152404785  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42375993728637695  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4240860939025879  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42410945892333984  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42410945892333984  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4241151809692383  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4244813919067383  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42449045181274414  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42449045181274414  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42449235916137695  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.424654483795166  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42467212677001953  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42467212677001953  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42467403411865234  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4249296188354492  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42494916915893555  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42494916915893555  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42495107650756836  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4252333641052246  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42525672912597656  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42525672912597656  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4252586364746094  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4255943298339844  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4253354072570801  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4253373146057129  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.425325870513916  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42532873153686523  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2746577262878418  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

--------------------------m.shape torch.Size([18, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28304100036621094  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28304100036621094  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.283233642578125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2847733497619629  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([50, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28521108627319336  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28521108627319336  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28574514389038086  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29474592208862305  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([53, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29532814025878906  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29532814025878906  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2958946228027344  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3084073066711426  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([53, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.30925607681274414  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.30925607681274414  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.30982255935668945  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.32623910903930664  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([44, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3273749351501465  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3273749351501465  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 44, 1433]), torch.Size([1, 44, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.32784509658813477  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.34476375579833984  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 44, 1433])
--------------------------m.shape torch.Size([28, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3454256057739258  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3454256057739258  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.34572505950927734  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3585844039916992  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([19, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3591446876525879  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3591446876525879  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3593478202819824  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3694944381713867  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36986303329467773  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36986303329467773  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3699812889099121  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37668752670288086  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3767247200012207  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3767247200012207  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37674665451049805  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3781247138977051  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([43, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38040924072265625  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38040924072265625  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 43, 1433]), torch.Size([1, 43, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38086891174316406  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41347694396972656  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 43, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4066910743713379  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4069972038269043  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4073772430419922  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

--------------------------m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40769481658935547  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40769481658935547  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4077138900756836  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4078664779663086  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40787839889526367  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40787839889526367  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4078993797302246  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40821409225463867  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4082469940185547  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4082469940185547  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4082756042480469  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.408905029296875  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4089369773864746  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4089369773864746  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40895986557006836  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4096236228942871  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4096364974975586  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4096364974975586  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40964603424072266  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4099893569946289  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([8, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4100308418273926  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4100308418273926  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4100461006164551  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4107022285461426  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4107084274291992  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4107084274291992  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41071224212646484  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4109029769897461  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41091012954711914  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41091012954711914  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41091203689575195  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41103410720825195  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41106224060058594  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41106224060058594  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4110679626464844  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41147422790527344  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4114823341369629  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4114823341369629  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4114842414855957  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4116330146789551  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41164398193359375  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41164398193359375  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41164588928222656  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4118080139160156  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4118313789367676  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4118313789367676  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4118332862854004  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4121689796447754  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41193246841430664  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41193437576293945  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41193342208862305  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41193580627441406  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

pure train time  0.24004054069519043
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.27467918395996094  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.799551248550415
loading full batch data spends  0.003627777099609375
range parition 
range partition time  8.249282836914062e-05

block_gen_time in "generate_blocks_for_one_layer_block"  0.0034737586975097656


block_gen_time in "generate_blocks_for_one_layer_block"  0.004219770431518555

connection checking time:  0.0026509761810302734
block generation total time  0.004219770431518555
generate_dataloader_block spend   0.013657093048095703
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.27394580841064453  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

--------------------------m.shape torch.Size([28, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28176212310791016  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28176212310791016  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2820615768432617  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.284454345703125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([42, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28475332260131836  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28475332260131836  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 42, 1433]), torch.Size([1, 42, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2852025032043457  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2919316291809082  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 42, 1433])
--------------------------m.shape torch.Size([42, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29237985610961914  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29237985610961914  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 42, 1433]), torch.Size([1, 42, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2928290367126465  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.30269813537597656  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 42, 1433])
--------------------------m.shape torch.Size([46, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3036227226257324  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3036227226257324  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.30411386489868164  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3190913200378418  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([42, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3207530975341797  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3207530975341797  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 42, 1433]), torch.Size([1, 42, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.32120227813720703  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.33735132217407227  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 42, 1433])
--------------------------m.shape torch.Size([26, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.33795976638793945  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.33795976638793945  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3382382392883301  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.350186824798584  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([18, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3507204055786133  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3507204055786133  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.35091304779052734  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3605351448059082  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36090898513793945  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36090898513793945  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36102724075317383  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3677334785461426  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3677706718444824  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3677706718444824  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36779260635375977  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3691706657409668  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([41, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37134885787963867  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37134885787963867  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 41, 1433]), torch.Size([1, 41, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37178754806518555  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4028916358947754  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 41, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39661169052124023  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3968958854675293  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3972487449645996  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

--------------------------m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39753293991088867  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39753293991088867  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3975558280944824  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3977389335632324  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3977508544921875  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3977508544921875  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39777374267578125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3981170654296875  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39813756942749023  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39813756942749023  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39815855026245117  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3986201286315918  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3986520767211914  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3986520767211914  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39867305755615234  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39928150177001953  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39931440353393555  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39931440353393555  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39933156967163086  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3999495506286621  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([8, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39998722076416016  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39998722076416016  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40000247955322266  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40065860748291016  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4006648063659668  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4006648063659668  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4006686210632324  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40085935592651367  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40087318420410156  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40087318420410156  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4008769989013672  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4010944366455078  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40110158920288086  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40110158920288086  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40110349655151367  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40122556686401367  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4012441635131836  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4012441635131836  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4012479782104492  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4015188217163086  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40131664276123047  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4013185501098633  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4013071060180664  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4013099670410156  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2753925323486328  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

--------------------------m.shape torch.Size([18, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28554344177246094  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28554344177246094  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.285736083984375  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2872757911682129  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([57, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28778839111328125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28778839111328125  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28839778900146484  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29827165603637695  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([70, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2991161346435547  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2991161346435547  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 70, 1433]), torch.Size([1, 70, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2998638153076172  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.31630849838256836  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 70, 1433])
--------------------------m.shape torch.Size([70, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3174295425415039  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3174295425415039  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 70, 1433]), torch.Size([1, 70, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3181772232055664  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3399519920349121  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 70, 1433])
--------------------------m.shape torch.Size([50, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.34102964401245117  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.34102964401245117  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.34156370162963867  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36082983016967773  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([38, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36178016662597656  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36178016662597656  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 38, 1433]), torch.Size([1, 38, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3621864318847656  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.379638671875  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 38, 1433])
--------------------------m.shape torch.Size([21, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3802204132080078  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3802204132080078  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3804454803466797  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39166879653930664  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([12, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39206886291503906  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39206886291503906  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3921976089477539  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39951324462890625  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([7, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39978551864624023  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39978551864624023  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39986085891723633  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40465688705444336  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([47, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40712833404541016  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40712833404541016  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40763092041015625  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44452905654907227  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4363260269165039  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43669795989990234  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43715953826904297  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.437532901763916  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.437532901763916  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4375481605529785  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4376702308654785  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43768787384033203  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43768787384033203  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4377126693725586  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43808460235595703  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43811559677124023  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43811559677124023  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4381442070007324  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43877363204956055  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43880176544189453  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43880176544189453  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43882274627685547  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43943119049072266  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4394497871398926  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4394497871398926  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43946123123168945  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43987321853637695  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43988513946533203  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43988513946533203  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43989086151123047  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4401369094848633  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44014787673950195  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44014787673950195  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4401516914367676  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44034242630004883  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44034862518310547  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44034862518310547  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4403505325317383  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4404592514038086  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44048452377319336  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44048452377319336  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4404902458190918  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4408564567565918  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44086360931396484  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44086360931396484  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44086551666259766  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44100093841552734  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4410109519958496  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4410109519958496  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4410128593444824  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4411616325378418  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44118404388427734  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44118404388427734  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44118785858154297  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4415121078491211  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4415287971496582  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4415287971496582  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.441530704498291  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4417862892150879  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4418058395385742  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4418058395385742  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.44180774688720703  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4420900344848633  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4421372413635254  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4421372413635254  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.442141056060791  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.442812442779541  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4425172805786133  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4425191879272461  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4425182342529297  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4425206184387207  GigaBytes
Max Memory Allocated: 0.5454621315002441  GigaBytes

pure train time  0.23908114433288574
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.27541685104370117  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7470020055770874
loading full batch data spends  0.003092527389526367
range parition 
range partition time  6.198883056640625e-05

block_gen_time in "generate_blocks_for_one_layer_block"  0.0032846927642822266


block_gen_time in "generate_blocks_for_one_layer_block"  0.003733396530151367

connection checking time:  0.002768993377685547
block generation total time  0.003733396530151367
generate_dataloader_block spend   0.012520074844360352
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2746572494506836  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

--------------------------m.shape torch.Size([27, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28363895416259766  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28363895416259766  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28392791748046875  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2862367630004883  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([45, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2865729331970215  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2865729331970215  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28705358505249023  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2942633628845215  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
--------------------------m.shape torch.Size([55, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2949042320251465  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2949042320251465  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29549169540405273  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.30866384506225586  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([56, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.31009769439697266  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.31009769439697266  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 56, 1433]), torch.Size([1, 56, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3106956481933594  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3280363082885742  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 56, 1433])
--------------------------m.shape torch.Size([41, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3288865089416504  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3288865089416504  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 41, 1433]), torch.Size([1, 41, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.32932519912719727  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3450965881347656  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 41, 1433])
--------------------------m.shape torch.Size([33, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3459343910217285  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3459343910217285  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.34628725051879883  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36144304275512695  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([21, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36205148696899414  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36205148696899414  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.362276554107666  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37349987030029297  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3738574981689453  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3738574981689453  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3739757537841797  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38068199157714844  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3808631896972656  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3808631896972656  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3809165954589844  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3843345642089844  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([46, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3867635726928711  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3867635726928711  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3872547149658203  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42281103134155273  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41650962829589844  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41683387756347656  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.417236328125  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

--------------------------m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4175691604614258  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4175691604614258  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4175882339477539  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4177408218383789  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4177546501159668  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4177546501159668  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41777753829956055  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4181208610534668  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4181528091430664  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4181528091430664  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4181814193725586  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4188108444213867  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4188389778137207  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4188389778137207  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41885995864868164  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41946840286254883  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4194822311401367  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4194822311401367  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4194917678833008  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41983509063720703  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41985368728637695  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41985368728637695  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4198613166809082  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42018938064575195  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42020606994628906  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42020606994628906  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4202117919921875  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4204978942871094  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42051076889038086  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42051076889038086  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4205145835876465  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4207320213317871  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4207477569580078  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4207477569580078  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42075157165527344  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42099571228027344  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4210038185119629  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4210038185119629  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4210057258605957  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4211411476135254  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42115116119384766  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42115116119384766  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42115306854248047  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42130184173583984  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4213242530822754  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4213242530822754  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.421328067779541  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42165231704711914  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42166900634765625  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42166900634765625  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42167091369628906  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42192649841308594  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42194604873657227  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42194604873657227  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4219479560852051  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42223024368286133  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4219784736633301  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4219803810119629  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4219684600830078  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42197132110595703  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.27422523498535156  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

--------------------------m.shape torch.Size([18, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28301429748535156  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28301429748535156  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2832069396972656  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2847466468811035  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([51, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28519487380981445  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28519487380981445  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2857394218444824  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2942538261413574  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([57, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2948946952819824  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2948946952819824  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.295504093170166  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.31020641326904297  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([56, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3110976219177246  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3110976219177246  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 56, 1433]), torch.Size([1, 56, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.31169557571411133  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3293471336364746  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 56, 1433])
--------------------------m.shape torch.Size([50, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3303828239440918  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3303828239440918  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3309168815612793  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3501429557800293  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([34, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3509650230407715  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3509650230407715  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.35132837295532227  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3669438362121582  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([16, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36736011505126953  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36736011505126953  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36753177642822266  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3760848045349121  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([13, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3765544891357422  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3765544891357422  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3766937255859375  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38461875915527344  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38469362258911133  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38469362258911133  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38472604751586914  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38678836822509766  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([41, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3889613151550293  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3889613151550293  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 41, 1433]), torch.Size([1, 41, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38940000534057617  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.420504093170166  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 41, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4134197235107422  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4137430191040039  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41414451599121094  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

--------------------------m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41446924209594727  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41446924209594727  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4144883155822754  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4146409034729004  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4146566390991211  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4146566390991211  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41468143463134766  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4150533676147461  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4150729179382324  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4150729179382324  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41509389877319336  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.415555477142334  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4155874252319336  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4155874252319336  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41560840606689453  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4162168502807617  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([10, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41625452041625977  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41625452041625977  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4162735939025879  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4169602394104004  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4169912338256836  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4169912338256836  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4170045852661133  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41757869720458984  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41757917404174805  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41757917404174805  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41758108139038086  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4176764488220215  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41768360137939453  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41768360137939453  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41768550872802734  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41779422760009766  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41781091690063477  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41781091690063477  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4178147315979004  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4180588722229004  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4180765151977539  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4180765151977539  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41808032989501953  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4183511734008789  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4183974266052246  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4183974266052246  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41840124130249023  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41907262802124023  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41882801055908203  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41882991790771484  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41882896423339844  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.41883134841918945  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

pure train time  0.2371079921722412
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2742466926574707  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.691556692123413
loading full batch data spends  0.0032770633697509766
range parition 
range partition time  6.747245788574219e-05

block_gen_time in "generate_blocks_for_one_layer_block"  0.0034568309783935547


block_gen_time in "generate_blocks_for_one_layer_block"  0.003602743148803711

connection checking time:  0.0026323795318603516
block generation total time  0.003602743148803711
generate_dataloader_block spend   0.012524127960205078
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2751131057739258  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

--------------------------m.shape torch.Size([21, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28479480743408203  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28479480743408203  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2850198745727539  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2868161201477051  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([64, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2873868942260742  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2873868942260742  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 64, 1433]), torch.Size([1, 64, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2880706787109375  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2991151809692383  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 64, 1433])
--------------------------m.shape torch.Size([62, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29992246627807617  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.29992246627807617  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 62, 1433]), torch.Size([1, 62, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3005852699279785  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3151540756225586  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 62, 1433])
--------------------------m.shape torch.Size([63, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.31616830825805664  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.31616830825805664  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 63, 1433]), torch.Size([1, 63, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.31684160232543945  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3372197151184082  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 63, 1433])
--------------------------m.shape torch.Size([41, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.33797788619995117  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.33797788619995117  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 41, 1433]), torch.Size([1, 41, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.33841657638549805  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3541879653930664  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 41, 1433])
--------------------------m.shape torch.Size([34, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3550577163696289  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3550577163696289  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3554210662841797  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3710365295410156  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([22, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3716773986816406  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3716773986816406  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37191295623779297  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3836708068847656  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3839378356933594  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3839378356933594  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3840341567993164  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3895244598388672  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([6, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38976478576660156  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38976478576660156  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3898296356201172  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39394140243530273  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([51, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39663171768188477  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39663171768188477  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.39717626571655273  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43642663955688477  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42859411239624023  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42894983291625977  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42939186096191406  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42974281311035156  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42974281311035156  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42975425720214844  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.42984580993652344  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([15, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4298691749572754  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4298691749572754  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4298977851867676  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4303269386291504  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([14, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43035316467285156  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43035316467285156  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43037986755371094  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4309673309326172  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4309964179992676  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4309964179992676  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4310173988342285  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4316258430480957  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43164920806884766  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43164920806884766  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43166255950927734  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4321432113647461  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43215417861938477  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43215417861938477  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4321599006652832  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.432405948638916  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4324302673339844  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4324302673339844  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4324378967285156  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4328193664550781  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43282365798950195  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43282365798950195  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43282556533813477  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4329342842102051  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4329509735107422  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4329509735107422  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4329547882080078  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4331989288330078  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4332261085510254  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4332261085510254  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43323183059692383  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4336380958557129  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43364620208740234  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43364620208740234  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43364810943603516  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43379688262939453  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43381452560424805  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43381452560424805  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43381643295288086  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43407201766967773  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43409156799316406  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43409156799316406  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4340934753417969  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4343757629394531  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4343991279602051  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4343991279602051  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4344010353088379  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4347367286682129  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4344630241394043  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4344649314880371  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43445348739624023  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.43445634841918945  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.27422428131103516  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

--------------------------m.shape torch.Size([25, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2821788787841797  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2821788787841797  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28244590759277344  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28458213806152344  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([34, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28481197357177734  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.28481197357177734  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2851753234863281  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2906227111816406  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([49, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2912259101867676  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2912259101867676  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2917494773864746  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3044776916503906  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([53, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.30534791946411133  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.30534791946411133  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.30591440200805664  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.32233095169067383  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([55, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3235158920288086  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3235158920288086  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.32410335540771484  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3461155891418457  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([30, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3467831611633301  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3467831611633301  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3471035957336426  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3608822822570801  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([15, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3612828254699707  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3612828254699707  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36144304275512695  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.36945390701293945  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([15, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37001466751098633  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37001466751098633  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3701748847961426  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37930727005004883  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37937164306640625  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37937164306640625  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.37940406799316406  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.3814663887023926  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([30, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38305187225341797  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38305187225341797  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.38337230682373047  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40612316131591797  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.399808406829834  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4001030921936035  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4004693031311035  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

--------------------------m.shape torch.Size([14, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4007744789123535  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4007744789123535  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4008011817932129  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4010148048400879  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40102100372314453  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40102100372314453  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40104007720947266  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40132617950439453  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4013514518737793  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4013514518737793  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40137434005737305  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40187788009643555  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40190887451171875  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40190887451171875  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4019298553466797  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4025382995605469  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40256643295288086  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40256643295288086  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40258169174194336  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40313100814819336  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([8, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4031696319580078  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4031696319580078  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4031848907470703  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4038410186767578  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40384912490844727  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40384912490844727  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4038529396057129  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4040703773498535  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4040861129760742  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4040861129760742  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40408992767333984  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40433406829833984  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.404355525970459  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.404355525970459  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4043593406677246  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40468358993530273  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4047060012817383  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4047060012817383  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4047079086303711  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.4050436019897461  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40482330322265625  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40482521057128906  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40482425689697266  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.40482664108276367  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

pure train time  0.23439526557922363
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.150390625 GB
    Memory Allocated: 0.2742447853088379  GigaBytes
Max Memory Allocated: 0.552879810333252  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6261417865753174
Total (block generation + training)time/epoch 0.3104760987418039
pure train time/epoch 0.24259026845296225

num_input_list  [1763, 1754, 1789, 1746, 1726, 1797, 1743, 1817, 1748, 1729]
