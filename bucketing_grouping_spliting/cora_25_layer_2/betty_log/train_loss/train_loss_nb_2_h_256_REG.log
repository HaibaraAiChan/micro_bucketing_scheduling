main start at this time 1697829006.1703901
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 23.817 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.817 GB
Metis partitioning: 0.000 seconds, peak memory: 23.817 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009875059127807617
pure dgl.metis_partition the time spent:  0.0032320022583007812

block_gen_time in "generate_blocks_for_one_layer_block"  0.005007505416870117


block_gen_time in "generate_blocks_for_one_layer_block"  0.005372762680053711

connection checking time:  0.007735013961791992
block generation total time  0.010380268096923828
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.515625 GB
    Memory Allocated: 0.07192802429199219  GigaBytes
Max Memory Allocated: 0.07192802429199219  GigaBytes

--------------------------m.shape torch.Size([19, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.08117818832397461  GigaBytes
Max Memory Allocated: 0.08117914199829102  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.08117818832397461  GigaBytes
Max Memory Allocated: 0.08117914199829102  GigaBytes

 h.shape torch.Size([1, 19, 1433]), torch.Size([1, 19, 1433])
----------------------------------------3
 Nvidia-smi: 1.595703125 GB
    Memory Allocated: 0.08138132095336914  GigaBytes
Max Memory Allocated: 0.08138132095336914  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.607421875 GB
    Memory Allocated: 0.08300495147705078  GigaBytes
Max Memory Allocated: 0.08310651779174805  GigaBytes

rst.shape  torch.Size([1, 19, 1433])
--------------------------m.shape torch.Size([48, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.607421875 GB
    Memory Allocated: 0.08341598510742188  GigaBytes
Max Memory Allocated: 0.08341741561889648  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.607421875 GB
    Memory Allocated: 0.08341598510742188  GigaBytes
Max Memory Allocated: 0.08341741561889648  GigaBytes

 h.shape torch.Size([1, 48, 1433]), torch.Size([1, 48, 1433])
----------------------------------------3
 Nvidia-smi: 1.607421875 GB
    Memory Allocated: 0.08392906188964844  GigaBytes
Max Memory Allocated: 0.08392906188964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.62890625 GB
    Memory Allocated: 0.09259366989135742  GigaBytes
Max Memory Allocated: 0.09310626983642578  GigaBytes

rst.shape  torch.Size([1, 48, 1433])
--------------------------m.shape torch.Size([64, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.62890625 GB
    Memory Allocated: 0.09336233139038086  GigaBytes
Max Memory Allocated: 0.09336471557617188  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.62890625 GB
    Memory Allocated: 0.09336233139038086  GigaBytes
Max Memory Allocated: 0.09336471557617188  GigaBytes

 h.shape torch.Size([1, 64, 1433]), torch.Size([1, 64, 1433])
----------------------------------------3
 Nvidia-smi: 1.62890625 GB
    Memory Allocated: 0.09404611587524414  GigaBytes
Max Memory Allocated: 0.09404611587524414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6328125 GB
    Memory Allocated: 0.10908079147338867  GigaBytes
Max Memory Allocated: 0.11010599136352539  GigaBytes

rst.shape  torch.Size([1, 64, 1433])
--------------------------m.shape torch.Size([66, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.6328125 GB
    Memory Allocated: 0.11084461212158203  GigaBytes
Max Memory Allocated: 0.11084842681884766  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6328125 GB
    Memory Allocated: 0.11084461212158203  GigaBytes
Max Memory Allocated: 0.11084842681884766  GigaBytes

 h.shape torch.Size([1, 66, 1433]), torch.Size([1, 66, 1433])
----------------------------------------3
 Nvidia-smi: 1.6328125 GB
    Memory Allocated: 0.11154937744140625  GigaBytes
Max Memory Allocated: 0.11154937744140625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.65625 GB
    Memory Allocated: 0.1319875717163086  GigaBytes
Max Memory Allocated: 0.13339710235595703  GigaBytes

rst.shape  torch.Size([1, 66, 1433])
--------------------------m.shape torch.Size([43, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.65625 GB
    Memory Allocated: 0.1327829360961914  GigaBytes
Max Memory Allocated: 0.13339710235595703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.65625 GB
    Memory Allocated: 0.1327829360961914  GigaBytes
Max Memory Allocated: 0.13339710235595703  GigaBytes

 h.shape torch.Size([1, 43, 1433]), torch.Size([1, 43, 1433])
----------------------------------------3
 Nvidia-smi: 1.65625 GB
    Memory Allocated: 0.13324260711669922  GigaBytes
Max Memory Allocated: 0.13339710235595703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.673828125 GB
    Memory Allocated: 0.14977645874023438  GigaBytes
Max Memory Allocated: 0.1512455940246582  GigaBytes

rst.shape  torch.Size([1, 43, 1433])
--------------------------m.shape torch.Size([31, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.673828125 GB
    Memory Allocated: 0.1510157585144043  GigaBytes
Max Memory Allocated: 0.1512455940246582  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.673828125 GB
    Memory Allocated: 0.1510157585144043  GigaBytes
Max Memory Allocated: 0.1512455940246582  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 1.673828125 GB
    Memory Allocated: 0.15134763717651367  GigaBytes
Max Memory Allocated: 0.15134763717651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7109375 GB
    Memory Allocated: 0.16559267044067383  GigaBytes
Max Memory Allocated: 0.16658592224121094  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([17, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.7109375 GB
    Memory Allocated: 0.1660623550415039  GigaBytes
Max Memory Allocated: 0.16658592224121094  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7109375 GB
    Memory Allocated: 0.1660623550415039  GigaBytes
Max Memory Allocated: 0.16658592224121094  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 1.7109375 GB
    Memory Allocated: 0.1662445068359375  GigaBytes
Max Memory Allocated: 0.16658592224121094  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.71875 GB
    Memory Allocated: 0.17533206939697266  GigaBytes
Max Memory Allocated: 0.17596769332885742  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([14, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.71875 GB
    Memory Allocated: 0.17583894729614258  GigaBytes
Max Memory Allocated: 0.17596769332885742  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.71875 GB
    Memory Allocated: 0.17583894729614258  GigaBytes
Max Memory Allocated: 0.17596769332885742  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 1.71875 GB
    Memory Allocated: 0.17598867416381836  GigaBytes
Max Memory Allocated: 0.17598867416381836  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7265625 GB
    Memory Allocated: 0.18451166152954102  GigaBytes
Max Memory Allocated: 0.18510961532592773  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([6, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.7265625 GB
    Memory Allocated: 0.18472528457641602  GigaBytes
Max Memory Allocated: 0.18510961532592773  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7265625 GB
    Memory Allocated: 0.18472528457641602  GigaBytes
Max Memory Allocated: 0.18510961532592773  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 1.7265625 GB
    Memory Allocated: 0.18479013442993164  GigaBytes
Max Memory Allocated: 0.18510961532592773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.73046875 GB
    Memory Allocated: 0.1889019012451172  GigaBytes
Max Memory Allocated: 0.18919038772583008  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([45, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.73046875 GB
    Memory Allocated: 0.19127178192138672  GigaBytes
Max Memory Allocated: 0.19127750396728516  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.73046875 GB
    Memory Allocated: 0.19127178192138672  GigaBytes
Max Memory Allocated: 0.19127750396728516  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 1.73046875 GB
    Memory Allocated: 0.19175243377685547  GigaBytes
Max Memory Allocated: 0.19175243377685547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22587871551513672  GigaBytes
Max Memory Allocated: 0.22828102111816406  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.21839237213134766  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.21872901916503906  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.2191472053527832  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

--------------------------m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.21951627731323242  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.21951627731323242  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.21953725814819336  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.21970510482788086  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.21971416473388672  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.21971416473388672  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.21973323822021484  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22001934051513672  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.2200474739074707  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.2200474739074707  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22007226943969727  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22061777114868164  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([13, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.2206554412841797  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.2206554412841797  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22068023681640625  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22139930725097656  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22141599655151367  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22141599655151367  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22142744064331055  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22183942794799805  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22186851501464844  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22186851501464844  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.2218799591064453  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22237205505371094  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.2223801612854004  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.2223801612854004  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22238397598266602  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22257471084594727  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22259902954101562  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22259902954101562  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22260475158691406  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22297096252441406  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22298765182495117  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22298765182495117  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.2229914665222168  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22326231002807617  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22327136993408203  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22327136993408203  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22327327728271484  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22342205047607422  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22344446182250977  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.22344446182250977  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.765625 GB
    Memory Allocated: 0.2234482765197754  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22377252578735352  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22378921508789062  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22378921508789062  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22379112243652344  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.2240467071533203  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22406625747680664  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22406625747680664  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22406816482543945  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.2243504524230957  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22437381744384766  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22437381744384766  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22437572479248047  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22471141815185547  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22442626953125  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.2244281768798828  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22442913055419922  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.767578125 GB
    Memory Allocated: 0.22443199157714844  GigaBytes
Max Memory Allocated: 0.2312912940979004  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.13830184936523438  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

--------------------------m.shape torch.Size([26, 1, 1433])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.1450061798095703  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.1450061798095703  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.14528465270996094  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.1475081443786621  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([49, 2, 1433])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.14789247512817383  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.14789247512817383  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.14841604232788086  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.15631628036499023  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([41, 3, 1433])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.15671157836914062  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.15671157836914062  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 41, 1433]), torch.Size([1, 41, 1433])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.1571502685546875  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.16678857803344727  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 41, 1433])
--------------------------m.shape torch.Size([45, 4, 1433])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.16753053665161133  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.16753053665161133  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.16801118850708008  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.18195009231567383  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
--------------------------m.shape torch.Size([41, 5, 1433])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.18280458450317383  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.18280458450317383  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 41, 1433]), torch.Size([1, 41, 1433])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.1832432746887207  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.19901466369628906  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 41, 1433])
--------------------------m.shape torch.Size([29, 6, 1433])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.1997241973876953  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.1997241973876953  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 29, 1433]), torch.Size([1, 29, 1433])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.20003414154052734  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.21335315704345703  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 29, 1433])
--------------------------m.shape torch.Size([18, 7, 1433])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.21387100219726562  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.21387100219726562  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2140636444091797  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.22368574142456055  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([8, 8, 1433])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.22393131256103516  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.22393131256103516  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 8, 1433]), torch.Size([1, 8, 1433])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.22401714324951172  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2288980484008789  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 8, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.22895145416259766  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.22895145416259766  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.228973388671875  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.23035144805908203  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([21, 10, 1433])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2318129539489746  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2318129539489746  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.23203802108764648  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24797487258911133  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24280500411987305  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2430720329284668  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24340343475341797  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24369192123413086  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24369192123413086  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24370908737182617  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24384641647338867  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([15, 2, 256])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2438669204711914  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2438669204711914  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2438955307006836  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2443246841430664  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24434804916381836  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24434804916381836  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24437284469604492  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2449183464050293  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24494075775146484  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24494075775146484  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24495792388916016  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24545574188232422  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24549055099487305  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24549055099487305  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24550771713256836  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2461256980895996  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24614620208740234  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24614620208740234  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2461557388305664  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2465658187866211  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24657487869262695  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24657487869262695  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24657869338989258  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24676942825317383  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24679088592529297  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24679088592529297  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2467966079711914  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24712276458740234  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24712896347045898  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24712896347045898  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2471308708190918  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2472529411315918  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24726200103759766  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24726200103759766  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24726390838623047  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24739933013916016  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2474226951599121  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.2474226951599121  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24742460250854492  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24776029586791992  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24755001068115234  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24755191802978516  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24755096435546875  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.904296875 GB
    Memory Allocated: 0.24755334854125977  GigaBytes
Max Memory Allocated: 0.34125328063964844  GigaBytes

pure train time  0.7116827964782715
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.27338171005249023  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9482313394546509
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.910 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.910 GB
Metis partitioning: 0.000 seconds, peak memory: 24.910 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.006510734558105469
pure dgl.metis_partition the time spent:  0.0022592544555664062

block_gen_time in "generate_blocks_for_one_layer_block"  0.004315614700317383


block_gen_time in "generate_blocks_for_one_layer_block"  0.0054721832275390625

connection checking time:  0.0061533451080322266
block generation total time  0.009787797927856445
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.2744913101196289  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

--------------------------m.shape torch.Size([23, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.28316307067871094  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.28316307067871094  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.28340911865234375  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.28537464141845703  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([51, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.2857961654663086  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.2857961654663086  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.28634071350097656  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.2945089340209961  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([54, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.2951016426086426  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.2951016426086426  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

 h.shape torch.Size([1, 54, 1433]), torch.Size([1, 54, 1433])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.29567861557006836  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.30919933319091797  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

rst.shape  torch.Size([1, 54, 1433])
--------------------------m.shape torch.Size([53, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3100428581237793  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3100428581237793  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3106093406677246  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3272271156311035  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([51, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3283052444458008  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3283052444458008  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.32884979248046875  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3484535217285156  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([27, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3490462303161621  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3490462303161621  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3493351936340332  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3617434501647949  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3620476722717285  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3620476722717285  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.36217641830444336  GigaBytes
Max Memory Allocated: 0.36713171005249023  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.368593692779541  GigaBytes
Max Memory Allocated: 0.36904239654541016  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([15, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3691701889038086  GigaBytes
Max Memory Allocated: 0.3691716194152832  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3691701889038086  GigaBytes
Max Memory Allocated: 0.3691716194152832  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.36933040618896484  GigaBytes
Max Memory Allocated: 0.36933040618896484  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3784627914428711  GigaBytes
Max Memory Allocated: 0.3791036605834961  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.37862300872802734  GigaBytes
Max Memory Allocated: 0.3791036605834961  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.37862300872802734  GigaBytes
Max Memory Allocated: 0.3791036605834961  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3786764144897461  GigaBytes
Max Memory Allocated: 0.3791036605834961  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3820943832397461  GigaBytes
Max Memory Allocated: 0.38233470916748047  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([43, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.38436317443847656  GigaBytes
Max Memory Allocated: 0.3843684196472168  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.38436317443847656  GigaBytes
Max Memory Allocated: 0.3843684196472168  GigaBytes

 h.shape torch.Size([1, 43, 1433]), torch.Size([1, 43, 1433])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.3848228454589844  GigaBytes
Max Memory Allocated: 0.3848228454589844  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4174308776855469  GigaBytes
Max Memory Allocated: 0.4197263717651367  GigaBytes

rst.shape  torch.Size([1, 43, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4105038642883301  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41082239151000977  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41121768951416016  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41156768798828125  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41156768798828125  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41158294677734375  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41170501708984375  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([14, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4117245674133301  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4117245674133301  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41175127029418945  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4121518135070801  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41217041015625  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41217041015625  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41219139099121094  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41265296936035156  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41268110275268555  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41268110275268555  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41270017623901367  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4132533073425293  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4132823944091797  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4132823944091797  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4132976531982422  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4138469696044922  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41387414932250977  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41387414932250977  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41388559341430664  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41437768936157227  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4143791198730469  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4143791198730469  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4143810272216797  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4144763946533203  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41449880599975586  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41449880599975586  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4145045280456543  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41483068466186523  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4148540496826172  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4148540496826172  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4148597717285156  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4152259826660156  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41524267196655273  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41524267196655273  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41524648666381836  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41551733016967773  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4155263900756836  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4155263900756836  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4155282974243164  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4156770706176758  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41568803787231445  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41568803787231445  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41568994522094727  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41585206985473633  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41587162017822266  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41587162017822266  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41587352752685547  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4161558151245117  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41617918014526367  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41617918014526367  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4161810874938965  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4165167808532715  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4162459373474121  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.4162478446960449  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41623640060424805  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.060546875 GB
    Memory Allocated: 0.41623926162719727  GigaBytes
Max Memory Allocated: 0.42260122299194336  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.27439403533935547  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

--------------------------m.shape torch.Size([23, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28191566467285156  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28191566467285156  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2821617126464844  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28412723541259766  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([47, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28450632095336914  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28450632095336914  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28500890731811523  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2925686836242676  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([51, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2931342124938965  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2931342124938965  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29367876052856445  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3062911033630371  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([56, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30721473693847656  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30721473693847656  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 56, 1433]), torch.Size([1, 56, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3078126907348633  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3251533508300781  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 56, 1433])
--------------------------m.shape torch.Size([38, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.325869083404541  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.325869083404541  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 38, 1433]), torch.Size([1, 38, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3262753486633301  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34088659286499023  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 38, 1433])
--------------------------m.shape torch.Size([32, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34256410598754883  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34256410598754883  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34290647506713867  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.357602596282959  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([23, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3582911491394043  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3582911491394043  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3585371971130371  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3708195686340332  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([7, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37099552154541016  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37099552154541016  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37107086181640625  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37534236907958984  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37544918060302734  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37544918060302734  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37548160552978516  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37754392623901367  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([26, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37891578674316406  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37891578674316406  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3791942596435547  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3989229202270508  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3930330276489258  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3933248519897461  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39368724822998047  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

--------------------------m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3939962387084961  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3939962387084961  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39401912689208984  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39420223236083984  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3942122459411621  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3942122459411621  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39423322677612305  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3945479393005371  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3945808410644531  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3945808410644531  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3946094512939453  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39523887634277344  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39527082443237305  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39527082443237305  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3952937126159668  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39595746994018555  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3959798812866211  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3959798812866211  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3959932327270508  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39647388458251953  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3964962959289551  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3964962959289551  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39650583267211914  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39691591262817383  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39693164825439453  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39693164825439453  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39693737030029297  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39722347259521484  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3972296714782715  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3972296714782715  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3972315788269043  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3973536491394043  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39736270904541016  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39736270904541016  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39736461639404297  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39750003814697266  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39751100540161133  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39751100540161133  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39751291275024414  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3976750373840332  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3976926803588867  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3976926803588867  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39769458770751953  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3979501724243164  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39797353744506836  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39797353744506836  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39797544479370117  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39831113815307617  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3980851173400879  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3980870246887207  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3980860710144043  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3980884552001953  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

pure train time  0.3083024024963379
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2744135856628418  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9223710298538208
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.973 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.973 GB
Metis partitioning: 0.000 seconds, peak memory: 24.973 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005791902542114258
pure dgl.metis_partition the time spent:  0.002341032028198242

block_gen_time in "generate_blocks_for_one_layer_block"  0.0038902759552001953


block_gen_time in "generate_blocks_for_one_layer_block"  0.005460262298583984

connection checking time:  0.006099700927734375
block generation total time  0.00935053825378418
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2747645378112793  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

--------------------------m.shape torch.Size([21, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.284024715423584  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.284024715423584  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28424978256225586  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28604602813720703  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([54, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2865104675292969  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2865104675292969  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 54, 1433]), torch.Size([1, 54, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28708744049072266  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29735231399536133  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 54, 1433])
--------------------------m.shape torch.Size([58, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2979927062988281  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2979927062988281  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 58, 1433]), torch.Size([1, 58, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2986125946044922  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3122415542602539  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 58, 1433])
--------------------------m.shape torch.Size([57, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31314897537231445  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31314897537231445  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31375837326049805  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.33141374588012695  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([46, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3323369026184082  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3323369026184082  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3328280448913574  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3513832092285156  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([33, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35219478607177734  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35219478607177734  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35254764556884766  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3677034378051758  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([14, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36805057525634766  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36805057525634766  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 14, 1433]), torch.Size([1, 14, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36820030212402344  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37567663192749023  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 14, 1433])
--------------------------m.shape torch.Size([17, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3763279914855957  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3763279914855957  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3765101432800293  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3868699073791504  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([6, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3870673179626465  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3870673179626465  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3871321678161621  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39124393463134766  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([46, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39366722106933594  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39366722106933594  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39415836334228516  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.429262638092041  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4217667579650879  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4221024513244629  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4225192070007324  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

--------------------------m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4228944778442383  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4228944778442383  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42290592193603516  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42299747467041016  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42301321029663086  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42301321029663086  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4230341911315918  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42334890365600586  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42337608337402344  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42337608337402344  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42340087890625  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4239463806152344  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([14, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42398786544799805  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42398786544799805  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4240145683288574  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4247889518737793  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42481422424316406  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42481422424316406  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42482948303222656  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42537879943847656  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4254002571105957  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4254002571105957  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42540979385375977  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42581987380981445  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42582225799560547  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42582225799560547  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4258241653442383  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4259195327758789  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42594194412231445  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42594194412231445  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4259476661682129  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42627382278442383  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4262971878051758  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4262971878051758  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4263029098510742  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4266691207885742  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42668581008911133  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42668581008911133  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42668962478637695  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42696046829223633  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4269695281982422  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4269695281982422  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.426971435546875  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4271202087402344  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42713117599487305  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42713117599487305  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42713308334350586  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4272952079772949  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42731285095214844  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42731285095214844  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42731475830078125  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4275703430175781  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42758989334106445  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42758989334106445  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42759180068969727  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4278740882873535  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42789745330810547  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42789745330810547  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4278993606567383  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4282350540161133  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42793798446655273  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42793989181518555  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42792844772338867  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4279313087463379  GigaBytes
Max Memory Allocated: 0.5284242630004883  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.27439308166503906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([25, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28131580352783203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28131580352783203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2815828323364258  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2837190628051758  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([42, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28403425216674805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28403425216674805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 42, 1433]), torch.Size([1, 42, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2844834327697754  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2912125587463379  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 42, 1433])
--------------------------m.shape torch.Size([46, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29172468185424805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29172468185424805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29221582412719727  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30370187759399414  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([53, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30458831787109375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30458831787109375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30515480041503906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32239532470703125  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([41, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32320690155029297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32320690155029297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 41, 1433]), torch.Size([1, 41, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32364559173583984  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3394169807434082  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 41, 1433])
--------------------------m.shape torch.Size([27, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34006261825561523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34006261825561523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34035158157348633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35275983810424805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([22, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3534379005432129  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3534379005432129  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35367345809936523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3654313087463379  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([6, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.365570068359375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.365570068359375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 6, 1433]), torch.Size([1, 6, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3656349182128906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3692970275878906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 6, 1433])
--------------------------m.shape torch.Size([2, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36936092376708984  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36936092376708984  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 1433]), torch.Size([1, 2, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3693828582763672  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3707609176635742  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 1433])
--------------------------m.shape torch.Size([22, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37192440032958984  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37192440032958984  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3721599578857422  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3888559341430664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38348865509033203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3837614059448242  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38409996032714844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([14, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3843836784362793  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3843836784362793  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38441038131713867  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38462400436401367  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([14, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38463783264160156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38463783264160156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38466453552246094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38506507873535156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3850893974304199  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3850893974304199  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3851141929626465  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38565969467163086  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3856782913208008  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3856782913208008  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3856935501098633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3861360549926758  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38616228103637695  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38616228103637695  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38617563247680664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3866562843322754  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3866844177246094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3866844177246094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38669586181640625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3871879577636719  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38720273971557617  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38720273971557617  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3872084617614746  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3874945640563965  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3875007629394531  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3875007629394531  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38750267028808594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38762474060058594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3876338005065918  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3876338005065918  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3876357078552246  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3877711296081543  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38778209686279297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38778209686279297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3877840042114258  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38794612884521484  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3879694938659668  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3879694938659668  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3879714012145996  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3883070945739746  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3881072998046875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3881092071533203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3881082534790039  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3881106376647949  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

pure train time  0.3092660903930664
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.274411678314209  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8940531015396118
loading full batch data spends  0.004507303237915039
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.973 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.973 GB
Metis partitioning: 0.000 seconds, peak memory: 24.973 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0055332183837890625
pure dgl.metis_partition the time spent:  0.0023565292358398438

block_gen_time in "generate_blocks_for_one_layer_block"  0.0038712024688720703


block_gen_time in "generate_blocks_for_one_layer_block"  0.006234884262084961

connection checking time:  0.006270408630371094
block generation total time  0.010106086730957031
generate_dataloader_block spend   0.028411388397216797
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.27464723587036133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([23, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28388071060180664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28388071060180664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28412675857543945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28609228134155273  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([50, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28650331497192383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28650331497192383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28703737258911133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2950601577758789  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([54, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2956581115722656  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2956581115722656  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 54, 1433]), torch.Size([1, 54, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2962350845336914  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3091764450073242  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 54, 1433])
--------------------------m.shape torch.Size([57, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3101053237915039  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3101053237915039  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3107147216796875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32867908477783203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([52, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32976245880126953  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32976245880126953  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 52, 1433]), torch.Size([1, 52, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3303184509277344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35058021545410156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 52, 1433])
--------------------------m.shape torch.Size([31, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3512992858886719  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3512992858886719  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35163116455078125  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3658761978149414  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([16, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36630821228027344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36630821228027344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36647987365722656  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.375032901763916  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([18, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3757162094116211  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3757162094116211  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37590885162353516  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38687801361083984  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3870220184326172  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3870220184326172  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38707542419433594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39049339294433594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([44, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39281558990478516  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39281558990478516  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 44, 1433]), torch.Size([1, 44, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39328575134277344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4266529083251953  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 44, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41919422149658203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4195280075073242  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41994237899780273  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42031145095825195  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42031145095825195  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42032670974731445  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42044878005981445  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42046451568603516  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42046451568603516  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4204874038696289  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42083072662353516  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42085695266723633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42085695266723633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4208817481994629  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42142724990844727  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4214458465576172  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4214458465576172  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4214611053466797  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4219036102294922  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4219346046447754  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4219346046447754  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4219498634338379  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4224991798400879  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4225320816040039  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4225320816040039  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4225454330444336  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42311954498291016  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4231266975402832  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4231266975402832  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42313051223754883  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4233212471008301  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4233427047729492  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4233427047729492  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42334842681884766  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4236745834350586  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4236893653869629  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4236893653869629  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4236931800842285  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4239373207092285  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4239645004272461  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4239645004272461  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42397022247314453  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4243764877319336  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42438459396362305  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42438459396362305  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42438650131225586  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42453527450561523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4245576858520508  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4245576858520508  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4245615005493164  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42488574981689453  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42490434646606445  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42490434646606445  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42490625381469727  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4251885414123535  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42521190643310547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42521190643310547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4252138137817383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4255495071411133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4252605438232422  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.425262451171875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4252510070800781  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42525386810302734  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.27439403533935547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([23, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2814674377441406  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2814674377441406  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28171348571777344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2836790084838867  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([46, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28404712677001953  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28404712677001953  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28453826904296875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29242610931396484  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([51, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2929973602294922  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2929973602294922  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29354190826416016  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3062400817871094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([51, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30705690383911133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30705690383911133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3076014518737793  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3233933448791504  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([36, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3240823745727539  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3240823745727539  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 36, 1433]), torch.Size([1, 36, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32446765899658203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3383164405822754  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 36, 1433])
--------------------------m.shape torch.Size([30, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.33908510208129883  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.33908510208129883  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.33940553665161133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35318422317504883  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
--------------------------m.shape torch.Size([21, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3538088798522949  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3538088798522949  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3540339469909668  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36525726318359375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([5, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3653583526611328  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3653583526611328  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36541175842285156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3684558868408203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3685736656188965  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3685736656188965  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3686060905456543  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3706684112548828  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([25, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37198686599731445  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37198686599731445  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3722538948059082  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39121294021606445  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3856978416442871  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38597536087036133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3863201141357422  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38660717010498047  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38660717010498047  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3866300582885742  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3868131637573242  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3868269920349121  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3868269920349121  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38685178756713867  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3872237205505371  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3872489929199219  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3872489929199219  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38727378845214844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3878192901611328  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([14, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3878607749938965  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3878607749938965  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38788747787475586  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38866186141967773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38868236541748047  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38868236541748047  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38869571685791016  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3891763687133789  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.389193058013916  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.389193058013916  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38920068740844727  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.389528751373291  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3895387649536133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3895387649536133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3895425796508789  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38973331451416016  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38974905014038086  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38974905014038086  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3897528648376465  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3899970054626465  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3900136947631836  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3900136947631836  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3900156021118164  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3902711868286133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39029455184936523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39029455184936523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39029645919799805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39063215255737305  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3904271125793457  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3904290199279785  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3904280662536621  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3904304504394531  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

pure train time  0.29580235481262207
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2744135856628418  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8658638000488281
loading full batch data spends  0.004822969436645508
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.973 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.973 GB
Metis partitioning: 0.000 seconds, peak memory: 24.973 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005936384201049805
pure dgl.metis_partition the time spent:  0.002727985382080078

block_gen_time in "generate_blocks_for_one_layer_block"  0.004445552825927734


block_gen_time in "generate_blocks_for_one_layer_block"  0.0054874420166015625

connection checking time:  0.006150960922241211
block generation total time  0.009932994842529297
generate_dataloader_block spend   0.029061317443847656
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2745223045349121  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([25, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2826371192932129  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2826371192932129  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28290414810180664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28504037857055664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([52, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2854623794555664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2854623794555664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 52, 1433]), torch.Size([1, 52, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28601837158203125  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2953047752380371  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 52, 1433])
--------------------------m.shape torch.Size([51, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29584360122680664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29584360122680664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2963881492614746  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30893659591674805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([54, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3098177909851074  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3098177909851074  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 54, 1433]), torch.Size([1, 54, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3103947639465332  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.327301025390625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 54, 1433])
--------------------------m.shape torch.Size([37, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3280673027038574  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3280673027038574  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.328463077545166  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34268951416015625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([23, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3432283401489258  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3432283401489258  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3434743881225586  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3540372848510742  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([15, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3544750213623047  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3544750213623047  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35463523864746094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36264610290527344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3630361557006836  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3630361557006836  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36315441131591797  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3698606491088867  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3700418472290039  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3700418472290039  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37009525299072266  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37351322174072266  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([43, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3757820129394531  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3757820129394531  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 43, 1433]), torch.Size([1, 43, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37624168395996094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40884971618652344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 43, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.402341365814209  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40264272689819336  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4030170440673828  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40333080291748047  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40333080291748047  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4033479690551758  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4034852981567383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([16, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40350770950317383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40350770950317383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40353822708129883  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40399599075317383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 16, 256])
--------------------------m.shape torch.Size([14, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4040212631225586  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4040212631225586  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40404796600341797  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4046354293823242  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4046645164489746  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4046645164489746  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40468549728393555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40529394149780273  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40531253814697266  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40531253814697266  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40532398223876953  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40573596954345703  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40575361251831055  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40575361251831055  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4057612419128418  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40608930587768555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40610599517822266  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40610599517822266  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4061117172241211  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40639781951904297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40641260147094727  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40641260147094727  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4064164161682129  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4066605567932129  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4066781997680664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4066781997680664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40668201446533203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4069528579711914  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40696191787719727  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40696191787719727  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4069638252258301  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40711259841918945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.407135009765625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.407135009765625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4071388244628906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40746307373046875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40748167037963867  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40748167037963867  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4074835777282715  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40776586532592773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4075331687927246  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4075350761413574  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40752363204956055  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40752649307250977  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2743949890136719  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([21, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2825479507446289  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2825479507446289  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2827730178833008  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28456926345825195  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([47, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2849588394165039  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2849588394165039  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28546142578125  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2933845520019531  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([55, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29401445388793945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29401445388793945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2946019172668457  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30764198303222656  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([55, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30852270126342773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30852270126342773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.309110164642334  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3261408805847168  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([49, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3277616500854492  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3277616500854492  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 49, 1433]), torch.Size([1, 49, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32828521728515625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34712648391723633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 49, 1433])
--------------------------m.shape torch.Size([37, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3480501174926758  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3480501174926758  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3484458923339844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36543846130371094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([20, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36598825454711914  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36598825454711914  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36620187759399414  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37688302993774414  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([12, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.377288818359375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.377288818359375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37741756439208984  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3847332000732422  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3848133087158203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3848133087158203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3848457336425781  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38690805435180664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([27, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3883333206176758  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3883333206176758  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3886222839355469  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40911006927490234  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.402681827545166  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40299272537231445  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4033784866333008  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4037208557128906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4037208557128906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40374183654785156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40390968322753906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4039168357849121  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4039168357849121  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4039340019226074  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4041914939880371  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4042177200317383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4042177200317383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40424060821533203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40474414825439453  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40477514266967773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40477514266967773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40479612350463867  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40540456771850586  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4054374694824219  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4054374694824219  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4054546356201172  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40607261657714844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40610456466674805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40610456466674805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40611791610717773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4066920280456543  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4066925048828125  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4066925048828125  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4066944122314453  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40678977966308594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4068121910095215  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4068121910095215  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4068179130554199  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40714406967163086  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40715885162353516  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40715885162353516  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4071626663208008  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4074068069458008  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40741491317749023  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40741491317749023  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40741682052612305  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40755224227905273  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40756988525390625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40756988525390625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40757179260253906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40782737731933594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40787458419799805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40787458419799805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40787839889526367  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40854978561401367  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40828752517700195  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40828943252563477  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40828847885131836  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4082908630371094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

pure train time  0.3059804439544678
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2744154930114746  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.844316005706787
loading full batch data spends  0.003810882568359375
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.973 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.973 GB
Metis partitioning: 0.000 seconds, peak memory: 24.973 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00568699836730957
pure dgl.metis_partition the time spent:  0.0022258758544921875

block_gen_time in "generate_blocks_for_one_layer_block"  0.003064870834350586


block_gen_time in "generate_blocks_for_one_layer_block"  0.003912687301635742

connection checking time:  0.003333568572998047
block generation total time  0.006977558135986328
generate_dataloader_block spend   0.021733760833740234
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2744483947753906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([23, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2828693389892578  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2828693389892578  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2831153869628906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2850809097290039  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([37, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2853531837463379  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2853531837463379  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2857489585876465  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29167699813842773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([57, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2923922538757324  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2923922538757324  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.293001651763916  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30722475051879883  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([59, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3081803321838379  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3081803321838379  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 59, 1433]), torch.Size([1, 59, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3088107109069824  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3272266387939453  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 59, 1433])
--------------------------m.shape torch.Size([47, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32816600799560547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32816600799560547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32866859436035156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3471388816833496  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([27, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34775257110595703  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34775257110595703  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3480415344238281  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36044979095458984  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([18, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3609781265258789  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3609781265258789  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36117076873779297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37079286575317383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([12, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37120914459228516  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37120914459228516  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.371337890625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37865352630615234  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3788294792175293  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3788294792175293  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37888288497924805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38230085372924805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([38, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38430309295654297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38430309295654297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 38, 1433]), torch.Size([1, 38, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38470935821533203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4135255813598633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 38, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.406766414642334  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4070744514465332  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4074568748474121  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4078044891357422  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4078044891357422  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40782737731933594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40801048278808594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40801477432250977  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40801477432250977  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40803003311157227  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40825891494750977  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.408294677734375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.408294677734375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4083232879638672  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4089527130126953  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([13, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40898847579956055  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40898847579956055  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4090132713317871  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4097323417663574  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4097585678100586  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4097585678100586  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4097738265991211  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4103231430053711  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41034460067749023  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41034460067749023  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4103541374206543  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.410764217376709  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 5, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4107666015625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4107666015625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4107685089111328  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41086387634277344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4108710289001465  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4108710289001465  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4108729362487793  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4109816551208496  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4110069274902344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4110069274902344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4110126495361328  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4113788604736328  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4113955497741699  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4113955497741699  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41139936447143555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4116702079772949  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41169166564941406  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41169166564941406  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4116954803466797  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4120197296142578  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41203832626342773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41203832626342773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41204023361206055  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4123225212097168  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41234588623046875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41234588623046875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41234779357910156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41268348693847656  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41242074966430664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.41242265701293945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4124112129211426  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4124140739440918  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2743949890136719  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([23, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2821364402770996  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2821364402770996  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2823824882507324  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2843480110168457  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([59, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28485536575317383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28485536575317383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 59, 1433]), torch.Size([1, 59, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28548574447631836  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29549646377563477  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 59, 1433])
--------------------------m.shape torch.Size([46, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29591798782348633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29591798782348633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29640913009643555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30739688873291016  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([50, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30821943283081055  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30821943283081055  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30875349044799805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32424116134643555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([42, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32509565353393555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32509565353393555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 42, 1433]), torch.Size([1, 42, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3255448341369629  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3416938781738281  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 42, 1433])
--------------------------m.shape torch.Size([31, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34246253967285156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34246253967285156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34279441833496094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3570394515991211  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([17, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35750913619995117  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35750913619995117  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 17, 1433]), torch.Size([1, 17, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35769128799438477  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3667788505554199  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 17, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3671150207519531  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3671150207519531  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3672218322753906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3733100891113281  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3734011650085449  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3734011650085449  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37343358993530273  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37549591064453125  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([32, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37718820571899414  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37718820571899414  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.377530574798584  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4017958641052246  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.395693302154541  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39599180221557617  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3963627815246582  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39667415618896484  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39667415618896484  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39668941497802734  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39681148529052734  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([17, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3968367576599121  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3968367576599121  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3968691825866699  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3973555564880371  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 17, 256])
--------------------------m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3973712921142578  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3973712921142578  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39739227294921875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3978538513183594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39787817001342773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39787817001342773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39789533615112305  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3983931541442871  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3984184265136719  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3984184265136719  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39843177795410156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3989124298095703  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3989405632019043  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3989405632019043  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39895200729370117  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3994441032409668  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3994588851928711  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3994588851928711  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39946460723876953  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3997507095336914  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3997635841369629  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3997635841369629  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3997673988342285  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39998483657836914  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3999919891357422  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3999919891357422  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.399993896484375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.400115966796875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40012502670288086  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40012502670288086  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40012693405151367  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40026235580444336  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4002723693847656  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4002723693847656  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40027427673339844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4004230499267578  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40044069290161133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40044069290161133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40044260025024414  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.400698184967041  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40072154998779297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40072154998779297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4007234573364258  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4010591506958008  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40082502365112305  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40082693099975586  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40082597732543945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40082836151123047  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

pure train time  0.30484652519226074
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2744154930114746  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8207223415374756
loading full batch data spends  0.002634286880493164
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.973 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.973 GB
Metis partitioning: 0.000 seconds, peak memory: 24.973 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0033674240112304688
pure dgl.metis_partition the time spent:  0.0019001960754394531

block_gen_time in "generate_blocks_for_one_layer_block"  0.0037865638732910156


block_gen_time in "generate_blocks_for_one_layer_block"  0.005367755889892578

connection checking time:  0.0060482025146484375
block generation total time  0.009154319763183594
generate_dataloader_block spend   0.02372574806213379
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.27455949783325195  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([21, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2827119827270508  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2827119827270508  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 21, 1433]), torch.Size([1, 21, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28293704986572266  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28473329544067383  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 21, 1433])
--------------------------m.shape torch.Size([54, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28519773483276367  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28519773483276367  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 54, 1433]), torch.Size([1, 54, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28577470779418945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29525279998779297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 54, 1433])
--------------------------m.shape torch.Size([55, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29584550857543945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29584550857543945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2964329719543457  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31032466888427734  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([53, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31116294860839844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31116294860839844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31172943115234375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3282632827758789  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([37, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3289680480957031  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3289680480957031  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 37, 1433]), torch.Size([1, 37, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3293638229370117  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34359025955200195  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 37, 1433])
--------------------------m.shape torch.Size([27, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3442573547363281  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3442573547363281  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3445463180541992  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35695457458496094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([16, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3574080467224121  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3574080467224121  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 16, 1433]), torch.Size([1, 16, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35757970809936523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3661327362060547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 16, 1433])
--------------------------m.shape torch.Size([10, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3664741516113281  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3664741516113281  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3665809631347656  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3726692199707031  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37285614013671875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37285614013671875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3729095458984375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3763275146484375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([41, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37848997116088867  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37848997116088867  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 41, 1433]), torch.Size([1, 41, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37892866134643555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4100327491760254  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 41, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4034919738769531  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4037961959838867  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4041743278503418  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4044919013977051  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4044919013977051  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4045071601867676  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4046292304992676  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([14, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4046487808227539  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4046487808227539  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4046754837036133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4050760269165039  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([17, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40511178970336914  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40511178970336914  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40514421463012695  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40585756301879883  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 17, 256])
--------------------------m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4058799743652344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4058799743652344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4058990478515625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4064521789550781  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4064764976501465  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4064764976501465  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40648984909057617  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4069705009460449  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40698719024658203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40698719024658203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4069948196411133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40732288360595703  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40733957290649414  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40733957290649414  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4073452949523926  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40763139724731445  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40764617919921875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40764617919921875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4076499938964844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4078941345214844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4079117774963379  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4079117774963379  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4079155921936035  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4081864356994629  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40819549560546875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40819549560546875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40819740295410156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40834617614746094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4083685874938965  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4083685874938965  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4083724021911621  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40869665145874023  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40871524810791016  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40871524810791016  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40871715545654297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4089994430541992  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40876197814941406  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4087638854980469  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40875244140625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4087553024291992  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2743949890136719  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([25, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28230714797973633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28230714797973633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2825741767883301  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2847104072570801  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
--------------------------m.shape torch.Size([43, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2850360870361328  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2850360870361328  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 43, 1433]), torch.Size([1, 43, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2854957580566406  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2923851013183594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 43, 1433])
--------------------------m.shape torch.Size([53, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29300451278686523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29300451278686523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 53, 1433]), torch.Size([1, 53, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29357099533081055  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3065509796142578  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 53, 1433])
--------------------------m.shape torch.Size([54, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3074212074279785  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3074212074279785  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 54, 1433]), torch.Size([1, 54, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3079981803894043  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32556819915771484  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 54, 1433])
--------------------------m.shape torch.Size([50, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3266143798828125  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3266143798828125  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3271484375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34662771224975586  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([33, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34741783142089844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34741783142089844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 33, 1433]), torch.Size([1, 33, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34777069091796875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3629264831542969  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 33, 1433])
--------------------------m.shape torch.Size([18, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36342287063598633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36342287063598633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3636155128479004  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37323760986328125  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([13, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37369680404663086  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37369680404663086  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37383604049682617  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3817610740661621  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3818359375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3818359375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3818683624267578  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38393068313598633  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([26, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3853025436401367  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3853025436401367  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38558101654052734  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40530967712402344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3991055488586426  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39940881729125977  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39978551864624023  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40012407302856445  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40012407302856445  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4001469612121582  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4003300666809082  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40034008026123047  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40034008026123047  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4003610610961914  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40067577362060547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40069150924682617  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40069150924682617  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4007086753845215  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40108633041381836  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4011240005493164  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4011240005493164  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40114688873291016  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4018106460571289  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4018378257751465  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4018378257751465  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.401853084564209  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.402402400970459  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.402435302734375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.402435302734375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4024486541748047  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40302276611328125  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40302324295043945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40302324295043945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40302515029907227  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4031205177307129  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40314292907714844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40314292907714844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4031486511230469  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4034748077392578  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4034895896911621  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4034895896911621  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40349340438842773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40373754501342773  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4037456512451172  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4037456512451172  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40374755859375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4038829803466797  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4039006233215332  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4039006233215332  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.403902530670166  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4041581153869629  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.404205322265625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.404205322265625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4042091369628906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4048805236816406  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40462303161621094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40462493896484375  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40462398529052734  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.40462636947631836  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

pure train time  0.2945384979248047
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2744154930114746  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.800909399986267
loading full batch data spends  0.0025835037231445312
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.973 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.973 GB
Metis partitioning: 0.000 seconds, peak memory: 24.973 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004929304122924805
pure dgl.metis_partition the time spent:  0.0023317337036132812

block_gen_time in "generate_blocks_for_one_layer_block"  0.003820657730102539


block_gen_time in "generate_blocks_for_one_layer_block"  0.0054204463958740234

connection checking time:  0.005949258804321289
block generation total time  0.009241104125976562
generate_dataloader_block spend   0.025846481323242188
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.273345947265625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([28, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.27994823455810547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.27994823455810547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28024768829345703  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2826404571533203  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([43, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28294992446899414  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28294992446899414  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 43, 1433]), torch.Size([1, 43, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28340959548950195  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2902989387512207  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 43, 1433])
--------------------------m.shape torch.Size([44, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.290773868560791  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.290773868560791  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 44, 1433]), torch.Size([1, 44, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2912440299987793  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30158329010009766  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 44, 1433])
--------------------------m.shape torch.Size([51, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30243730545043945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30243730545043945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 51, 1433]), torch.Size([1, 51, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3029818534851074  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3194918632507324  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 51, 1433])
--------------------------m.shape torch.Size([36, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32018089294433594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32018089294433594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 36, 1433]), torch.Size([1, 36, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32056617736816406  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3344149589538574  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 36, 1433])
--------------------------m.shape torch.Size([28, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.33511924743652344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.33511924743652344  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.335418701171875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3482780456542969  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([12, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34857702255249023  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.34857702255249023  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3487057685852051  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35512304306030273  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([9, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35544347763061523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35544347763061523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 9, 1433]), torch.Size([1, 9, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35553979873657227  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36103010177612305  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 9, 1433])
--------------------------m.shape torch.Size([1, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36103010177612305  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36103010177612305  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 1433]), torch.Size([1, 1, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3610415458679199  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36173534393310547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 1433])
--------------------------m.shape torch.Size([24, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3632221221923828  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3632221221923828  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 24, 1433]), torch.Size([1, 24, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3634786605834961  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38167858123779297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 24, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.376584529876709  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3768477439880371  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37717437744140625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([13, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37746381759643555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37746381759643555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3774886131286621  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3776869773864746  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3776998519897461  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3776998519897461  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37772464752197266  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3780965805053711  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([14, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3781247138977051  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3781247138977051  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37815141677856445  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3787388801574707  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37876415252685547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37876415252685547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3787832260131836  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3793363571166992  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37935590744018555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37935590744018555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3793673515319824  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3797793388366699  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 6, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37981414794921875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37981414794921875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37982749938964844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.380401611328125  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3804020881652832  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3804020881652832  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.380403995513916  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38049936294555664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3805217742919922  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3805217742919922  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3805274963378906  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38085365295410156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3808598518371582  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3808598518371582  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.380861759185791  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.380983829498291  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3809928894042969  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3809928894042969  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3809947967529297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3811302185058594  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38115358352661133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38115358352661133  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38115549087524414  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38149118423461914  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3812856674194336  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3812875747680664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38127613067626953  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38127899169921875  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2749466896057129  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([18, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2844853401184082  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2844853401184082  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28467798233032227  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28621768951416016  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([55, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2867088317871094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2867088317871094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 55, 1433]), torch.Size([1, 55, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2872962951660156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2975797653198242  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 55, 1433])
--------------------------m.shape torch.Size([66, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2983431816101074  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2983431816101074  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 66, 1433]), torch.Size([1, 66, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29904794692993164  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31496334075927734  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 66, 1433])
--------------------------m.shape torch.Size([58, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31584978103637695  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31584978103637695  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 58, 1433]), torch.Size([1, 58, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.316469669342041  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.33443498611450195  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 58, 1433])
--------------------------m.shape torch.Size([48, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3354063034057617  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3354063034057617  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 48, 1433]), torch.Size([1, 48, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3359193801879883  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35494089126586914  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 48, 1433])
--------------------------m.shape torch.Size([31, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35567760467529297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35567760467529297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35600948333740234  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3702545166015625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
--------------------------m.shape torch.Size([23, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37094831466674805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37094831466674805  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.37119436264038086  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38347673416137695  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([13, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3839092254638672  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3839092254638672  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 13, 1433]), torch.Size([1, 13, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3840484619140625  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39197349548339844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 13, 1433])
--------------------------m.shape torch.Size([7, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3922405242919922  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3922405242919922  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 7, 1433]), torch.Size([1, 7, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3923158645629883  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3971118927001953  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 7, 1433])
--------------------------m.shape torch.Size([45, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3994765281677246  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3994765281677246  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39995718002319336  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4340834617614746  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4263629913330078  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4267101287841797  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4271411895751953  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

--------------------------m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4275093078613281  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4275093078613281  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4275226593017578  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4276294708251953  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4276461601257324  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4276461601257324  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42766904830932617  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4280123710632324  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4280357360839844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4280357360839844  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4280586242675781  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4285621643066406  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42859697341918945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42859697341918945  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4286198616027832  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42928361892700195  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42931556701660156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42931556701660156  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4293327331542969  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4299507141113281  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 9, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4299654960632324  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4299654960632324  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.42997312545776367  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4303011894226074  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43031787872314453  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43031787872314453  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43032360076904297  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43060970306396484  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4306330680847168  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4306330680847168  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43063879013061523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43100500106811523  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43102169036865234  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43102169036865234  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43102550506591797  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43129634857177734  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4313054084777832  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4313054084777832  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.431307315826416  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4314560890197754  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43147850036621094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43147850036621094  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43148231506347656  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4318065643310547  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4318232536315918  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4318232536315918  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4318251609802246  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4320807456970215  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4321002960205078  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4321002960205078  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4321022033691406  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.4323844909667969  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43240785598754883  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43240785598754883  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43240976333618164  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43274545669555664  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43245553970336914  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43245744705200195  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43245649337768555  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.43245887756347656  GigaBytes
Max Memory Allocated: 0.5392746925354004  GigaBytes

pure train time  0.300062894821167
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.27496910095214844  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.733895182609558
loading full batch data spends  0.003324747085571289
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.973 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.973 GB
Metis partitioning: 0.000 seconds, peak memory: 24.973 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0062901973724365234
pure dgl.metis_partition the time spent:  0.0021975040435791016

block_gen_time in "generate_blocks_for_one_layer_block"  0.0038421154022216797


block_gen_time in "generate_blocks_for_one_layer_block"  0.005440711975097656

connection checking time:  0.005913734436035156
block generation total time  0.009282827377319336
generate_dataloader_block spend   0.02733778953552246
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.27439308166503906  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

--------------------------m.shape torch.Size([23, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2816476821899414  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2816476821899414  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 23, 1433]), torch.Size([1, 23, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2818937301635742  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2838592529296875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 23, 1433])
--------------------------m.shape torch.Size([45, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28421688079833984  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.28421688079833984  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 45, 1433]), torch.Size([1, 45, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2846975326538086  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.29190731048583984  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 45, 1433])
--------------------------m.shape torch.Size([42, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2923398017883301  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2923398017883301  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 42, 1433]), torch.Size([1, 42, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.2927889823913574  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3026580810546875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 42, 1433])
--------------------------m.shape torch.Size([50, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30350160598754883  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30350160598754883  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.30403566360473633  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.31969118118286133  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([41, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32103490829467773  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.32103490829467773  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 41, 1433]), torch.Size([1, 41, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3214735984802246  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.33724498748779297  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 41, 1433])
--------------------------m.shape torch.Size([26, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3378586769104004  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3378586769104004  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.338137149810791  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3500857353210449  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
--------------------------m.shape torch.Size([15, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3505072593688965  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3505072593688965  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35066747665405273  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35867834091186523  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3590683937072754  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3590683937072754  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.35918664932250977  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3658928871154785  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([3, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3659782409667969  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3659782409667969  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3660106658935547  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3680729866027832  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
--------------------------m.shape torch.Size([31, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36971187591552734  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.36971187591552734  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 31, 1433]), torch.Size([1, 31, 1433])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3700437545776367  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39356422424316406  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 31, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3878135681152344  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38808727264404297  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3884272575378418  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

--------------------------m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38872671127319336  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38872671127319336  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3887495994567871  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3889327049255371  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([15, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3889503479003906  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3889503479003906  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3889789581298828  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3894081115722656  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 15, 256])
--------------------------m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3894228935241699  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3894228935241699  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38944196701049805  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3898615837097168  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3898944854736328  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3898944854736328  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.38991546630859375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39052391052246094  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3905472755432129  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3905472755432129  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3905606269836426  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39104127883911133  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39105796813964844  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39105796813964844  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3910655975341797  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39139366149902344  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39139699935913086  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39139699935913086  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39139890670776367  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3914942741394043  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39151668548583984  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39151668548583984  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3915224075317383  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3918485641479492  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3918633460998535  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3918633460998535  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39186716079711914  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39211130142211914  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3921194076538086  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3921194076538086  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3921213150024414  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3922567367553711  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3922743797302246  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3922743797302246  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3922762870788574  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3925318717956543  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39255523681640625  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39255523681640625  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39255714416503906  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39289283752441406  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39267444610595703  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39267635345458984  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.39266490936279297  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.123046875 GB
    Memory Allocated: 0.3926677703857422  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.27471113204956055  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

--------------------------m.shape torch.Size([22, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2836766242980957  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2836766242980957  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.28391218185424805  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2857937812805176  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
--------------------------m.shape torch.Size([50, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2862100601196289  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2862100601196289  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2867441177368164  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.294769287109375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([64, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.29552745819091797  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.29552745819091797  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 64, 1433]), torch.Size([1, 64, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.29621124267578125  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3119664192199707  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 64, 1433])
--------------------------m.shape torch.Size([58, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3128633499145508  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3128633499145508  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 58, 1433]), torch.Size([1, 58, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.31348323822021484  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3317584991455078  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 58, 1433])
--------------------------m.shape torch.Size([46, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.33267641067504883  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.33267641067504883  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.33316755294799805  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3516836166381836  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([34, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3525271415710449  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3525271415710449  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 34, 1433]), torch.Size([1, 34, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3528904914855957  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.36850595474243164  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 34, 1433])
--------------------------m.shape torch.Size([20, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.36907196044921875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.36907196044921875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.36928558349609375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.37996673583984375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([12, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3803725242614746  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3803725242614746  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.38050127029418945  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3878169059753418  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([5, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.38799285888671875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.38799285888671875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 5, 1433]), torch.Size([1, 5, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3880462646484375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3914642333984375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 5, 1433])
--------------------------m.shape torch.Size([39, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.39351987838745117  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.39351987838745117  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 39, 1433]), torch.Size([1, 39, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3939366340637207  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42351198196411133  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 39, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.41634273529052734  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.41667652130126953  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.41709089279174805  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

--------------------------m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4174489974975586  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4174489974975586  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4174642562866211  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4175863265991211  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.41759824752807617  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.41759824752807617  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4176173210144043  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.41790342330932617  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([16, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4179401397705078  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4179401397705078  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4179706573486328  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4186420440673828  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 16, 256])
--------------------------m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4186692237854004  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4186692237854004  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.41869020462036133  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4192986488342285  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 11, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4193267822265625  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4193267822265625  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.419342041015625  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.419891357421875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.419924259185791  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.419924259185791  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4199376106262207  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42051172256469727  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42052555084228516  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42052555084228516  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4205312728881836  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42081737518310547  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42083215713500977  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42083215713500977  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4208359718322754  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4210801124572754  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4210977554321289  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4210977554321289  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42110157012939453  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4213724136352539  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42138147354125977  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42138147354125977  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4213833808898926  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42153215408325195  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4215545654296875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4215545654296875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4215583801269531  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42188262939453125  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42190122604370117  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42190122604370117  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.421903133392334  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42218542098999023  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4222087860107422  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4222087860107422  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.422210693359375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.42254638671875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.422269344329834  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4222712516784668  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4222702980041504  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4222726821899414  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

pure train time  0.30243539810180664
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2747325897216797  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7246575355529785
loading full batch data spends  0.0035772323608398438
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.973 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.973 GB
Metis partitioning: 0.000 seconds, peak memory: 24.973 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005524635314941406
pure dgl.metis_partition the time spent:  0.002331972122192383

block_gen_time in "generate_blocks_for_one_layer_block"  0.0038805007934570312


block_gen_time in "generate_blocks_for_one_layer_block"  0.00545048713684082

connection checking time:  0.00603795051574707
block generation total time  0.009330987930297852
generate_dataloader_block spend   0.026963233947753906
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.27439403533935547  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

--------------------------m.shape torch.Size([28, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2823328971862793  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2823328971862793  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 28, 1433]), torch.Size([1, 28, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.28263235092163086  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.28502511978149414  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 28, 1433])
--------------------------m.shape torch.Size([46, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2853665351867676  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2853665351867676  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 46, 1433]), torch.Size([1, 46, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2858576774597168  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.29388999938964844  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 46, 1433])
--------------------------m.shape torch.Size([47, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.29439735412597656  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.29439735412597656  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.29489994049072266  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3063626289367676  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([52, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3072218894958496  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3072218894958496  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 52, 1433]), torch.Size([1, 52, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.30777788162231445  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3238844871520996  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 52, 1433])
--------------------------m.shape torch.Size([39, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3246479034423828  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3246479034423828  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 39, 1433]), torch.Size([1, 39, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.32506465911865234  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3400607109069824  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 39, 1433])
--------------------------m.shape torch.Size([27, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3407173156738281  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3407173156738281  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 27, 1433]), torch.Size([1, 27, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3410062789916992  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.35341453552246094  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 27, 1433])
--------------------------m.shape torch.Size([15, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.35383081436157227  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.35383081436157227  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3539910316467285  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.362001895904541  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
--------------------------m.shape torch.Size([12, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.36243438720703125  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.36243438720703125  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 12, 1433]), torch.Size([1, 12, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3625631332397461  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.36987876892089844  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 12, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3700070381164551  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3700070381164551  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.37004995346069336  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.37279653549194336  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([39, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.375823974609375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.375823974609375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 39, 1433]), torch.Size([1, 39, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.37624073028564453  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40581607818603516  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 39, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.39948415756225586  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3997788429260254  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4001450538635254  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

--------------------------m.shape torch.Size([13, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40045690536499023  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40045690536499023  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4004817008972168  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4006800651550293  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40069103240966797  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40069103240966797  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4007139205932617  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40105724334716797  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([14, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40108633041381836  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40108633041381836  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40111303329467773  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.401700496673584  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 14, 256])
--------------------------m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4017333984375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4017333984375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40175628662109375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4024200439453125  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4024472236633301  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4024472236633301  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4024624824523926  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4030117988586426  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 8, 256])
--------------------------m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4030275344848633  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4030275344848633  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40303516387939453  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4033632278442383  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 4, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40337324142456055  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40337324142456055  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40337705612182617  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4035677909851074  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40357494354248047  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40357494354248047  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4035768508911133  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4036989212036133  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4037175178527832  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4037175178527832  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40372133255004883  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4039921760559082  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40400123596191406  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40400123596191406  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4040031433105469  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40415191650390625  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4041743278503418  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4041743278503418  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4041781425476074  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40450239181518555  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40452098846435547  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40452098846435547  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4045228958129883  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40480518341064453  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 1, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40457916259765625  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40458106994628906  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4045696258544922  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4045724868774414  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

step  1
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2740001678466797  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

--------------------------m.shape torch.Size([18, 1, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2822279930114746  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2822279930114746  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 18, 1433]), torch.Size([1, 18, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.28242063522338867  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.28396034240722656  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 18, 1433])
--------------------------m.shape torch.Size([50, 2, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.28439807891845703  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.28439807891845703  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 50, 1433]), torch.Size([1, 50, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.28493213653564453  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2929573059082031  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 50, 1433])
--------------------------m.shape torch.Size([60, 3, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2936515808105469  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2936515808105469  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 60, 1433]), torch.Size([1, 60, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2942924499511719  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.30933713912963867  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 60, 1433])
--------------------------m.shape torch.Size([57, 4, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.31023406982421875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.31023406982421875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 57, 1433]), torch.Size([1, 57, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.31084346771240234  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.32849884033203125  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 57, 1433])
--------------------------m.shape torch.Size([47, 5, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3294486999511719  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3294486999511719  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 47, 1433]), torch.Size([1, 47, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.32995128631591797  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3480982780456543  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 47, 1433])
--------------------------m.shape torch.Size([32, 6, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.34887218475341797  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.34887218475341797  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 32, 1433]), torch.Size([1, 32, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3492145538330078  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3639106750488281  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 32, 1433])
--------------------------m.shape torch.Size([20, 7, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3644871711730957  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3644871711730957  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3647007942199707  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3753819465637207  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
--------------------------m.shape torch.Size([11, 8, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3757452964782715  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3757452964782715  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.37586355209350586  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3825697898864746  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
--------------------------m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3827033042907715  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3827033042907715  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.38274621963500977  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.38549280166625977  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
--------------------------m.shape torch.Size([30, 10, 1433])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3874530792236328  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3874530792236328  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 30, 1433]), torch.Size([1, 30, 1433])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.3877735137939453  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4105243682861328  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 30, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4040060043334961  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40431976318359375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4047093391418457  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

--------------------------m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40505361557006836  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40505361557006836  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40506696701049805  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40517377853393555  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40519237518310547  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40519237518310547  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40521717071533203  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40558910369873047  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 13, 256])
--------------------------m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.405611515045166  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.405611515045166  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40563440322875977  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40613794326782227  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 12, 256])
--------------------------m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40616512298583984  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40616512298583984  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40618419647216797  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4067373275756836  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 10, 256])
--------------------------m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40676164627075195  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40676164627075195  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40677499771118164  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4072556495666504  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4072895050048828  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4072895050048828  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4073028564453125  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40787696838378906  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 7, 256])
--------------------------m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4078841209411621  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4078841209411621  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40788793563842773  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.408078670501709  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 2, 256])
--------------------------m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4081001281738281  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4081001281738281  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40810585021972656  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4084320068359375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40845537185668945  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40845537185668945  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4084610939025879  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4088273048400879  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 3, 256])
--------------------------m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40883445739746094  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40883445739746094  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40883636474609375  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40897178649902344  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40898942947387695  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40898942947387695  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40899133682250977  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40924692153930664  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 1, 256])
--------------------------m.shape torch.Size([2, 25, 256])
----------------------------------------1
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40929412841796875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40929412841796875  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4092979431152344  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4099693298339844  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

rst.shape  torch.Size([1, 2, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4097003936767578  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4097023010253906  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.4097013473510742  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.40970373153686523  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

pure train time  0.3038973808288574
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.125 GB
    Memory Allocated: 0.2740206718444824  GigaBytes
Max Memory Allocated: 0.5439372062683105  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6662366390228271
Total (block generation + training)time/epoch 0.3748700959341867
pure train time/epoch 0.30196019013722736

num_input_list  [1483, 1546, 1552, 1557, 1545, 1536, 1514, 1513, 1515, 1521]
