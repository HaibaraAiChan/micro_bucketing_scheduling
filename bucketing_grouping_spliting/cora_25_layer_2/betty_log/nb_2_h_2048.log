main start at this time 1689541578.291124
  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 24.015 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 24.015 GB
Metis partitioning: 0.000 seconds, peak memory: 24.015 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008508682250976562
pure dgl.metis_partition the time spent:  0.003572225570678711
connection checking time:  0.008076667785644531
block generation total time  0.009464502334594727
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.94921875 GB
    Memory Allocated: 0.4139742851257324  GigaBytes
Max Memory Allocated: 0.4177851676940918  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.94921875 GB
    Memory Allocated: 0.41397714614868164  GigaBytes
Max Memory Allocated: 0.4177851676940918  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.263671875 GB
    Memory Allocated: 0.5656118392944336  GigaBytes
Max Memory Allocated: 0.6612715721130371  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.263671875 GB
    Memory Allocated: 0.5656142234802246  GigaBytes
Max Memory Allocated: 0.6612715721130371  GigaBytes

pure train time  0.6771299839019775
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.857421875 GB
    Memory Allocated: 0.8399972915649414  GigaBytes
Max Memory Allocated: 1.0274972915649414  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9443058967590332
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 25.685 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 25.685 GB
Metis partitioning: 0.000 seconds, peak memory: 25.685 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005007505416870117
pure dgl.metis_partition the time spent:  0.002055644989013672
connection checking time:  0.00590825080871582
block generation total time  0.010355234146118164
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.859375 GB
    Memory Allocated: 1.0305156707763672  GigaBytes
Max Memory Allocated: 1.0342092514038086  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.859375 GB
    Memory Allocated: 1.0305185317993164  GigaBytes
Max Memory Allocated: 1.0342092514038086  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.921875 GB
    Memory Allocated: 0.9943079948425293  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.921875 GB
    Memory Allocated: 0.9943103790283203  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

pure train time  0.28812217712402344
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.921875 GB
    Memory Allocated: 0.8401808738708496  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.903369426727295
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 25.752 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 25.752 GB
Metis partitioning: 0.000 seconds, peak memory: 25.752 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004884004592895508
pure dgl.metis_partition the time spent:  0.002023935317993164
connection checking time:  0.006072282791137695
block generation total time  0.009097576141357422
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.931640625 GB
    Memory Allocated: 1.0235424041748047  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.931640625 GB
    Memory Allocated: 1.023545265197754  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.931640625 GB
    Memory Allocated: 1.0016965866088867  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.931640625 GB
    Memory Allocated: 1.0016989707946777  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

pure train time  0.32034993171691895
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.931640625 GB
    Memory Allocated: 0.8405542373657227  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8410086631774902
loading full batch data spends  0.003076314926147461
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 25.752 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 25.752 GB
Metis partitioning: 0.000 seconds, peak memory: 25.752 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005009174346923828
pure dgl.metis_partition the time spent:  0.002257823944091797
connection checking time:  0.005968809127807617
block generation total time  0.00908350944519043
generate_dataloader_block spend   0.025745153427124023
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.931640625 GB
    Memory Allocated: 1.010624885559082  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.931640625 GB
    Memory Allocated: 1.0106277465820312  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.931640625 GB
    Memory Allocated: 1.0136432647705078  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.931640625 GB
    Memory Allocated: 1.0136456489562988  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

pure train time  0.29474544525146484
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.931640625 GB
    Memory Allocated: 0.8406472206115723  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7564098834991455
loading full batch data spends  0.003154277801513672
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 25.752 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 25.752 GB
Metis partitioning: 0.000 seconds, peak memory: 25.752 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004926919937133789
pure dgl.metis_partition the time spent:  0.0024116039276123047
connection checking time:  0.005959987640380859
block generation total time  0.009079694747924805
generate_dataloader_block spend   0.025797367095947266
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.93359375 GB
    Memory Allocated: 1.0331768989562988  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.93359375 GB
    Memory Allocated: 1.033179759979248  GigaBytes
Max Memory Allocated: 1.2778053283691406  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 0.992311954498291  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 0.992314338684082  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

pure train time  0.28900909423828125
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 0.8405680656433105  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9635283946990967
loading full batch data spends  0.0031135082244873047
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 25.784 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 25.784 GB
Metis partitioning: 0.000 seconds, peak memory: 25.784 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00500035285949707
pure dgl.metis_partition the time spent:  0.002008199691772461
connection checking time:  0.005920886993408203
block generation total time  0.009102821350097656
generate_dataloader_block spend   0.025553464889526367
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 1.0274195671081543  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 1.0274224281311035  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 0.9965057373046875  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 0.9965081214904785  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

pure train time  0.2720611095428467
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 0.8405680656433105  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.9878355264663696
loading full batch data spends  0.004191160202026367
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 25.784 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 25.784 GB
Metis partitioning: 0.000 seconds, peak memory: 25.784 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005629062652587891
pure dgl.metis_partition the time spent:  0.002019643783569336
connection checking time:  0.006064176559448242
block generation total time  0.010003328323364258
generate_dataloader_block spend   0.027621030807495117
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 1.0043773651123047  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 1.004380226135254  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 1.0218777656555176  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 1.0218801498413086  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

pure train time  0.282651424407959
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 0.8410549163818359  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6700270175933838
loading full batch data spends  0.002888202667236328
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 25.784 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 25.784 GB
Metis partitioning: 0.000 seconds, peak memory: 25.784 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.004932403564453125
pure dgl.metis_partition the time spent:  0.002214670181274414
connection checking time:  0.006088972091674805
block generation total time  0.009119272232055664
generate_dataloader_block spend   0.025887489318847656
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 1.0382146835327148  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 1.038217544555664  GigaBytes
Max Memory Allocated: 1.2799005508422852  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 0.9856476783752441  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 0.9856500625610352  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

pure train time  0.2918074131011963
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.935546875 GB
    Memory Allocated: 0.8404064178466797  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6120553016662598
loading full batch data spends  0.0033469200134277344
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 25.784 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 25.784 GB
Metis partitioning: 0.000 seconds, peak memory: 25.784 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.005217075347900391
pure dgl.metis_partition the time spent:  0.002384185791015625
connection checking time:  0.006227254867553711
block generation total time  0.009176015853881836
generate_dataloader_block spend   0.02650904655456543
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.943359375 GB
    Memory Allocated: 1.0288958549499512  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.943359375 GB
    Memory Allocated: 1.0288987159729004  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.943359375 GB
    Memory Allocated: 0.9945974349975586  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.943359375 GB
    Memory Allocated: 0.9945998191833496  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

pure train time  0.2737131118774414
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.943359375 GB
    Memory Allocated: 0.8404083251953125  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5362164974212646
loading full batch data spends  0.0028002262115478516
REG start----................................
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 25.784 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 25.784 GB
Metis partitioning: 0.000 seconds, peak memory: 25.784 GB
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0050296783447265625
pure dgl.metis_partition the time spent:  0.0020024776458740234
connection checking time:  0.0061833858489990234
block generation total time  0.009102344512939453
generate_dataloader_block spend   0.025791645050048828
step  0
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.943359375 GB
    Memory Allocated: 1.0107450485229492  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.943359375 GB
    Memory Allocated: 1.0107479095458984  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

step  1
----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.943359375 GB
    Memory Allocated: 1.012197494506836  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.943359375 GB
    Memory Allocated: 1.012199878692627  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

pure train time  0.2681119441986084
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.943359375 GB
    Memory Allocated: 0.8405671119689941  GigaBytes
Max Memory Allocated: 1.2854127883911133  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4353516101837158
Total (block generation + training)time/epoch 0.4718743051801409
pure train time/epoch 0.27955901622772217

num_input_list  [1497, 1523, 1540, 1521, 1527, 1520, 1547, 1535, 1535, 1520]
