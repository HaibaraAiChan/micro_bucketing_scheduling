main start at this time 1698464624.6946537
karate data
{}
{}
Graph(num_nodes=7, num_edges=14,
      ndata_schemes={'label': Scheme(shape=(), dtype=torch.int64), 'feat': Scheme(shape=(4,), dtype=torch.float32)}
      edata_schemes={})
#nodes: 7
#edges: 14
#classes: 2
success----------------------------------------
4
2
1
# Nodes: 7
# Edges: 14
# Train: 4
# Val: 2
# Test: 1
# Classes: 2

in feats:  4
connection checking time:  0
block generation total time  0
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.462890625 GB
    Memory Allocated: 0.03133106231689453  GigaBytes
Max Memory Allocated: 0.03133106231689453  GigaBytes

--------------------------m.shape torch.Size([2, 1, 4])
----------------------------------------1
 Nvidia-smi: 1.54296875 GB
    Memory Allocated: 0.031337738037109375  GigaBytes
Max Memory Allocated: 0.03133964538574219  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.54296875 GB
    Memory Allocated: 0.031337738037109375  GigaBytes
Max Memory Allocated: 0.03133964538574219  GigaBytes

 h.shape torch.Size([1, 2, 4]), torch.Size([1, 2, 4])
----------------------------------------3
 Nvidia-smi: 1.54296875 GB
    Memory Allocated: 0.03133869171142578  GigaBytes
Max Memory Allocated: 0.03133964538574219  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.0313420295715332  GigaBytes
Max Memory Allocated: 0.031342506408691406  GigaBytes

rst.shape  torch.Size([1, 2, 4])
--------------------------m.shape torch.Size([4, 2, 4])
----------------------------------------1
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.0313420295715332  GigaBytes
Max Memory Allocated: 0.031343936920166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.0313420295715332  GigaBytes
Max Memory Allocated: 0.031343936920166016  GigaBytes

 h.shape torch.Size([1, 4, 4]), torch.Size([1, 4, 4])
----------------------------------------3
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03134298324584961  GigaBytes
Max Memory Allocated: 0.031343936920166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03134870529174805  GigaBytes
Max Memory Allocated: 0.03134918212890625  GigaBytes

rst.shape  torch.Size([1, 4, 4])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03134441375732422  GigaBytes
Max Memory Allocated: 0.031350135803222656  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03136730194091797  GigaBytes
Max Memory Allocated: 0.03136730194091797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03139543533325195  GigaBytes
Max Memory Allocated: 0.0314183235168457  GigaBytes

--------------------------m.shape torch.Size([1, 1, 1024])
----------------------------------------1
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03144121170043945  GigaBytes
Max Memory Allocated: 0.031441688537597656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03144121170043945  GigaBytes
Max Memory Allocated: 0.031441688537597656  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.0314488410949707  GigaBytes
Max Memory Allocated: 0.0314488410949707  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.0315098762512207  GigaBytes
Max Memory Allocated: 0.03151369094848633  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([1, 2, 1024])
----------------------------------------1
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03151416778564453  GigaBytes
Max Memory Allocated: 0.031514644622802734  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03151416778564453  GigaBytes
Max Memory Allocated: 0.031514644622802734  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03152179718017578  GigaBytes
Max Memory Allocated: 0.03152179718017578  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03163623809814453  GigaBytes
Max Memory Allocated: 0.03164386749267578  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([2, 3, 1024])
----------------------------------------1
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03165578842163086  GigaBytes
Max Memory Allocated: 0.03165626525878906  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03165578842163086  GigaBytes
Max Memory Allocated: 0.03165626525878906  GigaBytes

 h.shape torch.Size([1, 2, 1024]), torch.Size([1, 2, 1024])
----------------------------------------3
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03167104721069336  GigaBytes
Max Memory Allocated: 0.03167104721069336  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03200674057006836  GigaBytes
Max Memory Allocated: 0.03202962875366211  GigaBytes

rst.shape  torch.Size([1, 2, 1024])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.03197526931762695  GigaBytes
Max Memory Allocated: 0.03204488754272461  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.031975746154785156  GigaBytes
Max Memory Allocated: 0.03204488754272461  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.031975746154785156  GigaBytes
Max Memory Allocated: 0.03204488754272461  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.552734375 GB
    Memory Allocated: 0.031977176666259766  GigaBytes
Max Memory Allocated: 0.03204488754272461  GigaBytes

pure train time  0.4356842041015625
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.1253213882446289  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6675108671188354
connection checking time:  0
block generation total time  0
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.1253199577331543  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

--------------------------m.shape torch.Size([2, 1, 4])
----------------------------------------1
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

 h.shape torch.Size([1, 2, 4]), torch.Size([1, 2, 4])
----------------------------------------3
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12532758712768555  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

rst.shape  torch.Size([1, 2, 4])
--------------------------m.shape torch.Size([4, 2, 4])
----------------------------------------1
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

 h.shape torch.Size([1, 4, 4]), torch.Size([1, 4, 4])
----------------------------------------3
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12533187866210938  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.1253376007080078  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

rst.shape  torch.Size([1, 4, 4])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12533330917358398  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12535619735717773  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12538433074951172  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

--------------------------m.shape torch.Size([1, 1, 1024])
----------------------------------------1
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12543773651123047  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12549877166748047  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([1, 2, 1024])
----------------------------------------1
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12551069259643555  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.1256251335144043  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([2, 3, 1024])
----------------------------------------1
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

 h.shape torch.Size([1, 2, 1024]), torch.Size([1, 2, 1024])
----------------------------------------3
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12565994262695312  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12599563598632812  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

rst.shape  torch.Size([1, 2, 1024])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12596416473388672  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.12596464157104492  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.1259603500366211  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.701171875 GB
    Memory Allocated: 0.1259617805480957  GigaBytes
Max Memory Allocated: 0.1721963882446289  GigaBytes

pure train time  0.04636263847351074
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253213882446289  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6505905389785767
connection checking time:  0
block generation total time  0
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253199577331543  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([2, 1, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 4]), torch.Size([1, 2, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532758712768555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 4])
--------------------------m.shape torch.Size([4, 2, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 4, 4]), torch.Size([1, 4, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533187866210938  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253376007080078  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 4, 4])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533330917358398  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12535619735717773  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12538433074951172  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([1, 1, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543773651123047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12549877166748047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([1, 2, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12551069259643555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1256251335144043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([2, 3, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 1024]), torch.Size([1, 2, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12565994262695312  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12599563598632812  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 1024])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596416473388672  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596464157104492  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259603500366211  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259617805480957  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

pure train time  0.04858231544494629
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253213882446289  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.5009270310401917
loading full batch data spends  0.0050754547119140625
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   6.437301635742188e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253199577331543  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([2, 1, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 4]), torch.Size([1, 2, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532758712768555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 4])
--------------------------m.shape torch.Size([4, 2, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 4, 4]), torch.Size([1, 4, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533187866210938  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253376007080078  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 4, 4])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533330917358398  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12535619735717773  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12538433074951172  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([1, 1, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543773651123047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12549877166748047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([1, 2, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12551069259643555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1256251335144043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([2, 3, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 1024]), torch.Size([1, 2, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12565994262695312  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12599563598632812  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 1024])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596416473388672  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596464157104492  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259603500366211  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259617805480957  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

pure train time  0.04826474189758301
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253213882446289  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9802542924880981
loading full batch data spends  0.0054624080657958984
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   5.8650970458984375e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253199577331543  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([2, 1, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 4]), torch.Size([1, 2, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532758712768555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 4])
--------------------------m.shape torch.Size([4, 2, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 4, 4]), torch.Size([1, 4, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533187866210938  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253376007080078  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 4, 4])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533330917358398  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12535619735717773  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12538433074951172  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([1, 1, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543773651123047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12549877166748047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([1, 2, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12551069259643555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1256251335144043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([2, 3, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 1024]), torch.Size([1, 2, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12565994262695312  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12599563598632812  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 1024])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596416473388672  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596464157104492  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259603500366211  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259617805480957  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

pure train time  0.046390533447265625
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253213882446289  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.3823928236961365
loading full batch data spends  0.004433155059814453
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   6.246566772460938e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253199577331543  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([2, 1, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 4]), torch.Size([1, 2, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532758712768555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 4])
--------------------------m.shape torch.Size([4, 2, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 4, 4]), torch.Size([1, 4, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533187866210938  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253376007080078  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 4, 4])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533330917358398  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12535619735717773  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12538433074951172  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([1, 1, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543773651123047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12549877166748047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([1, 2, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12551069259643555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1256251335144043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([2, 3, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 1024]), torch.Size([1, 2, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12565994262695312  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12599563598632812  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 1024])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596416473388672  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596464157104492  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259603500366211  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259617805480957  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

pure train time  0.046920061111450195
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253213882446289  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.423293799161911
loading full batch data spends  0.005451202392578125
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   5.316734313964844e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253199577331543  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([2, 1, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 4]), torch.Size([1, 2, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532758712768555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 4])
--------------------------m.shape torch.Size([4, 2, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 4, 4]), torch.Size([1, 4, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533187866210938  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253376007080078  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 4, 4])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533330917358398  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12535619735717773  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12538433074951172  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([1, 1, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543773651123047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12549877166748047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([1, 2, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12551069259643555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1256251335144043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([2, 3, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 1024]), torch.Size([1, 2, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12565994262695312  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12599563598632812  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 1024])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596416473388672  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596464157104492  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259603500366211  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259617805480957  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

pure train time  0.04757094383239746
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253213882446289  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6295927166938782
loading full batch data spends  0.005682468414306641
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   8.153915405273438e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253199577331543  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([2, 1, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 4]), torch.Size([1, 2, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532758712768555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 4])
--------------------------m.shape torch.Size([4, 2, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 4, 4]), torch.Size([1, 4, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533187866210938  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253376007080078  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 4, 4])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533330917358398  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12535619735717773  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12538433074951172  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([1, 1, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543773651123047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12549877166748047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([1, 2, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12551069259643555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1256251335144043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([2, 3, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 1024]), torch.Size([1, 2, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12565994262695312  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12599563598632812  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 1024])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596416473388672  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596464157104492  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259603500366211  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259617805480957  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

pure train time  0.046029090881347656
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253213882446289  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.822492778301239
loading full batch data spends  0.002172231674194336
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   3.504753112792969e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253199577331543  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([2, 1, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 4]), torch.Size([1, 2, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532758712768555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 4])
--------------------------m.shape torch.Size([4, 2, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 4, 4]), torch.Size([1, 4, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533187866210938  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253376007080078  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 4, 4])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533330917358398  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12535619735717773  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12538433074951172  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([1, 1, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543773651123047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12549877166748047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([1, 2, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12551069259643555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1256251335144043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([2, 3, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 1024]), torch.Size([1, 2, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12565994262695312  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12599563598632812  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 1024])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596416473388672  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596464157104492  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259603500366211  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259617805480957  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

pure train time  0.037496089935302734
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253213882446289  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.4651617705821991
loading full batch data spends  0.00201416015625
connection checking time:  0
block generation total time  0
generate_dataloader_block spend   3.0279159545898438e-05
step  0
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253199577331543  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([2, 1, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532663345336914  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 4]), torch.Size([1, 2, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12532758712768555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 4])
--------------------------m.shape torch.Size([4, 2, 4])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533092498779297  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 4, 4]), torch.Size([1, 4, 4])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533187866210938  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253376007080078  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 4, 4])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12533330917358398  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12535619735717773  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12538433074951172  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

--------------------------m.shape torch.Size([1, 1, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543010711669922  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12543773651123047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12549877166748047  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([1, 2, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1255030632019043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 1, 1024]), torch.Size([1, 1, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12551069259643555  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1256251335144043  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 1, 1024])
--------------------------m.shape torch.Size([2, 3, 1024])
----------------------------------------1
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12564468383789062  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

 h.shape torch.Size([1, 2, 1024]), torch.Size([1, 2, 1024])
----------------------------------------3
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12565994262695312  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12599563598632812  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

rst.shape  torch.Size([1, 2, 1024])
----------------------------------------after graph.update_all
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596416473388672  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.12596464157104492  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259603500366211  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1259617805480957  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

pure train time  0.037020206451416016
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.716796875 GB
    Memory Allocated: 0.1253213882446289  GigaBytes
Max Memory Allocated: 0.18830013275146484  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.2745818495750427
Total (block generation + training)time/epoch 0.05135996001107352
pure train time/epoch 0.043571154276529946

num_input_list  [6, 6, 6, 6, 6, 6, 6, 6, 6, 6]
