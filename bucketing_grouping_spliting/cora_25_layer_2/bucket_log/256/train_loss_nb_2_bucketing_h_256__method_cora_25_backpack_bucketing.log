main start at this time 1698473505.5203743
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
get_in_degree_bucketing src global nid  tensor([  48,  128,  122,   89,  129,   69,   97,  131,   99,  101,   74,  118,
           5,   12,   51,   77,   85,    7,   34,  107,   78,  138,   17,    3,
          30,   11,   45,   98,   10,   68,   66,   25,  102,   80,  137,  106,
          62,   82,  121,  116,   41,  123,    2,  114,   13,    0,   38,  132,
          26,   50,  111,  103,   59,   93,    1,  130,   84,  119,    4,  104,
          61,   44,   64,  135,   90,   20,   27,   96,   37,   72,  120,   14,
          58,   23,  109,   53,    9,  110,   21,   87,   71,   29,   52,   39,
          43,   88,    8,  108,  117,  126,   65,  105,   67,  125,   24,  133,
          40,  112,   49,   15,   47,  124,   42,    6,  115,  139,   16,   32,
         113,   31,   22,  134,   83,   94,   73,   76,   63,   36,   92,   18,
          95,   46,  136,   54,   57,   60,   70,   86,   19,   55,  127,   91,
          33,  100,   79,   56,   28,   81,   75,   35,  598,  714, 1031, 1662,
        1666, 2041, 2205, 2206, 2471,  233,  370,  392, 2270, 2454, 2455,  258,
         884, 1087, 1094, 1157, 1401, 1530, 1585, 1653, 2463,  441,  701,  604,
        1013, 1351, 1914, 1920, 1926, 2189,  661, 1353,  834, 2169, 2604,  281,
        1358, 1589,  544,  586, 1042, 1118, 1416, 1517, 2052, 2155, 2419,  255,
         388,  446,  454,  554,  581,  842, 1029, 1343, 1507, 1538, 1616, 1690,
        1851, 2010, 2030, 2112, 2165, 2166, 1629, 1659, 2546, 1001, 1318, 2661,
        2662,  457,  710, 1392, 2213, 2214, 2215,  659, 1803, 1065, 2487, 2488,
         208,  541,  971, 1113, 1650, 1219, 1329, 1418,  236,  306, 1776,  927,
        1315, 1316, 2140, 2544,  697,  738, 2162, 2343, 1655, 1839,  733, 1986,
        2303, 2667, 2668, 1521,  476, 2545,  391, 2631, 1301, 1344, 2011, 2317,
        1251, 1448, 1561, 1623, 1871, 1878, 2256,  257, 1117, 2049, 2144, 2329,
        2504, 2461,  485, 1138, 1634,  589,  802,  980, 1158, 1910, 2251, 2252,
        1076, 1501,  175,  596,  644,  332, 1454,  610, 2288, 2506, 1701, 1810,
         633, 1862, 2582,  429,  862,  863, 1160,  379,  479,  904, 1022, 1959,
        1441,  758, 1169, 1762, 2492, 2643,  484,  608, 1775, 1790,  580,  609,
         615, 1067, 1287, 1627, 1725, 2651,  550,  950, 1495, 2151,  652,  654,
        1982, 2017,  284, 2223, 2224, 2226,  646, 1537, 1549, 1901, 1016, 1256,
        1761, 2175, 2176,  401,  864, 2210, 1080, 1309, 2312, 1582, 2624, 2701,
        1209, 1737, 2616, 2095,  155,  156,  817, 1072, 2269, 2374, 2375,  606,
        2360, 2578, 2217, 1190, 2427, 1103,  483,  514,  816, 1842, 2405,  158,
        2034, 2075, 2077, 1715, 2159,  318, 1787,  153, 1789, 1337, 1661,  176,
        2094,  426, 1346,  459, 1772, 1779, 1805, 2093,  289, 1769, 1045, 1739,
         723, 2614,  567, 1161, 1262, 1599, 2279, 1043, 2310, 2164,  206, 2691,
         963, 2645, 1139, 1467, 2053, 2172, 2182, 1349, 1522, 1532, 1965, 2357,
         152, 2399, 2400,  841, 1394,  696, 1908, 1741,  162, 1882,  415, 2012,
        1527,  743,  851, 2178, 1713,  815, 2013, 1174, 1288, 1847,  269, 1996,
        1647, 2157, 2209,  259, 2537, 1551, 2045, 2079,  239,  543,  619,  771,
        1156, 1293, 1628, 2021, 2418, 1721, 2476,  282,  540, 2628,  458, 2363,
         201, 1636, 2139, 2141,  399,  452, 1670, 1777, 1784, 2082,  507,  866,
        1364,  487, 2080, 1090, 1093, 1271, 2367,  163, 1579, 1367, 1622, 2478,
        1372,  373, 1602,  973,  660,  910, 1780,  970, 1632, 2444, 2642,  279,
         518, 1850, 1973,  747, 1884, 1594, 1234, 1702, 1703, 2238,  406, 1520,
        2581,  195,  675,  934, 1649, 1966, 2263, 2355, 2490,  449,  558,  797,
         876, 1035, 1136, 1189, 1214, 1723, 1745, 1751, 2018, 1322, 1146, 1505,
        1552, 1640, 1781, 2106, 2107,  898, 1836, 1560, 1786, 2145,  334,  456,
         693,  734,  736,  861, 1303, 1535, 1580, 1838, 2054, 2074, 2181, 2183,
        2197, 2199, 2200, 2201, 1604, 2366,  831,  767, 2184, 1336, 2295, 1939,
         210,  323,  651,  787, 1079, 1983, 2020,  330, 1046, 2001, 2122, 2123,
        2380,  286,  588,  698,  911, 1051, 2040, 2119, 2120, 2121, 2056,  603,
        2097,  412,  447, 1849, 1687,  347,  423,  527, 2180,  583, 2222, 2225,
         895, 1296, 1913])
get_in_degree_bucketing dst global nid  tensor([ 48, 128, 122,  89, 129,  69,  97, 131,  99, 101,  74, 118,   5,  12,
         51,  77,  85,   7,  34, 107,  78, 138,  17,   3,  30,  11,  45,  98,
         10,  68,  66,  25, 102,  80, 137, 106,  62,  82, 121, 116,  41, 123,
          2, 114,  13,   0,  38, 132,  26,  50, 111, 103,  59,  93,   1, 130,
         84, 119,   4, 104,  61,  44,  64, 135,  90,  20,  27,  96,  37,  72,
        120,  14,  58,  23, 109,  53,   9, 110,  21,  87,  71,  29,  52,  39,
         43,  88,   8, 108, 117, 126,  65, 105,  67, 125,  24, 133,  40, 112,
         49,  15,  47, 124,  42,   6, 115, 139,  16,  32, 113,  31,  22, 134,
         83,  94,  73,  76,  63,  36,  92,  18,  95,  46, 136,  54,  57,  60,
         70,  86,  19,  55, 127,  91,  33, 100,  79,  56,  28,  81,  75,  35])
get_in_degree_bucketing corresponding in degs tensor([ 9,  4,  4, 10,  2,  7,  2,  2,  6,  3,  9, 19,  3,  4,  6,  2,  3,  1,
         1,  4,  3,  3,  5,  1,  6,  2,  6,  1,  2,  3,  1,  4,  8,  3,  4,  1,
         1,  2,  7,  2,  4,  4,  5,  3,  2,  3,  4,  5,  5,  1,  6,  6, 10,  4,
         3,  3,  5,  6,  5,  4,  5,  3,  3,  3,  4,  5,  4,  1,  3,  2,  5,  5,
         1,  1, 25,  3,  2,  5,  2,  3,  3,  2,  5,  7,  6, 25,  3,  3,  2,  6,
        10,  4,  3,  2,  7,  9,  3,  4,  2,  4,  2,  5,  2,  4,  1,  8,  4,  4,
         3,  1,  5,  1,  2, 11, 12,  3,  1,  8,  2,  5, 21,  2,  1,  2,  1,  3,
         2,  4,  1, 12,  1,  6,  9,  2,  2,  4,  1,  4,  6,  3])
len(bkt)  20
local bkt nids  tensor([ 17,  18,  23,  27,  30,  35,  36,  49,  67,  72,  73, 104, 109, 111,
        116, 122, 124, 128, 130, 136])
len(bkt)  25
local bkt nids  tensor([  4,   6,   7,  15,  25,  28,  37,  39,  44,  69,  76,  78,  81,  88,
         93,  98, 100, 102, 112, 118, 121, 123, 126, 133, 134])
len(bkt)  26
local bkt nids  tensor([  9,  12,  16,  20,  21,  29,  33,  43,  45,  54,  55,  61,  62,  63,
         68,  75,  79,  80,  86,  87,  92,  96, 108, 115, 125, 139])
len(bkt)  22
local bkt nids  tensor([  1,   2,  13,  19,  31,  34,  40,  41,  46,  53,  59,  64,  66,  91,
         97,  99, 103, 106, 107, 127, 135, 137])
len(bkt)  15
local bkt nids  tensor([ 22,  42,  47,  48,  56,  58,  60,  65,  70,  71,  77,  82, 101, 110,
        119])
len(bkt)  11
local bkt nids  tensor([  8,  14,  24,  26,  50,  51,  57,  84,  89, 131, 138])
len(bkt)  4
local bkt nids  tensor([ 5, 38, 83, 94])
len(bkt)  3
local bkt nids  tensor([ 32, 105, 117])
len(bkt)  4
local bkt nids  tensor([  0,  10,  95, 132])
len(bkt)  3
local bkt nids  tensor([ 3, 52, 90])
len(bkt)  1
local bkt nids  tensor([113])
len(bkt)  2
local bkt nids  tensor([114, 129])
len(bkt)  1
local bkt nids  tensor([11])
len(bkt)  1
local bkt nids  tensor([120])
len(bkt)  2
local bkt nids  tensor([74, 85])
bucket partitioner: bkt_dst_nodes_list_local  [tensor([ 17,  18,  23,  27,  30,  35,  36,  49,  67,  72,  73, 104, 109, 111,
        116, 122, 124, 128, 130, 136]), tensor([  4,   6,   7,  15,  25,  28,  37,  39,  44,  69,  76,  78,  81,  88,
         93,  98, 100, 102, 112, 118, 121, 123, 126, 133, 134]), tensor([  9,  12,  16,  20,  21,  29,  33,  43,  45,  54,  55,  61,  62,  63,
         68,  75,  79,  80,  86,  87,  92,  96, 108, 115, 125, 139]), tensor([  1,   2,  13,  19,  31,  34,  40,  41,  46,  53,  59,  64,  66,  91,
         97,  99, 103, 106, 107, 127, 135, 137]), tensor([ 22,  42,  47,  48,  56,  58,  60,  65,  70,  71,  77,  82, 101, 110,
        119]), tensor([  8,  14,  24,  26,  50,  51,  57,  84,  89, 131, 138]), tensor([ 5, 38, 83, 94]), tensor([ 32, 105, 117]), tensor([  0,  10,  95, 132]), tensor([ 3, 52, 90]), tensor([113]), tensor([114, 129]), tensor([11]), tensor([120]), tensor([74, 85])]
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
memory_constraint:  0.19
sum(estimated_mem)
0.36848267912864685
15
the grouping_fanout_cora called successfully
capacity  190
 
sorted_dict  {3: 54, 4: 49, 2: 39, 5: 39, 1: 29, 14: 28, 8: 22, 9: 18, 6: 17, 7: 14, 11: 14, 13: 14, 12: 10, 0: 9, 10: 5}

weights after sort [54, 49, 39, 39, 29, 28, 22, 18, 17, 14, 14, 14, 10, 9, 5]
res_tmp  [54 39 29 28 22 18]

remove bucket_id:  [0, 2, 4, 5, 6, 7]
original bucket_id :,  [3, 2, 1, 14, 8, 9]
remove weights:  [54 39 29 28 22 18], 		------------sum 190

before remove weights,  [54, 49, 39, 39, 29, 28, 22, 18, 17, 14, 14, 14, 10, 9, 5]
after remove pre pack weights,  [49, 39, 17, 14, 14, 14, 10, 9, 5]
G_BUCKET_ID_list [[3, 2, 1, 14, 8, 9], [4, 2, 6, 7, 11, 13, 12, 0, 10]]
Groups_mem_list  [[54, 39, 29, 28, 22, 18], [49, 39, 17, 14, 14, 14, 10, 9, 5]]
G_BUCKET_ID_list length 2
backpack scheduling spend  0.004441499710083008
current group_mem  0.192594476044178
current group_mem  0.17561374604701996
batches output list generation spend  0.0007429122924804688
self.weights_list  [0.5857142857142857, 0.5214285714285715]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01113438606262207
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0052487850189208984
local_to_global: src global  tensor([  48,  128,  122,   89,  129,   69,   97,  131,   99,  101,   74,  118,
           5,   12,   51,   77,   85,    7,   34,  107,   78,  138,   17,    3,
          30,   11,   45,   98,   10,   68,   66,   25,  102,   80,  137,  106,
          62,   82,  121,  116,   41,  123,    2,  114,   13,    0,   38,  132,
          26,   50,  111,  103,   59,   93,    1,  130,   84,  119,    4,  104,
          61,   44,   64,  135,   90,   20,   27,   96,   37,   72,  120,   14,
          58,   23,  109,   53,    9,  110,   21,   87,   71,   29,   52,   39,
          43,   88,    8,  108,  117,  126,   65,  105,   67,  125,   24,  133,
          40,  112,   49,   15,   47,  124,   42,    6,  115,  139,   16,   32,
         113,   31,   22,  134,   83,   94,   73,   76,   63,   36,   92,   18,
          95,   46,  136,   54,   57,   60,   70,   86,   19,   55,  127,   91,
          33,  100,   79,   56,   28,   81,   75,   35,  598,  714, 1031, 1662,
        1666, 2041, 2205, 2206, 2471,  233,  370,  392, 2270, 2454, 2455,  258,
         884, 1087, 1094, 1157, 1401, 1530, 1585, 1653, 2463,  441,  701,  604,
        1013, 1351, 1914, 1920, 1926, 2189,  661, 1353,  834, 2169, 2604,  281,
        1358, 1589,  544,  586, 1042, 1118, 1416, 1517, 2052, 2155, 2419,  255,
         388,  446,  454,  554,  581,  842, 1029, 1343, 1507, 1538, 1616, 1690,
        1851, 2010, 2030, 2112, 2165, 2166, 1629, 1659, 2546, 1001, 1318, 2661,
        2662,  457,  710, 1392, 2213, 2214, 2215,  659, 1803, 1065, 2487, 2488,
         208,  541,  971, 1113, 1650, 1219, 1329, 1418,  236,  306, 1776,  927,
        1315, 1316, 2140, 2544,  697,  738, 2162, 2343, 1655, 1839,  733, 1986,
        2303, 2667, 2668, 1521,  476, 2545,  391, 2631, 1301, 1344, 2011, 2317,
        1251, 1448, 1561, 1623, 1871, 1878, 2256,  257, 1117, 2049, 2144, 2329,
        2504, 2461,  485, 1138, 1634,  589,  802,  980, 1158, 1910, 2251, 2252,
        1076, 1501,  175,  596,  644,  332, 1454,  610, 2288, 2506, 1701, 1810,
         633, 1862, 2582,  429,  862,  863, 1160,  379,  479,  904, 1022, 1959,
        1441,  758, 1169, 1762, 2492, 2643,  484,  608, 1775, 1790,  580,  609,
         615, 1067, 1287, 1627, 1725, 2651,  550,  950, 1495, 2151,  652,  654,
        1982, 2017,  284, 2223, 2224, 2226,  646, 1537, 1549, 1901, 1016, 1256,
        1761, 2175, 2176,  401,  864, 2210, 1080, 1309, 2312, 1582, 2624, 2701,
        1209, 1737, 2616, 2095,  155,  156,  817, 1072, 2269, 2374, 2375,  606,
        2360, 2578, 2217, 1190, 2427, 1103,  483,  514,  816, 1842, 2405,  158,
        2034, 2075, 2077, 1715, 2159,  318, 1787,  153, 1789, 1337, 1661,  176,
        2094,  426, 1346,  459, 1772, 1779, 1805, 2093,  289, 1769, 1045, 1739,
         723, 2614,  567, 1161, 1262, 1599, 2279, 1043, 2310, 2164,  206, 2691,
         963, 2645, 1139, 1467, 2053, 2172, 2182, 1349, 1522, 1532, 1965, 2357,
         152, 2399, 2400,  841, 1394,  696, 1908, 1741,  162, 1882,  415, 2012,
        1527,  743,  851, 2178, 1713,  815, 2013, 1174, 1288, 1847,  269, 1996,
        1647, 2157, 2209,  259, 2537, 1551, 2045, 2079,  239,  543,  619,  771,
        1156, 1293, 1628, 2021, 2418, 1721, 2476,  282,  540, 2628,  458, 2363,
         201, 1636, 2139, 2141,  399,  452, 1670, 1777, 1784, 2082,  507,  866,
        1364,  487, 2080, 1090, 1093, 1271, 2367,  163, 1579, 1367, 1622, 2478,
        1372,  373, 1602,  973,  660,  910, 1780,  970, 1632, 2444, 2642,  279,
         518, 1850, 1973,  747, 1884, 1594, 1234, 1702, 1703, 2238,  406, 1520,
        2581,  195,  675,  934, 1649, 1966, 2263, 2355, 2490,  449,  558,  797,
         876, 1035, 1136, 1189, 1214, 1723, 1745, 1751, 2018, 1322, 1146, 1505,
        1552, 1640, 1781, 2106, 2107,  898, 1836, 1560, 1786, 2145,  334,  456,
         693,  734,  736,  861, 1303, 1535, 1580, 1838, 2054, 2074, 2181, 2183,
        2197, 2199, 2200, 2201, 1604, 2366,  831,  767, 2184, 1336, 2295, 1939,
         210,  323,  651,  787, 1079, 1983, 2020,  330, 1046, 2001, 2122, 2123,
        2380,  286,  588,  698,  911, 1051, 2040, 2119, 2120, 2121, 2056,  603,
        2097,  412,  447, 1849, 1687,  347,  423,  527, 2180,  583, 2222, 2225,
         895, 1296, 1913])
partition total batch output list spend :  0.021572351455688477
self.buckets_partition() spend  sec:  0.016400575637817383
bucketing dataloader: layer  0
bucketing dataloader: the number of batches:  2
bucketing dataloader: global_batched_output_nid_list  [tensor([ 48, 128, 122,  89, 129,  97, 131, 101,  74,   5,  12,  77,  85, 107,
         78, 138,  11,  10,  68,  25,  80, 137,  82, 116,  41, 123, 114,  13,
          0,  38,  59,  93,   1, 130, 104,  44,  64, 135,  90,  27,  37,  72,
        109,  53,   9,  21,  87,  71,  29,  88,   8, 108, 117,  65, 105,  67,
        125, 133,  40, 112,  49,  15,  47,  42,   6,  16,  32, 113,  83,  76,
         92,  46,  54,  60,  70,  86,  33, 100,  79,  56,  81,  35]), tensor([ 69, 101, 118,   5,  85,   7,  34,  78, 138,  17,   3,  98,  68,  66,
        102,  80, 106,  62, 121,   2, 114,   0, 132,  26,  50,   1, 130,  84,
          4,  61,  44,  64, 135,  20,  96,  37, 120,  14,  58,  23,  53, 110,
         87,  71,  52,  39,   8, 108,  67,  24,  40, 124, 115, 139, 113,  31,
         22, 134,  94,  73,  76,  63,  36,  18,  95, 136,  57,  60,  19,  55,
        127,  28,  35])]
check_connections_block*********************************
connection check : local_output_nid  82
connection check : local_output_nid  73

block_gen_time in "generate_blocks_for_one_layer_block"  0.007836103439331055

----------------------------------------
bucketing dataloader: layer  1
bucketing dataloader: num of batch  2
check_connections_block*********************************
connection check : local_output_nid  365
connection check : local_output_nid  345

block_gen_time in "generate_blocks_for_one_layer_block"  0.005754947662353516

block collection to dataloader spend  8.821487426757812e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.515625 GB
    Memory Allocated: 0.072296142578125  GigaBytes
Max Memory Allocated: 0.072296142578125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.759765625 GB
    Memory Allocated: 0.22182989120483398  GigaBytes
Max Memory Allocated: 0.22883224487304688  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.759765625 GB
    Memory Allocated: 0.2218332290649414  GigaBytes
Max Memory Allocated: 0.22883224487304688  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.896484375 GB
    Memory Allocated: 0.14019536972045898  GigaBytes
Max Memory Allocated: 0.3395729064941406  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.896484375 GB
    Memory Allocated: 0.2857241630554199  GigaBytes
Max Memory Allocated: 0.3395729064941406  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 1.896484375 GB
    Memory Allocated: 0.28572654724121094  GigaBytes
Max Memory Allocated: 0.3395729064941406  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.275299072265625  GigaBytes
Max Memory Allocated: 0.39820384979248047  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.1504859924316406
pure train time :  0.5526947975158691
train time :  1.1057937145233154
end to end time :  1.1537044048309326
connection check time:  0.010608434677124023
block generation time  0.01359105110168457
generate_dataloader_bucket_block=======
get_in_degree_bucketing src global nid  tensor([  29,   48,   79,   69,   43,   66,  124,   75,   28,   63,   33,  127,
         114,    7,   17,   77,   34,   64,  110,   84,   51,   62,  104,   18,
         121,   25,  139,   54,   10,  109,   49,   67,   22,   57,   70,   19,
          11,  132,   52,   91,   38,  125,   68,   81,    0,  137,  115,  100,
          37,   47,    3,   46,    9,   96,   45,   88,   32,  111,  107,  123,
          86,   99,  122,   78,   76,   94,   40,   58,   41,   80,   73,  130,
          59,   31,  116,  133,   97,   42,   98,   44,   14,   72,   60,  128,
         131,   12,   74,  102,  119,  103,    4,   30,  118,    1,   92,   87,
         106,  101,   15,   36,  136,   53,   39,   24,   50,  112,    6,   65,
          71,  135,  113,   35,   82,   93,  138,   95,   83,  129,   90,   16,
           8,   13,   56,   26,  117,  120,   21,   23,   89,    2,   27,  105,
          85,    5,  126,   55,  108,  134,   20,   61,  963, 2645,  598,  714,
        1031, 1662, 1666, 2041, 2205, 2206, 2471,  603, 2097,  604, 1013, 1351,
        1914, 1920, 1926, 2189,  152, 1530, 1653, 2399, 2400, 2631,  306, 1367,
        1622, 2478,  583, 2222, 2223, 2224, 2225, 1687, 1322,  286,  588,  698,
         911, 1051, 2040, 2119, 2120, 2121, 2604,  610, 2288, 2506,  208,  927,
        1315, 1316, 2140,  659, 1803, 1358, 1209, 1737, 2616,  567, 1161, 1262,
        1599, 2279,  284, 2226,  457,  710, 1392, 2213, 2214, 2215,  485,  401,
         864, 1065, 2210, 1560, 1786, 2082, 2145,  589,  802,  980, 1158, 1910,
        2251, 2252, 1301, 1344, 2011, 2317,  660,  910, 1623, 1780, 2045,  767,
         476, 2545, 1661, 2093,  153,  176, 1045, 1346, 2092, 2095,  289,  563,
        1779,  519,  236, 1787, 2094, 1772, 1785,  426,  459, 2034,  282,  540,
        2628, 1234, 1702, 1703, 2238, 2418,  441, 2184, 1939, 1655, 1839,  379,
         479,  904, 1022, 1959, 1139, 1467, 2053, 2172, 2182,  330, 1046, 2001,
        2122, 2123, 2380,  429,  862,  863, 1160,  458, 2363,  391, 1986,  347,
         423,  527, 2180,  633, 1862, 2582, 2144, 2329, 2504,  973, 1602, 2056,
        1190, 2427,  163, 1579, 2544, 1604, 2366,  723, 2614, 2217,  733, 1219,
        2303, 2667, 2668, 1527, 1309,  696,  162, 1882, 1732,  851, 1394, 2178,
         815, 1174, 2012, 1658,  841,  300, 1741, 2017, 2010, 2014, 1677, 2013,
        2394,  279,  518, 1850, 1973,  758, 1169, 1762, 2492, 2643,  541,  971,
        1113, 1650, 2455, 1336, 2295, 2454, 1329, 1418, 2018,  195,  586,  675,
         934, 1649, 1966, 2263, 2355, 2357, 2490,  507,  866, 1364, 1715,  175,
         596,  644,  257, 1117, 2049,  449,  558,  797,  876, 1035, 1136, 1189,
        1214, 1723, 1745, 1751, 1982,  580,  609,  615, 1067, 1287, 1627, 1725,
        2651, 1594, 1076, 1501,  399,  452, 1670, 1777, 1784,  661, 1353, 1372,
        1521, 1582, 2624, 2701,  158, 2075, 2077, 1103,  233,  370,  392, 2270,
         834, 2169, 1001, 1318, 2661, 2662,  544, 1042, 1118, 1416, 1517, 2052,
        2155, 2419, 1251, 1448, 1561, 1871, 1878, 2256,  646, 1537, 1549, 1901,
         484,  608, 1775, 1790, 1016, 1256, 1761, 2175, 2176,  697,  738, 2162,
        2343,  255,  388,  446,  454,  554,  581,  842, 1029, 1343, 1507, 1538,
        1616, 1690, 1851, 2030, 2112, 2165, 2166,  652,  654,  898, 1836, 2164,
        2461,  281, 1589, 1090, 1093, 1271, 2367, 1146, 1505, 1552, 1640, 1781,
        2106, 2107,  831, 1739, 1349, 1522, 1532, 1634, 1965,  201, 1636, 1701,
        2139, 2141, 1441,  487, 2080,  373,  239,  543,  619,  771, 1156, 1293,
        1628, 2021,  206, 2691,  747, 1884,  895, 1296, 1913, 1138,  550,  950,
        1495, 2151, 1776,  334,  456,  693,  734,  736,  861, 1303, 1535, 1580,
        1838, 2054, 2074, 2181, 2183, 2197, 2199, 2200, 2201, 1520, 2581,  701,
         155,  156,  817,  970, 1632, 2444, 2642,  269, 1996, 1810,  412,  447,
        1849,  259, 2537,  483,  514,  816, 1842, 2405, 1043, 2310, 2159,  258,
         884, 1087, 1094, 1157, 1401, 1585, 2463,  332, 1454,  606, 2360, 2578,
        1721, 2476, 2487, 2488, 1629, 1659, 2546, 1551, 2079,  210,  323,  651,
         787, 1079, 1983, 2020, 1647, 2157, 2209,  406, 1072, 2269, 2374, 2375,
        1080, 2312])
get_in_degree_bucketing dst global nid  tensor([ 29,  48,  79,  69,  43,  66, 124,  75,  28,  63,  33, 127, 114,   7,
         17,  77,  34,  64, 110,  84,  51,  62, 104,  18, 121,  25, 139,  54,
         10, 109,  49,  67,  22,  57,  70,  19,  11, 132,  52,  91,  38, 125,
         68,  81,   0, 137, 115, 100,  37,  47,   3,  46,   9,  96,  45,  88,
         32, 111, 107, 123,  86,  99, 122,  78,  76,  94,  40,  58,  41,  80,
         73, 130,  59,  31, 116, 133,  97,  42,  98,  44,  14,  72,  60, 128,
        131,  12,  74, 102, 119, 103,   4,  30, 118,   1,  92,  87, 106, 101,
         15,  36, 136,  53,  39,  24,  50, 112,   6,  65,  71, 135, 113,  35,
         82,  93, 138,  95,  83, 129,  90,  16,   8,  13,  56,  26, 117, 120,
         21,  23,  89,   2,  27, 105,  85,   5, 126,  55, 108, 134,  20,  61])
get_in_degree_bucketing corresponding in degs tensor([ 2,  9,  2,  7,  6,  1,  5,  6,  1,  1,  9,  1,  3,  1,  5,  2,  1,  3,
         5,  5,  6,  1,  4,  5,  7,  4,  8,  2,  2, 25,  2,  3,  5,  1,  2,  1,
         2,  5,  5,  6,  4,  2,  3,  4,  3,  4,  1,  2,  3,  2,  1,  2,  2,  1,
         6, 25,  4,  6,  4,  4,  4,  6,  4,  3,  3, 11,  3,  1,  4,  3, 12,  3,
        10,  1,  2,  9,  2,  2,  1,  3,  5,  2,  3,  4,  2,  4,  9,  8,  6,  6,
         5,  6, 19,  3,  2,  3,  1,  3,  4,  8,  1,  3,  7,  7,  1,  4,  4, 10,
         3,  3,  3,  3,  2,  4,  3, 21,  2,  2,  4,  4,  3,  2,  4,  5,  2,  5,
         2,  1, 10,  5,  4,  4,  3,  3,  6, 12,  3,  1,  5,  5])
len(bkt)  20
local bkt nids  tensor([  5,   8,   9,  11,  13,  16,  21,  33,  35,  46,  50,  53,  67,  73,
         78,  96, 100, 104, 127, 137])
len(bkt)  25
local bkt nids  tensor([  0,   2,  15,  27,  28,  30,  34,  36,  41,  47,  49,  51,  52,  74,
         76,  77,  81,  84,  94, 112, 116, 117, 121, 124, 126])
len(bkt)  26
local bkt nids  tensor([ 12,  17,  31,  42,  44,  48,  63,  64,  66,  69,  71,  79,  82,  93,
         95,  97, 101, 108, 109, 110, 111, 114, 120, 132, 133, 136])
len(bkt)  22
local bkt nids  tensor([ 22,  25,  40,  43,  45,  56,  58,  59,  60,  62,  68,  83,  85,  98,
        105, 106, 113, 118, 119, 122, 130, 131])
len(bkt)  15
local bkt nids  tensor([  6,  14,  18,  19,  23,  32,  37,  38,  80,  90, 123, 125, 129, 138,
        139])
len(bkt)  11
local bkt nids  tensor([  4,   7,  20,  39,  54,  57,  61,  88,  89,  91, 134])
len(bkt)  4
local bkt nids  tensor([  3,  24, 102, 103])
len(bkt)  3
local bkt nids  tensor([26, 87, 99])
len(bkt)  4
local bkt nids  tensor([ 1, 10, 75, 86])
len(bkt)  3
local bkt nids  tensor([ 72, 107, 128])
len(bkt)  1
local bkt nids  tensor([65])
len(bkt)  2
local bkt nids  tensor([ 70, 135])
len(bkt)  1
local bkt nids  tensor([92])
len(bkt)  1
local bkt nids  tensor([115])
len(bkt)  2
local bkt nids  tensor([29, 55])
bucket partitioner: bkt_dst_nodes_list_local  [tensor([  5,   8,   9,  11,  13,  16,  21,  33,  35,  46,  50,  53,  67,  73,
         78,  96, 100, 104, 127, 137]), tensor([  0,   2,  15,  27,  28,  30,  34,  36,  41,  47,  49,  51,  52,  74,
         76,  77,  81,  84,  94, 112, 116, 117, 121, 124, 126]), tensor([ 12,  17,  31,  42,  44,  48,  63,  64,  66,  69,  71,  79,  82,  93,
         95,  97, 101, 108, 109, 110, 111, 114, 120, 132, 133, 136]), tensor([ 22,  25,  40,  43,  45,  56,  58,  59,  60,  62,  68,  83,  85,  98,
        105, 106, 113, 118, 119, 122, 130, 131]), tensor([  6,  14,  18,  19,  23,  32,  37,  38,  80,  90, 123, 125, 129, 138,
        139]), tensor([  4,   7,  20,  39,  54,  57,  61,  88,  89,  91, 134]), tensor([  3,  24, 102, 103]), tensor([26, 87, 99]), tensor([ 1, 10, 75, 86]), tensor([ 72, 107, 128]), tensor([65]), tensor([ 70, 135]), tensor([92]), tensor([115]), tensor([29, 55])]
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
memory_constraint:  0.19
sum(estimated_mem)
0.36848267912864685
15
the grouping_fanout_cora called successfully
capacity  190
 
sorted_dict  {3: 54, 4: 49, 2: 39, 5: 39, 1: 29, 14: 28, 8: 22, 9: 18, 6: 17, 7: 14, 11: 14, 13: 14, 12: 10, 0: 9, 10: 5}

weights after sort [54, 49, 39, 39, 29, 28, 22, 18, 17, 14, 14, 14, 10, 9, 5]
res_tmp  [54 39 29 28 22 18]

remove bucket_id:  [0, 2, 4, 5, 6, 7]
original bucket_id :,  [3, 2, 1, 14, 8, 9]
remove weights:  [54 39 29 28 22 18], 		------------sum 190

before remove weights,  [54, 49, 39, 39, 29, 28, 22, 18, 17, 14, 14, 14, 10, 9, 5]
after remove pre pack weights,  [49, 39, 17, 14, 14, 14, 10, 9, 5]
G_BUCKET_ID_list [[3, 2, 1, 14, 8, 9], [4, 2, 6, 7, 11, 13, 12, 0, 10]]
Groups_mem_list  [[54, 39, 29, 28, 22, 18], [49, 39, 17, 14, 14, 14, 10, 9, 5]]
G_BUCKET_ID_list length 2
backpack scheduling spend  0.004070281982421875
current group_mem  0.192594476044178
current group_mem  0.17561374604701996
batches output list generation spend  5.1975250244140625e-05
self.weights_list  [0.5857142857142857, 0.5214285714285715]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010700702667236328
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004168033599853516
local_to_global: src global  tensor([  29,   48,   79,   69,   43,   66,  124,   75,   28,   63,   33,  127,
         114,    7,   17,   77,   34,   64,  110,   84,   51,   62,  104,   18,
         121,   25,  139,   54,   10,  109,   49,   67,   22,   57,   70,   19,
          11,  132,   52,   91,   38,  125,   68,   81,    0,  137,  115,  100,
          37,   47,    3,   46,    9,   96,   45,   88,   32,  111,  107,  123,
          86,   99,  122,   78,   76,   94,   40,   58,   41,   80,   73,  130,
          59,   31,  116,  133,   97,   42,   98,   44,   14,   72,   60,  128,
         131,   12,   74,  102,  119,  103,    4,   30,  118,    1,   92,   87,
         106,  101,   15,   36,  136,   53,   39,   24,   50,  112,    6,   65,
          71,  135,  113,   35,   82,   93,  138,   95,   83,  129,   90,   16,
           8,   13,   56,   26,  117,  120,   21,   23,   89,    2,   27,  105,
          85,    5,  126,   55,  108,  134,   20,   61,  963, 2645,  598,  714,
        1031, 1662, 1666, 2041, 2205, 2206, 2471,  603, 2097,  604, 1013, 1351,
        1914, 1920, 1926, 2189,  152, 1530, 1653, 2399, 2400, 2631,  306, 1367,
        1622, 2478,  583, 2222, 2223, 2224, 2225, 1687, 1322,  286,  588,  698,
         911, 1051, 2040, 2119, 2120, 2121, 2604,  610, 2288, 2506,  208,  927,
        1315, 1316, 2140,  659, 1803, 1358, 1209, 1737, 2616,  567, 1161, 1262,
        1599, 2279,  284, 2226,  457,  710, 1392, 2213, 2214, 2215,  485,  401,
         864, 1065, 2210, 1560, 1786, 2082, 2145,  589,  802,  980, 1158, 1910,
        2251, 2252, 1301, 1344, 2011, 2317,  660,  910, 1623, 1780, 2045,  767,
         476, 2545, 1661, 2093,  153,  176, 1045, 1346, 2092, 2095,  289,  563,
        1779,  519,  236, 1787, 2094, 1772, 1785,  426,  459, 2034,  282,  540,
        2628, 1234, 1702, 1703, 2238, 2418,  441, 2184, 1939, 1655, 1839,  379,
         479,  904, 1022, 1959, 1139, 1467, 2053, 2172, 2182,  330, 1046, 2001,
        2122, 2123, 2380,  429,  862,  863, 1160,  458, 2363,  391, 1986,  347,
         423,  527, 2180,  633, 1862, 2582, 2144, 2329, 2504,  973, 1602, 2056,
        1190, 2427,  163, 1579, 2544, 1604, 2366,  723, 2614, 2217,  733, 1219,
        2303, 2667, 2668, 1527, 1309,  696,  162, 1882, 1732,  851, 1394, 2178,
         815, 1174, 2012, 1658,  841,  300, 1741, 2017, 2010, 2014, 1677, 2013,
        2394,  279,  518, 1850, 1973,  758, 1169, 1762, 2492, 2643,  541,  971,
        1113, 1650, 2455, 1336, 2295, 2454, 1329, 1418, 2018,  195,  586,  675,
         934, 1649, 1966, 2263, 2355, 2357, 2490,  507,  866, 1364, 1715,  175,
         596,  644,  257, 1117, 2049,  449,  558,  797,  876, 1035, 1136, 1189,
        1214, 1723, 1745, 1751, 1982,  580,  609,  615, 1067, 1287, 1627, 1725,
        2651, 1594, 1076, 1501,  399,  452, 1670, 1777, 1784,  661, 1353, 1372,
        1521, 1582, 2624, 2701,  158, 2075, 2077, 1103,  233,  370,  392, 2270,
         834, 2169, 1001, 1318, 2661, 2662,  544, 1042, 1118, 1416, 1517, 2052,
        2155, 2419, 1251, 1448, 1561, 1871, 1878, 2256,  646, 1537, 1549, 1901,
         484,  608, 1775, 1790, 1016, 1256, 1761, 2175, 2176,  697,  738, 2162,
        2343,  255,  388,  446,  454,  554,  581,  842, 1029, 1343, 1507, 1538,
        1616, 1690, 1851, 2030, 2112, 2165, 2166,  652,  654,  898, 1836, 2164,
        2461,  281, 1589, 1090, 1093, 1271, 2367, 1146, 1505, 1552, 1640, 1781,
        2106, 2107,  831, 1739, 1349, 1522, 1532, 1634, 1965,  201, 1636, 1701,
        2139, 2141, 1441,  487, 2080,  373,  239,  543,  619,  771, 1156, 1293,
        1628, 2021,  206, 2691,  747, 1884,  895, 1296, 1913, 1138,  550,  950,
        1495, 2151, 1776,  334,  456,  693,  734,  736,  861, 1303, 1535, 1580,
        1838, 2054, 2074, 2181, 2183, 2197, 2199, 2200, 2201, 1520, 2581,  701,
         155,  156,  817,  970, 1632, 2444, 2642,  269, 1996, 1810,  412,  447,
        1849,  259, 2537,  483,  514,  816, 1842, 2405, 1043, 2310, 2159,  258,
         884, 1087, 1094, 1157, 1401, 1585, 2463,  332, 1454,  606, 2360, 2578,
        1721, 2476, 2487, 2488, 1629, 1659, 2546, 1551, 2079,  210,  323,  651,
         787, 1079, 1983, 2020, 1647, 2157, 2209,  406, 1072, 2269, 2374, 2375,
        1080, 2312])
partition total batch output list spend :  0.01952838897705078
self.buckets_partition() spend  sec:  0.01488351821899414
bucketing dataloader: layer  0
bucketing dataloader: the number of batches:  2
bucketing dataloader: global_batched_output_nid_list  [tensor([ 29,  48,  79,  33, 114,  77,  64, 104,  25,  54,  10, 109,  49,  67,
         70,  11,  38, 125,  68,  81,   0, 137, 100,  37,  47,  46,   9,  88,
         32, 107, 123,  86, 122,  78,  76,  40,  41,  80, 130,  59, 116, 133,
         97,  42,  44,  72,  60, 128, 131,  12,  74,   1,  92,  87, 101,  15,
         53, 112,   6,  65,  71, 135, 113,  35,  82,  93, 138,  83, 129,  90,
         16,   8,  13,  56, 117,  21,  89,  27, 105,  85,   5, 108]), tensor([ 69,  66, 124,  28,  63, 127, 114,   7,  17,  34,  64, 110,  84,  62,
         18, 121, 139,  67,  22,  57,  19, 132,  52,  68,   0, 115,  37,   3,
         96,  78,  76,  94,  40,  58,  80,  73, 130,  31,  98,  44,  14,  60,
        102,   4, 118,   1,  87, 106, 101,  36, 136,  53,  39,  24,  50,  71,
        135, 113,  35, 138,  95,   8,  26, 120,  23,   2,  85,   5,  55, 108,
        134,  20,  61])]
check_connections_block*********************************
connection check : local_output_nid  82
connection check : local_output_nid  73

block_gen_time in "generate_blocks_for_one_layer_block"  0.0040819644927978516

----------------------------------------
bucketing dataloader: layer  1
bucketing dataloader: num of batch  2
check_connections_block*********************************
connection check : local_output_nid  364
connection check : local_output_nid  345

block_gen_time in "generate_blocks_for_one_layer_block"  0.0058443546295166016

block collection to dataloader spend  4.291534423828125e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.052734375 GB
    Memory Allocated: 0.2752799987792969  GigaBytes
Max Memory Allocated: 0.39820384979248047  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.056640625 GB
    Memory Allocated: 0.4245777130126953  GigaBytes
Max Memory Allocated: 0.43216705322265625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.056640625 GB
    Memory Allocated: 0.42457008361816406  GigaBytes
Max Memory Allocated: 0.43216705322265625  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.091796875 GB
    Memory Allocated: 0.27527809143066406  GigaBytes
Max Memory Allocated: 0.5375308990478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.091796875 GB
    Memory Allocated: 0.42070865631103516  GigaBytes
Max Memory Allocated: 0.5375308990478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.091796875 GB
    Memory Allocated: 0.42071104049682617  GigaBytes
Max Memory Allocated: 0.5375308990478516  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 2.091796875 GB
    Memory Allocated: 0.275299072265625  GigaBytes
Max Memory Allocated: 0.5375308990478516  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.1234865188598633
pure train time :  0.16358661651611328
train time :  0.18822693824768066
end to end time :  0.2262413501739502
connection check time:  0.006791353225708008
block generation time  0.009926319122314453
generate_dataloader_bucket_block=======
get_in_degree_bucketing src global nid  tensor([  53,   39,   50,   55,   10,   80,  123,   37,  134,   83,   51,  125,
          92,   25,  102,  111,   89,  119,    0,   49,  120,  126,   61,  139,
         105,   96,   28,   99,   88,  136,    1,   84,   95,   36,   17,    2,
         131,   45,   77,   26,   62,   60,   73,  110,  118,   29,  135,   97,
          56,   18,  127,   46,   33,   69,   32,   12,   42,   58,   54,    4,
         116,   19,   79,   64,   72,   76,   24,  108,  100,   13,   86,   85,
          98,    7,  107,   30,  104,   40,   52,   21,  122,   57,   48,   82,
          15,  117,   20,  124,   81,   23,  137,   44,  121,  109,   94,   41,
          66,   43,    9,  132,   22,    8,   65,   16,   35,  133,  128,    3,
          74,   78,  138,    5,  129,  103,  113,   90,   14,   59,  114,   67,
         106,   75,  101,   63,   71,   87,   93,   91,   11,  115,   34,   31,
          70,   38,   47,   27,  130,   68,  112,    6, 1103, 1358, 1739, 1349,
        1522, 1532, 1634, 1965, 2357, 1441,  210,  323,  651,  771,  787,  815,
        1079, 1156, 1983, 2020, 2021,  476, 2545,  257, 1117, 2049, 2455, 2604,
        1190, 2427,  406, 1520, 2581,  457,  710, 1392, 2213, 2214, 2215,  458,
        2363,  898, 1836, 1301, 1344, 2011, 2317, 1251, 1448, 1561, 1623, 1871,
        1878, 2256,  758, 1169, 1762, 2492, 2643,  258,  884, 1087, 1094, 1157,
        1401, 1530, 1585, 1653, 2463,  379,  646, 1537, 1549, 1901, 1959,  633,
        1862, 2582, 1666, 2034,  483,  514,  816, 1842, 2405,  236,  306, 1551,
        2045, 2079, 1080, 1309, 1416, 2162, 2312,  660,  910, 1780, 1721, 2476,
        2651, 2217, 1687, 2454, 1658, 2394, 2178,  498,  743, 1908,  737, 2013,
        2012, 1713, 1174, 1527, 1882,  162, 1288, 1494, 1741,  415, 2016,  300,
        1394,  831,  652,  654,  284, 2223, 2224, 2226,  334,  456,  693,  734,
         736,  861, 1303, 1535, 1580, 1602, 1628, 1838, 2054, 2074, 2181, 2182,
        2183, 2197, 2199, 2200, 2201, 1146, 1505, 1552, 1640, 1781, 2094, 2106,
        2107,  927, 1315, 1316, 2140,  332, 1454, 1986,  834, 2169,  733, 1219,
        2303, 2667, 2668,  659, 1803,  485,  449,  558,  797,  876, 1035, 1136,
        1189, 1214, 1723, 1745, 1751,  567, 1161, 1262, 1599, 2279,  255,  388,
         446,  454,  554,  581,  842, 1029, 1343, 1507, 1538, 1616, 1690, 1851,
        2010, 2030, 2112, 2165, 2166,  963, 2645, 2095, 2144,  661, 1353,  412,
         447, 1849, 1560, 1786, 2082, 2145, 1604, 2366,  286,  588,  698,  911,
        1051, 2040, 2119, 2120, 2121,  604, 1013, 1351, 1914, 1920, 1926, 2189,
         279,  518, 1850, 1973, 1001, 1318, 2661, 2662, 1372, 1715,  401,  767,
        1016, 1256, 1761, 2175, 2176, 1076, 1501, 1939,  603, 2097, 1209, 1737,
        2616, 2018,  201,  598, 1636, 1701, 2139, 2141, 1647, 2157, 2209, 2056,
        1810,  429, 1336, 2295, 1065, 2487, 2488, 1521,  208,  541,  971, 1113,
        1650,  697,  738, 2343,  864, 2210,  507,  866, 1364, 1139, 1467, 2053,
        2172, 1043, 2310, 2418,  714, 1031, 1662, 2041, 2205, 2206, 2471, 1138,
        1090, 1093, 1271, 2367,  259, 2537, 1072, 2269, 2270, 2374, 2375, 1367,
        1622, 2478,  347,  423,  527, 2180, 2159, 2329, 2504, 1582, 2624, 2701,
         589,  802,  980, 1158, 1910, 2251, 2252,  318, 2093, 1789, 1998, 1337,
        2092,  563, 1661,  153,  176, 1045,  426,  459, 1769,  289, 1772, 1805,
        1779, 1785,  195,  586,  675,  934, 1649, 1966, 2263, 2355, 2490,  175,
         596,  644, 2631,  152, 2399, 2400,  723, 2614,  479,  904, 1022, 1234,
        1702, 1703, 2238,  269,  281, 1996,  239,  543,  619, 1293, 2419,  970,
        1632, 2444, 2642,  895, 1296, 1913,  399,  452, 1670, 1777, 1784,  233,
         370,  392, 2544,  544, 1042, 1118, 1517, 2052, 2155, 1329, 1418, 1776,
        1629, 1659, 2546,  441,  701,  484,  608, 1775, 1790,  540,  747, 1884,
         155,  156,  817,  158, 2075, 2077,  580,  609,  615, 1067, 1287, 1627,
        1725,  610, 2288, 2506,  282, 2628, 2461,  583, 2222, 2225, 1589, 1322,
         206, 2691, 2164,  550,  950, 1495, 2151,  330, 1046, 2001, 2122, 2123,
        2380, 1655, 1839,  973, 1594, 2184,  862,  863, 1160,  163, 1579,  606,
        2360, 2578, 1982, 2017,  391,  487, 2080,  373])
get_in_degree_bucketing dst global nid  tensor([ 53,  39,  50,  55,  10,  80, 123,  37, 134,  83,  51, 125,  92,  25,
        102, 111,  89, 119,   0,  49, 120, 126,  61, 139, 105,  96,  28,  99,
         88, 136,   1,  84,  95,  36,  17,   2, 131,  45,  77,  26,  62,  60,
         73, 110, 118,  29, 135,  97,  56,  18, 127,  46,  33,  69,  32,  12,
         42,  58,  54,   4, 116,  19,  79,  64,  72,  76,  24, 108, 100,  13,
         86,  85,  98,   7, 107,  30, 104,  40,  52,  21, 122,  57,  48,  82,
         15, 117,  20, 124,  81,  23, 137,  44, 121, 109,  94,  41,  66,  43,
          9, 132,  22,   8,  65,  16,  35, 133, 128,   3,  74,  78, 138,   5,
        129, 103, 113,  90,  14,  59, 114,  67, 106,  75, 101,  63,  71,  87,
         93,  91,  11, 115,  34,  31,  70,  38,  47,  27, 130,  68, 112,   6])
get_in_degree_bucketing corresponding in degs tensor([ 3,  7,  1, 12,  2,  3,  4,  3,  1,  2,  6,  2,  2,  4,  8,  6, 10,  6,
         3,  2,  5,  6,  5,  8,  4,  1,  1,  6, 25,  1,  3,  5, 21,  8,  5,  5,
         2,  6,  2,  5,  1,  3, 12,  5, 19,  2,  3,  2,  4,  5,  1,  2,  9,  7,
         4,  4,  2,  1,  2,  5,  2,  1,  2,  3,  2,  3,  7,  3,  2,  2,  4,  3,
         1,  1,  4,  6,  4,  3,  5,  2,  4,  1,  9,  2,  4,  2,  5,  5,  4,  1,
         4,  3,  7, 25, 11,  4,  1,  6,  2,  5,  5,  3, 10,  4,  3,  9,  4,  1,
         9,  3,  3,  3,  2,  6,  3,  4,  5, 10,  3,  3,  1,  6,  3,  1,  3,  3,
         4,  6,  2,  1,  1,  1,  2,  4,  2,  4,  3,  3,  4,  4])
len(bkt)  20
local bkt nids  tensor([  2,   8,  25,  26,  29,  40,  50,  57,  61,  72,  73,  81,  89,  96,
        107, 120, 123, 129, 130, 131])
len(bkt)  25
local bkt nids  tensor([  4,   9,  11,  12,  19,  36,  38,  45,  47,  51,  56,  58,  60,  62,
         64,  68,  69,  79,  83,  85,  98, 112, 128, 132, 134])
len(bkt)  26
local bkt nids  tensor([  0,   5,   7,  18,  30,  41,  46,  63,  65,  67,  71,  77,  91, 101,
        104, 109, 110, 111, 114, 118, 119, 122, 124, 125, 136, 137])
len(bkt)  22
local bkt nids  tensor([  6,  13,  24,  48,  54,  55,  70,  74,  76,  80,  84,  88,  90,  95,
        103, 106, 115, 126, 133, 135, 138, 139])
len(bkt)  15
local bkt nids  tensor([ 20,  22,  31,  34,  35,  39,  43,  49,  59,  78,  86,  87,  99, 100,
        116])
len(bkt)  11
local bkt nids  tensor([ 10,  15,  17,  21,  27,  37,  75,  97, 113, 121, 127])
len(bkt)  4
local bkt nids  tensor([ 1, 53, 66, 92])
len(bkt)  3
local bkt nids  tensor([14, 23, 33])
len(bkt)  4
local bkt nids  tensor([ 52,  82, 105, 108])
len(bkt)  3
local bkt nids  tensor([ 16, 102, 117])
len(bkt)  1
local bkt nids  tensor([94])
len(bkt)  2
local bkt nids  tensor([ 3, 42])
len(bkt)  1
local bkt nids  tensor([44])
len(bkt)  1
local bkt nids  tensor([32])
len(bkt)  2
local bkt nids  tensor([28, 93])
bucket partitioner: bkt_dst_nodes_list_local  [tensor([  2,   8,  25,  26,  29,  40,  50,  57,  61,  72,  73,  81,  89,  96,
        107, 120, 123, 129, 130, 131]), tensor([  4,   9,  11,  12,  19,  36,  38,  45,  47,  51,  56,  58,  60,  62,
         64,  68,  69,  79,  83,  85,  98, 112, 128, 132, 134]), tensor([  0,   5,   7,  18,  30,  41,  46,  63,  65,  67,  71,  77,  91, 101,
        104, 109, 110, 111, 114, 118, 119, 122, 124, 125, 136, 137]), tensor([  6,  13,  24,  48,  54,  55,  70,  74,  76,  80,  84,  88,  90,  95,
        103, 106, 115, 126, 133, 135, 138, 139]), tensor([ 20,  22,  31,  34,  35,  39,  43,  49,  59,  78,  86,  87,  99, 100,
        116]), tensor([ 10,  15,  17,  21,  27,  37,  75,  97, 113, 121, 127]), tensor([ 1, 53, 66, 92]), tensor([14, 23, 33]), tensor([ 52,  82, 105, 108]), tensor([ 16, 102, 117]), tensor([94]), tensor([ 3, 42]), tensor([44]), tensor([32]), tensor([28, 93])]
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
memory_constraint:  0.19
sum(estimated_mem)
0.36848267912864685
15
the grouping_fanout_cora called successfully
capacity  190
 
sorted_dict  {3: 54, 4: 49, 2: 39, 5: 39, 1: 29, 14: 28, 8: 22, 9: 18, 6: 17, 7: 14, 11: 14, 13: 14, 12: 10, 0: 9, 10: 5}

weights after sort [54, 49, 39, 39, 29, 28, 22, 18, 17, 14, 14, 14, 10, 9, 5]
res_tmp  [54 39 29 28 22 18]

remove bucket_id:  [0, 2, 4, 5, 6, 7]
original bucket_id :,  [3, 2, 1, 14, 8, 9]
remove weights:  [54 39 29 28 22 18], 		------------sum 190

before remove weights,  [54, 49, 39, 39, 29, 28, 22, 18, 17, 14, 14, 14, 10, 9, 5]
after remove pre pack weights,  [49, 39, 17, 14, 14, 14, 10, 9, 5]
G_BUCKET_ID_list [[3, 2, 1, 14, 8, 9], [4, 2, 6, 7, 11, 13, 12, 0, 10]]
Groups_mem_list  [[54, 39, 29, 28, 22, 18], [49, 39, 17, 14, 14, 14, 10, 9, 5]]
G_BUCKET_ID_list length 2
backpack scheduling spend  0.004063606262207031
current group_mem  0.192594476044178
current group_mem  0.17561374604701996
batches output list generation spend  5.0067901611328125e-05
self.weights_list  [0.5857142857142857, 0.5214285714285715]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01123189926147461
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004158973693847656
local_to_global: src global  tensor([  53,   39,   50,   55,   10,   80,  123,   37,  134,   83,   51,  125,
          92,   25,  102,  111,   89,  119,    0,   49,  120,  126,   61,  139,
         105,   96,   28,   99,   88,  136,    1,   84,   95,   36,   17,    2,
         131,   45,   77,   26,   62,   60,   73,  110,  118,   29,  135,   97,
          56,   18,  127,   46,   33,   69,   32,   12,   42,   58,   54,    4,
         116,   19,   79,   64,   72,   76,   24,  108,  100,   13,   86,   85,
          98,    7,  107,   30,  104,   40,   52,   21,  122,   57,   48,   82,
          15,  117,   20,  124,   81,   23,  137,   44,  121,  109,   94,   41,
          66,   43,    9,  132,   22,    8,   65,   16,   35,  133,  128,    3,
          74,   78,  138,    5,  129,  103,  113,   90,   14,   59,  114,   67,
         106,   75,  101,   63,   71,   87,   93,   91,   11,  115,   34,   31,
          70,   38,   47,   27,  130,   68,  112,    6, 1103, 1358, 1739, 1349,
        1522, 1532, 1634, 1965, 2357, 1441,  210,  323,  651,  771,  787,  815,
        1079, 1156, 1983, 2020, 2021,  476, 2545,  257, 1117, 2049, 2455, 2604,
        1190, 2427,  406, 1520, 2581,  457,  710, 1392, 2213, 2214, 2215,  458,
        2363,  898, 1836, 1301, 1344, 2011, 2317, 1251, 1448, 1561, 1623, 1871,
        1878, 2256,  758, 1169, 1762, 2492, 2643,  258,  884, 1087, 1094, 1157,
        1401, 1530, 1585, 1653, 2463,  379,  646, 1537, 1549, 1901, 1959,  633,
        1862, 2582, 1666, 2034,  483,  514,  816, 1842, 2405,  236,  306, 1551,
        2045, 2079, 1080, 1309, 1416, 2162, 2312,  660,  910, 1780, 1721, 2476,
        2651, 2217, 1687, 2454, 1658, 2394, 2178,  498,  743, 1908,  737, 2013,
        2012, 1713, 1174, 1527, 1882,  162, 1288, 1494, 1741,  415, 2016,  300,
        1394,  831,  652,  654,  284, 2223, 2224, 2226,  334,  456,  693,  734,
         736,  861, 1303, 1535, 1580, 1602, 1628, 1838, 2054, 2074, 2181, 2182,
        2183, 2197, 2199, 2200, 2201, 1146, 1505, 1552, 1640, 1781, 2094, 2106,
        2107,  927, 1315, 1316, 2140,  332, 1454, 1986,  834, 2169,  733, 1219,
        2303, 2667, 2668,  659, 1803,  485,  449,  558,  797,  876, 1035, 1136,
        1189, 1214, 1723, 1745, 1751,  567, 1161, 1262, 1599, 2279,  255,  388,
         446,  454,  554,  581,  842, 1029, 1343, 1507, 1538, 1616, 1690, 1851,
        2010, 2030, 2112, 2165, 2166,  963, 2645, 2095, 2144,  661, 1353,  412,
         447, 1849, 1560, 1786, 2082, 2145, 1604, 2366,  286,  588,  698,  911,
        1051, 2040, 2119, 2120, 2121,  604, 1013, 1351, 1914, 1920, 1926, 2189,
         279,  518, 1850, 1973, 1001, 1318, 2661, 2662, 1372, 1715,  401,  767,
        1016, 1256, 1761, 2175, 2176, 1076, 1501, 1939,  603, 2097, 1209, 1737,
        2616, 2018,  201,  598, 1636, 1701, 2139, 2141, 1647, 2157, 2209, 2056,
        1810,  429, 1336, 2295, 1065, 2487, 2488, 1521,  208,  541,  971, 1113,
        1650,  697,  738, 2343,  864, 2210,  507,  866, 1364, 1139, 1467, 2053,
        2172, 1043, 2310, 2418,  714, 1031, 1662, 2041, 2205, 2206, 2471, 1138,
        1090, 1093, 1271, 2367,  259, 2537, 1072, 2269, 2270, 2374, 2375, 1367,
        1622, 2478,  347,  423,  527, 2180, 2159, 2329, 2504, 1582, 2624, 2701,
         589,  802,  980, 1158, 1910, 2251, 2252,  318, 2093, 1789, 1998, 1337,
        2092,  563, 1661,  153,  176, 1045,  426,  459, 1769,  289, 1772, 1805,
        1779, 1785,  195,  586,  675,  934, 1649, 1966, 2263, 2355, 2490,  175,
         596,  644, 2631,  152, 2399, 2400,  723, 2614,  479,  904, 1022, 1234,
        1702, 1703, 2238,  269,  281, 1996,  239,  543,  619, 1293, 2419,  970,
        1632, 2444, 2642,  895, 1296, 1913,  399,  452, 1670, 1777, 1784,  233,
         370,  392, 2544,  544, 1042, 1118, 1517, 2052, 2155, 1329, 1418, 1776,
        1629, 1659, 2546,  441,  701,  484,  608, 1775, 1790,  540,  747, 1884,
         155,  156,  817,  158, 2075, 2077,  580,  609,  615, 1067, 1287, 1627,
        1725,  610, 2288, 2506,  282, 2628, 2461,  583, 2222, 2225, 1589, 1322,
         206, 2691, 2164,  550,  950, 1495, 2151,  330, 1046, 2001, 2122, 2123,
        2380, 1655, 1839,  973, 1594, 2184,  862,  863, 1160,  163, 1579,  606,
        2360, 2578, 1982, 2017,  391,  487, 2080,  373])
partition total batch output list spend :  0.02010512351989746
self.buckets_partition() spend  sec:  0.015405893325805664
bucketing dataloader: layer  0
bucketing dataloader: the number of batches:  2
bucketing dataloader: global_batched_output_nid_list  [tensor([ 53,  10,  80, 123,  37,  83, 125,  92,  25,  89,   0,  49, 105,  88,
          1, 131,  77,  60,  29, 135,  97,  56,  46,  33,  32,  12,  42,  54,
        116,  79,  64,  72,  76, 108, 100,  13,  86,  85, 107, 104,  40,  21,
        122,  48,  82,  15, 117,  81, 137,  44, 109,  41,   9,   8,  65,  16,
         35, 133, 128,  74,  78, 138,   5, 129, 113,  90,  59, 114,  67, 101,
         71,  87,  93,  11,  70,  38,  47,  27, 130,  68, 112,   6]), tensor([ 53,  39,  50,  55,  80,  37, 134, 102,   0, 120,  61, 139,  96,  28,
        136,   1,  84,  95,  36,  17,   2,  26,  62,  60,  73, 110, 118, 135,
         18, 127,  69,  58,   4,  19,  64,  76,  24, 108,  85,  98,   7,  40,
         52,  57,  20, 124,  23,  44, 121,  94,  66, 132,  22,   8,  35,   3,
         78, 138,   5, 113,  14, 114,  67, 106, 101,  63,  71,  87, 115,  34,
         31, 130,  68])]
check_connections_block*********************************
connection check : local_output_nid  82
connection check : local_output_nid  73

block_gen_time in "generate_blocks_for_one_layer_block"  0.0038335323333740234

----------------------------------------
bucketing dataloader: layer  1
bucketing dataloader: num of batch  2
check_connections_block*********************************
connection check : local_output_nid  368
connection check : local_output_nid  345

block_gen_time in "generate_blocks_for_one_layer_block"  0.005839109420776367

block collection to dataloader spend  4.5299530029296875e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.091796875 GB
    Memory Allocated: 0.27531003952026367  GigaBytes
Max Memory Allocated: 0.5375308990478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.091796875 GB
    Memory Allocated: 0.4263644218444824  GigaBytes
Max Memory Allocated: 0.5375308990478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.091796875 GB
    Memory Allocated: 0.42635679244995117  GigaBytes
Max Memory Allocated: 0.5375308990478516  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.27527809143066406  GigaBytes
Max Memory Allocated: 0.5387849807739258  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.42070865631103516  GigaBytes
Max Memory Allocated: 0.5387849807739258  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.42071104049682617  GigaBytes
Max Memory Allocated: 0.5387849807739258  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.275299072265625  GigaBytes
Max Memory Allocated: 0.5387849807739258  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.101271390914917
pure train time :  0.15990900993347168
train time :  0.1848764419555664
end to end time :  0.22313523292541504
connection check time:  0.0067327022552490234
block generation time  0.00967264175415039
generate_dataloader_bucket_block=======
get_in_degree_bucketing src global nid  tensor([ 106,   38,   72,   55,   86,   23,  110,   44,   73,  133,   52,  135,
         104,   16,  118,   65,  112,  107,   98,   30,    9,   74,   76,   50,
         127,  132,  103,   84,  138,   12,   28,   91,   70,   66,   43,  109,
         131,  120,  111,   71,   21,  101,   42,   14,   25,  139,   58,   27,
          11,   35,  126,   33,   75,   60,   97,   15,   99,    8,   87,   82,
          59,   36,   34,   18,   85,  137,   26,   24,   13,  105,  114,  122,
           3,   57,   92,  100,   37,  108,   41,   53,  134,   64,   47,  125,
          79,    6,   39,    4,  115,  128,   48,   95,   67,  117,  129,  123,
          80,   22,   46,   61,   81,   69,   94,    0,  116,  136,   68,  113,
          40,   17,    2,  121,   29,    7,  102,   83,   62,   88,   19,   51,
           5,   56,   20,  130,   32,    1,   90,   89,   77,   63,   78,  124,
         119,   45,   96,   54,   31,   49,   93,   10, 2461,  429,  862,  863,
        1160, 1103, 1358,  210,  323,  651,  771,  787,  815, 1079, 1156, 1983,
        2020, 2021, 1336, 2034, 2295, 2159,  567, 1161, 1262, 1599, 2279, 1582,
        2624, 2701,  449,  558,  797,  876, 1035, 1136, 1189, 1214, 1723, 1745,
        1751,  399,  452, 1623, 1670, 1777, 1784, 2045, 2082, 1139, 1467, 2053,
        2172, 2182, 2095, 2144,  401,  864, 1065, 2210,  970, 1632, 2444, 2642,
         255,  388,  446,  454,  554,  581,  842, 1029, 1343, 1507, 1538, 1616,
        1690, 1851, 2010, 2030, 2112, 2165, 2166,  239,  543,  619, 1293, 1628,
        2418, 2419,  306,  487, 2080,  541,  971, 1113, 1650, 1521,  697,  738,
        1416, 2162, 2343,  723, 2614,  544,  586, 1042, 1118, 1517, 2052, 2155,
        2018, 2178, 1441, 2604,  379,  479,  904, 1022, 1959,  484,  608, 1775,
        1790,  284, 2223, 2224, 2226,  236, 1776, 1001, 1318, 2661, 2662, 1687,
         330, 1046, 2001, 2122, 2123, 2380,  441, 2184, 2631,  152,  963, 1530,
        1653, 2399, 2400,  426,  176, 1769, 1787, 1998,  610,  563,  459, 1661,
        1785, 1772, 2093,  318, 1337,  519, 1624,  289, 2094,  153, 2092, 1779,
         834, 2169,  483,  514,  816, 1842, 2405,  758, 1169, 1762, 2492, 2643,
         206, 1986, 2691, 1043, 2310,  281, 1589, 1372,  158, 2075, 2077, 2668,
        1301, 1344, 2011, 2317,  660,  910, 1780, 1715,  606, 1810, 2360, 2578,
        1655, 1839,  895, 1296, 1913, 1551, 2079,  286,  588,  698,  911, 1051,
        2040, 2119, 2120, 2121,  583, 2222, 2225, 1527,  661, 1353, 1090, 1093,
        1271, 2367, 2454, 2455,  269, 1996, 2164, 1138, 1634,  580,  609,  615,
        1067, 1287, 1627, 1725, 2651, 1146, 1505, 1552, 1640, 1781, 2106, 2107,
        1560, 1786, 2145, 2487, 2488, 2329, 2504,  201,  598, 1636, 1701, 2139,
        2141, 1721, 2476, 2288, 2506, 2544,  898, 1836, 1602, 2056, 1190, 2427,
        1647, 2157, 2209,  175,  596,  644, 1914, 1739,  406, 1209, 1737, 2616,
         163, 1579,  458, 2363,  603, 2097,  373, 1349, 1522, 1532, 1965, 2357,
        1016, 1256, 1761, 2175, 2176,  973,  233,  370,  392, 2270,  714, 1031,
        1662, 1666, 2041, 2205, 2206, 2471,  334,  456,  693,  734,  736,  861,
        1303, 1535, 1580, 1838, 2054, 2074, 2181, 2183, 2197, 2199, 2200, 2201,
         282,  540, 2628,  259, 2537,  701,  257, 1117, 2049, 1234, 1702, 1703,
        2238, 1604, 2366, 1080, 1309, 2312,  347,  423,  527, 2180,  604, 1013,
        1351, 1920, 1926, 2189,  195,  675,  733,  934, 1649, 1966, 2263, 2355,
        2490,  633, 1862, 2582, 1076, 1501,  831,  391,  747, 1884,  507,  866,
        1364,  927, 1315, 1316, 2140,  332, 1454,  589,  802,  980, 1158, 1910,
        2251, 2252, 2645,  208, 1251, 1448, 1561, 1871, 1878, 2256, 1520, 2581,
         485, 2014, 1908, 2394,  696,  300, 1732, 1394,  851, 2016,  415, 2015,
         162, 2013,  737, 1288, 1882,  841, 1677,  743, 2017, 1939,  457,  710,
        1392, 2213, 2214, 2215, 1629, 1659, 2546,  412,  447, 1849, 1072, 2269,
        2374, 2375, 1982,  279,  518, 1850, 1973,  652,  654,  155,  156,  817,
         258,  884, 1087, 1094, 1157, 1401, 1585, 2463,  659, 1803, 1322, 1219,
        1329, 1418, 1367, 1622, 2478,  646, 1537, 1549, 1901, 2303, 2667, 2217,
         767, 1594,  550,  950, 1495, 2151,  476, 2545])
get_in_degree_bucketing dst global nid  tensor([106,  38,  72,  55,  86,  23, 110,  44,  73, 133,  52, 135, 104,  16,
        118,  65, 112, 107,  98,  30,   9,  74,  76,  50, 127, 132, 103,  84,
        138,  12,  28,  91,  70,  66,  43, 109, 131, 120, 111,  71,  21, 101,
         42,  14,  25, 139,  58,  27,  11,  35, 126,  33,  75,  60,  97,  15,
         99,   8,  87,  82,  59,  36,  34,  18,  85, 137,  26,  24,  13, 105,
        114, 122,   3,  57,  92, 100,  37, 108,  41,  53, 134,  64,  47, 125,
         79,   6,  39,   4, 115, 128,  48,  95,  67, 117, 129, 123,  80,  22,
         46,  61,  81,  69,  94,   0, 116, 136,  68, 113,  40,  17,   2, 121,
         29,   7, 102,  83,  62,  88,  19,  51,   5,  56,  20, 130,  32,   1,
         90,  89,  77,  63,  78, 124, 119,  45,  96,  54,  31,  49,  93,  10])
get_in_degree_bucketing corresponding in degs tensor([ 1,  4,  2, 12,  4,  1,  5,  3, 12,  9,  5,  3,  4,  4, 19, 10,  4,  4,
         1,  6,  2,  9,  3,  1,  1,  5,  6,  5,  3,  4,  1,  6,  2,  1,  6, 25,
         2,  5,  6,  3,  2,  3,  2,  5,  4,  8,  1,  4,  2,  3,  6,  9,  6,  3,
         2,  4,  6,  3,  3,  2, 10,  8,  1,  5,  3,  4,  5,  7,  2,  4,  3,  4,
         1,  1,  2,  2,  3,  3,  4,  3,  1,  3,  2,  2,  2,  4,  7,  5,  1,  4,
         9, 21,  3,  2,  2,  4,  3,  5,  2,  5,  4,  7, 11,  3,  2,  1,  3,  3,
         3,  5,  5,  7,  2,  1,  8,  2,  1, 25,  1,  6,  3,  4,  5,  3,  4,  3,
         4, 10,  2,  1,  3,  5,  6,  6,  1,  2,  1,  2,  4,  2])
len(bkt)  20
local bkt nids  tensor([  0,   5,  18,  23,  24,  30,  33,  46,  62,  72,  73,  80,  88, 105,
        113, 116, 118, 129, 134, 136])
len(bkt)  25
local bkt nids  tensor([  2,  20,  32,  36,  40,  42,  48,  54,  59,  68,  74,  75,  82,  83,
         84,  93,  94,  98, 104, 112, 115, 128, 135, 137, 139])
len(bkt)  26
local bkt nids  tensor([  7,  11,  22,  28,  39,  41,  49,  53,  57,  58,  64,  70,  76,  77,
         79,  81,  92,  96, 103, 106, 107, 108, 120, 123, 125, 130])
len(bkt)  22
local bkt nids  tensor([  1,   4,  12,  13,  16,  17,  29,  44,  47,  55,  65,  69,  71,  78,
         85,  89,  95, 100, 121, 124, 126, 138])
len(bkt)  15
local bkt nids  tensor([  6,  10,  25,  27,  37,  43,  63,  66,  87,  97,  99, 109, 110, 122,
        131])
len(bkt)  11
local bkt nids  tensor([ 19,  26,  31,  34,  38,  50,  52,  56, 119, 132, 133])
len(bkt)  4
local bkt nids  tensor([ 67,  86, 101, 111])
len(bkt)  3
local bkt nids  tensor([ 45,  61, 114])
len(bkt)  4
local bkt nids  tensor([ 9, 21, 51, 90])
len(bkt)  3
local bkt nids  tensor([ 15,  60, 127])
len(bkt)  1
local bkt nids  tensor([102])
len(bkt)  2
local bkt nids  tensor([3, 8])
len(bkt)  1
local bkt nids  tensor([14])
len(bkt)  1
local bkt nids  tensor([91])
len(bkt)  2
local bkt nids  tensor([ 35, 117])
bucket partitioner: bkt_dst_nodes_list_local  [tensor([  0,   5,  18,  23,  24,  30,  33,  46,  62,  72,  73,  80,  88, 105,
        113, 116, 118, 129, 134, 136]), tensor([  2,  20,  32,  36,  40,  42,  48,  54,  59,  68,  74,  75,  82,  83,
         84,  93,  94,  98, 104, 112, 115, 128, 135, 137, 139]), tensor([  7,  11,  22,  28,  39,  41,  49,  53,  57,  58,  64,  70,  76,  77,
         79,  81,  92,  96, 103, 106, 107, 108, 120, 123, 125, 130]), tensor([  1,   4,  12,  13,  16,  17,  29,  44,  47,  55,  65,  69,  71,  78,
         85,  89,  95, 100, 121, 124, 126, 138]), tensor([  6,  10,  25,  27,  37,  43,  63,  66,  87,  97,  99, 109, 110, 122,
        131]), tensor([ 19,  26,  31,  34,  38,  50,  52,  56, 119, 132, 133]), tensor([ 67,  86, 101, 111]), tensor([ 45,  61, 114]), tensor([ 9, 21, 51, 90]), tensor([ 15,  60, 127]), tensor([102]), tensor([3, 8]), tensor([14]), tensor([91]), tensor([ 35, 117])]
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
memory_constraint:  0.19
sum(estimated_mem)
0.36848267912864685
15
the grouping_fanout_cora called successfully
capacity  190
 
sorted_dict  {3: 54, 4: 49, 2: 39, 5: 39, 1: 29, 14: 28, 8: 22, 9: 18, 6: 17, 7: 14, 11: 14, 13: 14, 12: 10, 0: 9, 10: 5}

weights after sort [54, 49, 39, 39, 29, 28, 22, 18, 17, 14, 14, 14, 10, 9, 5]
res_tmp  [54 39 29 28 22 18]

remove bucket_id:  [0, 2, 4, 5, 6, 7]
original bucket_id :,  [3, 2, 1, 14, 8, 9]
remove weights:  [54 39 29 28 22 18], 		------------sum 190

before remove weights,  [54, 49, 39, 39, 29, 28, 22, 18, 17, 14, 14, 14, 10, 9, 5]
after remove pre pack weights,  [49, 39, 17, 14, 14, 14, 10, 9, 5]
G_BUCKET_ID_list [[3, 2, 1, 14, 8, 9], [4, 2, 6, 7, 11, 13, 12, 0, 10]]
Groups_mem_list  [[54, 39, 29, 28, 22, 18], [49, 39, 17, 14, 14, 14, 10, 9, 5]]
G_BUCKET_ID_list length 2
backpack scheduling spend  0.004057645797729492
current group_mem  0.192594476044178
current group_mem  0.17561374604701996
batches output list generation spend  5.125999450683594e-05
self.weights_list  [0.5857142857142857, 0.5214285714285715]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012558937072753906
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004153728485107422
local_to_global: src global  tensor([ 106,   38,   72,   55,   86,   23,  110,   44,   73,  133,   52,  135,
         104,   16,  118,   65,  112,  107,   98,   30,    9,   74,   76,   50,
         127,  132,  103,   84,  138,   12,   28,   91,   70,   66,   43,  109,
         131,  120,  111,   71,   21,  101,   42,   14,   25,  139,   58,   27,
          11,   35,  126,   33,   75,   60,   97,   15,   99,    8,   87,   82,
          59,   36,   34,   18,   85,  137,   26,   24,   13,  105,  114,  122,
           3,   57,   92,  100,   37,  108,   41,   53,  134,   64,   47,  125,
          79,    6,   39,    4,  115,  128,   48,   95,   67,  117,  129,  123,
          80,   22,   46,   61,   81,   69,   94,    0,  116,  136,   68,  113,
          40,   17,    2,  121,   29,    7,  102,   83,   62,   88,   19,   51,
           5,   56,   20,  130,   32,    1,   90,   89,   77,   63,   78,  124,
         119,   45,   96,   54,   31,   49,   93,   10, 2461,  429,  862,  863,
        1160, 1103, 1358,  210,  323,  651,  771,  787,  815, 1079, 1156, 1983,
        2020, 2021, 1336, 2034, 2295, 2159,  567, 1161, 1262, 1599, 2279, 1582,
        2624, 2701,  449,  558,  797,  876, 1035, 1136, 1189, 1214, 1723, 1745,
        1751,  399,  452, 1623, 1670, 1777, 1784, 2045, 2082, 1139, 1467, 2053,
        2172, 2182, 2095, 2144,  401,  864, 1065, 2210,  970, 1632, 2444, 2642,
         255,  388,  446,  454,  554,  581,  842, 1029, 1343, 1507, 1538, 1616,
        1690, 1851, 2010, 2030, 2112, 2165, 2166,  239,  543,  619, 1293, 1628,
        2418, 2419,  306,  487, 2080,  541,  971, 1113, 1650, 1521,  697,  738,
        1416, 2162, 2343,  723, 2614,  544,  586, 1042, 1118, 1517, 2052, 2155,
        2018, 2178, 1441, 2604,  379,  479,  904, 1022, 1959,  484,  608, 1775,
        1790,  284, 2223, 2224, 2226,  236, 1776, 1001, 1318, 2661, 2662, 1687,
         330, 1046, 2001, 2122, 2123, 2380,  441, 2184, 2631,  152,  963, 1530,
        1653, 2399, 2400,  426,  176, 1769, 1787, 1998,  610,  563,  459, 1661,
        1785, 1772, 2093,  318, 1337,  519, 1624,  289, 2094,  153, 2092, 1779,
         834, 2169,  483,  514,  816, 1842, 2405,  758, 1169, 1762, 2492, 2643,
         206, 1986, 2691, 1043, 2310,  281, 1589, 1372,  158, 2075, 2077, 2668,
        1301, 1344, 2011, 2317,  660,  910, 1780, 1715,  606, 1810, 2360, 2578,
        1655, 1839,  895, 1296, 1913, 1551, 2079,  286,  588,  698,  911, 1051,
        2040, 2119, 2120, 2121,  583, 2222, 2225, 1527,  661, 1353, 1090, 1093,
        1271, 2367, 2454, 2455,  269, 1996, 2164, 1138, 1634,  580,  609,  615,
        1067, 1287, 1627, 1725, 2651, 1146, 1505, 1552, 1640, 1781, 2106, 2107,
        1560, 1786, 2145, 2487, 2488, 2329, 2504,  201,  598, 1636, 1701, 2139,
        2141, 1721, 2476, 2288, 2506, 2544,  898, 1836, 1602, 2056, 1190, 2427,
        1647, 2157, 2209,  175,  596,  644, 1914, 1739,  406, 1209, 1737, 2616,
         163, 1579,  458, 2363,  603, 2097,  373, 1349, 1522, 1532, 1965, 2357,
        1016, 1256, 1761, 2175, 2176,  973,  233,  370,  392, 2270,  714, 1031,
        1662, 1666, 2041, 2205, 2206, 2471,  334,  456,  693,  734,  736,  861,
        1303, 1535, 1580, 1838, 2054, 2074, 2181, 2183, 2197, 2199, 2200, 2201,
         282,  540, 2628,  259, 2537,  701,  257, 1117, 2049, 1234, 1702, 1703,
        2238, 1604, 2366, 1080, 1309, 2312,  347,  423,  527, 2180,  604, 1013,
        1351, 1920, 1926, 2189,  195,  675,  733,  934, 1649, 1966, 2263, 2355,
        2490,  633, 1862, 2582, 1076, 1501,  831,  391,  747, 1884,  507,  866,
        1364,  927, 1315, 1316, 2140,  332, 1454,  589,  802,  980, 1158, 1910,
        2251, 2252, 2645,  208, 1251, 1448, 1561, 1871, 1878, 2256, 1520, 2581,
         485, 2014, 1908, 2394,  696,  300, 1732, 1394,  851, 2016,  415, 2015,
         162, 2013,  737, 1288, 1882,  841, 1677,  743, 2017, 1939,  457,  710,
        1392, 2213, 2214, 2215, 1629, 1659, 2546,  412,  447, 1849, 1072, 2269,
        2374, 2375, 1982,  279,  518, 1850, 1973,  652,  654,  155,  156,  817,
         258,  884, 1087, 1094, 1157, 1401, 1585, 2463,  659, 1803, 1322, 1219,
        1329, 1418, 1367, 1622, 2478,  646, 1537, 1549, 1901, 2303, 2667, 2217,
         767, 1594,  550,  950, 1495, 2151,  476, 2545])
partition total batch output list spend :  0.02146744728088379
self.buckets_partition() spend  sec:  0.016727924346923828
bucketing dataloader: layer  0
bucketing dataloader: the number of batches:  2
bucketing dataloader: global_batched_output_nid_list  [tensor([ 38,  72,  86,  44, 133, 135, 104,  16,  65, 112, 107,   9,  74,  76,
        138,  12,  70, 109, 131,  71,  21, 101,  42,  25,  27,  11,  35,  33,
         60,  97,  15,   8,  87,  82,  59,  85, 137,  13, 105, 114, 122,  92,
        100,  37, 108,  41,  53,  64,  47, 125,  79,   6, 128,  48,  67, 117,
        129, 123,  80,  46,  81,   0, 116,  68, 113,  40,  29,  83,  88,   5,
         56, 130,  32,   1,  90,  89,  77,  78,  54,  49,  93,  10]), tensor([106,  55,  23, 110,  44,  73,  52, 135, 118,  98,  76,  50, 127, 132,
         84, 138,  28,  66, 120,  71, 101,  14, 139,  58,  35,  60,   8,  87,
         36,  34,  18,  85,  26,  24, 114,   3,  57,  37, 108,  53, 134,  64,
         39,   4, 115,  95,  67,  80,  22,  61,  69,  94,   0, 136,  68, 113,
         40,  17,   2, 121,   7, 102,  62,  19,   5,  20, 130,   1,  63,  78,
        124,  96,  31])]
check_connections_block*********************************
connection check : local_output_nid  82
connection check : local_output_nid  73

block_gen_time in "generate_blocks_for_one_layer_block"  0.003932476043701172

----------------------------------------
bucketing dataloader: layer  1
bucketing dataloader: num of batch  2
check_connections_block*********************************
connection check : local_output_nid  367
connection check : local_output_nid  345

block_gen_time in "generate_blocks_for_one_layer_block"  0.005945444107055664

block collection to dataloader spend  4.5299530029296875e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.275299072265625  GigaBytes
Max Memory Allocated: 0.5387849807739258  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.42664623260498047  GigaBytes
Max Memory Allocated: 0.5387849807739258  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.4266386032104492  GigaBytes
Max Memory Allocated: 0.5387849807739258  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.27527809143066406  GigaBytes
Max Memory Allocated: 0.5393943786621094  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.42070865631103516  GigaBytes
Max Memory Allocated: 0.5393943786621094  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.42071104049682617  GigaBytes
Max Memory Allocated: 0.5393943786621094  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.275299072265625  GigaBytes
Max Memory Allocated: 0.5393943786621094  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.050168514251709
pure train time :  0.1637587547302246
train time :  0.18832039833068848
end to end time :  0.2281172275543213
connection check time:  0.006742715835571289
block generation time  0.009877920150756836
generate_dataloader_bucket_block=======
get_in_degree_bucketing src global nid  tensor([ 128,   15,  123,   91,  135,   81,  110,   66,   41,  139,   33,   26,
          44,   77,   22,    0,   65,   59,    7,    9,   57,   99,  100,  103,
          51,   39,   95,   13,   30,   74,   75,   84,   19,   36,   64,  102,
          16,  109,  137,   48,  105,   78,   27,   85,  115,   37,   34,  138,
         129,   70,   61,   18,  118,  106,   21,  114,   86,   60,  119,  113,
          31,   80,   92,   56,  136,    3,  108,   94,  131,   17,    2,  133,
          88,   32,   28,    1,  116,  104,   23,  124,   96,   49,    6,   40,
          90,   98,  120,   20,   89,   14,   87,   72,   55,   69,   82,   43,
         127,   29,    5,   35,  126,    4,   97,   67,  134,    8,   73,  117,
          79,   68,   47,   42,   10,   83,   38,   58,  130,  125,  112,   71,
         132,  101,   25,   54,   52,   62,   53,   45,  111,   11,   46,   12,
         107,   24,   76,  121,   63,  122,   50,   93,  233,  370,  392, 2270,
        1090, 1093, 1271, 2367, 2455, 2604,  330, 1046, 2001, 2122, 2123, 2380,
        2095, 2144,  347,  423,  527, 2180,  567, 1161, 1262, 1599, 2279, 2631,
         175,  596,  644, 1914,  306,  660,  910, 1623, 1780, 2045,  286,  588,
         698,  911, 1051, 2040, 2119, 2120, 2121, 2454, 1582, 2624, 2701,  659,
        1803, 1234, 1702, 1703, 2238,  633, 1862, 2582,  239,  543,  619,  771,
        1156, 1293, 1628, 2021, 2418, 2419,  580,  609,  615, 1067, 1287, 1358,
        1627, 1725, 2651,  208,  723, 2614, 1602, 2056,  484,  608, 1775, 1790,
         457,  710, 1392, 2213, 2214, 2215, 1349, 1522, 1532, 1634, 1965, 2357,
         334,  456,  693,  734,  736,  861, 1303, 1535, 1580, 1838, 2054, 2074,
        2181, 2182, 2183, 2197, 2199, 2200, 2201, 1701, 1810,  697,  738, 1416,
        2162, 2343,  544,  586, 1042, 1118, 1517, 2052, 2155,  583, 2222, 2223,
        2224, 2225,  284, 2226, 1939, 1146, 1505, 1552, 1640, 1781, 2094, 2106,
        2107, 1209, 1737, 2616, 1251, 1448, 1561, 1871, 1878, 2256,  970, 1632,
        2444, 2642, 1337, 2092, 1805, 1772, 1624,  318, 2093, 1787, 1045,  289,
         563, 1346, 1789,  426, 1779, 1661,  153, 1785, 1998, 1769, 2329, 2504,
         598,  714, 1031, 1662, 1666, 2041, 2205, 2206, 2471, 1721, 2476, 1219,
        1329, 1418,  606, 2360, 2578, 1065, 2487, 2488,  973, 1190, 2427,  236,
        1776,  441,  701, 2184, 1080, 1309, 2312, 1560, 1786, 2082, 2145,  255,
         388,  446,  454,  554,  581,  842, 1029, 1343, 1507, 1538, 1616, 1690,
        1851, 2010, 2030, 2112, 2165, 2166, 2461, 1043, 2310,  610, 2288, 2506,
         429, 1336, 2034, 2295, 1527,  379,  646, 1537, 1549, 1901, 1959,  540,
         747, 1884, 1594,  257, 1117, 2049,  898, 1836,  412,  447, 1849,  831,
        2544, 1647, 2157, 2209,  195,  675,  733,  934, 1649, 1966, 2263, 2355,
        2490,  834, 2169,  927, 1315, 1316, 2140,  332, 1454, 1986,  399,  452,
        1670, 1777, 1784, 2015, 1174,  841, 1713, 2013, 1677, 1494,  498, 1732,
        2014,  162, 1658, 2011, 2012,  300, 1908,  696, 2394, 1288, 1741,  415,
        2178,  279,  518, 1850, 1973, 1687,  652,  654, 1076, 1501,  401,  864,
        2210, 2159, 1367, 1622, 2478, 2217,  373,  507,  866, 1364,  155,  156,
         817, 1521,  483,  514,  816, 1842, 2405, 1072, 2269, 2374, 2375,  258,
         884, 1087, 1094, 1157, 1401, 1530, 1585, 1653, 2463,  158, 2075, 2077,
        2668, 2164, 1103,  210,  323,  651,  787,  815, 1079, 1983, 2020,  604,
        1013, 1351, 1920, 1926, 2189, 1138,  152,  963, 2399, 2400, 2645, 1629,
        1659, 2546,  895, 1296, 1913, 1551, 2079, 1016, 1256, 1761, 2175, 2176,
         661, 1353,  282, 2628,  406,  269,  281, 1996,  449,  558,  797,  876,
        1035, 1136, 1189, 1214, 1723, 1745, 1751,  259, 2537,  603, 2097,  391,
         163, 1579, 1372,  476, 2545, 1520, 2581,  862,  863, 1160, 1715, 1982,
        2017,  458, 2363,  487, 2080,  206, 2691,  479,  904, 1022, 1589, 1301,
        1344, 2317,  767, 1139, 1467, 2053, 2172,  485, 1739, 2303, 2667,  758,
        1169, 1762, 2492, 2643, 1655, 1839, 1604, 2366, 1001, 1318, 2661, 2662,
         541,  971, 1113, 1650,  201, 1636, 2139, 2141, 2018,  589,  802,  980,
        1158, 1910, 2251, 2252, 1322, 1441,  550,  950, 1495, 2151])
get_in_degree_bucketing dst global nid  tensor([128,  15, 123,  91, 135,  81, 110,  66,  41, 139,  33,  26,  44,  77,
         22,   0,  65,  59,   7,   9,  57,  99, 100, 103,  51,  39,  95,  13,
         30,  74,  75,  84,  19,  36,  64, 102,  16, 109, 137,  48, 105,  78,
         27,  85, 115,  37,  34, 138, 129,  70,  61,  18, 118, 106,  21, 114,
         86,  60, 119, 113,  31,  80,  92,  56, 136,   3, 108,  94, 131,  17,
          2, 133,  88,  32,  28,   1, 116, 104,  23, 124,  96,  49,   6,  40,
         90,  98, 120,  20,  89,  14,  87,  72,  55,  69,  82,  43, 127,  29,
          5,  35, 126,   4,  97,  67, 134,   8,  73, 117,  79,  68,  47,  42,
         10,  83,  38,  58, 130, 125, 112,  71, 132, 101,  25,  54,  52,  62,
         53,  45, 111,  11,  46,  12, 107,  24,  76, 121,  63, 122,  50,  93])
get_in_degree_bucketing corresponding in degs tensor([ 4,  4,  4,  6,  3,  4,  5,  1,  4,  8,  9,  5,  3,  2,  5,  3, 10, 10,
         1,  2,  1,  6,  2,  6,  6,  7, 21,  2,  6,  9,  6,  5,  1,  8,  3,  8,
         4, 25,  4,  9,  4,  3,  4,  3,  1,  3,  1,  3,  2,  2,  5,  5, 19,  1,
         2,  3,  4,  3,  6,  3,  1,  3,  2,  4,  1,  1,  3, 11,  2,  5,  5,  9,
        25,  4,  1,  3,  2,  4,  1,  5,  1,  2,  4,  3,  4,  1,  5,  5, 10,  5,
         3,  2, 12,  7,  2,  6,  1,  2,  3,  3,  6,  5,  2,  3,  1,  3, 12,  2,
         2,  3,  2,  2,  2,  2,  4,  1,  3,  2,  4,  3,  5,  3,  4,  2,  5,  1,
         3,  6,  6,  2,  2,  4,  4,  7,  3,  7,  1,  4,  1,  4])
len(bkt)  20
local bkt nids  tensor([  7,  18,  20,  32,  44,  46,  53,  60,  64,  65,  74,  78,  80,  85,
         96, 104, 115, 125, 136, 138])
len(bkt)  25
local bkt nids  tensor([ 13,  19,  22,  27,  48,  49,  54,  62,  68,  76,  81,  91,  94,  97,
        102, 107, 108, 110, 111, 112, 113, 117, 123, 129, 130])
len(bkt)  26
local bkt nids  tensor([  4,  12,  15,  34,  41,  43,  45,  47,  55,  57,  59,  61,  66,  75,
         83,  90,  98,  99, 103, 105, 109, 116, 119, 121, 126, 134])
len(bkt)  22
local bkt nids  tensor([  0,   1,   2,   5,   8,  36,  38,  40,  42,  56,  63,  73,  77,  82,
         84, 114, 118, 122, 131, 132, 137, 139])
len(bkt)  15
local bkt nids  tensor([  6,  11,  14,  31,  50,  51,  69,  70,  79,  86,  87,  89, 101, 120,
        124])
len(bkt)  11
local bkt nids  tensor([  3,  21,  23,  24,  28,  30,  58,  95, 100, 127, 128])
len(bkt)  4
local bkt nids  tensor([ 25,  93, 133, 135])
len(bkt)  3
local bkt nids  tensor([ 9, 33, 35])
len(bkt)  4
local bkt nids  tensor([10, 29, 39, 71])
len(bkt)  3
local bkt nids  tensor([16, 17, 88])
len(bkt)  1
local bkt nids  tensor([67])
len(bkt)  2
local bkt nids  tensor([ 92, 106])
len(bkt)  1
local bkt nids  tensor([52])
len(bkt)  1
local bkt nids  tensor([26])
len(bkt)  2
local bkt nids  tensor([37, 72])
bucket partitioner: bkt_dst_nodes_list_local  [tensor([  7,  18,  20,  32,  44,  46,  53,  60,  64,  65,  74,  78,  80,  85,
         96, 104, 115, 125, 136, 138]), tensor([ 13,  19,  22,  27,  48,  49,  54,  62,  68,  76,  81,  91,  94,  97,
        102, 107, 108, 110, 111, 112, 113, 117, 123, 129, 130]), tensor([  4,  12,  15,  34,  41,  43,  45,  47,  55,  57,  59,  61,  66,  75,
         83,  90,  98,  99, 103, 105, 109, 116, 119, 121, 126, 134]), tensor([  0,   1,   2,   5,   8,  36,  38,  40,  42,  56,  63,  73,  77,  82,
         84, 114, 118, 122, 131, 132, 137, 139]), tensor([  6,  11,  14,  31,  50,  51,  69,  70,  79,  86,  87,  89, 101, 120,
        124]), tensor([  3,  21,  23,  24,  28,  30,  58,  95, 100, 127, 128]), tensor([ 25,  93, 133, 135]), tensor([ 9, 33, 35]), tensor([10, 29, 39, 71]), tensor([16, 17, 88]), tensor([67]), tensor([ 92, 106]), tensor([52]), tensor([26]), tensor([37, 72])]
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
memory_constraint:  0.19
sum(estimated_mem)
0.36848267912864685
15
the grouping_fanout_cora called successfully
capacity  190
 
sorted_dict  {3: 54, 4: 49, 2: 39, 5: 39, 1: 29, 14: 28, 8: 22, 9: 18, 6: 17, 7: 14, 11: 14, 13: 14, 12: 10, 0: 9, 10: 5}

weights after sort [54, 49, 39, 39, 29, 28, 22, 18, 17, 14, 14, 14, 10, 9, 5]
res_tmp  [54 39 29 28 22 18]

remove bucket_id:  [0, 2, 4, 5, 6, 7]
original bucket_id :,  [3, 2, 1, 14, 8, 9]
remove weights:  [54 39 29 28 22 18], 		------------sum 190

before remove weights,  [54, 49, 39, 39, 29, 28, 22, 18, 17, 14, 14, 14, 10, 9, 5]
after remove pre pack weights,  [49, 39, 17, 14, 14, 14, 10, 9, 5]
G_BUCKET_ID_list [[3, 2, 1, 14, 8, 9], [4, 2, 6, 7, 11, 13, 12, 0, 10]]
Groups_mem_list  [[54, 39, 29, 28, 22, 18], [49, 39, 17, 14, 14, 14, 10, 9, 5]]
G_BUCKET_ID_list length 2
backpack scheduling spend  0.004061698913574219
current group_mem  0.192594476044178
current group_mem  0.17561374604701996
batches output list generation spend  5.1021575927734375e-05
self.weights_list  [0.5857142857142857, 0.5214285714285715]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012796401977539062
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.00415802001953125
local_to_global: src global  tensor([ 128,   15,  123,   91,  135,   81,  110,   66,   41,  139,   33,   26,
          44,   77,   22,    0,   65,   59,    7,    9,   57,   99,  100,  103,
          51,   39,   95,   13,   30,   74,   75,   84,   19,   36,   64,  102,
          16,  109,  137,   48,  105,   78,   27,   85,  115,   37,   34,  138,
         129,   70,   61,   18,  118,  106,   21,  114,   86,   60,  119,  113,
          31,   80,   92,   56,  136,    3,  108,   94,  131,   17,    2,  133,
          88,   32,   28,    1,  116,  104,   23,  124,   96,   49,    6,   40,
          90,   98,  120,   20,   89,   14,   87,   72,   55,   69,   82,   43,
         127,   29,    5,   35,  126,    4,   97,   67,  134,    8,   73,  117,
          79,   68,   47,   42,   10,   83,   38,   58,  130,  125,  112,   71,
         132,  101,   25,   54,   52,   62,   53,   45,  111,   11,   46,   12,
         107,   24,   76,  121,   63,  122,   50,   93,  233,  370,  392, 2270,
        1090, 1093, 1271, 2367, 2455, 2604,  330, 1046, 2001, 2122, 2123, 2380,
        2095, 2144,  347,  423,  527, 2180,  567, 1161, 1262, 1599, 2279, 2631,
         175,  596,  644, 1914,  306,  660,  910, 1623, 1780, 2045,  286,  588,
         698,  911, 1051, 2040, 2119, 2120, 2121, 2454, 1582, 2624, 2701,  659,
        1803, 1234, 1702, 1703, 2238,  633, 1862, 2582,  239,  543,  619,  771,
        1156, 1293, 1628, 2021, 2418, 2419,  580,  609,  615, 1067, 1287, 1358,
        1627, 1725, 2651,  208,  723, 2614, 1602, 2056,  484,  608, 1775, 1790,
         457,  710, 1392, 2213, 2214, 2215, 1349, 1522, 1532, 1634, 1965, 2357,
         334,  456,  693,  734,  736,  861, 1303, 1535, 1580, 1838, 2054, 2074,
        2181, 2182, 2183, 2197, 2199, 2200, 2201, 1701, 1810,  697,  738, 1416,
        2162, 2343,  544,  586, 1042, 1118, 1517, 2052, 2155,  583, 2222, 2223,
        2224, 2225,  284, 2226, 1939, 1146, 1505, 1552, 1640, 1781, 2094, 2106,
        2107, 1209, 1737, 2616, 1251, 1448, 1561, 1871, 1878, 2256,  970, 1632,
        2444, 2642, 1337, 2092, 1805, 1772, 1624,  318, 2093, 1787, 1045,  289,
         563, 1346, 1789,  426, 1779, 1661,  153, 1785, 1998, 1769, 2329, 2504,
         598,  714, 1031, 1662, 1666, 2041, 2205, 2206, 2471, 1721, 2476, 1219,
        1329, 1418,  606, 2360, 2578, 1065, 2487, 2488,  973, 1190, 2427,  236,
        1776,  441,  701, 2184, 1080, 1309, 2312, 1560, 1786, 2082, 2145,  255,
         388,  446,  454,  554,  581,  842, 1029, 1343, 1507, 1538, 1616, 1690,
        1851, 2010, 2030, 2112, 2165, 2166, 2461, 1043, 2310,  610, 2288, 2506,
         429, 1336, 2034, 2295, 1527,  379,  646, 1537, 1549, 1901, 1959,  540,
         747, 1884, 1594,  257, 1117, 2049,  898, 1836,  412,  447, 1849,  831,
        2544, 1647, 2157, 2209,  195,  675,  733,  934, 1649, 1966, 2263, 2355,
        2490,  834, 2169,  927, 1315, 1316, 2140,  332, 1454, 1986,  399,  452,
        1670, 1777, 1784, 2015, 1174,  841, 1713, 2013, 1677, 1494,  498, 1732,
        2014,  162, 1658, 2011, 2012,  300, 1908,  696, 2394, 1288, 1741,  415,
        2178,  279,  518, 1850, 1973, 1687,  652,  654, 1076, 1501,  401,  864,
        2210, 2159, 1367, 1622, 2478, 2217,  373,  507,  866, 1364,  155,  156,
         817, 1521,  483,  514,  816, 1842, 2405, 1072, 2269, 2374, 2375,  258,
         884, 1087, 1094, 1157, 1401, 1530, 1585, 1653, 2463,  158, 2075, 2077,
        2668, 2164, 1103,  210,  323,  651,  787,  815, 1079, 1983, 2020,  604,
        1013, 1351, 1920, 1926, 2189, 1138,  152,  963, 2399, 2400, 2645, 1629,
        1659, 2546,  895, 1296, 1913, 1551, 2079, 1016, 1256, 1761, 2175, 2176,
         661, 1353,  282, 2628,  406,  269,  281, 1996,  449,  558,  797,  876,
        1035, 1136, 1189, 1214, 1723, 1745, 1751,  259, 2537,  603, 2097,  391,
         163, 1579, 1372,  476, 2545, 1520, 2581,  862,  863, 1160, 1715, 1982,
        2017,  458, 2363,  487, 2080,  206, 2691,  479,  904, 1022, 1589, 1301,
        1344, 2317,  767, 1139, 1467, 2053, 2172,  485, 1739, 2303, 2667,  758,
        1169, 1762, 2492, 2643, 1655, 1839, 1604, 2366, 1001, 1318, 2661, 2662,
         541,  971, 1113, 1650,  201, 1636, 2139, 2141, 2018,  589,  802,  980,
        1158, 1910, 2251, 2252, 1322, 1441,  550,  950, 1495, 2151])
partition total batch output list spend :  0.021634817123413086
self.buckets_partition() spend  sec:  0.016968965530395508
bucketing dataloader: layer  0
bucketing dataloader: the number of batches:  2
bucketing dataloader: global_batched_output_nid_list  [tensor([128,  15, 123, 135,  81,  41,  33,  44,  77,   0,  65,  59,   9, 100,
         13,  74,  64,  16, 109, 137,  48, 105,  78,  27,  85,  37, 138, 129,
         70,  21, 114,  86,  60, 113,  80,  92,  56, 108, 131, 133,  88,  32,
          1, 116, 104,  49,   6,  40,  90,  89,  87,  72,  82,  29,   5,  35,
         97,  67,   8, 117,  79,  68,  47,  42,  10,  83,  38, 130, 125, 112,
         71, 101,  25,  54,  53,  11,  46,  12, 107,  76, 122,  93]), tensor([135, 110,  66, 139,  26,  44,  22,   0,   7,  57,  39,  95,  84,  19,
         36,  64, 102,  78,  85, 115,  37,  34, 138,  61,  18, 118, 106, 114,
         60, 113,  31,  80, 136,   3, 108,  94,  17,   2,  28,   1,  23, 124,
         96,  40,  98, 120,  20,  14,  87,  55,  69, 127,   5,  35,   4,  67,
        134,   8,  73,  68,  58, 130,  71, 132, 101,  52,  62,  53,  24,  76,
        121,  63,  50])]
check_connections_block*********************************
connection check : local_output_nid  82
connection check : local_output_nid  73

block_gen_time in "generate_blocks_for_one_layer_block"  0.0039026737213134766

----------------------------------------
bucketing dataloader: layer  1
bucketing dataloader: num of batch  2
check_connections_block*********************************
connection check : local_output_nid  371
connection check : local_output_nid  345

block_gen_time in "generate_blocks_for_one_layer_block"  0.005933046340942383

block collection to dataloader spend  4.5299530029296875e-06
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.27529382705688477  GigaBytes
Max Memory Allocated: 0.5393943786621094  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.4274125099182129  GigaBytes
Max Memory Allocated: 0.5393943786621094  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.09375 GB
    Memory Allocated: 0.42740488052368164  GigaBytes
Max Memory Allocated: 0.5393943786621094  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.095703125 GB
    Memory Allocated: 0.27527809143066406  GigaBytes
Max Memory Allocated: 0.5393943786621094  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 2.095703125 GB
    Memory Allocated: 0.42070865631103516  GigaBytes
Max Memory Allocated: 0.5393943786621094  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 2.095703125 GB
    Memory Allocated: 0.42071104049682617  GigaBytes
Max Memory Allocated: 0.5393943786621094  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 2.095703125 GB
    Memory Allocated: 0.275299072265625  GigaBytes
Max Memory Allocated: 0.5393943786621094  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.014854907989502
pure train time :  0.1699056625366211
train time :  0.19401979446411133
end to end time :  0.23401427268981934
connection check time:  0.006821632385253906
block generation time  0.00983572006225586
end to end time  0.2575650215148926
Total (block generation + training)time/epoch 0.2575650215148926
pure train time per /epoch  [0.5526947975158691, 0.16358661651611328, 0.15990900993347168, 0.1637587547302246, 0.1699056625366211]
pure train time average  0.16683220863342285
input num list  [1839, 1849, 1859, 1853, 1843]
