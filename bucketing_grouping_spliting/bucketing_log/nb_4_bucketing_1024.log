main start at this time 1689050215.0407524
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04677605628967285
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.8035550117492676
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.0008540153503417969
self.weights_list  [0.38857061171528795, 0.26453414851387164, 0.20335162358012338, 0.14354361619071707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014837265014648438
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.8046665191650391
len local_batched_seeds_list  4
partition total batch output list spend :  0.9252364635467529
self.buckets_partition() spend  sec:  0.8195512294769287
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.556640625 GB
    Memory Allocated: 0.1100163459777832  GigaBytes
Max Memory Allocated: 0.1100163459777832  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.361328125 GB
    Memory Allocated: 15.511442184448242  GigaBytes
Max Memory Allocated: 16.38003969192505  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.361328125 GB
    Memory Allocated: 15.517390251159668  GigaBytes
Max Memory Allocated: 16.38003969192505  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.59375 GB
    Memory Allocated: 0.15134096145629883  GigaBytes
Max Memory Allocated: 16.38003969192505  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.828125 GB
    Memory Allocated: 17.578222274780273  GigaBytes
Max Memory Allocated: 18.501481533050537  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.828125 GB
    Memory Allocated: 17.582037448883057  GigaBytes
Max Memory Allocated: 18.501481533050537  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.31640625 GB
    Memory Allocated: 0.1529855728149414  GigaBytes
Max Memory Allocated: 18.501481533050537  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.4609375 GB
    Memory Allocated: 20.414469718933105  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.4609375 GB
    Memory Allocated: 20.417226314544678  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.953125 GB
    Memory Allocated: 0.15369224548339844  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.955078125 GB
    Memory Allocated: 14.29048490524292  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.955078125 GB
    Memory Allocated: 14.292510986328125  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 0.22575759887695312  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.776103973388672
pure train time :  2.995988607406616
train time :  4.556804656982422
end to end time :  10.55659794807434
connection check time:  2.0990140438079834
block generation time  2.9525279998779297
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.0480351448059082
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.7216877937316895
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.0004737377166748047
self.weights_list  [0.38857061171528795, 0.26453414851387164, 0.20335162358012338, 0.14354361619071707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015335798263549805
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.7223482131958008
len local_batched_seeds_list  4
partition total batch output list spend :  0.8447356224060059
self.buckets_partition() spend  sec:  0.7377281188964844
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 0.21491575241088867  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 15.630810737609863  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 15.633048057556152  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 0.21767187118530273  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 17.71289587020874  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 17.716894149780273  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 0.21909618377685547  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.361328125 GB
    Memory Allocated: 20.46434783935547  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.361328125 GB
    Memory Allocated: 20.46721315383911  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.375 GB
    Memory Allocated: 0.21889019012451172  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.375 GB
    Memory Allocated: 14.311458587646484  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.375 GB
    Memory Allocated: 14.313507556915283  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.376953125 GB
    Memory Allocated: 0.22547435760498047  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.190448760986328
pure train time :  2.6019394397735596
train time :  3.6587255001068115
end to end time :  9.586173295974731
connection check time:  2.1127331256866455
block generation time  2.9186606407165527
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.044821977615356445
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.7352786064147949
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.0004901885986328125