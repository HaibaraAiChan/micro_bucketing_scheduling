main start at this time 1698815297.7402062
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3086, 3087, 3090]), tensor([3091, 3092, 3093,  ..., 6129, 6130, 6131]), tensor([6132, 6133, 6134,  ..., 9191, 9192, 9193]), tensor([ 9194,  9196,  9197,  ..., 12259, 12260, 12261]), tensor([12262, 12263, 12264,  ..., 15338, 15339, 15340]), tensor([15341, 15342, 15343,  ..., 18402, 18403, 18404]), tensor([18405, 18406, 18407,  ..., 21473, 21474, 21475]), tensor([21476, 21477, 21478,  ..., 24524, 24525, 24526]), tensor([24528, 24529, 24530,  ..., 27604, 27605, 27606]), tensor([27607, 27608, 27609,  ..., 30683, 30684, 30685]), tensor([30686, 30687, 30688,  ..., 33736, 33737, 33738]), tensor([33739, 33740, 33741,  ..., 36825, 36827, 36828]), tensor([36829, 36830, 36831,  ..., 39898, 39900, 39901]), tensor([39902, 39903, 39904,  ..., 42996, 42997, 42998]), tensor([43000, 43002, 43003,  ..., 46061, 46062, 46063]), tensor([46064, 46065, 46066,  ..., 49132, 49133, 49134]), tensor([49135, 49136, 49137,  ..., 52183, 52184, 52185]), tensor([52186, 52187, 52188,  ..., 55250, 55251, 55253]), tensor([55254, 55255, 55256,  ..., 58305, 58306, 58307]), tensor([58308, 58309, 58310,  ..., 61362, 61363, 61364]), tensor([61365, 61366, 61367,  ..., 64426, 64430, 64431]), tensor([64432, 64433, 64434,  ..., 67508, 67510, 67511]), tensor([67512, 67513, 67515,  ..., 70564, 70565, 70566]), tensor([70567, 70568, 70569,  ..., 73634, 73635, 73636]), tensor([73637, 73638, 73639,  ..., 76716, 76717, 76718]), tensor([76719, 76721, 76722,  ..., 79786, 79788, 79789]), tensor([79790, 79791, 79792,  ..., 82852, 82853, 82854]), tensor([82855, 82856, 82857,  ..., 85910, 85912, 85913]), tensor([85914, 85915, 85916,  ..., 88999, 89000, 89001]), tensor([89003, 89004, 89005,  ..., 92061, 92062, 92063]), tensor([92064, 92066, 92067,  ..., 95148, 95152, 95153]), tensor([95154, 95155, 95156,  ..., 98209, 98210, 98211]), tensor([ 98212,  98213,  98214,  ..., 101283, 101284, 101285]), tensor([101286, 101287, 101288,  ..., 104377, 104378, 104379]), tensor([104380, 104381, 104383,  ..., 107445, 107447, 107448]), tensor([107449, 107450, 107451,  ..., 110537, 110538, 110539]), tensor([110540, 110541, 110542,  ..., 113591, 113592, 113593]), tensor([113594, 113595, 113596,  ..., 116654, 116655, 116656]), tensor([116657, 116658, 116659,  ..., 119692, 119693, 119694]), tensor([119695, 119696, 119697,  ..., 122778, 122779, 122781]), tensor([122782, 122783, 122784,  ..., 125855, 125856, 125857]), tensor([125858, 125859, 125860,  ..., 128917, 128918, 128919]), tensor([128920, 128921, 128922,  ..., 131968, 131969, 131970]), tensor([131971, 131972, 131975,  ..., 135056, 135057, 135058]), tensor([135060, 135062, 135063,  ..., 138155, 138157, 138158]), tensor([138159, 138160, 138161,  ..., 141234, 141235, 141236]), tensor([141237, 141238, 141239,  ..., 144264, 144265, 144266]), tensor([144267, 144268, 144269,  ..., 147345, 147346, 147347]), tensor([147349, 147350, 147351,  ..., 150391, 150392, 150393]), tensor([150394, 150396, 150397,  ..., 153426, 153428, 153430])]
self.K  50
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.45175862312316895
21
50
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0011181831359863281
self.weights_list  [0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.01766918028299366, 0.017480170239390996]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02000284194946289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.46035051345825195
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  3.0467162132263184
self.buckets_partition() spend  sec:  0.480379581451416
check connections block*********************************

the find indices time spent  0.06832742691040039

in edges time spent  0.7811529636383057
local to global src and eids time spent  2.0664098262786865
time gen tails  0.3825812339782715
res  length 50

block_gen_time in "generate_blocks_for_one_layer_block"  2.2543106079101562

----------------------------------------
check connections block*********************************

the find indices time spent  0.7723681926727295

in edges time spent  7.173285961151123
local to global src and eids time spent  10.399157524108887
time gen tails  1.705148458480835
res  length 50

block_gen_time in "generate_blocks_for_one_layer_block"  12.757606029510498

block collection to dataloader spend  0.00012063980102539062
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.802734375 GB
    Memory Allocated: 0.3668656349182129  GigaBytes
Max Memory Allocated: 0.3668656349182129  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.32421875 GB
    Memory Allocated: 19.530073165893555  GigaBytes
Max Memory Allocated: 20.77810287475586  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.32421875 GB
    Memory Allocated: 19.53048849105835  GigaBytes
Max Memory Allocated: 20.77810287475586  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3359375 GB
    Memory Allocated: 0.38181257247924805  GigaBytes
Max Memory Allocated: 20.77810287475586  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.50390625 GB
    Memory Allocated: 19.481698036193848  GigaBytes
Max Memory Allocated: 20.77810287475586  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.50390625 GB
    Memory Allocated: 19.482112884521484  GigaBytes
Max Memory Allocated: 20.77810287475586  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.505859375 GB
    Memory Allocated: 0.38294506072998047  GigaBytes
Max Memory Allocated: 20.77810287475586  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.505859375 GB
    Memory Allocated: 19.467074394226074  GigaBytes
Max Memory Allocated: 20.77810287475586  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.505859375 GB
    Memory Allocated: 19.46748924255371  GigaBytes
Max Memory Allocated: 20.77810287475586  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.5078125 GB
    Memory Allocated: 0.3871631622314453  GigaBytes
Max Memory Allocated: 20.77810287475586  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.44921875 GB
    Memory Allocated: 19.549216270446777  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.44921875 GB
    Memory Allocated: 19.549631118774414  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.453125 GB
    Memory Allocated: 0.3858318328857422  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.455078125 GB
    Memory Allocated: 19.37579584121704  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.455078125 GB
    Memory Allocated: 19.376210689544678  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.45703125 GB
    Memory Allocated: 0.3896760940551758  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.45703125 GB
    Memory Allocated: 19.531977653503418  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.45703125 GB
    Memory Allocated: 19.532392501831055  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4609375 GB
    Memory Allocated: 0.39113426208496094  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4609375 GB
    Memory Allocated: 19.480161666870117  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.4609375 GB
    Memory Allocated: 19.480576515197754  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4609375 GB
    Memory Allocated: 0.3921985626220703  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4609375 GB
    Memory Allocated: 19.473658561706543  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.4609375 GB
    Memory Allocated: 19.47407341003418  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4609375 GB
    Memory Allocated: 0.39448070526123047  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.4609375 GB
    Memory Allocated: 19.534634590148926  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.4609375 GB
    Memory Allocated: 19.535049438476562  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.46484375 GB
    Memory Allocated: 0.3962249755859375  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.46484375 GB
    Memory Allocated: 19.533912658691406  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.46484375 GB
    Memory Allocated: 19.534327507019043  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.46875 GB
    Memory Allocated: 0.3989858627319336  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.46875 GB
    Memory Allocated: 19.538652420043945  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.46875 GB
    Memory Allocated: 19.539067268371582  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.470703125 GB
    Memory Allocated: 0.3994021415710449  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.470703125 GB
    Memory Allocated: 19.477837562561035  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.470703125 GB
    Memory Allocated: 19.478252410888672  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.470703125 GB
    Memory Allocated: 0.40188074111938477  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.470703125 GB
    Memory Allocated: 19.534768104553223  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.470703125 GB
    Memory Allocated: 19.53518295288086  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.47265625 GB
    Memory Allocated: 0.40440797805786133  GigaBytes
Max Memory Allocated: 20.801666736602783  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.47265625 GB
    Memory Allocated: 19.564918518066406  GigaBytes
Max Memory Allocated: 20.81618881225586  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.47265625 GB
    Memory Allocated: 19.565333366394043  GigaBytes
Max Memory Allocated: 20.81618881225586  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.47265625 GB
    Memory Allocated: 0.4057927131652832  GigaBytes
Max Memory Allocated: 20.81618881225586  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.482421875 GB
    Memory Allocated: 19.641566276550293  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.482421875 GB
    Memory Allocated: 19.64198112487793  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.486328125 GB
    Memory Allocated: 0.4057588577270508  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.486328125 GB
    Memory Allocated: 19.4489107131958  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.486328125 GB
    Memory Allocated: 19.449325561523438  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.490234375 GB
    Memory Allocated: 0.4092526435852051  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.490234375 GB
    Memory Allocated: 19.54989194869995  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.490234375 GB
    Memory Allocated: 19.550306797027588  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.494140625 GB
    Memory Allocated: 0.40924882888793945  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.494140625 GB
    Memory Allocated: 19.511003971099854  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.494140625 GB
    Memory Allocated: 19.51141881942749  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.494140625 GB
    Memory Allocated: 0.41209888458251953  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.494140625 GB
    Memory Allocated: 19.561410903930664  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.494140625 GB
    Memory Allocated: 19.5618257522583  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.494140625 GB
    Memory Allocated: 0.4120025634765625  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.494140625 GB
    Memory Allocated: 19.449824810028076  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.494140625 GB
    Memory Allocated: 19.450239658355713  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.49609375 GB
    Memory Allocated: 0.4158039093017578  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.49609375 GB
    Memory Allocated: 19.577367782592773  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.49609375 GB
    Memory Allocated: 19.57778263092041  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.49609375 GB
    Memory Allocated: 0.41600656509399414  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.498046875 GB
    Memory Allocated: 19.488749504089355  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.498046875 GB
    Memory Allocated: 19.489164352416992  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.501953125 GB
    Memory Allocated: 0.41751766204833984  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.501953125 GB
    Memory Allocated: 19.412543296813965  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.501953125 GB
    Memory Allocated: 19.4129581451416  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 0.42099523544311523  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 19.513087272644043  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 19.51350212097168  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 0.4212207794189453  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 19.516573429107666  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 19.516988277435303  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 0.4223933219909668  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 19.46827793121338  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 19.468692779541016  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.42563962936401367  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.514236450195312  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.51465129852295  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.42653942108154297  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.480705738067627  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.481120586395264  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4275360107421875  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.51234245300293  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.512757301330566  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.513671875 GB
    Memory Allocated: 0.42975568771362305  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.513671875 GB
    Memory Allocated: 19.527076244354248  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.513671875 GB
    Memory Allocated: 19.527491092681885  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.513671875 GB
    Memory Allocated: 0.4316864013671875  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.513671875 GB
    Memory Allocated: 19.576255798339844  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.513671875 GB
    Memory Allocated: 19.57667064666748  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.515625 GB
    Memory Allocated: 0.4344806671142578  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.515625 GB
    Memory Allocated: 19.591663360595703  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.515625 GB
    Memory Allocated: 19.59207820892334  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.517578125 GB
    Memory Allocated: 0.4356060028076172  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.517578125 GB
    Memory Allocated: 19.508802890777588  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.517578125 GB
    Memory Allocated: 19.509217739105225  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.51953125 GB
    Memory Allocated: 0.4369058609008789  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.51953125 GB
    Memory Allocated: 19.491262435913086  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.51953125 GB
    Memory Allocated: 19.491677284240723  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.51953125 GB
    Memory Allocated: 0.43987560272216797  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.51953125 GB
    Memory Allocated: 19.57599925994873  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.51953125 GB
    Memory Allocated: 19.576414108276367  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.521484375 GB
    Memory Allocated: 0.4400973320007324  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.521484375 GB
    Memory Allocated: 19.526158332824707  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.521484375 GB
    Memory Allocated: 19.526573181152344  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.525390625 GB
    Memory Allocated: 0.4414544105529785  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.525390625 GB
    Memory Allocated: 19.500744342803955  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.525390625 GB
    Memory Allocated: 19.501159191131592  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52734375 GB
    Memory Allocated: 0.44455432891845703  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52734375 GB
    Memory Allocated: 19.58051633834839  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52734375 GB
    Memory Allocated: 19.580931186676025  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52734375 GB
    Memory Allocated: 0.44565916061401367  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.529296875 GB
    Memory Allocated: 19.58319616317749  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.529296875 GB
    Memory Allocated: 19.583611011505127  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53125 GB
    Memory Allocated: 0.4478764533996582  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53125 GB
    Memory Allocated: 19.529820919036865  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53125 GB
    Memory Allocated: 19.530235767364502  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53125 GB
    Memory Allocated: 0.4485654830932617  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53125 GB
    Memory Allocated: 19.441716194152832  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53125 GB
    Memory Allocated: 19.44213104248047  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.533203125 GB
    Memory Allocated: 0.4504871368408203  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.533203125 GB
    Memory Allocated: 19.52511501312256  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.533203125 GB
    Memory Allocated: 19.525529861450195  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.533203125 GB
    Memory Allocated: 0.4526667594909668  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.533203125 GB
    Memory Allocated: 19.48066759109497  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.533203125 GB
    Memory Allocated: 19.481082439422607  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53515625 GB
    Memory Allocated: 0.45333290100097656  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53515625 GB
    Memory Allocated: 19.526423454284668  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53515625 GB
    Memory Allocated: 19.526838302612305  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53515625 GB
    Memory Allocated: 0.45569372177124023  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.541015625 GB
    Memory Allocated: 19.542137145996094  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.541015625 GB
    Memory Allocated: 19.54255199432373  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54296875 GB
    Memory Allocated: 0.45882129669189453  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54296875 GB
    Memory Allocated: 19.606335163116455  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54296875 GB
    Memory Allocated: 19.606750011444092  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.544921875 GB
    Memory Allocated: 0.4598402976989746  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.544921875 GB
    Memory Allocated: 19.540735721588135  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.544921875 GB
    Memory Allocated: 19.54115056991577  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.544921875 GB
    Memory Allocated: 0.4618563652038574  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.544921875 GB
    Memory Allocated: 19.60015869140625  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.544921875 GB
    Memory Allocated: 19.600573539733887  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.546875 GB
    Memory Allocated: 0.4622163772583008  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.546875 GB
    Memory Allocated: 19.46316909790039  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.546875 GB
    Memory Allocated: 19.463583946228027  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.55078125 GB
    Memory Allocated: 0.4641914367675781  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.55078125 GB
    Memory Allocated: 19.4788498878479  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.55078125 GB
    Memory Allocated: 19.479260444641113  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.55078125 GB
    Memory Allocated: 0.49746036529541016  GigaBytes
Max Memory Allocated: 20.90154218673706  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.235854625701904
pure train time :  18.11758518218994
train time :  41.707542181015015
end to end time :  87.03243780136108
connection check time:  27.234190225601196
block generation time  15.011916637420654
end to end time  87.72868847846985
Total (block generation + training)time/epoch 87.72868847846985
pure train time per /epoch  [18.11758518218994]
pure train time average  nan
input num list  [7750026]
