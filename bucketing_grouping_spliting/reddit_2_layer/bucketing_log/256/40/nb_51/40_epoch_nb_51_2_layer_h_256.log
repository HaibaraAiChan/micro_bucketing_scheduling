main start at this time 1698815651.7007248
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3025, 3027, 3028]), tensor([3030, 3031, 3032,  ..., 6004, 6006, 6007]), tensor([6008, 6009, 6010,  ..., 9007, 9008, 9009]), tensor([ 9010,  9011,  9012,  ..., 12020, 12022, 12023]), tensor([12024, 12026, 12027,  ..., 15031, 15032, 15033]), tensor([15034, 15035, 15036,  ..., 18037, 18038, 18039]), tensor([18040, 18041, 18042,  ..., 21047, 21048, 21049]), tensor([21050, 21051, 21052,  ..., 24049, 24050, 24051]), tensor([24052, 24053, 24054,  ..., 27055, 27056, 27058]), tensor([27060, 27062, 27063,  ..., 30099, 30100, 30101]), tensor([30102, 30103, 30104,  ..., 33097, 33099, 33100]), tensor([33101, 33102, 33103,  ..., 36085, 36087, 36089]), tensor([36090, 36091, 36092,  ..., 39117, 39118, 39119]), tensor([39120, 39121, 39122,  ..., 42152, 42153, 42154]), tensor([42155, 42156, 42157,  ..., 45143, 45144, 45145]), tensor([45146, 45147, 45148,  ..., 48179, 48180, 48181]), tensor([48185, 48186, 48187,  ..., 51160, 51161, 51162]), tensor([51163, 51165, 51166,  ..., 54189, 54190, 54192]), tensor([54193, 54194, 54195,  ..., 57188, 57189, 57190]), tensor([57191, 57193, 57194,  ..., 60189, 60190, 60191]), tensor([60192, 60193, 60194,  ..., 63150, 63152, 63156]), tensor([63157, 63159, 63160,  ..., 66196, 66197, 66198]), tensor([66199, 66200, 66201,  ..., 69194, 69195, 69196]), tensor([69197, 69199, 69200,  ..., 72195, 72196, 72197]), tensor([72198, 72200, 72201,  ..., 75220, 75222, 75223]), tensor([75224, 75225, 75226,  ..., 78219, 78220, 78221]), tensor([78222, 78223, 78224,  ..., 81219, 81220, 81221]), tensor([81222, 81224, 81225,  ..., 84243, 84244, 84245]), tensor([84246, 84247, 84248,  ..., 87249, 87250, 87251]), tensor([87252, 87253, 87254,  ..., 90282, 90283, 90284]), tensor([90285, 90286, 90287,  ..., 93282, 93283, 93284]), tensor([93285, 93286, 93288,  ..., 96315, 96316, 96317]), tensor([96318, 96319, 96320,  ..., 99316, 99317, 99318]), tensor([ 99319,  99320,  99321,  ..., 102303, 102304, 102305]), tensor([102306, 102308, 102309,  ..., 105345, 105346, 105347]), tensor([105348, 105349, 105350,  ..., 108341, 108342, 108343]), tensor([108344, 108346, 108347,  ..., 111380, 111381, 111382]), tensor([111383, 111384, 111385,  ..., 114390, 114391, 114393]), tensor([114394, 114395, 114396,  ..., 117370, 117371, 117372]), tensor([117373, 117374, 117375,  ..., 120369, 120370, 120371]), tensor([120372, 120375, 120376,  ..., 123383, 123384, 123385]), tensor([123386, 123387, 123388,  ..., 126418, 126419, 126420]), tensor([126421, 126422, 126423,  ..., 129406, 129407, 129408]), tensor([129409, 129410, 129411,  ..., 132393, 132394, 132395]), tensor([132396, 132397, 132398,  ..., 135451, 135453, 135454]), tensor([135455, 135456, 135457,  ..., 138460, 138461, 138462]), tensor([138463, 138464, 138465,  ..., 141487, 141488, 141489]), tensor([141490, 141492, 141493,  ..., 144453, 144454, 144455]), tensor([144456, 144457, 144458,  ..., 147478, 147479, 147480]), tensor([147481, 147482, 147483,  ..., 150462, 150463, 150464]), tensor([150465, 150466, 150467,  ..., 153426, 153428, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4441492557525635
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0009336471557617188
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01962137222290039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4519476890563965
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.9766411781311035
self.buckets_partition() spend  sec:  0.47159457206726074
check connections block*********************************

the find indices time spent  0.06364631652832031

in edges time spent  0.666208028793335
local to global src and eids time spent  1.1470317840576172
time gen tails  0.3509960174560547
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.1426100730895996

----------------------------------------
check connections block*********************************

the find indices time spent  0.7808816432952881

in edges time spent  6.1412670612335205
local to global src and eids time spent  4.1283814907073975
time gen tails  1.0416464805603027
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  10.254531383514404

block collection to dataloader spend  0.00012135505676269531
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.80078125 GB
    Memory Allocated: 0.3660106658935547  GigaBytes
Max Memory Allocated: 0.3660106658935547  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.984375 GB
    Memory Allocated: 19.207749366760254  GigaBytes
Max Memory Allocated: 20.44145107269287  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.984375 GB
    Memory Allocated: 19.20815658569336  GigaBytes
Max Memory Allocated: 20.44145107269287  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.99609375 GB
    Memory Allocated: 0.37996721267700195  GigaBytes
Max Memory Allocated: 20.44145107269287  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.1484375 GB
    Memory Allocated: 19.21486234664917  GigaBytes
Max Memory Allocated: 20.44587755203247  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.1484375 GB
    Memory Allocated: 19.215269088745117  GigaBytes
Max Memory Allocated: 20.44587755203247  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.150390625 GB
    Memory Allocated: 0.3818812370300293  GigaBytes
Max Memory Allocated: 20.44587755203247  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.150390625 GB
    Memory Allocated: 19.169935703277588  GigaBytes
Max Memory Allocated: 20.44587755203247  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.150390625 GB
    Memory Allocated: 19.170342445373535  GigaBytes
Max Memory Allocated: 20.44587755203247  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.15234375 GB
    Memory Allocated: 0.38556623458862305  GigaBytes
Max Memory Allocated: 20.44587755203247  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.228515625 GB
    Memory Allocated: 19.293394565582275  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.228515625 GB
    Memory Allocated: 19.293801307678223  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.23046875 GB
    Memory Allocated: 0.38394880294799805  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.232421875 GB
    Memory Allocated: 19.102447032928467  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.232421875 GB
    Memory Allocated: 19.102853775024414  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.236328125 GB
    Memory Allocated: 0.3880276679992676  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.236328125 GB
    Memory Allocated: 19.22481393814087  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.236328125 GB
    Memory Allocated: 19.225220680236816  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.23828125 GB
    Memory Allocated: 0.38954973220825195  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.23828125 GB
    Memory Allocated: 19.208373546600342  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.23828125 GB
    Memory Allocated: 19.20878028869629  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.240234375 GB
    Memory Allocated: 0.3909330368041992  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.240234375 GB
    Memory Allocated: 19.23585844039917  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.240234375 GB
    Memory Allocated: 19.236265182495117  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.240234375 GB
    Memory Allocated: 0.3927431106567383  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.396484375 GB
    Memory Allocated: 19.263741970062256  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.396484375 GB
    Memory Allocated: 19.264148712158203  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.396484375 GB
    Memory Allocated: 0.3939957618713379  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 19.224828243255615  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 19.225234985351562  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.40625 GB
    Memory Allocated: 0.39698076248168945  GigaBytes
Max Memory Allocated: 20.53385019302368  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.25 GB
    Memory Allocated: 19.311555862426758  GigaBytes
Max Memory Allocated: 20.553586959838867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.25 GB
    Memory Allocated: 19.311962604522705  GigaBytes
Max Memory Allocated: 20.553586959838867  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.251953125 GB
    Memory Allocated: 0.3973574638366699  GigaBytes
Max Memory Allocated: 20.553586959838867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.251953125 GB
    Memory Allocated: 19.172892093658447  GigaBytes
Max Memory Allocated: 20.553586959838867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.251953125 GB
    Memory Allocated: 19.173298835754395  GigaBytes
Max Memory Allocated: 20.553586959838867  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.255859375 GB
    Memory Allocated: 0.3994579315185547  GigaBytes
Max Memory Allocated: 20.553586959838867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.255859375 GB
    Memory Allocated: 19.150700569152832  GigaBytes
Max Memory Allocated: 20.553586959838867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.255859375 GB
    Memory Allocated: 19.15110731124878  GigaBytes
Max Memory Allocated: 20.553586959838867  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.255859375 GB
    Memory Allocated: 0.4021272659301758  GigaBytes
Max Memory Allocated: 20.553586959838867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.255859375 GB
    Memory Allocated: 19.3123140335083  GigaBytes
Max Memory Allocated: 20.553586959838867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.255859375 GB
    Memory Allocated: 19.312720775604248  GigaBytes
Max Memory Allocated: 20.553586959838867  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.2578125 GB
    Memory Allocated: 0.4035825729370117  GigaBytes
Max Memory Allocated: 20.553586959838867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.318359375 GB
    Memory Allocated: 19.34441566467285  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.318359375 GB
    Memory Allocated: 19.3448224067688  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3203125 GB
    Memory Allocated: 0.40426111221313477  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.217329502105713  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.21773624420166  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.326171875 GB
    Memory Allocated: 0.40590620040893555  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.326171875 GB
    Memory Allocated: 19.207934379577637  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.326171875 GB
    Memory Allocated: 19.208341121673584  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.328125 GB
    Memory Allocated: 0.4078803062438965  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.328125 GB
    Memory Allocated: 19.213461875915527  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.328125 GB
    Memory Allocated: 19.213868618011475  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.330078125 GB
    Memory Allocated: 0.40929651260375977  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.330078125 GB
    Memory Allocated: 19.301788330078125  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.330078125 GB
    Memory Allocated: 19.302195072174072  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.330078125 GB
    Memory Allocated: 0.41013145446777344  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.330078125 GB
    Memory Allocated: 19.202149868011475  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.330078125 GB
    Memory Allocated: 19.202556610107422  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.330078125 GB
    Memory Allocated: 0.4122772216796875  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.330078125 GB
    Memory Allocated: 19.1637544631958  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.330078125 GB
    Memory Allocated: 19.164161205291748  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 0.413449764251709  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 19.207555770874023  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 19.20796251296997  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.333984375 GB
    Memory Allocated: 0.4152865409851074  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3359375 GB
    Memory Allocated: 19.202505588531494  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3359375 GB
    Memory Allocated: 19.20291233062744  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 0.418917179107666  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 19.2134051322937  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 19.21381187438965  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 0.4192986488342285  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 19.307651042938232  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 19.30805778503418  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 0.42125558853149414  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 19.307118892669678  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 19.307525634765625  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.341796875 GB
    Memory Allocated: 0.4215812683105469  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.341796875 GB
    Memory Allocated: 19.220885276794434  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.341796875 GB
    Memory Allocated: 19.22129201889038  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.341796875 GB
    Memory Allocated: 0.42482852935791016  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.34375 GB
    Memory Allocated: 19.243715286254883  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.34375 GB
    Memory Allocated: 19.24412202835083  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 0.42641639709472656  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 19.269500255584717  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 19.269906997680664  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 0.4261341094970703  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 19.21574306488037  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 19.21614980697632  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3515625 GB
    Memory Allocated: 0.42882680892944336  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3515625 GB
    Memory Allocated: 19.230051040649414  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3515625 GB
    Memory Allocated: 19.23045778274536  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.353515625 GB
    Memory Allocated: 0.43012571334838867  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.353515625 GB
    Memory Allocated: 19.27160406112671  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.353515625 GB
    Memory Allocated: 19.272010803222656  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.353515625 GB
    Memory Allocated: 0.4328904151916504  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.353515625 GB
    Memory Allocated: 19.25190496444702  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.353515625 GB
    Memory Allocated: 19.25231170654297  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.353515625 GB
    Memory Allocated: 0.43490028381347656  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.353515625 GB
    Memory Allocated: 19.26972484588623  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.353515625 GB
    Memory Allocated: 19.270131587982178  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 0.43711233139038086  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 19.264667510986328  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 19.265074253082275  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 0.4381098747253418  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 19.23604679107666  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 19.236453533172607  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 0.43857383728027344  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.361328125 GB
    Memory Allocated: 19.18101167678833  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.361328125 GB
    Memory Allocated: 19.181418418884277  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.365234375 GB
    Memory Allocated: 0.4410691261291504  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.365234375 GB
    Memory Allocated: 19.275939464569092  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.365234375 GB
    Memory Allocated: 19.27634620666504  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.365234375 GB
    Memory Allocated: 0.44264698028564453  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.365234375 GB
    Memory Allocated: 19.269694805145264  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.365234375 GB
    Memory Allocated: 19.27010154724121  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.365234375 GB
    Memory Allocated: 0.4441370964050293  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.365234375 GB
    Memory Allocated: 19.235602855682373  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.365234375 GB
    Memory Allocated: 19.23600959777832  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3671875 GB
    Memory Allocated: 0.44636011123657227  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3671875 GB
    Memory Allocated: 19.233887195587158  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3671875 GB
    Memory Allocated: 19.234293937683105  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3671875 GB
    Memory Allocated: 0.4468255043029785  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3671875 GB
    Memory Allocated: 19.170332431793213  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3671875 GB
    Memory Allocated: 19.17073917388916  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3671875 GB
    Memory Allocated: 0.4495983123779297  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3671875 GB
    Memory Allocated: 19.238582611083984  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3671875 GB
    Memory Allocated: 19.23898935317993  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.37109375 GB
    Memory Allocated: 0.45093822479248047  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.37109375 GB
    Memory Allocated: 19.188998222351074  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.37109375 GB
    Memory Allocated: 19.18940496444702  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.37109375 GB
    Memory Allocated: 0.45143842697143555  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.37109375 GB
    Memory Allocated: 19.24274253845215  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.37109375 GB
    Memory Allocated: 19.243149280548096  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.373046875 GB
    Memory Allocated: 0.45442771911621094  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.375 GB
    Memory Allocated: 19.25458526611328  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.375 GB
    Memory Allocated: 19.25499200820923  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.37890625 GB
    Memory Allocated: 0.45768117904663086  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.37890625 GB
    Memory Allocated: 19.350398063659668  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.37890625 GB
    Memory Allocated: 19.350804805755615  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.380859375 GB
    Memory Allocated: 0.4583568572998047  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.380859375 GB
    Memory Allocated: 19.24049949645996  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.380859375 GB
    Memory Allocated: 19.240906238555908  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.380859375 GB
    Memory Allocated: 0.45993804931640625  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.380859375 GB
    Memory Allocated: 19.287731647491455  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.380859375 GB
    Memory Allocated: 19.288138389587402  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3828125 GB
    Memory Allocated: 0.46088457107543945  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3828125 GB
    Memory Allocated: 19.186068534851074  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3828125 GB
    Memory Allocated: 19.18647527694702  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.384765625 GB
    Memory Allocated: 0.46221303939819336  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.384765625 GB
    Memory Allocated: 19.121745109558105  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.384765625 GB
    Memory Allocated: 19.122146129608154  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.4953804016113281  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 6.225468158721924
pure train time :  18.357827186584473
train time :  41.65673303604126
end to end time :  73.27498459815979
connection check time:  16.216841459274292
block generation time  12.397141456604004
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3017, 3018, 3019]), tensor([3020, 3021, 3022,  ..., 6044, 6045, 6046]), tensor([6047, 6048, 6049,  ..., 9063, 9064, 9065]), tensor([ 9066,  9067,  9068,  ..., 12055, 12056, 12057]), tensor([12058, 12061, 12062,  ..., 15050, 15051, 15052]), tensor([15054, 15055, 15056,  ..., 18026, 18027, 18028]), tensor([18029, 18030, 18031,  ..., 21033, 21034, 21035]), tensor([21036, 21037, 21038,  ..., 24058, 24059, 24060]), tensor([24061, 24062, 24063,  ..., 27055, 27056, 27057]), tensor([27058, 27059, 27061,  ..., 30045, 30048, 30049]), tensor([30052, 30054, 30055,  ..., 33086, 33087, 33088]), tensor([33089, 33090, 33091,  ..., 36082, 36083, 36084]), tensor([36085, 36086, 36087,  ..., 39093, 39094, 39095]), tensor([39096, 39097, 39098,  ..., 42080, 42081, 42083]), tensor([42084, 42085, 42086,  ..., 45088, 45089, 45090]), tensor([45091, 45092, 45094,  ..., 48081, 48082, 48083]), tensor([48085, 48086, 48087,  ..., 51127, 51128, 51129]), tensor([51131, 51133, 51134,  ..., 54108, 54109, 54111]), tensor([54112, 54114, 54115,  ..., 57123, 57124, 57125]), tensor([57126, 57127, 57128,  ..., 60140, 60142, 60143]), tensor([60144, 60145, 60146,  ..., 63133, 63134, 63135]), tensor([63136, 63137, 63138,  ..., 66134, 66136, 66137]), tensor([66138, 66139, 66140,  ..., 69147, 69148, 69149]), tensor([69150, 69151, 69152,  ..., 72202, 72203, 72205]), tensor([72206, 72207, 72208,  ..., 75199, 75200, 75201]), tensor([75202, 75204, 75205,  ..., 78217, 78220, 78221]), tensor([78222, 78223, 78224,  ..., 81219, 81220, 81221]), tensor([81222, 81223, 81224,  ..., 84243, 84244, 84245]), tensor([84246, 84247, 84248,  ..., 87232, 87233, 87235]), tensor([87236, 87237, 87238,  ..., 90246, 90247, 90248]), tensor([90249, 90250, 90251,  ..., 93278, 93279, 93280]), tensor([93281, 93282, 93283,  ..., 96291, 96292, 96293]), tensor([96296, 96297, 96298,  ..., 99298, 99299, 99300]), tensor([ 99302,  99303,  99305,  ..., 102329, 102330, 102331]), tensor([102332, 102333, 102334,  ..., 105316, 105317, 105318]), tensor([105319, 105320, 105321,  ..., 108322, 108323, 108324]), tensor([108325, 108326, 108327,  ..., 111368, 111369, 111370]), tensor([111371, 111373, 111375,  ..., 114404, 114406, 114407]), tensor([114408, 114409, 114410,  ..., 117415, 117416, 117417]), tensor([117418, 117419, 117420,  ..., 120401, 120402, 120403]), tensor([120404, 120405, 120406,  ..., 123431, 123432, 123433]), tensor([123434, 123435, 123437,  ..., 126428, 126429, 126430]), tensor([126431, 126432, 126435,  ..., 129449, 129450, 129452]), tensor([129453, 129454, 129455,  ..., 132474, 132476, 132477]), tensor([132478, 132479, 132480,  ..., 135452, 135453, 135454]), tensor([135455, 135457, 135459,  ..., 138453, 138454, 138455]), tensor([138456, 138458, 138459,  ..., 141491, 141492, 141494]), tensor([141496, 141497, 141498,  ..., 144476, 144479, 144480]), tensor([144481, 144482, 144483,  ..., 147467, 147468, 147469]), tensor([147470, 147471, 147472,  ..., 150485, 150486, 150487]), tensor([150488, 150489, 150490,  ..., 153427, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.49808239936828613
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004153251647949219
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.020175457000732422
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5053267478942871
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.701447010040283
self.buckets_partition() spend  sec:  0.5255322456359863
check connections block*********************************

the find indices time spent  0.07072663307189941

in edges time spent  0.7061185836791992
local to global src and eids time spent  0.9349825382232666
time gen tails  0.21480417251586914
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  1.7098493576049805

----------------------------------------
check connections block*********************************

the find indices time spent  0.6336591243743896

in edges time spent  4.199188709259033
local to global src and eids time spent  9.916675806045532
time gen tails  1.6422874927520752
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.363851547241211

block collection to dataloader spend  8.630752563476562e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.4089241027832031  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.300528526306152  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.299270629882812  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.40894031524658203  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.262752056121826  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.263158798217773  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.4085879325866699  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.148191928863525  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.148598670959473  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.4116373062133789  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.20347261428833  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.203879356384277  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.41278505325317383  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.202779293060303  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.20318603515625  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.41539907455444336  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.21672296524048  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.217129707336426  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.4167766571044922  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.204622268676758  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.205029010772705  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.4206714630126953  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.305351734161377  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.305758476257324  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4192390441894531  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.237064361572266  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.237471103668213  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.42194700241088867  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.21210289001465  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.212509632110596  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4240293502807617  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.234492778778076  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.234899520874023  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.42412281036376953  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.218125820159912  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.21853256225586  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.42760133743286133  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.21037769317627  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.210784435272217  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4297666549682617  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.2620906829834  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.262497425079346  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4313621520996094  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.317304611206055  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.317711353302002  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.431241512298584  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.211398124694824  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.21180486679077  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4334135055541992  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.24338436126709  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.243791103363037  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4355792999267578  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.25979995727539  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.260206699371338  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4370245933532715  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.228861331939697  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.229268074035645  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.43936586380004883  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.235838890075684  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.23624563217163  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.44112443923950195  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.273874759674072  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.27428150177002  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.44241952896118164  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.238949298858643  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.23935604095459  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4435901641845703  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.183955192565918  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.184361934661865  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4449939727783203  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.185576915740967  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.185983657836914  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4465656280517578  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.248734951019287  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.249141693115234  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4497532844543457  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.337035179138184  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.33744192123413  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4502420425415039  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.195531845092773  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.19593858718872  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.45351648330688477  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.30736780166626  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.307774543762207  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4532451629638672  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.168448448181152  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.1688551902771  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4553041458129883  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.269911766052246  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.270318508148193  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4578132629394531  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.29840612411499  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.298812866210938  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.45955801010131836  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.27737522125244  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.27778196334839  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4613990783691406  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.2953200340271  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.295726776123047  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4625053405761719  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.350709915161133  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.35111665725708  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4656510353088379  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.29332160949707  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.293728351593018  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4668612480163574  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.30486822128296  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.305274963378906  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4676780700683594  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.260597229003906  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.261003971099854  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.46996307373046875  GigaBytes
Max Memory Allocated: 20.590556144714355  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.367382049560547  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.367788791656494  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4692244529724121  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.25803232192993  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.25843906402588  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.47312164306640625  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.271138191223145  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.271544933319092  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.47418212890625  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.2087459564209  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.209152698516846  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.47551870346069336  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.185726642608643  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.18613338470459  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.47809600830078125  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.364315509796143  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.36472225189209  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.48039722442626953  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.27392864227295  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.274335384368896  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.48056507110595703  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.26511240005493  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.26551914215088  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.4822249412536621  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.265957832336426  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.266364574432373  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 0.48485279083251953  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.3370680809021  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 19.337474822998047  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 0.48580121994018555  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 19.272990226745605  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 19.273396968841553  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 0.4876060485839844  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 19.28134536743164  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 19.281752109527588  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 0.4903264045715332  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 19.276004314422607  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.505859375 GB
    Memory Allocated: 19.276411056518555  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.5078125 GB
    Memory Allocated: 0.4910120964050293  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.5078125 GB
    Memory Allocated: 19.122962951660156  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.5078125 GB
    Memory Allocated: 19.123363971710205  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.49615955352783203  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.099809646606445
pure train time :  17.50130033493042
train time :  40.66489219665527
end to end time :  78.09597945213318
connection check time:  21.599711418151855
block generation time  13.073700904846191
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   1,    2,    3,  ..., 3005, 3007, 3008]), tensor([3009, 3010, 3011,  ..., 5988, 5990, 5991]), tensor([5992, 5993, 5995,  ..., 8987, 8989, 8990]), tensor([ 8991,  8992,  8993,  ..., 11991, 11992, 11994]), tensor([11995, 11996, 11997,  ..., 15022, 15023, 15024]), tensor([15025, 15026, 15027,  ..., 18067, 18068, 18069]), tensor([18072, 18073, 18075,  ..., 21106, 21107, 21108]), tensor([21109, 21110, 21111,  ..., 24143, 24144, 24145]), tensor([24146, 24147, 24148,  ..., 27140, 27141, 27142]), tensor([27143, 27144, 27145,  ..., 30179, 30180, 30181]), tensor([30182, 30183, 30184,  ..., 33187, 33190, 33191]), tensor([33192, 33193, 33194,  ..., 36216, 36217, 36218]), tensor([36219, 36220, 36221,  ..., 39202, 39203, 39204]), tensor([39205, 39206, 39207,  ..., 42229, 42230, 42231]), tensor([42233, 42234, 42235,  ..., 45229, 45230, 45231]), tensor([45232, 45233, 45234,  ..., 48249, 48250, 48251]), tensor([48252, 48253, 48254,  ..., 51251, 51252, 51253]), tensor([51254, 51255, 51256,  ..., 54241, 54242, 54244]), tensor([54245, 54246, 54247,  ..., 57259, 57260, 57261]), tensor([57262, 57263, 57264,  ..., 60245, 60246, 60247]), tensor([60249, 60250, 60251,  ..., 63219, 63220, 63221]), tensor([63222, 63223, 63224,  ..., 66192, 66193, 66194]), tensor([66196, 66198, 66199,  ..., 69204, 69206, 69207]), tensor([69208, 69209, 69210,  ..., 72199, 72201, 72202]), tensor([72203, 72205, 72206,  ..., 75255, 75256, 75257]), tensor([75258, 75259, 75260,  ..., 78234, 78237, 78238]), tensor([78240, 78241, 78242,  ..., 81277, 81278, 81279]), tensor([81281, 81282, 81283,  ..., 84277, 84278, 84279]), tensor([84280, 84281, 84283,  ..., 87292, 87294, 87295]), tensor([87296, 87297, 87299,  ..., 90305, 90307, 90309]), tensor([90310, 90311, 90312,  ..., 93293, 93294, 93295]), tensor([93296, 93297, 93299,  ..., 96360, 96361, 96362]), tensor([96363, 96364, 96365,  ..., 99397, 99398, 99399]), tensor([ 99401,  99402,  99403,  ..., 102425, 102427, 102428]), tensor([102430, 102431, 102432,  ..., 105424, 105425, 105426]), tensor([105427, 105428, 105429,  ..., 108438, 108439, 108441]), tensor([108442, 108443, 108444,  ..., 111433, 111434, 111435]), tensor([111436, 111437, 111438,  ..., 114430, 114431, 114432]), tensor([114433, 114434, 114435,  ..., 117433, 117434, 117436]), tensor([117437, 117438, 117439,  ..., 120428, 120429, 120430]), tensor([120431, 120432, 120434,  ..., 123449, 123450, 123452]), tensor([123453, 123454, 123456,  ..., 126457, 126458, 126459]), tensor([126460, 126461, 126462,  ..., 129489, 129490, 129491]), tensor([129492, 129493, 129494,  ..., 132488, 132489, 132490]), tensor([132491, 132492, 132493,  ..., 135509, 135511, 135512]), tensor([135513, 135514, 135515,  ..., 138495, 138496, 138497]), tensor([138498, 138499, 138500,  ..., 141501, 141502, 141503]), tensor([141504, 141505, 141506,  ..., 144504, 144505, 144506]), tensor([144507, 144508, 144510,  ..., 147491, 147492, 147493]), tensor([147494, 147496, 147497,  ..., 150483, 150485, 150486]), tensor([150487, 150488, 150489,  ..., 153426, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4857211112976074
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004131793975830078
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027994394302368164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4930553436279297
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  1.4392991065979004
self.buckets_partition() spend  sec:  0.5210819244384766
check connections block*********************************

the find indices time spent  0.05351853370666504

in edges time spent  0.4064507484436035
local to global src and eids time spent  0.9071512222290039
time gen tails  0.34893369674682617
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.2172963619232178

----------------------------------------
check connections block*********************************

the find indices time spent  0.8716051578521729

in edges time spent  5.868331432342529
local to global src and eids time spent  9.981187582015991
time gen tails  1.577643632888794
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.023321390151978

block collection to dataloader spend  8.988380432128906e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4080014228820801  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.1977596282959  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.19650173187256  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4070897102355957  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.192555904388428  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.192962646484375  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.41025495529174805  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.21834945678711  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.218756198883057  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4118771553039551  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.250884532928467  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.251291275024414  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4137687683105469  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.204559803009033  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.20496654510498  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4151782989501953  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.25617027282715  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.256577014923096  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.41823339462280273  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.22461462020874  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.225021362304688  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.41897010803222656  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.238647937774658  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.239054679870605  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.42102909088134766  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.259267807006836  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.259674549102783  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.421142578125  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.202085971832275  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.202492713928223  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.42533445358276367  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.333113193511963  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.33351993560791  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4255704879760742  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.241352081298828  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.241758823394775  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4273257255554199  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.166486263275146  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.166893005371094  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4286832809448242  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.232887268066406  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.233294010162354  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4302377700805664  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.272981643676758  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.273388385772705  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.43111467361450195  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.178458213806152  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.1788649559021  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4341921806335449  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.32145357131958  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.321860313415527  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4356656074523926  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.229287147521973  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.22969388961792  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4389047622680664  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.29919719696045  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.299603939056396  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.43900203704833984  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.286964893341064  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.28737163543701  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.43961048126220703  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.225651741027832  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.22605848312378  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4429783821105957  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.173885822296143  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.17429256439209  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.44428348541259766  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.233586311340332  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.23399305343628  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.44535017013549805  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.292871475219727  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.293278217315674  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4468522071838379  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.194228172302246  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.194634914398193  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.44863224029541016  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.288406372070312  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.28881311416626  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4508371353149414  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.337849140167236  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.338255882263184  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.45270729064941406  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.269668102264404  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.27007484436035  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4550967216491699  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.29280948638916  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.293216228485107  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.45773935317993164  GigaBytes
Max Memory Allocated: 20.60822057723999  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.373077869415283  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.37348461151123  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4557967185974121  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.240604400634766  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.241011142730713  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.45977020263671875  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.25462245941162  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.25502920150757  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4590592384338379  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.1983380317688  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.198744773864746  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.46259117126464844  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.264925479888916  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.265332221984863  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4647397994995117  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.30803680419922  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.308443546295166  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.46585988998413086  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.22207021713257  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.222476959228516  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.46773433685302734  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.30803680419922  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.308443546295166  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.46874189376831055  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.2765474319458  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.276954174041748  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4707832336425781  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.288644313812256  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.289051055908203  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.47355031967163086  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.30700397491455  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.307410717010498  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4746546745300293  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.278183937072754  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.2785906791687  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4753732681274414  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.278625011444092  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.27903175354004  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4769554138183594  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.210230827331543  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.21063756942749  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.48010826110839844  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.3045654296875  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.304972171783447  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4806184768676758  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.271224975585938  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.271631717681885  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4816770553588867  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.235225200653076  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.235631942749023  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4859457015991211  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.340187072753906  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.340593814849854  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.48590517044067383  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.22638988494873  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.226796627044678  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.48713207244873047  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.315614700317383  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.31602144241333  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.48879194259643555  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.213221073150635  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.213627815246582  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.488863468170166  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.034253120422363  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.034654140472412  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.49399375915527344  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.790814399719238
pure train time :  17.210593938827515
train time :  40.37619090080261
end to end time :  78.53265142440796
connection check time:  23.4310302734375
block generation time  13.240617752075195
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    2,    3,  ..., 3008, 3009, 3010]), tensor([3011, 3012, 3014,  ..., 6035, 6036, 6037]), tensor([6039, 6040, 6041,  ..., 9050, 9051, 9053]), tensor([ 9054,  9055,  9056,  ..., 12048, 12049, 12051]), tensor([12052, 12053, 12054,  ..., 15070, 15071, 15072]), tensor([15073, 15074, 15075,  ..., 18058, 18059, 18061]), tensor([18062, 18063, 18064,  ..., 21055, 21057, 21058]), tensor([21059, 21060, 21061,  ..., 24037, 24038, 24039]), tensor([24040, 24041, 24042,  ..., 27046, 27047, 27048]), tensor([27049, 27050, 27051,  ..., 30088, 30089, 30090]), tensor([30091, 30092, 30095,  ..., 33072, 33073, 33074]), tensor([33075, 33076, 33077,  ..., 36053, 36054, 36055]), tensor([36056, 36057, 36058,  ..., 39056, 39057, 39058]), tensor([39059, 39060, 39061,  ..., 42067, 42068, 42070]), tensor([42072, 42074, 42075,  ..., 45093, 45094, 45095]), tensor([45096, 45097, 45098,  ..., 48114, 48115, 48116]), tensor([48117, 48118, 48119,  ..., 51126, 51127, 51129]), tensor([51130, 51131, 51132,  ..., 54086, 54087, 54088]), tensor([54089, 54090, 54091,  ..., 57094, 57095, 57096]), tensor([57097, 57098, 57099,  ..., 60089, 60090, 60091]), tensor([60092, 60093, 60094,  ..., 63090, 63091, 63093]), tensor([63095, 63096, 63097,  ..., 66100, 66101, 66102]), tensor([66103, 66104, 66105,  ..., 69093, 69094, 69095]), tensor([69096, 69097, 69098,  ..., 72144, 72145, 72146]), tensor([72147, 72148, 72149,  ..., 75142, 75143, 75144]), tensor([75145, 75146, 75147,  ..., 78166, 78167, 78168]), tensor([78169, 78170, 78171,  ..., 81199, 81200, 81201]), tensor([81202, 81203, 81204,  ..., 84204, 84205, 84206]), tensor([84207, 84208, 84209,  ..., 87188, 87189, 87190]), tensor([87191, 87192, 87193,  ..., 90195, 90196, 90198]), tensor([90200, 90201, 90202,  ..., 93243, 93244, 93245]), tensor([93246, 93248, 93250,  ..., 96238, 96240, 96241]), tensor([96242, 96245, 96246,  ..., 99261, 99262, 99263]), tensor([ 99264,  99266,  99267,  ..., 102281, 102282, 102283]), tensor([102284, 102285, 102286,  ..., 105294, 105295, 105296]), tensor([105297, 105298, 105299,  ..., 108293, 108294, 108295]), tensor([108296, 108299, 108300,  ..., 111318, 111319, 111320]), tensor([111323, 111324, 111325,  ..., 114339, 114340, 114341]), tensor([114343, 114344, 114345,  ..., 117351, 117352, 117353]), tensor([117354, 117356, 117357,  ..., 120363, 120364, 120367]), tensor([120368, 120369, 120370,  ..., 123386, 123388, 123389]), tensor([123390, 123391, 123392,  ..., 126412, 126413, 126414]), tensor([126415, 126416, 126417,  ..., 129436, 129437, 129438]), tensor([129439, 129440, 129441,  ..., 132425, 132426, 132427]), tensor([132428, 132429, 132430,  ..., 135423, 135424, 135425]), tensor([135426, 135427, 135428,  ..., 138427, 138428, 138430]), tensor([138431, 138432, 138433,  ..., 141447, 141448, 141449]), tensor([141450, 141451, 141453,  ..., 144463, 144464, 144465]), tensor([144466, 144469, 144470,  ..., 147463, 147464, 147465]), tensor([147467, 147468, 147470,  ..., 150464, 150467, 150468]), tensor([150469, 150471, 150473,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4993321895599365
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004315376281738281
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02474808692932129
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5065217018127441
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.904689073562622
self.buckets_partition() spend  sec:  0.5313012599945068
check connections block*********************************

the find indices time spent  0.07236075401306152

in edges time spent  0.703195333480835
local to global src and eids time spent  2.0500869750976562
time gen tails  0.3872203826904297
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.215833902359009

----------------------------------------
check connections block*********************************

the find indices time spent  0.8635313510894775

in edges time spent  6.059220790863037
local to global src and eids time spent  9.60878324508667
time gen tails  1.5477266311645508
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  10.674561023712158

block collection to dataloader spend  7.367134094238281e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.40833520889282227  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.193588733673096  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.192331790924072  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4073042869567871  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.166016578674316  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.166423320770264  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.41037654876708984  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.26018714904785  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.2605938911438  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.4113941192626953  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.2543044090271  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 19.254711151123047  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.509765625 GB
    Memory Allocated: 0.414456844329834  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 19.331021785736084  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 19.33142852783203  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 0.41521263122558594  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 19.20648717880249  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 19.206893920898438  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 0.4164237976074219  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 19.243987560272217  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 19.244394302368164  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 0.418515682220459  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 19.249796390533447  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 19.250203132629395  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 0.4206995964050293  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 19.276384353637695  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.89453125 GB
    Memory Allocated: 19.276791095733643  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.8984375 GB
    Memory Allocated: 0.4226408004760742  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.8984375 GB
    Memory Allocated: 19.313096046447754  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.8984375 GB
    Memory Allocated: 19.3135027885437  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.900390625 GB
    Memory Allocated: 0.42452096939086914  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.900390625 GB
    Memory Allocated: 19.32150936126709  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.900390625 GB
    Memory Allocated: 19.321916103363037  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.90234375 GB
    Memory Allocated: 0.42514562606811523  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.90234375 GB
    Memory Allocated: 19.245769023895264  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.90234375 GB
    Memory Allocated: 19.24617576599121  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.90234375 GB
    Memory Allocated: 0.4280228614807129  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.90234375 GB
    Memory Allocated: 19.316590309143066  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.90234375 GB
    Memory Allocated: 19.316997051239014  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.90625 GB
    Memory Allocated: 0.42916107177734375  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.90625 GB
    Memory Allocated: 19.235378742218018  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.90625 GB
    Memory Allocated: 19.235785484313965  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.90625 GB
    Memory Allocated: 0.4296703338623047  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.90625 GB
    Memory Allocated: 19.212753772735596  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.90625 GB
    Memory Allocated: 19.213160514831543  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.90625 GB
    Memory Allocated: 0.43174076080322266  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.90625 GB
    Memory Allocated: 19.278035163879395  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.90625 GB
    Memory Allocated: 19.278441905975342  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.908203125 GB
    Memory Allocated: 0.43282413482666016  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.908203125 GB
    Memory Allocated: 19.220776557922363  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.908203125 GB
    Memory Allocated: 19.22118330001831  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.908203125 GB
    Memory Allocated: 0.4346475601196289  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.91015625 GB
    Memory Allocated: 19.227258682250977  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.91015625 GB
    Memory Allocated: 19.227665424346924  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.912109375 GB
    Memory Allocated: 0.4360074996948242  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9140625 GB
    Memory Allocated: 19.179244995117188  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.9140625 GB
    Memory Allocated: 19.179651737213135  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.916015625 GB
    Memory Allocated: 0.43938207626342773  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.916015625 GB
    Memory Allocated: 19.283737659454346  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.916015625 GB
    Memory Allocated: 19.284144401550293  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.919921875 GB
    Memory Allocated: 0.43938255310058594  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.919921875 GB
    Memory Allocated: 19.27228355407715  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.919921875 GB
    Memory Allocated: 19.272690296173096  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.919921875 GB
    Memory Allocated: 0.44159364700317383  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.919921875 GB
    Memory Allocated: 19.26754331588745  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.919921875 GB
    Memory Allocated: 19.2679500579834  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.919921875 GB
    Memory Allocated: 0.44504642486572266  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.921875 GB
    Memory Allocated: 19.33209228515625  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.921875 GB
    Memory Allocated: 19.332499027252197  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.92578125 GB
    Memory Allocated: 0.44606733322143555  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.92578125 GB
    Memory Allocated: 19.292980670928955  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.92578125 GB
    Memory Allocated: 19.293387413024902  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.92578125 GB
    Memory Allocated: 0.4476943016052246  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.92578125 GB
    Memory Allocated: 19.243725299835205  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.92578125 GB
    Memory Allocated: 19.244132041931152  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.92578125 GB
    Memory Allocated: 0.44768238067626953  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.927734375 GB
    Memory Allocated: 19.236289501190186  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.927734375 GB
    Memory Allocated: 19.236696243286133  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9296875 GB
    Memory Allocated: 0.4492049217224121  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9296875 GB
    Memory Allocated: 19.250152111053467  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.9296875 GB
    Memory Allocated: 19.250558853149414  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9296875 GB
    Memory Allocated: 0.4530830383300781  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9296875 GB
    Memory Allocated: 19.259031772613525  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.9296875 GB
    Memory Allocated: 19.259438514709473  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9296875 GB
    Memory Allocated: 0.45342397689819336  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9296875 GB
    Memory Allocated: 19.23885440826416  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.9296875 GB
    Memory Allocated: 19.239261150360107  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9296875 GB
    Memory Allocated: 0.4546961784362793  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.931640625 GB
    Memory Allocated: 19.190701961517334  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.931640625 GB
    Memory Allocated: 19.19110870361328  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.93359375 GB
    Memory Allocated: 0.45749902725219727  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.93359375 GB
    Memory Allocated: 19.28188133239746  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.93359375 GB
    Memory Allocated: 19.282288074493408  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.93359375 GB
    Memory Allocated: 0.4582633972167969  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.93359375 GB
    Memory Allocated: 19.277536869049072  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.93359375 GB
    Memory Allocated: 19.27794361114502  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9375 GB
    Memory Allocated: 0.4611539840698242  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9375 GB
    Memory Allocated: 19.307783126831055  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.9375 GB
    Memory Allocated: 19.308189868927002  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9375 GB
    Memory Allocated: 0.4628024101257324  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.939453125 GB
    Memory Allocated: 19.284977912902832  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.939453125 GB
    Memory Allocated: 19.28538465499878  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.4628310203552246  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 19.247802257537842  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 19.24820899963379  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.46366024017333984  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 19.21432638168335  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 19.214733123779297  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.46753549575805664  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 19.25608205795288  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 19.256488800048828  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.94140625 GB
    Memory Allocated: 0.46834850311279297  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.943359375 GB
    Memory Allocated: 19.258895874023438  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.943359375 GB
    Memory Allocated: 19.259302616119385  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9453125 GB
    Memory Allocated: 0.47113561630249023  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9453125 GB
    Memory Allocated: 19.27483320236206  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.9453125 GB
    Memory Allocated: 19.275239944458008  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.947265625 GB
    Memory Allocated: 0.47216033935546875  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.947265625 GB
    Memory Allocated: 19.25713062286377  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.947265625 GB
    Memory Allocated: 19.257537364959717  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.94921875 GB
    Memory Allocated: 0.47390031814575195  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.94921875 GB
    Memory Allocated: 19.202884197235107  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.94921875 GB
    Memory Allocated: 19.203290939331055  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.953125 GB
    Memory Allocated: 0.4747934341430664  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.953125 GB
    Memory Allocated: 19.23439884185791  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.953125 GB
    Memory Allocated: 19.234805583953857  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.953125 GB
    Memory Allocated: 0.4764976501464844  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.953125 GB
    Memory Allocated: 19.188066959381104  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.953125 GB
    Memory Allocated: 19.18847370147705  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.953125 GB
    Memory Allocated: 0.4799003601074219  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.95703125 GB
    Memory Allocated: 19.304808139801025  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.95703125 GB
    Memory Allocated: 19.305214881896973  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.958984375 GB
    Memory Allocated: 0.48189258575439453  GigaBytes
Max Memory Allocated: 20.61532497406006  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.958984375 GB
    Memory Allocated: 19.392963886260986  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.958984375 GB
    Memory Allocated: 19.393370628356934  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.958984375 GB
    Memory Allocated: 0.4820833206176758  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.958984375 GB
    Memory Allocated: 19.26921844482422  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.958984375 GB
    Memory Allocated: 19.269625186920166  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.958984375 GB
    Memory Allocated: 0.4844846725463867  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.958984375 GB
    Memory Allocated: 19.312397480010986  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.958984375 GB
    Memory Allocated: 19.312804222106934  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9609375 GB
    Memory Allocated: 0.48560047149658203  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.9609375 GB
    Memory Allocated: 19.21503448486328  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.9609375 GB
    Memory Allocated: 19.21544122695923  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96484375 GB
    Memory Allocated: 0.48700714111328125  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96484375 GB
    Memory Allocated: 19.279347896575928  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96484375 GB
    Memory Allocated: 19.279754638671875  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96484375 GB
    Memory Allocated: 0.48856592178344727  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96484375 GB
    Memory Allocated: 19.20033025741577  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96484375 GB
    Memory Allocated: 19.20073699951172  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96484375 GB
    Memory Allocated: 0.49020814895629883  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96484375 GB
    Memory Allocated: 19.160163402557373  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96484375 GB
    Memory Allocated: 19.160564422607422  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4953641891479492  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2960078716278076
pure train time :  17.636838912963867
train time :  40.704055070877075
end to end time :  80.65921878814697
connection check time:  24.118404150009155
block generation time  12.890394926071167
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3028, 3029, 3030]), tensor([3031, 3032, 3033,  ..., 6029, 6030, 6031]), tensor([6032, 6033, 6034,  ..., 9013, 9014, 9015]), tensor([ 9016,  9017,  9019,  ..., 12034, 12035, 12036]), tensor([12037, 12039, 12040,  ..., 15022, 15023, 15024]), tensor([15026, 15027, 15028,  ..., 18026, 18027, 18028]), tensor([18029, 18030, 18031,  ..., 21039, 21040, 21041]), tensor([21042, 21043, 21044,  ..., 24077, 24078, 24079]), tensor([24080, 24081, 24082,  ..., 27086, 27087, 27088]), tensor([27089, 27090, 27091,  ..., 30122, 30123, 30124]), tensor([30125, 30126, 30127,  ..., 33143, 33144, 33148]), tensor([33149, 33150, 33151,  ..., 36143, 36144, 36145]), tensor([36146, 36148, 36149,  ..., 39134, 39135, 39136]), tensor([39137, 39138, 39139,  ..., 42131, 42132, 42133]), tensor([42134, 42135, 42136,  ..., 45145, 45146, 45147]), tensor([45148, 45149, 45150,  ..., 48107, 48108, 48109]), tensor([48110, 48112, 48113,  ..., 51136, 51138, 51139]), tensor([51140, 51141, 51142,  ..., 54099, 54100, 54101]), tensor([54102, 54103, 54104,  ..., 57100, 57102, 57103]), tensor([57104, 57105, 57106,  ..., 60099, 60100, 60101]), tensor([60102, 60103, 60104,  ..., 63124, 63125, 63126]), tensor([63127, 63130, 63131,  ..., 66159, 66160, 66161]), tensor([66162, 66163, 66164,  ..., 69161, 69162, 69163]), tensor([69165, 69166, 69167,  ..., 72142, 72143, 72144]), tensor([72145, 72146, 72147,  ..., 75186, 75187, 75188]), tensor([75189, 75190, 75191,  ..., 78207, 78208, 78209]), tensor([78210, 78212, 78213,  ..., 81204, 81205, 81206]), tensor([81207, 81210, 81212,  ..., 84216, 84217, 84218]), tensor([84220, 84221, 84222,  ..., 87220, 87223, 87224]), tensor([87225, 87226, 87227,  ..., 90250, 90251, 90252]), tensor([90253, 90254, 90255,  ..., 93243, 93244, 93245]), tensor([93246, 93247, 93249,  ..., 96248, 96249, 96250]), tensor([96251, 96252, 96254,  ..., 99271, 99272, 99274]), tensor([ 99275,  99276,  99277,  ..., 102289, 102290, 102291]), tensor([102292, 102293, 102294,  ..., 105276, 105277, 105278]), tensor([105279, 105280, 105281,  ..., 108281, 108282, 108283]), tensor([108285, 108286, 108287,  ..., 111302, 111303, 111304]), tensor([111305, 111306, 111307,  ..., 114298, 114299, 114300]), tensor([114301, 114302, 114303,  ..., 117319, 117320, 117321]), tensor([117322, 117323, 117324,  ..., 120311, 120312, 120313]), tensor([120314, 120315, 120316,  ..., 123337, 123339, 123340]), tensor([123341, 123342, 123343,  ..., 126372, 126373, 126375]), tensor([126376, 126377, 126378,  ..., 129377, 129378, 129379]), tensor([129380, 129381, 129382,  ..., 132371, 132372, 132373]), tensor([132374, 132375, 132377,  ..., 135399, 135400, 135401]), tensor([135403, 135404, 135405,  ..., 138421, 138422, 138423]), tensor([138424, 138425, 138427,  ..., 141438, 141439, 141440]), tensor([141441, 141442, 141443,  ..., 144450, 144451, 144452]), tensor([144453, 144454, 144455,  ..., 147482, 147484, 147486]), tensor([147487, 147488, 147489,  ..., 150492, 150493, 150494]), tensor([150495, 150496, 150497,  ..., 153426, 153427, 153429])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4682424068450928
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.00038242340087890625
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021620512008666992
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48813629150390625
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.951083183288574
self.buckets_partition() spend  sec:  0.5097825527191162
check connections block*********************************

the find indices time spent  0.07869696617126465

in edges time spent  0.7207145690917969
local to global src and eids time spent  1.7786262035369873
time gen tails  0.39234375953674316
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.225295066833496

----------------------------------------
check connections block*********************************

the find indices time spent  0.8671467304229736

in edges time spent  5.402325630187988
local to global src and eids time spent  10.059430122375488
time gen tails  1.6107113361358643
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.495970726013184

block collection to dataloader spend  8.249282836914062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4079303741455078  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.199278831481934  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.198020458221436  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.40817928314208984  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.212748527526855  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.213155269622803  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4105525016784668  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.246016025543213  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.24642276763916  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4114036560058594  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.2074236869812  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.20783042907715  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.414642333984375  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.29951000213623  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.299916744232178  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.41523170471191406  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.23006010055542  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.230466842651367  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4163784980773926  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.163459300994873  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.16386604309082  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4189324378967285  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.234342098236084  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.23474884033203  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.42093420028686523  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.21945571899414  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.219862461090088  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4214768409729004  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.205187797546387  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.205594539642334  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.42249011993408203  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.145365238189697  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.145771980285645  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4249563217163086  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.2201566696167  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.220563411712646  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.42723941802978516  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.28126621246338  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.281672954559326  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4295945167541504  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.246830940246582  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.24723768234253  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4300270080566406  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.213987350463867  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.214394092559814  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4305300712585449  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.14460849761963  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.145015239715576  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.43343400955200195  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.22443675994873  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.224843502044678  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.43687963485717773  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.252960205078125  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.253366947174072  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4376487731933594  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.240478038787842  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.24088478088379  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.43840599060058594  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.23328971862793  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.233696460723877  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.44075679779052734  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.19467544555664  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.195082187652588  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4428257942199707  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.233388900756836  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.233795642852783  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4437727928161621  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.282029628753662  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.28243637084961  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.44505929946899414  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.19740581512451  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.19781255722046  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4478321075439453  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.26955223083496  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.269958972930908  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4485659599304199  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.247889518737793  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.24829626083374  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4506869316101074  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.26374578475952  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.26415252685547  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.45200204849243164  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.193310737609863  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.19371747970581  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.45337820053100586  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.342718601226807  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.343125343322754  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.45583486557006836  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.274503707885742  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.27491044998169  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.45917797088623047  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.356082439422607  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.356489181518555  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4600858688354492  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.257511138916016  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.257917881011963  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4606480598449707  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.302550792694092  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.30295753479004  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.46213197708129883  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.290157794952393  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.29056453704834  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.46548032760620117  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.35444688796997  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.354853630065918  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4651041030883789  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.268422603607178  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.268829345703125  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4677748680114746  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.205979347229004  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.20638608932495  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4698796272277832  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.26234483718872  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.262751579284668  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4714541435241699  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.257604122161865  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.258010864257812  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.47327518463134766  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.298367500305176  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.298774242401123  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4742579460144043  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.3092942237854  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.309700965881348  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.47622108459472656  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.300787925720215  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.301194667816162  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4789614677429199  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.329501152038574  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.32990789413452  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.47840404510498047  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.263963222503662  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.26436996459961  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4816274642944336  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.30304479598999  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.303451538085938  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4822111129760742  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.267563819885254  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.2679705619812  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4837522506713867  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.294875621795654  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.2952823638916  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4864959716796875  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.291554927825928  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.291961669921875  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.4876985549926758  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.27153491973877  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.271941661834717  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.48899126052856445  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.27372169494629  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 19.274128437042236  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4907417297363281  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.125792026519775  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.126193046569824  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.49589014053344727  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3059322834014893
pure train time :  17.350931882858276
train time :  40.646995544433594
end to end time :  81.67430758476257
connection check time:  24.311450004577637
block generation time  13.72126579284668
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3001, 3002, 3003]), tensor([3004, 3006, 3007,  ..., 6025, 6026, 6029]), tensor([6030, 6031, 6032,  ..., 9051, 9052, 9054]), tensor([ 9055,  9056,  9057,  ..., 12053, 12054, 12055]), tensor([12056, 12057, 12058,  ..., 15072, 15073, 15074]), tensor([15076, 15077, 15078,  ..., 18117, 18118, 18120]), tensor([18121, 18122, 18124,  ..., 21128, 21129, 21130]), tensor([21131, 21132, 21133,  ..., 24152, 24153, 24154]), tensor([24155, 24156, 24157,  ..., 27180, 27181, 27182]), tensor([27183, 27184, 27185,  ..., 30166, 30167, 30168]), tensor([30169, 30170, 30171,  ..., 33160, 33162, 33163]), tensor([33164, 33165, 33166,  ..., 36206, 36207, 36209]), tensor([36211, 36212, 36213,  ..., 39201, 39202, 39203]), tensor([39204, 39205, 39206,  ..., 42190, 42191, 42192]), tensor([42193, 42194, 42196,  ..., 45238, 45239, 45240]), tensor([45241, 45242, 45243,  ..., 48258, 48259, 48260]), tensor([48261, 48262, 48263,  ..., 51249, 51250, 51251]), tensor([51253, 51254, 51255,  ..., 54269, 54270, 54272]), tensor([54273, 54274, 54275,  ..., 57233, 57234, 57235]), tensor([57236, 57239, 57240,  ..., 60227, 60228, 60229]), tensor([60230, 60231, 60232,  ..., 63242, 63243, 63244]), tensor([63245, 63246, 63247,  ..., 66252, 66253, 66255]), tensor([66257, 66258, 66259,  ..., 69257, 69258, 69260]), tensor([69261, 69262, 69263,  ..., 72269, 72270, 72271]), tensor([72273, 72274, 72275,  ..., 75321, 75322, 75325]), tensor([75326, 75327, 75328,  ..., 78354, 78355, 78357]), tensor([78358, 78359, 78360,  ..., 81343, 81344, 81345]), tensor([81346, 81347, 81348,  ..., 84357, 84358, 84359]), tensor([84360, 84361, 84362,  ..., 87355, 87356, 87357]), tensor([87359, 87360, 87361,  ..., 90375, 90376, 90377]), tensor([90378, 90379, 90380,  ..., 93394, 93395, 93396]), tensor([93397, 93398, 93399,  ..., 96380, 96381, 96383]), tensor([96384, 96385, 96386,  ..., 99397, 99398, 99399]), tensor([ 99400,  99401,  99402,  ..., 102389, 102390, 102392]), tensor([102394, 102395, 102396,  ..., 105409, 105410, 105411]), tensor([105412, 105414, 105415,  ..., 108394, 108395, 108396]), tensor([108397, 108398, 108399,  ..., 111385, 111386, 111387]), tensor([111388, 111389, 111390,  ..., 114390, 114392, 114393]), tensor([114394, 114395, 114396,  ..., 117410, 117411, 117412]), tensor([117413, 117414, 117416,  ..., 120473, 120474, 120475]), tensor([120477, 120478, 120479,  ..., 123519, 123520, 123521]), tensor([123522, 123524, 123525,  ..., 126532, 126534, 126536]), tensor([126537, 126538, 126539,  ..., 129500, 129501, 129502]), tensor([129504, 129505, 129506,  ..., 132477, 132478, 132480]), tensor([132481, 132482, 132483,  ..., 135479, 135480, 135481]), tensor([135482, 135483, 135484,  ..., 138426, 138428, 138429]), tensor([138430, 138431, 138432,  ..., 141412, 141413, 141414]), tensor([141415, 141416, 141417,  ..., 144418, 144419, 144420]), tensor([144421, 144422, 144423,  ..., 147407, 147408, 147410]), tensor([147411, 147412, 147413,  ..., 150450, 150451, 150452]), tensor([150453, 150454, 150455,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4947657585144043
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0005037784576416016
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02149200439453125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5027971267700195
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.886248826980591
self.buckets_partition() spend  sec:  0.524320125579834
check connections block*********************************

the find indices time spent  0.07274627685546875

in edges time spent  0.6785333156585693
local to global src and eids time spent  1.6513044834136963
time gen tails  0.36809277534484863
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.2528316974639893

----------------------------------------
check connections block*********************************

the find indices time spent  0.8303229808807373

in edges time spent  6.171299934387207
local to global src and eids time spent  8.736742973327637
time gen tails  1.5765511989593506
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.126724004745483

block collection to dataloader spend  8.678436279296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.40776968002319336  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.200448036193848  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.199190139770508  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4092411994934082  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.300217628479004  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.30062437057495  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.41034364700317383  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.167139053344727  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.167545795440674  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.411649227142334  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.22096014022827  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.22136688232422  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4125986099243164  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.218083381652832  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.21849012374878  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.41602659225463867  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.236419677734375  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.236826419830322  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.41654253005981445  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.171345233917236  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.171751976013184  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4179816246032715  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.221060276031494  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.22146701812744  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4217562675476074  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.24314546585083  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.243552207946777  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.42109060287475586  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.221052646636963  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.22145938873291  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4248924255371094  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.309391498565674  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.30979824066162  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.42578697204589844  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.17518377304077  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.17559051513672  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.42491912841796875  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.165302753448486  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.165709495544434  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.428255558013916  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.223078727722168  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.223485469818115  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4303741455078125  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.218220710754395  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.218627452850342  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.43259382247924805  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.32744312286377  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.327849864959717  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.43335819244384766  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.222442150115967  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.222848892211914  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.43398141860961914  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.18620252609253  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.186609268188477  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4380640983581543  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.325287342071533  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.32569408416748  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.43941307067871094  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.249197959899902  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.24960470199585  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.44203662872314453  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.33119821548462  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.331604957580566  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.44263410568237305  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.270840644836426  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.271247386932373  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.44388580322265625  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.329142570495605  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.329549312591553  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4465651512145996  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.29696798324585  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.297374725341797  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.44608259201049805  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.23295021057129  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.233356952667236  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4498448371887207  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.34250259399414  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.342909336090088  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.44937562942504883  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.148680210113525  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.149086952209473  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4521903991699219  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.26330280303955  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.263709545135498  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.45316410064697266  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.243430137634277  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.243836879730225  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.45581960678100586  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.240292072296143  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.24069881439209  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.45792102813720703  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.28993797302246  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.290344715118408  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4575352668762207  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.19175672531128  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.192163467407227  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4601116180419922  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.1950101852417  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.195416927337646  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.46278953552246094  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.35032367706299  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.350730419158936  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.46392154693603516  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.258009433746338  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.258416175842285  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.46545886993408203  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.350183486938477  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.350590229034424  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4665226936340332  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.199925422668457  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.200332164764404  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4678840637207031  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.21229839324951  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.21270513534546  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4703969955444336  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.209739685058594  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.21014642715454  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.47278356552124023  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.317537784576416  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.317944526672363  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4732027053833008  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.264458656311035  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.264865398406982  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4764695167541504  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.379623889923096  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.380030632019043  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.47829627990722656  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.308300495147705  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.308707237243652  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4791107177734375  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.31895351409912  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.31936025619507  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4807262420654297  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.269644737243652  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.2700514793396  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4824380874633789  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.23978900909424  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.240195751190186  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4840097427368164  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.27204179763794  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.272448539733887  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4849739074707031  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.301734447479248  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.302141189575195  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.48798179626464844  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.27409076690674  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.274497509002686  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4895949363708496  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.330323219299316  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.330729961395264  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.48885154724121094  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.022316932678223  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.02271795272827  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.49397993087768555  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.8056386709213257
pure train time :  17.42736506462097
train time :  40.471152782440186
end to end time :  80.80327844619751
connection check time:  23.010464429855347
block generation time  14.379555702209473
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3007, 3008, 3009]), tensor([3010, 3012, 3013,  ..., 5996, 5998, 5999]), tensor([6000, 6001, 6002,  ..., 9022, 9023, 9025]), tensor([ 9026,  9028,  9029,  ..., 12015, 12016, 12017]), tensor([12018, 12019, 12020,  ..., 15003, 15004, 15005]), tensor([15006, 15007, 15008,  ..., 18041, 18042, 18043]), tensor([18044, 18045, 18046,  ..., 21061, 21062, 21063]), tensor([21064, 21066, 21067,  ..., 24080, 24081, 24082]), tensor([24084, 24085, 24086,  ..., 27102, 27103, 27104]), tensor([27105, 27106, 27107,  ..., 30122, 30123, 30124]), tensor([30125, 30126, 30127,  ..., 33113, 33114, 33116]), tensor([33117, 33118, 33119,  ..., 36150, 36151, 36152]), tensor([36153, 36154, 36155,  ..., 39124, 39126, 39127]), tensor([39129, 39130, 39131,  ..., 42168, 42169, 42171]), tensor([42172, 42174, 42176,  ..., 45173, 45174, 45175]), tensor([45176, 45177, 45178,  ..., 48204, 48206, 48207]), tensor([48208, 48209, 48211,  ..., 51199, 51200, 51201]), tensor([51202, 51203, 51204,  ..., 54161, 54162, 54163]), tensor([54164, 54165, 54166,  ..., 57161, 57162, 57163]), tensor([57164, 57165, 57166,  ..., 60182, 60183, 60184]), tensor([60185, 60186, 60188,  ..., 63198, 63199, 63200]), tensor([63201, 63202, 63203,  ..., 66205, 66207, 66209]), tensor([66210, 66211, 66212,  ..., 69219, 69220, 69221]), tensor([69223, 69224, 69225,  ..., 72244, 72245, 72246]), tensor([72248, 72249, 72250,  ..., 75250, 75251, 75252]), tensor([75253, 75254, 75255,  ..., 78263, 78264, 78265]), tensor([78267, 78268, 78269,  ..., 81271, 81272, 81273]), tensor([81274, 81275, 81276,  ..., 84290, 84291, 84292]), tensor([84293, 84294, 84295,  ..., 87328, 87329, 87330]), tensor([87331, 87332, 87334,  ..., 90334, 90335, 90336]), tensor([90338, 90339, 90340,  ..., 93358, 93359, 93360]), tensor([93361, 93362, 93363,  ..., 96357, 96358, 96360]), tensor([96361, 96363, 96365,  ..., 99405, 99406, 99407]), tensor([ 99410,  99411,  99412,  ..., 102363, 102364, 102365]), tensor([102366, 102368, 102369,  ..., 105365, 105366, 105368]), tensor([105369, 105370, 105371,  ..., 108350, 108351, 108352]), tensor([108353, 108354, 108355,  ..., 111360, 111361, 111362]), tensor([111363, 111364, 111365,  ..., 114366, 114368, 114369]), tensor([114370, 114371, 114372,  ..., 117348, 117349, 117350]), tensor([117351, 117352, 117353,  ..., 120355, 120356, 120357]), tensor([120358, 120359, 120360,  ..., 123333, 123334, 123336]), tensor([123338, 123339, 123340,  ..., 126354, 126356, 126357]), tensor([126359, 126360, 126361,  ..., 129383, 129385, 129386]), tensor([129387, 129388, 129389,  ..., 132393, 132394, 132395]), tensor([132396, 132397, 132398,  ..., 135388, 135389, 135390]), tensor([135392, 135393, 135396,  ..., 138427, 138428, 138429]), tensor([138431, 138432, 138433,  ..., 141450, 141451, 141452]), tensor([141453, 141454, 141456,  ..., 144472, 144473, 144474]), tensor([144475, 144476, 144477,  ..., 147497, 147498, 147501]), tensor([147502, 147503, 147504,  ..., 150499, 150500, 150501]), tensor([150505, 150507, 150509,  ..., 153427, 153428, 153429])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4762156009674072
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0005066394805908203
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023901700973510742
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4825470447540283
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.6407973766326904
self.buckets_partition() spend  sec:  0.5064804553985596
check connections block*********************************

the find indices time spent  0.08011698722839355

in edges time spent  0.697129487991333
local to global src and eids time spent  2.156099557876587
time gen tails  0.3863029479980469
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.244272232055664

----------------------------------------
check connections block*********************************

the find indices time spent  0.8435754776000977

in edges time spent  6.026610374450684
local to global src and eids time spent  9.969444036483765
time gen tails  1.6266725063323975
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.589162111282349

block collection to dataloader spend  9.369850158691406e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4102616310119629  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.29439687728882  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.293139934539795  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4086875915527344  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.255375862121582  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.25578260421753  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4104118347167969  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.2108097076416  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.21121644973755  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.41240549087524414  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.270390510559082  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.27079725265503  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4145975112915039  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.33497905731201  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.33538579940796  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4163846969604492  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.263399124145508  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.263805866241455  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.41706037521362305  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.21990442276001  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.220311164855957  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.41771888732910156  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.2350492477417  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.235455989837646  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4222745895385742  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.308276653289795  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.308683395385742  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.42223215103149414  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.21283721923828  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.21324396133423  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4234042167663574  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.150126457214355  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.150533199310303  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4256601333618164  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.231950283050537  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.232357025146484  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.42705202102661133  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.239120483398438  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.239527225494385  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.42853879928588867  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.215989112854004  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.21639585494995  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.43027496337890625  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.238025188446045  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.238431930541992  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4327692985534668  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.33442783355713  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.334834575653076  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4348487854003906  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.246580123901367  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.246986865997314  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.43602705001831055  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.227231979370117  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.227638721466064  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.43705177307128906  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.147826194763184  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.14823293685913  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.439150333404541  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.25054407119751  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.250950813293457  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4411311149597168  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.15233612060547  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.152742862701416  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.44237565994262695  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.285391807556152  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.2857985496521  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.44411754608154297  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.330210208892822  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.33061695098877  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4457879066467285  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.271751880645752  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.2721586227417  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4482913017272949  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.33327627182007  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.333683013916016  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4477105140686035  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.186250686645508  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.186657428741455  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4507870674133301  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.2703800201416  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.27078676223755  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.45261430740356445  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.280076026916504  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.28048276901245  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4534592628479004  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.26044464111328  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.26085138320923  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4564476013183594  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.3072509765625  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.307657718658447  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.456510066986084  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.197685718536377  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.198092460632324  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4589705467224121  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.25589084625244  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.25629758834839  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4608297348022461  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.21240472793579  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.21281147003174  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4628868103027344  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.28760576248169  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.288012504577637  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4647941589355469  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.314289093017578  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.314695835113525  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4665236473083496  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.365156650543213  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.36556339263916  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4664754867553711  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.24891233444214  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.249319076538086  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4691734313964844  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.253713130950928  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.254119873046875  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4725055694580078  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.371978282928467  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.372385025024414  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.47190427780151367  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.171066761016846  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.171473503112793  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.474423885345459  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.292181491851807  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.292588233947754  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.47681522369384766  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.261569023132324  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.26197576522827  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4773702621459961  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.214239597320557  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.214646339416504  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.47940778732299805  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.27194118499756  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.272347927093506  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.48057031631469727  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.28144645690918  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.281853199005127  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4828453063964844  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.306836128234863  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.30724287033081  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4843015670776367  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.269005298614502  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.26941204071045  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.48557567596435547  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.28670883178711  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.287115573883057  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4888787269592285  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.3121018409729  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.312508583068848  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 0.4902520179748535  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.287970542907715  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.96875 GB
    Memory Allocated: 19.288377285003662  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.48894405364990234  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 18.987489223480225  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 18.987890243530273  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4940629005432129  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5132725238800049
pure train time :  17.27213191986084
train time :  40.65545105934143
end to end time :  82.41211652755737
connection check time:  25.23809838294983
block generation time  13.833434343338013
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   1,    2,    3,  ..., 3022, 3023, 3024]), tensor([3025, 3026, 3027,  ..., 6057, 6058, 6059]), tensor([6060, 6061, 6062,  ..., 9048, 9049, 9050]), tensor([ 9051,  9052,  9053,  ..., 12073, 12074, 12075]), tensor([12076, 12077, 12078,  ..., 15082, 15083, 15084]), tensor([15085, 15086, 15087,  ..., 18066, 18067, 18068]), tensor([18069, 18070, 18071,  ..., 21055, 21056, 21057]), tensor([21058, 21060, 21061,  ..., 24064, 24065, 24066]), tensor([24067, 24068, 24069,  ..., 27069, 27070, 27071]), tensor([27072, 27073, 27074,  ..., 30085, 30086, 30087]), tensor([30088, 30089, 30090,  ..., 33082, 33083, 33084]), tensor([33085, 33086, 33087,  ..., 36032, 36033, 36034]), tensor([36036, 36037, 36041,  ..., 39043, 39044, 39045]), tensor([39046, 39047, 39048,  ..., 42072, 42073, 42074]), tensor([42075, 42076, 42077,  ..., 45084, 45085, 45086]), tensor([45089, 45090, 45091,  ..., 48084, 48087, 48088]), tensor([48089, 48090, 48091,  ..., 51070, 51071, 51072]), tensor([51073, 51074, 51075,  ..., 54088, 54090, 54093]), tensor([54094, 54095, 54096,  ..., 57067, 57068, 57069]), tensor([57070, 57071, 57072,  ..., 60069, 60070, 60071]), tensor([60072, 60073, 60074,  ..., 63082, 63083, 63084]), tensor([63085, 63086, 63088,  ..., 66115, 66116, 66117]), tensor([66118, 66119, 66120,  ..., 69138, 69139, 69140]), tensor([69141, 69142, 69143,  ..., 72138, 72139, 72140]), tensor([72141, 72142, 72143,  ..., 75125, 75126, 75127]), tensor([75128, 75129, 75130,  ..., 78140, 78141, 78142]), tensor([78143, 78144, 78145,  ..., 81157, 81158, 81159]), tensor([81161, 81162, 81163,  ..., 84153, 84156, 84157]), tensor([84158, 84160, 84161,  ..., 87162, 87163, 87165]), tensor([87166, 87167, 87168,  ..., 90165, 90166, 90167]), tensor([90168, 90169, 90170,  ..., 93170, 93171, 93172]), tensor([93173, 93174, 93175,  ..., 96209, 96210, 96212]), tensor([96213, 96215, 96216,  ..., 99232, 99233, 99234]), tensor([ 99235,  99236,  99237,  ..., 102254, 102256, 102257]), tensor([102258, 102259, 102260,  ..., 105252, 105253, 105254]), tensor([105256, 105257, 105260,  ..., 108246, 108248, 108249]), tensor([108250, 108251, 108252,  ..., 111255, 111256, 111257]), tensor([111258, 111259, 111260,  ..., 114253, 114254, 114255]), tensor([114256, 114257, 114258,  ..., 117283, 117285, 117286]), tensor([117287, 117288, 117289,  ..., 120339, 120341, 120342]), tensor([120344, 120345, 120347,  ..., 123321, 123322, 123323]), tensor([123324, 123326, 123327,  ..., 126320, 126321, 126322]), tensor([126323, 126324, 126325,  ..., 129312, 129313, 129314]), tensor([129315, 129316, 129317,  ..., 132350, 132351, 132352]), tensor([132353, 132354, 132355,  ..., 135356, 135357, 135358]), tensor([135359, 135360, 135361,  ..., 138378, 138379, 138380]), tensor([138382, 138383, 138384,  ..., 141403, 141404, 141405]), tensor([141406, 141407, 141408,  ..., 144432, 144433, 144434]), tensor([144435, 144436, 144437,  ..., 147466, 147467, 147468]), tensor([147469, 147470, 147471,  ..., 150485, 150486, 150487]), tensor([150488, 150489, 150491,  ..., 153427, 153428, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.49472665786743164
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0005044937133789062
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.022019386291503906
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5028989315032959
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.8810203075408936
self.buckets_partition() spend  sec:  0.5249478816986084
check connections block*********************************

the find indices time spent  0.06863069534301758

in edges time spent  0.6638631820678711
local to global src and eids time spent  1.567237138748169
time gen tails  0.382352352142334
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.243779182434082

----------------------------------------
check connections block*********************************

the find indices time spent  0.8142595291137695

in edges time spent  6.0530195236206055
local to global src and eids time spent  9.09383249282837
time gen tails  1.5830788612365723
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.40474534034729

block collection to dataloader spend  9.083747863769531e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4076414108276367  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.197592735290527  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.196336269378662  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.40986061096191406  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.196977615356445  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.197384357452393  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.409299373626709  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.223918437957764  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.22432518005371  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.41077756881713867  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.153255462646484  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.15366220474243  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.41351938247680664  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.206137657165527  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.206544399261475  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.414825439453125  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.209892749786377  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.210299491882324  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.41572046279907227  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.1571626663208  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.157569408416748  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4182138442993164  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.25492572784424  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.255332469940186  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.419435977935791  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.217644691467285  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.218051433563232  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4215059280395508  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.22921848297119  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.22962522506714  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4235258102416992  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.17371654510498  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.174123287200928  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4260997772216797  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.245851039886475  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.246257781982422  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.42716407775878906  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.263254642486572  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.26366138458252  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.42865800857543945  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.21351718902588  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.213923931121826  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4305000305175781  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.26697587966919  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.267382621765137  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4333829879760742  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.288434982299805  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.288841724395752  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.43445444107055664  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.325636386871338  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.326043128967285  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4348483085632324  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.18915605545044  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.189562797546387  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.43637657165527344  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.22025156021118  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.22065830230713  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.43763160705566406  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.23447322845459  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.234879970550537  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4424571990966797  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.33682870864868  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.33723545074463  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.44183778762817383  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.29477548599243  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.29518222808838  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.44418811798095703  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.326465129852295  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.326871871948242  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.44465065002441406  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.148229598999023  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.14863634109497  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.44635915756225586  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.236233711242676  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.236640453338623  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.44832515716552734  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.257773399353027  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.258180141448975  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4503931999206543  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.204182624816895  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.204589366912842  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4521455764770508  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.274715423583984  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.27512216567993  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.45406198501586914  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.29991626739502  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.300323009490967  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4553232192993164  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.284119606018066  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.284526348114014  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.45790529251098633  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.373359203338623  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.37376594543457  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.45876026153564453  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.305278778076172  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.30568552017212  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4607563018798828  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.282492637634277  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.282899379730225  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.46146535873413086  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.200392246246338  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.200798988342285  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.463376522064209  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.24857759475708  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.248984336853027  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4652528762817383  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.212280750274658  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.212687492370605  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.46869754791259766  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.354554653167725  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.354961395263672  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.46967363357543945  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.297014236450195  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.297420978546143  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4703969955444336  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.279973030090332  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.28037977218628  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4732332229614258  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.284232139587402  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.28463888168335  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.47240495681762695  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.267956256866455  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.268362998962402  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4766230583190918  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.321669578552246  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.322076320648193  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4785943031311035  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.365580081939697  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.365986824035645  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4789295196533203  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.21549940109253  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.215906143188477  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4817647933959961  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.311241149902344  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.31164789199829  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4830141067504883  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.369492530822754  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.3698992729187  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4840841293334961  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.296555519104004  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.29696226119995  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.48464441299438477  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.162675857543945  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.163082599639893  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.48828744888305664  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.330533504486084  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.33094024658203  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4889559745788574  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.23856258392334  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.238969326019287  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4896278381347656  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.077543258666992  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.07794427871704  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4947667121887207  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.274516224861145
pure train time :  17.072305917739868
train time :  40.74644231796265
end to end time :  80.92845058441162
connection check time:  23.605265855789185
block generation time  13.648524522781372
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2983, 2984, 2985]), tensor([2986, 2987, 2988,  ..., 5991, 5992, 5993]), tensor([5994, 5995, 5996,  ..., 8991, 8992, 8993]), tensor([ 8994,  8995,  8996,  ..., 12004, 12005, 12006]), tensor([12008, 12009, 12010,  ..., 15009, 15010, 15011]), tensor([15012, 15013, 15014,  ..., 17977, 17978, 17979]), tensor([17980, 17981, 17982,  ..., 20959, 20960, 20962]), tensor([20963, 20964, 20965,  ..., 23997, 23998, 23999]), tensor([24000, 24001, 24002,  ..., 27043, 27045, 27046]), tensor([27047, 27048, 27049,  ..., 30060, 30061, 30062]), tensor([30063, 30064, 30065,  ..., 33109, 33110, 33111]), tensor([33112, 33113, 33114,  ..., 36124, 36125, 36126]), tensor([36127, 36128, 36129,  ..., 39155, 39156, 39157]), tensor([39158, 39159, 39160,  ..., 42177, 42178, 42179]), tensor([42180, 42181, 42182,  ..., 45180, 45181, 45182]), tensor([45183, 45185, 45186,  ..., 48173, 48174, 48175]), tensor([48176, 48177, 48178,  ..., 51151, 51152, 51154]), tensor([51155, 51157, 51158,  ..., 54169, 54170, 54171]), tensor([54172, 54173, 54174,  ..., 57192, 57193, 57195]), tensor([57196, 57197, 57198,  ..., 60180, 60181, 60182]), tensor([60183, 60184, 60186,  ..., 63160, 63161, 63162]), tensor([63163, 63164, 63165,  ..., 66181, 66182, 66183]), tensor([66184, 66185, 66186,  ..., 69203, 69204, 69205]), tensor([69207, 69208, 69209,  ..., 72210, 72211, 72214]), tensor([72215, 72216, 72217,  ..., 75245, 75246, 75247]), tensor([75248, 75249, 75251,  ..., 78240, 78241, 78242]), tensor([78243, 78244, 78246,  ..., 81204, 81205, 81206]), tensor([81207, 81208, 81209,  ..., 84213, 84214, 84216]), tensor([84217, 84218, 84219,  ..., 87197, 87199, 87200]), tensor([87201, 87202, 87203,  ..., 90238, 90239, 90240]), tensor([90242, 90243, 90244,  ..., 93259, 93260, 93261]), tensor([93262, 93263, 93264,  ..., 96284, 96285, 96286]), tensor([96287, 96288, 96289,  ..., 99283, 99284, 99286]), tensor([ 99287,  99288,  99289,  ..., 102324, 102325, 102326]), tensor([102327, 102329, 102330,  ..., 105330, 105331, 105332]), tensor([105333, 105334, 105335,  ..., 108382, 108383, 108385]), tensor([108386, 108387, 108388,  ..., 111409, 111410, 111413]), tensor([111414, 111415, 111416,  ..., 114424, 114425, 114426]), tensor([114429, 114431, 114432,  ..., 117430, 117431, 117433]), tensor([117434, 117435, 117436,  ..., 120437, 120438, 120439]), tensor([120440, 120441, 120442,  ..., 123411, 123412, 123413]), tensor([123414, 123415, 123416,  ..., 126415, 126416, 126417]), tensor([126418, 126421, 126422,  ..., 129395, 129396, 129397]), tensor([129398, 129399, 129400,  ..., 132385, 132387, 132389]), tensor([132390, 132391, 132392,  ..., 135410, 135411, 135412]), tensor([135414, 135415, 135416,  ..., 138437, 138438, 138439]), tensor([138440, 138443, 138444,  ..., 141433, 141434, 141435]), tensor([141436, 141437, 141438,  ..., 144441, 144443, 144444]), tensor([144445, 144446, 144447,  ..., 147439, 147440, 147441]), tensor([147442, 147443, 147445,  ..., 150434, 150435, 150437]), tensor([150438, 150439, 150440,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.49509572982788086
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004875659942626953
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02426314353942871
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5031256675720215
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.379608392715454
self.buckets_partition() spend  sec:  0.5274262428283691
check connections block*********************************

the find indices time spent  0.07068204879760742

in edges time spent  0.49077844619750977
local to global src and eids time spent  1.176525592803955
time gen tails  0.35549187660217285
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.2474112510681152

----------------------------------------
check connections block*********************************

the find indices time spent  0.8161697387695312

in edges time spent  4.794090986251831
local to global src and eids time spent  8.1990487575531
time gen tails  1.5895023345947266
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.585487842559814

block collection to dataloader spend  9.012222290039062e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4077324867248535  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.196706295013428  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.195448875427246  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4081554412841797  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.30774974822998  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.308156490325928  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4093146324157715  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.248205184936523  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.24861192703247  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.41196298599243164  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.20701837539673  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.207425117492676  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.41374921798706055  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.301318645477295  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.301725387573242  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4142913818359375  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.244994163513184  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.24540090560913  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.41637277603149414  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.20134449005127  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.201751232147217  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4180445671081543  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.151550769805908  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.151957511901855  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.41997241973876953  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.30476188659668  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.305168628692627  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4227581024169922  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.22003746032715  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.220444202423096  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4241042137145996  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.218031883239746  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.218438625335693  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.42528200149536133  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.264638900756836  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.265045642852783  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.42557382583618164  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.222463607788086  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.222870349884033  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.42902517318725586  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.280852794647217  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.281259536743164  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4294261932373047  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.263673305511475  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.264080047607422  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4332108497619629  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.27303695678711  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.273443698883057  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.43364858627319336  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.280137062072754  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.2805438041687  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.43561315536499023  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.236534118652344  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.23694086074829  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.43752622604370117  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.24387788772583  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.244284629821777  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4393730163574219  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.32584857940674  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.326255321502686  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.44059324264526367  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.26483392715454  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.26524066925049  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4412522315979004  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.18070077896118  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.18110752105713  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4434080123901367  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.24650287628174  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.246909618377686  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.44478368759155273  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.227439403533936  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.227846145629883  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.44629573822021484  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.13835620880127  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.138762950897217  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4486961364746094  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.262588024139404  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.26299476623535  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.45071983337402344  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.199585437774658  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.199992179870605  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.45171499252319336  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.1630539894104  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.163460731506348  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4533958435058594  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.262810707092285  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.263217449188232  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.45479726791381836  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.29870319366455  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.299109935760498  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4569535255432129  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.247899532318115  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.248306274414062  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.45821428298950195  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.20744752883911  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.20785427093506  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.46054601669311523  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.241276741027832  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.24168348312378  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4611935615539551  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.207183837890625  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.207590579986572  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.46454620361328125  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.365739345550537  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.366146087646484  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4647102355957031  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.2161283493042  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.216535091400146  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.46872806549072266  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.35994291305542  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.360349655151367  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.46962499618530273  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.358511924743652  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.3589186668396  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.47153472900390625  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.35220432281494  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.35261106491089  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4719557762145996  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.22079038619995  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.2211971282959  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.47565269470214844  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.361554622650146  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.361961364746094  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4748349189758301  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.265625953674316  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.266032695770264  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.47751617431640625  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.290741443634033  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.29114818572998  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.47940969467163086  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.290391445159912  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.29079818725586  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.48123931884765625  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.329204559326172  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.32961130142212  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4834413528442383  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.224770069122314  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.22517681121826  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.48453378677368164  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.296181201934814  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.29658794403076  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.48490428924560547  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.294764041900635  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.295170783996582  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.48708105087280273  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.199687480926514  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.20009422302246  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4892411231994629  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.24437141418457  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.244778156280518  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4887857437133789  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.102668285369873  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.103069305419922  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4939274787902832  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0765032768249512
pure train time :  17.439691305160522
train time :  40.799583435058594
end to end time :  77.9136962890625
connection check time:  20.854203939437866
block generation time  13.83289909362793
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2987, 2990, 2991]), tensor([2992, 2993, 2994,  ..., 6021, 6022, 6023]), tensor([6024, 6025, 6026,  ..., 9023, 9024, 9025]), tensor([ 9026,  9027,  9028,  ..., 12073, 12075, 12076]), tensor([12077, 12078, 12079,  ..., 15093, 15094, 15095]), tensor([15096, 15097, 15098,  ..., 18109, 18110, 18111]), tensor([18112, 18113, 18114,  ..., 21125, 21126, 21127]), tensor([21128, 21129, 21130,  ..., 24138, 24139, 24140]), tensor([24141, 24142, 24143,  ..., 27167, 27168, 27169]), tensor([27170, 27171, 27172,  ..., 30185, 30186, 30187]), tensor([30188, 30192, 30194,  ..., 33183, 33184, 33185]), tensor([33186, 33187, 33188,  ..., 36194, 36195, 36196]), tensor([36197, 36198, 36200,  ..., 39218, 39219, 39220]), tensor([39221, 39222, 39223,  ..., 42217, 42220, 42221]), tensor([42222, 42224, 42225,  ..., 45232, 45233, 45234]), tensor([45235, 45236, 45237,  ..., 48236, 48237, 48238]), tensor([48239, 48241, 48242,  ..., 51269, 51271, 51272]), tensor([51273, 51274, 51275,  ..., 54275, 54276, 54277]), tensor([54278, 54279, 54280,  ..., 57281, 57282, 57283]), tensor([57285, 57286, 57287,  ..., 60304, 60305, 60306]), tensor([60307, 60309, 60310,  ..., 63328, 63329, 63331]), tensor([63332, 63333, 63336,  ..., 66309, 66310, 66311]), tensor([66312, 66314, 66315,  ..., 69314, 69315, 69316]), tensor([69318, 69319, 69320,  ..., 72322, 72323, 72324]), tensor([72325, 72326, 72327,  ..., 75319, 75320, 75321]), tensor([75322, 75323, 75325,  ..., 78347, 78349, 78350]), tensor([78351, 78352, 78353,  ..., 81373, 81374, 81375]), tensor([81378, 81380, 81381,  ..., 84403, 84404, 84405]), tensor([84406, 84407, 84408,  ..., 87413, 87414, 87415]), tensor([87416, 87418, 87419,  ..., 90412, 90413, 90414]), tensor([90415, 90416, 90417,  ..., 93413, 93414, 93415]), tensor([93416, 93417, 93418,  ..., 96427, 96428, 96429]), tensor([96431, 96432, 96433,  ..., 99397, 99398, 99399]), tensor([ 99400,  99401,  99402,  ..., 102377, 102378, 102379]), tensor([102380, 102381, 102382,  ..., 105373, 105374, 105375]), tensor([105376, 105378, 105379,  ..., 108364, 108365, 108366]), tensor([108367, 108368, 108369,  ..., 111352, 111353, 111354]), tensor([111355, 111357, 111358,  ..., 114348, 114350, 114351]), tensor([114352, 114353, 114354,  ..., 117402, 117403, 117404]), tensor([117405, 117406, 117407,  ..., 120382, 120383, 120384]), tensor([120386, 120387, 120388,  ..., 123354, 123355, 123356]), tensor([123357, 123359, 123360,  ..., 126358, 126359, 126361]), tensor([126365, 126366, 126367,  ..., 129353, 129354, 129355]), tensor([129356, 129357, 129360,  ..., 132364, 132366, 132367]), tensor([132368, 132369, 132370,  ..., 135363, 135364, 135365]), tensor([135366, 135367, 135368,  ..., 138392, 138393, 138394]), tensor([138395, 138396, 138397,  ..., 141412, 141413, 141414]), tensor([141415, 141416, 141417,  ..., 144447, 144449, 144450]), tensor([144451, 144452, 144453,  ..., 147453, 147454, 147455]), tensor([147456, 147457, 147458,  ..., 150452, 150453, 150454]), tensor([150455, 150456, 150457,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.47526073455810547
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0005075931549072266
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026842594146728516
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4816007614135742
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.811439275741577
self.buckets_partition() spend  sec:  0.508474588394165
check connections block*********************************

the find indices time spent  0.07068610191345215

in edges time spent  0.715057373046875
local to global src and eids time spent  2.0196192264556885
time gen tails  0.41862916946411133
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.286378860473633

----------------------------------------
check connections block*********************************

the find indices time spent  0.9065420627593994

in edges time spent  6.228503465652466
local to global src and eids time spent  9.254609107971191
time gen tails  1.563750982284546
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.914072275161743

block collection to dataloader spend  8.416175842285156e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.409024715423584  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.26028537750244  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 19.25902795791626  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.970703125 GB
    Memory Allocated: 0.4097599983215332  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.364251613616943  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.36465835571289  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 0.4113898277282715  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.23775625228882  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.238162994384766  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 0.41178369522094727  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.24349546432495  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.2439022064209  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 0.4154195785522461  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.30890655517578  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.30931329727173  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 0.41533851623535156  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.13254165649414  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.132948398590088  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 0.41646289825439453  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.200413703918457  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.200820446014404  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 0.42051267623901367  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.271446228027344  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.27185297012329  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 0.4209432601928711  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.304612636566162  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.322265625 GB
    Memory Allocated: 19.30501937866211  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.32421875 GB
    Memory Allocated: 0.42266273498535156  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.32421875 GB
    Memory Allocated: 19.309584617614746  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.32421875 GB
    Memory Allocated: 19.309991359710693  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.32421875 GB
    Memory Allocated: 0.4244561195373535  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.32421875 GB
    Memory Allocated: 19.31234121322632  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.32421875 GB
    Memory Allocated: 19.312747955322266  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.326171875 GB
    Memory Allocated: 0.42609739303588867  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.326171875 GB
    Memory Allocated: 19.23697280883789  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.326171875 GB
    Memory Allocated: 19.237379550933838  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.326171875 GB
    Memory Allocated: 0.42722368240356445  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.328125 GB
    Memory Allocated: 19.21387004852295  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.328125 GB
    Memory Allocated: 19.214276790618896  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 0.42817258834838867  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 19.21945333480835  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 19.219860076904297  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 0.43164587020874023  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 19.318155765533447  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 19.318562507629395  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 0.4313373565673828  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 19.257392406463623  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 19.25779914855957  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33203125 GB
    Memory Allocated: 0.43349361419677734  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3359375 GB
    Memory Allocated: 19.272295475006104  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3359375 GB
    Memory Allocated: 19.27270221710205  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 0.4354243278503418  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 19.22454833984375  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 19.224955081939697  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 0.4374394416809082  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 19.324975967407227  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 19.325382709503174  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.33984375 GB
    Memory Allocated: 0.43792247772216797  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.341796875 GB
    Memory Allocated: 19.173481464385986  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.341796875 GB
    Memory Allocated: 19.173888206481934  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.345703125 GB
    Memory Allocated: 0.43961143493652344  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.345703125 GB
    Memory Allocated: 19.24794626235962  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.345703125 GB
    Memory Allocated: 19.248353004455566  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.345703125 GB
    Memory Allocated: 0.4421696662902832  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.345703125 GB
    Memory Allocated: 19.198596477508545  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.345703125 GB
    Memory Allocated: 19.199003219604492  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 0.4445219039916992  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 19.329607486724854  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 19.3300142288208  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 0.4458298683166504  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 19.26284646987915  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 19.263253211975098  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 0.4472031593322754  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 19.263182640075684  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 19.26358938217163  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.34765625 GB
    Memory Allocated: 0.4492006301879883  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.349609375 GB
    Memory Allocated: 19.242892265319824  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.349609375 GB
    Memory Allocated: 19.24329900741577  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3515625 GB
    Memory Allocated: 0.45094966888427734  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3515625 GB
    Memory Allocated: 19.28273105621338  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3515625 GB
    Memory Allocated: 19.283137798309326  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3515625 GB
    Memory Allocated: 0.45230531692504883  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.35546875 GB
    Memory Allocated: 19.25235939025879  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.35546875 GB
    Memory Allocated: 19.252766132354736  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 0.4539375305175781  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 19.24652624130249  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 19.246932983398438  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 0.45667552947998047  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 19.289941787719727  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.357421875 GB
    Memory Allocated: 19.290348529815674  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.361328125 GB
    Memory Allocated: 0.4573798179626465  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.361328125 GB
    Memory Allocated: 19.25597333908081  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.361328125 GB
    Memory Allocated: 19.256380081176758  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.361328125 GB
    Memory Allocated: 0.4593238830566406  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.361328125 GB
    Memory Allocated: 19.283091068267822  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.361328125 GB
    Memory Allocated: 19.28349781036377  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.361328125 GB
    Memory Allocated: 0.4602193832397461  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.36328125 GB
    Memory Allocated: 19.35298204421997  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.36328125 GB
    Memory Allocated: 19.353388786315918  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3671875 GB
    Memory Allocated: 0.46357297897338867  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3671875 GB
    Memory Allocated: 19.36715316772461  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3671875 GB
    Memory Allocated: 19.367559909820557  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.369140625 GB
    Memory Allocated: 0.4641742706298828  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.369140625 GB
    Memory Allocated: 19.290281295776367  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.369140625 GB
    Memory Allocated: 19.290688037872314  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.369140625 GB
    Memory Allocated: 0.4659547805786133  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.369140625 GB
    Memory Allocated: 19.31965160369873  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.369140625 GB
    Memory Allocated: 19.320058345794678  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.373046875 GB
    Memory Allocated: 0.46835851669311523  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.373046875 GB
    Memory Allocated: 19.302244186401367  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.373046875 GB
    Memory Allocated: 19.302650928497314  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.373046875 GB
    Memory Allocated: 0.4690256118774414  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.373046875 GB
    Memory Allocated: 19.294209957122803  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.373046875 GB
    Memory Allocated: 19.29461669921875  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.375 GB
    Memory Allocated: 0.4706268310546875  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.375 GB
    Memory Allocated: 19.3126482963562  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.375 GB
    Memory Allocated: 19.31305503845215  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.375 GB
    Memory Allocated: 0.4741954803466797  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.375 GB
    Memory Allocated: 19.364574432373047  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.375 GB
    Memory Allocated: 19.364981174468994  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.37890625 GB
    Memory Allocated: 0.47383832931518555  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.37890625 GB
    Memory Allocated: 19.297487258911133  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.37890625 GB
    Memory Allocated: 19.29789400100708  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.37890625 GB
    Memory Allocated: 0.47593069076538086  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.37890625 GB
    Memory Allocated: 19.220909595489502  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.37890625 GB
    Memory Allocated: 19.22131633758545  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.37890625 GB
    Memory Allocated: 0.4786500930786133  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.380859375 GB
    Memory Allocated: 19.324537754058838  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.380859375 GB
    Memory Allocated: 19.324944496154785  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3828125 GB
    Memory Allocated: 0.4800691604614258  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3828125 GB
    Memory Allocated: 19.271606922149658  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3828125 GB
    Memory Allocated: 19.272013664245605  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.384765625 GB
    Memory Allocated: 0.4811744689941406  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.384765625 GB
    Memory Allocated: 19.215832710266113  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.384765625 GB
    Memory Allocated: 19.21623945236206  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.4827566146850586  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.275899410247803  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.27630615234375  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.48636960983276367  GigaBytes
Max Memory Allocated: 20.635119438171387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.399921894073486  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.400328636169434  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.4863886833190918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.322673797607422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 19.32308053970337  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.38671875 GB
    Memory Allocated: 0.4873695373535156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.390625 GB
    Memory Allocated: 19.29370880126953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.390625 GB
    Memory Allocated: 19.29411554336548  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.392578125 GB
    Memory Allocated: 0.4887423515319824  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.392578125 GB
    Memory Allocated: 19.21721076965332  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.392578125 GB
    Memory Allocated: 19.217617511749268  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.392578125 GB
    Memory Allocated: 0.4895052909851074  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.392578125 GB
    Memory Allocated: 19.078267574310303  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.392578125 GB
    Memory Allocated: 19.07866859436035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4946441650390625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9446222186088562
pure train time :  17.52677273750305
train time :  40.73311805725098
end to end time :  82.03367137908936
connection check time:  24.24413013458252
block generation time  14.200451135635376
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2995, 2996, 2997]), tensor([2998, 2999, 3001,  ..., 5994, 5995, 5997]), tensor([5998, 5999, 6000,  ..., 8991, 8993, 8994]), tensor([ 8995,  8996,  8997,  ..., 11975, 11976, 11977]), tensor([11978, 11979, 11980,  ..., 15020, 15022, 15023]), tensor([15024, 15025, 15027,  ..., 17994, 17995, 17996]), tensor([17997, 17998, 18003,  ..., 21002, 21003, 21004]), tensor([21005, 21006, 21007,  ..., 24027, 24030, 24031]), tensor([24033, 24034, 24035,  ..., 27034, 27036, 27039]), tensor([27040, 27041, 27042,  ..., 30047, 30048, 30049]), tensor([30052, 30053, 30054,  ..., 33092, 33093, 33094]), tensor([33095, 33096, 33097,  ..., 36132, 36135, 36136]), tensor([36137, 36138, 36139,  ..., 39139, 39140, 39142]), tensor([39143, 39144, 39146,  ..., 42156, 42157, 42158]), tensor([42159, 42160, 42161,  ..., 45167, 45168, 45169]), tensor([45170, 45171, 45172,  ..., 48202, 48204, 48205]), tensor([48206, 48207, 48208,  ..., 51214, 51215, 51216]), tensor([51217, 51218, 51219,  ..., 54225, 54226, 54227]), tensor([54228, 54229, 54230,  ..., 57233, 57234, 57235]), tensor([57238, 57239, 57240,  ..., 60197, 60199, 60200]), tensor([60201, 60202, 60203,  ..., 63180, 63181, 63182]), tensor([63183, 63184, 63185,  ..., 66152, 66153, 66154]), tensor([66156, 66157, 66158,  ..., 69155, 69156, 69157]), tensor([69158, 69159, 69160,  ..., 72143, 72144, 72146]), tensor([72147, 72148, 72149,  ..., 75147, 75148, 75149]), tensor([75150, 75151, 75152,  ..., 78123, 78125, 78126]), tensor([78127, 78128, 78129,  ..., 81178, 81179, 81180]), tensor([81182, 81183, 81184,  ..., 84166, 84167, 84168]), tensor([84169, 84170, 84171,  ..., 87192, 87193, 87194]), tensor([87195, 87196, 87197,  ..., 90208, 90209, 90210]), tensor([90211, 90212, 90213,  ..., 93244, 93245, 93246]), tensor([93247, 93248, 93249,  ..., 96263, 96264, 96265]), tensor([96266, 96267, 96268,  ..., 99266, 99267, 99268]), tensor([ 99269,  99270,  99271,  ..., 102287, 102288, 102289]), tensor([102290, 102291, 102292,  ..., 105289, 105290, 105291]), tensor([105292, 105293, 105294,  ..., 108341, 108342, 108343]), tensor([108344, 108345, 108346,  ..., 111362, 111363, 111364]), tensor([111365, 111367, 111368,  ..., 114349, 114350, 114352]), tensor([114353, 114355, 114356,  ..., 117355, 117356, 117357]), tensor([117358, 117359, 117360,  ..., 120329, 120330, 120333]), tensor([120334, 120335, 120336,  ..., 123328, 123329, 123330]), tensor([123331, 123333, 123334,  ..., 126313, 126314, 126315]), tensor([126316, 126317, 126318,  ..., 129324, 129325, 129326]), tensor([129328, 129330, 129331,  ..., 132309, 132310, 132311]), tensor([132312, 132313, 132314,  ..., 135356, 135359, 135360]), tensor([135361, 135362, 135363,  ..., 138372, 138374, 138375]), tensor([138376, 138377, 138378,  ..., 141407, 141408, 141409]), tensor([141410, 141411, 141412,  ..., 144422, 144423, 144424]), tensor([144425, 144426, 144427,  ..., 147447, 147448, 147449]), tensor([147450, 147451, 147452,  ..., 150464, 150465, 150466]), tensor([150467, 150468, 150469,  ..., 153427, 153428, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.5006124973297119
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004329681396484375
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021755218505859375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5079050064086914
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.9283831119537354
self.buckets_partition() spend  sec:  0.5296881198883057
check connections block*********************************

the find indices time spent  0.07955336570739746

in edges time spent  0.7074730396270752
local to global src and eids time spent  1.51845121383667
time gen tails  0.40996885299682617
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.252403974533081

----------------------------------------
check connections block*********************************

the find indices time spent  0.9293186664581299

in edges time spent  5.431869983673096
local to global src and eids time spent  8.062409400939941
time gen tails  1.5922822952270508
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.448848724365234

block collection to dataloader spend  7.319450378417969e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4092226028442383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.265810012817383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2645525932312  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.40718841552734375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.139967918395996  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.140374660491943  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4107050895690918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24546527862549  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.245872020721436  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4105110168457031  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.107635974884033  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.10804271697998  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4114818572998047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.098056316375732  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.09846305847168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41562414169311523  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.211058616638184  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.21146535873413  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4180469512939453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.262222290039062  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26262903213501  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.418670654296875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.206164360046387  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.206571102142334  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4201321601867676  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.337624073028564  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.33803081512451  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4217696189880371  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.20914125442505  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.209547996520996  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42450475692749023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25778341293335  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.258190155029297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4242420196533203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.209670543670654  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2100772857666  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4284510612487793  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.31073570251465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.311142444610596  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42907094955444336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.233675479888916  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.234082221984863  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4295668601989746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.222275257110596  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.222681999206543  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43239450454711914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.34662103652954  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.34702777862549  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4345893859863281  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26328706741333  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.263693809509277  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43414306640625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.168147563934326  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.168554306030273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43825483322143555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.32783317565918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.328239917755127  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4374847412109375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.168453216552734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.16885995864868  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44110107421875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.335972785949707  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.336379528045654  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4411764144897461  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23024272918701  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23064947128296  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44376420974731445  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.18346071243286  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.18386745452881  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44498586654663086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.280723094940186  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.281129837036133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44759225845336914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.267998695373535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.268405437469482  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44947052001953125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.338525772094727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.338932514190674  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4497246742248535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.20025396347046  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.200660705566406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4516897201538086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.252708435058594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25311517715454  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45392465591430664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.342264652252197  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.342671394348145  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45523881912231445  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2418794631958  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.242286205291748  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4576268196105957  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.260831356048584  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26123809814453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45983362197875977  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25147581100464  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.251882553100586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46060991287231445  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27036142349243  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27076816558838  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46230554580688477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29204750061035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2924542427063  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46394824981689453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.30574369430542  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.306150436401367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4666728973388672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.35558271408081  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.355989456176758  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4677300453186035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.302606105804443  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.30301284790039  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.468386173248291  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2654070854187  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26581382751465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47055912017822266  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.251118659973145  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.251525402069092  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4733753204345703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.360613346099854  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.3610200881958  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47415876388549805  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26651906967163  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.266925811767578  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47627782821655273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.36600351333618  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.36641025543213  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47778749465942383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.263492107391357  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.263898849487305  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4794940948486328  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29539680480957  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.295803546905518  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4794344902038574  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.181004524230957  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.181411266326904  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4819297790527344  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.20236110687256  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.202767848968506  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48409605026245117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.31549596786499  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.315902709960938  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48639583587646484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.315014362335205  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.315421104431152  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48614072799682617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.232677459716797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.233084201812744  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.49050474166870117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.32084560394287  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.32125234603882  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.49114274978637695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.078808307647705  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.079209327697754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.49628257751464844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8359401226043701
pure train time :  17.077008724212646
train time :  40.57768249511719
end to end time :  78.94360971450806
connection check time:  21.690146923065186
block generation time  13.701252698898315
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    2,    4,  ..., 2972, 2973, 2974]), tensor([2975, 2976, 2977,  ..., 5970, 5971, 5972]), tensor([5973, 5974, 5975,  ..., 8976, 8977, 8978]), tensor([ 8979,  8980,  8981,  ..., 12020, 12021, 12022]), tensor([12023, 12025, 12026,  ..., 15040, 15041, 15042]), tensor([15043, 15045, 15046,  ..., 18043, 18044, 18045]), tensor([18046, 18047, 18048,  ..., 21034, 21035, 21037]), tensor([21038, 21040, 21041,  ..., 24057, 24058, 24059]), tensor([24060, 24061, 24062,  ..., 27075, 27077, 27078]), tensor([27079, 27080, 27081,  ..., 30099, 30100, 30101]), tensor([30102, 30103, 30104,  ..., 33100, 33101, 33102]), tensor([33103, 33107, 33108,  ..., 36089, 36090, 36091]), tensor([36092, 36093, 36094,  ..., 39061, 39062, 39063]), tensor([39065, 39067, 39068,  ..., 42049, 42050, 42051]), tensor([42052, 42054, 42055,  ..., 45085, 45086, 45087]), tensor([45088, 45089, 45090,  ..., 48120, 48121, 48122]), tensor([48123, 48124, 48126,  ..., 51169, 51170, 51171]), tensor([51172, 51173, 51174,  ..., 54174, 54175, 54176]), tensor([54177, 54179, 54180,  ..., 57163, 57164, 57165]), tensor([57166, 57167, 57168,  ..., 60145, 60146, 60150]), tensor([60151, 60153, 60154,  ..., 63161, 63163, 63165]), tensor([63166, 63167, 63168,  ..., 66157, 66158, 66159]), tensor([66160, 66161, 66162,  ..., 69154, 69155, 69156]), tensor([69158, 69159, 69160,  ..., 72164, 72165, 72166]), tensor([72167, 72168, 72169,  ..., 75153, 75154, 75155]), tensor([75156, 75157, 75158,  ..., 78149, 78150, 78151]), tensor([78152, 78153, 78154,  ..., 81135, 81136, 81137]), tensor([81138, 81139, 81141,  ..., 84179, 84180, 84181]), tensor([84182, 84183, 84184,  ..., 87198, 87199, 87200]), tensor([87201, 87202, 87203,  ..., 90258, 90259, 90260]), tensor([90261, 90262, 90263,  ..., 93250, 93251, 93252]), tensor([93253, 93254, 93255,  ..., 96251, 96252, 96254]), tensor([96255, 96256, 96257,  ..., 99255, 99256, 99257]), tensor([ 99258,  99259,  99260,  ..., 102281, 102283, 102284]), tensor([102285, 102286, 102287,  ..., 105313, 105314, 105315]), tensor([105316, 105317, 105318,  ..., 108338, 108339, 108340]), tensor([108341, 108342, 108343,  ..., 111359, 111360, 111361]), tensor([111362, 111363, 111364,  ..., 114362, 114363, 114364]), tensor([114365, 114366, 114367,  ..., 117373, 117374, 117375]), tensor([117376, 117377, 117378,  ..., 120365, 120366, 120367]), tensor([120368, 120369, 120370,  ..., 123386, 123387, 123388]), tensor([123389, 123390, 123391,  ..., 126381, 126382, 126384]), tensor([126386, 126387, 126388,  ..., 129375, 129376, 129377]), tensor([129378, 129379, 129380,  ..., 132393, 132394, 132395]), tensor([132396, 132397, 132398,  ..., 135405, 135406, 135407]), tensor([135408, 135409, 135410,  ..., 138395, 138396, 138397]), tensor([138398, 138399, 138400,  ..., 141394, 141395, 141397]), tensor([141398, 141399, 141400,  ..., 144422, 144423, 144424]), tensor([144425, 144427, 144429,  ..., 147432, 147434, 147435]), tensor([147436, 147437, 147438,  ..., 150454, 150456, 150457]), tensor([150458, 150459, 150460,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.49054670333862305
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004420280456542969
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.022086143493652344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49782371520996094
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.010582685470581
self.buckets_partition() spend  sec:  0.5199413299560547
check connections block*********************************

the find indices time spent  0.07050704956054688

in edges time spent  0.46344733238220215
local to global src and eids time spent  1.5371618270874023
time gen tails  0.35650062561035156
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.251368999481201

----------------------------------------
check connections block*********************************

the find indices time spent  0.8094198703765869

in edges time spent  6.0056774616241455
local to global src and eids time spent  9.347406387329102
time gen tails  1.5736427307128906
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.477853298187256

block collection to dataloader spend  7.128715515136719e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4070854187011719  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24258327484131  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.241325855255127  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.40804290771484375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.19254779815674  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.192954540252686  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4102950096130371  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.21250629425049  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.212913036346436  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41206932067871094  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.245660305023193  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24606704711914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41414642333984375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.263882637023926  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.264289379119873  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.415252685546875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.20356798171997  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.203974723815918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41655683517456055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.201297760009766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.201704502105713  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4194297790527344  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.306386470794678  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.306793212890625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41955995559692383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.225786685943604  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.22619342803955  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4232187271118164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25345754623413  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.253864288330078  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4245643615722656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27294158935547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.273348331451416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42536497116088867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2109375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.211344242095947  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42800474166870117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.31850242614746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.318909168243408  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42845916748046875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2278790473938  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.228285789489746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4320521354675293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23776865005493  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23817539215088  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43282604217529297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.219078540802002  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.21948528289795  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4339733123779297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.17826747894287  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.17867422103882  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43439579010009766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.17772674560547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.178133487701416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43722105026245117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.224070072174072  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.22447681427002  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4372115135192871  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.156171321868896  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.156578063964844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43950748443603516  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.133710861206055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.134117603302002  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44361257553100586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.337261199951172  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.33766794204712  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4435596466064453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.225332260131836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.225739002227783  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4466285705566406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28346347808838  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.283870220184326  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44727516174316406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.239441871643066  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.239848613739014  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45003604888916016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.34131383895874  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.341720581054688  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4506549835205078  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.257019519805908  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.257426261901855  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45186281204223633  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23253631591797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.232943058013916  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45557546615600586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.291259765625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.291666507720947  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45504140853881836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.244874000549316  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.245280742645264  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4578113555908203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.34070873260498  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.341115474700928  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45875072479248047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.345746994018555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.346153736114502  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46046924591064453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.189271450042725  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.189678192138672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4624762535095215  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.281371116638184  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28177785873413  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.462735652923584  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.177624702453613  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.17803144454956  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4668416976928711  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.291083335876465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.291490077972412  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4686398506164551  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.213797569274902  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.21420431137085  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4700002670288086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.35716724395752  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.357573986053467  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47159719467163086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2647123336792  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.265119075775146  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4724874496459961  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.183609008789062  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.18401575088501  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47429943084716797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.225387573242188  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.225794315338135  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47612524032592773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.278810024261475  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.279216766357422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47821664810180664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.261037826538086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.261444568634033  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4805140495300293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.37282085418701  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.37322759628296  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4811410903930664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.37258768081665  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.372994422912598  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48264551162719727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26841115951538  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.268817901611328  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4843888282775879  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.293646812438965  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.294053554534912  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4872865676879883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.338175773620605  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.338582515716553  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4882392883300781  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.271934509277344  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27234125137329  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4915943145751953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.38030767440796  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.380714416503906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4903860092163086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.12940740585327  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.12980842590332  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.49553442001342773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7430753111839294
pure train time :  17.01270842552185
train time :  40.3709990978241
end to end time :  79.2049515247345
connection check time:  23.04845428466797
block generation time  13.729222297668457
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2994, 2995, 2996]), tensor([2997, 2998, 2999,  ..., 6012, 6013, 6014]), tensor([6015, 6016, 6017,  ..., 9022, 9023, 9024]), tensor([ 9025,  9026,  9027,  ..., 12048, 12049, 12050]), tensor([12051, 12052, 12053,  ..., 15098, 15099, 15100]), tensor([15101, 15102, 15103,  ..., 18139, 18141, 18142]), tensor([18143, 18144, 18145,  ..., 21137, 21139, 21140]), tensor([21141, 21142, 21143,  ..., 24127, 24128, 24129]), tensor([24130, 24131, 24132,  ..., 27119, 27120, 27121]), tensor([27123, 27124, 27125,  ..., 30148, 30149, 30150]), tensor([30151, 30152, 30153,  ..., 33175, 33176, 33177]), tensor([33178, 33179, 33180,  ..., 36178, 36180, 36183]), tensor([36184, 36186, 36187,  ..., 39209, 39210, 39211]), tensor([39214, 39216, 39217,  ..., 42223, 42224, 42225]), tensor([42226, 42227, 42228,  ..., 45218, 45219, 45221]), tensor([45222, 45223, 45224,  ..., 48205, 48208, 48209]), tensor([48210, 48211, 48212,  ..., 51265, 51266, 51267]), tensor([51268, 51269, 51270,  ..., 54285, 54287, 54288]), tensor([54289, 54290, 54291,  ..., 57299, 57300, 57301]), tensor([57302, 57303, 57304,  ..., 60316, 60318, 60319]), tensor([60320, 60322, 60323,  ..., 63363, 63364, 63365]), tensor([63366, 63367, 63368,  ..., 66344, 66345, 66346]), tensor([66347, 66348, 66349,  ..., 69378, 69379, 69380]), tensor([69381, 69382, 69383,  ..., 72352, 72353, 72354]), tensor([72355, 72356, 72357,  ..., 75339, 75340, 75341]), tensor([75342, 75343, 75344,  ..., 78330, 78331, 78332]), tensor([78333, 78334, 78335,  ..., 81326, 81327, 81328]), tensor([81329, 81330, 81331,  ..., 84330, 84331, 84332]), tensor([84333, 84334, 84335,  ..., 87373, 87374, 87375]), tensor([87376, 87377, 87378,  ..., 90396, 90397, 90399]), tensor([90400, 90401, 90402,  ..., 93450, 93452, 93453]), tensor([93454, 93455, 93456,  ..., 96483, 96484, 96485]), tensor([96486, 96487, 96488,  ..., 99463, 99465, 99467]), tensor([ 99468,  99469,  99470,  ..., 102484, 102485, 102486]), tensor([102487, 102488, 102489,  ..., 105482, 105483, 105484]), tensor([105485, 105486, 105487,  ..., 108456, 108457, 108458]), tensor([108459, 108460, 108461,  ..., 111438, 111439, 111440]), tensor([111442, 111443, 111444,  ..., 114425, 114426, 114427]), tensor([114428, 114429, 114430,  ..., 117453, 117454, 117455]), tensor([117457, 117458, 117459,  ..., 120480, 120481, 120482]), tensor([120483, 120484, 120485,  ..., 123474, 123475, 123476]), tensor([123477, 123479, 123480,  ..., 126457, 126458, 126459]), tensor([126460, 126461, 126462,  ..., 129461, 129462, 129464]), tensor([129465, 129467, 129468,  ..., 132471, 132472, 132473]), tensor([132474, 132476, 132477,  ..., 135483, 135486, 135487]), tensor([135488, 135489, 135490,  ..., 138498, 138499, 138502]), tensor([138503, 138504, 138505,  ..., 141502, 141503, 141504]), tensor([141506, 141507, 141508,  ..., 144521, 144522, 144523]), tensor([144524, 144525, 144526,  ..., 147496, 147497, 147498]), tensor([147499, 147500, 147502,  ..., 150470, 150472, 150473]), tensor([150474, 150475, 150476,  ..., 153427, 153428, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4478917121887207
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004086494445800781
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04119992256164551
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4552586078643799
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.8232946395874023
self.buckets_partition() spend  sec:  0.4964900016784668
check connections block*********************************

the find indices time spent  0.07282733917236328

in edges time spent  0.7171099185943604
local to global src and eids time spent  2.0957560539245605
time gen tails  0.38747429847717285
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.2763609886169434

----------------------------------------
check connections block*********************************

the find indices time spent  0.8249008655548096

in edges time spent  5.919946908950806
local to global src and eids time spent  9.504015445709229
time gen tails  1.6662936210632324
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.747867107391357

block collection to dataloader spend  9.250640869140625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4083223342895508  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.245654106140137  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.244396209716797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.40753173828125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.128726959228516  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.129133701324463  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4095902442932129  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.13262176513672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.133028507232666  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41106510162353516  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.224732398986816  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.225139141082764  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4143099784851074  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.3012056350708  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.301612377166748  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4156379699707031  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.252089977264404  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25249671936035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4165229797363281  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.17026376724243  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.17067050933838  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4180903434753418  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.22113037109375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.221537113189697  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41915369033813477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.140305995941162  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.14071273803711  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4224052429199219  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.266794681549072  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26720142364502  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42340898513793945  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.30785369873047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.308260440826416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42476367950439453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23154306411743  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23194980621338  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4268641471862793  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.278846740722656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.279253482818604  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4287538528442383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.272192001342773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27259874343872  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43035221099853516  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.315214157104492  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.31562089920044  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4330744743347168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.324615001678467  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.325021743774414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.432614803314209  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24436044692993  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24476718902588  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4351177215576172  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.240267753601074  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24067449569702  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4379558563232422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.291712284088135  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.292119026184082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43889665603637695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25994062423706  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.260347366333008  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4409809112548828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.235610008239746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.236016750335693  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4420895576477051  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27829074859619  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27869749069214  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44405269622802734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26976776123047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.270174503326416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4469137191772461  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.341444492340088  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.341851234436035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4462919235229492  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.234506130218506  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.234912872314453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.447843074798584  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.170498847961426  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.170905590057373  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4500770568847656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.18393564224243  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.18434238433838  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45252323150634766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.236666679382324  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23707342147827  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45340967178344727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23907995223999  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.239486694335938  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4564089775085449  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.348626613616943  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.34903335571289  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45803165435791016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.265352249145508  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.265758991241455  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45910024642944336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.296228408813477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.296635150909424  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46050071716308594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.251152992248535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.251559734344482  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46308374404907227  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.35164976119995  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.3520565032959  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46517133712768555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.315816402435303  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.31622314453125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46492910385131836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.19992160797119  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.20032835006714  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4670839309692383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26991605758667  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.270322799682617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4685359001159668  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.252371311187744  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25277805328369  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4697599411010742  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.219362258911133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.21976900100708  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47243452072143555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.36025857925415  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.360665321350098  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47341394424438477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.292611122131348  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.293017864227295  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47542285919189453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.266347885131836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.266754627227783  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4775533676147461  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.368988037109375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.369394779205322  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4799318313598633  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28335475921631  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.283761501312256  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4815363883972168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.366433143615723  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.36683988571167  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48368406295776367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.299554347991943  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29996109008789  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48392295837402344  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.276268482208252  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2766752243042  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48572206497192383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.294182777404785  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.294589519500732  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48839616775512695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.285035133361816  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.285441875457764  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4890432357788086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.280193328857422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28060007095337  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48934268951416016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.068650245666504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.069051265716553  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.494473934173584  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6725536584854126
pure train time :  17.313623666763306
train time :  40.68840551376343
end to end time :  83.5932469367981
connection check time:  25.011502504348755
block generation time  15.0242280960083
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2999, 3000, 3001]), tensor([3002, 3003, 3005,  ..., 6018, 6020, 6022]), tensor([6023, 6024, 6025,  ..., 9022, 9023, 9024]), tensor([ 9025,  9026,  9027,  ..., 12032, 12033, 12034]), tensor([12035, 12036, 12037,  ..., 15028, 15029, 15030]), tensor([15031, 15034, 15035,  ..., 18061, 18062, 18063]), tensor([18064, 18065, 18066,  ..., 21074, 21076, 21077]), tensor([21078, 21079, 21080,  ..., 24084, 24085, 24086]), tensor([24087, 24088, 24090,  ..., 27101, 27102, 27103]), tensor([27104, 27105, 27106,  ..., 30129, 30131, 30132]), tensor([30133, 30134, 30135,  ..., 33113, 33115, 33117]), tensor([33118, 33119, 33120,  ..., 36068, 36070, 36071]), tensor([36072, 36073, 36074,  ..., 39108, 39109, 39110]), tensor([39111, 39112, 39113,  ..., 42123, 42124, 42125]), tensor([42126, 42127, 42128,  ..., 45116, 45117, 45118]), tensor([45119, 45120, 45121,  ..., 48147, 48148, 48149]), tensor([48150, 48151, 48152,  ..., 51161, 51163, 51164]), tensor([51166, 51167, 51168,  ..., 54178, 54179, 54180]), tensor([54181, 54182, 54183,  ..., 57205, 57206, 57207]), tensor([57208, 57209, 57210,  ..., 60196, 60197, 60198]), tensor([60199, 60200, 60201,  ..., 63244, 63245, 63246]), tensor([63247, 63248, 63249,  ..., 66262, 66263, 66264]), tensor([66265, 66266, 66267,  ..., 69297, 69298, 69299]), tensor([69300, 69302, 69303,  ..., 72304, 72305, 72306]), tensor([72307, 72308, 72309,  ..., 75310, 75311, 75313]), tensor([75314, 75316, 75317,  ..., 78305, 78306, 78307]), tensor([78308, 78309, 78310,  ..., 81289, 81290, 81291]), tensor([81292, 81293, 81294,  ..., 84260, 84262, 84263]), tensor([84264, 84265, 84266,  ..., 87278, 87279, 87280]), tensor([87281, 87282, 87283,  ..., 90283, 90284, 90285]), tensor([90286, 90287, 90288,  ..., 93283, 93284, 93285]), tensor([93286, 93287, 93288,  ..., 96336, 96337, 96338]), tensor([96339, 96340, 96341,  ..., 99326, 99327, 99328]), tensor([ 99329,  99330,  99331,  ..., 102330, 102332, 102333]), tensor([102334, 102335, 102336,  ..., 105305, 105307, 105308]), tensor([105309, 105310, 105311,  ..., 108279, 108280, 108281]), tensor([108282, 108283, 108284,  ..., 111264, 111265, 111266]), tensor([111268, 111269, 111270,  ..., 114273, 114274, 114275]), tensor([114277, 114278, 114281,  ..., 117311, 117312, 117313]), tensor([117314, 117315, 117317,  ..., 120309, 120310, 120311]), tensor([120312, 120313, 120314,  ..., 123326, 123327, 123328]), tensor([123329, 123330, 123331,  ..., 126327, 126328, 126329]), tensor([126330, 126331, 126332,  ..., 129347, 129348, 129349]), tensor([129350, 129351, 129352,  ..., 132312, 132313, 132315]), tensor([132316, 132317, 132318,  ..., 135354, 135355, 135356]), tensor([135357, 135358, 135359,  ..., 138391, 138392, 138393]), tensor([138394, 138395, 138396,  ..., 141427, 141428, 141429]), tensor([141430, 141431, 141432,  ..., 144455, 144456, 144457]), tensor([144458, 144459, 144460,  ..., 147487, 147488, 147490]), tensor([147492, 147495, 147496,  ..., 150487, 150488, 150490]), tensor([150491, 150492, 150493,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4791271686553955
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004508495330810547
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026372671127319336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4846463203430176
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.4768147468566895
self.buckets_partition() spend  sec:  0.5110514163970947
check connections block*********************************

the find indices time spent  0.06995964050292969

in edges time spent  0.41512155532836914
local to global src and eids time spent  0.927664041519165
time gen tails  0.22121858596801758
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  1.732318639755249

----------------------------------------
check connections block*********************************

the find indices time spent  0.5586743354797363

in edges time spent  3.4737086296081543
local to global src and eids time spent  5.851726531982422
time gen tails  1.6879034042358398
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.528658390045166

block collection to dataloader spend  7.271766662597656e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4074368476867676  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.199331760406494  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.19807481765747  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.40736865997314453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.102575302124023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.10298204421997  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41101741790771484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.30246353149414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.302870273590088  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41228675842285156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2292160987854  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.229622840881348  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4136366844177246  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.223750114440918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.224156856536865  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4164714813232422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.35844135284424  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.358848094940186  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41626644134521484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.208277225494385  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.208683967590332  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4189724922180176  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.269917011260986  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.270323753356934  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42082691192626953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.207526683807373  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.20793342590332  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4216170310974121  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.237868785858154  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2382755279541  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42363548278808594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.225834846496582  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.22624158859253  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42629194259643555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.3343243598938  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.334731101989746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4274024963378906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.248021602630615  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.248428344726562  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42874765396118164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25702476501465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.257431507110596  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43014049530029297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.179250240325928  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.179656982421875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4316859245300293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.172329425811768  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.172736167907715  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43437671661376953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.221710681915283  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.22211742401123  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43621826171875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24052906036377  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.240935802459717  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43750715255737305  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.325320720672607  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.325727462768555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43786096572875977  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.176491737365723  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.17689847946167  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44137048721313477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.292224407196045  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.292631149291992  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44177961349487305  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.293447494506836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.293854236602783  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4428443908691406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.255566596984863  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25597333908081  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4457054138183594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26356267929077  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26396942138672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4464268684387207  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.205121994018555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.205528736114502  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4487276077270508  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23637294769287  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23677968978882  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4494967460632324  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.175628185272217  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.176034927368164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4526538848876953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.237890243530273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23829698562622  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.454317569732666  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.257550716400146  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.257957458496094  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4571061134338379  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.376593589782715  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.377000331878662  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4565768241882324  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.192413330078125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.192820072174072  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4594550132751465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.39503812789917  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.395444869995117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4609222412109375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.293485641479492  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29389238357544  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4619736671447754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2477765083313  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.248183250427246  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.463834285736084  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25112295150757  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.251529693603516  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4637174606323242  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.14763069152832  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.148037433624268  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46920108795166016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.355679988861084  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.35608673095703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4692206382751465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.301170825958252  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.3015775680542  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47040700912475586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29874610900879  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.299152851104736  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47185373306274414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.257288455963135  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.257695198059082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4737405776977539  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.320903301239014  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.32131004333496  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4753837585449219  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.268636226654053  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26904296875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4775986671447754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.288236618041992  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28864336013794  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4803647994995117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.30489492416382  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.305301666259766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47989988327026367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.199836254119873  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.20024299621582  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48458242416381836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.325281620025635  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.325688362121582  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4847259521484375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.286527633666992  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28693437576294  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4869532585144043  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.330507278442383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.33091402053833  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4875469207763672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.289357662200928  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.289764404296875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48862504959106445  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27602195739746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.276428699493408  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48978757858276367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.073644638061523  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.074045658111572  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4949207305908203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6213779449462891
pure train time :  17.121615409851074
train time :  40.721062898635864
end to end time :  73.00636959075928
connection check time:  16.49907350540161
block generation time  13.260977029800415
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3011, 3012, 3013]), tensor([3014, 3015, 3016,  ..., 5991, 5992, 5993]), tensor([5994, 5995, 5996,  ..., 9034, 9035, 9036]), tensor([ 9037,  9038,  9039,  ..., 12066, 12068, 12069]), tensor([12070, 12071, 12072,  ..., 15113, 15114, 15115]), tensor([15116, 15117, 15118,  ..., 18138, 18139, 18140]), tensor([18141, 18142, 18143,  ..., 21134, 21135, 21136]), tensor([21137, 21138, 21139,  ..., 24146, 24147, 24148]), tensor([24149, 24150, 24151,  ..., 27140, 27141, 27142]), tensor([27143, 27144, 27146,  ..., 30142, 30144, 30145]), tensor([30146, 30147, 30148,  ..., 33126, 33128, 33129]), tensor([33130, 33131, 33132,  ..., 36180, 36181, 36182]), tensor([36183, 36185, 36187,  ..., 39189, 39190, 39191]), tensor([39192, 39193, 39194,  ..., 42175, 42176, 42177]), tensor([42178, 42179, 42180,  ..., 45207, 45208, 45209]), tensor([45210, 45211, 45212,  ..., 48216, 48217, 48218]), tensor([48219, 48220, 48221,  ..., 51235, 51236, 51237]), tensor([51238, 51239, 51240,  ..., 54227, 54228, 54229]), tensor([54230, 54231, 54232,  ..., 57245, 57246, 57247]), tensor([57248, 57249, 57250,  ..., 60258, 60259, 60260]), tensor([60262, 60263, 60264,  ..., 63266, 63267, 63268]), tensor([63269, 63270, 63271,  ..., 66307, 66308, 66309]), tensor([66310, 66311, 66312,  ..., 69298, 69299, 69300]), tensor([69301, 69303, 69304,  ..., 72252, 72253, 72254]), tensor([72255, 72256, 72257,  ..., 75224, 75225, 75227]), tensor([75228, 75229, 75233,  ..., 78239, 78240, 78241]), tensor([78243, 78244, 78245,  ..., 81250, 81251, 81252]), tensor([81253, 81254, 81255,  ..., 84270, 84271, 84272]), tensor([84273, 84274, 84275,  ..., 87279, 87280, 87281]), tensor([87282, 87283, 87284,  ..., 90300, 90301, 90302]), tensor([90303, 90304, 90305,  ..., 93303, 93304, 93305]), tensor([93306, 93307, 93308,  ..., 96312, 96313, 96314]), tensor([96315, 96316, 96317,  ..., 99360, 99362, 99363]), tensor([ 99364,  99365,  99366,  ..., 102342, 102345, 102346]), tensor([102347, 102349, 102350,  ..., 105352, 105354, 105355]), tensor([105356, 105357, 105358,  ..., 108378, 108379, 108380]), tensor([108381, 108382, 108383,  ..., 111397, 111398, 111399]), tensor([111400, 111401, 111402,  ..., 114415, 114416, 114418]), tensor([114419, 114420, 114421,  ..., 117433, 117434, 117435]), tensor([117437, 117438, 117439,  ..., 120461, 120462, 120464]), tensor([120467, 120468, 120469,  ..., 123416, 123417, 123418]), tensor([123419, 123420, 123421,  ..., 126467, 126468, 126469]), tensor([126470, 126471, 126472,  ..., 129478, 129479, 129480]), tensor([129481, 129482, 129483,  ..., 132489, 132490, 132491]), tensor([132492, 132493, 132494,  ..., 135511, 135512, 135513]), tensor([135514, 135515, 135516,  ..., 138500, 138501, 138503]), tensor([138504, 138505, 138506,  ..., 141501, 141502, 141503]), tensor([141504, 141505, 141506,  ..., 144482, 144483, 144484]), tensor([144486, 144487, 144488,  ..., 147490, 147491, 147492]), tensor([147493, 147494, 147495,  ..., 150478, 150479, 150481]), tensor([150482, 150483, 150484,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.5015854835510254
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.00044989585876464844
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.022586345672607422
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5089664459228516
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.8948943614959717
self.buckets_partition() spend  sec:  0.531585693359375
check connections block*********************************

the find indices time spent  0.0725862979888916

in edges time spent  0.6888206005096436
local to global src and eids time spent  2.060089111328125
time gen tails  0.4024972915649414
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.2837257385253906

----------------------------------------
check connections block*********************************

the find indices time spent  0.8190326690673828

in edges time spent  6.142401456832886
local to global src and eids time spent  9.229339122772217
time gen tails  1.5936763286590576
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.522365808486938

block collection to dataloader spend  6.413459777832031e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4089369773864746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.250706672668457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.249449729919434  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.40928030014038086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.206167221069336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.206573963165283  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41121435165405273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.326536178588867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.326942920684814  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41204023361206055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.207254886627197  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.207661628723145  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4135918617248535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.223251819610596  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.223658561706543  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41490745544433594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.20966339111328  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.21007013320923  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4165024757385254  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.144227504730225  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.144634246826172  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41761350631713867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.207961082458496  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.208367824554443  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4216146469116211  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24088430404663  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.241291046142578  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4230837821960449  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.311689376831055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.312096118927002  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.423490047454834  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25022315979004  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.250629901885986  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42474365234375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.18256139755249  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.182968139648438  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42703866958618164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25278949737549  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.253196239471436  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4288816452026367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.22579336166382  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.226200103759766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43062496185302734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.149198055267334  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.14960479736328  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.431851863861084  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28140926361084  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.281816005706787  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4328804016113281  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24662208557129  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.247028827667236  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43465614318847656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.251397609710693  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25180435180664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4374270439147949  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.3578519821167  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.358258724212646  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43773651123046875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.187138557434082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.18754529953003  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4408283233642578  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.229657649993896  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.230064392089844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44214487075805664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.187283515930176  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.187690258026123  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44388818740844727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.235068321228027  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.235475063323975  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4461526870727539  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27756929397583  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.277976036071777  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4483160972595215  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.34422540664673  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.344632148742676  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.447664737701416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.240445137023926  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.240851879119873  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45113372802734375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27991771697998  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.280324459075928  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45185279846191406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.243595123291016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.244001865386963  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45407724380493164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.283092498779297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.283499240875244  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45640993118286133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29577398300171  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.296180725097656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4571547508239746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.197407245635986  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.197813987731934  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4587411880493164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26412343978882  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.264530181884766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4618844985961914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.368658542633057  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.369065284729004  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46408843994140625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.316564083099365  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.316970825195312  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4628429412841797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.187545776367188  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.187952518463135  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4658346176147461  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.216567516326904  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.21697425842285  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4674968719482422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.351054668426514  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.35146141052246  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46777915954589844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.19213104248047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.192537784576416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4718155860900879  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2896409034729  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.290047645568848  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47336483001708984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29380750656128  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.294214248657227  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4739398956298828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27715015411377  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.277556896209717  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4767608642578125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.36781120300293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.368217945098877  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47849464416503906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.32110023498535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.3215069770813  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4793400764465332  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26259136199951  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26299810409546  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48110103607177734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.209624767303467  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.210031509399414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4820671081542969  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.214372158050537  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.214778900146484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48435401916503906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26885986328125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.269266605377197  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4852457046508789  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.231296062469482  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23170280456543  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4877347946166992  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23411512374878  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.234521865844727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48899412155151367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27248525619507  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.272891998291016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.49005699157714844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.014995098114014  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.015396118164062  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.49518346786499023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.5773720741271973
pure train time :  17.133852005004883
train time :  40.66248655319214
end to end time :  81.61197209358215
connection check time:  24.209506273269653
block generation time  13.806091547012329
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    4,  ..., 3015, 3016, 3017]), tensor([3018, 3019, 3021,  ..., 6006, 6007, 6008]), tensor([6009, 6010, 6011,  ..., 9019, 9020, 9021]), tensor([ 9022,  9023,  9024,  ..., 12056, 12057, 12059]), tensor([12060, 12061, 12062,  ..., 15069, 15071, 15072]), tensor([15073, 15074, 15075,  ..., 18036, 18037, 18038]), tensor([18039, 18041, 18044,  ..., 21027, 21028, 21029]), tensor([21030, 21031, 21032,  ..., 24032, 24033, 24034]), tensor([24035, 24036, 24038,  ..., 27011, 27012, 27013]), tensor([27014, 27016, 27017,  ..., 30064, 30065, 30066]), tensor([30067, 30068, 30069,  ..., 33059, 33060, 33061]), tensor([33063, 33064, 33065,  ..., 36040, 36041, 36042]), tensor([36043, 36045, 36046,  ..., 39057, 39058, 39059]), tensor([39061, 39062, 39063,  ..., 42042, 42043, 42044]), tensor([42045, 42046, 42047,  ..., 45060, 45061, 45062]), tensor([45063, 45064, 45065,  ..., 48062, 48063, 48065]), tensor([48066, 48067, 48068,  ..., 51071, 51072, 51073]), tensor([51074, 51075, 51076,  ..., 54061, 54062, 54064]), tensor([54065, 54066, 54067,  ..., 57040, 57041, 57043]), tensor([57044, 57045, 57046,  ..., 60081, 60082, 60083]), tensor([60084, 60085, 60086,  ..., 63102, 63103, 63104]), tensor([63105, 63106, 63107,  ..., 66101, 66102, 66103]), tensor([66105, 66107, 66109,  ..., 69111, 69112, 69113]), tensor([69114, 69115, 69116,  ..., 72106, 72107, 72108]), tensor([72110, 72111, 72112,  ..., 75123, 75125, 75126]), tensor([75127, 75128, 75129,  ..., 78117, 78118, 78119]), tensor([78120, 78121, 78122,  ..., 81131, 81132, 81133]), tensor([81134, 81135, 81136,  ..., 84140, 84141, 84142]), tensor([84143, 84144, 84145,  ..., 87154, 87155, 87156]), tensor([87157, 87158, 87159,  ..., 90164, 90166, 90168]), tensor([90169, 90170, 90171,  ..., 93171, 93172, 93175]), tensor([93177, 93178, 93179,  ..., 96200, 96201, 96202]), tensor([96203, 96204, 96205,  ..., 99202, 99203, 99204]), tensor([ 99206,  99207,  99208,  ..., 102244, 102246, 102247]), tensor([102248, 102249, 102250,  ..., 105252, 105253, 105254]), tensor([105255, 105257, 105258,  ..., 108219, 108220, 108221]), tensor([108222, 108223, 108224,  ..., 111218, 111219, 111221]), tensor([111222, 111223, 111224,  ..., 114214, 114216, 114217]), tensor([114218, 114219, 114221,  ..., 117265, 117266, 117267]), tensor([117268, 117269, 117270,  ..., 120282, 120285, 120286]), tensor([120287, 120288, 120289,  ..., 123273, 123274, 123276]), tensor([123277, 123278, 123279,  ..., 126255, 126256, 126257]), tensor([126258, 126259, 126260,  ..., 129294, 129295, 129296]), tensor([129298, 129299, 129300,  ..., 132329, 132330, 132331]), tensor([132332, 132333, 132335,  ..., 135343, 135344, 135345]), tensor([135346, 135347, 135349,  ..., 138370, 138371, 138372]), tensor([138374, 138375, 138376,  ..., 141433, 141434, 141435]), tensor([141436, 141437, 141438,  ..., 144425, 144426, 144427]), tensor([144429, 144430, 144431,  ..., 147447, 147450, 147451]), tensor([147452, 147453, 147454,  ..., 150439, 150440, 150441]), tensor([150442, 150443, 150445,  ..., 153427, 153428, 153429])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.49965548515319824
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.00044345855712890625
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.022747278213500977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5073542594909668
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.431701421737671
self.buckets_partition() spend  sec:  0.5301332473754883
check connections block*********************************

the find indices time spent  0.07026791572570801

in edges time spent  0.5836606025695801
local to global src and eids time spent  1.5191395282745361
time gen tails  0.359710693359375
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.3210432529449463

----------------------------------------
check connections block*********************************

the find indices time spent  0.8050715923309326

in edges time spent  6.148324728012085
local to global src and eids time spent  9.161359786987305
time gen tails  1.6088571548461914
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.52623462677002

block collection to dataloader spend  9.131431579589844e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.408510684967041  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.20131492614746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.200057983398438  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4095020294189453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.314552783966064  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.31495952606201  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41039228439331055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.300501823425293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.30090856552124  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4119539260864258  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23515510559082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.235561847686768  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4134492874145508  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.15223455429077  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.15264129638672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41564130783081055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2156982421875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.216104984283447  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41740942001342773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.21771240234375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.218119144439697  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4188981056213379  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.3093900680542  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.309796810150146  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42049407958984375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25598955154419  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.256396293640137  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4216609001159668  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.20759916305542  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.208005905151367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4232778549194336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.225225925445557  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.225632667541504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4257998466491699  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.270989418029785  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.271396160125732  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42935705184936523  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.319234371185303  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.31964111328125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42913007736206055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.264071941375732  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26447868347168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4309725761413574  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2484073638916  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24881410598755  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4321451187133789  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.189526557922363  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.18993330001831  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43305540084838867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.170512199401855  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.170918941497803  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43565797805786133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.261779308319092  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26218605041504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.438112735748291  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.268211364746094  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26861810684204  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43967199325561523  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.332094192504883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.33250093460083  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4407806396484375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.241390705108643  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24179744720459  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44329261779785156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.262053966522217  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.262460708618164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44494009017944336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27192735671997  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.272334098815918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.446197509765625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.253817081451416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.254223823547363  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4462456703186035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.243577480316162  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24398422241211  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44969987869262695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28176975250244  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28217649459839  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4506373405456543  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.234156131744385  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.234562873840332  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45266199111938477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.262314796447754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2627215385437  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45369863510131836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24678659439087  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.247193336486816  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45563507080078125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.30192518234253  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.302331924438477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4587421417236328  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26257085800171  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.262977600097656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45806312561035156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.20024061203003  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.200647354125977  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4612894058227539  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.242778301239014  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24318504333496  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4629325866699219  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.309290885925293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.30969762802124  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46449804306030273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28483819961548  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.285244941711426  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.465118408203125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25294065475464  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.253347396850586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4670400619506836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.19651746749878  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.196924209594727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4697604179382324  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.211032390594482  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.21143913269043  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47016191482543945  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.256004810333252  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2564115524292  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4735288619995117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.26476812362671  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.265174865722656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4755539894104004  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.323288917541504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.32369565963745  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47662353515625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.272416591644287  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.272823333740234  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4779825210571289  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.268438816070557  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.268845558166504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47901296615600586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.215725421905518  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.216132164001465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4813094139099121  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.217527389526367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.217934131622314  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48355770111083984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27611207962036  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27651882171631  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4844655990600586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.285693168640137  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.286099910736084  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48707008361816406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.37163734436035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.3720440864563  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48779916763305664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.317200660705566  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.317607402801514  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48943138122558594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28548002243042  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.285886764526367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.49133920669555664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.11589765548706  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.11629867553711  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.49648380279541016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.5403881669044495
pure train time :  16.85057520866394
train time :  40.46420335769653
end to end time :  81.10551524162292
connection check time:  23.320786237716675
block generation time  14.847277879714966
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    3,  ..., 3011, 3012, 3013]), tensor([3014, 3015, 3016,  ..., 6009, 6010, 6012]), tensor([6013, 6014, 6017,  ..., 9026, 9027, 9029]), tensor([ 9030,  9031,  9033,  ..., 12036, 12037, 12038]), tensor([12039, 12040, 12041,  ..., 15050, 15051, 15052]), tensor([15053, 15054, 15055,  ..., 18042, 18043, 18044]), tensor([18046, 18047, 18048,  ..., 21045, 21046, 21047]), tensor([21048, 21049, 21050,  ..., 24068, 24069, 24070]), tensor([24072, 24073, 24074,  ..., 27109, 27110, 27111]), tensor([27112, 27113, 27115,  ..., 30095, 30096, 30097]), tensor([30098, 30099, 30100,  ..., 33078, 33079, 33080]), tensor([33082, 33083, 33085,  ..., 36109, 36110, 36111]), tensor([36112, 36113, 36114,  ..., 39101, 39102, 39103]), tensor([39104, 39105, 39106,  ..., 42103, 42104, 42105]), tensor([42106, 42108, 42110,  ..., 45101, 45102, 45103]), tensor([45105, 45107, 45108,  ..., 48127, 48128, 48129]), tensor([48130, 48131, 48133,  ..., 51166, 51168, 51169]), tensor([51170, 51171, 51172,  ..., 54164, 54165, 54166]), tensor([54167, 54168, 54169,  ..., 57184, 57185, 57186]), tensor([57187, 57188, 57189,  ..., 60183, 60184, 60185]), tensor([60186, 60187, 60188,  ..., 63167, 63168, 63169]), tensor([63170, 63172, 63174,  ..., 66147, 66148, 66149]), tensor([66150, 66151, 66152,  ..., 69130, 69131, 69132]), tensor([69133, 69134, 69135,  ..., 72173, 72175, 72176]), tensor([72177, 72178, 72179,  ..., 75167, 75168, 75169]), tensor([75170, 75171, 75172,  ..., 78178, 78179, 78180]), tensor([78181, 78182, 78183,  ..., 81236, 81237, 81238]), tensor([81239, 81241, 81242,  ..., 84267, 84268, 84269]), tensor([84270, 84271, 84274,  ..., 87293, 87295, 87296]), tensor([87298, 87299, 87300,  ..., 90301, 90303, 90304]), tensor([90305, 90306, 90307,  ..., 93316, 93317, 93319]), tensor([93321, 93322, 93323,  ..., 96324, 96325, 96326]), tensor([96327, 96328, 96329,  ..., 99366, 99367, 99368]), tensor([ 99369,  99370,  99371,  ..., 102373, 102374, 102375]), tensor([102376, 102377, 102380,  ..., 105397, 105398, 105399]), tensor([105400, 105402, 105403,  ..., 108392, 108394, 108395]), tensor([108396, 108397, 108398,  ..., 111376, 111377, 111378]), tensor([111379, 111380, 111381,  ..., 114375, 114376, 114377]), tensor([114378, 114379, 114381,  ..., 117395, 117396, 117397]), tensor([117398, 117399, 117400,  ..., 120449, 120450, 120451]), tensor([120452, 120453, 120455,  ..., 123442, 123443, 123444]), tensor([123445, 123446, 123449,  ..., 126467, 126468, 126470]), tensor([126471, 126472, 126473,  ..., 129492, 129493, 129494]), tensor([129495, 129497, 129498,  ..., 132492, 132493, 132494]), tensor([132495, 132496, 132497,  ..., 135490, 135491, 135492]), tensor([135493, 135494, 135497,  ..., 138492, 138493, 138494]), tensor([138496, 138497, 138498,  ..., 141470, 141471, 141472]), tensor([141473, 141474, 141475,  ..., 144458, 144459, 144460]), tensor([144461, 144462, 144463,  ..., 147491, 147492, 147493]), tensor([147494, 147496, 147497,  ..., 150481, 150483, 150484]), tensor([150485, 150486, 150487,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.5029916763305664
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004432201385498047
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021867990493774414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.510338306427002
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  1.9087233543395996
self.buckets_partition() spend  sec:  0.532238245010376
check connections block*********************************

the find indices time spent  0.05276083946228027

in edges time spent  0.63326096534729
local to global src and eids time spent  2.114905595779419
time gen tails  0.39053940773010254
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.358660936355591

----------------------------------------
check connections block*********************************

the find indices time spent  0.816694974899292

in edges time spent  6.0760886669158936
local to global src and eids time spent  9.965662002563477
time gen tails  1.6764037609100342
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.889575004577637

block collection to dataloader spend  9.942054748535156e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4088306427001953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29480791091919  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29355001449585  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.40852785110473633  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.297816276550293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29822301864624  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4089226722717285  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.218743324279785  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.219150066375732  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4132070541381836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.295637130737305  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.296043872833252  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4138960838317871  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25913906097412  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25954580307007  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.41574573516845703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.301109790802002  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.30151653289795  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4169163703918457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.218929767608643  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.21933650970459  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4182124137878418  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.214871406555176  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.215278148651123  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4201960563659668  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23881959915161  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.23922634124756  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4226799011230469  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.173229694366455  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.173636436462402  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.42351770401000977  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.166701316833496  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.167108058929443  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4246954917907715  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.163973808288574  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.16438055038452  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.425295352935791  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.134920120239258  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.135326862335205  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4282670021057129  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.21832036972046  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.218727111816406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4308605194091797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.265723705291748  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.266130447387695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4330902099609375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.32913112640381  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.329537868499756  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.43488454818725586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.345863819122314  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.34627056121826  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4353141784667969  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.228315353393555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.228722095489502  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4361248016357422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.155245304107666  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.155652046203613  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4382638931274414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.231064319610596  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.231471061706543  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44066667556762695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.259446144104004  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.25985288619995  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44171905517578125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.261249542236328  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.261656284332275  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4448561668395996  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.333311080932617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.333717823028564  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44580793380737305  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.280497074127197  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.280903816223145  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44841909408569336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.331697463989258  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.332104206085205  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.44914960861206055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.240562438964844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24096918106079  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.45084333419799805  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.296116828918457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.296523571014404  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4519319534301758  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27726936340332  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.277676105499268  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4539613723754883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.212714195251465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.213120937347412  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4547910690307617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.185407638549805  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.185814380645752  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4574918746948242  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.240403652191162  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.24081039428711  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4595208168029785  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.278456687927246  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.278863430023193  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4612293243408203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.35330295562744  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.35370969772339  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46115732192993164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.198626041412354  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.1990327835083  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46439504623413086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.250679969787598  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.251086711883545  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4657325744628906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.31710958480835  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.317516326904297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4692058563232422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.358054161071777  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.358460903167725  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.46919918060302734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.259647369384766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.260054111480713  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47176504135131836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.31722593307495  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.3176326751709  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47410058975219727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29156732559204  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29197406768799  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47406816482543945  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28119468688965  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.281601428985596  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.475832462310791  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.36444091796875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.364847660064697  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4774942398071289  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.270760536193848  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.271167278289795  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47880983352661133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29006862640381  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.290475368499756  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.47965383529663086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27323055267334  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.273637294769287  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4824094772338867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.265379428863525  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.265786170959473  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48535776138305664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.28902769088745  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.2894344329834  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4851093292236328  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.20583152770996  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.206238269805908  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.48694753646850586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.272407054901123  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.27281379699707  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.4890766143798828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.299124240875244  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.29953098297119  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 0.488985538482666  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.035417079925537  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.396484375 GB
    Memory Allocated: 19.035818099975586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.49411582946777344  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.5017700791358948
pure train time :  17.205814361572266
train time :  40.72353196144104
end to end time :  81.96121072769165
connection check time:  25.035603523254395
block generation time  14.248235940933228
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    3,  ..., 3029, 3030, 3031]), tensor([3032, 3033, 3034,  ..., 6024, 6026, 6027]), tensor([6028, 6030, 6032,  ..., 9060, 9061, 9062]), tensor([ 9063,  9064,  9065,  ..., 12074, 12075, 12076]), tensor([12077, 12078, 12079,  ..., 15066, 15067, 15068]), tensor([15069, 15070, 15072,  ..., 18049, 18050, 18051]), tensor([18053, 18054, 18055,  ..., 21014, 21015, 21016]), tensor([21017, 21018, 21019,  ..., 24011, 24013, 24015]), tensor([24016, 24017, 24018,  ..., 27009, 27011, 27012]), tensor([27013, 27014, 27016,  ..., 30003, 30004, 30005]), tensor([30006, 30007, 30008,  ..., 33016, 33017, 33018]), tensor([33019, 33020, 33021,  ..., 36012, 36013, 36014]), tensor([36015, 36016, 36018,  ..., 39017, 39018, 39019]), tensor([39020, 39021, 39022,  ..., 42006, 42007, 42008]), tensor([42009, 42011, 42012,  ..., 44995, 44996, 44997]), tensor([44999, 45000, 45002,  ..., 47996, 47997, 47998]), tensor([47999, 48000, 48002,  ..., 51010, 51011, 51012]), tensor([51013, 51014, 51015,  ..., 54020, 54021, 54023]), tensor([54024, 54025, 54026,  ..., 57017, 57019, 57020]), tensor([57021, 57023, 57024,  ..., 60028, 60029, 60030]), tensor([60031, 60032, 60033,  ..., 63051, 63052, 63053]), tensor([63054, 63055, 63056,  ..., 66057, 66058, 66059]), tensor([66060, 66061, 66062,  ..., 69059, 69060, 69061]), tensor([69062, 69063, 69064,  ..., 72090, 72091, 72093]), tensor([72094, 72095, 72096,  ..., 75106, 75108, 75109]), tensor([75110, 75111, 75112,  ..., 78117, 78118, 78119]), tensor([78121, 78122, 78123,  ..., 81117, 81118, 81119]), tensor([81120, 81121, 81124,  ..., 84142, 84143, 84144]), tensor([84145, 84148, 84149,  ..., 87177, 87178, 87179]), tensor([87180, 87181, 87183,  ..., 90179, 90180, 90181]), tensor([90183, 90184, 90185,  ..., 93183, 93184, 93185]), tensor([93186, 93187, 93188,  ..., 96224, 96225, 96226]), tensor([96228, 96229, 96230,  ..., 99237, 99238, 99239]), tensor([ 99241,  99242,  99243,  ..., 102285, 102286, 102287]), tensor([102288, 102289, 102291,  ..., 105334, 105335, 105336]), tensor([105337, 105338, 105339,  ..., 108346, 108347, 108348]), tensor([108349, 108351, 108352,  ..., 111352, 111353, 111354]), tensor([111355, 111356, 111357,  ..., 114357, 114358, 114359]), tensor([114360, 114361, 114362,  ..., 117379, 117381, 117382]), tensor([117383, 117385, 117386,  ..., 120418, 120419, 120420]), tensor([120421, 120422, 120423,  ..., 123399, 123400, 123402]), tensor([123403, 123404, 123405,  ..., 126415, 126416, 126417]), tensor([126419, 126420, 126421,  ..., 129432, 129433, 129434]), tensor([129435, 129436, 129437,  ..., 132439, 132440, 132441]), tensor([132442, 132443, 132444,  ..., 135407, 135408, 135409]), tensor([135410, 135411, 135412,  ..., 138461, 138462, 138463]), tensor([138464, 138465, 138466,  ..., 141451, 141452, 141453]), tensor([141454, 141455, 141456,  ..., 144425, 144426, 144427]), tensor([144428, 144430, 144431,  ..., 147420, 147421, 147422]), tensor([147423, 147424, 147425,  ..., 150455, 150456, 150457]), tensor([150458, 150459, 150460,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.46565985679626465
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.00044989585876464844
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02413773536682129
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.47094035148620605
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.2228617668151855
self.buckets_partition() spend  sec:  0.49511027336120605
check connections block*********************************

the find indices time spent  0.06985688209533691

in edges time spent  0.5650346279144287
local to global src and eids time spent  1.5144433975219727
time gen tails  0.357560396194458
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.289168119430542

----------------------------------------
check connections block*********************************

the find indices time spent  0.8646275997161865

in edges time spent  5.830177545547485
local to global src and eids time spent  7.850041389465332
time gen tails  1.6983888149261475
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.758018016815186

block collection to dataloader spend  9.655952453613281e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.40856170654296875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23769998550415  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.236443042755127  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4091815948486328  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.260262489318848  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.260669231414795  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41014909744262695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.155304431915283  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.15571117401123  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4107217788696289  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.196986198425293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19739294052124  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41291379928588867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.251887798309326  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.252294540405273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4166388511657715  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.301705360412598  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.302112102508545  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41666316986083984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.168248653411865  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.168655395507812  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4182863235473633  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.159538745880127  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.159945487976074  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42006778717041016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24973726272583  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.250144004821777  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4216461181640625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.20644760131836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.206854343414307  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4248952865600586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24782943725586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.248236179351807  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42588186264038086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.219106197357178  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.219512939453125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4272332191467285  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.15782356262207  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.158230304718018  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42924070358276367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.316123008728027  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.316529750823975  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4310479164123535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.225537300109863  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22594404220581  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4325227737426758  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.255807399749756  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.256214141845703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4338216781616211  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.32023859024048  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.320645332336426  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4359598159790039  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26638650894165  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.266793251037598  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4378952980041504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2867112159729  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.287117958068848  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.440093994140625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.223137378692627  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.223544120788574  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44084692001342773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26051378250122  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.260920524597168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44240379333496094  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22869634628296  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.229103088378906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44382381439208984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26531171798706  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.265718460083008  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4469733238220215  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.336052894592285  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.336459636688232  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4465031623840332  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.18397331237793  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.184380054473877  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45000171661376953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.303123950958252  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.3035306930542  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45144176483154297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.242871284484863  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24327802658081  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4529690742492676  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30043888092041  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.300845623016357  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4537544250488281  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.234205722808838  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.234612464904785  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45413684844970703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.18805694580078  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.18846368789673  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4583110809326172  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.287269592285156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.287676334381104  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45813417434692383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.16025733947754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.160664081573486  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46131372451782227  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.244701385498047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.245108127593994  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4612565040588379  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29710817337036  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29751491546631  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46470069885253906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27156352996826  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27197027206421  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4664006233215332  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.302902698516846  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.303309440612793  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4678468704223633  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.317431926727295  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.317838668823242  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4692959785461426  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.284356117248535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.284762859344482  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4721102714538574  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.37558364868164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.375990390777588  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4709138870239258  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.206904888153076  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.207311630249023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4741549491882324  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.284260272979736  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.284667015075684  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47566986083984375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.309828281402588  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.310235023498535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4780263900756836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.365371704101562  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.36577844619751  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4801912307739258  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.326050758361816  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.326457500457764  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4803438186645508  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27052593231201  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27093267440796  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48384714126586914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.32837200164795  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.328778743743896  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.484041690826416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.226176261901855  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.226583003997803  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48766326904296875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.376826286315918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.377233028411865  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48870229721069336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.3813533782959  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.381760120391846  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48941946029663086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.185408115386963  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.18581485748291  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.49013280868530273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.135480880737305  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.135881900787354  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4952831268310547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.46956703066825867
pure train time :  17.281208992004395
train time :  40.70001578330994
end to end time :  80.50132870674133
connection check time:  22.48689365386963
block generation time  15.047186136245728
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3019, 3020, 3021]), tensor([3022, 3024, 3025,  ..., 6046, 6047, 6048]), tensor([6049, 6050, 6051,  ..., 9085, 9086, 9087]), tensor([ 9088,  9089,  9090,  ..., 12064, 12065, 12066]), tensor([12067, 12068, 12069,  ..., 15031, 15032, 15034]), tensor([15035, 15036, 15037,  ..., 18029, 18030, 18031]), tensor([18032, 18033, 18034,  ..., 21046, 21047, 21048]), tensor([21049, 21050, 21051,  ..., 24048, 24049, 24050]), tensor([24051, 24052, 24053,  ..., 27082, 27084, 27086]), tensor([27087, 27088, 27089,  ..., 30093, 30095, 30096]), tensor([30097, 30098, 30099,  ..., 33084, 33085, 33086]), tensor([33087, 33088, 33089,  ..., 36039, 36040, 36042]), tensor([36043, 36044, 36045,  ..., 39049, 39050, 39051]), tensor([39052, 39053, 39054,  ..., 42048, 42049, 42050]), tensor([42051, 42052, 42053,  ..., 45066, 45067, 45068]), tensor([45069, 45071, 45072,  ..., 48110, 48111, 48112]), tensor([48113, 48114, 48115,  ..., 51122, 51123, 51124]), tensor([51125, 51126, 51127,  ..., 54145, 54146, 54148]), tensor([54149, 54150, 54151,  ..., 57156, 57157, 57158]), tensor([57159, 57160, 57161,  ..., 60193, 60194, 60195]), tensor([60196, 60199, 60200,  ..., 63241, 63242, 63244]), tensor([63245, 63246, 63247,  ..., 66246, 66247, 66248]), tensor([66249, 66250, 66251,  ..., 69270, 69271, 69272]), tensor([69273, 69274, 69275,  ..., 72288, 72289, 72290]), tensor([72291, 72292, 72293,  ..., 75252, 75254, 75255]), tensor([75256, 75257, 75258,  ..., 78243, 78244, 78245]), tensor([78247, 78248, 78249,  ..., 81268, 81270, 81271]), tensor([81272, 81274, 81275,  ..., 84243, 84244, 84245]), tensor([84246, 84247, 84249,  ..., 87253, 87254, 87255]), tensor([87256, 87257, 87258,  ..., 90287, 90289, 90290]), tensor([90292, 90293, 90295,  ..., 93332, 93333, 93334]), tensor([93335, 93336, 93337,  ..., 96343, 96344, 96345]), tensor([96346, 96347, 96349,  ..., 99354, 99355, 99356]), tensor([ 99357,  99358,  99360,  ..., 102359, 102361, 102362]), tensor([102363, 102364, 102365,  ..., 105394, 105395, 105396]), tensor([105397, 105398, 105399,  ..., 108396, 108397, 108398]), tensor([108399, 108400, 108401,  ..., 111409, 111410, 111412]), tensor([111413, 111414, 111416,  ..., 114416, 114417, 114418]), tensor([114419, 114420, 114421,  ..., 117456, 117457, 117458]), tensor([117459, 117460, 117462,  ..., 120447, 120448, 120449]), tensor([120450, 120452, 120453,  ..., 123451, 123452, 123453]), tensor([123455, 123456, 123457,  ..., 126440, 126441, 126442]), tensor([126443, 126445, 126448,  ..., 129466, 129467, 129468]), tensor([129470, 129471, 129472,  ..., 132457, 132458, 132459]), tensor([132460, 132461, 132462,  ..., 135425, 135426, 135427]), tensor([135428, 135429, 135430,  ..., 138439, 138440, 138441]), tensor([138442, 138443, 138444,  ..., 141398, 141399, 141401]), tensor([141402, 141403, 141405,  ..., 144417, 144419, 144420]), tensor([144421, 144422, 144423,  ..., 147409, 147410, 147411]), tensor([147413, 147414, 147415,  ..., 150415, 150416, 150417]), tensor([150418, 150419, 150420,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4847729206085205
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0005178451538085938
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024399757385253906
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49117112159729004
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.7337191104888916
self.buckets_partition() spend  sec:  0.5156052112579346
check connections block*********************************

the find indices time spent  0.07425522804260254

in edges time spent  0.6496937274932861
local to global src and eids time spent  1.667160987854004
time gen tails  0.36913442611694336
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.326524257659912

----------------------------------------
check connections block*********************************

the find indices time spent  0.8491675853729248

in edges time spent  6.013463258743286
local to global src and eids time spent  8.572429656982422
time gen tails  1.6086840629577637
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.470067977905273

block collection to dataloader spend  7.700920104980469e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.40802955627441406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.189676761627197  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.188418865203857  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4079751968383789  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.158603191375732  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.15900993347168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4103689193725586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19841241836548  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.198819160461426  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.411435604095459  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.212858200073242  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.21326494216919  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41306304931640625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.207367420196533  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.20777416229248  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4153280258178711  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.229777812957764  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23018455505371  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41774559020996094  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.228214263916016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.228621006011963  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41963958740234375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.214696884155273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.21510362625122  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4182891845703125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.15638303756714  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.156789779663086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4219222068786621  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.20669651031494  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.20710325241089  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42400503158569336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.270533561706543  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27094030380249  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4256916046142578  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.17568826675415  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.176095008850098  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4269075393676758  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.174363136291504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.17476987838745  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42972803115844727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.31056308746338  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.310969829559326  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43021297454833984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.269015789031982  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26942253112793  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4312577247619629  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.169699668884277  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.170106410980225  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4350137710571289  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.320463180541992  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.32086992263794  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43524694442749023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.17778444290161  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.17819118499756  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43669652938842773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.219756603240967  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.220163345336914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44054174423217773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.336878299713135  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.337285041809082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43973207473754883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.193984985351562  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19439172744751  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44111156463623047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19577980041504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.196186542510986  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44380712509155273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.268905639648438  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.269312381744385  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44415950775146484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23383378982544  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.234240531921387  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44886350631713867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.352126598358154  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.3525333404541  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4492340087890625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29189968109131  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.292306423187256  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45084428787231445  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24724292755127  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.247649669647217  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45348119735717773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.34549856185913  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.345905303955078  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4535794258117676  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.18504047393799  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.185447216033936  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4552574157714844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24020004272461  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.240606784820557  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4566836357116699  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.178434371948242  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.17884111404419  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46010303497314453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27339458465576  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27380132675171  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.461606502532959  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.248728275299072  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24913501739502  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4618806838989258  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26473903656006  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.265145778656006  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4638557434082031  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.302300930023193  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30270767211914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46698570251464844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.320692539215088  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.321099281311035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4682002067565918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.259507656097412  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25991439819336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46892213821411133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.253011226654053  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25341796875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4705696105957031  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.258909702301025  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.259316444396973  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4717826843261719  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22855281829834  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.228959560394287  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47262048721313477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.196885108947754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.1972918510437  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47787046432495117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.3186616897583  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.319068431854248  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47729969024658203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22929811477661  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22970485687256  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4802432060241699  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.331016063690186  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.331422805786133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48053455352783203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.220767974853516  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.221174716949463  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4842867851257324  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.331953525543213  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.33236026763916  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48429441452026367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.275513172149658  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.275919914245605  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4865751266479492  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.273172855377197  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.273579597473145  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48744821548461914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.222952842712402  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22335958480835  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4902825355529785  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.33769941329956  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.338106155395508  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4909062385559082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.079188346862793  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.079589366912842  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4960460662841797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.4467979073524475
pure train time :  17.060011386871338
train time :  40.42677330970764
end to end time :  79.78385090827942
connection check time:  22.78474187850952
block generation time  13.796592235565186
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2981, 2982, 2983]), tensor([2984, 2985, 2986,  ..., 5987, 5988, 5989]), tensor([5990, 5991, 5993,  ..., 8992, 8993, 8994]), tensor([ 8995,  8996,  8998,  ..., 12034, 12035, 12036]), tensor([12037, 12038, 12039,  ..., 15039, 15040, 15041]), tensor([15042, 15044, 15045,  ..., 18043, 18044, 18045]), tensor([18046, 18047, 18048,  ..., 21033, 21034, 21035]), tensor([21037, 21038, 21039,  ..., 24029, 24030, 24031]), tensor([24032, 24033, 24034,  ..., 27062, 27063, 27064]), tensor([27065, 27067, 27068,  ..., 30058, 30059, 30060]), tensor([30061, 30062, 30063,  ..., 33048, 33049, 33050]), tensor([33052, 33053, 33054,  ..., 36043, 36044, 36045]), tensor([36046, 36047, 36048,  ..., 39060, 39061, 39062]), tensor([39063, 39064, 39066,  ..., 42079, 42080, 42082]), tensor([42083, 42084, 42085,  ..., 45105, 45106, 45107]), tensor([45108, 45109, 45110,  ..., 48111, 48112, 48113]), tensor([48114, 48115, 48116,  ..., 51133, 51134, 51136]), tensor([51137, 51138, 51139,  ..., 54155, 54156, 54157]), tensor([54159, 54160, 54161,  ..., 57150, 57151, 57152]), tensor([57153, 57154, 57155,  ..., 60174, 60176, 60177]), tensor([60178, 60179, 60180,  ..., 63143, 63144, 63145]), tensor([63146, 63147, 63148,  ..., 66163, 66164, 66165]), tensor([66166, 66167, 66169,  ..., 69146, 69147, 69148]), tensor([69149, 69150, 69151,  ..., 72163, 72165, 72166]), tensor([72167, 72168, 72169,  ..., 75185, 75186, 75187]), tensor([75188, 75189, 75190,  ..., 78186, 78187, 78188]), tensor([78190, 78191, 78192,  ..., 81162, 81163, 81164]), tensor([81165, 81167, 81168,  ..., 84166, 84167, 84168]), tensor([84169, 84170, 84173,  ..., 87159, 87160, 87161]), tensor([87162, 87164, 87165,  ..., 90181, 90182, 90183]), tensor([90184, 90185, 90186,  ..., 93185, 93186, 93188]), tensor([93189, 93190, 93191,  ..., 96208, 96209, 96210]), tensor([96211, 96212, 96213,  ..., 99206, 99207, 99209]), tensor([ 99210,  99211,  99212,  ..., 102192, 102193, 102194]), tensor([102195, 102196, 102197,  ..., 105225, 105227, 105228]), tensor([105229, 105230, 105231,  ..., 108244, 108245, 108246]), tensor([108249, 108250, 108251,  ..., 111272, 111273, 111275]), tensor([111276, 111277, 111278,  ..., 114309, 114310, 114311]), tensor([114312, 114314, 114315,  ..., 117302, 117303, 117304]), tensor([117305, 117307, 117308,  ..., 120315, 120316, 120317]), tensor([120320, 120321, 120322,  ..., 123310, 123311, 123312]), tensor([123313, 123315, 123316,  ..., 126327, 126328, 126329]), tensor([126330, 126332, 126333,  ..., 129369, 129370, 129371]), tensor([129372, 129373, 129374,  ..., 132378, 132379, 132380]), tensor([132381, 132383, 132384,  ..., 135384, 135385, 135386]), tensor([135387, 135389, 135390,  ..., 138397, 138398, 138399]), tensor([138400, 138401, 138402,  ..., 141416, 141417, 141418]), tensor([141419, 141420, 141421,  ..., 144449, 144450, 144451]), tensor([144452, 144453, 144454,  ..., 147452, 147453, 147454]), tensor([147455, 147456, 147457,  ..., 150442, 150443, 150445]), tensor([150446, 150447, 150448,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.5007319450378418
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.00044536590576171875
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.022275447845458984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5083074569702148
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.8980321884155273
self.buckets_partition() spend  sec:  0.5306150913238525
check connections block*********************************

the find indices time spent  0.07155370712280273

in edges time spent  0.6958072185516357
local to global src and eids time spent  1.9264237880706787
time gen tails  0.3586897850036621
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.3359572887420654

----------------------------------------
check connections block*********************************

the find indices time spent  0.817040205001831

in edges time spent  5.998412609100342
local to global src and eids time spent  9.938244819641113
time gen tails  1.618647813796997
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.26267409324646

block collection to dataloader spend  7.414817810058594e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4069938659667969  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.222554206848145  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.221296787261963  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.40813255310058594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19412851333618  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19453525543213  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4105348587036133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.246888637542725  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.247295379638672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4117598533630371  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.199763298034668  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.200170040130615  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4132695198059082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.202935218811035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.203341960906982  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41559934616088867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.32034397125244  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.32075071334839  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4165658950805664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.13814401626587  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.138550758361816  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41826915740966797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.15422296524048  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.154629707336426  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41997385025024414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26471996307373  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.265126705169678  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42125940322875977  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.218897342681885  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.219304084777832  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42319726943969727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26987314224243  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27027988433838  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42473554611206055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.207797050476074  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.20820379257202  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4267587661743164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.21572494506836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.216131687164307  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4302506446838379  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.322800636291504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.32320737838745  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4301643371582031  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.109663009643555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.110069751739502  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4323129653930664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.21920871734619  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.21961545944214  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4328474998474121  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.168021202087402  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.16842794418335  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43630027770996094  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.272462368011475  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.272869110107422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4382033348083496  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.28452157974243  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.28492832183838  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4386630058288574  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23271369934082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.233120441436768  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4411048889160156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.328239917755127  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.328646659851074  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44237422943115234  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.285709857940674  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.28611660003662  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44538402557373047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26165533065796  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.262062072753906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4459710121154785  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.33173179626465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.332138538360596  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4488539695739746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.336034297943115  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.336441040039062  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4498438835144043  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.280003547668457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.280410289764404  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45140838623046875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.287642002105713  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.28804874420166  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4522719383239746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27119731903076  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27160406112671  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4549226760864258  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.301127433776855  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.301534175872803  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.456453800201416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.348204612731934  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.34861135482788  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45649147033691406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.193188667297363  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19359540939331  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4593539237976074  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.342426300048828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.342833042144775  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.461336612701416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.311317443847656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.311724185943604  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4621438980102539  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.28923797607422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.289644718170166  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4624972343444824  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.196134090423584  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19654083251953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46638917922973633  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.255715370178223  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25612211227417  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46808624267578125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27585220336914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.276258945465088  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4688282012939453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.273651123046875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.274057865142822  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4707975387573242  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.321277141571045  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.321683883666992  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4704766273498535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.16414165496826  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.16454839706421  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47498607635498047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.36286211013794  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.363268852233887  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4758729934692383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.260295867919922  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26070261001587  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47788143157958984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.265877723693848  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.266284465789795  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4789543151855469  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.267205238342285  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.267611980438232  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4809384346008301  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.287944316864014  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.28835105895996  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.481752872467041  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27186346054077  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27227020263672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4838700294494629  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.1907639503479  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.191170692443848  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4861454963684082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.3146014213562  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.31500816345215  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48730897903442383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.280571460723877  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.280978202819824  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.49025678634643555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.386856079101562  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.38726282119751  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4901118278503418  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.13192081451416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.13232183456421  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.49526119232177734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.4232689142227173
pure train time :  17.420592784881592
train time :  40.546857595443726
end to end time :  81.50915741920471
connection check time:  24.417314529418945
block generation time  13.598631381988525
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2982, 2983, 2984]), tensor([2986, 2987, 2988,  ..., 5997, 5998, 5999]), tensor([6000, 6001, 6002,  ..., 8995, 8996, 8997]), tensor([ 8998,  8999,  9000,  ..., 11999, 12000, 12001]), tensor([12002, 12003, 12008,  ..., 15010, 15011, 15012]), tensor([15013, 15014, 15015,  ..., 18011, 18012, 18013]), tensor([18015, 18016, 18017,  ..., 20991, 20992, 20993]), tensor([20994, 20995, 20996,  ..., 24049, 24050, 24051]), tensor([24052, 24053, 24054,  ..., 27068, 27069, 27070]), tensor([27071, 27072, 27073,  ..., 30087, 30088, 30090]), tensor([30091, 30093, 30094,  ..., 33105, 33106, 33107]), tensor([33109, 33110, 33111,  ..., 36134, 36135, 36136]), tensor([36138, 36139, 36140,  ..., 39170, 39171, 39172]), tensor([39174, 39175, 39176,  ..., 42195, 42196, 42198]), tensor([42199, 42200, 42201,  ..., 45178, 45180, 45181]), tensor([45182, 45183, 45184,  ..., 48199, 48200, 48201]), tensor([48202, 48203, 48204,  ..., 51186, 51187, 51188]), tensor([51189, 51190, 51191,  ..., 54222, 54223, 54224]), tensor([54225, 54226, 54227,  ..., 57239, 57240, 57241]), tensor([57242, 57244, 57245,  ..., 60224, 60225, 60226]), tensor([60227, 60228, 60229,  ..., 63248, 63249, 63251]), tensor([63252, 63253, 63254,  ..., 66203, 66204, 66206]), tensor([66207, 66209, 66210,  ..., 69205, 69206, 69207]), tensor([69208, 69209, 69210,  ..., 72243, 72244, 72245]), tensor([72246, 72247, 72248,  ..., 75228, 75229, 75230]), tensor([75231, 75232, 75233,  ..., 78234, 78235, 78237]), tensor([78239, 78240, 78241,  ..., 81242, 81243, 81244]), tensor([81245, 81247, 81248,  ..., 84247, 84248, 84249]), tensor([84250, 84251, 84252,  ..., 87244, 87247, 87248]), tensor([87249, 87250, 87251,  ..., 90268, 90269, 90270]), tensor([90271, 90272, 90273,  ..., 93301, 93302, 93303]), tensor([93304, 93305, 93306,  ..., 96287, 96288, 96289]), tensor([96290, 96291, 96292,  ..., 99302, 99305, 99306]), tensor([ 99307,  99308,  99309,  ..., 102282, 102283, 102284]), tensor([102285, 102286, 102287,  ..., 105291, 105292, 105293]), tensor([105294, 105295, 105296,  ..., 108318, 108319, 108320]), tensor([108321, 108322, 108323,  ..., 111355, 111356, 111357]), tensor([111358, 111359, 111360,  ..., 114374, 114375, 114376]), tensor([114377, 114378, 114380,  ..., 117376, 117377, 117378]), tensor([117379, 117380, 117381,  ..., 120395, 120396, 120397]), tensor([120398, 120399, 120400,  ..., 123405, 123406, 123407]), tensor([123408, 123409, 123410,  ..., 126376, 126377, 126378]), tensor([126379, 126380, 126381,  ..., 129375, 129376, 129377]), tensor([129378, 129379, 129380,  ..., 132403, 132405, 132406]), tensor([132407, 132408, 132409,  ..., 135381, 135383, 135384]), tensor([135385, 135386, 135387,  ..., 138414, 138415, 138416]), tensor([138417, 138418, 138419,  ..., 141413, 141416, 141417]), tensor([141418, 141419, 141422,  ..., 144407, 144408, 144409]), tensor([144411, 144412, 144414,  ..., 147462, 147463, 147464]), tensor([147465, 147466, 147467,  ..., 150473, 150474, 150475]), tensor([150476, 150477, 150478,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.498485803604126
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004394054412841797
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021405935287475586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5061287879943848
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.8914663791656494
self.buckets_partition() spend  sec:  0.5275676250457764
check connections block*********************************

the find indices time spent  0.07147622108459473

in edges time spent  0.6923305988311768
local to global src and eids time spent  2.083310127258301
time gen tails  0.3882155418395996
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.325084686279297

----------------------------------------
check connections block*********************************

the find indices time spent  0.8059022426605225

in edges time spent  5.896851301193237
local to global src and eids time spent  9.870151996612549
time gen tails  1.5940032005310059
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.717979431152344

block collection to dataloader spend  7.581710815429688e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4090580940246582  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23761796951294  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2363600730896  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.40955543518066406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29905080795288  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.299457550048828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4097104072570801  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.214332103729248  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.214738845825195  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41087865829467773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.14927864074707  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.149685382843018  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4138803482055664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.15358829498291  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.153995037078857  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41471242904663086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.229565620422363  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22997236251831  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41699838638305664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.20943260192871  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.209839344024658  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4183955192565918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.213552951812744  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.21395969390869  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42049598693847656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.319361686706543  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.31976842880249  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42089271545410156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.219905376434326  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.220312118530273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4237504005432129  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.21962308883667  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.220029830932617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4262399673461914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.218994617462158  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.219401359558105  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4278392791748047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27338409423828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27379083633423  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43022966384887695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.320720195770264  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.32112693786621  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43057823181152344  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.259904384613037  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.260311126708984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4331784248352051  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.261878967285156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.262285709381104  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4333162307739258  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22622299194336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.226629734039307  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4351520538330078  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.249762058258057  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.250168800354004  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43819475173950195  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29154109954834  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.291947841644287  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4392209053039551  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.224070072174072  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22447681427002  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4416050910949707  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.291390419006348  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.291797161102295  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4425368309020996  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.270369052886963  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27077579498291  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44321346282958984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.16549015045166  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.165896892547607  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4462404251098633  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.339723587036133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.34013032913208  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44769287109375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.298885345458984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29929208755493  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44921875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.246187210083008  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.246593952178955  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45044851303100586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.249122619628906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.249529361724854  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45348596572875977  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.339250087738037  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.339656829833984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45465898513793945  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23483419418335  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.235240936279297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4566774368286133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.347447395324707  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.347854137420654  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4545431137084961  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.120880126953125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.121286869049072  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45972347259521484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.248958110809326  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.249364852905273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4597926139831543  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24228048324585  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.242687225341797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46227550506591797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.255954265594482  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25636100769043  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4638686180114746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.206908226013184  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.20731496810913  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46560001373291016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.270829677581787  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.271236419677734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46816396713256836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.273731231689453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2741379737854  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4693279266357422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.323791980743408  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.324198722839355  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4711627960205078  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26381015777588  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.264216899871826  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47243309020996094  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2586932182312  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25909996032715  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4756016731262207  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.279910564422607  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.280317306518555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47580671310424805  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.278165340423584  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27857208251953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47806644439697266  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.315374851226807  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.315781593322754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47888708114624023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.28891134262085  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.289318084716797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48192739486694336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.272122859954834  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27252960205078  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48386049270629883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.309523582458496  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.309930324554443  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4833793640136719  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.193414211273193  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19382095336914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48544740676879883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2786226272583  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.279029369354248  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4884772300720215  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.286726474761963  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.28713321685791  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.49043798446655273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27617359161377  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.276580333709717  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4907803535461426  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.119473457336426  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.119874477386475  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4959268569946289  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.39906156063079834
pure train time :  17.07845640182495
train time :  40.46130990982056
end to end time :  81.6126799583435
connection check time:  24.17550039291382
block generation time  14.04306411743164
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3000, 3001, 3002]), tensor([3003, 3004, 3005,  ..., 5997, 5998, 5999]), tensor([6001, 6002, 6003,  ..., 9063, 9064, 9065]), tensor([ 9066,  9067,  9068,  ..., 12079, 12080, 12081]), tensor([12083, 12084, 12085,  ..., 15071, 15072, 15073]), tensor([15074, 15075, 15076,  ..., 18053, 18055, 18056]), tensor([18057, 18058, 18059,  ..., 21065, 21066, 21067]), tensor([21068, 21069, 21070,  ..., 24055, 24056, 24057]), tensor([24058, 24059, 24060,  ..., 27054, 27055, 27056]), tensor([27057, 27058, 27059,  ..., 30070, 30071, 30072]), tensor([30073, 30074, 30075,  ..., 33085, 33086, 33088]), tensor([33089, 33090, 33091,  ..., 36101, 36102, 36103]), tensor([36104, 36105, 36106,  ..., 39088, 39089, 39090]), tensor([39091, 39092, 39094,  ..., 42109, 42110, 42111]), tensor([42112, 42113, 42114,  ..., 45123, 45124, 45125]), tensor([45126, 45127, 45128,  ..., 48137, 48138, 48139]), tensor([48140, 48141, 48142,  ..., 51146, 51147, 51148]), tensor([51149, 51150, 51151,  ..., 54165, 54166, 54167]), tensor([54169, 54170, 54171,  ..., 57165, 57166, 57167]), tensor([57169, 57170, 57171,  ..., 60185, 60186, 60187]), tensor([60188, 60189, 60190,  ..., 63209, 63210, 63211]), tensor([63212, 63213, 63214,  ..., 66240, 66241, 66242]), tensor([66243, 66244, 66245,  ..., 69258, 69259, 69260]), tensor([69261, 69262, 69263,  ..., 72277, 72278, 72279]), tensor([72280, 72281, 72282,  ..., 75284, 75285, 75286]), tensor([75287, 75289, 75290,  ..., 78296, 78297, 78298]), tensor([78299, 78300, 78301,  ..., 81301, 81302, 81303]), tensor([81304, 81305, 81307,  ..., 84304, 84305, 84306]), tensor([84307, 84308, 84309,  ..., 87318, 87319, 87320]), tensor([87321, 87322, 87323,  ..., 90354, 90355, 90356]), tensor([90357, 90358, 90359,  ..., 93357, 93358, 93362]), tensor([93363, 93364, 93365,  ..., 96355, 96356, 96357]), tensor([96358, 96359, 96360,  ..., 99371, 99372, 99373]), tensor([ 99374,  99375,  99376,  ..., 102382, 102383, 102384]), tensor([102385, 102386, 102387,  ..., 105444, 105445, 105447]), tensor([105448, 105450, 105451,  ..., 108440, 108441, 108442]), tensor([108444, 108445, 108446,  ..., 111431, 111432, 111433]), tensor([111434, 111435, 111436,  ..., 114423, 114424, 114425]), tensor([114426, 114427, 114429,  ..., 117450, 117451, 117452]), tensor([117453, 117455, 117456,  ..., 120425, 120426, 120427]), tensor([120428, 120430, 120431,  ..., 123402, 123403, 123404]), tensor([123405, 123406, 123407,  ..., 126393, 126395, 126396]), tensor([126397, 126398, 126400,  ..., 129401, 129403, 129404]), tensor([129405, 129406, 129407,  ..., 132400, 132401, 132402]), tensor([132403, 132405, 132406,  ..., 135408, 135409, 135411]), tensor([135412, 135413, 135414,  ..., 138447, 138449, 138450]), tensor([138451, 138453, 138454,  ..., 141471, 141472, 141473]), tensor([141474, 141475, 141476,  ..., 144503, 144505, 144506]), tensor([144507, 144508, 144509,  ..., 147504, 147505, 147506]), tensor([147508, 147509, 147510,  ..., 150492, 150493, 150494]), tensor([150495, 150496, 150497,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.44869136810302734
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004029273986816406
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.022374868392944336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.45596790313720703
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.27185320854187
self.buckets_partition() spend  sec:  0.47837233543395996
check connections block*********************************

the find indices time spent  0.08070707321166992

in edges time spent  0.7194609642028809
local to global src and eids time spent  1.7501637935638428
time gen tails  0.35857224464416504
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  1.779475212097168

----------------------------------------
check connections block*********************************

the find indices time spent  0.813488245010376

in edges time spent  6.123679876327515
local to global src and eids time spent  9.8342764377594
time gen tails  1.672590732574463
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.456707000732422

block collection to dataloader spend  9.179115295410156e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4090113639831543  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.229872703552246  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.228614807128906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.40908193588256836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.16375732421875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.164164066314697  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4110279083251953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.298553943634033  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29896068572998  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4103207588195801  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.106497764587402  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.10690450668335  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41222524642944336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.197020530700684  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19742727279663  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41521358489990234  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.21605110168457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.216457843780518  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4168267250061035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.230136394500732  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23054313659668  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41893482208251953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.305514335632324  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30592107772827  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42075300216674805  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.233514308929443  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23392105102539  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4229559898376465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.309897422790527  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.310304164886475  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42342519760131836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.167935371398926  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.168342113494873  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42553281784057617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.17768621444702  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.17809295654297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42676258087158203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.224133491516113  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22454023361206  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.426210880279541  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.133790969848633  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.13419771194458  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4300570487976074  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.259496212005615  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.259902954101562  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4335308074951172  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.323819637298584  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.32422637939453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43431806564331055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2555513381958  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.255958080291748  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4351072311401367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.250010013580322  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25041675567627  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.437589168548584  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.21962070465088  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.220027446746826  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43815183639526367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.237596035003662  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23800277709961  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44014978408813477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.242785930633545  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.243192672729492  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44141340255737305  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22521686553955  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.225623607635498  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4440937042236328  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.261520862579346  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.261927604675293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4450850486755371  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.195402145385742  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19580888748169  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4475221633911133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.277892589569092  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27829933166504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44817161560058594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.237401008605957  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.237807750701904  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4499549865722656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25457000732422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.254976749420166  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45261287689208984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.304028034210205  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.304434776306152  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45437192916870117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.253934860229492  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25434160232544  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45572900772094727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26181936264038  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.262226104736328  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45805835723876953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27940845489502  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.279815196990967  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4583759307861328  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.291630744934082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29203748703003  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46163225173950195  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.31416606903076  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.31457281112671  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4621415138244629  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.257401943206787  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.257808685302734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46501779556274414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.283196449279785  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.283603191375732  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4665565490722656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.35472011566162  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.35512685775757  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46706628799438477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2506365776062  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25104331970215  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4675426483154297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25221872329712  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.252625465393066  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4714827537536621  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30841302871704  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30881977081299  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4728226661682129  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25918436050415  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.259591102600098  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4732522964477539  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.285542488098145  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.285949230194092  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47561120986938477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.363117218017578  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.363523960113525  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4780540466308594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.32688856124878  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.327295303344727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47942066192626953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.31380271911621  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.314209461212158  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4812440872192383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.323094844818115  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.323501586914062  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4827756881713867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.268736362457275  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.269143104553223  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48415088653564453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.371938705444336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.372345447540283  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4856758117675781  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.222174644470215  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.222581386566162  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48824310302734375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.34116792678833  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.341574668884277  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4884490966796875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.239060878753662  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23946762084961  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4898085594177246  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.15242052078247  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.15282154083252  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4949636459350586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.3828487992286682
pure train time :  17.466021299362183
train time :  40.80770468711853
end to end time :  81.70496249198914
connection check time:  24.33878755569458
block generation time  14.23618221282959
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   1,    2,    3,  ..., 3033, 3034, 3035]), tensor([3036, 3037, 3038,  ..., 6026, 6027, 6028]), tensor([6029, 6031, 6033,  ..., 9017, 9018, 9019]), tensor([ 9020,  9021,  9022,  ..., 12023, 12024, 12026]), tensor([12027, 12028, 12029,  ..., 15006, 15007, 15008]), tensor([15009, 15011, 15012,  ..., 17999, 18000, 18002]), tensor([18003, 18004, 18005,  ..., 21012, 21013, 21014]), tensor([21015, 21016, 21017,  ..., 24050, 24051, 24052]), tensor([24053, 24054, 24055,  ..., 27060, 27061, 27062]), tensor([27064, 27065, 27066,  ..., 30032, 30033, 30034]), tensor([30035, 30036, 30037,  ..., 33070, 33071, 33072]), tensor([33073, 33074, 33075,  ..., 36083, 36084, 36086]), tensor([36087, 36088, 36090,  ..., 39079, 39080, 39081]), tensor([39082, 39083, 39084,  ..., 42068, 42070, 42071]), tensor([42072, 42073, 42074,  ..., 45053, 45054, 45055]), tensor([45056, 45057, 45058,  ..., 48076, 48077, 48078]), tensor([48079, 48080, 48081,  ..., 51096, 51097, 51099]), tensor([51100, 51102, 51103,  ..., 54108, 54110, 54111]), tensor([54113, 54114, 54115,  ..., 57112, 57113, 57114]), tensor([57116, 57117, 57118,  ..., 60141, 60142, 60143]), tensor([60144, 60145, 60148,  ..., 63167, 63168, 63169]), tensor([63170, 63171, 63172,  ..., 66152, 66153, 66154]), tensor([66155, 66157, 66158,  ..., 69195, 69196, 69197]), tensor([69198, 69199, 69200,  ..., 72241, 72242, 72243]), tensor([72244, 72245, 72246,  ..., 75248, 75249, 75251]), tensor([75252, 75253, 75255,  ..., 78265, 78266, 78267]), tensor([78268, 78269, 78270,  ..., 81286, 81287, 81288]), tensor([81289, 81292, 81293,  ..., 84285, 84286, 84287]), tensor([84288, 84289, 84290,  ..., 87290, 87291, 87292]), tensor([87293, 87294, 87296,  ..., 90285, 90286, 90287]), tensor([90288, 90289, 90290,  ..., 93305, 93307, 93308]), tensor([93309, 93311, 93312,  ..., 96298, 96299, 96301]), tensor([96303, 96304, 96305,  ..., 99317, 99318, 99319]), tensor([ 99320,  99321,  99322,  ..., 102302, 102303, 102304]), tensor([102305, 102306, 102307,  ..., 105298, 105299, 105300]), tensor([105301, 105302, 105303,  ..., 108285, 108286, 108287]), tensor([108288, 108289, 108291,  ..., 111298, 111299, 111300]), tensor([111301, 111302, 111303,  ..., 114301, 114302, 114303]), tensor([114304, 114305, 114306,  ..., 117328, 117329, 117331]), tensor([117332, 117333, 117334,  ..., 120302, 120303, 120304]), tensor([120305, 120306, 120307,  ..., 123326, 123327, 123328]), tensor([123329, 123331, 123332,  ..., 126359, 126360, 126361]), tensor([126362, 126363, 126364,  ..., 129367, 129368, 129369]), tensor([129370, 129371, 129373,  ..., 132328, 132329, 132330]), tensor([132331, 132332, 132333,  ..., 135329, 135330, 135332]), tensor([135333, 135334, 135335,  ..., 138380, 138381, 138382]), tensor([138383, 138384, 138386,  ..., 141423, 141424, 141425]), tensor([141427, 141428, 141429,  ..., 144424, 144425, 144426]), tensor([144427, 144428, 144429,  ..., 147436, 147437, 147438]), tensor([147439, 147440, 147441,  ..., 150469, 150471, 150472]), tensor([150474, 150475, 150476,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4846172332763672
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004980564117431641
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024028301239013672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4909505844116211
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  1.9376568794250488
self.buckets_partition() spend  sec:  0.5150060653686523
check connections block*********************************

the find indices time spent  0.07218337059020996

in edges time spent  0.6936361789703369
local to global src and eids time spent  1.4229710102081299
time gen tails  0.36017584800720215
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.32218337059021

----------------------------------------
check connections block*********************************

the find indices time spent  0.8901798725128174

in edges time spent  5.455223083496094
local to global src and eids time spent  10.272497177124023
time gen tails  1.645150899887085
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.858680725097656

block collection to dataloader spend  8.654594421386719e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.40784597396850586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.217293739318848  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.216035842895508  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.40813350677490234  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.1994366645813  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.199843406677246  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4095907211303711  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.151031017303467  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.151437759399414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41233396530151367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.251044273376465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.251451015472412  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41289234161376953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2560133934021  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.256420135498047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4168877601623535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.323575973510742  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.32398271560669  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41620731353759766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.198418140411377  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.198824882507324  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41872596740722656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30555820465088  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.305964946746826  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41965198516845703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.223172187805176  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.223578929901123  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4229869842529297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27456569671631  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.274972438812256  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42516183853149414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.320993900299072  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.32140064239502  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4262714385986328  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25022602081299  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.250632762908936  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42711448669433594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25634527206421  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.256752014160156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4293398857116699  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.260085582733154  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2604923248291  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43075037002563477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.256770610809326  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.257177352905273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43158960342407227  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22743320465088  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.227839946746826  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4347653388977051  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.275672912597656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.276079654693604  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4350471496582031  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.158824920654297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.159231662750244  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4373469352722168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.269801139831543  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27020788192749  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4383702278137207  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.237614154815674  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23802089691162  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44141530990600586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.32688283920288  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.327289581298828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44187068939208984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.33157205581665  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.331978797912598  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44403743743896484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.332102298736572  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.33250904083252  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44491052627563477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.1751766204834  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.175583362579346  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44693994522094727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.177733898162842  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.17814064025879  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4492650032043457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.33978271484375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.340189456939697  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45105552673339844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.260353565216064  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26076030731201  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4526972770690918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23691463470459  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.237321376800537  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4531850814819336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19138240814209  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.191789150238037  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45552587509155273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26278257369995  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2631893157959  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45856475830078125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.341423511505127  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.341830253601074  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4613494873046875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.351816177368164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.35222291946411  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4600529670715332  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.197752952575684  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.19815969467163  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4628872871398926  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.200307369232178  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.200714111328125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46254920959472656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.176573276519775  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.176980018615723  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4647841453552246  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.245575428009033  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24598217010498  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4686775207519531  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30083990097046  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.301246643066406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47034692764282227  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.359755039215088  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.360161781311035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47109222412109375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.299885272979736  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.300292015075684  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47373104095458984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.285295486450195  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.285702228546143  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47452306747436523  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.272368907928467  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.272775650024414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47531986236572266  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29893732070923  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.299344062805176  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4774303436279297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.294785499572754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2951922416687  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4775857925415039  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.284453868865967  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.284860610961914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4811387062072754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29691505432129  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.297321796417236  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48288536071777344  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.269620418548584  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.27002716064453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4848942756652832  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.324545860290527  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.324952602386475  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48605966567993164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.283979415893555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.284386157989502  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4875469207763672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29359722137451  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29400396347046  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.49049806594848633  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.28553056716919  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.285937309265137  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4911680221557617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.17180871963501  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.17220973968506  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.49632692337036133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.36030593514442444
pure train time :  17.305277347564697
train time :  40.74148654937744
end to end time :  80.98153281211853
connection check time:  24.08024001121521
block generation time  14.180864095687866
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3027, 3029, 3030]), tensor([3031, 3032, 3033,  ..., 6032, 6033, 6034]), tensor([6035, 6036, 6037,  ..., 9046, 9048, 9049]), tensor([ 9050,  9051,  9052,  ..., 12069, 12070, 12071]), tensor([12072, 12073, 12074,  ..., 15078, 15079, 15080]), tensor([15082, 15083, 15084,  ..., 18089, 18090, 18092]), tensor([18093, 18094, 18095,  ..., 21105, 21106, 21107]), tensor([21108, 21109, 21110,  ..., 24114, 24115, 24116]), tensor([24117, 24118, 24119,  ..., 27121, 27123, 27124]), tensor([27126, 27127, 27128,  ..., 30130, 30131, 30132]), tensor([30133, 30134, 30135,  ..., 33147, 33148, 33149]), tensor([33150, 33151, 33152,  ..., 36150, 36151, 36152]), tensor([36153, 36154, 36155,  ..., 39136, 39137, 39138]), tensor([39140, 39141, 39142,  ..., 42165, 42166, 42168]), tensor([42169, 42170, 42172,  ..., 45155, 45156, 45157]), tensor([45158, 45160, 45161,  ..., 48145, 48146, 48147]), tensor([48148, 48149, 48150,  ..., 51131, 51132, 51133]), tensor([51134, 51135, 51137,  ..., 54135, 54136, 54137]), tensor([54138, 54140, 54141,  ..., 57141, 57142, 57145]), tensor([57146, 57147, 57148,  ..., 60173, 60174, 60175]), tensor([60176, 60177, 60178,  ..., 63186, 63187, 63188]), tensor([63189, 63190, 63191,  ..., 66209, 66210, 66211]), tensor([66212, 66213, 66214,  ..., 69204, 69206, 69207]), tensor([69208, 69209, 69210,  ..., 72220, 72221, 72222]), tensor([72223, 72224, 72225,  ..., 75242, 75243, 75244]), tensor([75245, 75246, 75247,  ..., 78236, 78237, 78238]), tensor([78239, 78240, 78241,  ..., 81232, 81233, 81234]), tensor([81236, 81237, 81238,  ..., 84228, 84229, 84231]), tensor([84232, 84233, 84234,  ..., 87191, 87193, 87194]), tensor([87195, 87196, 87197,  ..., 90232, 90233, 90234]), tensor([90235, 90236, 90237,  ..., 93253, 93255, 93256]), tensor([93257, 93258, 93259,  ..., 96297, 96298, 96299]), tensor([96300, 96301, 96302,  ..., 99303, 99304, 99305]), tensor([ 99306,  99307,  99308,  ..., 102305, 102306, 102307]), tensor([102308, 102309, 102310,  ..., 105319, 105320, 105321]), tensor([105322, 105323, 105325,  ..., 108319, 108320, 108321]), tensor([108322, 108323, 108324,  ..., 111343, 111344, 111346]), tensor([111347, 111348, 111349,  ..., 114353, 114355, 114356]), tensor([114357, 114358, 114360,  ..., 117325, 117327, 117328]), tensor([117329, 117330, 117331,  ..., 120324, 120325, 120327]), tensor([120328, 120329, 120330,  ..., 123335, 123336, 123337]), tensor([123338, 123339, 123340,  ..., 126371, 126372, 126373]), tensor([126374, 126375, 126376,  ..., 129385, 129386, 129387]), tensor([129388, 129389, 129394,  ..., 132387, 132390, 132392]), tensor([132393, 132394, 132395,  ..., 135392, 135393, 135394]), tensor([135395, 135396, 135397,  ..., 138416, 138417, 138418]), tensor([138419, 138420, 138421,  ..., 141434, 141435, 141436]), tensor([141437, 141438, 141440,  ..., 144459, 144460, 144462]), tensor([144463, 144464, 144465,  ..., 147458, 147459, 147460]), tensor([147461, 147462, 147463,  ..., 150464, 150465, 150466]), tensor([150467, 150468, 150469,  ..., 153426, 153427, 153429])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.5006103515625
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.000537872314453125
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.022185564041137695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5087418556213379
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  3.0496280193328857
self.buckets_partition() spend  sec:  0.5309603214263916
check connections block*********************************

the find indices time spent  0.0724344253540039

in edges time spent  0.754204511642456
local to global src and eids time spent  2.125613212585449
time gen tails  0.3969542980194092
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.3509023189544678

----------------------------------------
check connections block*********************************

the find indices time spent  0.807257890701294

in edges time spent  5.887753486633301
local to global src and eids time spent  10.143409252166748
time gen tails  1.6836111545562744
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.062082052230835

block collection to dataloader spend  0.00010967254638671875
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.40783119201660156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.20089054107666  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.199632167816162  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.40792083740234375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.139958381652832  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.14036512374878  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41129255294799805  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30063819885254  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.301044940948486  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4104633331298828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.14973258972168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.150139331817627  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41313743591308594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.241377353668213  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24178409576416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4161348342895508  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.259163856506348  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.259570598602295  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4179091453552246  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23374366760254  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.234150409698486  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41773223876953125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.15824842453003  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.158655166625977  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4208211898803711  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.334065914154053  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.33447265625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4207925796508789  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.20585536956787  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.20626211166382  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42149782180786133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.114914417266846  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.115321159362793  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4249687194824219  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22190570831299  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.222312450408936  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4278273582458496  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.321563243865967  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.321969985961914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4294142723083496  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26402759552002  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.264434337615967  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42998218536376953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24139928817749  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.241806030273438  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4309849739074707  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.222569942474365  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.222976684570312  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43314361572265625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.227749347686768  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.228156089782715  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43562793731689453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.195732593536377  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.196139335632324  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4365100860595703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.272562980651855  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.272969722747803  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43848705291748047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23357105255127  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.233977794647217  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4395427703857422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.178815841674805  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.179222583770752  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44220495223999023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26375913619995  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2641658782959  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44321632385253906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.229430198669434  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22983694076538  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4461545944213867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.252601623535156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.253008365631104  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44816064834594727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.300453662872314  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30086040496826  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44910192489624023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.258878707885742  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25928544998169  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4505739212036133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.239294052124023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23970079421997  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45244598388671875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23779582977295  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.238202571868896  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4536561965942383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23773956298828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23814630508423  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45405101776123047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.16860294342041  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.169009685516357  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45879364013671875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30086851119995  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.3012752532959  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4587669372558594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.267282009124756  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.267688751220703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4607100486755371  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.179102420806885  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.179509162902832  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46251773834228516  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.281540393829346  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.281947135925293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46315956115722656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24590015411377  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.246306896209717  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46656131744384766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.369142055511475  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.369548797607422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4674949645996094  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30962610244751  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.310032844543457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46868896484375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.260380744934082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26078748703003  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47090911865234375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.358782291412354  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.3591890335083  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47156381607055664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25954294204712  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.259949684143066  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47356700897216797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.257437229156494  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25784397125244  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4760317802429199  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.365962982177734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.36636972427368  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4784374237060547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.314038276672363  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.31444501876831  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4781637191772461  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.216437339782715  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.216844081878662  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4815101623535156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.314799308776855  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.315206050872803  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4827747344970703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.368187427520752  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.3685941696167  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4840049743652344  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.31601905822754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.316425800323486  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48665475845336914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.33640956878662  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.33681631088257  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48725223541259766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.284687519073486  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.285094261169434  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4899163246154785  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.304795742034912  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30520248413086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48984718322753906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.102378368377686  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.102779388427734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.49498796463012695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.3453104794025421
pure train time :  17.33353543281555
train time :  40.72369074821472
end to end time :  83.59673857688904
connection check time:  25.363286018371582
block generation time  14.412984371185303
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2978, 2979, 2980]), tensor([2981, 2982, 2983,  ..., 5986, 5987, 5988]), tensor([5989, 5990, 5991,  ..., 9010, 9011, 9012]), tensor([ 9014,  9015,  9017,  ..., 12041, 12042, 12043]), tensor([12044, 12045, 12046,  ..., 15034, 15035, 15036]), tensor([15037, 15038, 15039,  ..., 18037, 18038, 18039]), tensor([18040, 18043, 18044,  ..., 21018, 21019, 21020]), tensor([21021, 21022, 21023,  ..., 24024, 24025, 24026]), tensor([24027, 24028, 24029,  ..., 27037, 27038, 27039]), tensor([27040, 27041, 27042,  ..., 30060, 30061, 30063]), tensor([30064, 30065, 30066,  ..., 33070, 33071, 33072]), tensor([33073, 33074, 33075,  ..., 36071, 36072, 36074]), tensor([36075, 36076, 36077,  ..., 39056, 39057, 39058]), tensor([39059, 39060, 39062,  ..., 42075, 42076, 42077]), tensor([42078, 42079, 42080,  ..., 45079, 45080, 45081]), tensor([45083, 45085, 45087,  ..., 48089, 48090, 48091]), tensor([48092, 48093, 48094,  ..., 51069, 51070, 51071]), tensor([51073, 51074, 51075,  ..., 54092, 54093, 54094]), tensor([54095, 54096, 54097,  ..., 57078, 57079, 57080]), tensor([57081, 57082, 57083,  ..., 60112, 60113, 60114]), tensor([60115, 60116, 60117,  ..., 63129, 63130, 63131]), tensor([63132, 63133, 63134,  ..., 66138, 66139, 66140]), tensor([66141, 66142, 66143,  ..., 69101, 69102, 69103]), tensor([69104, 69105, 69106,  ..., 72111, 72112, 72113]), tensor([72114, 72115, 72116,  ..., 75125, 75126, 75127]), tensor([75128, 75129, 75130,  ..., 78114, 78115, 78116]), tensor([78117, 78118, 78119,  ..., 81108, 81109, 81110]), tensor([81111, 81112, 81113,  ..., 84122, 84124, 84127]), tensor([84128, 84129, 84130,  ..., 87159, 87160, 87161]), tensor([87162, 87163, 87164,  ..., 90168, 90169, 90170]), tensor([90171, 90172, 90174,  ..., 93184, 93185, 93187]), tensor([93188, 93189, 93190,  ..., 96186, 96187, 96188]), tensor([96189, 96190, 96191,  ..., 99211, 99212, 99213]), tensor([ 99214,  99215,  99216,  ..., 102206, 102207, 102208]), tensor([102209, 102210, 102212,  ..., 105238, 105239, 105241]), tensor([105242, 105243, 105244,  ..., 108234, 108235, 108236]), tensor([108237, 108238, 108239,  ..., 111222, 111223, 111224]), tensor([111225, 111226, 111227,  ..., 114236, 114237, 114238]), tensor([114240, 114241, 114242,  ..., 117245, 117246, 117247]), tensor([117248, 117249, 117251,  ..., 120264, 120265, 120266]), tensor([120267, 120268, 120269,  ..., 123320, 123321, 123322]), tensor([123323, 123325, 123326,  ..., 126377, 126378, 126379]), tensor([126380, 126381, 126382,  ..., 129341, 129342, 129343]), tensor([129344, 129345, 129346,  ..., 132341, 132342, 132343]), tensor([132344, 132345, 132346,  ..., 135387, 135388, 135389]), tensor([135390, 135391, 135392,  ..., 138399, 138400, 138402]), tensor([138404, 138405, 138406,  ..., 141397, 141398, 141399]), tensor([141400, 141401, 141402,  ..., 144416, 144417, 144418]), tensor([144419, 144421, 144422,  ..., 147435, 147436, 147437]), tensor([147438, 147439, 147441,  ..., 150457, 150458, 150459]), tensor([150460, 150461, 150462,  ..., 153427, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.49454832077026367
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.00044465065002441406
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029699087142944336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.49950718879699707
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.5661168098449707
self.buckets_partition() spend  sec:  0.5292418003082275
check connections block*********************************

the find indices time spent  0.07064056396484375

in edges time spent  0.6818642616271973
local to global src and eids time spent  2.0767223834991455
time gen tails  0.3895077705383301
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.328038454055786

----------------------------------------
check connections block*********************************

the find indices time spent  0.8392505645751953

in edges time spent  6.107771158218384
local to global src and eids time spent  10.27314019203186
time gen tails  1.66542649269104
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.288416862487793

block collection to dataloader spend  0.00010395050048828125
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.40868091583251953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30158805847168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.300330638885498  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4091181755065918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30475950241089  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.305166244506836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41153764724731445  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30268383026123  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.303090572357178  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41159820556640625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.251808166503906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.252214908599854  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41304826736450195  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.15130853652954  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.15171527862549  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41532373428344727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23086929321289  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.231276035308838  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.41620302200317383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.201146125793457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.201552867889404  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4181938171386719  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.241644859313965  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.242051601409912  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42088890075683594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24821949005127  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.248626232147217  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4226417541503906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30951738357544  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.309924125671387  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4251260757446289  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22601079940796  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.226417541503906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4235820770263672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.145447254180908  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.145853996276855  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4270472526550293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.142558097839355  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.142964839935303  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.42708921432495117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.13094663619995  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.1313533782959  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4304990768432617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.28234100341797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.282747745513916  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4325251579284668  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.318996906280518  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.319403648376465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.432253360748291  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.222083568572998  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.222490310668945  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43599891662597656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.280397415161133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.28080415725708  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43770933151245117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.334423542022705  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.334830284118652  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.43909168243408203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26945924758911  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26986598968506  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44097137451171875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.327666759490967  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.328073501586914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44156932830810547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.293973922729492  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29438066482544  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44313716888427734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23873805999756  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.239144802093506  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44538021087646484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.280155181884766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.280561923980713  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4465484619140625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.247684955596924  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24809169769287  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.44954776763916016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.2347469329834  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.235153675079346  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.45043087005615234  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.237561225891113  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23796796798706  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4522666931152344  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26231050491333  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.262717247009277  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.453519344329834  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.282143115997314  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.28254985809326  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4540524482727051  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.1729793548584  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.173386096954346  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4566373825073242  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24913215637207  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.249538898468018  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4585280418395996  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.244208335876465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.244615077972412  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4605121612548828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.240201950073242  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.24060869216919  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46229124069213867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26648187637329  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.26688861846924  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46466827392578125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.357125282287598  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.357532024383545  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4664764404296875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.29253911972046  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.292945861816406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4667477607727051  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.17232036590576  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.17272710800171  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.46813344955444336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.135878562927246  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.136285305023193  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4698514938354492  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.25534200668335  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.255748748779297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4714021682739258  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.22006893157959  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.220475673675537  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.47290992736816406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.206800937652588  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.207207679748535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4759359359741211  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.257112503051758  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.257519245147705  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4777359962463379  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30144453048706  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.301851272583008  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4800891876220703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.276092529296875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.276499271392822  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.481778621673584  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.339796543121338  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.340203285217285  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4822568893432617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.23184061050415  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.232247352600098  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48456811904907227  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.33591651916504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.336323261260986  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.484560489654541  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.196115016937256  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.196521759033203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.48765039443969727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.300589084625244  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.30099582672119  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4891653060913086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.292892932891846  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.293299674987793  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 0.4894881248474121  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.082268714904785  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.3984375 GB
    Memory Allocated: 19.082669734954834  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4946269989013672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.33149880170822144
pure train time :  17.171767950057983
train time :  40.5926730632782
end to end time :  83.17544889450073
connection check time:  25.35985255241394
block generation time  14.616455316543579
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    3,  ..., 2986, 2987, 2988]), tensor([2989, 2990, 2991,  ..., 6007, 6008, 6010]), tensor([6011, 6012, 6013,  ..., 9029, 9030, 9031]), tensor([ 9032,  9033,  9034,  ..., 12037, 12038, 12039]), tensor([12040, 12041, 12042,  ..., 15037, 15039, 15040]), tensor([15041, 15042, 15043,  ..., 18048, 18049, 18051]), tensor([18052, 18053, 18054,  ..., 21083, 21085, 21086]), tensor([21087, 21088, 21089,  ..., 24074, 24076, 24077]), tensor([24078, 24079, 24080,  ..., 27086, 27087, 27088]), tensor([27089, 27090, 27091,  ..., 30093, 30094, 30095]), tensor([30096, 30097, 30098,  ..., 33115, 33116, 33117]), tensor([33118, 33119, 33120,  ..., 36114, 36115, 36116]), tensor([36117, 36118, 36119,  ..., 39108, 39109, 39110]), tensor([39111, 39112, 39113,  ..., 42076, 42077, 42078]), tensor([42079, 42080, 42082,  ..., 45103, 45104, 45105]), tensor([45106, 45107, 45108,  ..., 48112, 48113, 48114]), tensor([48116, 48117, 48119,  ..., 51088, 51089, 51090]), tensor([51091, 51092, 51093,  ..., 54129, 54130, 54131]), tensor([54132, 54133, 54134,  ..., 57149, 57150, 57151]), tensor([57152, 57154, 57155,  ..., 60169, 60170, 60172]), tensor([60173, 60174, 60175,  ..., 63170, 63172, 63173]), tensor([63174, 63176, 63177,  ..., 66172, 66173, 66174]), tensor([66175, 66176, 66177,  ..., 69173, 69174, 69175]), tensor([69176, 69177, 69178,  ..., 72181, 72182, 72183]), tensor([72184, 72185, 72186,  ..., 75205, 75206, 75208]), tensor([75209, 75210, 75211,  ..., 78227, 78228, 78229]), tensor([78230, 78231, 78232,  ..., 81238, 81239, 81241]), tensor([81242, 81243, 81244,  ..., 84246, 84247, 84248]), tensor([84249, 84250, 84251,  ..., 87268, 87269, 87270]), tensor([87271, 87272, 87273,  ..., 90244, 90245, 90246]), tensor([90248, 90249, 90250,  ..., 93263, 93265, 93266]), tensor([93267, 93268, 93269,  ..., 96300, 96302, 96303]), tensor([96304, 96305, 96306,  ..., 99294, 99295, 99296]), tensor([ 99297,  99298,  99299,  ..., 102321, 102322, 102323]), tensor([102324, 102325, 102327,  ..., 105317, 105318, 105319]), tensor([105320, 105322, 105323,  ..., 108304, 108305, 108306]), tensor([108307, 108308, 108309,  ..., 111337, 111338, 111339]), tensor([111340, 111341, 111343,  ..., 114321, 114322, 114323]), tensor([114324, 114325, 114326,  ..., 117327, 117328, 117329]), tensor([117330, 117331, 117332,  ..., 120337, 120338, 120339]), tensor([120343, 120344, 120345,  ..., 123341, 123343, 123344]), tensor([123345, 123346, 123347,  ..., 126365, 126366, 126367]), tensor([126368, 126369, 126370,  ..., 129413, 129414, 129415]), tensor([129416, 129417, 129418,  ..., 132418, 132419, 132420]), tensor([132422, 132423, 132424,  ..., 135461, 135462, 135463]), tensor([135464, 135465, 135466,  ..., 138463, 138464, 138465]), tensor([138466, 138467, 138468,  ..., 141438, 141439, 141440]), tensor([141442, 141443, 141444,  ..., 144458, 144459, 144460]), tensor([144461, 144463, 144464,  ..., 147453, 147454, 147455]), tensor([147457, 147459, 147460,  ..., 150464, 150465, 150466]), tensor([150467, 150468, 150469,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.501596212387085
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.00045299530029296875
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021251916885375977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5089490413665771
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.907806634902954
self.buckets_partition() spend  sec:  0.5302321910858154
check connections block*********************************

the find indices time spent  0.07103133201599121

in edges time spent  0.692197322845459
local to global src and eids time spent  2.0877697467803955
time gen tails  0.389911413192749
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.3497021198272705

----------------------------------------
check connections block*********************************

the find indices time spent  0.81170654296875

in edges time spent  6.131007432937622
local to global src and eids time spent  8.62403392791748
time gen tails  1.604745864868164
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.577930688858032

block collection to dataloader spend  7.843971252441406e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40949010848999023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.308844566345215  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.307587146759033  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4080038070678711  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.236267566680908  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.236674308776855  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4105377197265625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.202950954437256  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.203357696533203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4105825424194336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.297643661499023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29805040359497  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41346311569213867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.221341133117676  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.221747875213623  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4149661064147949  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.253817081451416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.254223823547363  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41611576080322266  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21333408355713  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.213740825653076  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41820478439331055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.209821701049805  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.210228443145752  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41992759704589844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.230521202087402  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23092794418335  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4205312728881836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21349000930786  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21389675140381  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4233541488647461  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.212937355041504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21334409713745  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4248480796813965  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23367929458618  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23408603668213  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4264960289001465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.268975257873535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.269381999969482  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4267764091491699  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21685266494751  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.217259407043457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4298872947692871  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.314234733581543  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31464147567749  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4323587417602539  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274186611175537  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274593353271484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43383359909057617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.220369338989258  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.220776081085205  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43453168869018555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.225117206573486  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.225523948669434  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4359908103942871  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21911334991455  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.219520092010498  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4378042221069336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.222724437713623  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22313117980957  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.439547061920166  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2345871925354  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.234993934631348  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4425044059753418  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.254801273345947  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.255208015441895  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4441714286804199  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.255363941192627  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.255770683288574  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44522762298583984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.251777172088623  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25218391418457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4481797218322754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27956199645996  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.279968738555908  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44940996170043945  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33685827255249  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.337265014648438  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4499812126159668  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.239381313323975  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.239788055419922  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4536929130554199  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.34087896347046  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.341285705566406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45424604415893555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2417311668396  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.242137908935547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4554438591003418  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.246466636657715  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.246873378753662  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45682811737060547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258716106414795  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.259122848510742  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45681047439575195  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.178122997283936  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.178529739379883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4596233367919922  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19495964050293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.195366382598877  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46180105209350586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2423095703125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.242716312408447  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4632425308227539  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.245378017425537  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.245784759521484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46671342849731445  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.285396575927734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28580331802368  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4675436019897461  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.275392055511475  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.275798797607422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46894407272338867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26826047897339  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.268667221069336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46947813034057617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258946895599365  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.259353637695312  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47278738021850586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.262686252593994  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26309299468994  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4742598533630371  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.282897472381592  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28330421447754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4755234718322754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274642944335938  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.275049686431885  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47622108459472656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.210708618164062  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21111536026001  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4784374237060547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.264554977416992  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26496171951294  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4802393913269043  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.305118560791016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.305525302886963  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4824528694152832  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.303613662719727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.304020404815674  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48302412033081055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2665696144104  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.266976356506348  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4859428405761719  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.232858180999756  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.233264923095703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48710107803344727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27342653274536  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27383327484131  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48967695236206055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.288797855377197  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.289204597473145  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4904317855834961  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.072932243347168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.073333263397217  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49556684494018555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.31725671887397766
pure train time :  17.191099405288696
train time :  40.53478813171387
end to end time :  80.93098306655884
connection check time:  23.51829504966736
block generation time  13.927632808685303
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    2,    3,  ..., 3005, 3007, 3008]), tensor([3009, 3010, 3011,  ..., 6032, 6033, 6034]), tensor([6035, 6036, 6037,  ..., 9044, 9045, 9046]), tensor([ 9048,  9049,  9050,  ..., 12058, 12059, 12060]), tensor([12061, 12062, 12063,  ..., 15079, 15080, 15082]), tensor([15083, 15084, 15085,  ..., 18072, 18073, 18074]), tensor([18075, 18076, 18078,  ..., 21089, 21090, 21092]), tensor([21093, 21094, 21097,  ..., 24066, 24067, 24068]), tensor([24070, 24071, 24072,  ..., 27080, 27081, 27082]), tensor([27083, 27084, 27085,  ..., 30114, 30115, 30117]), tensor([30118, 30119, 30120,  ..., 33115, 33116, 33117]), tensor([33118, 33119, 33120,  ..., 36103, 36104, 36105]), tensor([36106, 36108, 36109,  ..., 39153, 39154, 39155]), tensor([39156, 39157, 39158,  ..., 42174, 42175, 42176]), tensor([42177, 42178, 42180,  ..., 45186, 45187, 45188]), tensor([45189, 45190, 45191,  ..., 48187, 48188, 48189]), tensor([48190, 48191, 48193,  ..., 51203, 51204, 51205]), tensor([51206, 51207, 51208,  ..., 54229, 54230, 54231]), tensor([54232, 54233, 54234,  ..., 57215, 57216, 57217]), tensor([57218, 57219, 57220,  ..., 60218, 60219, 60220]), tensor([60221, 60222, 60223,  ..., 63251, 63252, 63253]), tensor([63254, 63255, 63256,  ..., 66279, 66280, 66281]), tensor([66282, 66283, 66284,  ..., 69256, 69257, 69258]), tensor([69259, 69260, 69261,  ..., 72244, 72245, 72246]), tensor([72247, 72248, 72249,  ..., 75265, 75266, 75267]), tensor([75268, 75269, 75271,  ..., 78261, 78262, 78263]), tensor([78264, 78265, 78266,  ..., 81284, 81285, 81286]), tensor([81288, 81289, 81290,  ..., 84269, 84270, 84271]), tensor([84272, 84273, 84276,  ..., 87261, 87263, 87264]), tensor([87265, 87266, 87267,  ..., 90278, 90279, 90280]), tensor([90281, 90282, 90283,  ..., 93332, 93333, 93334]), tensor([93335, 93336, 93338,  ..., 96351, 96352, 96353]), tensor([96354, 96355, 96356,  ..., 99336, 99337, 99338]), tensor([ 99339,  99340,  99341,  ..., 102347, 102348, 102349]), tensor([102350, 102351, 102352,  ..., 105339, 105340, 105341]), tensor([105342, 105343, 105344,  ..., 108326, 108327, 108328]), tensor([108329, 108330, 108331,  ..., 111325, 111326, 111327]), tensor([111328, 111329, 111330,  ..., 114354, 114355, 114356]), tensor([114357, 114358, 114359,  ..., 117361, 117362, 117363]), tensor([117364, 117365, 117366,  ..., 120380, 120381, 120382]), tensor([120383, 120384, 120385,  ..., 123361, 123362, 123363]), tensor([123364, 123365, 123367,  ..., 126377, 126378, 126379]), tensor([126380, 126381, 126382,  ..., 129397, 129398, 129399]), tensor([129401, 129402, 129403,  ..., 132399, 132400, 132401]), tensor([132402, 132403, 132404,  ..., 135421, 135422, 135423]), tensor([135424, 135425, 135426,  ..., 138425, 138426, 138427]), tensor([138428, 138429, 138430,  ..., 141446, 141447, 141448]), tensor([141449, 141450, 141451,  ..., 144447, 144448, 144449]), tensor([144450, 144451, 144452,  ..., 147452, 147453, 147454]), tensor([147456, 147457, 147458,  ..., 150460, 150461, 150462]), tensor([150463, 150464, 150465,  ..., 153427, 153428, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.47948122024536133
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004551410675048828
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02426600456237793
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48515796661376953
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  1.7369184494018555
self.buckets_partition() spend  sec:  0.5094568729400635
check connections block*********************************

the find indices time spent  0.07030725479125977

in edges time spent  0.6040148735046387
local to global src and eids time spent  2.1252381801605225
time gen tails  0.4171609878540039
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.3205482959747314

----------------------------------------
check connections block*********************************

the find indices time spent  0.8210761547088623

in edges time spent  6.038836479187012
local to global src and eids time spent  10.316305160522461
time gen tails  1.6767969131469727
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.833358764648438

block collection to dataloader spend  8.606910705566406e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4087867736816406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22980546951294  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.228548049926758  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40783262252807617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19251251220703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19291925430298  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4091973304748535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.1944260597229  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.194832801818848  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4111795425415039  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20490550994873  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.205312252044678  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41490697860717773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.302222728729248  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.302629470825195  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4141840934753418  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19874382019043  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.199150562286377  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4181175231933594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30454158782959  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.304948329925537  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41847944259643555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20316791534424  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.203574657440186  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4214448928833008  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25799560546875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258402347564697  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42142343521118164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.17658519744873  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.176991939544678  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4248166084289551  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26508665084839  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.265493392944336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4258599281311035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.322914600372314  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32332134246826  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42619848251342773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.180744171142578  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.181150913238525  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4289817810058594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.276705265045166  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.277112007141113  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43073463439941406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.247654914855957  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.248061656951904  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43163299560546875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23765277862549  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.238059520721436  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4331846237182617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21692657470703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21733331680298  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.436159610748291  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.234317302703857  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.234724044799805  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.436978816986084  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.275671005249023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27607774734497  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4391942024230957  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27394962310791  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274356365203857  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44063520431518555  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.255480766296387  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.255887508392334  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44274187088012695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.35042953491211  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.350836277008057  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44465065002441406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29783058166504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.298237323760986  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4446115493774414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.18204402923584  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.182450771331787  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4481039047241211  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30359125137329  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30399799346924  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44890689849853516  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.14236879348755  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.142775535583496  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45027637481689453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.257906913757324  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25831365585327  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45180273056030273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.18241262435913  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.182819366455078  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4549884796142578  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.339666843414307  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.340073585510254  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45643043518066406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.246659755706787  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.247066497802734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45791101455688477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.351147174835205  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.351553916931152  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4593958854675293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30470323562622  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.305109977722168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4599161148071289  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.281075954437256  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.281482696533203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46173954010009766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.248377323150635  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.248784065246582  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4649958610534668  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.35613489151001  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.356541633605957  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4646625518798828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.17931842803955  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.179725170135498  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4669036865234375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.306848526000977  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.307255268096924  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46802234649658203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.272884368896484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27329111099243  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.471743106842041  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.359771251678467  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.360177993774414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47237443923950195  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.259928703308105  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.260335445404053  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47387027740478516  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.190539360046387  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.190946102142334  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4757804870605469  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.218803882598877  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.219210624694824  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47732067108154297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29224681854248  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.292653560638428  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4788203239440918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.369632244110107  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.370038986206055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4814004898071289  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274364948272705  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274771690368652  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4829115867614746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.269765377044678  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.270172119140625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48404741287231445  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.267707347869873  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26811408996582  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4862937927246094  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.334121227264404  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33452796936035  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48699283599853516  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.325539588928223  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32594633102417  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49040985107421875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.331798553466797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.332205295562744  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4888010025024414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.00907850265503  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.009479522705078  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4939265251159668  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.3096701502799988
pure train time :  17.10688591003418
train time :  40.51187348365784
end to end time :  81.92125654220581
connection check time:  25.47921133041382
block generation time  14.153907060623169
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   1,    2,    3,  ..., 3052, 3053, 3054]), tensor([3055, 3056, 3058,  ..., 6067, 6068, 6070]), tensor([6071, 6072, 6073,  ..., 9091, 9092, 9093]), tensor([ 9094,  9095,  9096,  ..., 12095, 12097, 12098]), tensor([12099, 12100, 12101,  ..., 15122, 15123, 15124]), tensor([15125, 15126, 15127,  ..., 18111, 18112, 18113]), tensor([18114, 18115, 18116,  ..., 21100, 21101, 21102]), tensor([21103, 21104, 21105,  ..., 24093, 24094, 24095]), tensor([24096, 24097, 24099,  ..., 27127, 27128, 27130]), tensor([27131, 27132, 27133,  ..., 30110, 30111, 30112]), tensor([30113, 30114, 30115,  ..., 33167, 33169, 33170]), tensor([33171, 33172, 33173,  ..., 36175, 36176, 36177]), tensor([36178, 36179, 36180,  ..., 39153, 39154, 39155]), tensor([39156, 39157, 39158,  ..., 42151, 42153, 42154]), tensor([42155, 42156, 42157,  ..., 45182, 45183, 45184]), tensor([45185, 45186, 45187,  ..., 48180, 48181, 48182]), tensor([48183, 48184, 48185,  ..., 51180, 51181, 51182]), tensor([51183, 51184, 51185,  ..., 54177, 54178, 54179]), tensor([54180, 54181, 54182,  ..., 57177, 57178, 57180]), tensor([57182, 57183, 57185,  ..., 60212, 60214, 60215]), tensor([60216, 60217, 60218,  ..., 63198, 63200, 63201]), tensor([63202, 63203, 63204,  ..., 66225, 66226, 66227]), tensor([66228, 66230, 66231,  ..., 69255, 69257, 69258]), tensor([69259, 69260, 69261,  ..., 72262, 72263, 72264]), tensor([72265, 72266, 72267,  ..., 75270, 75272, 75273]), tensor([75274, 75275, 75276,  ..., 78256, 78257, 78258]), tensor([78259, 78260, 78261,  ..., 81224, 81225, 81226]), tensor([81227, 81229, 81230,  ..., 84262, 84263, 84264]), tensor([84265, 84266, 84267,  ..., 87300, 87301, 87302]), tensor([87304, 87305, 87306,  ..., 90307, 90308, 90309]), tensor([90310, 90311, 90312,  ..., 93313, 93315, 93316]), tensor([93318, 93319, 93320,  ..., 96364, 96365, 96366]), tensor([96367, 96368, 96370,  ..., 99393, 99394, 99395]), tensor([ 99396,  99397,  99398,  ..., 102421, 102422, 102423]), tensor([102424, 102425, 102426,  ..., 105420, 105421, 105422]), tensor([105423, 105425, 105426,  ..., 108448, 108449, 108450]), tensor([108451, 108452, 108454,  ..., 111435, 111436, 111437]), tensor([111438, 111439, 111440,  ..., 114440, 114441, 114443]), tensor([114444, 114445, 114446,  ..., 117461, 117462, 117463]), tensor([117464, 117465, 117466,  ..., 120450, 120451, 120452]), tensor([120454, 120455, 120456,  ..., 123450, 123451, 123452]), tensor([123453, 123454, 123455,  ..., 126438, 126439, 126440]), tensor([126441, 126442, 126444,  ..., 129426, 129427, 129428]), tensor([129429, 129430, 129431,  ..., 132439, 132440, 132441]), tensor([132442, 132444, 132446,  ..., 135420, 135421, 135422]), tensor([135423, 135424, 135425,  ..., 138432, 138433, 138435]), tensor([138436, 138437, 138438,  ..., 141434, 141435, 141436]), tensor([141437, 141438, 141441,  ..., 144431, 144432, 144433]), tensor([144434, 144435, 144436,  ..., 147454, 147455, 147456]), tensor([147457, 147458, 147459,  ..., 150477, 150478, 150479]), tensor([150480, 150482, 150483,  ..., 153427, 153428, 153429])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.13947010040283203
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.00028324127197265625
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021218061447143555
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.14342665672302246
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  1.1305627822875977
self.buckets_partition() spend  sec:  0.1646709442138672
check connections block*********************************

the find indices time spent  0.07179880142211914

in edges time spent  0.6764125823974609
local to global src and eids time spent  1.4349169731140137
time gen tails  0.3569173812866211
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.435455322265625

----------------------------------------
check connections block*********************************

the find indices time spent  0.8023481369018555

in edges time spent  5.940603256225586
local to global src and eids time spent  10.408081531524658
time gen tails  1.7552390098571777
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.004946947097778

block collection to dataloader spend  0.00010585784912109375
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40871286392211914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.243593215942383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24233627319336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40591859817504883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.09586000442505  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.096266746520996  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41163158416748047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.300276279449463  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30068302154541  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41078996658325195  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.194114208221436  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.194520950317383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41391992568969727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2393159866333  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.239722728729248  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4149794578552246  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.222780227661133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22318696975708  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4178004264831543  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25413465499878  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.254541397094727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4178614616394043  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.207991123199463  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20839786529541  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4203791618347168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.216293334960938  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.216700077056885  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4227590560913086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.312411785125732  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31281852722168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4248690605163574  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.315970420837402  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31637716293335  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.426694393157959  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.260121822357178  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.260528564453125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42690420150756836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22046995162964  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.220876693725586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4286355972290039  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.262145042419434  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26255178451538  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4295644760131836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.15164041519165  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.152047157287598  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43180179595947266  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.252681255340576  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.253087997436523  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4337940216064453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.283452033996582  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28385877609253  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43419408798217773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.219609260559082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22001600265503  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43737173080444336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.244450569152832  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24485731124878  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43952465057373047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.335916996002197  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.336323738098145  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4411964416503906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.234671592712402  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23507833480835  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4416656494140625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.232872009277344  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23327875137329  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4433002471923828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.226696968078613  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22710371017456  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44406986236572266  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.181516647338867  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.181923389434814  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.446868896484375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23802947998047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.238436222076416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44869565963745117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26497983932495  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2653865814209  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45057153701782227  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258503913879395  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258910655975342  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4515566825866699  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.204038619995117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.204445362091064  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45418787002563477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.254152297973633  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25455904006958  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4557991027832031  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30518341064453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30559015274048  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4562830924987793  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.245041847229004  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24544858932495  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4579348564147949  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24732542037964  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.247732162475586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.460385799407959  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26186466217041  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.262271404266357  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46220922470092773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21329355239868  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21370029449463  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4634232521057129  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.256314277648926  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.256721019744873  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46659183502197266  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.311145782470703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31155252456665  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4674720764160156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.254189491271973  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25459623336792  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46942663192749023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28455686569214  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.284963607788086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4708881378173828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.257766246795654  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2581729888916  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4715003967285156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.215466022491455  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.215872764587402  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4739551544189453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26695203781128  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.267358779907227  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47667741775512695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.312991619110107  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.313398361206055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47858524322509766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.273850440979004  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27425718307495  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48024892807006836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.314757823944092  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31516456604004  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4807467460632324  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274093627929688  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274500370025635  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48168230056762695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263689041137695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.264095783233643  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48459291458129883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.312968254089355  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.313374996185303  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48745250701904297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.376659393310547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.377066135406494  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48539304733276367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.213451862335205  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.213858604431152  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4896121025085449  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.332931518554688  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.333338260650635  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48967552185058594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.07313871383667  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.07353973388672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4948086738586426  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.29321134090423584
pure train time :  17.383899450302124
train time :  40.70937180519104
end to end time :  82.65194654464722
connection check time:  26.33054780960083
block generation time  14.440402269363403
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2976, 2977, 2978]), tensor([2980, 2981, 2982,  ..., 6007, 6008, 6010]), tensor([6011, 6012, 6013,  ..., 9056, 9057, 9058]), tensor([ 9060,  9061,  9062,  ..., 12054, 12055, 12057]), tensor([12058, 12059, 12060,  ..., 15087, 15088, 15089]), tensor([15090, 15092, 15093,  ..., 18097, 18098, 18099]), tensor([18100, 18101, 18102,  ..., 21096, 21097, 21098]), tensor([21099, 21100, 21101,  ..., 24103, 24104, 24105]), tensor([24106, 24107, 24108,  ..., 27125, 27127, 27128]), tensor([27129, 27130, 27131,  ..., 30132, 30133, 30134]), tensor([30135, 30136, 30137,  ..., 33126, 33127, 33128]), tensor([33129, 33130, 33131,  ..., 36128, 36129, 36130]), tensor([36131, 36132, 36134,  ..., 39125, 39126, 39127]), tensor([39130, 39131, 39132,  ..., 42118, 42119, 42120]), tensor([42121, 42122, 42123,  ..., 45120, 45121, 45122]), tensor([45124, 45125, 45126,  ..., 48117, 48118, 48120]), tensor([48121, 48122, 48123,  ..., 51127, 51128, 51129]), tensor([51130, 51131, 51132,  ..., 54139, 54140, 54141]), tensor([54142, 54143, 54144,  ..., 57141, 57142, 57144]), tensor([57145, 57146, 57147,  ..., 60171, 60173, 60174]), tensor([60175, 60176, 60177,  ..., 63198, 63199, 63200]), tensor([63201, 63202, 63203,  ..., 66170, 66171, 66172]), tensor([66173, 66175, 66176,  ..., 69175, 69178, 69179]), tensor([69180, 69181, 69182,  ..., 72186, 72188, 72189]), tensor([72190, 72191, 72192,  ..., 75199, 75200, 75201]), tensor([75202, 75204, 75205,  ..., 78230, 78231, 78233]), tensor([78234, 78235, 78236,  ..., 81208, 81209, 81210]), tensor([81211, 81212, 81213,  ..., 84211, 84213, 84214]), tensor([84215, 84216, 84217,  ..., 87188, 87189, 87190]), tensor([87191, 87192, 87193,  ..., 90177, 90178, 90179]), tensor([90180, 90182, 90184,  ..., 93185, 93186, 93187]), tensor([93188, 93189, 93190,  ..., 96217, 96218, 96219]), tensor([96220, 96221, 96222,  ..., 99195, 99196, 99197]), tensor([ 99198,  99199,  99200,  ..., 102207, 102208, 102210]), tensor([102211, 102212, 102213,  ..., 105233, 105234, 105235]), tensor([105236, 105237, 105238,  ..., 108227, 108228, 108229]), tensor([108230, 108231, 108232,  ..., 111229, 111230, 111231]), tensor([111232, 111233, 111234,  ..., 114266, 114267, 114268]), tensor([114269, 114270, 114271,  ..., 117269, 117270, 117272]), tensor([117273, 117274, 117275,  ..., 120288, 120289, 120290]), tensor([120291, 120292, 120293,  ..., 123317, 123318, 123320]), tensor([123321, 123322, 123323,  ..., 126332, 126333, 126334]), tensor([126335, 126336, 126337,  ..., 129349, 129350, 129351]), tensor([129352, 129353, 129355,  ..., 132335, 132336, 132337]), tensor([132338, 132339, 132340,  ..., 135353, 135355, 135356]), tensor([135357, 135358, 135359,  ..., 138355, 138356, 138357]), tensor([138358, 138359, 138360,  ..., 141384, 141385, 141386]), tensor([141387, 141388, 141389,  ..., 144415, 144416, 144417]), tensor([144418, 144419, 144420,  ..., 147401, 147402, 147404]), tensor([147405, 147408, 147409,  ..., 150443, 150444, 150445]), tensor([150446, 150447, 150448,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.5012731552124023
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0005257129669189453
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024779558181762695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5093984603881836
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.905771017074585
self.buckets_partition() spend  sec:  0.534217119216919
check connections block*********************************

the find indices time spent  0.07046031951904297

in edges time spent  0.6832315921783447
local to global src and eids time spent  2.1004438400268555
time gen tails  0.4127635955810547
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.356928825378418

----------------------------------------
check connections block*********************************

the find indices time spent  0.8053457736968994

in edges time spent  5.879452228546143
local to global src and eids time spent  10.274240970611572
time gen tails  1.6689825057983398
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.122637271881104

block collection to dataloader spend  6.985664367675781e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4087381362915039  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.226040840148926  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.224783897399902  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40839529037475586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.243366241455078  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.243772983551025  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4096646308898926  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19294500350952  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19335174560547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4098529815673828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.123074531555176  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.123481273651123  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4128732681274414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.15743112564087  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.157837867736816  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41501283645629883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20036792755127  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.200774669647217  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41802167892456055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29978370666504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.300190448760986  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4179873466491699  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22621726989746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.226624011993408  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4208645820617676  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.306350231170654  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.3067569732666  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42011499404907227  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.1292142868042  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.129621028900146  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.422269344329834  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21697187423706  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.217378616333008  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42476892471313477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.14391565322876  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.144322395324707  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4289093017578125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.325300693511963  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32570743560791  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42801713943481445  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.244308948516846  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.244715690612793  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4299583435058594  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.213376998901367  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.213783740997314  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4313192367553711  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.278706550598145  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.279113292694092  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4348335266113281  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.277655601501465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.278062343597412  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.435943603515625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.328163623809814  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32857036590576  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43688535690307617  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26755142211914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.267958164215088  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4399905204772949  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23151969909668  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.231926441192627  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4414381980895996  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.247952461242676  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.248359203338623  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44281625747680664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25174903869629  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.252155780792236  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44426631927490234  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.262983798980713  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26339054107666  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44530534744262695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.265445232391357  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.265851974487305  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.446530818939209  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25823211669922  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258638858795166  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4488105773925781  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.330955982208252  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.3313627243042  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4501018524169922  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.203019618988037  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.203426361083984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4526996612548828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.271008014678955  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.271414756774902  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45300769805908203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.167150497436523  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16755723953247  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45676660537719727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24670171737671  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.247108459472656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45776939392089844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.346877574920654  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.3472843170166  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4600248336791992  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.346388339996338  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.346795082092285  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45953369140625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.296250820159912  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29665756225586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46185827255249023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.254359245300293  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25476598739624  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4644804000854492  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.252965927124023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25337266921997  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4661121368408203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28346300125122  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.283869743347168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46737241744995117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.256869792938232  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25727653503418  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46887683868408203  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.319287300109863  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31969404220581  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4711184501647949  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.290141582489014  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29054832458496  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4722890853881836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22368049621582  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.224087238311768  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47356176376342773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.229785442352295  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.230192184448242  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4764866828918457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.288826942443848  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.289233684539795  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47815990447998047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27696704864502  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.277373790740967  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47825002670288086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2649188041687  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26532554626465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48175716400146484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.277846336364746  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.278253078460693  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48372936248779297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.37054681777954  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.37095355987549  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.484285831451416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31043767929077  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31084442138672  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48642492294311523  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.268362045288086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.268768787384033  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4875302314758301  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.304935455322266  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.305342197418213  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4912858009338379  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.38208532333374  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.382492065429688  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4902043342590332  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.116151332855225  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.116552352905273  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4953498840332031  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.28267702460289
pure train time :  17.48467755317688
train time :  40.53098678588867
end to end time :  82.94517683982849
connection check time:  24.962563276290894
block generation time  14.479566097259521
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2973, 2974, 2975]), tensor([2976, 2977, 2978,  ..., 5971, 5972, 5973]), tensor([5974, 5975, 5976,  ..., 8946, 8947, 8948]), tensor([ 8949,  8950,  8951,  ..., 11953, 11954, 11955]), tensor([11956, 11957, 11958,  ..., 14930, 14931, 14932]), tensor([14933, 14934, 14935,  ..., 17938, 17939, 17940]), tensor([17941, 17942, 17943,  ..., 20941, 20942, 20943]), tensor([20945, 20946, 20947,  ..., 23944, 23949, 23950]), tensor([23952, 23953, 23954,  ..., 26982, 26983, 26984]), tensor([26986, 26987, 26988,  ..., 30019, 30020, 30021]), tensor([30022, 30023, 30024,  ..., 33015, 33016, 33017]), tensor([33018, 33019, 33020,  ..., 36031, 36032, 36033]), tensor([36034, 36035, 36036,  ..., 39059, 39060, 39061]), tensor([39062, 39063, 39064,  ..., 42076, 42077, 42078]), tensor([42079, 42080, 42081,  ..., 45079, 45080, 45081]), tensor([45082, 45083, 45084,  ..., 48095, 48096, 48097]), tensor([48098, 48099, 48100,  ..., 51074, 51075, 51076]), tensor([51078, 51079, 51080,  ..., 54093, 54094, 54095]), tensor([54096, 54097, 54098,  ..., 57110, 57112, 57113]), tensor([57114, 57115, 57116,  ..., 60170, 60171, 60172]), tensor([60175, 60176, 60177,  ..., 63188, 63190, 63191]), tensor([63192, 63193, 63194,  ..., 66208, 66209, 66210]), tensor([66211, 66212, 66213,  ..., 69180, 69181, 69182]), tensor([69183, 69184, 69185,  ..., 72170, 72171, 72172]), tensor([72173, 72174, 72175,  ..., 75178, 75179, 75180]), tensor([75181, 75182, 75184,  ..., 78191, 78193, 78194]), tensor([78195, 78196, 78197,  ..., 81198, 81199, 81200]), tensor([81201, 81202, 81204,  ..., 84219, 84222, 84223]), tensor([84225, 84226, 84227,  ..., 87247, 87248, 87249]), tensor([87250, 87251, 87252,  ..., 90294, 90295, 90296]), tensor([90297, 90298, 90299,  ..., 93282, 93283, 93284]), tensor([93285, 93286, 93287,  ..., 96279, 96280, 96281]), tensor([96282, 96283, 96284,  ..., 99275, 99276, 99277]), tensor([ 99278,  99279,  99280,  ..., 102301, 102302, 102303]), tensor([102304, 102307, 102308,  ..., 105338, 105339, 105340]), tensor([105341, 105342, 105343,  ..., 108332, 108333, 108334]), tensor([108335, 108336, 108337,  ..., 111358, 111359, 111360]), tensor([111361, 111362, 111363,  ..., 114331, 114332, 114333]), tensor([114334, 114335, 114338,  ..., 117340, 117341, 117342]), tensor([117344, 117345, 117347,  ..., 120368, 120369, 120370]), tensor([120371, 120372, 120373,  ..., 123395, 123396, 123397]), tensor([123398, 123399, 123400,  ..., 126422, 126423, 126424]), tensor([126425, 126426, 126427,  ..., 129426, 129427, 129428]), tensor([129429, 129430, 129431,  ..., 132451, 132452, 132454]), tensor([132456, 132457, 132458,  ..., 135452, 135453, 135454]), tensor([135455, 135456, 135457,  ..., 138476, 138477, 138478]), tensor([138479, 138480, 138481,  ..., 141498, 141500, 141501]), tensor([141502, 141503, 141504,  ..., 144488, 144489, 144490]), tensor([144491, 144492, 144493,  ..., 147477, 147478, 147480]), tensor([147481, 147482, 147483,  ..., 150488, 150489, 150490]), tensor([150491, 150492, 150493,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4305548667907715
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004112720489501953
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023591279983520508
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4355297088623047
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.416823148727417
self.buckets_partition() spend  sec:  0.4591512680053711
check connections block*********************************

the find indices time spent  0.07564663887023926

in edges time spent  0.5490612983703613
local to global src and eids time spent  1.8585631847381592
time gen tails  0.39183759689331055
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.386138916015625

----------------------------------------
check connections block*********************************

the find indices time spent  0.8174388408660889

in edges time spent  6.155160665512085
local to global src and eids time spent  10.025148868560791
time gen tails  1.7000727653503418
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.76725435256958

block collection to dataloader spend  6.961822509765625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40827465057373047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28891372680664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2876558303833  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40801477432250977  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.192922592163086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.193329334259033  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40960216522216797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.210885047912598  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.211291790008545  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41164112091064453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.261975288391113  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26238203048706  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4133634567260742  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.198448657989502  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19885540008545  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41533803939819336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.247131824493408  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.247538566589355  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41647863388061523  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16385555267334  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.164262294769287  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4180583953857422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21110248565674  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.211509227752686  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4209165573120117  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24399185180664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.244398593902588  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4220094680786133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.215492248535156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.215898990631104  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42490243911743164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.3128604888916  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31326723098755  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4246072769165039  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.169336318969727  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.169743061065674  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42693519592285156  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.257274627685547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.257681369781494  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42910194396972656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.174711227416992  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.17511796951294  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4302682876586914  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.228227138519287  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.228633880615234  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43340015411376953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2560396194458  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.256446361541748  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.434751033782959  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.277639389038086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.278046131134033  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.436309814453125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25270175933838  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.253108501434326  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43619441986083984  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.154272079467773  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.15467882156372  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4397878646850586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32474994659424  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.325156688690186  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4413414001464844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.289235591888428  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.289642333984375  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4434328079223633  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28911828994751  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.289525032043457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.443265438079834  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.185684204101562  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.18609094619751  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4448676109313965  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2441463470459  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.244553089141846  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44745635986328125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.243889808654785  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.244296550750732  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44861698150634766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19937515258789  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.199781894683838  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4508380889892578  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.339276790618896  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.339683532714844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4533810615539551  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28221607208252  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.282622814178467  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.453580379486084  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.337918281555176  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.338325023651123  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4559183120727539  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23914670944214  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.239553451538086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45807743072509766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.269035816192627  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.269442558288574  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45926332473754883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.361277103424072  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.36168384552002  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4618058204650879  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.35304880142212  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.353455543518066  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46322011947631836  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.270559310913086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.270966053009033  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4643540382385254  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.317375659942627  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.317782402038574  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4671149253845215  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.351984977722168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.352391719818115  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46738719940185547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26295757293701  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26336431503296  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4699869155883789  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.356546878814697  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.356953620910645  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47202301025390625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.373039722442627  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.373446464538574  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4718632698059082  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.224527835845947  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.224934577941895  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47435903549194336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258805751800537  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.259212493896484  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47563648223876953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.211063385009766  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.211470127105713  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4759984016418457  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.1916823387146  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.192089080810547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4801936149597168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32509136199951  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32549810409546  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48169946670532227  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27309560775757  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.273502349853516  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48332691192626953  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.370462894439697  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.370869636535645  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48437023162841797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.271633625030518  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.272040367126465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48541879653930664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.231146335601807  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.231553077697754  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4874300956726074  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.294585704803467  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.294992446899414  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48976707458496094  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31591796875  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.316324710845947  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49083614349365234  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.108055114746094  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.108456134796143  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49597883224487305  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.2728273570537567
pure train time :  17.603498935699463
train time :  40.591716289520264
end to end time :  82.90769386291504
connection check time:  24.702270030975342
block generation time  15.153393268585205
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2994, 2995, 2996]), tensor([2998, 3000, 3001,  ..., 5970, 5971, 5972]), tensor([5973, 5975, 5976,  ..., 8989, 8990, 8991]), tensor([ 8992,  8993,  8994,  ..., 12011, 12012, 12013]), tensor([12014, 12015, 12016,  ..., 15043, 15044, 15047]), tensor([15048, 15049, 15050,  ..., 18053, 18054, 18055]), tensor([18056, 18057, 18058,  ..., 21064, 21065, 21066]), tensor([21067, 21068, 21069,  ..., 24069, 24070, 24071]), tensor([24072, 24073, 24074,  ..., 27059, 27060, 27061]), tensor([27062, 27063, 27064,  ..., 30056, 30057, 30058]), tensor([30059, 30060, 30061,  ..., 33071, 33072, 33073]), tensor([33074, 33075, 33076,  ..., 36101, 36102, 36103]), tensor([36104, 36105, 36106,  ..., 39111, 39112, 39113]), tensor([39114, 39115, 39116,  ..., 42119, 42120, 42121]), tensor([42122, 42123, 42124,  ..., 45102, 45103, 45105]), tensor([45106, 45107, 45108,  ..., 48113, 48114, 48115]), tensor([48116, 48117, 48118,  ..., 51110, 51111, 51112]), tensor([51113, 51114, 51115,  ..., 54121, 54122, 54123]), tensor([54124, 54125, 54126,  ..., 57144, 57145, 57147]), tensor([57148, 57149, 57152,  ..., 60202, 60203, 60204]), tensor([60205, 60206, 60207,  ..., 63196, 63197, 63198]), tensor([63199, 63200, 63201,  ..., 66228, 66229, 66230]), tensor([66232, 66234, 66235,  ..., 69245, 69246, 69247]), tensor([69248, 69249, 69250,  ..., 72269, 72271, 72272]), tensor([72273, 72274, 72275,  ..., 75309, 75310, 75311]), tensor([75312, 75313, 75314,  ..., 78320, 78321, 78322]), tensor([78323, 78324, 78325,  ..., 81321, 81322, 81323]), tensor([81324, 81325, 81326,  ..., 84341, 84342, 84343]), tensor([84344, 84345, 84346,  ..., 87340, 87341, 87342]), tensor([87343, 87344, 87345,  ..., 90342, 90343, 90344]), tensor([90345, 90346, 90347,  ..., 93375, 93376, 93377]), tensor([93379, 93380, 93381,  ..., 96355, 96357, 96358]), tensor([96359, 96360, 96361,  ..., 99361, 99362, 99363]), tensor([ 99364,  99365,  99366,  ..., 102348, 102349, 102351]), tensor([102353, 102354, 102355,  ..., 105327, 105328, 105329]), tensor([105330, 105331, 105332,  ..., 108337, 108338, 108339]), tensor([108342, 108343, 108344,  ..., 111355, 111356, 111357]), tensor([111358, 111359, 111360,  ..., 114395, 114397, 114398]), tensor([114399, 114400, 114401,  ..., 117410, 117411, 117412]), tensor([117413, 117415, 117416,  ..., 120390, 120391, 120392]), tensor([120393, 120394, 120395,  ..., 123379, 123381, 123382]), tensor([123383, 123384, 123385,  ..., 126376, 126378, 126379]), tensor([126380, 126381, 126382,  ..., 129383, 129384, 129385]), tensor([129386, 129387, 129388,  ..., 132399, 132400, 132401]), tensor([132402, 132404, 132405,  ..., 135444, 135445, 135446]), tensor([135447, 135448, 135449,  ..., 138486, 138487, 138488]), tensor([138489, 138490, 138491,  ..., 141482, 141483, 141484]), tensor([141485, 141487, 141488,  ..., 144478, 144479, 144481]), tensor([144482, 144483, 144484,  ..., 147463, 147464, 147465]), tensor([147466, 147467, 147468,  ..., 150490, 150491, 150492]), tensor([150493, 150496, 150497,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.5012919902801514
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.000514984130859375
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021663188934326172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.5096287727355957
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.929568290710449
self.buckets_partition() spend  sec:  0.5313241481781006
check connections block*********************************

the find indices time spent  0.08151936531066895

in edges time spent  0.7027237415313721
local to global src and eids time spent  1.6625425815582275
time gen tails  0.3619198799133301
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.3664307594299316

----------------------------------------
check connections block*********************************

the find indices time spent  0.8148403167724609

in edges time spent  6.06782341003418
local to global src and eids time spent  9.978454113006592
time gen tails  1.6566996574401855
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.147719860076904

block collection to dataloader spend  0.00010442733764648438
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4085979461669922  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.293773651123047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.292516231536865  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.407503604888916  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.186168670654297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.186575412750244  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.409879207611084  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.239872455596924  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24027919769287  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.411041259765625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.1305251121521  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.130931854248047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41379308700561523  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.266849994659424  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26725673675537  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41503095626831055  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.155762672424316  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.156169414520264  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4176979064941406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25511646270752  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.255523204803467  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41867494583129883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24161195755005  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.242018699645996  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41989850997924805  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.168604850769043  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16901159286499  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42319583892822266  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32201385498047  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.322420597076416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4237251281738281  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.242759704589844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24316644668579  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4252028465270996  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.215898036956787  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.216304779052734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42697572708129883  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21824359893799  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.218650341033936  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4283719062805176  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.226057052612305  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.226463794708252  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43064308166503906  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.213645458221436  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.214052200317383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4324626922607422  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.227769374847412  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22817611694336  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4341397285461426  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2398624420166  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24026918411255  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43616342544555664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.358646392822266  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.359053134918213  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4364762306213379  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.071757793426514  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.07216453552246  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4398369789123535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32618522644043  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.326591968536377  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44077062606811523  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.281423568725586  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.281830310821533  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.441861629486084  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.197179794311523  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19758653640747  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44395875930786133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.289949893951416  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.290356636047363  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44568634033203125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.233303546905518  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.233710289001465  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4474053382873535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.234752655029297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.235159397125244  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44910430908203125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.238521575927734  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23892831802368  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4502086639404297  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.231964111328125  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.232370853424072  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45261096954345703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2694993019104  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.269906044006348  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45361900329589844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.294076919555664  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29448366165161  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4554738998413086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.270785808563232  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27119255065918  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45610857009887695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.17956256866455  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.179969310760498  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4590129852294922  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2848801612854  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.285286903381348  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46065616607666016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2674822807312  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26788902282715  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4619135856628418  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.212578773498535  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.212985515594482  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4650406837463379  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.354039669036865  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.354446411132812  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4656400680541992  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.255268096923828  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.255674839019775  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46793222427368164  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.36500597000122  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.365412712097168  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4697422981262207  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25190258026123  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.252309322357178  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47104930877685547  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28128147125244  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28168821334839  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47289562225341797  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.220133781433105  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.220540523529053  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47412681579589844  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.225224018096924  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22563076019287  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4761171340942383  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.36484432220459  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.365251064300537  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4778766632080078  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263449668884277  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263856410980225  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47843313217163086  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.177685737609863  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.17809247970581  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48192644119262695  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.273884296417236  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274291038513184  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48223018646240234  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.265385150909424  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26579189300537  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48471546173095703  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24375581741333  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.244162559509277  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48635196685791016  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.37186050415039  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.372267246246338  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48769617080688477  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.284460067749023  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28486680984497  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4901151657104492  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.37943696975708  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.379843711853027  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4909539222717285  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.1435489654541  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.14394998550415  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4961061477661133  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.26707515120506287
pure train time :  17.494296312332153
train time :  40.55891013145447
end to end time :  82.50527048110962
connection check time:  24.457298040390015
block generation time  14.514150619506836
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3030, 3031, 3032]), tensor([3033, 3034, 3035,  ..., 6041, 6042, 6043]), tensor([6044, 6045, 6046,  ..., 9042, 9043, 9044]), tensor([ 9045,  9046,  9047,  ..., 12031, 12032, 12033]), tensor([12034, 12035, 12037,  ..., 15039, 15040, 15041]), tensor([15043, 15044, 15046,  ..., 18046, 18047, 18049]), tensor([18050, 18051, 18052,  ..., 21072, 21073, 21074]), tensor([21075, 21077, 21078,  ..., 24084, 24085, 24086]), tensor([24087, 24088, 24089,  ..., 27104, 27105, 27107]), tensor([27108, 27109, 27110,  ..., 30125, 30126, 30127]), tensor([30128, 30129, 30130,  ..., 33132, 33133, 33134]), tensor([33135, 33136, 33137,  ..., 36101, 36102, 36104]), tensor([36105, 36106, 36107,  ..., 39117, 39118, 39119]), tensor([39120, 39122, 39123,  ..., 42101, 42102, 42104]), tensor([42105, 42106, 42108,  ..., 45093, 45094, 45095]), tensor([45097, 45098, 45100,  ..., 48116, 48118, 48119]), tensor([48120, 48121, 48122,  ..., 51138, 51141, 51142]), tensor([51144, 51145, 51146,  ..., 54163, 54164, 54165]), tensor([54166, 54170, 54171,  ..., 57184, 57186, 57187]), tensor([57189, 57190, 57191,  ..., 60174, 60175, 60176]), tensor([60177, 60178, 60180,  ..., 63178, 63179, 63180]), tensor([63181, 63182, 63183,  ..., 66189, 66190, 66192]), tensor([66193, 66194, 66195,  ..., 69218, 69219, 69220]), tensor([69221, 69222, 69223,  ..., 72226, 72227, 72228]), tensor([72229, 72230, 72231,  ..., 75237, 75238, 75239]), tensor([75240, 75241, 75242,  ..., 78251, 78252, 78253]), tensor([78254, 78255, 78258,  ..., 81241, 81242, 81243]), tensor([81244, 81245, 81246,  ..., 84255, 84256, 84257]), tensor([84258, 84259, 84260,  ..., 87241, 87242, 87243]), tensor([87244, 87245, 87246,  ..., 90236, 90237, 90238]), tensor([90239, 90240, 90241,  ..., 93194, 93196, 93198]), tensor([93199, 93200, 93201,  ..., 96202, 96203, 96204]), tensor([96205, 96206, 96207,  ..., 99205, 99206, 99207]), tensor([ 99208,  99209,  99210,  ..., 102239, 102240, 102242]), tensor([102243, 102244, 102245,  ..., 105234, 105236, 105237]), tensor([105238, 105239, 105241,  ..., 108253, 108254, 108255]), tensor([108256, 108257, 108259,  ..., 111282, 111283, 111284]), tensor([111285, 111286, 111287,  ..., 114288, 114289, 114290]), tensor([114291, 114292, 114293,  ..., 117323, 117325, 117326]), tensor([117328, 117329, 117330,  ..., 120367, 120368, 120369]), tensor([120370, 120371, 120372,  ..., 123389, 123391, 123392]), tensor([123393, 123394, 123395,  ..., 126431, 126432, 126433]), tensor([126434, 126435, 126437,  ..., 129426, 129427, 129428]), tensor([129429, 129430, 129431,  ..., 132394, 132395, 132396]), tensor([132397, 132398, 132399,  ..., 135423, 135424, 135425]), tensor([135426, 135427, 135428,  ..., 138436, 138438, 138439]), tensor([138440, 138441, 138442,  ..., 141437, 141438, 141439]), tensor([141440, 141441, 141442,  ..., 144429, 144430, 144431]), tensor([144432, 144433, 144435,  ..., 147413, 147414, 147415]), tensor([147416, 147417, 147418,  ..., 150457, 150458, 150459]), tensor([150461, 150462, 150463,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4831256866455078
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0005228519439697266
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0242764949798584
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48960280418395996
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.3738341331481934
self.buckets_partition() spend  sec:  0.5139117240905762
check connections block*********************************

the find indices time spent  0.04198312759399414

in edges time spent  0.39867281913757324
local to global src and eids time spent  1.194822072982788
time gen tails  0.3735678195953369
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.388805627822876

----------------------------------------
check connections block*********************************

the find indices time spent  0.832831621170044

in edges time spent  5.989007234573364
local to global src and eids time spent  8.477745056152344
time gen tails  1.7014384269714355
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.197123050689697

block collection to dataloader spend  6.866455078125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4085564613342285  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.202301025390625  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.201043128967285  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4082150459289551  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29284954071045  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.293256282806396  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41034650802612305  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20348024368286  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20388698577881  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.411649227142334  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.14952564239502  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.149932384490967  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41315650939941406  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.195768356323242  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19617509841919  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4160938262939453  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30265712738037  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30306386947632  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41768836975097656  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26198434829712  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.262391090393066  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4199337959289551  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.239943027496338  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.240349769592285  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4219040870666504  GigaBytes
Max Memory Allocated: 20.64300537109375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.405724048614502  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.40613079071045  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42311811447143555  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.333881855010986  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.334288597106934  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42334699630737305  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.159924507141113  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16033124923706  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42560768127441406  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.245630264282227  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.246037006378174  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42706823348999023  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.312217712402344  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31262445449829  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42933177947998047  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31771945953369  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31812620162964  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42935943603515625  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.13699245452881  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.137399196624756  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4328455924987793  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26812982559204  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26853656768799  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43445348739624023  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.218648433685303  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21905517578125  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4358081817626953  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.265507698059082  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26591444015503  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43616724014282227  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.1901798248291  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19058656692505  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43851375579833984  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.331259727478027  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.331666469573975  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4384183883666992  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21702241897583  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.217429161071777  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4432339668273926  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.331708431243896  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.332115173339844  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44329309463500977  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258203983306885  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258610725402832  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4460482597351074  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.330273628234863  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33068037033081  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44660329818725586  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25410509109497  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.254511833190918  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44944334030151367  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27925729751587  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.279664039611816  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4505271911621094  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.255592823028564  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25599956512451  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4518885612487793  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.245999336242676  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.246406078338623  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45396852493286133  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.240713119506836  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.241119861602783  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45702028274536133  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.305671215057373  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30607795715332  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45819616317749023  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28482151031494  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28522825241089  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45767784118652344  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.254273891448975  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.254680633544922  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46137428283691406  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.346410274505615  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.346817016601562  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4617452621459961  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.208385467529297  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.208792209625244  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46416568756103516  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.256381511688232  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25678825378418  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4664621353149414  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.289809226989746  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.290215969085693  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46828460693359375  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.35847806930542  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.358884811401367  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4692678451538086  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.269461631774902  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26986837387085  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4698209762573242  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.257396697998047  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.257803440093994  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4713554382324219  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27358102798462  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.273987770080566  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4742612838745117  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274307250976562  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27471399307251  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47561168670654297  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2918758392334  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.292282581329346  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47630882263183594  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.266287326812744  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26669406890869  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4797239303588867  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.310874462127686  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.311281204223633  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48066043853759766  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20164203643799  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.202048778533936  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4815201759338379  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.208628177642822  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20903491973877  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48477649688720703  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.277960300445557  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.278367042541504  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48674440383911133  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.309757232666016  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.310163974761963  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48759031295776367  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27315044403076  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27355718612671  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49085187911987305  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.380094051361084  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.38050079345703  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4902210235595703  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.074166297912598  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.074567317962646  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49535703659057617  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.2555348873138428
pure train time :  17.48498272895813
train time :  41.06056475639343
end to end time :  80.54602003097534
connection check time:  22.481427907943726
block generation time  14.585928678512573
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3004, 3005, 3007]), tensor([3008, 3009, 3010,  ..., 6034, 6035, 6036]), tensor([6037, 6038, 6039,  ..., 9081, 9082, 9083]), tensor([ 9084,  9085,  9086,  ..., 12117, 12118, 12119]), tensor([12120, 12121, 12122,  ..., 15151, 15152, 15153]), tensor([15155, 15156, 15157,  ..., 18170, 18171, 18172]), tensor([18173, 18174, 18175,  ..., 21160, 21161, 21164]), tensor([21165, 21166, 21167,  ..., 24159, 24160, 24161]), tensor([24162, 24163, 24164,  ..., 27172, 27173, 27175]), tensor([27176, 27177, 27179,  ..., 30141, 30142, 30143]), tensor([30144, 30146, 30148,  ..., 33149, 33150, 33151]), tensor([33152, 33153, 33154,  ..., 36185, 36186, 36187]), tensor([36188, 36189, 36190,  ..., 39193, 39194, 39195]), tensor([39196, 39198, 39199,  ..., 42205, 42206, 42207]), tensor([42208, 42209, 42210,  ..., 45224, 45225, 45226]), tensor([45228, 45229, 45230,  ..., 48216, 48217, 48218]), tensor([48219, 48220, 48221,  ..., 51231, 51232, 51233]), tensor([51234, 51235, 51236,  ..., 54264, 54265, 54266]), tensor([54267, 54268, 54269,  ..., 57255, 57256, 57257]), tensor([57258, 57259, 57260,  ..., 60281, 60282, 60283]), tensor([60284, 60285, 60286,  ..., 63267, 63268, 63269]), tensor([63270, 63271, 63272,  ..., 66291, 66292, 66293]), tensor([66294, 66296, 66298,  ..., 69326, 69327, 69328]), tensor([69329, 69330, 69331,  ..., 72329, 72330, 72331]), tensor([72334, 72335, 72336,  ..., 75329, 75331, 75332]), tensor([75333, 75334, 75335,  ..., 78344, 78345, 78346]), tensor([78347, 78348, 78350,  ..., 81336, 81337, 81338]), tensor([81339, 81340, 81341,  ..., 84331, 84332, 84333]), tensor([84334, 84335, 84336,  ..., 87343, 87345, 87346]), tensor([87347, 87348, 87349,  ..., 90349, 90350, 90351]), tensor([90352, 90353, 90354,  ..., 93369, 93371, 93372]), tensor([93373, 93374, 93375,  ..., 96349, 96350, 96351]), tensor([96352, 96353, 96354,  ..., 99314, 99315, 99317]), tensor([ 99318,  99320,  99321,  ..., 102356, 102357, 102358]), tensor([102359, 102361, 102363,  ..., 105329, 105330, 105332]), tensor([105333, 105334, 105335,  ..., 108371, 108372, 108373]), tensor([108374, 108376, 108377,  ..., 111379, 111380, 111381]), tensor([111382, 111383, 111384,  ..., 114358, 114359, 114360]), tensor([114361, 114362, 114363,  ..., 117382, 117383, 117384]), tensor([117385, 117386, 117387,  ..., 120391, 120392, 120393]), tensor([120394, 120395, 120396,  ..., 123375, 123376, 123377]), tensor([123378, 123379, 123380,  ..., 126353, 126354, 126355]), tensor([126356, 126357, 126358,  ..., 129369, 129371, 129372]), tensor([129375, 129376, 129377,  ..., 132383, 132384, 132385]), tensor([132386, 132387, 132388,  ..., 135378, 135379, 135380]), tensor([135381, 135382, 135383,  ..., 138395, 138396, 138397]), tensor([138398, 138399, 138400,  ..., 141385, 141386, 141387]), tensor([141388, 141389, 141390,  ..., 144445, 144447, 144448]), tensor([144449, 144450, 144451,  ..., 147447, 147449, 147450]), tensor([147451, 147452, 147453,  ..., 150457, 150458, 150460]), tensor([150461, 150462, 150463,  ..., 153427, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4496772289276123
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.00048160552978515625
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025168418884277344
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4577062129974365
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.8682758808135986
self.buckets_partition() spend  sec:  0.48290514945983887
check connections block*********************************

the find indices time spent  0.07789397239685059

in edges time spent  0.7365207672119141
local to global src and eids time spent  1.838761806488037
time gen tails  0.36772990226745605
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.3757317066192627

----------------------------------------
check connections block*********************************

the find indices time spent  0.8191885948181152

in edges time spent  6.110889434814453
local to global src and eids time spent  6.916794776916504
time gen tails  1.0365495681762695
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  9.283520936965942

block collection to dataloader spend  4.029273986816406e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40807580947875977  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.12165117263794  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.120393753051758  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4082942008972168  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.248076915740967  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.248483657836914  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40906667709350586  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24760675430298  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.248013496398926  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4112229347229004  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.158721923828125  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.159128665924072  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41312360763549805  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.238494873046875  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.238901615142822  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41504716873168945  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.197872161865234  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19827890396118  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4169778823852539  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.233871936798096  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.234278678894043  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4183692932128906  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20604372024536  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20645046234131  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4184999465942383  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.203524589538574  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20393133163452  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42173051834106445  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.307947158813477  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.308353900909424  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4237947463989258  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.257856845855713  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25826358795166  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42418479919433594  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.231088161468506  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.231494903564453  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4262809753417969  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.15675449371338  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.157161235809326  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4282650947570801  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.164326190948486  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.164732933044434  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43131017684936523  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16908025741577  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16948699951172  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43303871154785156  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.320101737976074  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32050848007202  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4344043731689453  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.320294857025146  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.320701599121094  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43500280380249023  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263680458068848  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.264087200164795  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43758344650268555  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.330533981323242  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33094072341919  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43773794174194336  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2242751121521  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.224681854248047  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4404439926147461  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33439350128174  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.334800243377686  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4412217140197754  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.240844249725342  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24125099182129  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44371795654296875  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23970127105713  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.240108013153076  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.445162296295166  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.246925354003906  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.247332096099854  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44675254821777344  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.240530967712402  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24093770980835  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44780492782592773  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.154099464416504  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.15450620651245  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44902610778808594  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.185588359832764  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.18599510192871  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45198869705200195  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.199894905090332  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20030164718628  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4536609649658203  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.253613471984863  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25402021408081  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45558881759643555  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.256704807281494  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25711154937744  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4568643569946289  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2971773147583  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.297584056854248  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4590325355529785  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.349485874176025  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.349892616271973  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45968055725097656  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.127784729003906  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.128191471099854  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46268558502197266  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.348442554473877  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.348849296569824  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.465054988861084  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.273027420043945  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.273434162139893  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4665036201477051  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.356365203857422  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.35677194595337  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46827268600463867  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.369742393493652  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.3701491355896  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4686775207519531  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.264254093170166  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.264660835266113  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4709625244140625  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.312206268310547  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.312613010406494  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4727201461791992  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.306994915008545  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.307401657104492  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4742555618286133  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29215097427368  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29255771636963  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47584104537963867  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.308568954467773  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30897569656372  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.478330135345459  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30831527709961  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.308722019195557  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47869253158569336  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.269655227661133  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27006196975708  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4801464080810547  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26709508895874  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.267501831054688  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48131513595581055  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.178043365478516  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.178450107574463  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48496055603027344  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.328503608703613  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32891035079956  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48587799072265625  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2390398979187  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23944664001465  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4876708984375  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30888557434082  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.309292316436768  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48992443084716797  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.307603359222412  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30801010131836  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49001026153564453  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.107315063476562  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.10771608352661  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49515199661254883  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.24648207426071167
pure train time :  17.32308554649353
train time :  40.57124900817871
end to end time :  74.78658533096313
connection check time:  19.645997524261475
block generation time  11.659252643585205
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3007, 3008, 3009]), tensor([3010, 3011, 3012,  ..., 6000, 6001, 6002]), tensor([6003, 6004, 6005,  ..., 8977, 8978, 8979]), tensor([ 8980,  8981,  8982,  ..., 12013, 12014, 12015]), tensor([12016, 12018, 12019,  ..., 15036, 15037, 15038]), tensor([15039, 15040, 15041,  ..., 18033, 18034, 18035]), tensor([18036, 18038, 18039,  ..., 21051, 21052, 21053]), tensor([21054, 21055, 21056,  ..., 24055, 24056, 24057]), tensor([24058, 24059, 24060,  ..., 27037, 27038, 27040]), tensor([27041, 27042, 27043,  ..., 30053, 30054, 30055]), tensor([30056, 30057, 30058,  ..., 33087, 33089, 33090]), tensor([33091, 33092, 33093,  ..., 36109, 36110, 36111]), tensor([36112, 36114, 36115,  ..., 39144, 39145, 39146]), tensor([39147, 39148, 39149,  ..., 42152, 42153, 42154]), tensor([42155, 42156, 42157,  ..., 45153, 45155, 45156]), tensor([45157, 45158, 45159,  ..., 48152, 48153, 48154]), tensor([48155, 48156, 48158,  ..., 51181, 51182, 51184]), tensor([51185, 51186, 51187,  ..., 54168, 54169, 54170]), tensor([54171, 54172, 54173,  ..., 57183, 57184, 57185]), tensor([57186, 57187, 57188,  ..., 60182, 60183, 60184]), tensor([60185, 60186, 60187,  ..., 63207, 63208, 63209]), tensor([63210, 63211, 63212,  ..., 66203, 66204, 66205]), tensor([66207, 66208, 66209,  ..., 69191, 69192, 69193]), tensor([69194, 69195, 69196,  ..., 72218, 72219, 72221]), tensor([72222, 72223, 72224,  ..., 75240, 75241, 75242]), tensor([75243, 75244, 75245,  ..., 78229, 78231, 78232]), tensor([78233, 78234, 78235,  ..., 81241, 81242, 81243]), tensor([81244, 81245, 81246,  ..., 84234, 84235, 84236]), tensor([84237, 84238, 84239,  ..., 87226, 87227, 87228]), tensor([87229, 87230, 87231,  ..., 90242, 90244, 90245]), tensor([90246, 90248, 90250,  ..., 93228, 93229, 93230]), tensor([93231, 93232, 93233,  ..., 96201, 96202, 96203]), tensor([96204, 96207, 96208,  ..., 99229, 99230, 99231]), tensor([ 99232,  99233,  99234,  ..., 102227, 102228, 102229]), tensor([102230, 102231, 102232,  ..., 105235, 105236, 105237]), tensor([105238, 105240, 105241,  ..., 108257, 108258, 108259]), tensor([108260, 108261, 108262,  ..., 111263, 111264, 111265]), tensor([111266, 111267, 111268,  ..., 114322, 114323, 114324]), tensor([114325, 114326, 114327,  ..., 117316, 117317, 117318]), tensor([117319, 117320, 117321,  ..., 120315, 120316, 120317]), tensor([120318, 120319, 120320,  ..., 123299, 123300, 123301]), tensor([123302, 123303, 123304,  ..., 126294, 126295, 126296]), tensor([126298, 126299, 126300,  ..., 129312, 129313, 129314]), tensor([129315, 129316, 129317,  ..., 132361, 132362, 132363]), tensor([132364, 132365, 132366,  ..., 135399, 135400, 135401]), tensor([135402, 135403, 135404,  ..., 138437, 138438, 138439]), tensor([138441, 138442, 138443,  ..., 141434, 141435, 141436]), tensor([141437, 141439, 141441,  ..., 144416, 144417, 144418]), tensor([144419, 144420, 144421,  ..., 147443, 147444, 147445]), tensor([147446, 147447, 147449,  ..., 150459, 150460, 150461]), tensor([150462, 150464, 150465,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.6263632774353027
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.000457763671875
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021421432495117188
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6337063312530518
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  3.0150344371795654
self.buckets_partition() spend  sec:  0.6551635265350342
check connections block*********************************

the find indices time spent  0.08864068984985352

in edges time spent  0.702871561050415
local to global src and eids time spent  2.041931629180908
time gen tails  0.36693334579467773
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.3712236881256104

----------------------------------------
check connections block*********************************

the find indices time spent  0.8246002197265625

in edges time spent  6.486753225326538
local to global src and eids time spent  10.048956394195557
time gen tails  1.6750767230987549
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.079941749572754

block collection to dataloader spend  6.890296936035156e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40703773498535156  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.200385570526123  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19912815093994  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4096064567565918  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25773859024048  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258145332336426  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4111771583557129  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.297607421875  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.298014163970947  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41036462783813477  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.137086391448975  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.137493133544922  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.412874698638916  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.12351655960083  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.123923301696777  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4137721061706543  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.105952262878418  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.106359004974365  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41654396057128906  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.222318649291992  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22272539138794  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42062854766845703  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30850315093994  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30890989303589  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41999387741088867  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22220277786255  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.222609519958496  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42223405838012695  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.302682399749756  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.303089141845703  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42227602005004883  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.204501628875732  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20490837097168  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42627382278442383  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.243581771850586  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.243988513946533  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4269728660583496  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.311776638031006  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.312183380126953  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42870140075683594  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23902416229248  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.239430904388428  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4307098388671875  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.257734775543213  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25814151763916  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43244028091430664  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21214485168457  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.212551593780518  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4336075782775879  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.18959665298462  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.190003395080566  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.434237003326416  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.1364688873291  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.13687562942505  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43666791915893555  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22239923477173  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.222805976867676  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43996381759643555  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33195924758911  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33236598968506  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4411768913269043  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.259180545806885  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.259587287902832  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4420642852783203  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.271048069000244  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27145481109619  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44606924057006836  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.365631103515625  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.366037845611572  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4450874328613281  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.228546619415283  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22895336151123  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4470953941345215  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.234965324401855  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.235372066497803  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44966983795166016  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.234679222106934  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23508596420288  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45113706588745117  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.262215614318848  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.262622356414795  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45333337783813477  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26569128036499  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.266098022460938  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45404577255249023  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24954891204834  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.249955654144287  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4569859504699707  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.281940937042236  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.282347679138184  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4574141502380371  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.309815406799316  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.310222148895264  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.459317684173584  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.242912769317627  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.243319511413574  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4607381820678711  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24487590789795  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.245282649993896  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46274614334106445  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.292956352233887  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.293363094329834  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46429967880249023  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.350071907043457  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.350478649139404  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46434450149536133  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16501808166504  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.165424823760986  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4687919616699219  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.257890701293945  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258297443389893  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4696049690246582  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26328134536743  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26368808746338  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4721336364746094  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.301435947418213  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30184268951416  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47252702713012695  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.264777183532715  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.265183925628662  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4736366271972656  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.264341831207275  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.264748573303223  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4759178161621094  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.283153533935547  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.283560276031494  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4776735305786133  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26707649230957  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.267483234405518  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47887086868286133  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21013832092285  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2105450630188  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48195791244506836  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29037094116211  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.290777683258057  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4835338592529297  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27506732940674  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.275474071502686  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48352479934692383  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.17255163192749  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.172958374023438  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48560523986816406  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.268250465393066  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.268657207489014  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48787403106689453  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.312840938568115  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.313247680664062  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48975419998168945  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274552822113037  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274959564208984  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49057865142822266  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.08224105834961  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.082642078399658  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49571847915649414  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.2410125583410263
pure train time :  17.26604390144348
train time :  40.79930543899536
end to end time :  83.44502115249634
connection check time:  25.13276481628418
block generation time  14.451165437698364
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3004, 3005, 3006]), tensor([3007, 3008, 3009,  ..., 6025, 6026, 6027]), tensor([6028, 6029, 6030,  ..., 9043, 9044, 9045]), tensor([ 9046,  9047,  9050,  ..., 12048, 12049, 12050]), tensor([12051, 12052, 12053,  ..., 15033, 15034, 15035]), tensor([15036, 15037, 15039,  ..., 18064, 18065, 18066]), tensor([18067, 18068, 18069,  ..., 21098, 21099, 21100]), tensor([21102, 21103, 21104,  ..., 24108, 24109, 24110]), tensor([24111, 24112, 24113,  ..., 27108, 27109, 27110]), tensor([27111, 27112, 27113,  ..., 30100, 30101, 30102]), tensor([30103, 30104, 30105,  ..., 33065, 33066, 33067]), tensor([33068, 33069, 33070,  ..., 36090, 36091, 36092]), tensor([36093, 36094, 36095,  ..., 39129, 39130, 39131]), tensor([39132, 39135, 39136,  ..., 42147, 42148, 42149]), tensor([42151, 42152, 42153,  ..., 45206, 45207, 45208]), tensor([45209, 45210, 45211,  ..., 48184, 48185, 48187]), tensor([48188, 48189, 48190,  ..., 51243, 51244, 51245]), tensor([51246, 51247, 51248,  ..., 54222, 54223, 54224]), tensor([54225, 54226, 54227,  ..., 57255, 57256, 57257]), tensor([57258, 57259, 57260,  ..., 60276, 60277, 60278]), tensor([60279, 60281, 60282,  ..., 63266, 63268, 63269]), tensor([63270, 63271, 63272,  ..., 66277, 66278, 66279]), tensor([66280, 66281, 66282,  ..., 69324, 69325, 69327]), tensor([69328, 69329, 69331,  ..., 72317, 72318, 72319]), tensor([72320, 72321, 72322,  ..., 75360, 75361, 75362]), tensor([75363, 75364, 75365,  ..., 78402, 78403, 78404]), tensor([78405, 78406, 78407,  ..., 81408, 81409, 81410]), tensor([81411, 81412, 81413,  ..., 84428, 84430, 84431]), tensor([84433, 84434, 84435,  ..., 87428, 87430, 87431]), tensor([87432, 87434, 87435,  ..., 90466, 90467, 90468]), tensor([90469, 90470, 90472,  ..., 93442, 93443, 93444]), tensor([93445, 93446, 93447,  ..., 96423, 96424, 96425]), tensor([96426, 96427, 96428,  ..., 99437, 99438, 99439]), tensor([ 99440,  99441,  99443,  ..., 102418, 102419, 102421]), tensor([102422, 102423, 102424,  ..., 105426, 105427, 105428]), tensor([105430, 105431, 105432,  ..., 108424, 108425, 108426]), tensor([108427, 108428, 108429,  ..., 111420, 111421, 111422]), tensor([111423, 111425, 111426,  ..., 114432, 114433, 114434]), tensor([114435, 114436, 114437,  ..., 117416, 117417, 117418]), tensor([117419, 117420, 117421,  ..., 120436, 120437, 120438]), tensor([120439, 120440, 120441,  ..., 123449, 123450, 123451]), tensor([123452, 123453, 123454,  ..., 126450, 126451, 126452]), tensor([126453, 126454, 126455,  ..., 129425, 129426, 129428]), tensor([129430, 129431, 129432,  ..., 132414, 132415, 132416]), tensor([132417, 132418, 132419,  ..., 135459, 135461, 135463]), tensor([135464, 135465, 135467,  ..., 138449, 138450, 138451]), tensor([138452, 138455, 138456,  ..., 141461, 141463, 141464]), tensor([141466, 141468, 141469,  ..., 144491, 144492, 144493]), tensor([144494, 144495, 144496,  ..., 147480, 147481, 147483]), tensor([147484, 147485, 147486,  ..., 150489, 150490, 150491]), tensor([150492, 150493, 150494,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.48256707191467285
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0005221366882324219
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024652957916259766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48908543586730957
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.7896080017089844
self.buckets_partition() spend  sec:  0.5137715339660645
check connections block*********************************

the find indices time spent  0.07077980041503906

in edges time spent  0.7049741744995117
local to global src and eids time spent  2.1599442958831787
time gen tails  0.39386653900146484
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.37481427192688

----------------------------------------
check connections block*********************************

the find indices time spent  0.8144867420196533

in edges time spent  6.113556623458862
local to global src and eids time spent  10.06238603591919
time gen tails  1.662386417388916
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  11.534181118011475

block collection to dataloader spend  6.961822509765625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40768861770629883  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.194767951965332  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19351053237915  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40831947326660156  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.217021465301514  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21742820739746  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4097318649291992  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.243239879608154  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2436466217041  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4120354652404785  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.254595279693604  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25500202178955  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41372203826904297  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2513747215271  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.251781463623047  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4158167839050293  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.301798820495605  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.302205562591553  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41713666915893555  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.243192195892334  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24359893798828  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41893482208251953  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.302744388580322  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30315113067627  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42026424407958984  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23213005065918  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.232536792755127  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42170190811157227  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.229681491851807  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.230088233947754  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42400503158569336  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25057601928711  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.250982761383057  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4250659942626953  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.172579288482666  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.172986030578613  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4267253875732422  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.17386245727539  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.174269199371338  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42760467529296875  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.211780548095703  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21218729019165  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42955541610717773  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2726731300354  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.273079872131348  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4307975769042969  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21369457244873  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.214101314544678  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43480825424194336  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.320802688598633  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32120943069458  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43500757217407227  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.245943069458008  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.246349811553955  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4369015693664551  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.220752716064453  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2211594581604  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4366469383239746  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.18281602859497  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.183222770690918  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43996524810791016  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.264252185821533  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26465892791748  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4424443244934082  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.287786960601807  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.288193702697754  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4431791305541992  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.250288486480713  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25069522857666  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4436764717102051  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23848533630371  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.238892078399658  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4480404853820801  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.279879570007324  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28028631210327  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44831180572509766  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263173580169678  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263580322265625  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44977331161499023  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2811222076416  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28152894973755  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45171070098876953  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.233752727508545  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.234159469604492  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4544692039489746  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.279205799102783  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27961254119873  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45652103424072266  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.369019508361816  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.369426250457764  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4569735527038574  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.276060104370117  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.276466846466064  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45955991744995117  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.283044815063477  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.283451557159424  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45949649810791016  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.243651390075684  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24405813217163  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4609055519104004  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.193577766418457  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.193984508514404  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46447229385375977  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28316879272461  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.283575534820557  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4658951759338379  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258808612823486  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.259215354919434  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46851205825805664  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.288145065307617  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.288551807403564  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46752023696899414  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.210357666015625  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.210764408111572  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47065019607543945  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258631706237793  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25903844833374  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4723362922668457  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.362191677093506  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.362598419189453  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4736480712890625  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.214797019958496  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.215203762054443  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47613954544067383  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.271117210388184  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27152395248413  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4783024787902832  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.323594093322754  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.3240008354187  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47764015197753906  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.230125904083252  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2305326461792  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48132896423339844  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.282894134521484  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28330087661743  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.481719970703125  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.286324501037598  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.286731243133545  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4850587844848633  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.375836849212646  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.376243591308594  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48659753799438477  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.321541786193848  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.321948528289795  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4873838424682617  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.279210567474365  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.279617309570312  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4888896942138672  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.288533687591553  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2889404296875  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49042272567749023  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.136649131774902  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.13705015182495  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4955730438232422  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.2333492934703827
pure train time :  17.369266271591187
train time :  40.642364740371704
end to end time :  82.25515270233154
connection check time:  24.871357917785645
block generation time  13.908995389938354
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2997, 3000, 3001]), tensor([3002, 3003, 3004,  ..., 5997, 5998, 5999]), tensor([6000, 6001, 6002,  ..., 8992, 8993, 8994]), tensor([ 8995,  8996,  8997,  ..., 11998, 12000, 12001]), tensor([12002, 12003, 12004,  ..., 15006, 15007, 15008]), tensor([15009, 15011, 15012,  ..., 18001, 18002, 18003]), tensor([18004, 18005, 18006,  ..., 20984, 20985, 20986]), tensor([20987, 20988, 20990,  ..., 23958, 23959, 23961]), tensor([23962, 23963, 23964,  ..., 27000, 27001, 27002]), tensor([27003, 27005, 27006,  ..., 30029, 30030, 30031]), tensor([30032, 30034, 30035,  ..., 33030, 33031, 33032]), tensor([33033, 33034, 33036,  ..., 36041, 36042, 36043]), tensor([36044, 36046, 36048,  ..., 39062, 39063, 39064]), tensor([39065, 39066, 39067,  ..., 42078, 42079, 42080]), tensor([42081, 42082, 42083,  ..., 45073, 45074, 45075]), tensor([45076, 45077, 45078,  ..., 48131, 48132, 48134]), tensor([48135, 48136, 48137,  ..., 51128, 51129, 51131]), tensor([51132, 51133, 51134,  ..., 54111, 54112, 54113]), tensor([54114, 54115, 54116,  ..., 57089, 57090, 57091]), tensor([57092, 57093, 57094,  ..., 60145, 60146, 60147]), tensor([60148, 60149, 60150,  ..., 63157, 63158, 63159]), tensor([63160, 63161, 63163,  ..., 66182, 66183, 66184]), tensor([66185, 66186, 66187,  ..., 69192, 69193, 69194]), tensor([69195, 69196, 69197,  ..., 72199, 72201, 72202]), tensor([72203, 72204, 72205,  ..., 75189, 75190, 75191]), tensor([75192, 75193, 75194,  ..., 78251, 78252, 78254]), tensor([78255, 78256, 78257,  ..., 81265, 81266, 81267]), tensor([81268, 81269, 81270,  ..., 84288, 84289, 84290]), tensor([84291, 84292, 84293,  ..., 87281, 87284, 87285]), tensor([87286, 87287, 87288,  ..., 90279, 90280, 90281]), tensor([90282, 90283, 90284,  ..., 93304, 93305, 93306]), tensor([93307, 93308, 93309,  ..., 96292, 96293, 96294]), tensor([96295, 96296, 96297,  ..., 99294, 99296, 99297]), tensor([ 99298,  99299,  99300,  ..., 102325, 102326, 102327]), tensor([102328, 102329, 102330,  ..., 105335, 105336, 105338]), tensor([105339, 105342, 105343,  ..., 108356, 108357, 108358]), tensor([108360, 108361, 108362,  ..., 111355, 111356, 111357]), tensor([111358, 111359, 111360,  ..., 114342, 114343, 114344]), tensor([114346, 114347, 114348,  ..., 117351, 117353, 117354]), tensor([117355, 117356, 117357,  ..., 120402, 120403, 120404]), tensor([120405, 120406, 120407,  ..., 123452, 123453, 123454]), tensor([123455, 123456, 123457,  ..., 126424, 126425, 126426]), tensor([126428, 126430, 126431,  ..., 129450, 129451, 129452]), tensor([129453, 129454, 129455,  ..., 132473, 132474, 132475]), tensor([132476, 132477, 132478,  ..., 135455, 135456, 135457]), tensor([135458, 135459, 135460,  ..., 138459, 138461, 138462]), tensor([138463, 138465, 138466,  ..., 141465, 141466, 141467]), tensor([141468, 141469, 141470,  ..., 144469, 144470, 144471]), tensor([144473, 144474, 144475,  ..., 147471, 147472, 147473]), tensor([147475, 147476, 147477,  ..., 150458, 150459, 150460]), tensor([150461, 150462, 150464,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.44882798194885254
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.00047087669372558594
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02345585823059082
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.456773042678833
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.8479299545288086
self.buckets_partition() spend  sec:  0.4802591800689697
check connections block*********************************

the find indices time spent  0.07253408432006836

in edges time spent  0.718541145324707
local to global src and eids time spent  2.161741018295288
time gen tails  0.3611485958099365
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.387702226638794

----------------------------------------
check connections block*********************************

the find indices time spent  0.8027474880218506

in edges time spent  5.813506364822388
local to global src and eids time spent  8.127928972244263
time gen tails  1.7276701927185059
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.787317276000977

block collection to dataloader spend  0.00010633468627929688
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4066348075866699  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.157443046569824  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.156185150146484  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4075465202331543  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.15955114364624  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.159957885742188  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40901851654052734  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.150143146514893  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.15054988861084  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41161441802978516  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.148509979248047  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.148916721343994  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41322851181030273  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.302517414093018  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.302924156188965  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4144158363342285  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.204759120941162  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20516586303711  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4169325828552246  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.305498123168945  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.305904865264893  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4188385009765625  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30888080596924  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.309287548065186  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42067813873291016  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.308473110198975  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.308879852294922  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42154788970947266  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.215250968933105  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.215657711029053  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4238905906677246  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.219358921051025  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.219765663146973  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4250664710998535  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22105312347412  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22145986557007  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42672204971313477  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22146224975586  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.221868991851807  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42906618118286133  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.277740001678467  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.278146743774414  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4306516647338867  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.249797821044922  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25020456314087  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43268871307373047  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22770595550537  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22811269760132  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43506383895874023  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.325730800628662  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32613754272461  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4350905418395996  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.17563247680664  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.176039218902588  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43770265579223633  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.228166103363037  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.228572845458984  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4398775100708008  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.325483798980713  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32589054107666  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4396848678588867  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.17332887649536  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.17373561859131  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44149303436279297  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.229463577270508  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.229870319366455  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4423651695251465  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19350290298462  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.193909645080566  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44647836685180664  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33240509033203  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33281183242798  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4475855827331543  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.237449645996094  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23785638809204  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44896459579467773  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24282455444336  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.243231296539307  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45084619522094727  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.277979850769043  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27838659286499  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4515419006347656  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.174975872039795  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.175382614135742  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4537363052368164  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.337646007537842  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33805274963379  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45396852493286133  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.165407180786133  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16581392288208  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4577960968017578  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.34073495864868  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.34114170074463  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4594697952270508  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29628896713257  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.296695709228516  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46002626419067383  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.220810413360596  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.221217155456543  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46072816848754883  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.262710571289062  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26311731338501  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46487951278686523  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.35530996322632  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.355716705322266  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46564340591430664  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.268517017364502  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26892375946045  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4664030075073242  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.19548511505127  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.195891857147217  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46890830993652344  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.255051612854004  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25545835494995  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4713315963745117  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.308008670806885  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.308415412902832  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47242307662963867  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.309914588928223  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31032133102417  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4736480712890625  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.288208484649658  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.288615226745605  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4767465591430664  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.365524291992188  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.365931034088135  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4774928092956543  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.276394367218018  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.276801109313965  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47893428802490234  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31200361251831  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.312410354614258  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47954893112182617  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.18482780456543  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.185234546661377  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4824047088623047  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.290197372436523  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29060411453247  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48421239852905273  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.301618576049805  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.302025318145752  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4861626625061035  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.291959285736084  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29236602783203  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48766279220581055  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.284827709197998  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.285234451293945  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4892001152038574  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.279417991638184  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27982473373413  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49018239974975586  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.137572288513184  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.137973308563232  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4953336715698242  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.22692248225212097
pure train time :  17.083698987960815
train time :  40.54448747634888
end to end time :  81.70845770835876
connection check time:  23.092496156692505
block generation time  15.17501950263977
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3004, 3005, 3006]), tensor([3007, 3008, 3009,  ..., 6005, 6006, 6007]), tensor([6008, 6009, 6010,  ..., 8961, 8962, 8963]), tensor([ 8964,  8965,  8966,  ..., 11974, 11975, 11976]), tensor([11977, 11978, 11980,  ..., 14993, 14994, 14995]), tensor([14996, 14997, 14998,  ..., 18013, 18014, 18016]), tensor([18017, 18018, 18019,  ..., 21026, 21027, 21028]), tensor([21029, 21030, 21031,  ..., 24037, 24038, 24039]), tensor([24040, 24041, 24042,  ..., 27078, 27079, 27080]), tensor([27082, 27083, 27084,  ..., 30124, 30125, 30126]), tensor([30127, 30128, 30129,  ..., 33114, 33115, 33116]), tensor([33117, 33118, 33119,  ..., 36125, 36126, 36130]), tensor([36132, 36133, 36134,  ..., 39146, 39147, 39148]), tensor([39149, 39150, 39151,  ..., 42201, 42202, 42203]), tensor([42204, 42206, 42207,  ..., 45203, 45204, 45205]), tensor([45206, 45207, 45208,  ..., 48185, 48186, 48187]), tensor([48188, 48189, 48192,  ..., 51176, 51177, 51178]), tensor([51179, 51180, 51181,  ..., 54189, 54190, 54191]), tensor([54192, 54194, 54195,  ..., 57196, 57197, 57198]), tensor([57199, 57200, 57201,  ..., 60215, 60216, 60217]), tensor([60218, 60219, 60220,  ..., 63241, 63242, 63243]), tensor([63244, 63245, 63246,  ..., 66256, 66257, 66258]), tensor([66259, 66260, 66261,  ..., 69275, 69276, 69277]), tensor([69278, 69279, 69280,  ..., 72287, 72288, 72289]), tensor([72290, 72291, 72292,  ..., 75287, 75288, 75289]), tensor([75290, 75291, 75292,  ..., 78286, 78287, 78288]), tensor([78289, 78290, 78292,  ..., 81273, 81274, 81275]), tensor([81276, 81277, 81278,  ..., 84263, 84264, 84265]), tensor([84266, 84267, 84268,  ..., 87247, 87248, 87249]), tensor([87250, 87251, 87252,  ..., 90294, 90295, 90296]), tensor([90297, 90299, 90300,  ..., 93313, 93314, 93315]), tensor([93316, 93317, 93318,  ..., 96349, 96350, 96351]), tensor([96352, 96353, 96354,  ..., 99330, 99331, 99333]), tensor([ 99334,  99335,  99336,  ..., 102363, 102365, 102367]), tensor([102368, 102369, 102370,  ..., 105372, 105373, 105377]), tensor([105378, 105379, 105380,  ..., 108373, 108374, 108375]), tensor([108376, 108377, 108378,  ..., 111386, 111387, 111388]), tensor([111389, 111390, 111391,  ..., 114396, 114397, 114398]), tensor([114400, 114401, 114402,  ..., 117384, 117385, 117386]), tensor([117389, 117390, 117391,  ..., 120401, 120402, 120403]), tensor([120404, 120405, 120406,  ..., 123401, 123402, 123403]), tensor([123404, 123406, 123407,  ..., 126434, 126435, 126436]), tensor([126437, 126438, 126439,  ..., 129461, 129462, 129463]), tensor([129464, 129465, 129466,  ..., 132473, 132474, 132475]), tensor([132476, 132477, 132478,  ..., 135478, 135479, 135480]), tensor([135482, 135483, 135484,  ..., 138499, 138500, 138501]), tensor([138502, 138503, 138504,  ..., 141476, 141477, 141478]), tensor([141479, 141480, 141481,  ..., 144488, 144489, 144490]), tensor([144491, 144492, 144493,  ..., 147484, 147485, 147486]), tensor([147487, 147488, 147489,  ..., 150490, 150492, 150493]), tensor([150494, 150495, 150496,  ..., 153426, 153427, 153428])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.4940054416656494
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004456043243408203
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03391671180725098
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4990718364715576
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  1.786949872970581
self.buckets_partition() spend  sec:  0.5330281257629395
check connections block*********************************

the find indices time spent  0.07085394859313965

in edges time spent  0.4963569641113281
local to global src and eids time spent  2.1241774559020996
time gen tails  0.3921549320220947
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.37172532081604

----------------------------------------
check connections block*********************************

the find indices time spent  0.8284192085266113

in edges time spent  6.240194320678711
local to global src and eids time spent  9.718277931213379
time gen tails  1.6576685905456543
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.280076026916504

block collection to dataloader spend  8.58306884765625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40606117248535156  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.120015144348145  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.118757247924805  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40719127655029297  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.144065856933594  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.14447259902954  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4111509323120117  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.217369556427002  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21777629852295  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4123415946960449  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2459716796875  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.246378421783447  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.413912296295166  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.200398445129395  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.200805187225342  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41533613204956055  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.202868938446045  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.203275680541992  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4168691635131836  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20856523513794  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.208971977233887  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4196162223815918  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24467372894287  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24508047103882  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4206409454345703  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.238712310791016  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.239119052886963  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4218916893005371  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.208377838134766  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.208784580230713  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4236736297607422  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30808687210083  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.308493614196777  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4244203567504883  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.17214298248291  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.172549724578857  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42824649810791016  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.283754348754883  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28416109085083  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42824649810791016  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22759771347046  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.228004455566406  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4298095703125  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.209016799926758  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.209423542022705  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43071556091308594  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.171172618865967  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.171579360961914  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43442249298095703  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28277015686035  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2831768989563  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43363237380981445  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.134132385253906  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.134539127349854  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.438507080078125  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32661247253418  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.327019214630127  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4384274482727051  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.223013401031494  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22342014312744  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44040632247924805  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.227139472961426  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.227546215057373  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44257545471191406  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.324098587036133  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32450532913208  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4425487518310547  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.256165027618408  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.256571769714355  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4463324546813965  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.249563694000244  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24997043609619  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.446807861328125  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.178171634674072  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.17857837677002  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4483060836791992  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.172459602355957  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.172866344451904  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4506645202636719  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28230333328247  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.282710075378418  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45085668563842773  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.235239028930664  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23564577102661  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45607805252075195  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.375202655792236  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.375609397888184  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45614099502563477  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.247072219848633  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24747896194458  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.457733154296875  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.314161777496338  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.314568519592285  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45990467071533203  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20004367828369  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20045042037964  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.459287166595459  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.18968439102173  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.190091133117676  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.462374210357666  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25672960281372  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.257136344909668  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4647207260131836  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.35194158554077  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.35234832763672  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.465667724609375  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28121519088745  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2816219329834  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4668459892272949  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.256712913513184  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25711965560913  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4689912796020508  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.279178619384766  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.279585361480713  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47223949432373047  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.36172103881836  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.362127780914307  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47302865982055664  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.319289207458496  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.319695949554443  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4738602638244629  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21122455596924  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.211631298065186  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4760713577270508  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30852746963501  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.308934211730957  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4767780303955078  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.268802642822266  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.269209384918213  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4797787666320801  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.262611389160156  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263018131256104  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4803781509399414  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.267507553100586  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.267914295196533  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.483701229095459  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.309171676635742  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30957841873169  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48418712615966797  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.229702949523926  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.230109691619873  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4863457679748535  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28039836883545  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.280805110931396  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48775815963745117  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33101749420166  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.331424236297607  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4897127151489258  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33363962173462  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.334046363830566  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48928022384643555  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.108059406280518  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.108460426330566  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.49442291259765625  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.21897004544734955
pure train time :  17.106588125228882
train time :  40.723275899887085
end to end time :  81.96940755844116
connection check time:  24.764261960983276
block generation time  14.651801347732544
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 3035, 3036, 3037]), tensor([3038, 3039, 3040,  ..., 6041, 6042, 6043]), tensor([6044, 6045, 6046,  ..., 9049, 9050, 9051]), tensor([ 9052,  9053,  9054,  ..., 12066, 12067, 12068]), tensor([12069, 12070, 12071,  ..., 15037, 15038, 15039]), tensor([15040, 15041, 15042,  ..., 18071, 18072, 18073]), tensor([18074, 18075, 18076,  ..., 21094, 21096, 21097]), tensor([21098, 21099, 21100,  ..., 24076, 24077, 24078]), tensor([24080, 24082, 24083,  ..., 27090, 27091, 27092]), tensor([27094, 27095, 27096,  ..., 30127, 30128, 30129]), tensor([30130, 30131, 30132,  ..., 33113, 33114, 33116]), tensor([33117, 33118, 33119,  ..., 36114, 36115, 36116]), tensor([36117, 36118, 36119,  ..., 39127, 39129, 39131]), tensor([39132, 39134, 39135,  ..., 42115, 42116, 42117]), tensor([42118, 42119, 42120,  ..., 45148, 45149, 45150]), tensor([45151, 45152, 45153,  ..., 48145, 48146, 48147]), tensor([48148, 48149, 48150,  ..., 51175, 51176, 51177]), tensor([51178, 51179, 51180,  ..., 54182, 54183, 54184]), tensor([54185, 54186, 54187,  ..., 57185, 57186, 57187]), tensor([57188, 57189, 57190,  ..., 60187, 60188, 60190]), tensor([60191, 60192, 60193,  ..., 63194, 63196, 63198]), tensor([63199, 63200, 63201,  ..., 66167, 66168, 66169]), tensor([66170, 66171, 66172,  ..., 69191, 69193, 69194]), tensor([69195, 69196, 69197,  ..., 72203, 72204, 72205]), tensor([72206, 72207, 72208,  ..., 75167, 75168, 75169]), tensor([75170, 75171, 75172,  ..., 78211, 78212, 78213]), tensor([78214, 78215, 78218,  ..., 81249, 81250, 81251]), tensor([81252, 81253, 81255,  ..., 84271, 84272, 84273]), tensor([84274, 84275, 84276,  ..., 87296, 87297, 87299]), tensor([87300, 87301, 87302,  ..., 90321, 90322, 90323]), tensor([90324, 90325, 90326,  ..., 93316, 93317, 93318]), tensor([93319, 93320, 93321,  ..., 96321, 96322, 96323]), tensor([96324, 96325, 96326,  ..., 99362, 99363, 99364]), tensor([ 99365,  99366,  99367,  ..., 102359, 102360, 102361]), tensor([102362, 102363, 102364,  ..., 105374, 105375, 105376]), tensor([105377, 105378, 105379,  ..., 108363, 108364, 108366]), tensor([108367, 108368, 108369,  ..., 111356, 111357, 111358]), tensor([111359, 111360, 111361,  ..., 114357, 114358, 114359]), tensor([114360, 114361, 114362,  ..., 117376, 117377, 117378]), tensor([117379, 117380, 117381,  ..., 120382, 120383, 120384]), tensor([120385, 120386, 120388,  ..., 123381, 123382, 123384]), tensor([123385, 123386, 123387,  ..., 126358, 126359, 126361]), tensor([126362, 126363, 126365,  ..., 129367, 129368, 129369]), tensor([129370, 129371, 129372,  ..., 132343, 132344, 132346]), tensor([132347, 132348, 132349,  ..., 135350, 135351, 135352]), tensor([135353, 135354, 135355,  ..., 138383, 138384, 138386]), tensor([138387, 138388, 138389,  ..., 141377, 141378, 141380]), tensor([141381, 141382, 141383,  ..., 144405, 144406, 144409]), tensor([144410, 144412, 144413,  ..., 147437, 147438, 147439]), tensor([147440, 147441, 147442,  ..., 150454, 150456, 150458]), tensor([150459, 150460, 150461,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.45369625091552734
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.00042748451232910156
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.04497814178466797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.46244311332702637
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.871877670288086
self.buckets_partition() spend  sec:  0.5074598789215088
check connections block*********************************

the find indices time spent  0.0687096118927002

in edges time spent  0.5284059047698975
local to global src and eids time spent  1.574256420135498
time gen tails  0.36449265480041504
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.3863697052001953

----------------------------------------
check connections block*********************************

the find indices time spent  0.8412880897521973

in edges time spent  6.111605644226074
local to global src and eids time spent  10.051375389099121
time gen tails  1.6584796905517578
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.25813889503479

block collection to dataloader spend  0.00010347366333007812
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4081411361694336  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.229053020477295  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.227795600891113  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40892934799194336  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.234859943389893  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23526668548584  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40919065475463867  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.196714878082275  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.197121620178223  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41219091415405273  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30259656906128  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.303003311157227  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4125785827636719  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.165871143341064  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16627788543701  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4145965576171875  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.225147247314453  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2255539894104  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.416776180267334  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.221621990203857  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.222028732299805  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41866636276245117  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.3692946434021  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.369701385498047  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42071104049682617  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21738052368164  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.217787265777588  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4210796356201172  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22562837600708  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.226035118103027  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4232172966003418  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.267473697662354  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2678804397583  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4244265556335449  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22239923477173  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.222805976867676  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42664575576782227  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22051429748535  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2209210395813  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42841243743896484  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.1739559173584  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.174362659454346  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.430264949798584  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.212745666503906  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.213152408599854  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43340635299682617  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.248586654663086  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.248993396759033  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43235349655151367  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.179035186767578  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.179441928863525  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4357471466064453  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.322906017303467  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.323312759399414  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43704748153686523  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32387399673462  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.324280738830566  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4393348693847656  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24635887145996  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.246765613555908  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44126462936401367  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24159049987793  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.241997241973877  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4405708312988281  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.189445972442627  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.189852714538574  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4449462890625  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26937437057495  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2697811126709  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44579076766967773  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.333571910858154  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.3339786529541  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44634246826171875  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23957586288452  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23998260498047  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4488534927368164  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.233974933624268  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.234381675720215  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4512500762939453  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263315200805664  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26372194290161  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4509601593017578  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.15959596633911  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16000270843506  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.452603816986084  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25217294692993  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25257968902588  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45601511001586914  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.34305763244629  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.343464374542236  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4557805061340332  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16908025741577  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16948699951172  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45838403701782227  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.241235733032227  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.241642475128174  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4607515335083008  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24101686477661  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24142360687256  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4612760543823242  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.18164300918579  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.18204975128174  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46558189392089844  GigaBytes
Max Memory Allocated: 20.65421724319458  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.412854194641113  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.41326093673706  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4653129577636719  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.309895038604736  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.310301780700684  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46754026412963867  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.284721851348877  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.285128593444824  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46861982345581055  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22229766845703  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22270441055298  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.470609188079834  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.222450256347656  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.222856998443604  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47222185134887695  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.287922859191895  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.288329601287842  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47369384765625  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.225186347961426  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.225593090057373  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4763970375061035  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29738998413086  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.297796726226807  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47852468490600586  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.333096504211426  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.333503246307373  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4787588119506836  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.227770805358887  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.228177547454834  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4816403388977051  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28396701812744  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28437376022339  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4838223457336426  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.40488576889038  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.405292510986328  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48422765731811523  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.283527374267578  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.283934116363525  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48580312728881836  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.221639156341553  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2220458984375  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4882183074951172  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.391830444335938  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.392237186431885  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4900941848754883  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.376803874969482  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.37721061706543  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4902210235595703  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.107779026031494  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.108180046081543  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.495363712310791  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.21388152241706848
pure train time :  17.48695421218872
train time :  40.84366750717163
end to end time :  82.50369763374329
connection check time:  24.081571578979492
block generation time  14.644508600234985
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2984, 2986, 2988]), tensor([2989, 2990, 2991,  ..., 5990, 5991, 5992]), tensor([5993, 5994, 5995,  ..., 9029, 9030, 9031]), tensor([ 9032,  9033,  9034,  ..., 12026, 12027, 12028]), tensor([12029, 12030, 12031,  ..., 15043, 15044, 15045]), tensor([15046, 15047, 15048,  ..., 18064, 18065, 18066]), tensor([18067, 18069, 18070,  ..., 21081, 21082, 21083]), tensor([21084, 21086, 21087,  ..., 24101, 24102, 24103]), tensor([24104, 24105, 24106,  ..., 27137, 27138, 27140]), tensor([27141, 27142, 27143,  ..., 30132, 30133, 30134]), tensor([30135, 30136, 30137,  ..., 33133, 33134, 33135]), tensor([33136, 33139, 33140,  ..., 36121, 36122, 36123]), tensor([36124, 36125, 36126,  ..., 39117, 39119, 39120]), tensor([39121, 39122, 39123,  ..., 42084, 42085, 42086]), tensor([42087, 42089, 42090,  ..., 45102, 45103, 45104]), tensor([45105, 45106, 45107,  ..., 48108, 48109, 48110]), tensor([48112, 48113, 48115,  ..., 51122, 51123, 51124]), tensor([51125, 51126, 51127,  ..., 54131, 54132, 54133]), tensor([54134, 54135, 54136,  ..., 57139, 57140, 57141]), tensor([57142, 57143, 57145,  ..., 60211, 60212, 60213]), tensor([60214, 60215, 60216,  ..., 63224, 63225, 63226]), tensor([63227, 63228, 63229,  ..., 66227, 66229, 66230]), tensor([66231, 66232, 66234,  ..., 69226, 69227, 69228]), tensor([69229, 69230, 69231,  ..., 72252, 72253, 72254]), tensor([72255, 72257, 72258,  ..., 75250, 75251, 75253]), tensor([75255, 75256, 75257,  ..., 78283, 78284, 78286]), tensor([78287, 78288, 78289,  ..., 81324, 81325, 81326]), tensor([81327, 81328, 81329,  ..., 84346, 84347, 84348]), tensor([84349, 84350, 84351,  ..., 87337, 87339, 87340]), tensor([87341, 87342, 87343,  ..., 90330, 90331, 90332]), tensor([90335, 90336, 90337,  ..., 93318, 93319, 93321]), tensor([93323, 93324, 93325,  ..., 96307, 96308, 96309]), tensor([96310, 96311, 96312,  ..., 99349, 99350, 99352]), tensor([ 99353,  99354,  99355,  ..., 102321, 102322, 102323]), tensor([102324, 102325, 102326,  ..., 105345, 105346, 105347]), tensor([105348, 105349, 105350,  ..., 108368, 108369, 108370]), tensor([108371, 108372, 108373,  ..., 111372, 111373, 111374]), tensor([111375, 111376, 111377,  ..., 114356, 114357, 114358]), tensor([114359, 114360, 114361,  ..., 117357, 117358, 117359]), tensor([117360, 117361, 117363,  ..., 120391, 120392, 120394]), tensor([120395, 120396, 120397,  ..., 123372, 123373, 123374]), tensor([123375, 123376, 123377,  ..., 126371, 126372, 126373]), tensor([126375, 126376, 126377,  ..., 129396, 129397, 129398]), tensor([129399, 129400, 129401,  ..., 132412, 132413, 132415]), tensor([132417, 132418, 132419,  ..., 135442, 135443, 135444]), tensor([135446, 135447, 135448,  ..., 138431, 138432, 138433]), tensor([138435, 138436, 138438,  ..., 141442, 141443, 141444]), tensor([141445, 141446, 141447,  ..., 144428, 144429, 144430]), tensor([144431, 144432, 144433,  ..., 147426, 147427, 147428]), tensor([147429, 147431, 147433,  ..., 150453, 150454, 150455]), tensor([150456, 150457, 150458,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.48124170303344727
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.0004525184631347656
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028174877166748047
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.48636341094970703
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  2.685389995574951
self.buckets_partition() spend  sec:  0.5145761966705322
check connections block*********************************

the find indices time spent  0.09087133407592773

in edges time spent  0.7085154056549072
local to global src and eids time spent  2.299168348312378
time gen tails  0.39203977584838867
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.378527879714966

----------------------------------------
check connections block*********************************

the find indices time spent  0.8136501312255859

in edges time spent  6.161886215209961
local to global src and eids time spent  8.944562911987305
time gen tails  1.6554744243621826
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.261688470840454

block collection to dataloader spend  8.821487426757812e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4089350700378418  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2182035446167  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.216946125030518  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40890932083129883  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.319433212280273  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31983995437622  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4096860885620117  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.211090087890625  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.211496829986572  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4108409881591797  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.194100856781006  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.194507598876953  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4139866828918457  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21043586730957  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.210842609405518  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4156527519226074  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.305954933166504  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.30636167526245  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41783857345581055  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2054123878479  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.205819129943848  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41877174377441406  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22214984893799  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.222556591033936  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42039060592651367  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.205174922943115  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.205581665039062  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42169666290283203  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.204190731048584  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20459747314453  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4238319396972656  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.174461841583252  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.1748685836792  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4240145683288574  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20716905593872  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.207575798034668  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42575979232788086  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.133642196655273  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.13404893875122  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4290757179260254  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.319299697875977  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.319706439971924  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4300551414489746  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22392225265503  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.224328994750977  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4323725700378418  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.223225593566895  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.223632335662842  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4333176612854004  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23216962814331  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.232576370239258  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43587636947631836  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32326030731201  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32366704940796  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43796205520629883  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25853967666626  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258946418762207  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43921422958374023  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.249460220336914  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24986696243286  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4407925605773926  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28701114654541  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.287417888641357  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44270753860473633  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.330982208251953  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.3313889503479  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44328832626342773  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.18341636657715  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.183823108673096  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4460296630859375  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.245492935180664  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24589967727661  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44802427291870117  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.279740810394287  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.280147552490234  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44938230514526367  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24220609664917  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.242612838745117  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4504375457763672  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.268270015716553  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2686767578125  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45221614837646484  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33855962753296  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.338966369628906  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45412778854370117  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2656888961792  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.266095638275146  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45603179931640625  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.285320281982422  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28572702407837  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45708417892456055  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263107776641846  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263514518737793  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4595985412597656  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.265052795410156  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.265459537506104  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4604482650756836  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.209232807159424  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20963954925537  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46196556091308594  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26111602783203  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26152276992798  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4644336700439453  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.344874382019043  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.34528112411499  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46662044525146484  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.35249614715576  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.35290288925171  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46836137771606445  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.256160259246826  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.256567001342773  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4689784049987793  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.293792724609375  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.294199466705322  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47095775604248047  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2224063873291  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22281312942505  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4722561836242676  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.288755893707275  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.289162635803223  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4751920700073242  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.311167240142822  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31157398223877  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47636842727661133  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.37728977203369  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.37769651412964  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.477719783782959  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.21906614303589  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.219472885131836  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48022985458374023  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.372896194458008  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.373302936553955  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4825758934020996  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.302220821380615  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.302627563476562  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4823431968688965  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.267235279083252  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2676420211792  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48503923416137695  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29556179046631  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.295968532562256  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4851107597351074  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.277556896209717  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.277963638305664  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48861074447631836  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32244300842285  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.3228497505188  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48967504501342773  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27565097808838  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.276057720184326  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4881138801574707  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 18.972123622894287  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 18.972524642944336  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4932241439819336  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.2075275182723999
pure train time :  17.597109079360962
train time :  40.802717447280884
end to end time :  82.54275584220886
connection check time:  24.36704969406128
block generation time  14.64021635055542
generate_dataloader_bucket_block=======
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
print(split_batches_nid_list)  [tensor([   0,    1,    2,  ..., 2998, 3000, 3001]), tensor([3002, 3003, 3004,  ..., 5953, 5954, 5955]), tensor([5956, 5957, 5958,  ..., 8966, 8967, 8968]), tensor([ 8969,  8970,  8971,  ..., 11959, 11960, 11961]), tensor([11962, 11963, 11964,  ..., 14950, 14951, 14952]), tensor([14953, 14954, 14955,  ..., 17957, 17958, 17959]), tensor([17960, 17961, 17962,  ..., 20987, 20988, 20989]), tensor([20990, 20991, 20992,  ..., 24006, 24008, 24009]), tensor([24010, 24011, 24012,  ..., 27021, 27022, 27023]), tensor([27025, 27026, 27027,  ..., 30050, 30051, 30052]), tensor([30053, 30055, 30056,  ..., 33043, 33044, 33045]), tensor([33046, 33047, 33048,  ..., 36031, 36032, 36033]), tensor([36034, 36035, 36036,  ..., 39049, 39050, 39051]), tensor([39052, 39053, 39054,  ..., 42095, 42096, 42097]), tensor([42098, 42099, 42101,  ..., 45114, 45115, 45116]), tensor([45117, 45119, 45120,  ..., 48113, 48114, 48115]), tensor([48116, 48117, 48118,  ..., 51095, 51096, 51099]), tensor([51101, 51103, 51104,  ..., 54108, 54109, 54110]), tensor([54111, 54112, 54113,  ..., 57103, 57104, 57105]), tensor([57106, 57108, 57109,  ..., 60140, 60141, 60142]), tensor([60143, 60144, 60145,  ..., 63115, 63116, 63117]), tensor([63118, 63119, 63120,  ..., 66118, 66119, 66123]), tensor([66124, 66125, 66127,  ..., 69129, 69130, 69131]), tensor([69132, 69133, 69134,  ..., 72088, 72089, 72090]), tensor([72091, 72092, 72093,  ..., 75091, 75092, 75093]), tensor([75094, 75095, 75096,  ..., 78104, 78105, 78106]), tensor([78107, 78109, 78110,  ..., 81123, 81124, 81125]), tensor([81126, 81127, 81128,  ..., 84149, 84150, 84151]), tensor([84152, 84153, 84154,  ..., 87155, 87156, 87157]), tensor([87158, 87159, 87161,  ..., 90155, 90156, 90157]), tensor([90159, 90160, 90161,  ..., 93147, 93148, 93149]), tensor([93150, 93151, 93152,  ..., 96172, 96173, 96175]), tensor([96176, 96178, 96179,  ..., 99175, 99176, 99177]), tensor([ 99178,  99179,  99180,  ..., 102206, 102207, 102208]), tensor([102209, 102210, 102212,  ..., 105290, 105291, 105292]), tensor([105294, 105295, 105297,  ..., 108292, 108293, 108294]), tensor([108296, 108297, 108298,  ..., 111298, 111299, 111301]), tensor([111302, 111303, 111304,  ..., 114301, 114302, 114304]), tensor([114307, 114308, 114309,  ..., 117291, 117293, 117294]), tensor([117296, 117297, 117298,  ..., 120321, 120322, 120323]), tensor([120324, 120325, 120326,  ..., 123354, 123355, 123356]), tensor([123357, 123358, 123360,  ..., 126382, 126384, 126385]), tensor([126386, 126387, 126388,  ..., 129399, 129400, 129402]), tensor([129403, 129404, 129405,  ..., 132415, 132416, 132418]), tensor([132419, 132420, 132421,  ..., 135409, 135410, 135411]), tensor([135412, 135413, 135414,  ..., 138420, 138422, 138423]), tensor([138424, 138425, 138426,  ..., 141399, 141400, 141401]), tensor([141402, 141403, 141404,  ..., 144426, 144427, 144428]), tensor([144429, 144430, 144431,  ..., 147447, 147448, 147449]), tensor([147450, 147451, 147452,  ..., 150469, 150470, 150471]), tensor([150472, 150473, 150474,  ..., 153428, 153429, 153430])]
self.K  51
G_BUCKET_ID_list [[23], [5, 1], [22], [6, 2], [21], [0, 3], [20], [18], [19], [16], [17], [14], [15], [12], [13], [11], [10], [9], [8], [7], [4]]
Groups_mem_list  [[2593], [1427, 1151], [2518], [1482, 996], [2474], [1339, 1133], [2454], [2338], [2277], [2199], [2177], [2164], [2137], [2075], [2026], [1915], [1872], [1678], [1611], [1609], [1273], [1273]]
G_BUCKET_ID_list length 21
backpack scheduling spend  0.14074206352233887
21
51
current group_mem  2.593600036529913
current group_mem  2.578288437755119
current group_mem  2.518576996875674
current group_mem  2.4788913927468563
current group_mem  2.4747481289605364
current group_mem  2.472064271284017
current group_mem  2.454792454762997
current group_mem  2.3384675421966064
current group_mem  2.2770233221822953
current group_mem  2.1997352567082333
current group_mem  2.1771046663129945
current group_mem  2.1645393796554804
current group_mem  2.1370398432040925
current group_mem  2.0752913576516465
current group_mem  2.0264824781498296
current group_mem  1.915525670833232
current group_mem  1.8729928371372757
current group_mem  1.6784923510901304
current group_mem  1.6116104018773965
current group_mem  1.6097993905165318
current group_mem  1.273968707844615
batches output list generation spend  0.00034618377685546875
self.weights_list  [0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017323748134340518, 0.017082597389054363]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0220949649810791
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.14565753936767578
num_output  135521
self.output_nids  153431
output nodes length not match !!!!
partition total batch output list spend :  1.9526917934417725
self.buckets_partition() spend  sec:  0.1677711009979248
check connections block*********************************

the find indices time spent  0.04959988594055176

in edges time spent  0.40794801712036133
local to global src and eids time spent  1.520179033279419
time gen tails  0.36171746253967285
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  2.386341094970703

----------------------------------------
check connections block*********************************

the find indices time spent  0.8973491191864014

in edges time spent  5.323301315307617
local to global src and eids time spent  10.498299837112427
time gen tails  1.6757099628448486
res  length 51

block_gen_time in "generate_blocks_for_one_layer_block"  12.150345802307129

block collection to dataloader spend  8.368492126464844e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40963029861450195  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.246095657348633  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.244839668273926  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.40784740447998047  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.220556259155273  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.22096300125122  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41070079803466797  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20551872253418  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.205925464630127  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41273927688598633  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.303056716918945  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.303463459014893  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4127202033996582  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.219459056854248  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.219865798950195  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4159126281738281  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.302342414855957  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.302749156951904  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4165525436401367  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.20197582244873  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.202382564544678  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.41785335540771484  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26620626449585  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.266613006591797  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4198770523071289  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.303565502166748  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.303972244262695  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4230952262878418  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.31751823425293  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.317924976348877  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4249420166015625  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263760566711426  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.264167308807373  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4256291389465332  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.234371662139893  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23477840423584  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42591190338134766  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.160680770874023  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16108751296997  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.42843008041381836  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.169312477111816  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.169719219207764  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4300074577331543  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.227386474609375  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.227793216705322  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43155860900878906  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.18238639831543  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.182793140411377  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4349026679992676  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.237103939056396  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.237510681152344  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43541812896728516  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.2215576171875  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.221964359283447  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43834495544433594  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32612895965576  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32653570175171  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.43939876556396484  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.219841480255127  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.220248222351074  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44075536727905273  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263856410980225  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.264263153076172  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4414339065551758  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.283018589019775  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.283425331115723  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44382381439208984  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.229618549346924  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.23002529144287  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4450197219848633  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.329803943634033  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33021068572998  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.447359561920166  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.237849712371826  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.238256454467773  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.44926929473876953  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25571584701538  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.256122589111328  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45145654678344727  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.335381984710693  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.33578872680664  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4528541564941406  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.344099521636963  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.34450626373291  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45562171936035156  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.344438552856445  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.344845294952393  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4555807113647461  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.261715412139893  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26212215423584  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.45621347427368164  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.165208339691162  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.16561508178711  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4593815803527832  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.253113746643066  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.253520488739014  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46067190170288086  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.289522171020508  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.289928913116455  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46178770065307617  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.253532886505127  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.253939628601074  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46370744705200195  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.26263952255249  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.263046264648438  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4660606384277344  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.3548903465271  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.355297088623047  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.46770286560058594  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.293118953704834  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.29352569580078  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4681859016418457  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.257712364196777  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.258119106292725  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4716825485229492  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.359808921813965  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.360215663909912  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4730062484741211  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.328797340393066  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.329204082489014  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  40
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4743375778198242  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.259406566619873  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.25981330871582  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  41
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4753379821777344  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.277833461761475  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.278240203857422  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  42
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.47885608673095703  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.28560209274292  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.286008834838867  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  43
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4795546531677246  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.27362060546875  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.274027347564697  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  44
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4812941551208496  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.377917289733887  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.378324031829834  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  45
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4831118583679199  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.32608461380005  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.326491355895996  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  46
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4837832450866699  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.195300579071045  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.195707321166992  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  47
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48732614517211914  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.287324905395508  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.287731647491455  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  48
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.48682308197021484  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.244697093963623  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.24510383605957  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  49
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4886136054992676  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.224081993103027  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.224488735198975  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

step  50
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4894843101501465  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.108731269836426  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 19.109132289886475  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.400390625 GB
    Memory Allocated: 0.4946269989013672  GigaBytes
Max Memory Allocated: 20.65906810760498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.20322401821613312
pure train time :  17.215256214141846
train time :  40.68962335586548
end to end time :  81.26621437072754
connection check time:  24.039206981658936
block generation time  14.536686897277832
end to end time  81.91041851043701
Total (block generation + training)time/epoch 81.91041851043701
pure train time per /epoch  [18.357827186584473, 17.50130033493042, 17.210593938827515, 17.636838912963867, 17.350931882858276, 17.42736506462097, 17.27213191986084, 17.072305917739868, 17.439691305160522, 17.52677273750305, 17.077008724212646, 17.01270842552185, 17.313623666763306, 17.121615409851074, 17.133852005004883, 16.85057520866394, 17.205814361572266, 17.281208992004395, 17.060011386871338, 17.420592784881592, 17.07845640182495, 17.466021299362183, 17.305277347564697, 17.33353543281555, 17.171767950057983, 17.191099405288696, 17.10688591003418, 17.383899450302124, 17.48467755317688, 17.603498935699463, 17.494296312332153, 17.48498272895813, 17.32308554649353, 17.26604390144348, 17.369266271591187, 17.083698987960815, 17.106588125228882, 17.48695421218872, 17.597109079360962, 17.215256214141846]
pure train time average  17.29068783167246
input num list  [7867567, 7869619, 7868137, 7861127, 7868959, 7863227, 7872174, 7863442, 7861543, 7873400, 7864972, 7872568, 7864223, 7866474, 7867878, 7874271, 7866691, 7871935, 7869078, 7867502, 7871395, 7865140, 7870139, 7863129, 7862199, 7857872, 7866518, 7863942, 7866819, 7871006, 7868343, 7868037, 7861319, 7869725, 7860859, 7862147, 7865686, 7863435, 7869287, 7868613]
