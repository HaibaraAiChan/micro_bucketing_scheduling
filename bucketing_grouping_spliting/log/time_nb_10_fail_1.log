main start at this time 1686890057.1202319
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  10
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.09328944757873746, 0.09328944757873746, 0.09328944757873746, 0.09328944757873746, 0.09328944757873746, 0.09328944757873746, 0.09328944757873746, 0.09328944757873746, 0.09328944757873746, 0.09327927313795016]
check_connections_block*********************************
num of batch  10
check_connections_block*********************************
generate_K_hop_neighbors time  43.49820947647095
5.81906821860076
5.815188648728832
5.797303353970417
5.824221518663199
5.803077597500729
5.827835728078772
5.801124544541947
5.821812045719485
5.801963083584033
5.827945928501973
the split redundant ratio 
[5.81906821860076, 5.815188648728832, 5.797303353970417, 5.824221518663199, 5.803077597500729, 5.827835728078772, 5.801124544541947, 5.821812045719485, 5.801963083584033, 5.827945928501973]
10
average memory estimation for each split fanout bucket batch 17.93604829604411
capacity est:  0.6207868105714169
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  1000
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [2, 4]
original bucket_id :,  [21, 18]
remove weights:  [545 455], 		------------sum 1000

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [6, 9, 10]
original bucket_id :,  [15, 12, 11]
remove weights:  [388 331 281], 		------------sum 1000

before remove weights,  [595, 583, 494, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 448, 427, 410, 383, 362, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [4, 7, 10]
original bucket_id :,  [17, 13, 8]
remove weights:  [427 362 211], 		------------sum 1000

before remove weights,  [595, 583, 494, 448, 427, 410, 383, 362, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 494, 448, 410, 383, 280, 253, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [2, 7, 8, 12]
original bucket_id :,  [20, 9, 7, 3]
remove weights:  [494 253 181  72], 		------------sum 1000

before remove weights,  [595, 583, 494, 448, 410, 383, 280, 253, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 448, 410, 383, 280, 165, 132, 95, 53, 46, 31]

remove bucket_id:  [5, 6, 8, 10, 11]
original bucket_id :,  [10, 6, 4, 2, 0]
remove weights:  [280 165  95  46  31], 		------------sum 617

before remove weights,  [595, 583, 448, 410, 383, 280, 165, 132, 95, 53, 46, 31]
after remove pre pack weights,  [595, 583, 448, 410, 383, 132, 53]

remove bucket_id:  [1, 3]
original bucket_id :,  [22, 16]
remove weights:  [583 410], 		------------sum 993

before remove weights,  [595, 583, 448, 410, 383, 132, 53]
after remove pre pack weights,  [595, 448, 383, 132, 53]

remove bucket_id:  [0, 2]
original bucket_id :,  [23, 14]
remove weights:  [595 383], 		------------sum 978

before remove weights,  [595, 448, 383, 132, 53]
after remove pre pack weights,  [448, 132, 53]
G_BUCKET_ID_list [[21, 18], [15, 12, 11], [17, 13, 8], [20, 9, 7, 3], [10, 6, 4, 2, 0], [22, 16], [23, 14], [19, 5, 1]]
[[21, 18], [15, 12, 11], [17, 13, 8], [20, 9, 7, 3], [10, 6, 4, 2, 0], [22, 16], [23, 14], [19, 5, 1]]
G_BUCKET_ID_list length 8
split_batches_nid_list  10
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[21, 18]
current group_mem  1.00151067857457
the new estimated memory cost(GB) for batch 0 18.93755897461868
[15, 12, 11]
current group_mem  1.001725397178439
the new estimated memory cost(GB) for batch 1 18.93777369322255
[17, 13, 8]
current group_mem  1.0006656987864855
the new estimated memory cost(GB) for batch 2 18.936713994830594
[20, 9, 7, 3]
current group_mem  1.0007544595578484
the new estimated memory cost(GB) for batch 3 18.93680275560196
[10, 6, 4, 2, 0]
current group_mem  0.6205012665987287
the new estimated memory cost(GB) for batch 4 18.55654956264284
[22, 16]
current group_mem  0.9943211991771329
the new estimated memory cost(GB) for batch 5 18.930369495221242
[23, 14]
current group_mem  0.9786631398104554
the new estimated memory cost(GB) for batch 6 18.914711435854564
[19, 5, 1]
current group_mem  0.6342025262275531
the new estimated memory cost(GB) for batch 7 18.570250822271664
the length of split_batches_nid_list  10
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023978471755981445
total k batches seeds list generation spend  43.63681888580322
len local_batched_seeds_list  10
partition total batch output list spend :  46.71566891670227
 the number of batches:  10
check_connections_block*********************************
num of batch  10
check_connections_block*********************************
