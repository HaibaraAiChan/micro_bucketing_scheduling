main start at this time 1686329860.9066565
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  19
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
check_connections_block*********************************
num of batch  19
check_connections_block*********************************
generate_K_hop_neighbors time  60.250659465789795
8.489265868274341
8.510481041963493
8.504128589765696
8.476853378344995
8.477488623564774
8.475260223666817
8.495940984710758
8.503967257646387
8.46694153626494
8.493319337771984
8.520201302151868
8.49355125269349
8.455577705111104
8.476500464334006
8.514605094263333
8.460800832473737
8.492926090731167
8.539097326625951
8.480265020583609
the split redundant ratio 
[8.489265868274341, 8.510481041963493, 8.504128589765696, 8.476853378344995, 8.477488623564774, 8.475260223666817, 8.495940984710758, 8.503967257646387, 8.46694153626494, 8.493319337771984, 8.520201302151868, 8.49355125269349, 8.455577705111104, 8.476500464334006, 8.514605094263333, 8.460800832473737, 8.492926090731167, 8.539097326625951, 8.480265020583609]
19
average memory estimation for each split fanout bucket batch 13.786546410165027
capacity est:  0.1352024986099689
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  595
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [14, 20]
original bucket_id :,  [8, 1]
remove weights:  [211  53], 		------------sum 264

before remove weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 181, 165, 132, 95, 72, 46, 31]

remove bucket_id:  [14, 20]
original bucket_id :,  [7, 0]
remove weights:  [181  31], 		------------sum 212

before remove weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 181, 165, 132, 95, 72, 46, 31]
after remove pre pack weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 165, 132, 95, 72, 46]

remove bucket_id:  [16, 17]
original bucket_id :,  [4, 3]
remove weights:  [95 72], 		------------sum 167

before remove weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 165, 132, 95, 72, 46]
after remove pre pack weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 165, 132, 46]

remove bucket_id:  [14, 16]
original bucket_id :,  [6, 2]
remove weights:  [165  46], 		------------sum 211

before remove weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 165, 132, 46]
after remove pre pack weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 132]

remove bucket_id:  [3, 14]
original bucket_id :,  [18, 5]
remove weights:  [455 132], 		------------sum 587

before remove weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 132]
after remove pre pack weights,  [583, 545, 494, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253]

remove bucket_id:  [9, 12]
original bucket_id :,  [12, 9]
remove weights:  [331 253], 		------------sum 584

before remove weights,  [583, 545, 494, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253]
after remove pre pack weights,  [583, 545, 494, 448, 427, 410, 388, 383, 362, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 545, 494, 448, 427, 410, 388, 383, 362, 281, 280]
after remove pre pack weights,  [545, 494, 448, 427, 410, 388, 383, 362, 281, 280]

remove bucket_id:  [8, 9]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [545, 494, 448, 427, 410, 388, 383, 362, 281, 280]
after remove pre pack weights,  [545, 494, 448, 427, 410, 388, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [545], 		------------sum 545

before remove weights,  [545, 494, 448, 427, 410, 388, 383, 362]
after remove pre pack weights,  [494, 448, 427, 410, 388, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 388, 383, 362]
after remove pre pack weights,  [448, 427, 410, 388, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 388, 383, 362]
after remove pre pack weights,  [427, 410, 388, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 388, 383, 362]
after remove pre pack weights,  [410, 388, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 388, 383, 362]
after remove pre pack weights,  [388, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [388], 		------------sum 388

before remove weights,  [388, 383, 362]
after remove pre pack weights,  [383, 362]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 362]
after remove pre pack weights,  [362]
the last batch value is  362
G_BUCKET_ID_list [[23], [8, 1], [7, 0], [4, 3], [6, 2], [18, 5], [12, 9], [22], [11, 10], [21], [20], [19], [17], [16], [15], [14], [13]]
G_BUCKET_ID_list length 17
split_batches_nid_list  19
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[23]
current group_mem  0.5952225418284881
the new estimated memory cost(GB) for batch 0 14.381768951993514
[8, 1]
current group_mem  0.26475316804776117
the new estimated memory cost(GB) for batch 1 14.051299578212788
[7, 0]
current group_mem  0.21286495226486504
the new estimated memory cost(GB) for batch 2 13.999411362429893
[4, 3]
current group_mem  0.16754250343800875
the new estimated memory cost(GB) for batch 3 13.954088913603035
[6, 2]
current group_mem  0.21253860960757287
the new estimated memory cost(GB) for batch 4 13.9990850197726
[18, 5]
current group_mem  0.588449010213026
the new estimated memory cost(GB) for batch 5 14.374995420378053
[12, 9]
current group_mem  0.5849106351775074
the new estimated memory cost(GB) for batch 6 14.371457045342535
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 7 14.370380984565397
[11, 10]
current group_mem  0.5622422140780288
the new estimated memory cost(GB) for batch 8 14.348788624243056
[21]
current group_mem  0.5455698065359045
the new estimated memory cost(GB) for batch 9 14.332116216700932
[20]
current group_mem  0.494359802184077
the new estimated memory cost(GB) for batch 10 14.280906212349104
[19]
current group_mem  0.4482479429953582
the new estimated memory cost(GB) for batch 11 14.234794353160385
[17]
current group_mem  0.427057239492208
the new estimated memory cost(GB) for batch 12 14.213603649657236
[16]
current group_mem  0.4104866247767621
the new estimated memory cost(GB) for batch 13 14.19703303494179
[15]
current group_mem  0.38852240658495635
the new estimated memory cost(GB) for batch 14 14.175068816749983
[14]
current group_mem  0.3834405979819673
the new estimated memory cost(GB) for batch 15 14.169987008146993
[13]
current group_mem  0.36230173630435075
the new estimated memory cost(GB) for batch 16 14.148848146469378
the length of split_batches_nid_list  19
len local_batched_seeds_list  19
 the number of batches:  19
check_connections_block*********************************
num of batch  19
check_connections_block*********************************
----------------------------------------after generate_dataloader_bucket_block 
 Nvidia-smi: 1.34375 GB
    Memory Allocated: 0.000934600830078125  GigaBytes
Max Memory Allocated: 0.000934600830078125  GigaBytes

batch 2
src global  1813939
seeds global  184033
----------------------------------------after load_block_subtensor
 Nvidia-smi: 2.0390625 GB
    Memory Allocated: 0.6780872344970703  GigaBytes
Max Memory Allocated: 0.6780872344970703  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 2.23046875 GB
    Memory Allocated: 0.7986984252929688  GigaBytes
Max Memory Allocated: 0.7986984252929688  GigaBytes

