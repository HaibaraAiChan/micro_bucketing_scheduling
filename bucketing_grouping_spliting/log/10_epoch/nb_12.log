main start at this time 1688358042.8147094
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

self.global_to_local() spend sec:  0.3197965621948242
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
num of batch  12
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  37.65359377861023
6.521662016060751
6.537532348060836
6.50851103870113
6.50938989336245
6.528444481381815
6.5051675698808875
6.543792595394738
6.512338514436303
6.519999834418687
6.506269322463557
6.531609631864977
6.532575947258202
the split redundant ratio 
[6.521662016060751, 6.537532348060836, 6.50851103870113, 6.50938989336245, 6.528444481381815, 6.5051675698808875, 6.543792595394738, 6.512338514436303, 6.519999834418687, 6.506269322463557, 6.531609631864977, 6.532575947258202]
12
average memory estimation for each split fanout bucket batch 16.76553815981126
capacity est:  1.2769998693393632
split fanout degree bucket spend /sec:  37.65439200401306
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10761618614196777
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.56751779393411
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.56661792958631
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.118895711434693
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.564501854422414
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.55946538256999
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.557989297006827
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.55489713560782
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.553388897728908
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.495079227521117
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.34937273421163
the length of split_batches_nid_list  12
batches output list generation spend  0.0028030872344970703
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026562929153442383
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  37.76490783691406
len local_batched_seeds_list  12
partition total batch output list spend :  41.25462317466736
self.buckets_partition() spend  sec:  37.79152035713196
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.85546875 GB
    Memory Allocated: 20.87930727005005  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.83203125 GB
    Memory Allocated: 20.86750030517578  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.83203125 GB
    Memory Allocated: 20.459396362304688  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.953125 GB
    Memory Allocated: 20.961812496185303  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.87109375 GB
    Memory Allocated: 20.89730930328369  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.8828125 GB
    Memory Allocated: 20.870521068572998  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.96028709411621  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.925491333007812  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.873311519622803  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.763845920562744  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.212109565734863  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.213406562805176  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 0.5699458122253418  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.857676982879639
pure train time :  3.2603745460510254
train time :  6.769968032836914
connection check time:  45.68018341064453
block generation time  44.87668442726135
self.global_to_local() spend sec:  0.36930298805236816
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
num of batch  12
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  36.96110463142395
6.516802841375331
6.54268447430003
6.510905599227628
6.499977232569462
6.533583870596931
6.5253875956033065
6.549339569380322
6.500601346749241
6.516000408858473
6.5079633466658136
6.533481974404314
6.53277981968758
the split redundant ratio 
[6.516802841375331, 6.54268447430003, 6.510905599227628, 6.499977232569462, 6.533583870596931, 6.5253875956033065, 6.549339569380322, 6.500601346749241, 6.516000408858473, 6.5079633466658136, 6.533481974404314, 6.53277981968758]
12
average memory estimation for each split fanout bucket batch 16.768155029514297
capacity est:  1.2627395237180892
split fanout degree bucket spend /sec:  36.96187877655029
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.1085042953491211
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.570134663637145
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.569234799289347
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.12151258113773
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.56711872412545
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.562082252273026
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.560606166709864
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.557514005310857
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.556005767431948
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.497696097224154
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.351989603914667
the length of split_batches_nid_list  12
batches output list generation spend  0.001795053482055664
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.024914979934692383
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  37.072272062301636
len local_batched_seeds_list  12
partition total batch output list spend :  40.02859830856323
self.buckets_partition() spend  sec:  37.09723734855652
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.03125 GB
    Memory Allocated: 20.88991355895996  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.04296875 GB
    Memory Allocated: 20.889187335968018  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.04296875 GB
    Memory Allocated: 20.487768173217773  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.817050457000732  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.791764736175537  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.934958457946777  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.959117889404297  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.912869453430176  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.880499362945557  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.78062629699707  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.31846570968628  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.271262645721436  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 0.5745038986206055  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2391610145568848
pure train time :  2.437152147293091
train time :  5.450101852416992
connection check time:  44.28908348083496
block generation time  44.72044825553894
self.global_to_local() spend sec:  0.33469343185424805
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
num of batch  12
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  37.13072896003723
6.525234751314382
6.538532204450889
6.5130645248087
6.499665175479573
6.525712389717273
6.5197132513769525
6.5478493375632985
6.52227976172849
6.519700514352875
6.50665143318587
6.529941081710875
6.546719597046144
the split redundant ratio 
[6.525234751314382, 6.538532204450889, 6.5130645248087, 6.499665175479573, 6.525712389717273, 6.5197132513769525, 6.5478493375632985, 6.52227976172849, 6.519700514352875, 6.50665143318587, 6.529941081710875, 6.546719597046144]
12
average memory estimation for each split fanout bucket batch 16.773630035426283
capacity est:  1.2665706613476893
split fanout degree bucket spend /sec:  37.131447553634644
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.11034536361694336
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.57560966954913
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.574709805201334
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.126987587049715
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.572593730037436
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.567557258185012
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.56608117262185
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.562989011222843
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.56148077334393
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.50317110313614
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.357464609826653
the length of split_batches_nid_list  12
batches output list generation spend  0.00173187255859375
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02783346176147461
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  37.24363613128662
len local_batched_seeds_list  12
partition total batch output list spend :  40.707778215408325
self.buckets_partition() spend  sec:  37.271520137786865
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.830885887145996  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.88627576828003  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.47308921813965  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.885474681854248  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.886273860931396  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.93744945526123  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.923717498779297  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.969818592071533  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.833988666534424  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.794161796569824  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.157340049743652  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.219388484954834  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 0.5777478218078613  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.547273635864258
pure train time :  2.3963451385498047
train time :  5.395087003707886
connection check time:  44.81084847450256
block generation time  43.9800386428833
self.global_to_local() spend sec:  0.3325047492980957
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
num of batch  12
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  36.548391342163086
6.525935287638624
6.5359465885632355
6.511631609600022
6.505970002397745
6.520394682165078
6.513204632073546
6.5494350970609
6.517318690850455
6.520044414002957
6.512504095749306
6.532864228736574
6.537685500019432
the split redundant ratio 
[6.525935287638624, 6.5359465885632355, 6.511631609600022, 6.505970002397745, 6.520394682165078, 6.513204632073546, 6.5494350970609, 6.517318690850455, 6.520044414002957, 6.512504095749306, 6.532864228736574, 6.537685500019432]
12
average memory estimation for each split fanout bucket batch 16.771031524099065
capacity est:  1.2624939379726037
split fanout degree bucket spend /sec:  36.549275159835815
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.2562689781188965
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.573011158221913
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.572111293874116
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.124389075722497
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.56999521871022
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.564958746857794
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.563482661294632
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.560390499895625
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.558882262016716
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.500572591808922
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.354866098499436
the length of split_batches_nid_list  12
batches output list generation spend  0.0017383098602294922
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03859543800354004
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  36.80760049819946
len local_batched_seeds_list  12
partition total batch output list spend :  40.27365684509277
self.buckets_partition() spend  sec:  36.846245765686035
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.869750022888184  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.906763553619385  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.447404861450195  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.853790283203125  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.82582187652588  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.936280727386475  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.957692623138428  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.91869068145752  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.913366317749023  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.81868314743042  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.296515464782715  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.21473789215088  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 0.576045036315918  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.090529680252075
pure train time :  2.299057722091675
train time :  5.229116678237915
connection check time:  40.50254034996033
block generation time  29.664484977722168
self.global_to_local() spend sec:  0.28003811836242676
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
num of batch  12
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  36.43177056312561
6.522521765185957
6.532150955388255
6.517433324067149
6.489672980091076
6.525393964115345
6.500811507646514
6.549358674916437
6.515051500564728
6.5124658846770735
6.507683132136117
6.530081188975724
6.5313654547087845
the split redundant ratio 
[6.522521765185957, 6.532150955388255, 6.517433324067149, 6.489672980091076, 6.525393964115345, 6.500811507646514, 6.549358674916437, 6.515051500564728, 6.5124658846770735, 6.507683132136117, 6.530081188975724, 6.5313654547087845]
12
average memory estimation for each split fanout bucket batch 16.76054584553331
capacity est:  1.2626904065689928
split fanout degree bucket spend /sec:  36.43250632286072
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10903549194335938
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.56252547965616
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.561625615308362
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.113903397156744
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.559509540144465
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.55447306829204
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.552996982728878
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.54990482132987
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.54839658345096
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.490086913243168
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.34438041993368
the length of split_batches_nid_list  12
batches output list generation spend  0.0016858577728271484
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025399446487426758
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  36.543312788009644
len local_batched_seeds_list  12
partition total batch output list spend :  39.72197198867798
self.buckets_partition() spend  sec:  36.56876015663147
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.87788200378418  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.84088706970215  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.48173236846924  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.984375 GB
    Memory Allocated: 20.998186111450195  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.955078125 GB
    Memory Allocated: 20.8947696685791  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.871445655822754  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.863461017608643  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.950387001037598  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.83047914505005  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.777570724487305  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.288795471191406  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.270976543426514  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.578216552734375  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.658360242843628
pure train time :  2.6717326641082764
train time :  5.621574640274048
connection check time:  44.81907868385315
block generation time  43.576205253601074
self.global_to_local() spend sec:  0.34446263313293457
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
num of batch  12
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  36.52189898490906
6.52361078074455
6.531635105913131
6.518152965927506
6.497378879657732
6.531666948473325
6.512344882948342
6.541614564277552
6.519859727153839
6.518636972842436
6.50560062869951
6.519178296365714
6.540597053151454
the split redundant ratio 
[6.52361078074455, 6.531635105913131, 6.518152965927506, 6.497378879657732, 6.531666948473325, 6.512344882948342, 6.541614564277552, 6.519859727153839, 6.518636972842436, 6.50560062869951, 6.519178296365714, 6.540597053151454]
12
average memory estimation for each split fanout bucket batch 16.766177357429754
capacity est:  1.2825992243364617
split fanout degree bucket spend /sec:  36.522531032562256
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.21036148071289062
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.568156991552602
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.567257127204805
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.119534909053186
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.565141052040907
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.560104580188483
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.55862849462532
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.555536333226314
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.554028095347405
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.49571842513961
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.350011931830124
the length of split_batches_nid_list  12
batches output list generation spend  0.0014629364013671875
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02619314193725586
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  36.734490633010864
len local_batched_seeds_list  12
partition total batch output list spend :  40.2036817073822
self.buckets_partition() spend  sec:  36.76073622703552
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.86618423461914  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.978515625 GB
    Memory Allocated: 20.81562328338623  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.978515625 GB
    Memory Allocated: 20.485912799835205  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.8858962059021  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.897313594818115  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.87066888809204  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.961467266082764  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.876830577850342  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.832877159118652  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.778599739074707  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.27328109741211  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.274209022521973  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 0.5738925933837891  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4476399421691895
pure train time :  2.4538135528564453
train time :  5.601253271102905
connection check time:  44.940791845321655
block generation time  46.869723081588745
self.global_to_local() spend sec:  0.343031644821167
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
num of batch  12
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  36.8196907043457
6.534481830794368
6.538029091999843
6.519598618160258
6.502562848457117
6.532361116285528
6.514879550739686
6.540289913773532
6.50732012694992
6.519885201201992
6.505033831128077
6.532405695869797
6.5476306519649174
the split redundant ratio 
[6.534481830794368, 6.538029091999843, 6.519598618160258, 6.502562848457117, 6.532361116285528, 6.514879550739686, 6.540289913773532, 6.50732012694992, 6.519885201201992, 6.505033831128077, 6.532405695869797, 6.5476306519649174]
12
average memory estimation for each split fanout bucket batch 16.773504590454703
capacity est:  1.267132865573526
split fanout degree bucket spend /sec:  36.8208749294281
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10879063606262207
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.57548422457755
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.574584360229753
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.126862142078135
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.572468285065856
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.56743181321343
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.56595572765027
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.562863566251263
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.56135532837235
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.50304565816456
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.357339164855073
the length of split_batches_nid_list  12
batches output list generation spend  0.0017502307891845703
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03906512260437012
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  36.93150997161865
len local_batched_seeds_list  12
partition total batch output list spend :  40.45142722129822
self.buckets_partition() spend  sec:  36.97063112258911
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.889294147491455  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.88482666015625  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.402989864349365  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.850690364837646  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.849075317382812  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.865787982940674  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 21.017892837524414  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.967775344848633  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.967628955841064  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.73578643798828  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.26336431503296  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.24595308303833  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 0.5739350318908691  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.302002191543579
pure train time :  2.6522655487060547
train time :  5.71452784538269
connection check time:  44.66062545776367
block generation time  43.52326989173889
self.global_to_local() spend sec:  0.3503103256225586
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
num of batch  12
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  28.626463890075684
6.525941656150661
6.538767839396317
6.514408280848834
6.512344882948342
6.531686054009441
6.537041972633867
6.5421558878008295
6.519566775600065
6.515357189142579
6.511950035201951
6.541767408566477
6.535207175799833
the split redundant ratio 
[6.525941656150661, 6.538767839396317, 6.514408280848834, 6.512344882948342, 6.531686054009441, 6.537041972633867, 6.5421558878008295, 6.519566775600065, 6.515357189142579, 6.511950035201951, 6.541767408566477, 6.535207175799833]
12
average memory estimation for each split fanout bucket batch 16.780299448801113
capacity est:  1.281207571778701
split fanout degree bucket spend /sec:  28.62717056274414
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.15601372718811035
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.58227908292396
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.581379218576163
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.133657000424545
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.579263143412266
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.574226671559842
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.57275058599668
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.569658424597673
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.56815018671876
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.50984051651097
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.364134023201483
the length of split_batches_nid_list  12
batches output list generation spend  0.0010502338409423828
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03624153137207031
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  28.7843918800354
len local_batched_seeds_list  12
partition total batch output list spend :  30.237332820892334
self.buckets_partition() spend  sec:  28.820676803588867
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.792885780334473  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.01953125 GB
    Memory Allocated: 20.85314702987671  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.01953125 GB
    Memory Allocated: 20.513665199279785  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.845357418060303  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.931341648101807  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.977127075195312  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.8929762840271  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.964092254638672  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.950093269348145  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.727797985076904  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.27521324157715  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.30099058151245  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 0.579261302947998  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.194218635559082
pure train time :  2.461493492126465
train time :  5.4429380893707275
connection check time:  31.464659690856934
block generation time  41.37217354774475
self.global_to_local() spend sec:  0.3367650508880615
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
num of batch  12
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  36.590553522109985
6.525890708054353
6.550212055529603
6.514484702993296
6.503225173709127
6.528355322213275
6.51548455938335
6.552695775224642
6.5157902479612
6.516656365598445
6.505040199640116
6.5260881319275486
6.541043024090713
the split redundant ratio 
[6.525890708054353, 6.550212055529603, 6.514484702993296, 6.503225173709127, 6.528355322213275, 6.51548455938335, 6.552695775224642, 6.5157902479612, 6.516656365598445, 6.505040199640116, 6.5260881319275486, 6.541043024090713]
12
average memory estimation for each split fanout bucket batch 16.773609092473244
capacity est:  1.2541112778599839
split fanout degree bucket spend /sec:  36.59142518043518
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.11134076118469238
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.57558872659609
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.574688862248294
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.126966644096676
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.572572787084397
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.567536315231973
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.56606022966881
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.562968068269804
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.561459830390895
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.5031501601831
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.357443666873614
the length of split_batches_nid_list  12
batches output list generation spend  0.0017476081848144531
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03022170066833496
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  36.704622983932495
len local_batched_seeds_list  12
partition total batch output list spend :  40.15721082687378
self.buckets_partition() spend  sec:  36.73489737510681
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.865506172180176  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.85741376876831  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.467748641967773  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.876157760620117  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.839056491851807  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.978811264038086  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.972137928009033  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.966694831848145  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.871886730194092  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.72205352783203  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.233319759368896  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.24035406112671  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 0.5771632194519043  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0964686870574951
pure train time :  2.4395997524261475
train time :  5.3305768966674805
connection check time:  44.719178915023804
block generation time  43.473381757736206
self.global_to_local() spend sec:  0.33713388442993164
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
num of batch  12
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  36.197092056274414
6.5170703188809505
6.547308014040023
6.508663882990055
6.5007159799659355
6.516879263519794
6.510587173625699
6.540449126574495
6.508109822442701
6.51756069430792
6.50338438651009
6.531756107641865
6.530549964991282
the split redundant ratio 
[6.5170703188809505, 6.547308014040023, 6.508663882990055, 6.5007159799659355, 6.516879263519794, 6.510587173625699, 6.540449126574495, 6.508109822442701, 6.51756069430792, 6.50338438651009, 6.531756107641865, 6.530549964991282]
12
average memory estimation for each split fanout bucket batch 16.760341122152024
capacity est:  1.2679623139054428
split fanout degree bucket spend /sec:  36.197821617126465
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.24472475051879883
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.56232075627487
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.561420891927074
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.113698673775456
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.559304816763177
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.554268344910753
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.55279225934759
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.549700097948584
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.54819186006967
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.48988218986188
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.344175696552394
the length of split_batches_nid_list  12
batches output list generation spend  0.001367807388305664
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027550220489501953
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  36.444053173065186
len local_batched_seeds_list  12
partition total batch output list spend :  39.91738319396973
self.buckets_partition() spend  sec:  36.47165513038635
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.820992946624756  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.892221450805664  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.44477653503418  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.84020757675171  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.892187118530273  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.920042037963867  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.976149559020996  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.96395206451416  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.9428653717041  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.726227283477783  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.281135082244873  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.21934747695923  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 0.5754356384277344  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0051754713058472
pure train time :  2.3414881229400635
train time :  5.404308319091797
connection check time:  44.00384759902954
block generation time  43.92485332489014
