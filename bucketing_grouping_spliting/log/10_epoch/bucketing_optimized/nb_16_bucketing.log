main start at this time 1688700666.6991892
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

self.global_to_local() spend sec:  0.31776857376098633
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  16
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.05823849906649506]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  218937
orderedCounter spend  0.15227103233337402
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  871568
orderedCounter spend  0.9298191070556641
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.9165005683898926
7.730577840837449
the split redundant ratio 
[7.730577840837449]
1
average memory estimation for each split fanout bucket batch 14.905520399364706
capacity est:  3.1944796006352956
split fanout degree bucket spend /sec:  3.916985511779785
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10706090927124023
split_batches_nid_list  16
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 15.707500033487552
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 15.706600169139756
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.25887795098814
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 15.704484093975857
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 15.699447622123435
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 15.697971536560273
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 15.694879375161264
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 15.693371137282355
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 15.635061467074562
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.489354973765076
the length of split_batches_nid_list  16
batches output list generation spend  0.001413106918334961
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026356220245361328
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.027904748916626
len local_batched_seeds_list  16
partition total batch output list spend :  8.505210399627686
self.buckets_partition() spend  sec:  4.054326772689819
layer  0
 the number of batches:  16
check_connections_block*********************************
layer  1
num of batch  16
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 18.623046875 GB
    Memory Allocated: 16.7332444190979  GigaBytes
Max Memory Allocated: 17.006961822509766  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 18.6328125 GB
    Memory Allocated: 16.70793390274048  GigaBytes
Max Memory Allocated: 17.006961822509766  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 18.6328125 GB
    Memory Allocated: 16.270780563354492  GigaBytes
Max Memory Allocated: 17.006961822509766  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 19.533203125 GB
    Memory Allocated: 16.70328664779663  GigaBytes
Max Memory Allocated: 17.006961822509766  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.784860610961914  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.774892330169678  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.76575803756714  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.760653018951416  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.777587413787842  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.561343669891357  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.012991428375244  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.035685539245605  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.04208993911743  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.07529306411743  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.05691385269165  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.021483898162842  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 0.5249099731445312  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.8595733642578125
pure train time :  3.0449252128601074
train time :  6.883003234863281
end to end time :  114.36564111709595
connection check time:  50.419803619384766
block generation time  48.42257642745972
self.global_to_local() spend sec:  0.24852943420410156
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  16
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.05823849906649506]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  218765
orderedCounter spend  0.09502196311950684
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  870879
orderedCounter spend  0.6041598320007324
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  2.6242666244506836
7.724532263809623
the split redundant ratio 
[7.724532263809623]
1
average memory estimation for each split fanout bucket batch 14.89386377115793
capacity est:  3.2061362288420714
split fanout degree bucket spend /sec:  2.6247751712799072
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.03256964683532715
split_batches_nid_list  16
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 15.695843405280776
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 15.69494354093298
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.247221322781364
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 15.692827465769081
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 15.687790993916659
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 15.686314908353497
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 15.683222746954488
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 15.68171450907558
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 15.623404838867787
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.4776983455583
the length of split_batches_nid_list  16
batches output list generation spend  0.0008275508880615234
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023290157318115234
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  2.6601619720458984
len local_batched_seeds_list  16
partition total batch output list spend :  4.327988624572754
self.buckets_partition() spend  sec:  2.6835241317749023
layer  0
 the number of batches:  16
check_connections_block*********************************
layer  1
num of batch  16
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.75144100189209  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.70310115814209  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.31640625 GB
    Memory Allocated: 16.29316520690918  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.3203125 GB
    Memory Allocated: 16.77064847946167  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.3203125 GB
    Memory Allocated: 16.730406284332275  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.3203125 GB
    Memory Allocated: 16.65643310546875  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.3203125 GB
    Memory Allocated: 16.75410795211792  GigaBytes
Max Memory Allocated: 17.060935020446777  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.80003309249878  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.742568969726562  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.560784816741943  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.031355381011963  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.030999183654785  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.059138774871826  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.089210987091064  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.113024711608887  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.06027889251709  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 0.5243806838989258  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.239617347717285
pure train time :  2.553920030593872
train time :  6.040422677993774
end to end time :  109.26974821090698
connection check time:  50.77756381034851
block generation time  48.013914823532104
self.global_to_local() spend sec:  0.36081552505493164
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  16
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.05823849906649506]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  219233
orderedCounter spend  0.15688681602478027
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  871903
orderedCounter spend  1.0582070350646973
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.158078670501709
7.736173395979778
the split redundant ratio 
[7.736173395979778]
1
average memory estimation for each split fanout bucket batch 14.916309329123509
capacity est:  3.1836906708764925
split fanout degree bucket spend /sec:  4.163429021835327
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10868144035339355
split_batches_nid_list  16
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 15.718288963246355
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 15.71738909889856
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.269666880746943
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 15.71527302373466
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 15.710236551882238
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 15.708760466319076
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 15.705668304920067
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 15.704160067041158
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 15.645850396833366
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.50014390352388
the length of split_batches_nid_list  16
batches output list generation spend  0.0010020732879638672
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02670431137084961
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.273182153701782
len local_batched_seeds_list  16
partition total batch output list spend :  8.790469646453857
self.buckets_partition() spend  sec:  4.299951076507568
layer  0
 the number of batches:  16
check_connections_block*********************************
layer  1
num of batch  16
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.697617053985596  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.708740234375  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.287286281585693  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.764370918273926  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.729418754577637  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.783155918121338  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.763128757476807  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.782301425933838  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.716053009033203  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.608720302581787  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.031469345092773  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.003437995910645  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.080541133880615  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.029923915863037  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.01935386657715  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.045634746551514  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 0.5295701026916504  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5531222820281982
pure train time :  2.4484336376190186
train time :  6.0605628490448
end to end time :  111.9719033241272
connection check time:  49.67376136779785
block generation time  47.31598210334778
self.global_to_local() spend sec:  0.34290647506713867
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  16
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.05823849906649506]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  218794
orderedCounter spend  0.15494012832641602
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  871685
orderedCounter spend  0.9019546508789062
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.942613124847412
7.735723374094279
the split redundant ratio 
[7.735723374094279]
1
average memory estimation for each split fanout bucket batch 14.915441630675533
capacity est:  3.184558369324469
split fanout degree bucket spend /sec:  3.9430742263793945
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10982108116149902
split_batches_nid_list  16
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 15.717421264798379
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 15.716521400450583
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.268799182298967
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 15.714405325286684
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 15.709368853434261
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 15.7078927678711
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 15.70480060647209
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 15.703292368593182
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 15.64498269838539
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.499276205075903
the length of split_batches_nid_list  16
batches output list generation spend  0.0009698867797851562
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026587247848510742
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.0539350509643555
len local_batched_seeds_list  16
partition total batch output list spend :  7.524460792541504
self.buckets_partition() spend  sec:  4.080583572387695
layer  0
 the number of batches:  16
check_connections_block*********************************
layer  1
num of batch  16
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.740201950073242  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.717477321624756  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.288020133972168  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.771605968475342  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.737213134765625  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.716862678527832  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.717330932617188  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.780288696289062  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.777132511138916  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.560667514801025  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.03078842163086  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.06403875350952  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.134274005889893  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.06913661956787  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.05575942993164  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.045143127441406  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 0.5274777412414551  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.0830092430114746
pure train time :  2.4066925048828125
train time :  5.747792720794678
end to end time :  75.65175533294678
connection check time:  32.94285774230957
block generation time  29.317898273468018
self.global_to_local() spend sec:  0.3514118194580078
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  16
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.05823849906649506]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  219082
orderedCounter spend  0.15646958351135254
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  870984
orderedCounter spend  0.9385690689086914
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.7426013946533203
7.728183384767439
the split redundant ratio 
[7.728183384767439]
1
average memory estimation for each split fanout bucket batch 14.90090358875472
capacity est:  3.199096411245282
split fanout degree bucket spend /sec:  3.7430760860443115
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10881447792053223
split_batches_nid_list  16
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 15.702883222877565
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 15.70198335852977
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.254261140378151
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 15.699867283365872
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 15.694830811513448
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 15.693354725950286
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 15.690262564551277
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 15.688754326672369
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 15.630444656464576
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.48473816315509
the length of split_batches_nid_list  16
batches output list generation spend  0.0009734630584716797
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02839517593383789
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.85292911529541
len local_batched_seeds_list  16
partition total batch output list spend :  8.377768993377686
self.buckets_partition() spend  sec:  3.881399393081665
layer  0
 the number of batches:  16
check_connections_block*********************************
layer  1
num of batch  16
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.74185848236084  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.670686721801758  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.286165237426758  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.556640625 GB
    Memory Allocated: 16.766271591186523  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.783374786376953  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.782259464263916  GigaBytes
Max Memory Allocated: 17.07664203643799  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.805842876434326  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.73515510559082  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.666735649108887  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.610365867614746  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.036141395568848  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 15.994542121887207  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.068650722503662  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.07543420791626  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.037025928497314  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.05960512161255  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 0.5259237289428711  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.6565567255020142
pure train time :  2.6497864723205566
train time :  6.126778602600098
end to end time :  109.97067046165466
connection check time:  49.0709912776947
block generation time  46.293351888656616
self.global_to_local() spend sec:  0.3365960121154785
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  16
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.05823849906649506]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  219248
orderedCounter spend  0.15468502044677734
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  871862
orderedCounter spend  0.9171998500823975
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.687202215194702
7.735366752977468
the split redundant ratio 
[7.735366752977468]
1
average memory estimation for each split fanout bucket batch 14.914754020584681
capacity est:  3.1852459794153205
split fanout degree bucket spend /sec:  3.687802791595459
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.22179102897644043
split_batches_nid_list  16
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 15.716733654707527
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 15.715833790359731
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.268111572208113
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 15.713717715195834
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 15.70868124334341
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 15.707205157780248
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 15.70411299638124
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 15.70260475850233
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 15.644295088294538
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.498588594985051
the length of split_batches_nid_list  16
batches output list generation spend  0.0010292530059814453
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027169466018676758
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.9107449054718018
len local_batched_seeds_list  16
partition total batch output list spend :  8.405399084091187
self.buckets_partition() spend  sec:  3.937981128692627
layer  0
 the number of batches:  16
check_connections_block*********************************
layer  1
num of batch  16
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.6967716217041  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.705745697021484  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.251754760742188  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.773283004760742  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.735573768615723  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.740179538726807  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.799331665039062  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.762803554534912  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.745773792266846  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.579835891723633  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 15.985538959503174  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.031405448913574  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.075199604034424  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.093265056610107  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.06916046142578  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.07782793045044  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 0.5260505676269531  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4477897882461548
pure train time :  2.5542471408843994
train time :  5.815878629684448
end to end time :  110.27529907226562
connection check time:  48.85895919799805
block generation time  47.078603744506836
self.global_to_local() spend sec:  0.3295471668243408
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  16
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.05823849906649506]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  219141
orderedCounter spend  0.15453839302062988
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  872549
orderedCounter spend  0.91282057762146
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.8459689617156982
7.738763144566135
the split redundant ratio 
[7.738763144566135]
1
average memory estimation for each split fanout bucket batch 14.92130268811658
capacity est:  3.178697311883422
split fanout degree bucket spend /sec:  3.8465704917907715
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10863780975341797
split_batches_nid_list  16
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 15.723282322239426
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 15.72238245789163
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.274660239740012
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 15.720266382727733
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 15.715229910875308
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 15.713753825312146
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 15.710661663913138
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 15.709153426034229
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 15.650843755826436
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.50513726251695
the length of split_batches_nid_list  16
batches output list generation spend  0.0010602474212646484
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028577089309692383
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.9563329219818115
len local_batched_seeds_list  16
partition total batch output list spend :  8.440610647201538
self.buckets_partition() spend  sec:  3.984966516494751
layer  0
 the number of batches:  16
check_connections_block*********************************
layer  1
num of batch  16
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.74332094192505  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.700424194335938  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.292215824127197  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.659655570983887  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.738650798797607  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.754315853118896  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.75742483139038  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.771023750305176  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.783742904663086  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.62539768218994  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.060471534729004  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.08016300201416  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.049331665039062  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.008450508117676  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.086751461029053  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.045520782470703  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 0.5317625999450684  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3001980781555176
pure train time :  2.4784388542175293
train time :  5.864679336547852
end to end time :  88.71460342407227
connection check time:  43.77021503448486
block generation time  30.502249240875244
self.global_to_local() spend sec:  0.26634931564331055
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  16
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.05823849906649506]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  218929
orderedCounter spend  0.1553514003753662
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  872317
orderedCounter spend  0.9850170612335205
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.816864252090454
7.7395443146315275
the split redundant ratio 
[7.7395443146315275]
1
average memory estimation for each split fanout bucket batch 14.922808881648914
capacity est:  3.1771911183510877
split fanout degree bucket spend /sec:  3.820523262023926
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.22505927085876465
split_batches_nid_list  16
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 15.72478851577176
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 15.723888651423964
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.276166433272348
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 15.721772576260065
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 15.716736104407643
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 15.71526001884448
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 15.712167857445472
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 15.710659619566563
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 15.65234994935877
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.506643456049284
the length of split_batches_nid_list  16
batches output list generation spend  0.0011456012725830078
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026711702346801758
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.046848773956299
len local_batched_seeds_list  16
partition total batch output list spend :  6.650265455245972
self.buckets_partition() spend  sec:  4.073643207550049
layer  0
 the number of batches:  16
check_connections_block*********************************
layer  1
num of batch  16
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.682640552520752  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.674007892608643  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.281437397003174  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.771481037139893  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.735897541046143  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.734497547149658  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.802327156066895  GigaBytes
Max Memory Allocated: 17.0825138092041  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.81275987625122  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.689146518707275  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.613325595855713  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.01288414001465  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.11040496826172  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.002560138702393  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.081596851348877  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.08705186843872  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.061951160430908  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 0.5295186042785645  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1926229000091553
pure train time :  2.617255687713623
train time :  5.911262273788452
end to end time :  75.83061528205872
connection check time:  33.33318853378296
block generation time  29.853574752807617
self.global_to_local() spend sec:  0.3546772003173828
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  16
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.05823849906649506]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  218770
orderedCounter spend  0.15560054779052734
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  872387
orderedCounter spend  0.9123880863189697
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.894355297088623
7.735867720736798
the split redundant ratio 
[7.735867720736798]
1
average memory estimation for each split fanout bucket batch 14.91571994904564
capacity est:  3.184280050954362
split fanout degree bucket spend /sec:  3.8948912620544434
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10935187339782715
split_batches_nid_list  16
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 15.717699583168486
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 15.71679971882069
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.269077500669074
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 15.714683643656791
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 15.709647171804368
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 15.708171086241206
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 15.705078924842198
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 15.703570686963289
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 15.645261016755496
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.49955452344601
the length of split_batches_nid_list  16
batches output list generation spend  0.0010492801666259766
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026894569396972656
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.005363941192627
len local_batched_seeds_list  16
partition total batch output list spend :  8.510310888290405
self.buckets_partition() spend  sec:  4.032318115234375
layer  0
 the number of batches:  16
check_connections_block*********************************
layer  1
num of batch  16
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.69169044494629  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.706239223480225  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.279340744018555  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.73222255706787  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.73719549179077  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.71904754638672  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.76877737045288  GigaBytes
Max Memory Allocated: 17.088054180145264  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.813522338867188  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.77734088897705  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.57729959487915  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.069758892059326  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.017349243164062  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.03004264831543  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.027925491333008  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.05859899520874  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.03690195083618  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 0.5287051200866699  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.099392056465149
pure train time :  2.582836866378784
train time :  6.030315160751343
end to end time :  110.3927960395813
connection check time:  49.26988387107849
block generation time  46.46098470687866
self.global_to_local() spend sec:  0.35443782806396484
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  16
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.058309720152006146, 0.05823849906649506]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  218877
orderedCounter spend  0.14366626739501953
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  870150
orderedCounter spend  0.6056478023529053
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  3.295386552810669
7.7198961892910924
the split redundant ratio 
[7.7198961892910924]
1
average memory estimation for each split fanout bucket batch 14.884924839976888
capacity est:  3.2150751600231136
split fanout degree bucket spend /sec:  3.295989990234375
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.1156470775604248
split_batches_nid_list  16
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 15.686904474099734
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 15.686004609751938
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.238282391600322
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 15.68388853458804
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 15.678852062735617
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 15.677375977172455
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 15.674283815773446
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 15.672775577894537
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 15.614465907686744
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.468759414377258
the length of split_batches_nid_list  16
batches output list generation spend  0.0009138584136962891
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.03041815757751465
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  3.4126694202423096
len local_batched_seeds_list  16
partition total batch output list spend :  5.273428916931152
self.buckets_partition() spend  sec:  3.443147897720337
layer  0
 the number of batches:  16
check_connections_block*********************************
layer  1
num of batch  16
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.68132209777832  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.7689847946167  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.24410104751587  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.73936414718628  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.74477767944336  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.736387252807617  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.74675226211548  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.810497760772705  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.77696990966797  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.624825477600098  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.061342239379883  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.052865028381348  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.02196741104126  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.06721067428589  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.062705516815186  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

step  15
----------------------------------------after loss function
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 16.03415870666504  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.45703125 GB
    Memory Allocated: 0.5294895172119141  GigaBytes
Max Memory Allocated: 17.08967685699463  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.002779483795166
pure train time :  2.444648027420044
train time :  5.865603685379028
end to end time :  73.45877265930176
connection check time:  33.27851629257202
block generation time  28.933209896087646
end to end time  74.26361131668091
Total (block generation + training)time/epoch 74.26361131668091
