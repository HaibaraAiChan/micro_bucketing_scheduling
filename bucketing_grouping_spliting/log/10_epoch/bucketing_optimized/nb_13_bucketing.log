main start at this time 1688702805.24147
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

self.global_to_local() spend sec:  0.3224353790283203
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  258826
orderedCounter spend  0.1794276237487793
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  950974
orderedCounter spend  1.020998239517212
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.193081855773926
6.846907823041601
the split redundant ratio 
[6.846907823041601]
1
average memory estimation for each split fanout bucket batch 16.248238949294876
capacity est:  1.8517610507051252
split fanout degree bucket spend /sec:  4.193570613861084
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10750794410705566
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.050218583417724
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.049318719069927
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.60159650091831
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.04720264390603
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.042166172053605
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.040690086490443
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.037597925091436
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.036089687212524
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.977780017004733
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.832073523695247
the length of split_batches_nid_list  13
batches output list generation spend  0.0015506744384765625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023686885833740234
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.302699327468872
len local_batched_seeds_list  13
partition total batch output list spend :  7.973901033401489
self.buckets_partition() spend  sec:  4.326441526412964
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.623046875 GB
    Memory Allocated: 19.650373458862305  GigaBytes
Max Memory Allocated: 19.98743200302124  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.67578125 GB
    Memory Allocated: 19.642600536346436  GigaBytes
Max Memory Allocated: 19.98743200302124  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.67578125 GB
    Memory Allocated: 19.193434238433838  GigaBytes
Max Memory Allocated: 19.98743200302124  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.681640625 GB
    Memory Allocated: 19.71410083770752  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.712890625 GB
    Memory Allocated: 19.6856746673584  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.712890625 GB
    Memory Allocated: 19.69166898727417  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 19.707854747772217  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 19.679303646087646  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 19.64418363571167  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 19.48949098587036  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 18.982789993286133  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 18.98613929748535  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 18.97411823272705  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 0.5590362548828125  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.85070276260376
pure train time :  3.1717441082000732
train time :  7.021570444107056
end to end time :  106.67408895492554
connection check time:  45.99280285835266
block generation time  45.55496072769165
self.global_to_local() spend sec:  0.32584309577941895
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  258719
orderedCounter spend  0.1757817268371582
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  950395
orderedCounter spend  1.0363390445709229
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.181885719299316
6.840753516216978
the split redundant ratio 
[6.840753516216978]
1
average memory estimation for each split fanout bucket batch 16.23363430579183
capacity est:  1.8663656942081701
split fanout degree bucket spend /sec:  4.1823742389678955
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.1083216667175293
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.03561393991468
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.03471407556688
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.586991857415263
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.032598000402984
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.02756152855056
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.026085442987398
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.02299328158839
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.021485043709482
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.963175373501688
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.8174688801922
the length of split_batches_nid_list  13
batches output list generation spend  0.0010364055633544922
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.022690296173095703
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.291797399520874
len local_batched_seeds_list  13
partition total batch output list spend :  7.970565319061279
self.buckets_partition() spend  sec:  4.31453013420105
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.6015625 GB
    Memory Allocated: 19.66605281829834  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.619140625 GB
    Memory Allocated: 19.66390609741211  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.619140625 GB
    Memory Allocated: 19.222288131713867  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.659982681274414  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.55078887939453  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.679521560668945  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.670852184295654  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.677438259124756  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.682325839996338  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.509588718414307  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.015103340148926  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.085384845733643  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.01504611968994  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 0.5583004951477051  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.243335485458374
pure train time :  2.3466010093688965
train time :  5.559283971786499
end to end time :  105.35697388648987
connection check time:  46.27106189727783
block generation time  45.418219327926636
self.global_to_local() spend sec:  0.3365440368652344
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  259012
orderedCounter spend  0.18441438674926758
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  950776
orderedCounter spend  1.0184295177459717
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.185063123703003
6.845479637489251
the split redundant ratio 
[6.845479637489251]
1
average memory estimation for each split fanout bucket batch 16.24484975511872
capacity est:  1.8551502448812798
split fanout degree bucket spend /sec:  4.185634613037109
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10855269432067871
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.04682938924157
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.045929524893772
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.598207306742154
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.043813449729875
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.03877697787745
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.03730089231429
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.03420873091528
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.032700493036373
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.97439082282858
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.828684329519092
the length of split_batches_nid_list  13
batches output list generation spend  0.0009686946868896484
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025678634643554688
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.295229434967041
len local_batched_seeds_list  13
partition total batch output list spend :  8.022013187408447
self.buckets_partition() spend  sec:  4.320971965789795
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.634541034698486  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.656055450439453  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.218843936920166  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.63181781768799  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.67416763305664  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.64341640472412  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 19.71142292022705  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 19.667460441589355  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 19.667763233184814  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 19.49044370651245  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 19.0633487701416  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 18.906031608581543  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 18.9875545501709  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 0.5638341903686523  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5489401817321777
pure train time :  2.646965503692627
train time :  5.7724831104278564
end to end time :  105.28235721588135
connection check time:  46.14791297912598
block generation time  45.219154834747314
self.global_to_local() spend sec:  0.3319377899169922
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  258787
orderedCounter spend  0.17612409591674805
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  951343
orderedCounter spend  1.023305892944336
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.102596759796143
6.850233356549974
the split redundant ratio 
[6.850233356549974]
1
average memory estimation for each split fanout bucket batch 16.256130696120515
capacity est:  1.8438693038794867
split fanout degree bucket spend /sec:  4.10315728187561
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.20866608619689941
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.058110330243363
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.057210465895565
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.609488247743947
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.055094390731668
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.050057918879244
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.04858183331608
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.045489671917075
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.043981434038166
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.98567176383037
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.839965270520885
the length of split_batches_nid_list  13
batches output list generation spend  0.0010371208190917969
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026432514190673828
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.3129870891571045
len local_batched_seeds_list  13
partition total batch output list spend :  8.057904243469238
self.buckets_partition() spend  sec:  4.339465618133545
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.646484375 GB
    Memory Allocated: 19.63014841079712  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.6640625 GB
    Memory Allocated: 19.662143230438232  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.6640625 GB
    Memory Allocated: 19.20150089263916  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.618035793304443  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.615560054779053  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.67301654815674  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.665449142456055  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.70548963546753  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.62834119796753  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.53929090499878  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.04953956604004  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.00830602645874  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 18.98723840713501  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 0.5630979537963867  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.080272912979126
pure train time :  2.4206013679504395
train time :  5.653170347213745
end to end time :  104.46520590782166
connection check time:  45.69205570220947
block generation time  44.93983244895935
self.global_to_local() spend sec:  0.3580665588378906
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  258892
orderedCounter spend  0.17995810508728027
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  950827
orderedCounter spend  1.032707691192627
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.246325254440308
6.844555111576134
the split redundant ratio 
[6.844555111576134]
1
average memory estimation for each split fanout bucket batch 16.242655784009518
capacity est:  1.8573442159904836
split fanout degree bucket spend /sec:  4.246879816055298
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.1093292236328125
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.044635418132366
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.04373555378457
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.59601333563295
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.04161947862067
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.036583006768247
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.035106921205085
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.032014759806078
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.030506521927165
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.972196851719374
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.826490358409888
the length of split_batches_nid_list  13
batches output list generation spend  0.0010466575622558594
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.032494544982910156
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.357335805892944
len local_batched_seeds_list  13
partition total batch output list spend :  8.138889074325562
self.buckets_partition() spend  sec:  4.38988184928894
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.631829261779785  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.590420246124268  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.24872350692749  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.704145431518555  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.671968936920166  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.686232566833496  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.60709571838379  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.6640043258667  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.66093921661377  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.456022262573242  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.00502586364746  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 18.999534130096436  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.020554542541504  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 0.5593538284301758  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.660544514656067
pure train time :  2.4423704147338867
train time :  5.5316572189331055
end to end time :  104.78166246414185
connection check time:  46.02566456794739
block generation time  44.95917892456055
self.global_to_local() spend sec:  0.34348273277282715
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  259203
orderedCounter spend  0.18468403816223145
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  951435
orderedCounter spend  1.0225441455841064
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.070476293563843
6.849364026213759
the split redundant ratio 
[6.849364026213759]
1
average memory estimation for each split fanout bucket batch 16.254067708361113
capacity est:  1.8459322916388885
split fanout degree bucket spend /sec:  4.070964574813843
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.20929884910583496
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.05604734248396
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.055147478136163
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.607425259984545
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.053031402972266
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.04799493111984
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.04651884555668
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.043426684157673
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.041918446278764
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.98360877607097
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.837902282761483
the length of split_batches_nid_list  13
batches output list generation spend  0.0011324882507324219
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025809764862060547
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.281470537185669
len local_batched_seeds_list  13
partition total batch output list spend :  8.024785995483398
self.buckets_partition() spend  sec:  4.307343244552612
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.617915153503418  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.606234550476074  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.24617290496826  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.65229034423828  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.66779375076294  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.67040777206421  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.65961217880249  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.666632652282715  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.574509143829346  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.517566680908203  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 18.99610471725464  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.003172874450684  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.025033473968506  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 0.5585503578186035  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4519141912460327
pure train time :  2.3832035064697266
train time :  5.497983694076538
end to end time :  103.34905505180359
connection check time:  45.51287245750427
block generation time  44.1944420337677
self.global_to_local() spend sec:  0.3489878177642822
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  259144
orderedCounter spend  0.1796112060546875
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  952785
orderedCounter spend  1.0259175300598145
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.14482855796814
6.858402301931535
the split redundant ratio 
[6.858402301931535]
1
average memory estimation for each split fanout bucket batch 16.275516231891373
capacity est:  1.8244837681086281
split fanout degree bucket spend /sec:  4.145282506942749
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10900259017944336
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.07749586601422
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.076596001666424
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.628873783514805
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.074479926502526
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.069443454650102
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.06796736908694
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.064875207687933
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.063366969809024
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.00505729960123
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.859350806291744
the length of split_batches_nid_list  13
batches output list generation spend  0.0010042190551757812
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025833606719970703
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.255347967147827
len local_batched_seeds_list  13
partition total batch output list spend :  7.987098455429077
self.buckets_partition() spend  sec:  4.2812418937683105
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.66068458557129  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.610921382904053  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.170873641967773  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.568547248840332  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.66827154159546  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.626606464385986  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 19.749157905578613  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 19.715820789337158  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 19.664916515350342  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 19.520416736602783  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 18.972543716430664  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 18.998201370239258  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 18.985033988952637  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 0.5598611831665039  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3001590967178345
pure train time :  2.4209940433502197
train time :  5.653800964355469
end to end time :  103.44433617591858
connection check time:  45.642194747924805
block generation time  44.033005237579346
self.global_to_local() spend sec:  0.3247110843658447
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  258774
orderedCounter spend  0.18927955627441406
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  951921
orderedCounter spend  1.0792813301086426
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.1801066398620605
6.851896123304159
the split redundant ratio 
[6.851896123304159]
1
average memory estimation for each split fanout bucket batch 16.260076569533332
capacity est:  1.8399234304666692
split fanout degree bucket spend /sec:  4.180682182312012
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.26330041885375977
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.06205620365618
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.061156339308383
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.613434121156764
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.059040264144485
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.05400379229206
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.0525277067289
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.049435545329892
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.047927307450983
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.98961763724319
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.843911143933703
the length of split_batches_nid_list  13
batches output list generation spend  0.0011582374572753906
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027054548263549805
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.445268869400024
len local_batched_seeds_list  13
partition total batch output list spend :  8.174328565597534
self.buckets_partition() spend  sec:  4.472370862960815
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.765625 GB
    Memory Allocated: 19.5786190032959  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.783203125 GB
    Memory Allocated: 19.613301753997803  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.783203125 GB
    Memory Allocated: 19.235165119171143  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.618143558502197  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.628711223602295  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.66553258895874  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.7022123336792  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.71212673187256  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.631510257720947  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.564795970916748  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 18.94994831085205  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.027923107147217  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.03955841064453  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 0.5605716705322266  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1863338947296143
pure train time :  2.3988285064697266
train time :  5.495406866073608
end to end time :  104.24195170402527
connection check time:  45.72399306297302
block generation time  44.72138977050781
self.global_to_local() spend sec:  0.35609912872314453
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  258847
orderedCounter spend  0.18749570846557617
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  952323
orderedCounter spend  1.0748214721679688
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.316297769546509
6.852558470226988
the split redundant ratio 
[6.852558470226988]
1
average memory estimation for each split fanout bucket batch 16.26164836973097
capacity est:  1.838351630269031
split fanout degree bucket spend /sec:  4.316766977310181
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.11526942253112793
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.063628003853818
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.06272813950602
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.615005921354403
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.060612064342124
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.0555755924897
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.054099506926537
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.05100734552753
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.04949910764862
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.991189437440827
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.84548294413134
the length of split_batches_nid_list  13
batches output list generation spend  0.0010213851928710938
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026491165161132812
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.433128356933594
len local_batched_seeds_list  13
partition total batch output list spend :  8.27234411239624
self.buckets_partition() spend  sec:  4.459671258926392
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.619826316833496  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.651905059814453  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.180694580078125  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.627788066864014  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.619080066680908  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.713555812835693  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.69175958633423  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 19.71157455444336  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 19.67396593093872  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.603515625 GB
    Memory Allocated: 19.51038694381714  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.60546875 GB
    Memory Allocated: 18.996521949768066  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.60546875 GB
    Memory Allocated: 18.9703369140625  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.60546875 GB
    Memory Allocated: 19.001392364501953  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.60546875 GB
    Memory Allocated: 0.5613322257995605  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.097776174545288
pure train time :  2.4315216541290283
train time :  5.44112753868103
end to end time :  97.58305430412292
connection check time:  39.87105631828308
block generation time  43.853288888931274
self.global_to_local() spend sec:  0.33792710304260254
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  258776
orderedCounter spend  0.17681121826171875
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  950080
orderedCounter spend  1.021467924118042
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.083643674850464
6.838807872131168
the split redundant ratio 
[6.838807872131168]
1
average memory estimation for each split fanout bucket batch 16.22901714271127
capacity est:  1.8709828572887304
split fanout degree bucket spend /sec:  4.084075450897217
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.21124958992004395
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.03099677683412
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.03009691248632
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.582374694334703
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.027980837322424
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.02294436547
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.021468279906838
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.01837611850783
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.016867880628922
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.958558210421128
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.81285171711164
the length of split_batches_nid_list  13
batches output list generation spend  0.001436471939086914
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025155305862426758
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.297060251235962
len local_batched_seeds_list  13
partition total batch output list spend :  8.061463117599487
self.buckets_partition() spend  sec:  4.3222668170928955
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.607421875 GB
    Memory Allocated: 19.576755046844482  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.623046875 GB
    Memory Allocated: 19.650227069854736  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.623046875 GB
    Memory Allocated: 19.182599544525146  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.623292922973633  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.624213218688965  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.639667987823486  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.6969895362854  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.747517585754395  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.66719341278076  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.49089527130127  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 18.984107494354248  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.009682178497314  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 18.98119831085205  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 0.5606474876403809  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0073095560073853
pure train time :  2.4153504371643066
train time :  5.587531805038452
end to end time :  103.32730531692505
connection check time:  45.552164793014526
block generation time  44.00635385513306
end to end time  104.19492697715759
Total (block generation + training)time/epoch 104.19492697715759
