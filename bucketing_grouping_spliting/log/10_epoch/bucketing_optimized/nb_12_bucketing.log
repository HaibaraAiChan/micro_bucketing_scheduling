main start at this time 1688703883.442406
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

self.global_to_local() spend sec:  0.32173967361450195
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275830
orderedCounter spend  0.19370126724243164
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  981753
orderedCounter spend  1.0866475105285645
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.375354051589966
6.521662016060751
the split redundant ratio 
[6.521662016060751]
1
average memory estimation for each split fanout bucket batch 16.76610609962285
capacity est:  1.3338939003771522
split fanout degree bucket spend /sec:  4.375874996185303
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.11013507843017578
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.568085733745697
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.5671858693979
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.11946365124628
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.565069794234002
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.560033322381578
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.558557236818416
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.55546507541941
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.553956837540497
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.495647167332706
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.34994067402322
the length of split_batches_nid_list  12
batches output list generation spend  0.0016753673553466797
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.031835317611694336
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.48777961730957
len local_batched_seeds_list  12
partition total batch output list spend :  7.953207492828369
self.buckets_partition() spend  sec:  4.5196592807769775
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.85546875 GB
    Memory Allocated: 20.87930727005005  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.83203125 GB
    Memory Allocated: 20.86750030517578  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.83203125 GB
    Memory Allocated: 20.459396362304688  GigaBytes
Max Memory Allocated: 21.243483066558838  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.953125 GB
    Memory Allocated: 20.961812496185303  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.87109375 GB
    Memory Allocated: 20.89730930328369  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.8828125 GB
    Memory Allocated: 20.870521068572998  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.96028709411621  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.925491333007812  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.873311519622803  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.763845920562744  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.212109565734863  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 20.213406562805176  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.0234375 GB
    Memory Allocated: 0.5699458122253418  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.857676982879639
pure train time :  3.149238348007202
train time :  6.680910587310791
end to end time :  105.95652961730957
connection check time:  45.82739186286926
block generation time  45.36360549926758
self.global_to_local() spend sec:  0.32059741020202637
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275698
orderedCounter spend  0.1914348602294922
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  981409
orderedCounter spend  1.090914011001587
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.351746559143066
6.516802841375331
the split redundant ratio 
[6.516802841375331]
1
average memory estimation for each split fanout bucket batch 16.75361397136908
capacity est:  1.3463860286309206
split fanout degree bucket spend /sec:  4.352183818817139
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10803747177124023
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.55559360549193
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.55469374114413
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.106971522992513
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.552577665980234
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.54754119412781
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.546065108564648
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.54297294716564
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.54146470928673
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.483155039078937
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.33744854576945
the length of split_batches_nid_list  12
batches output list generation spend  0.0010845661163330078
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02541947364807129
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.461378574371338
len local_batched_seeds_list  12
partition total batch output list spend :  7.885650634765625
self.buckets_partition() spend  sec:  4.486843824386597
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.03125 GB
    Memory Allocated: 20.88991355895996  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.04296875 GB
    Memory Allocated: 20.889187335968018  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.04296875 GB
    Memory Allocated: 20.487768173217773  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.817050457000732  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.791764736175537  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.934958457946777  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.959117889404297  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.912869453430176  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.880499362945557  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.78062629699707  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.31846570968628  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.271262645721436  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 0.5745038986206055  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.2391610145568848
pure train time :  2.3266119956970215
train time :  5.420913457870483
end to end time :  101.68064188957214
connection check time:  43.3147873878479
block generation time  44.928303718566895
self.global_to_local() spend sec:  0.3325371742248535
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  276283
orderedCounter spend  0.2061445713043213
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  982303
orderedCounter spend  1.0739576816558838
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.371723651885986
6.525234751314382
the split redundant ratio 
[6.525234751314382]
1
average memory estimation for each split fanout bucket batch 16.77529100650406
capacity est:  1.3247089934959426
split fanout degree bucket spend /sec:  4.372199535369873
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.1083519458770752
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.577270640626907
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.57637077627911
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.12864855812749
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.574254701115212
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.569218229262788
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.567742143699626
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.56464998230062
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.563141744421706
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.504832074213915
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.35912558090443
the length of split_batches_nid_list  12
batches output list generation spend  0.0010085105895996094
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02902388572692871
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.481631755828857
len local_batched_seeds_list  12
partition total batch output list spend :  7.9552106857299805
self.buckets_partition() spend  sec:  4.510699033737183
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.830885887145996  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.88627576828003  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.47308921813965  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.885474681854248  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.886273860931396  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.93744945526123  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.923717498779297  GigaBytes
Max Memory Allocated: 21.328181743621826  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.969818592071533  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.833988666534424  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.794161796569824  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.157340049743652  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.219388484954834  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 0.5777478218078613  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.547273635864258
pure train time :  2.311495304107666
train time :  5.35118293762207
end to end time :  102.6169650554657
connection check time:  44.70588421821594
block generation time  44.47868275642395
self.global_to_local() spend sec:  0.3519914150238037
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275868
orderedCounter spend  0.19811153411865234
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  982382
orderedCounter spend  1.104539155960083
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.236139535903931
6.525935287638624
the split redundant ratio 
[6.525935287638624]
1
average memory estimation for each split fanout bucket batch 16.77709196863763
capacity est:  1.3229080313623705
split fanout degree bucket spend /sec:  4.236601114273071
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.20840787887573242
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.57907160276048
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.57817173841268
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.130449520261063
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.576055663248784
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.57101919139636
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.569543105833198
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.56645094443419
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.56494270655528
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.506633036347488
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.360926543038
the length of split_batches_nid_list  12
batches output list generation spend  0.0010716915130615234
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02722764015197754
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.446207046508789
len local_batched_seeds_list  12
partition total batch output list spend :  7.928524494171143
self.buckets_partition() spend  sec:  4.473483324050903
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.869750022888184  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.906763553619385  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.447404861450195  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.853790283203125  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.82582187652588  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.936280727386475  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.957692623138428  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.91869068145752  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.913366317749023  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.81868314743042  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.296515464782715  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.21473789215088  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 0.576045036315918  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.090529680252075
pure train time :  2.302410364151001
train time :  5.309277057647705
end to end time :  102.70156478881836
connection check time:  44.9055871963501
block generation time  44.43130326271057
self.global_to_local() spend sec:  0.3548569679260254
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275998
orderedCounter spend  0.20148587226867676
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  982116
orderedCounter spend  1.077315330505371
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.357476711273193
6.522521765185957
the split redundant ratio 
[6.522521765185957]
1
average memory estimation for each split fanout bucket batch 16.76831637133223
capacity est:  1.331683628667772
split fanout degree bucket spend /sec:  4.357921123504639
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10841083526611328
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.570296005455077
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.56939614110728
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.12167392295566
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.567280065943383
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.56224359409096
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.560767508527796
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.55767534712879
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.556167109249877
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.497857439042086
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.3521509457326
the length of split_batches_nid_list  12
batches output list generation spend  0.0010111331939697266
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028276681900024414
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.4674131870269775
len local_batched_seeds_list  12
partition total batch output list spend :  7.93444299697876
self.buckets_partition() spend  sec:  4.49573826789856
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.87788200378418  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.84088706970215  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.064453125 GB
    Memory Allocated: 20.48173236846924  GigaBytes
Max Memory Allocated: 21.33692502975464  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.984375 GB
    Memory Allocated: 20.998186111450195  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.955078125 GB
    Memory Allocated: 20.8947696685791  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.871445655822754  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.863461017608643  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.950387001037598  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.83047914505005  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.777570724487305  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.288795471191406  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.270976543426514  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 0.578216552734375  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.658360242843628
pure train time :  2.6447510719299316
train time :  5.585735559463501
end to end time :  101.70950722694397
connection check time:  44.683746337890625
block generation time  43.38428568840027
self.global_to_local() spend sec:  0.33884453773498535
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  276231
orderedCounter spend  0.19817566871643066
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  982194
orderedCounter spend  1.0913097858428955
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.1950600147247314
6.52361078074455
the split redundant ratio 
[6.52361078074455]
1
average memory estimation for each split fanout bucket batch 16.77111604883078
capacity est:  1.328883951169221
split fanout degree bucket spend /sec:  4.195505380630493
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.2089087963104248
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.57309568295363
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.57219581860583
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.124473600454213
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.570079743441934
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.56504327158951
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.563567186026347
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.56047502462734
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.558966786748428
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.500657116540637
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.35495062323115
the length of split_batches_nid_list  12
batches output list generation spend  0.0011556148529052734
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02886056900024414
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.405697345733643
len local_batched_seeds_list  12
partition total batch output list spend :  7.8744001388549805
self.buckets_partition() spend  sec:  4.434607982635498
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.966796875 GB
    Memory Allocated: 20.86618423461914  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.978515625 GB
    Memory Allocated: 20.81562328338623  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.978515625 GB
    Memory Allocated: 20.485912799835205  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.8858962059021  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.897313594818115  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.87066888809204  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.961467266082764  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.876830577850342  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.832877159118652  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.778599739074707  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.27328109741211  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.274209022521973  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 0.5738925933837891  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4476399421691895
pure train time :  2.2495715618133545
train time :  5.379380941390991
end to end time :  101.95860052108765
connection check time:  44.789926528930664
block generation time  43.77184247970581
self.global_to_local() spend sec:  0.24458718299865723
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  276236
orderedCounter spend  0.11176371574401855
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  983861
orderedCounter spend  0.6823441982269287
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  2.82840895652771
6.534481830794368
the split redundant ratio 
[6.534481830794368]
1
average memory estimation for each split fanout bucket batch 16.799063706667187
capacity est:  1.3009362933328141
split fanout degree bucket spend /sec:  2.828883409500122
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.033266305923461914
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.601043340790035
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.600143476442238
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.15242125829062
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.59802740127834
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.592990929425916
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.591514843862754
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.588422682463747
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.586914444584835
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.528604774377044
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.382898281067558
the length of split_batches_nid_list  12
batches output list generation spend  0.00078582763671875
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.023860931396484375
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  2.8629887104034424
len local_batched_seeds_list  12
partition total batch output list spend :  4.209877252578735
self.buckets_partition() spend  sec:  2.8868966102600098
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.889294147491455  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.88482666015625  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.998046875 GB
    Memory Allocated: 20.402989864349365  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.0 GB
    Memory Allocated: 20.850690364837646  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.0 GB
    Memory Allocated: 20.849075317382812  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.0 GB
    Memory Allocated: 20.865787982940674  GigaBytes
Max Memory Allocated: 21.36536979675293  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 21.017892837524414  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.967775344848633  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.967628955841064  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.73578643798828  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.26336431503296  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.24595308303833  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 0.5739350318908691  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.302002191543579
pure train time :  2.5796420574188232
train time :  5.564209699630737
end to end time :  97.33854007720947
connection check time:  42.903969049453735
block generation time  44.55271029472351
self.global_to_local() spend sec:  0.3381989002227783
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275729
orderedCounter spend  0.19680190086364746
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  982731
orderedCounter spend  1.1177139282226562
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.293599367141724
6.525941656150661
the split redundant ratio 
[6.525941656150661]
1
average memory estimation for each split fanout bucket batch 16.77710834102066
capacity est:  1.3228916589793407
split fanout degree bucket spend /sec:  4.294035196304321
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.11498570442199707
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.57908797514351
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.57818811079571
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.130465892644093
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.576072035631814
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.57103556377939
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.569559478216227
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.56646731681722
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.56495907893831
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.506649408730517
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.36094291542103
the length of split_batches_nid_list  12
batches output list generation spend  0.0010285377502441406
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027467966079711914
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.410119533538818
len local_batched_seeds_list  12
partition total batch output list spend :  8.02275800704956
self.buckets_partition() spend  sec:  4.437634229660034
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.00390625 GB
    Memory Allocated: 20.792885780334473  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.01953125 GB
    Memory Allocated: 20.85314702987671  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.01953125 GB
    Memory Allocated: 20.513665199279785  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.845357418060303  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.931341648101807  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.977127075195312  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.8929762840271  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.964092254638672  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.950093269348145  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.727797985076904  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.27521324157715  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.30099058151245  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 0.579261302947998  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.194218635559082
pure train time :  2.3238930702209473
train time :  5.307656526565552
end to end time :  102.22081637382507
connection check time:  44.76441264152527
block generation time  43.9991614818573
self.global_to_local() spend sec:  0.3430509567260742
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275904
orderedCounter spend  0.19722437858581543
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  982978
orderedCounter spend  1.1295228004455566
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.4312920570373535
6.525890708054353
the split redundant ratio 
[6.525890708054353]
1
average memory estimation for each split fanout bucket batch 16.7769773619564
capacity est:  1.3230226380436
split fanout degree bucket spend /sec:  4.431751489639282
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.21698808670043945
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.57895699607925
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.578057131731452
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.130334913579834
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.575941056567554
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.57090458471513
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.569428499151968
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.56633633775296
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.56482809987405
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.506518429666258
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.36081193635677
the length of split_batches_nid_list  12
batches output list generation spend  0.0010478496551513672
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.029421567916870117
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.649913311004639
len local_batched_seeds_list  12
partition total batch output list spend :  8.189452886581421
self.buckets_partition() spend  sec:  4.679386854171753
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.865506172180176  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.85741376876831  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.0390625 GB
    Memory Allocated: 20.467748641967773  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.876157760620117  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.839056491851807  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.978811264038086  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.972137928009033  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.966694831848145  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.871886730194092  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.72205352783203  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.233319759368896  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.24035406112671  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 0.5771632194519043  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0964686870574951
pure train time :  2.3046367168426514
train time :  5.357927083969116
end to end time :  101.38011407852173
connection check time:  44.32598352432251
block generation time  43.38212203979492
self.global_to_local() spend sec:  0.3323328495025635
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  12
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07774290205574576, 0.07771237873338387]
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  275937
orderedCounter spend  0.19289302825927734
one layer mini_batch_src_local collection stoped 
num of batch  1
check_connections_block*********************************
step start 0
len(mini_batch_src_global)  981448
orderedCounter spend  1.0713422298431396
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  4.320292949676514
6.5170703188809505
the split redundant ratio 
[6.5170703188809505]
1
average memory estimation for each split fanout bucket batch 16.754301611456444
capacity est:  1.345698388543557
split fanout degree bucket spend /sec:  4.320849418640137
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10843276977539062
split_batches_nid_list  12
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.556281245579292
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.555381381231495
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 17.107659163079877
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.553265306067598
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.548228834215173
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.54675274865201
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.543660587253004
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.542152349374092
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 17.4838426791663
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 17.338136185856815
the length of split_batches_nid_list  12
batches output list generation spend  0.0009698867797851562
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02483654022216797
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  4.430321455001831
len local_batched_seeds_list  12
partition total batch output list spend :  7.889521598815918
self.buckets_partition() spend  sec:  4.455200672149658
layer  0
 the number of batches:  12
check_connections_block*********************************
layer  1
num of batch  12
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.820992946624756  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.892221450805664  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.44477653503418  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.84020757675171  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.892187118530273  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.920042037963867  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.976149559020996  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.96395206451416  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.9428653717041  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.726227283477783  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.281135082244873  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 20.21934747695923  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.041015625 GB
    Memory Allocated: 0.5754356384277344  GigaBytes
Max Memory Allocated: 21.385276317596436  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0051754713058472
pure train time :  2.312363386154175
train time :  5.267889499664307
end to end time :  100.87825775146484
connection check time:  44.202598094940186
block generation time  43.38733768463135
end to end time  101.7404465675354
Total (block generation + training)time/epoch 101.7404465675354
