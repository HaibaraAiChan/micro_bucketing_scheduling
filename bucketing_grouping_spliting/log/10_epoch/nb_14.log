main start at this time 1688361912.013399
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

self.global_to_local() spend sec:  0.31740379333496094
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  14
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.06663749993640974, 0.06663749993640974, 0.06663749993640974, 0.06663749993640974, 0.06663749993640974, 0.06663749993640974, 0.06663749993640974, 0.06663749993640974, 0.06663749993640974, 0.06663749993640974, 0.06663749993640974, 0.06663749993640974, 0.06663749993640974, 0.06659680217326056]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
one layer mini_batch_src_local collection stoped 
num of batch  14
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  40.415942907333374
7.148169220027383
7.177531985967242
7.152292786600416
7.13483263984974
7.151267467344417
7.151824706070503
7.137180472348979
7.184434316321021
7.151208028546969
7.134364559319827
7.178371558981212
7.125099536767447
7.168051497774111
7.153600633112662
the split redundant ratio 
[7.148169220027383, 7.177531985967242, 7.152292786600416, 7.13483263984974, 7.151267467344417, 7.151824706070503, 7.137180472348979, 7.184434316321021, 7.151208028546969, 7.134364559319827, 7.178371558981212, 7.125099536767447, 7.168051497774111, 7.153600633112662]
14
average memory estimation for each split fanout bucket batch 15.763126924839977
capacity est:  2.2685858101068934
split fanout degree bucket spend /sec:  40.41680335998535
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10758829116821289
split_batches_nid_list  14
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 16.565106558962825
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 16.564206694615027
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.11648447646341
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 16.56209061945113
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 16.557054147598706
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 16.555578062035543
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 16.552485900636537
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 16.550977662757624
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.492667992549833
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.346961499240347
the length of split_batches_nid_list  14
batches output list generation spend  0.002825498580932617
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026593446731567383
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  40.52731680870056
len local_batched_seeds_list  14
partition total batch output list spend :  44.505449533462524
self.buckets_partition() spend  sec:  40.553977966308594
layer  0
 the number of batches:  14
check_connections_block*********************************
layer  1
num of batch  14
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 20.416015625 GB
    Memory Allocated: 18.5541934967041  GigaBytes
Max Memory Allocated: 18.867748737335205  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.43359375 GB
    Memory Allocated: 18.578852653503418  GigaBytes
Max Memory Allocated: 18.895604610443115  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.43359375 GB
    Memory Allocated: 18.10996150970459  GigaBytes
Max Memory Allocated: 18.895604610443115  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.455078125 GB
    Memory Allocated: 18.544251441955566  GigaBytes
Max Memory Allocated: 18.895604610443115  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.830078125 GB
    Memory Allocated: 18.591105461120605  GigaBytes
Max Memory Allocated: 18.906785488128662  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.83984375 GB
    Memory Allocated: 18.587921619415283  GigaBytes
Max Memory Allocated: 18.906785488128662  GigaBytes

