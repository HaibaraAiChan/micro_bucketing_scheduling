main start at this time 1688425696.807725
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

self.global_to_local() spend sec:  0.3270998001098633
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  15
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06213530988803028]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
num of batch  15
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  40.55571150779724
7.439619525696702
7.479978650261918
7.439882218223458
7.434731852623123
7.437716994972622
7.460419997588006
7.437892123323793
7.457801032700045
7.446330125698374
7.422528590698376
7.430950672313761
7.461200114788674
7.425298802798711
7.46074637315155
7.443853071163601
the split redundant ratio 
[7.439619525696702, 7.479978650261918, 7.439882218223458, 7.434731852623123, 7.437716994972622, 7.460419997588006, 7.437892123323793, 7.457801032700045, 7.446330125698374, 7.422528590698376, 7.430950672313761, 7.461200114788674, 7.425298802798711, 7.46074637315155, 7.443853071163601]
15
average memory estimation for each split fanout bucket batch 15.312424942240817
capacity est:  2.7161772426279907
split fanout degree bucket spend /sec:  40.55644869804382
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.11051630973815918
split_batches_nid_list  15
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 16.114404576363665
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 16.113504712015867
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.66578249386425
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 16.11138863685197
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 16.106352164999546
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 16.104876079436384
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 16.101783918037377
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 16.100275680158468
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.041966009950674
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.896259516641187
the length of split_batches_nid_list  15
batches output list generation spend  0.002496004104614258
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02387261390686035
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  40.669564723968506
len local_batched_seeds_list  15
partition total batch output list spend :  44.969831705093384
self.buckets_partition() spend  sec:  40.69357180595398
layer  0
 the number of batches:  15
check_connections_block*********************************
layer  1
num of batch  15
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 19.443359375 GB
    Memory Allocated: 17.581791400909424  GigaBytes
Max Memory Allocated: 17.874614238739014  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 20.390625 GB
    Memory Allocated: 17.57583236694336  GigaBytes
Max Memory Allocated: 17.874614238739014  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 20.390625 GB
    Memory Allocated: 17.130779266357422  GigaBytes
Max Memory Allocated: 17.874614238739014  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 20.412109375 GB
    Memory Allocated: 17.57193422317505  GigaBytes
Max Memory Allocated: 17.874614238739014  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 17.639742374420166  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 17.62327527999878  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 17.622475624084473  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 17.623799324035645  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 17.61250591278076  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 17.417141914367676  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 16.906456470489502  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 16.904105186462402  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 16.941370964050293  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 16.91430377960205  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 16.889575958251953  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 0.5319304466247559  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.858091354370117
pure train time :  3.0000598430633545
train time :  6.815116882324219
end to end time :  149.14663791656494
connection check time:  49.48772978782654
block generation time  47.74298906326294
self.global_to_local() spend sec:  0.3590407371520996
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  15
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06213530988803028]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
num of batch  15
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  41.051480531692505
7.433306944674964
7.476507924756901
7.455134305534495
7.428936696275299
7.42441520066326
7.461144392131484
7.438855329255231
7.473283971019443
7.443416626765265
7.417959332808745
7.430624296750215
7.457522419414092
7.434254229847205
7.47049783815991
7.440633918159411
the split redundant ratio 
[7.433306944674964, 7.476507924756901, 7.455134305534495, 7.428936696275299, 7.42441520066326, 7.461144392131484, 7.438855329255231, 7.473283971019443, 7.443416626765265, 7.417959332808745, 7.430624296750215, 7.457522419414092, 7.434254229847205, 7.47049783815991, 7.440633918159411]
15
average memory estimation for each split fanout bucket batch 15.313459209772272
capacity est:  2.7233153680833073
split fanout degree bucket spend /sec:  41.052375078201294
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10866212844848633
split_batches_nid_list  15
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 16.11543884389512
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 16.114538979547323
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.666816761395705
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 16.112422904383426
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 16.107386432531
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 16.10591034696784
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 16.102818185568832
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 16.10130994768992
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.04300027748213
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.897293784172643
the length of split_batches_nid_list  15
batches output list generation spend  0.0015578269958496094
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027074098587036133
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  41.16268348693848
len local_batched_seeds_list  15
partition total batch output list spend :  45.47706651687622
self.buckets_partition() spend  sec:  41.18981885910034
layer  0
 the number of batches:  15
check_connections_block*********************************
layer  1
num of batch  15
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 17.596715450286865  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 17.575809955596924  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.28515625 GB
    Memory Allocated: 17.172163009643555  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.618446826934814  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.547412395477295  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.54929494857788  GigaBytes
Max Memory Allocated: 17.935585021972656  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.654581546783447  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.58952808380127  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.580771923065186  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.458148956298828  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.91869878768921  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.92529296875  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.93944549560547  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.007383823394775  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.936796188354492  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 0.5387721061706543  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.245551824569702
pure train time :  2.5193631649017334
train time :  5.829312324523926
end to end time :  148.49402165412903
connection check time:  49.76309132575989
block generation time  47.284098863601685
self.global_to_local() spend sec:  0.267380952835083
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  15
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06213530988803028]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
num of batch  15
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  38.395188093185425
7.443464389042856
7.4712540742217834
7.457267687266935
7.441824550845532
7.427678956298711
7.453430784300381
7.4356552566565695
7.476834300320445
7.4378045591482085
7.440614573146536
7.434055220357239
7.4568855890462
7.4378602818054
7.476842260700043
7.456092227139931
the split redundant ratio 
[7.443464389042856, 7.4712540742217834, 7.457267687266935, 7.441824550845532, 7.427678956298711, 7.453430784300381, 7.4356552566565695, 7.476834300320445, 7.4378045591482085, 7.440614573146536, 7.434055220357239, 7.4568855890462, 7.4378602818054, 7.476842260700043, 7.456092227139931]
15
average memory estimation for each split fanout bucket batch 15.32183276138958
capacity est:  2.7226277504935776
split fanout degree bucket spend /sec:  38.39596509933472
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10847854614257812
split_batches_nid_list  15
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 16.123812395512427
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 16.12291253116463
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.675190313013012
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 16.120796456000733
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 16.11575998414831
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 16.114283898585146
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 16.11119173718614
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 16.10968349930723
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.051373829099436
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.90566733578995
the length of split_batches_nid_list  15
batches output list generation spend  0.0017406940460205078
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030315637588500977
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  38.50631642341614
len local_batched_seeds_list  15
partition total batch output list spend :  42.76590442657471
self.buckets_partition() spend  sec:  38.53669357299805
layer  0
 the number of batches:  15
check_connections_block*********************************
layer  1
num of batch  15
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.555415630340576  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.606321811676025  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.15727186203003  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.615346908569336  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.582358837127686  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.622174739837646  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.64965581893921  GigaBytes
Max Memory Allocated: 17.94985294342041  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.664918422698975  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.578879356384277  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.4912428855896  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.878056049346924  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.898398399353027  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.938734531402588  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.875965118408203  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.914766788482666  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 0.5393218994140625  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5481271743774414
pure train time :  2.426487445831299
train time :  5.772073984146118
end to end time :  134.91527318954468
connection check time:  48.03860592842102
block generation time  38.240965127944946
self.global_to_local() spend sec:  0.3633885383605957
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  15
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06213530988803028]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
num of batch  15
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  39.87645387649536
7.444499238390682
7.475910896287001
7.441243443134829
7.429175507663259
7.43713588726192
7.453534269235163
7.444180823206736
7.463803158917436
7.44992821727697
7.442564866148208
7.439595644557906
7.462561339700045
7.434214427949212
7.477200477781984
7.445701693680859
the split redundant ratio 
[7.444499238390682, 7.475910896287001, 7.441243443134829, 7.429175507663259, 7.43713588726192, 7.453534269235163, 7.444180823206736, 7.463803158917436, 7.44992821727697, 7.442564866148208, 7.439595644557906, 7.462561339700045, 7.434214427949212, 7.477200477781984, 7.445701693680859]
15
average memory estimation for each split fanout bucket batch 15.320966929525689
capacity est:  2.7218910173617203
split fanout degree bucket spend /sec:  39.87743830680847
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10889792442321777
split_batches_nid_list  15
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 16.122946563648537
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 16.12204669930074
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.674324481149121
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 16.119930624136842
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 16.114894152284418
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 16.113418066721255
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 16.11032590532225
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 16.10881766744334
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.050507997235545
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.904801503926059
the length of split_batches_nid_list  15
batches output list generation spend  0.0020575523376464844
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028662443161010742
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  39.988539695739746
len local_batched_seeds_list  15
partition total batch output list spend :  44.361268281936646
self.buckets_partition() spend  sec:  40.01728320121765
layer  0
 the number of batches:  15
check_connections_block*********************************
layer  1
num of batch  15
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.591707706451416  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.590797424316406  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.166817665100098  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.616113662719727  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.58665370941162  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.551655769348145  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.656723022460938  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.62311887741089  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.62688398361206  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.427054405212402  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.93182611465454  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.979472637176514  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.949604034423828  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.930774688720703  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 16.922796726226807  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 0.5356054306030273  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.0847322940826416
pure train time :  2.5617332458496094
train time :  5.882125616073608
end to end time :  144.28062319755554
connection check time:  47.96515607833862
block generation time  45.94247317314148
self.global_to_local() spend sec:  0.35872817039489746
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  15
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06213530988803028]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
num of batch  15
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  39.76094079017639
7.440335959860583
7.4668997465813165
7.435854266146536
7.436252285126468
7.417258819404062
7.454537277064595
7.413740331621454
7.455922383114761
7.456344283233491
7.434779614900716
7.42548189152948
7.461168273270279
7.4282361828706165
7.462545418940848
7.4359964254652535
the split redundant ratio 
[7.440335959860583, 7.4668997465813165, 7.435854266146536, 7.436252285126468, 7.417258819404062, 7.454537277064595, 7.413740331621454, 7.455922383114761, 7.456344283233491, 7.434779614900716, 7.42548189152948, 7.461168273270279, 7.4282361828706165, 7.462545418940848, 7.4359964254652535]
15
average memory estimation for each split fanout bucket batch 15.305076199818554
capacity est:  2.7430761878644265
split fanout degree bucket spend /sec:  39.761818408966064
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.11036324501037598
split_batches_nid_list  15
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 16.107055833941402
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 16.106155969593605
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.658433751441986
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 16.104039894429707
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 16.099003422577283
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 16.09752733701412
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 16.094435175615114
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 16.092926937736202
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.03461726752841
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.888910774218925
the length of split_batches_nid_list  15
batches output list generation spend  0.0018966197967529297
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02568221092224121
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  39.874202728271484
len local_batched_seeds_list  15
partition total batch output list spend :  44.203460454940796
self.buckets_partition() spend  sec:  39.89995765686035
layer  0
 the number of batches:  15
check_connections_block*********************************
layer  1
num of batch  15
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.59064817428589  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.565646171569824  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.18490219116211  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.2890625 GB
    Memory Allocated: 17.6155743598938  GigaBytes
Max Memory Allocated: 17.9596209526062  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 19.662109375 GB
    Memory Allocated: 17.667460918426514  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 19.669921875 GB
    Memory Allocated: 17.616936206817627  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 19.763671875 GB
    Memory Allocated: 17.622918128967285  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 19.763671875 GB
    Memory Allocated: 17.578850269317627  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 19.771484375 GB
    Memory Allocated: 17.55960178375244  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 19.771484375 GB
    Memory Allocated: 17.47514581680298  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 19.771484375 GB
    Memory Allocated: 16.869243621826172  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 19.771484375 GB
    Memory Allocated: 16.92943525314331  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 19.771484375 GB
    Memory Allocated: 16.92266845703125  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 19.771484375 GB
    Memory Allocated: 16.92857837677002  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 19.771484375 GB
    Memory Allocated: 16.925329208374023  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.771484375 GB
    Memory Allocated: 0.5379219055175781  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.659633755683899
pure train time :  2.7049033641815186
train time :  5.996173143386841
end to end time :  145.16916060447693
connection check time:  48.16672873497009
block generation time  46.67192554473877
self.global_to_local() spend sec:  0.3420727252960205
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  15
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06213530988803028]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
num of batch  15
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  39.398417949676514
7.446178878486
7.480145818233488
7.434867179076301
7.436443334236836
7.426890878718443
7.463381258798708
7.441824550845532
7.463349417280313
7.441665343253558
7.444300228900715
7.436053275636502
7.460499601383992
7.415404050957574
7.469725681338841
7.453478657374151
the split redundant ratio 
[7.446178878486, 7.480145818233488, 7.434867179076301, 7.436443334236836, 7.426890878718443, 7.463381258798708, 7.441824550845532, 7.463349417280313, 7.441665343253558, 7.444300228900715, 7.436053275636502, 7.460499601383992, 7.415404050957574, 7.469725681338841, 7.453478657374151]
15
average memory estimation for each split fanout bucket batch 15.317259206964318
capacity est:  2.7158334338331276
split fanout degree bucket spend /sec:  39.399253606796265
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.2097773551940918
split_batches_nid_list  15
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 16.119238841087164
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 16.118338976739366
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.670616758587752
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 16.11622290157547
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 16.11118642972305
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 16.109710344159883
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 16.106618182760876
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 16.105109944881967
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.046800274674176
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.901093781364688
the length of split_batches_nid_list  15
batches output list generation spend  0.0015132427215576172
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02723383903503418
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  39.61075687408447
len local_batched_seeds_list  15
partition total batch output list spend :  43.941155195236206
self.buckets_partition() spend  sec:  39.638049840927124
layer  0
 the number of batches:  15
check_connections_block*********************************
layer  1
num of batch  15
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 19.771484375 GB
    Memory Allocated: 17.572404861450195  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 19.7734375 GB
    Memory Allocated: 17.55394411087036  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 19.7734375 GB
    Memory Allocated: 17.173369884490967  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 17.600218296051025  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 17.597291469573975  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 17.60251235961914  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 17.597944736480713  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 17.62536907196045  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 17.572097301483154  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 17.42219877243042  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 16.874956607818604  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 16.916991233825684  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 16.976070880889893  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 16.923829078674316  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 16.94977903366089  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 0.5350823402404785  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4461495876312256
pure train time :  2.4778854846954346
train time :  5.860002279281616
end to end time :  143.605712890625
connection check time:  47.79960656166077
block generation time  45.88275218009949
self.global_to_local() spend sec:  0.3324408531188965
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  15
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06213530988803028]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
num of batch  15
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  39.27235984802246
7.450573008024461
7.482597615149877
7.4472774108706155
7.429780496512756
7.4365627399308165
7.4645036723221185
7.438401587618108
7.464957413959243
7.431101919526135
7.426039118101387
7.43987425784386
7.4548556922485405
7.433426350368944
7.470720728788673
7.461853236105351
the split redundant ratio 
[7.450573008024461, 7.482597615149877, 7.4472774108706155, 7.429780496512756, 7.4365627399308165, 7.4645036723221185, 7.438401587618108, 7.464957413959243, 7.431101919526135, 7.426039118101387, 7.43987425784386, 7.4548556922485405, 7.433426350368944, 7.470720728788673, 7.461853236105351]
15
average memory estimation for each split fanout bucket batch 15.319770683917296
capacity est:  2.7107909048417547
split fanout degree bucket spend /sec:  39.273133993148804
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10889172554016113
split_batches_nid_list  15
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 16.121750318040142
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 16.120850453692345
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.67312823554073
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 16.118734378528448
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 16.113697906676027
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 16.11222182111286
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 16.109129659713854
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 16.107621421834946
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.049311751627155
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.903605258317667
the length of split_batches_nid_list  15
batches output list generation spend  0.0014452934265136719
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.030126094818115234
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  39.383596420288086
len local_batched_seeds_list  15
partition total batch output list spend :  43.65629863739014
self.buckets_partition() spend  sec:  39.41379427909851
layer  0
 the number of batches:  15
check_connections_block*********************************
layer  1
num of batch  15
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 17.60389280319214  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 17.558614253997803  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 17.16384220123291  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 19.796875 GB
    Memory Allocated: 17.51261615753174  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 17.600993156433105  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 17.570932865142822  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 17.603301525115967  GigaBytes
Max Memory Allocated: 17.963185787200928  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 17.672311305999756  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 17.605626106262207  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 17.493159770965576  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 16.94732427597046  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 16.946226596832275  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 16.876973628997803  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 16.931751251220703  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 16.91761589050293  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 0.537379264831543  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.301452398300171
pure train time :  2.5842530727386475
train time :  5.741377592086792
end to end time :  143.04132843017578
connection check time:  47.770487546920776
block generation time  45.73165488243103
self.global_to_local() spend sec:  0.34248971939086914
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  15
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06213530988803028]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
num of batch  15
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  39.083935022354126
7.451424768641518
7.46883411882379
7.449187901974294
7.420944475158243
7.445167910276971
7.462887715263591
7.455182067812086
7.47388895986894
7.4467838673354985
7.440264316444194
7.432606431270282
7.459783167220113
7.423690806119781
7.483210564378973
7.440729536565475
the split redundant ratio 
[7.451424768641518, 7.46883411882379, 7.449187901974294, 7.420944475158243, 7.445167910276971, 7.462887715263591, 7.455182067812086, 7.47388895986894, 7.4467838673354985, 7.440264316444194, 7.432606431270282, 7.459783167220113, 7.423690806119781, 7.483210564378973, 7.440729536565475]
15
average memory estimation for each split fanout bucket batch 15.322795541469748
capacity est:  2.7095302725939128
split fanout degree bucket spend /sec:  39.086894273757935
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.21038103103637695
split_batches_nid_list  15
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 16.124775175592596
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 16.1238753112448
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.67615309309318
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 16.1217592360809
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 16.116722764228477
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 16.115246678665315
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 16.11215451726631
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 16.110646279387396
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.052336609179605
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.906630115870119
the length of split_batches_nid_list  15
batches output list generation spend  0.0017819404602050781
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02603292465209961
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  39.299261808395386
len local_batched_seeds_list  15
partition total batch output list spend :  43.606462478637695
self.buckets_partition() spend  sec:  39.32540464401245
layer  0
 the number of batches:  15
check_connections_block*********************************
layer  1
num of batch  15
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 17.531173706054688  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 17.557904720306396  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 20.72265625 GB
    Memory Allocated: 17.17266607284546  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.604175090789795  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.540587425231934  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.606200695037842  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.62940216064453  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.615747451782227  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.576852798461914  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.463168144226074  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.953118801116943  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.871203422546387  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.90648317337036  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.975603580474854  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.925703048706055  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 0.5333318710327148  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1869854927062988
pure train time :  2.507018566131592
train time :  5.774910926818848
end to end time :  143.32166051864624
connection check time:  48.15504431724548
block generation time  45.65954399108887
self.global_to_local() spend sec:  0.33802342414855957
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  15
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06213530988803028]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
num of batch  15
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  39.67258596420288
7.446258482281986
7.478816434840512
7.4449927819258
7.4338402901080745
7.4361567605712855
7.456614936139846
7.447229648593024
7.467512695810412
7.448375943255231
7.439619525696702
7.434214427949212
7.464607157256902
7.418150381919113
7.473419297472619
7.443614025148438
the split redundant ratio 
[7.446258482281986, 7.478816434840512, 7.4449927819258, 7.4338402901080745, 7.4361567605712855, 7.456614936139846, 7.447229648593024, 7.467512695810412, 7.448375943255231, 7.439619525696702, 7.434214427949212, 7.464607157256902, 7.418150381919113, 7.473419297472619, 7.443614025148438]
15
average memory estimation for each split fanout bucket batch 15.319893746843103
capacity est:  2.7185675323446805
split fanout degree bucket spend /sec:  39.67327094078064
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10899591445922852
split_batches_nid_list  15
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 16.12187338096595
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 16.120973516618154
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.673251298466536
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 16.118857441454256
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 16.113820969601832
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 16.11234488403867
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 16.109252722639663
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 16.10774448476075
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.04943481455296
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.903728321243474
the length of split_batches_nid_list  15
batches output list generation spend  0.0016162395477294922
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025458812713623047
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  39.78401279449463
len local_batched_seeds_list  15
partition total batch output list spend :  44.0864577293396
self.buckets_partition() spend  sec:  39.80953240394592
layer  0
 the number of batches:  15
check_connections_block*********************************
layer  1
num of batch  15
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.566000938415527  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.58672857284546  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.138737678527832  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.585803508758545  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.592971324920654  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.561326503753662  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.667943954467773  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.63284730911255  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.611411571502686  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.469887256622314  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.905908584594727  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.899291038513184  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.91017436981201  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.909240245819092  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.907110691070557  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 0.5319066047668457  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.101770281791687
pure train time :  2.5413691997528076
train time :  5.96143651008606
end to end time :  143.9425585269928
connection check time:  48.118468284606934
block generation time  45.638028621673584
self.global_to_local() spend sec:  0.33197617530822754
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  15
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06219635653275407, 0.06213530988803028]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
num of batch  15
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
step start 13
step start 14
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  39.12768292427063
7.430751662823794
7.490589836266933
7.455572126412419
7.4188429349441956
7.43511395084386
7.443926091059579
7.417919530910752
7.4660718671030555
7.440463325934162
7.430106872076302
7.4295655662635935
7.4624419340060655
7.426771473024463
7.465228066865596
7.442833141498906
the split redundant ratio 
[7.430751662823794, 7.490589836266933, 7.455572126412419, 7.4188429349441956, 7.43511395084386, 7.443926091059579, 7.417919530910752, 7.4660718671030555, 7.440463325934162, 7.430106872076302, 7.4295655662635935, 7.4624419340060655, 7.426771473024463, 7.465228066865596, 7.442833141498906]
15
average memory estimation for each split fanout bucket batch 15.309305422329063
capacity est:  2.6943535700776753
split fanout degree bucket spend /sec:  39.128644943237305
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10941529273986816
split_batches_nid_list  15
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 16.11128505645191
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 16.11038519210411
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 15.662662973952497
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 16.108269116940214
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 16.103232645087793
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 16.101756559524627
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 16.09866439812562
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 16.097156160246712
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.03884649003892
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 15.893139996729433
the length of split_batches_nid_list  15
batches output list generation spend  0.0014846324920654297
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0296630859375
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  39.23963928222656
len local_batched_seeds_list  15
partition total batch output list spend :  43.5246217250824
self.buckets_partition() spend  sec:  39.269357204437256
layer  0
 the number of batches:  15
check_connections_block*********************************
layer  1
num of batch  15
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.55880355834961  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.593412399291992  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.129989624023438  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.6009202003479  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.526814460754395  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.600209712982178  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.606996059417725  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.637528896331787  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.634799480438232  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 17.466800689697266  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.95788335800171  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.89527654647827  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.897963523864746  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  13
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.933051586151123  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

step  14
----------------------------------------after loss function
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 16.91321325302124  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 20.724609375 GB
    Memory Allocated: 0.530329704284668  GigaBytes
Max Memory Allocated: 17.96762990951538  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.008060336112976
pure train time :  2.574276924133301
train time :  5.769237756729126
end to end time :  143.48903369903564
connection check time:  47.7356812953949
block generation time  46.314704179763794
end to end time  144.34303951263428
Total (block generation + training)time/epoch 144.34303951263428
