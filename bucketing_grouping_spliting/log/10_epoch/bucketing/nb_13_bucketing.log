main start at this time 1688427175.9696074
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

self.global_to_local() spend sec:  0.31637048721313477
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
num of batch  13
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  39.13001871109009
6.846907823041601
6.855801210370007
6.851654642655212
6.814439024928738
6.870158959811756
6.828279315837026
6.860140962603962
6.840926002394799
6.829590210788458
6.856311769456355
6.83040434554777
6.858326408013295
6.85133036864091
the split redundant ratio 
[6.846907823041601, 6.855801210370007, 6.851654642655212, 6.814439024928738, 6.870158959811756, 6.828279315837026, 6.860140962603962, 6.840926002394799, 6.829590210788458, 6.856311769456355, 6.83040434554777, 6.858326408013295, 6.85133036864091]
13
average memory estimation for each split fanout bucket batch 16.24540391544481
capacity est:  1.7965843146005618
split fanout degree bucket spend /sec:  39.130834102630615
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10766315460205078
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.04738354956766
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.04648368521986
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.598761467068243
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.044367610055964
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.03933113820354
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.037855052640378
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.03476289124137
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.033254653362462
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.974944983154668
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.82923848984518
the length of split_batches_nid_list  13
batches output list generation spend  0.002561330795288086
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026860952377319336
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  39.24116349220276
len local_batched_seeds_list  13
partition total batch output list spend :  42.939732789993286
self.buckets_partition() spend  sec:  39.268089294433594
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.623046875 GB
    Memory Allocated: 19.650373458862305  GigaBytes
Max Memory Allocated: 19.98743200302124  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.67578125 GB
    Memory Allocated: 19.642600536346436  GigaBytes
Max Memory Allocated: 19.98743200302124  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.67578125 GB
    Memory Allocated: 19.193434238433838  GigaBytes
Max Memory Allocated: 19.98743200302124  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.681640625 GB
    Memory Allocated: 19.71410083770752  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.712890625 GB
    Memory Allocated: 19.6856746673584  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.712890625 GB
    Memory Allocated: 19.69166898727417  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 19.707854747772217  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 19.679303646087646  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 19.64418363571167  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 19.48949098587036  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 18.982789993286133  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 18.98613929748535  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 18.97411823272705  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.595703125 GB
    Memory Allocated: 0.5590362548828125  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.85070276260376
pure train time :  3.195141077041626
train time :  6.912203550338745
end to end time :  143.52813959121704
connection check time:  46.99570679664612
block generation time  46.55248427391052
self.global_to_local() spend sec:  0.35508179664611816
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
num of batch  13
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  39.50194263458252
6.840753516216978
6.862790350295279
6.844499915999231
6.815977601634893
6.86859278531715
6.8307976140332
6.874133041348732
6.841560751529176
6.823284116127354
6.845707319243972
6.830632027302493
6.86613658214499
6.8496331046511605
the split redundant ratio 
[6.840753516216978, 6.862790350295279, 6.844499915999231, 6.815977601634893, 6.86859278531715, 6.8307976140332, 6.874133041348732, 6.841560751529176, 6.823284116127354, 6.845707319243972, 6.830632027302493, 6.86613658214499, 6.8496331046511605]
13
average memory estimation for each split fanout bucket batch 16.245445477469268
capacity est:  1.78715351341474
split fanout degree bucket spend /sec:  39.50274991989136
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10867571830749512
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.047425111592116
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.04652524724432
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.5988030290927
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.04440917208042
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.039372700227997
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.037896614664835
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.034804453265828
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.03329621538692
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.974986545179124
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.829280051869638
the length of split_batches_nid_list  13
batches output list generation spend  0.0017321109771728516
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027102947235107422
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  39.61325001716614
len local_batched_seeds_list  13
partition total batch output list spend :  43.38857340812683
self.buckets_partition() spend  sec:  39.640427350997925
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.6015625 GB
    Memory Allocated: 19.66605281829834  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.619140625 GB
    Memory Allocated: 19.66390609741211  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.619140625 GB
    Memory Allocated: 19.222288131713867  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.659982681274414  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.55078887939453  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.679521560668945  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.670852184295654  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.677438259124756  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.682325839996338  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.509588718414307  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.015103340148926  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.085384845733643  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.01504611968994  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 0.5583004951477051  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.243335485458374
pure train time :  2.4569852352142334
train time :  5.564646005630493
end to end time :  142.42582988739014
connection check time:  47.377524852752686
block generation time  45.96743655204773
self.global_to_local() spend sec:  0.3431680202484131
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
num of batch  13
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  37.951844692230225
6.845479637489251
6.8573535859703885
6.8520686094819805
6.822532076392059
6.863811468467975
6.832908844849717
6.8700140714223865
6.83620678056964
6.843002735975753
6.849170841694601
6.8333297111236
6.867840745581853
6.862714456377039
the split redundant ratio 
[6.845479637489251, 6.8573535859703885, 6.8520686094819805, 6.822532076392059, 6.863811468467975, 6.832908844849717, 6.8700140714223865, 6.83620678056964, 6.843002735975753, 6.849170841694601, 6.8333297111236, 6.867840745581853, 6.862714456377039]
13
average memory estimation for each split fanout bucket batch 16.25310044670103
capacity est:  1.7969281458937978
split fanout degree bucket spend /sec:  37.95299053192139
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10862374305725098
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.055080080823878
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.05418021647608
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.606457998324462
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.052064141312183
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.04702766945976
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.045551583896597
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.04245942249759
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.040951184618677
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.982641514410886
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.8369350211014
the length of split_batches_nid_list  13
batches output list generation spend  0.0014901161193847656
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025090694427490234
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  38.06320309638977
len local_batched_seeds_list  13
partition total batch output list spend :  41.80196261405945
self.buckets_partition() spend  sec:  38.088353872299194
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.634541034698486  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.656055450439453  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.218843936920166  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.63181781768799  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.67416763305664  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 22.63671875 GB
    Memory Allocated: 19.64341640472412  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 19.71142292022705  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 19.667460441589355  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 19.667763233184814  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 19.49044370651245  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 19.0633487701416  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 18.906031608581543  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 18.9875545501709  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.640625 GB
    Memory Allocated: 0.5638341903686523  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5489401817321777
pure train time :  2.647073984146118
train time :  5.868442535400391
end to end time :  140.0980589389801
connection check time:  46.339539766311646
block generation time  45.96643352508545
self.global_to_local() spend sec:  0.3480336666107178
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
num of batch  13
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  38.41979742050171
6.850233356549974
6.855345846860563
6.8493916240022115
6.821731740526973
6.86308702652113
6.827837751221806
6.863404401088319
6.844458519316555
6.840187761553728
6.849177741141714
6.841091589125506
6.868206416278832
6.857270792605036
the split redundant ratio 
[6.850233356549974, 6.855345846860563, 6.8493916240022115, 6.821731740526973, 6.86308702652113, 6.827837751221806, 6.863404401088319, 6.844458519316555, 6.840187761553728, 6.849177741141714, 6.841091589125506, 6.868206416278832, 6.857270792605036]
13
average memory estimation for each split fanout bucket batch 16.252186082162982
capacity est:  1.8012178505998513
split fanout degree bucket spend /sec:  38.420602798461914
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10889458656311035
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.05416571628583
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.053265851938033
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.605543633786414
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.051149776774135
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.04611330492171
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.04463721935855
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.041545057959542
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.04003682008063
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.98172714987284
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.836020656563353
the length of split_batches_nid_list  13
batches output list generation spend  0.0014019012451171875
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025571823120117188
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  38.53099489212036
len local_batched_seeds_list  13
partition total batch output list spend :  42.28012752532959
self.buckets_partition() spend  sec:  38.55662775039673
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.646484375 GB
    Memory Allocated: 19.63014841079712  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.6640625 GB
    Memory Allocated: 19.662143230438232  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.6640625 GB
    Memory Allocated: 19.20150089263916  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.618035793304443  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.615560054779053  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.67301654815674  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.665449142456055  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.70548963546753  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.62834119796753  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.53929090499878  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.04953956604004  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.00830602645874  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 18.98723840713501  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 0.5630979537963867  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.080272912979126
pure train time :  2.3911986351013184
train time :  5.507505178451538
end to end time :  139.75385999679565
connection check time:  46.01748991012573
block generation time  45.820812940597534
self.global_to_local() spend sec:  0.3332362174987793
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
num of batch  13
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  38.0719838142395
6.844555111576134
6.8490052549638945
6.847266594291467
6.808650388801093
6.858043530681669
6.812665867020747
6.8555114335912695
6.8481773213103585
6.834302533166505
6.839497816842447
6.836179182781188
6.862604065223233
6.847715058353799
the split redundant ratio 
[6.844555111576134, 6.8490052549638945, 6.847266594291467, 6.808650388801093, 6.858043530681669, 6.812665867020747, 6.8555114335912695, 6.8481773213103585, 6.834302533166505, 6.839497816842447, 6.836179182781188, 6.862604065223233, 6.847715058353799]
13
average memory estimation for each split fanout bucket batch 16.23625901060904
capacity est:  1.8145126606048656
split fanout degree bucket spend /sec:  38.0727744102478
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10932517051696777
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.038238644731887
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.03733878038409
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.58961656223247
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.035222705220193
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.03018623336777
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.028710147804606
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.0256179864056
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.02410974852669
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.965800078318896
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.82009358500941
the length of split_batches_nid_list  13
batches output list generation spend  0.0016994476318359375
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.028734922409057617
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  38.18390727043152
len local_batched_seeds_list  13
partition total batch output list spend :  41.92481184005737
self.buckets_partition() spend  sec:  38.21270489692688
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.631829261779785  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.590420246124268  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.24872350692749  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.704145431518555  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.671968936920166  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.686232566833496  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.60709571838379  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.6640043258667  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.66093921661377  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.456022262573242  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.00502586364746  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 18.999534130096436  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.020554542541504  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 0.5593538284301758  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.660544514656067
pure train time :  2.381146192550659
train time :  5.518529891967773
end to end time :  139.22627878189087
connection check time:  46.187827825546265
block generation time  45.493289947509766
self.global_to_local() spend sec:  0.2453758716583252
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
num of batch  13
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  26.68820071220398
6.849364026213759
6.851523553160068
6.850785312318998
6.819586012474891
6.866550548971758
6.837103708694305
6.856801630201363
6.842057511721299
6.846756035205119
6.847970337896974
6.83023185936995
6.859181939455282
6.85615308217276
the split redundant ratio 
[6.849364026213759, 6.851523553160068, 6.850785312318998, 6.819586012474891, 6.866550548971758, 6.837103708694305, 6.856801630201363, 6.842057511721299, 6.846756035205119, 6.847970337896974, 6.83023185936995, 6.859181939455282, 6.85615308217276]
13
average memory estimation for each split fanout bucket batch 16.249017292661975
capacity est:  1.805147351093943
split fanout degree bucket spend /sec:  26.688859224319458
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.04177570343017578
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.050996926784823
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.050097062437025
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.602374844285407
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.047980987273128
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.042944515420704
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.04146842985754
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.038376268458535
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.036868030579626
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.97855836037183
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.832851867062345
the length of split_batches_nid_list  13
batches output list generation spend  0.0013072490692138672
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.025519371032714844
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  26.732035875320435
len local_batched_seeds_list  13
partition total batch output list spend :  28.209766387939453
self.buckets_partition() spend  sec:  26.757638931274414
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.617915153503418  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.606234550476074  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.24617290496826  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.65229034423828  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.66779375076294  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.67040777206421  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.65961217880249  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.666632652282715  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.574509143829346  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.517566680908203  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 18.99610471725464  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.003172874450684  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.025033473968506  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 0.5585503578186035  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.4519141912460327
pure train time :  2.406484365463257
train time :  5.595837593078613
end to end time :  125.36967372894287
connection check time:  46.337435722351074
block generation time  45.12626576423645
self.global_to_local() spend sec:  0.34171056747436523
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
num of batch  13
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  37.91812324523926
6.858402301931535
6.858912861017883
6.852461877967409
6.821393667618446
6.870676418345215
6.831846329994346
6.8643082286600965
6.828010237399627
6.833729879056142
6.846376565613916
6.834364628190519
6.866288369981472
6.868634181999826
the split redundant ratio 
[6.858402301931535, 6.858912861017883, 6.852461877967409, 6.821393667618446, 6.870676418345215, 6.831846329994346, 6.8643082286600965, 6.828010237399627, 6.833729879056142, 6.846376565613916, 6.834364628190519, 6.866288369981472, 6.868634181999826]
13
average memory estimation for each split fanout bucket batch 16.25291278786333
capacity est:  1.7953563456961632
split fanout degree bucket spend /sec:  37.91875886917114
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.2102804183959961
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.054892421986178
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.05399255763838
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.606270339486763
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.051876482474484
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.04684001062206
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.045363925058897
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.04227176365989
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.04076352578098
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.982453855573187
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.8367473622637
the length of split_batches_nid_list  13
batches output list generation spend  0.001482248306274414
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02618122100830078
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  38.13067412376404
len local_batched_seeds_list  13
partition total batch output list spend :  41.89402651786804
self.buckets_partition() spend  sec:  38.15692377090454
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.66068458557129  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.610921382904053  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.170873641967773  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.568547248840332  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.66827154159546  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.6796875 GB
    Memory Allocated: 19.626606464385986  GigaBytes
Max Memory Allocated: 20.053534507751465  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 19.749157905578613  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 19.715820789337158  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 19.664916515350342  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 19.520416736602783  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 18.972543716430664  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 18.998201370239258  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 18.985033988952637  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.76171875 GB
    Memory Allocated: 0.5598611831665039  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3001590967178345
pure train time :  2.4785995483398438
train time :  5.685908555984497
end to end time :  138.65087175369263
connection check time:  45.885501861572266
block generation time  45.057854890823364
self.global_to_local() spend sec:  0.3444981575012207
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
num of batch  13
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  37.73741173744202
6.851896123304159
6.855946098759377
6.850412742174907
6.8324534813402735
6.874636700987967
6.842485277442292
6.8746229020937415
6.840988097418813
6.8391666433810325
6.841588349317629
6.841809131625237
6.875616422477986
6.853034532077772
the split redundant ratio 
[6.851896123304159, 6.855946098759377, 6.850412742174907, 6.8324534813402735, 6.874636700987967, 6.842485277442292, 6.8746229020937415, 6.840988097418813, 6.8391666433810325, 6.841588349317629, 6.841809131625237, 6.875616422477986, 6.853034532077772]
13
average memory estimation for each split fanout bucket batch 16.26007782898862
capacity est:  1.78363333588878
split fanout degree bucket spend /sec:  37.73830032348633
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10923266410827637
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.06205746311147
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.06115759876367
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.613435380612053
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.059041523599774
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.05400505174735
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.052528966184187
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.04943680478518
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.047928566906272
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.989618896698477
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.84391240338899
the length of split_batches_nid_list  13
batches output list generation spend  0.0014901161193847656
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026069164276123047
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  37.84913754463196
len local_batched_seeds_list  13
partition total batch output list spend :  41.605998516082764
self.buckets_partition() spend  sec:  37.87526297569275
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.765625 GB
    Memory Allocated: 19.5786190032959  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.783203125 GB
    Memory Allocated: 19.613301753997803  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.783203125 GB
    Memory Allocated: 19.235165119171143  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.618143558502197  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.628711223602295  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.66553258895874  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.7022123336792  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.71212673187256  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.631510257720947  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.564795970916748  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 18.94994831085205  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.027923107147217  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.03955841064453  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 0.5605716705322266  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1863338947296143
pure train time :  2.4394428730010986
train time :  5.5617516040802
end to end time :  138.2077648639679
connection check time:  45.94958734512329
block generation time  44.95879578590393
self.global_to_local() spend sec:  0.32801032066345215
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
num of batch  13
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  37.43145966529846
6.852558470226988
6.863114624309581
6.854034951909129
6.824098250886665
6.855359645754787
6.841678042130094
6.872918738656878
6.843423602249633
6.843740976816823
6.8470734097723085
6.831577251556947
6.861624343733215
6.857174200345455
the split redundant ratio 
[6.852558470226988, 6.863114624309581, 6.854034951909129, 6.824098250886665, 6.855359645754787, 6.841678042130094, 6.872918738656878, 6.843423602249633, 6.843740976816823, 6.8470734097723085, 6.831577251556947, 6.861624343733215, 6.857174200345455]
13
average memory estimation for each split fanout bucket batch 16.25528056380208
capacity est:  1.7900351471104088
split fanout degree bucket spend /sec:  37.432106494903564
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.10928630828857422
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.05726019792493
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.056360333577132
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.608638115425514
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.054244258413235
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.04920778656081
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.047731700997648
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.04463953959864
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.043131301719733
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.984821631511938
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.83911513820245
the length of split_batches_nid_list  13
batches output list generation spend  0.0015947818756103516
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.026165485382080078
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  37.543081521987915
len local_batched_seeds_list  13
partition total batch output list spend :  41.2890350818634
self.buckets_partition() spend  sec:  37.5692982673645
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.619826316833496  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.651905059814453  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.180694580078125  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.627788066864014  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.619080066680908  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.713555812835693  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 21.802734375 GB
    Memory Allocated: 19.69175958633423  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 19.71157455444336  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 19.67396593093872  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.603515625 GB
    Memory Allocated: 19.51038694381714  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.60546875 GB
    Memory Allocated: 18.996521949768066  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.60546875 GB
    Memory Allocated: 18.9703369140625  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.60546875 GB
    Memory Allocated: 19.001392364501953  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.60546875 GB
    Memory Allocated: 0.5613322257995605  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.097776174545288
pure train time :  2.4172961711883545
train time :  5.6329450607299805
end to end time :  137.52751421928406
connection check time:  45.872910499572754
block generation time  44.60798692703247
self.global_to_local() spend sec:  0.33229541778564453
len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  13
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144, 0.0717603308728144]
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
num of batch  13
check_connections_block*********************************
step start 0
step start 1
step start 2
step start 3
step start 4
step start 5
step start 6
step start 7
step start 8
step start 9
step start 10
step start 11
step start 12
one layer mini_batch_src_local collection stoped 
generate_K_hop_neighbors time  37.79597616195679
6.838807872131168
6.8692137355573015
6.846369666166802
6.814894388438182
6.861838226593712
6.823015037689955
6.861175879670884
6.842423182418277
6.824243139276034
6.8570914069801026
6.8272512982172175
6.860665320584536
6.851537352054295
the split redundant ratio 
[6.838807872131168, 6.8692137355573015, 6.846369666166802, 6.814894388438182, 6.861838226593712, 6.823015037689955, 6.861175879670884, 6.842423182418277, 6.824243139276034, 6.8570914069801026, 6.8272512982172175, 6.860665320584536, 6.851537352054295]
13
average memory estimation for each split fanout bucket batch 16.242529838480863
capacity est:  1.7988274044659427
split fanout degree bucket spend /sec:  37.796666622161865
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  800
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [8, 13, 18]
original bucket_id :,  [15, 10, 5]
remove weights:  [388 280 132], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]

remove bucket_id:  [3, 13, 16]
original bucket_id :,  [20, 8, 4]
remove weights:  [494 211  95], 		------------sum 800

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 383, 362, 331, 281, 253, 211, 181, 165, 95, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]

remove bucket_id:  [11, 15, 16]
original bucket_id :,  [9, 1, 2]
remove weights:  [253  53  46], 		------------sum 352

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 253, 181, 165, 72, 53, 46, 31]
after remove pre pack weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]

remove bucket_id:  [2, 11, 13]
original bucket_id :,  [21, 7, 3]
remove weights:  [545 181  72], 		------------sum 798

before remove weights,  [595, 583, 545, 455, 448, 427, 410, 383, 362, 331, 281, 181, 165, 72, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]

remove bucket_id:  [5, 6]
original bucket_id :,  [16, 14]
remove weights:  [410 383], 		------------sum 793

before remove weights,  [595, 583, 455, 448, 427, 410, 383, 362, 331, 281, 165, 31]
after remove pre pack weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]

remove bucket_id:  [0, 8, 9]
original bucket_id :,  [23, 6, 0]
remove weights:  [595 165  31], 		------------sum 791

before remove weights,  [595, 583, 455, 448, 427, 362, 331, 281, 165, 31]
after remove pre pack weights,  [583, 455, 448, 427, 362, 331, 281]

remove bucket_id:  [3, 4]
original bucket_id :,  [17, 13]
remove weights:  [427 362], 		------------sum 789

before remove weights,  [583, 455, 448, 427, 362, 331, 281]
after remove pre pack weights,  [583, 455, 448, 331, 281]

remove bucket_id:  [1, 3]
original bucket_id :,  [18, 12]
remove weights:  [455 331], 		------------sum 786

before remove weights,  [583, 455, 448, 331, 281]
after remove pre pack weights,  [583, 448, 281]

remove bucket_id:  [1, 2]
original bucket_id :,  [19, 11]
remove weights:  [448 281], 		------------sum 729

before remove weights,  [583, 448, 281]
after remove pre pack weights,  [583]
the last batch value is  583
G_BUCKET_ID_list [[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
[[15, 10, 5], [20, 8, 4], [9, 1, 2], [21, 7, 3], [16, 14], [23, 6, 0], [17, 13], [18, 12], [19, 11], [22]]
G_BUCKET_ID_list length 10
backpack scheduling spend  0.2307732105255127
split_batches_nid_list  13
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[15, 10, 5]
current group_mem  0.8019796341228467
the new estimated memory cost(GB) for batch 0 17.04450947260371
[20, 8, 4]
current group_mem  0.8010797697750498
the new estimated memory cost(GB) for batch 1 17.043609608255913
[9, 1, 2]
current group_mem  0.3533575516234331
the new estimated memory cost(GB) for batch 2 16.595887390104295
[21, 7, 3]
current group_mem  0.7989636946111522
the new estimated memory cost(GB) for batch 3 17.041493533092016
[16, 14]
current group_mem  0.7939272227587294
the new estimated memory cost(GB) for batch 4 17.03645706123959
[23, 6, 0]
current group_mem  0.7924511371955659
the new estimated memory cost(GB) for batch 5 17.03498097567643
[17, 13]
current group_mem  0.7893589757965587
the new estimated memory cost(GB) for batch 6 17.031888814277423
[18, 12]
current group_mem  0.7878507379176494
the new estimated memory cost(GB) for batch 7 17.030380576398514
[19, 11]
current group_mem  0.729541067709857
the new estimated memory cost(GB) for batch 8 16.97207090619072
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 9 16.826364412881233
the length of split_batches_nid_list  13
batches output list generation spend  0.0016393661499023438
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02577376365661621
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  38.02926826477051
len local_batched_seeds_list  13
partition total batch output list spend :  41.80020260810852
self.buckets_partition() spend  sec:  38.05510091781616
layer  0
 the number of batches:  13
check_connections_block*********************************
layer  1
num of batch  13
check_connections_block*********************************
step  0
----------------------------------------after loss function
 Nvidia-smi: 23.607421875 GB
    Memory Allocated: 19.576755046844482  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  1
----------------------------------------after loss function
 Nvidia-smi: 23.623046875 GB
    Memory Allocated: 19.650227069854736  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  2
----------------------------------------after loss function
 Nvidia-smi: 23.623046875 GB
    Memory Allocated: 19.182599544525146  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  3
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.623292922973633  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  4
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.624213218688965  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  5
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.639667987823486  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  6
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.6969895362854  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  7
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.747517585754395  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  8
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.66719341278076  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  9
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.49089527130127  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  10
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 18.984107494354248  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  11
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 19.009682178497314  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

step  12
----------------------------------------after loss function
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 18.98119831085205  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.642578125 GB
    Memory Allocated: 0.5606474876403809  GigaBytes
Max Memory Allocated: 20.08966588973999  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0073095560073853
pure train time :  2.403930902481079
train time :  5.518847703933716
end to end time :  137.9041783809662
connection check time:  45.737868547439575
block generation time  44.715688943862915
end to end time  138.70010209083557
Total (block generation + training)time/epoch 138.70010209083557
