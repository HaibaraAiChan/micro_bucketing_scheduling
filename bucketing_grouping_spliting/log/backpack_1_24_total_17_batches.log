main start at this time 1686870810.1695518
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  17
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.054875846386293, 0.05487075916589934]
check_connections_block*********************************
num of batch  17
check_connections_block*********************************
generate_K_hop_neighbors time  59.147191524505615
7.9986881568942705
7.993897313089989
8.003903049020213
7.981960803950507
7.94385058882944
7.986435867089723
8.00376771444947
7.983124681258891
8.002603837141084
8.00051968475165
7.961615506815562
7.98023754374972
7.996396491496365
7.978929309565877
7.987798235101864
8.035526227050358
7.987347751410656
the split redundant ratio 
[7.9986881568942705, 7.993897313089989, 8.003903049020213, 7.981960803950507, 7.94385058882944, 7.986435867089723, 8.00376771444947, 7.983124681258891, 8.002603837141084, 8.00051968475165, 7.961615506815562, 7.98023754374972, 7.996396491496365, 7.978929309565877, 7.987798235101864, 8.035526227050358, 7.987347751410656]
17
average memory estimation for each split fanout bucket batch 14.49913735362417
capacity est:  3.4178832879703798
sum(estimated_mem)
7.232344365911213
24
the grouping_fanout_1 called successfully
capacity  595
sorted_dict  {23: 595, 22: 583, 21: 545, 20: 494, 18: 455, 19: 448, 17: 427, 16: 410, 15: 388, 14: 383, 13: 362, 12: 331, 11: 281, 10: 280, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 46, 0: 31}

weights after sort [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [595], 		------------sum 595

before remove weights,  [595, 583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]

remove bucket_id:  [14, 20]
original bucket_id :,  [8, 1]
remove weights:  [211  53], 		------------sum 264

before remove weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 211, 181, 165, 132, 95, 72, 53, 46, 31]
after remove pre pack weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 181, 165, 132, 95, 72, 46, 31]

remove bucket_id:  [14, 20]
original bucket_id :,  [7, 0]
remove weights:  [181  31], 		------------sum 212

before remove weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 181, 165, 132, 95, 72, 46, 31]
after remove pre pack weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 165, 132, 95, 72, 46]

remove bucket_id:  [16, 17]
original bucket_id :,  [4, 3]
remove weights:  [95 72], 		------------sum 167

before remove weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 165, 132, 95, 72, 46]
after remove pre pack weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 165, 132, 46]

remove bucket_id:  [14, 16]
original bucket_id :,  [6, 2]
remove weights:  [165  46], 		------------sum 211

before remove weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 165, 132, 46]
after remove pre pack weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 132]

remove bucket_id:  [3, 14]
original bucket_id :,  [18, 5]
remove weights:  [455 132], 		------------sum 587

before remove weights,  [583, 545, 494, 455, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253, 132]
after remove pre pack weights,  [583, 545, 494, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253]

remove bucket_id:  [9, 12]
original bucket_id :,  [12, 9]
remove weights:  [331 253], 		------------sum 584

before remove weights,  [583, 545, 494, 448, 427, 410, 388, 383, 362, 331, 281, 280, 253]
after remove pre pack weights,  [583, 545, 494, 448, 427, 410, 388, 383, 362, 281, 280]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [583], 		------------sum 583

before remove weights,  [583, 545, 494, 448, 427, 410, 388, 383, 362, 281, 280]
after remove pre pack weights,  [545, 494, 448, 427, 410, 388, 383, 362, 281, 280]

remove bucket_id:  [8, 9]
original bucket_id :,  [11, 10]
remove weights:  [281 280], 		------------sum 561

before remove weights,  [545, 494, 448, 427, 410, 388, 383, 362, 281, 280]
after remove pre pack weights,  [545, 494, 448, 427, 410, 388, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [545], 		------------sum 545

before remove weights,  [545, 494, 448, 427, 410, 388, 383, 362]
after remove pre pack weights,  [494, 448, 427, 410, 388, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [494], 		------------sum 494

before remove weights,  [494, 448, 427, 410, 388, 383, 362]
after remove pre pack weights,  [448, 427, 410, 388, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 427, 410, 388, 383, 362]
after remove pre pack weights,  [427, 410, 388, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [427], 		------------sum 427

before remove weights,  [427, 410, 388, 383, 362]
after remove pre pack weights,  [410, 388, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [410], 		------------sum 410

before remove weights,  [410, 388, 383, 362]
after remove pre pack weights,  [388, 383, 362]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [388], 		------------sum 388

before remove weights,  [388, 383, 362]
after remove pre pack weights,  [383, 362]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [383], 		------------sum 383

before remove weights,  [383, 362]
after remove pre pack weights,  [362]
the last batch value is  362
G_BUCKET_ID_list [[23], [8, 1], [7, 0], [4, 3], [6, 2], [18, 5], [12, 9], [22], [11, 10], [21], [20], [19], [17], [16], [15], [14], [13]]
[[23], [8, 1], [7, 0], [4, 3], [6, 2], [18, 5], [12, 9], [22], [11, 10], [21], [20], [19], [17], [16], [15], [14], [13]]
G_BUCKET_ID_list length 17
split_batches_nid_list  17
estimated_mem  [0.031600323026579925, 0.053446445057834434, 0.04691033726707499, 0.07212925883696267, 0.0954132446010461, 0.13250813817436047, 0.16562827234049787, 0.18126462923828512, 0.21130672298992675, 0.25300076929852366, 0.2809490893635299, 0.28129312471449885, 0.33190986587898375, 0.36230173630435075, 0.3834405979819673, 0.38852240658495635, 0.4104866247767621, 0.427057239492208, 0.45594087203866557, 0.4482479429953582, 0.494359802184077, 0.5455698065359045, 0.5838345744003708, 0.5952225418284881]
[23]
current group_mem  0.5952225418284881
the new estimated memory cost(GB) for batch 0 15.094359895452657
[8, 1]
current group_mem  0.26475316804776117
the new estimated memory cost(GB) for batch 1 14.76389052167193
[7, 0]
current group_mem  0.21286495226486504
the new estimated memory cost(GB) for batch 2 14.712002305889035
[4, 3]
current group_mem  0.16754250343800875
the new estimated memory cost(GB) for batch 3 14.666679857062178
[6, 2]
current group_mem  0.21253860960757287
the new estimated memory cost(GB) for batch 4 14.711675963231743
[18, 5]
current group_mem  0.588449010213026
the new estimated memory cost(GB) for batch 5 15.087586363837195
[12, 9]
current group_mem  0.5849106351775074
the new estimated memory cost(GB) for batch 6 15.084047988801677
[22]
current group_mem  0.5838345744003708
the new estimated memory cost(GB) for batch 7 15.08297192802454
[11, 10]
current group_mem  0.5622422140780288
the new estimated memory cost(GB) for batch 8 15.061379567702199
[21]
current group_mem  0.5455698065359045
the new estimated memory cost(GB) for batch 9 15.044707160160074
[20]
current group_mem  0.494359802184077
the new estimated memory cost(GB) for batch 10 14.993497155808246
[19]
current group_mem  0.4482479429953582
the new estimated memory cost(GB) for batch 11 14.947385296619528
[17]
current group_mem  0.427057239492208
the new estimated memory cost(GB) for batch 12 14.926194593116378
[16]
current group_mem  0.4104866247767621
the new estimated memory cost(GB) for batch 13 14.909623978400932
[15]
current group_mem  0.38852240658495635
the new estimated memory cost(GB) for batch 14 14.887659760209125
[14]
current group_mem  0.3834405979819673
the new estimated memory cost(GB) for batch 15 14.882577951606137
[13]
current group_mem  0.36230173630435075
the new estimated memory cost(GB) for batch 16 14.86143908992852
the length of split_batches_nid_list  17
len local_batched_seeds_list  17
 the number of batches:  17
check_connections_block*********************************
num of batch  17
check_connections_block*********************************
----------------------------------------after generate_dataloader_bucket_block 
 Nvidia-smi: 1.34375 GB
    Memory Allocated: 0.000934600830078125  GigaBytes
Max Memory Allocated: 0.000934600830078125  GigaBytes

batch 0
src global  914035
seeds global  11432
----------------------------------------after load_block_subtensor
 Nvidia-smi: 1.685546875 GB
    Memory Allocated: 0.341524600982666  GigaBytes
Max Memory Allocated: 0.341524600982666  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 1.79296875 GB
    Memory Allocated: 0.3607935905456543  GigaBytes
Max Memory Allocated: 0.3607935905456543  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 17.6328125 GB
    Memory Allocated: 15.773810386657715  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 17.6328125 GB
    Memory Allocated: 15.775813102722168  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 17.640625 GB
    Memory Allocated: 0.3889765739440918  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

---------------------------------------- batch 0
 Nvidia-smi: 17.640625 GB
    Memory Allocated: 0.3889765739440918  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

batch 1
src global  903196
seeds global  11584
----------------------------------------after load_block_subtensor
 Nvidia-smi: 17.640625 GB
    Memory Allocated: 0.3493485450744629  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 17.640625 GB
    Memory Allocated: 0.3684682846069336  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 18.470703125 GB
    Memory Allocated: 15.407033920288086  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 18.470703125 GB
    Memory Allocated: 15.409180164337158  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 18.470703125 GB
    Memory Allocated: 0.39206790924072266  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

---------------------------------------- batch 1
 Nvidia-smi: 18.470703125 GB
    Memory Allocated: 0.39206790924072266  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

batch 2
src global  902126
seeds global  11472
----------------------------------------after load_block_subtensor
 Nvidia-smi: 18.470703125 GB
    Memory Allocated: 0.3573784828186035  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 18.470703125 GB
    Memory Allocated: 0.37595081329345703  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 18.470703125 GB
    Memory Allocated: 15.384572982788086  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 18.470703125 GB
    Memory Allocated: 15.38737440109253  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 0.39996814727783203  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

---------------------------------------- batch 2
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 0.39996814727783203  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

batch 3
src global  900506
seeds global  11688
----------------------------------------after load_block_subtensor
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 0.36508607864379883  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 0.38416576385498047  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 15.347153186798096  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 15.3499755859375  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 0.4064764976501465  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

---------------------------------------- batch 3
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 0.4064764976501465  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

batch 4
src global  907391
seeds global  11816
----------------------------------------after load_block_subtensor
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 0.37479352951049805  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 0.393768310546875  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 15.457673072814941  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 15.460312843322754  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 0.41869544982910156  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

---------------------------------------- batch 4
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 0.41869544982910156  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

batch 5
src global  919510
seeds global  11921
----------------------------------------after load_block_subtensor
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 0.3888835906982422  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 18.47265625 GB
    Memory Allocated: 0.4079399108886719  GigaBytes
Max Memory Allocated: 16.03453493118286  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.842906475067139  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.845507621765137  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4314584732055664  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

---------------------------------------- batch 5
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4314584732055664  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

batch 6
src global  917294
seeds global  12042
----------------------------------------after load_block_subtensor
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.3954010009765625  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.41445112228393555  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.831181049346924  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.833290100097656  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4382820129394531  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

---------------------------------------- batch 6
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4382820129394531  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

batch 7
src global  911098
seeds global  11435
----------------------------------------after load_block_subtensor
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4012336730957031  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.42026376724243164  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.822574615478516  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.825117588043213  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4441819190979004  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

---------------------------------------- batch 7
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4441819190979004  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

batch 8
src global  916114
seeds global  11994
----------------------------------------after load_block_subtensor
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4113783836364746  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4306979179382324  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.82401990890503  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.827085494995117  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.45497798919677734  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

---------------------------------------- batch 8
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.45497798919677734  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

batch 9
src global  914081
seeds global  11379
----------------------------------------after load_block_subtensor
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4195375442504883  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4391207695007324  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.826489925384521  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.829304695129395  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4627799987792969  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

---------------------------------------- batch 9
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4627799987792969  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

batch 10
src global  912780
seeds global  11373
----------------------------------------after load_block_subtensor
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.42765378952026367  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4466681480407715  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.740095138549805  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.742186546325684  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4699740409851074  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

---------------------------------------- batch 10
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4699740409851074  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

batch 11
src global  914957
seeds global  11359
----------------------------------------after load_block_subtensor
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.43622398376464844  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.45564842224121094  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.762253284454346  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.76424264907837  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.47945451736450195  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

---------------------------------------- batch 11
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.47945451736450195  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

batch 12
src global  908475
seeds global  11391
----------------------------------------after load_block_subtensor
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.442476749420166  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4614715576171875  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.698236465454102  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.70072317123413  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4851875305175781  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

---------------------------------------- batch 12
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4851875305175781  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

batch 13
src global  911091
seeds global  11343
----------------------------------------after load_block_subtensor
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4512767791748047  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4702610969543457  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.681843757629395  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.683934211730957  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4934554100036621  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

---------------------------------------- batch 13
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4934554100036621  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

batch 14
src global  910124
seeds global  11401
----------------------------------------after load_block_subtensor
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4584970474243164  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.47748422622680664  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.700783729553223  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.702898025512695  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.5021834373474121  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

---------------------------------------- batch 14
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.5021834373474121  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

batch 15
src global  905846
seeds global  11460
----------------------------------------after load_block_subtensor
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4661102294921875  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.48558664321899414  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.65830135345459  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.660345554351807  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.5090250968933105  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

---------------------------------------- batch 15
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.5090250968933105  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

batch 16
src global  907160
seeds global  11481
----------------------------------------after load_block_subtensor
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.4750380516052246  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.49393701553344727  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.664446353912354  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 15.667195320129395  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.5185379981994629  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

---------------------------------------- batch 16
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.5185379981994629  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.5204071998596191  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.858120441436768
---------------------------------------- batch 16 after optimizer
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.5204071998596191  GigaBytes
Max Memory Allocated: 16.105152130126953  GigaBytes

