main start at this time 1686266892.03999
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  19
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
check_connections_block*********************************
num of batch  19
check_connections_block*********************************
generate_K_hop_neighbors time  59.02782416343689
8.489265868274341
8.510481041963493
8.504128589765696
8.476853378344995
8.477488623564774
8.475260223666817
8.495940984710758
8.503967257646387
8.46694153626494
8.493319337771984
8.520201302151868
8.49355125269349
8.455577705111104
8.476500464334006
8.514605094263333
8.460800832473737
8.492926090731167
8.539097326625951
8.480265020583609
the split redundant ratio 
[8.489265868274341, 8.510481041963493, 8.504128589765696, 8.476853378344995, 8.477488623564774, 8.475260223666817, 8.495940984710758, 8.503967257646387, 8.46694153626494, 8.493319337771984, 8.520201302151868, 8.49355125269349, 8.455577705111104, 8.476500464334006, 8.514605094263333, 8.460800832473737, 8.492926090731167, 8.539097326625951, 8.480265020583609]
19
average memory estimation for each split fanout bucket batch 13.786546410165027
capacity est:  0.1352024986099689
capacity  596
sorted_dict  {23: 594, 22: 585, 21: 544, 20: 495, 18: 454, 19: 448, 17: 426, 16: 409, 15: 389, 14: 381, 13: 361, 12: 331, 11: 282, 10: 281, 9: 253, 8: 211, 7: 181, 6: 165, 5: 132, 4: 95, 3: 72, 1: 53, 2: 47, 0: 31}

weights after sort [594, 585, 544, 495, 454, 448, 426, 409, 389, 381, 361, 331, 282, 281, 253, 211, 181, 165, 132, 95, 72, 53, 47, 31]

remove bucket_id:  [15, 18]
original bucket_id :,  [8, 5]
remove weights:  [211 132], 		------------sum 343

before remove weights,  [594, 585, 544, 495, 454, 448, 426, 409, 389, 381, 361, 331, 282, 281, 253, 211, 181, 165, 132, 95, 72, 53, 47, 31]
after remove pre pack weights,  [594, 585, 544, 495, 454, 448, 426, 409, 389, 381, 361, 331, 282, 281, 253, 181, 165, 95, 72, 53, 47, 31]

remove bucket_id:  [17, 19]
original bucket_id :,  [4, 1]
remove weights:  [95 53], 		------------sum 148

before remove weights,  [594, 585, 544, 495, 454, 448, 426, 409, 389, 381, 361, 331, 282, 281, 253, 181, 165, 95, 72, 53, 47, 31]
after remove pre pack weights,  [594, 585, 544, 495, 454, 448, 426, 409, 389, 381, 361, 331, 282, 281, 253, 181, 165, 72, 47, 31]

remove bucket_id:  [16, 17, 18, 19]
original bucket_id :,  [6, 3, 2, 0]
remove weights:  [165  72  47  31], 		------------sum 315

before remove weights,  [594, 585, 544, 495, 454, 448, 426, 409, 389, 381, 361, 331, 282, 281, 253, 181, 165, 72, 47, 31]
after remove pre pack weights,  [594, 585, 544, 495, 454, 448, 426, 409, 389, 381, 361, 331, 282, 281, 253, 181]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [594], 		------------sum 594

before remove weights,  [594, 585, 544, 495, 454, 448, 426, 409, 389, 381, 361, 331, 282, 281, 253, 181]
after remove pre pack weights,  [585, 544, 495, 454, 448, 426, 409, 389, 381, 361, 331, 282, 281, 253, 181]

remove bucket_id:  [6, 14]
original bucket_id :,  [16, 7]
remove weights:  [409 181], 		------------sum 590

before remove weights,  [585, 544, 495, 454, 448, 426, 409, 389, 381, 361, 331, 282, 281, 253, 181]
after remove pre pack weights,  [585, 544, 495, 454, 448, 426, 389, 381, 361, 331, 282, 281, 253]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [585], 		------------sum 585

before remove weights,  [585, 544, 495, 454, 448, 426, 389, 381, 361, 331, 282, 281, 253]
after remove pre pack weights,  [544, 495, 454, 448, 426, 389, 381, 361, 331, 282, 281, 253]

remove bucket_id:  [8, 11]
original bucket_id :,  [12, 9]
remove weights:  [331 253], 		------------sum 584

before remove weights,  [544, 495, 454, 448, 426, 389, 381, 361, 331, 282, 281, 253]
after remove pre pack weights,  [544, 495, 454, 448, 426, 389, 381, 361, 282, 281]

remove bucket_id:  [8, 9]
original bucket_id :,  [11, 10]
remove weights:  [282 281], 		------------sum 563

before remove weights,  [544, 495, 454, 448, 426, 389, 381, 361, 282, 281]
after remove pre pack weights,  [544, 495, 454, 448, 426, 389, 381, 361]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [544], 		------------sum 544

before remove weights,  [544, 495, 454, 448, 426, 389, 381, 361]
after remove pre pack weights,  [495, 454, 448, 426, 389, 381, 361]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [495], 		------------sum 495

before remove weights,  [495, 454, 448, 426, 389, 381, 361]
after remove pre pack weights,  [454, 448, 426, 389, 381, 361]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [454], 		------------sum 454

before remove weights,  [454, 448, 426, 389, 381, 361]
after remove pre pack weights,  [448, 426, 389, 381, 361]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [448], 		------------sum 448

before remove weights,  [448, 426, 389, 381, 361]
after remove pre pack weights,  [426, 389, 381, 361]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [426], 		------------sum 426

before remove weights,  [426, 389, 381, 361]
after remove pre pack weights,  [389, 381, 361]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [389], 		------------sum 389

before remove weights,  [389, 381, 361]
after remove pre pack weights,  [381, 361]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [381], 		------------sum 381

before remove weights,  [381, 361]
after remove pre pack weights,  [361]
the last batch value is  361
G_BUCKET_ID_list [[8, 5], [4, 1], [6, 3, 2, 0], [23], [16, 7], [22], [12, 9], [11, 10], [21], [20], [18], [19], [17], [15], [14], [13]]
G_BUCKET_ID_list length 16
split_batches_nid_list  19
estimated_mem  [0.03173831570355189, 0.05356346886621881, 0.04711123806907531, 0.07226774258244979, 0.09551787968431964, 0.1325150206414136, 0.16567610820741147, 0.18105303097399883, 0.2113949286027087, 0.2532854815945029, 0.28107834893923545, 0.2823118815649026, 0.33190986587898375, 0.3619426326234686, 0.3814523874739127, 0.3890698973198667, 0.40976734184772345, 0.4268743659042759, 0.4544031402175385, 0.44849912694596744, 0.49506335349881553, 0.5441759409753638, 0.5855775860088747, 0.5946814550216808]
[8, 5]
current group_mem  0.3439099492441223
the new estimated memory cost(GB) for batch 0 14.130456359409148
[4, 1]
current group_mem  0.14908134855053845
the new estimated memory cost(GB) for batch 1 13.935627758715565
[6, 3, 2, 0]
current group_mem  0.31679340456248845
the new estimated memory cost(GB) for batch 2 14.103339814727516
[23]
current group_mem  0.5946814550216808
the new estimated memory cost(GB) for batch 3 14.381227865186707
[16, 7]
current group_mem  0.5908203728217223
the new estimated memory cost(GB) for batch 4 14.37736678298675
[22]
current group_mem  0.5855775860088747
the new estimated memory cost(GB) for batch 5 14.372123996173901
[12, 9]
current group_mem  0.5851953474734867
the new estimated memory cost(GB) for batch 6 14.371741757638514
[11, 10]
current group_mem  0.5633902305041381
the new estimated memory cost(GB) for batch 7 14.349936640669165
[21]
current group_mem  0.5441759409753638
the new estimated memory cost(GB) for batch 8 14.330722351140391
[20]
current group_mem  0.49506335349881553
the new estimated memory cost(GB) for batch 9 14.281609763663843
[18]
current group_mem  0.4544031402175385
the new estimated memory cost(GB) for batch 10 14.240949550382565
[19]
current group_mem  0.44849912694596744
the new estimated memory cost(GB) for batch 11 14.235045537110993
[17]
current group_mem  0.4268743659042759
the new estimated memory cost(GB) for batch 12 14.213420776069302
[15]
current group_mem  0.3890698973198667
the new estimated memory cost(GB) for batch 13 14.175616307484894
[14]
current group_mem  0.3814523874739127
the new estimated memory cost(GB) for batch 14 14.167998797638939
[13]
current group_mem  0.3619426326234686
the new estimated memory cost(GB) for batch 15 14.148489042788496
the length of split_batches_nid_list  19
len local_batched_seeds_list  19
 the number of batches:  19
check_connections_block*********************************
num of batch  19
check_connections_block*********************************
----------------------------------------after generate_dataloader_bucket_block 
 Nvidia-smi: 1.34375 GB
    Memory Allocated: 0.000934600830078125  GigaBytes
Max Memory Allocated: 0.000934600830078125  GigaBytes

batch 0
src global  863529
seeds global  10609
----------------------------------------after load_block_subtensor
 Nvidia-smi: 1.666015625 GB
    Memory Allocated: 0.32327938079833984  GigaBytes
Max Memory Allocated: 0.32327938079833984  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 1.775390625 GB
    Memory Allocated: 0.3403024673461914  GigaBytes
Max Memory Allocated: 0.3403024673461914  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 15.947265625 GB
    Memory Allocated: 14.100167751312256  GigaBytes
Max Memory Allocated: 14.329402923583984  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 15.947265625 GB
    Memory Allocated: 14.102701663970947  GigaBytes
Max Memory Allocated: 14.329402923583984  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 15.955078125 GB
    Memory Allocated: 0.36371850967407227  GigaBytes
Max Memory Allocated: 14.329402923583984  GigaBytes

---------------------------------------- batch 0
 Nvidia-smi: 15.955078125 GB
    Memory Allocated: 0.36371850967407227  GigaBytes
Max Memory Allocated: 14.329402923583984  GigaBytes

batch 1
src global  854884
seeds global  10281
----------------------------------------after load_block_subtensor
 Nvidia-smi: 15.955078125 GB
    Memory Allocated: 0.3287973403930664  GigaBytes
Max Memory Allocated: 14.329402923583984  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 15.955078125 GB
    Memory Allocated: 0.3462352752685547  GigaBytes
Max Memory Allocated: 14.329402923583984  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 16.693359375 GB
    Memory Allocated: 13.88658857345581  GigaBytes
Max Memory Allocated: 14.329402923583984  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 16.693359375 GB
    Memory Allocated: 13.889106273651123  GigaBytes
Max Memory Allocated: 14.329402923583984  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 16.693359375 GB
    Memory Allocated: 0.36646318435668945  GigaBytes
Max Memory Allocated: 14.329402923583984  GigaBytes

---------------------------------------- batch 1
 Nvidia-smi: 16.693359375 GB
    Memory Allocated: 0.36646318435668945  GigaBytes
Max Memory Allocated: 14.329402923583984  GigaBytes

batch 2
src global  1814722
seeds global  184523
----------------------------------------after load_block_subtensor
 Nvidia-smi: 16.693359375 GB
    Memory Allocated: 0.6939725875854492  GigaBytes
Max Memory Allocated: 14.329402923583984  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 16.693359375 GB
    Memory Allocated: 0.8138999938964844  GigaBytes
Max Memory Allocated: 14.329402923583984  GigaBytes

