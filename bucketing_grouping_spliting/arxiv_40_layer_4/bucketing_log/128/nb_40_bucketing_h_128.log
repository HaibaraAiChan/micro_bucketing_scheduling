main start at this time 1690352797.2019477
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  261
len(bkt)  300
len(bkt)  273
len(bkt)  261
len(bkt)  231
len(bkt)  200
len(bkt)  226
len(bkt)  196
len(bkt)  186
len(bkt)  200
len(bkt)  5145
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  40
the grouping_fanout_arxiv called successfully
capacity  1599
 
sorted_dict  {37: 1503, 33: 1491, 29: 1490, 34: 1489, 36: 1466, 35: 1429, 38: 1401, 32: 1387, 31: 1378, 30: 1326, 28: 1319, 25: 1275, 27: 1261, 26: 1247, 22: 1188, 21: 1150, 23: 1144, 24: 1137, 0: 1065, 20: 1022, 18: 997, 19: 969, 17: 947, 16: 930, 15: 918, 14: 870, 13: 851, 12: 810, 11: 771, 10: 738, 1: 714, 9: 708, 8: 690, 7: 665, 6: 655, 5: 641, 2: 637, 3: 622, 4: 603}

weights after sort [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
res_tmp  [930 665]

remove bucket_id:  [23, 33]
original bucket_id :,  [16, 7]
remove weights:  [930 665], 		------------sum 1595

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
res_tmp  [969 622]

remove bucket_id:  [21, 35]
original bucket_id :,  [19, 3]
remove weights:  [969 622], 		------------sum 1591

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [851 738]

remove bucket_id:  [24, 27]
original bucket_id :,  [13, 10]
remove weights:  [851 738], 		------------sum 1589

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [947 641]

remove bucket_id:  [21, 30]
original bucket_id :,  [17, 5]
remove weights:  [947 641], 		------------sum 1588

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
res_tmp  [870 714]

remove bucket_id:  [22, 25]
original bucket_id :,  [14, 1]
remove weights:  [870 714], 		------------sum 1584

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
res_tmp  [810 771]

remove bucket_id:  [22, 23]
original bucket_id :,  [12, 11]
remove weights:  [810 771], 		------------sum 1581

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
res_tmp  [918 655]

remove bucket_id:  [21, 24]
original bucket_id :,  [15, 6]
remove weights:  [918 655], 		------------sum 1573

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1503]

remove bucket_id:  [0]
original bucket_id :,  [37]
remove weights:  [1503], 		------------sum 1503

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1491]

remove bucket_id:  [0]
original bucket_id :,  [33]
remove weights:  [1491], 		------------sum 1491

before remove weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1490]

remove bucket_id:  [0]
original bucket_id :,  [29]
remove weights:  [1490], 		------------sum 1490

before remove weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1489]

remove bucket_id:  [0]
original bucket_id :,  [34]
remove weights:  [1489], 		------------sum 1489

before remove weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1466]

remove bucket_id:  [0]
original bucket_id :,  [36]
remove weights:  [1466], 		------------sum 1466

before remove weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [35]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1401]

remove bucket_id:  [0]
original bucket_id :,  [38]
remove weights:  [1401], 		------------sum 1401

before remove weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [708 690]

remove bucket_id:  [14, 15]
original bucket_id :,  [9, 8]
remove weights:  [708 690], 		------------sum 1398

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1387]

remove bucket_id:  [0]
original bucket_id :,  [32]
remove weights:  [1387], 		------------sum 1387

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1378]

remove bucket_id:  [0]
original bucket_id :,  [31]
remove weights:  [1378], 		------------sum 1378

before remove weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1326]

remove bucket_id:  [0]
original bucket_id :,  [30]
remove weights:  [1326], 		------------sum 1326

before remove weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1319]

remove bucket_id:  [0]
original bucket_id :,  [28]
remove weights:  [1319], 		------------sum 1319

before remove weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1275]

remove bucket_id:  [0]
original bucket_id :,  [25]
remove weights:  [1275], 		------------sum 1275

before remove weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1261]

remove bucket_id:  [0]
original bucket_id :,  [27]
remove weights:  [1261], 		------------sum 1261

before remove weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1247]

remove bucket_id:  [0]
original bucket_id :,  [26]
remove weights:  [1247], 		------------sum 1247

before remove weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [637 603]

remove bucket_id:  [7, 8]
original bucket_id :,  [2, 4]
remove weights:  [637 603], 		------------sum 1240

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1188]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1188], 		------------sum 1188

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1150]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [1150], 		------------sum 1150

before remove weights,  [1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1144, 1137, 1065, 1022, 997]
res_tmp  [1144]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1144], 		------------sum 1144

before remove weights,  [1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1137, 1065, 1022, 997]
res_tmp  [1137]

remove bucket_id:  [0]
original bucket_id :,  [24]
remove weights:  [1137], 		------------sum 1137

before remove weights,  [1137, 1065, 1022, 997]
after remove pre pack weights,  [1065, 1022, 997]
res_tmp  [1065]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1065], 		------------sum 1065

before remove weights,  [1065, 1022, 997]
after remove pre pack weights,  [1022, 997]
res_tmp  [1022]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1022], 		------------sum 1022

before remove weights,  [1022, 997]
after remove pre pack weights,  [997]
the last batch value is  997
G_BUCKET_ID_list [[16, 7], [19, 3], [13, 10], [17, 5], [14, 1], [12, 11], [15, 6], [37], [33], [29], [34], [36], [35], [38], [9, 8], [32], [31], [30], [28], [25], [27], [26], [2, 4], [22], [21], [23], [24], [0], [20], [18]]
Groups_mem_list  [[930, 665], [969, 622], [851, 738], [947, 641], [870, 714], [810, 771], [918, 655], [1503], [1491], [1490], [1489], [1466], [1429], [1401], [708, 690], [1387], [1378], [1326], [1319], [1275], [1261], [1247], [637, 603], [1188], [1150], [1144], [1137], [1065], [1022], [997], [997]]
G_BUCKET_ID_list length 30
backpack scheduling spend  0.9044628143310547
len(g_bucket_nids_list)  30
len(local_split_batches_nid_list)  40
current group_mem  1.596117937663403
current group_mem  1.5921340399311468
current group_mem  1.589870625764705
current group_mem  1.5891473550971833
current group_mem  1.5857603736084847
current group_mem  1.5820095418574445
current group_mem  1.5734293513806403
current group_mem  1.503098849221118
current group_mem  1.4919510315025555
current group_mem  1.4902377010672119
current group_mem  1.489771218355281
current group_mem  1.4669528399603706
current group_mem  1.4299614653289316
current group_mem  1.4019953464128971
current group_mem  1.398786105658422
current group_mem  1.3877983983820137
current group_mem  1.378120696771145
current group_mem  1.3265526451140681
current group_mem  1.3195097810560623
current group_mem  1.275594926541009
current group_mem  1.261519346948089
current group_mem  1.247374740324102
current group_mem  1.240614376707236
current group_mem  1.1887666153577383
current group_mem  1.1507276274635794
current group_mem  1.1445336375167028
current group_mem  1.1373269469250744
current group_mem  1.065213040461425
current group_mem  1.0222163350143478
current group_mem  0.9979639436230555
batches output list generation spend  0.0009796619415283203
self.weights_list  [0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.0012535600004398456]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0192415714263916
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.9058377742767334
len local_batched_seeds_list  40
partition total batch output list spend :  2.358447790145874
self.buckets_partition() spend  sec:  0.9251179695129395
layer  0
 the number of batches:  40
check_connections_block*********************************

the find indices time spent  0.036173105239868164

in edges time spent  0.045830488204956055
local to global src and eids time spent  0.12442517280578613
time gen tails  0.02733778953552246
res  length 40
layer  1
num of batch  40
check_connections_block*********************************

the find indices time spent  0.06803417205810547

in edges time spent  0.9448432922363281
local to global src and eids time spent  1.5369763374328613
time gen tails  0.2526888847351074
res  length 40
layer  2
num of batch  40
check_connections_block*********************************

the find indices time spent  0.2740035057067871

in edges time spent  4.939922332763672
local to global src and eids time spent  9.695582866668701
time gen tails  0.7830874919891357
res  length 40
layer  3
num of batch  40
check_connections_block*********************************

the find indices time spent  0.6290602684020996

in edges time spent  7.087348699569702
local to global src and eids time spent  9.933052778244019
time gen tails  1.23539400100708
res  length 40
block collection to dataloader spend  0.00011277198791503906
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.51171875 GB
    Memory Allocated: 0.07215166091918945  GigaBytes
Max Memory Allocated: 0.07215166091918945  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.080078125 GB
    Memory Allocated: 11.29731559753418  GigaBytes
Max Memory Allocated: 11.333172798156738  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.080078125 GB
    Memory Allocated: 11.297336101531982  GigaBytes
Max Memory Allocated: 11.333172798156738  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.708984375 GB
    Memory Allocated: 0.09637880325317383  GigaBytes
Max Memory Allocated: 11.333172798156738  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.685546875 GB
    Memory Allocated: 11.512297630310059  GigaBytes
Max Memory Allocated: 11.54268503189087  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.685546875 GB
    Memory Allocated: 11.512317657470703  GigaBytes
Max Memory Allocated: 11.54268503189087  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.314453125 GB
    Memory Allocated: 0.11519098281860352  GigaBytes
Max Memory Allocated: 11.54268503189087  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 11.576804161071777  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 11.576824188232422  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 0.1326894760131836  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 11.5081205368042  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 11.508140563964844  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 0.1513991355895996  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 11.565510272979736  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 11.56553030014038  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 0.1722879409790039  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 11.226905345916748  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 11.226925373077393  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 0.18936824798583984  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 11.342095375061035  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 11.34211540222168  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.681640625 GB
    Memory Allocated: 0.21006536483764648  GigaBytes
Max Memory Allocated: 11.608991622924805  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 11.744224071502686  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 11.74424409866333  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 0.23112773895263672  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 11.634448051452637  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 11.634468078613281  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 0.24811697006225586  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 11.618311405181885  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 11.61833143234253  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 0.26501941680908203  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 11.273690223693848  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 11.273710250854492  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 0.2840147018432617  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 11.306257724761963  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 11.306277751922607  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 0.30681753158569336  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 11.540098190307617  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 11.540118217468262  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.6953125 GB
    Memory Allocated: 0.3224477767944336  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.697265625 GB
    Memory Allocated: 11.5864896774292  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.697265625 GB
    Memory Allocated: 11.586509704589844  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.697265625 GB
    Memory Allocated: 0.34314870834350586  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.701171875 GB
    Memory Allocated: 11.62719202041626  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.701171875 GB
    Memory Allocated: 11.627212047576904  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.005859375 GB
    Memory Allocated: 0.36009979248046875  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.025390625 GB
    Memory Allocated: 11.658836364746094  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.025390625 GB
    Memory Allocated: 11.658856391906738  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.025390625 GB
    Memory Allocated: 0.37755393981933594  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.025390625 GB
    Memory Allocated: 11.618113994598389  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.025390625 GB
    Memory Allocated: 11.618134021759033  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.025390625 GB
    Memory Allocated: 0.3989448547363281  GigaBytes
Max Memory Allocated: 11.777708053588867  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.296875 GB
    Memory Allocated: 11.924776554107666  GigaBytes
Max Memory Allocated: 11.958033561706543  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.296875 GB
    Memory Allocated: 11.92479658126831  GigaBytes
Max Memory Allocated: 11.958033561706543  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.93359375 GB
    Memory Allocated: 0.416689395904541  GigaBytes
Max Memory Allocated: 11.958033561706543  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.939453125 GB
    Memory Allocated: 11.718245029449463  GigaBytes
Max Memory Allocated: 11.958033561706543  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.939453125 GB
    Memory Allocated: 11.718265056610107  GigaBytes
Max Memory Allocated: 11.958033561706543  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.939453125 GB
    Memory Allocated: 0.43536853790283203  GigaBytes
Max Memory Allocated: 11.958033561706543  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.939453125 GB
    Memory Allocated: 11.472097396850586  GigaBytes
Max Memory Allocated: 11.958033561706543  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.939453125 GB
    Memory Allocated: 11.47211742401123  GigaBytes
Max Memory Allocated: 11.958033561706543  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.939453125 GB
    Memory Allocated: 0.45740747451782227  GigaBytes
Max Memory Allocated: 11.958033561706543  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.310546875 GB
    Memory Allocated: 11.958016395568848  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.310546875 GB
    Memory Allocated: 11.958036422729492  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.310546875 GB
    Memory Allocated: 0.47214841842651367  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.310546875 GB
    Memory Allocated: 11.530666828155518  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.310546875 GB
    Memory Allocated: 11.530686855316162  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.310546875 GB
    Memory Allocated: 0.49184322357177734  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 11.745893478393555  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 11.7459135055542  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.5093092918395996  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 11.495609283447266  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 11.49562931060791  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.5277619361877441  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 11.753133296966553  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 11.753153324127197  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.5462822914123535  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 11.809916973114014  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 11.809937000274658  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.3203125 GB
    Memory Allocated: 0.5655779838562012  GigaBytes
Max Memory Allocated: 11.989544868469238  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 11.968523979187012  GigaBytes
Max Memory Allocated: 12.000502109527588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 11.968544006347656  GigaBytes
Max Memory Allocated: 12.000502109527588  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 0.5823478698730469  GigaBytes
Max Memory Allocated: 12.000502109527588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 11.597103118896484  GigaBytes
Max Memory Allocated: 12.000502109527588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 11.597123146057129  GigaBytes
Max Memory Allocated: 12.000502109527588  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 0.6027178764343262  GigaBytes
Max Memory Allocated: 12.000502109527588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 11.919133186340332  GigaBytes
Max Memory Allocated: 12.000502109527588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 11.919153213500977  GigaBytes
Max Memory Allocated: 12.000502109527588  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 0.6214699745178223  GigaBytes
Max Memory Allocated: 12.000502109527588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 11.949325561523438  GigaBytes
Max Memory Allocated: 12.000502109527588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 11.949345588684082  GigaBytes
Max Memory Allocated: 12.000502109527588  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 0.6395368576049805  GigaBytes
Max Memory Allocated: 12.000502109527588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 12.013335227966309  GigaBytes
Max Memory Allocated: 12.045939922332764  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 12.013355255126953  GigaBytes
Max Memory Allocated: 12.045939922332764  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 0.657963752746582  GigaBytes
Max Memory Allocated: 12.045939922332764  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.34765625 GB
    Memory Allocated: 11.983820915222168  GigaBytes
Max Memory Allocated: 12.045939922332764  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.34765625 GB
    Memory Allocated: 11.983840942382812  GigaBytes
Max Memory Allocated: 12.045939922332764  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.34765625 GB
    Memory Allocated: 0.6749186515808105  GigaBytes
Max Memory Allocated: 12.045939922332764  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.34765625 GB
    Memory Allocated: 11.874529838562012  GigaBytes
Max Memory Allocated: 12.045939922332764  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.34765625 GB
    Memory Allocated: 11.874549865722656  GigaBytes
Max Memory Allocated: 12.045939922332764  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.34765625 GB
    Memory Allocated: 0.6937246322631836  GigaBytes
Max Memory Allocated: 12.045939922332764  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.34765625 GB
    Memory Allocated: 11.81917953491211  GigaBytes
Max Memory Allocated: 12.045939922332764  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.34765625 GB
    Memory Allocated: 11.819199562072754  GigaBytes
Max Memory Allocated: 12.045939922332764  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.34765625 GB
    Memory Allocated: 0.7144808769226074  GigaBytes
Max Memory Allocated: 12.045939922332764  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.35546875 GB
    Memory Allocated: 12.09348440170288  GigaBytes
Max Memory Allocated: 12.124617099761963  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.35546875 GB
    Memory Allocated: 12.093504428863525  GigaBytes
Max Memory Allocated: 12.124617099761963  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.35546875 GB
    Memory Allocated: 0.7323946952819824  GigaBytes
Max Memory Allocated: 12.124617099761963  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.359375 GB
    Memory Allocated: 11.959397315979004  GigaBytes
Max Memory Allocated: 12.124617099761963  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.359375 GB
    Memory Allocated: 11.959417343139648  GigaBytes
Max Memory Allocated: 12.124617099761963  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.359375 GB
    Memory Allocated: 0.751042366027832  GigaBytes
Max Memory Allocated: 12.124617099761963  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.359375 GB
    Memory Allocated: 11.989609241485596  GigaBytes
Max Memory Allocated: 12.124617099761963  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.359375 GB
    Memory Allocated: 11.98962926864624  GigaBytes
Max Memory Allocated: 12.124617099761963  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.359375 GB
    Memory Allocated: 0.7707657814025879  GigaBytes
Max Memory Allocated: 12.124617099761963  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.37109375 GB
    Memory Allocated: 12.133479118347168  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.37109375 GB
    Memory Allocated: 12.133499145507812  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.788475513458252  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 12.066996097564697  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 12.067016124725342  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.8048005104064941  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.394662380218506  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.39468002319336  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.8277835845947266  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.2753123939037323
pure train time :  17.550257921218872
train time :  21.42908000946045
end to end time :  87.511873960495
connection check time:  43.460124254226685
block generation time  20.24253821372986
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  261
len(bkt)  300
len(bkt)  273
len(bkt)  261
len(bkt)  231
len(bkt)  200
len(bkt)  226
len(bkt)  196
len(bkt)  186
len(bkt)  200
len(bkt)  5145
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  40
the grouping_fanout_arxiv called successfully
capacity  1599
 
sorted_dict  {37: 1503, 33: 1491, 29: 1490, 34: 1489, 36: 1466, 35: 1429, 38: 1401, 32: 1387, 31: 1378, 30: 1326, 28: 1319, 25: 1275, 27: 1261, 26: 1247, 22: 1188, 21: 1150, 23: 1144, 24: 1137, 0: 1065, 20: 1022, 18: 997, 19: 969, 17: 947, 16: 930, 15: 918, 14: 870, 13: 851, 12: 810, 11: 771, 10: 738, 1: 714, 9: 708, 8: 690, 7: 665, 6: 655, 5: 641, 2: 637, 3: 622, 4: 603}

weights after sort [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
res_tmp  [930 665]

remove bucket_id:  [23, 33]
original bucket_id :,  [16, 7]
remove weights:  [930 665], 		------------sum 1595

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
res_tmp  [969 622]

remove bucket_id:  [21, 35]
original bucket_id :,  [19, 3]
remove weights:  [969 622], 		------------sum 1591

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [851 738]

remove bucket_id:  [24, 27]
original bucket_id :,  [13, 10]
remove weights:  [851 738], 		------------sum 1589

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [947 641]

remove bucket_id:  [21, 30]
original bucket_id :,  [17, 5]
remove weights:  [947 641], 		------------sum 1588

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
res_tmp  [870 714]

remove bucket_id:  [22, 25]
original bucket_id :,  [14, 1]
remove weights:  [870 714], 		------------sum 1584

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
res_tmp  [810 771]

remove bucket_id:  [22, 23]
original bucket_id :,  [12, 11]
remove weights:  [810 771], 		------------sum 1581

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
res_tmp  [918 655]

remove bucket_id:  [21, 24]
original bucket_id :,  [15, 6]
remove weights:  [918 655], 		------------sum 1573

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1503]

remove bucket_id:  [0]
original bucket_id :,  [37]
remove weights:  [1503], 		------------sum 1503

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1491]

remove bucket_id:  [0]
original bucket_id :,  [33]
remove weights:  [1491], 		------------sum 1491

before remove weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1490]

remove bucket_id:  [0]
original bucket_id :,  [29]
remove weights:  [1490], 		------------sum 1490

before remove weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1489]

remove bucket_id:  [0]
original bucket_id :,  [34]
remove weights:  [1489], 		------------sum 1489

before remove weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1466]

remove bucket_id:  [0]
original bucket_id :,  [36]
remove weights:  [1466], 		------------sum 1466

before remove weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [35]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1401]

remove bucket_id:  [0]
original bucket_id :,  [38]
remove weights:  [1401], 		------------sum 1401

before remove weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [708 690]

remove bucket_id:  [14, 15]
original bucket_id :,  [9, 8]
remove weights:  [708 690], 		------------sum 1398

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1387]

remove bucket_id:  [0]
original bucket_id :,  [32]
remove weights:  [1387], 		------------sum 1387

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1378]

remove bucket_id:  [0]
original bucket_id :,  [31]
remove weights:  [1378], 		------------sum 1378

before remove weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1326]

remove bucket_id:  [0]
original bucket_id :,  [30]
remove weights:  [1326], 		------------sum 1326

before remove weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1319]

remove bucket_id:  [0]
original bucket_id :,  [28]
remove weights:  [1319], 		------------sum 1319

before remove weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1275]

remove bucket_id:  [0]
original bucket_id :,  [25]
remove weights:  [1275], 		------------sum 1275

before remove weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1261]

remove bucket_id:  [0]
original bucket_id :,  [27]
remove weights:  [1261], 		------------sum 1261

before remove weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1247]

remove bucket_id:  [0]
original bucket_id :,  [26]
remove weights:  [1247], 		------------sum 1247

before remove weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [637 603]

remove bucket_id:  [7, 8]
original bucket_id :,  [2, 4]
remove weights:  [637 603], 		------------sum 1240

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1188]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1188], 		------------sum 1188

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1150]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [1150], 		------------sum 1150

before remove weights,  [1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1144, 1137, 1065, 1022, 997]
res_tmp  [1144]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1144], 		------------sum 1144

before remove weights,  [1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1137, 1065, 1022, 997]
res_tmp  [1137]

remove bucket_id:  [0]
original bucket_id :,  [24]
remove weights:  [1137], 		------------sum 1137

before remove weights,  [1137, 1065, 1022, 997]
after remove pre pack weights,  [1065, 1022, 997]
res_tmp  [1065]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1065], 		------------sum 1065

before remove weights,  [1065, 1022, 997]
after remove pre pack weights,  [1022, 997]
res_tmp  [1022]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1022], 		------------sum 1022

before remove weights,  [1022, 997]
after remove pre pack weights,  [997]
the last batch value is  997
G_BUCKET_ID_list [[16, 7], [19, 3], [13, 10], [17, 5], [14, 1], [12, 11], [15, 6], [37], [33], [29], [34], [36], [35], [38], [9, 8], [32], [31], [30], [28], [25], [27], [26], [2, 4], [22], [21], [23], [24], [0], [20], [18]]
Groups_mem_list  [[930, 665], [969, 622], [851, 738], [947, 641], [870, 714], [810, 771], [918, 655], [1503], [1491], [1490], [1489], [1466], [1429], [1401], [708, 690], [1387], [1378], [1326], [1319], [1275], [1261], [1247], [637, 603], [1188], [1150], [1144], [1137], [1065], [1022], [997], [997]]
G_BUCKET_ID_list length 30
backpack scheduling spend  1.000614881515503
len(g_bucket_nids_list)  30
len(local_split_batches_nid_list)  40
current group_mem  1.596117937663403
current group_mem  1.5921340399311468
current group_mem  1.589870625764705
current group_mem  1.5891473550971833
current group_mem  1.5857603736084847
current group_mem  1.5820095418574445
current group_mem  1.5734293513806403
current group_mem  1.503098849221118
current group_mem  1.4919510315025555
current group_mem  1.4902377010672119
current group_mem  1.489771218355281
current group_mem  1.4669528399603706
current group_mem  1.4299614653289316
current group_mem  1.4019953464128971
current group_mem  1.398786105658422
current group_mem  1.3877983983820137
current group_mem  1.378120696771145
current group_mem  1.3265526451140681
current group_mem  1.3195097810560623
current group_mem  1.275594926541009
current group_mem  1.261519346948089
current group_mem  1.247374740324102
current group_mem  1.240614376707236
current group_mem  1.1887666153577383
current group_mem  1.1507276274635794
current group_mem  1.1445336375167028
current group_mem  1.1373269469250744
current group_mem  1.065213040461425
current group_mem  1.0222163350143478
current group_mem  0.9979639436230555
batches output list generation spend  0.0009121894836425781
self.weights_list  [0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.0012535600004398456]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02573394775390625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  1.002075433731079
len local_batched_seeds_list  40
partition total batch output list spend :  2.2023613452911377
self.buckets_partition() spend  sec:  1.0278542041778564
layer  0
 the number of batches:  40
check_connections_block*********************************

the find indices time spent  0.03010725975036621

in edges time spent  0.03613996505737305
local to global src and eids time spent  0.1297292709350586
time gen tails  0.03281760215759277
res  length 40
layer  1
num of batch  40
check_connections_block*********************************

the find indices time spent  0.06519603729248047

in edges time spent  0.9836645126342773
local to global src and eids time spent  0.8600630760192871
time gen tails  0.20261430740356445
res  length 40
layer  2
num of batch  40
check_connections_block*********************************

the find indices time spent  0.26544666290283203

in edges time spent  5.079026222229004
local to global src and eids time spent  8.51253628730774
time gen tails  0.816556453704834
res  length 40
layer  3
num of batch  40
check_connections_block*********************************

the find indices time spent  0.625321626663208

in edges time spent  6.732353687286377
local to global src and eids time spent  9.45464825630188
time gen tails  1.288135051727295
res  length 40
block collection to dataloader spend  0.00011014938354492188
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.09810733795166016  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.26531982421875  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.247909545898438  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.09784603118896484  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.287153244018555  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.2871732711792  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.11594247817993164  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.262685775756836  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.26270580291748  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.1351466178894043  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.016808986663818  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.016829013824463  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.15556812286376953  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.43832540512085  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.438345432281494  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.17429065704345703  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.348977088928223  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.348997116088867  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.19484472274780273  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.815341472625732  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.815361499786377  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.2131342887878418  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.565316200256348  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.565336227416992  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.2338418960571289  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.540685176849365  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.54070520401001  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.2533574104309082  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.533351421356201  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.533371448516846  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.2714686393737793  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.45096492767334  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.450984954833984  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.2899942398071289  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.556691646575928  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.556711673736572  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.30547285079956055  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.23757553100586  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.237595558166504  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.3250589370727539  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.603076457977295  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.60309648513794  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.34494543075561523  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.523837566375732  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.523857593536377  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.3644862174987793  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.547228336334229  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.547248363494873  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.3836250305175781  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.637148380279541  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.637168407440186  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.4020862579345703  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.578668117523193  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.578688144683838  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.42317676544189453  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.729234218597412  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.729254245758057  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.4392862319946289  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.529356479644775  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.52937650680542  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.4595789909362793  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.571447372436523  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.571467399597168  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.4802274703979492  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.833670616149902  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.833690643310547  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.49835824966430664  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.588565826416016  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.58858585357666  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.5170755386352539  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.836738586425781  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.836758613586426  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.5343427658081055  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.546205997467041  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.546226024627686  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.5550169944763184  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.992433071136475  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.99245309829712  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.5782299041748047  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.949041843414307  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.949061870574951  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.5962958335876465  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.857390403747559  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.857410430908203  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.6158900260925293  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.901288032531738  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.901308059692383  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.6338052749633789  GigaBytes
Max Memory Allocated: 12.16405725479126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 12.142398357391357  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 12.142418384552002  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.6532588005065918  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.909780025482178  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.909800052642822  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.672339916229248  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.861522674560547  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.861542701721191  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.6905303001403809  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.97771406173706  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 11.977734088897705  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 0.7084646224975586  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 12.056167125701904  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.681640625 GB
    Memory Allocated: 12.056187152862549  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7250595092773438  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.932483673095703  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.932503700256348  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7431902885437012  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.786392211914062  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.786412239074707  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7627372741699219  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.864210605621338  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.864230632781982  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7810006141662598  GigaBytes
Max Memory Allocated: 12.17558240890503  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.153454780578613  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.153474807739258  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.8011965751647949  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.128393173217773  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.128413200378418  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.8163490295410156  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.547427654266357  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.547445297241211  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.8335757255554199  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.22630009055137634
pure train time :  16.91496205329895
train time :  20.229894161224365
end to end time :  85.73364877700806
connection check time:  43.005512714385986
block generation time  20.261548042297363
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  261
len(bkt)  300
len(bkt)  273
len(bkt)  261
len(bkt)  231
len(bkt)  200
len(bkt)  226
len(bkt)  196
len(bkt)  186
len(bkt)  200
len(bkt)  5145
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  40
the grouping_fanout_arxiv called successfully
capacity  1599
 
sorted_dict  {37: 1503, 33: 1491, 29: 1490, 34: 1489, 36: 1466, 35: 1429, 38: 1401, 32: 1387, 31: 1378, 30: 1326, 28: 1319, 25: 1275, 27: 1261, 26: 1247, 22: 1188, 21: 1150, 23: 1144, 24: 1137, 0: 1065, 20: 1022, 18: 997, 19: 969, 17: 947, 16: 930, 15: 918, 14: 870, 13: 851, 12: 810, 11: 771, 10: 738, 1: 714, 9: 708, 8: 690, 7: 665, 6: 655, 5: 641, 2: 637, 3: 622, 4: 603}

weights after sort [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
res_tmp  [930 665]

remove bucket_id:  [23, 33]
original bucket_id :,  [16, 7]
remove weights:  [930 665], 		------------sum 1595

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
res_tmp  [969 622]

remove bucket_id:  [21, 35]
original bucket_id :,  [19, 3]
remove weights:  [969 622], 		------------sum 1591

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [851 738]

remove bucket_id:  [24, 27]
original bucket_id :,  [13, 10]
remove weights:  [851 738], 		------------sum 1589

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [947 641]

remove bucket_id:  [21, 30]
original bucket_id :,  [17, 5]
remove weights:  [947 641], 		------------sum 1588

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
res_tmp  [870 714]

remove bucket_id:  [22, 25]
original bucket_id :,  [14, 1]
remove weights:  [870 714], 		------------sum 1584

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
res_tmp  [810 771]

remove bucket_id:  [22, 23]
original bucket_id :,  [12, 11]
remove weights:  [810 771], 		------------sum 1581

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
res_tmp  [918 655]

remove bucket_id:  [21, 24]
original bucket_id :,  [15, 6]
remove weights:  [918 655], 		------------sum 1573

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1503]

remove bucket_id:  [0]
original bucket_id :,  [37]
remove weights:  [1503], 		------------sum 1503

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1491]

remove bucket_id:  [0]
original bucket_id :,  [33]
remove weights:  [1491], 		------------sum 1491

before remove weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1490]

remove bucket_id:  [0]
original bucket_id :,  [29]
remove weights:  [1490], 		------------sum 1490

before remove weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1489]

remove bucket_id:  [0]
original bucket_id :,  [34]
remove weights:  [1489], 		------------sum 1489

before remove weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1466]

remove bucket_id:  [0]
original bucket_id :,  [36]
remove weights:  [1466], 		------------sum 1466

before remove weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [35]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1401]

remove bucket_id:  [0]
original bucket_id :,  [38]
remove weights:  [1401], 		------------sum 1401

before remove weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [708 690]

remove bucket_id:  [14, 15]
original bucket_id :,  [9, 8]
remove weights:  [708 690], 		------------sum 1398

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1387]

remove bucket_id:  [0]
original bucket_id :,  [32]
remove weights:  [1387], 		------------sum 1387

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1378]

remove bucket_id:  [0]
original bucket_id :,  [31]
remove weights:  [1378], 		------------sum 1378

before remove weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1326]

remove bucket_id:  [0]
original bucket_id :,  [30]
remove weights:  [1326], 		------------sum 1326

before remove weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1319]

remove bucket_id:  [0]
original bucket_id :,  [28]
remove weights:  [1319], 		------------sum 1319

before remove weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1275]

remove bucket_id:  [0]
original bucket_id :,  [25]
remove weights:  [1275], 		------------sum 1275

before remove weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1261]

remove bucket_id:  [0]
original bucket_id :,  [27]
remove weights:  [1261], 		------------sum 1261

before remove weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1247]

remove bucket_id:  [0]
original bucket_id :,  [26]
remove weights:  [1247], 		------------sum 1247

before remove weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [637 603]

remove bucket_id:  [7, 8]
original bucket_id :,  [2, 4]
remove weights:  [637 603], 		------------sum 1240

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1188]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1188], 		------------sum 1188

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1150]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [1150], 		------------sum 1150

before remove weights,  [1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1144, 1137, 1065, 1022, 997]
res_tmp  [1144]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1144], 		------------sum 1144

before remove weights,  [1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1137, 1065, 1022, 997]
res_tmp  [1137]

remove bucket_id:  [0]
original bucket_id :,  [24]
remove weights:  [1137], 		------------sum 1137

before remove weights,  [1137, 1065, 1022, 997]
after remove pre pack weights,  [1065, 1022, 997]
res_tmp  [1065]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1065], 		------------sum 1065

before remove weights,  [1065, 1022, 997]
after remove pre pack weights,  [1022, 997]
res_tmp  [1022]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1022], 		------------sum 1022

before remove weights,  [1022, 997]
after remove pre pack weights,  [997]
the last batch value is  997
G_BUCKET_ID_list [[16, 7], [19, 3], [13, 10], [17, 5], [14, 1], [12, 11], [15, 6], [37], [33], [29], [34], [36], [35], [38], [9, 8], [32], [31], [30], [28], [25], [27], [26], [2, 4], [22], [21], [23], [24], [0], [20], [18]]
Groups_mem_list  [[930, 665], [969, 622], [851, 738], [947, 641], [870, 714], [810, 771], [918, 655], [1503], [1491], [1490], [1489], [1466], [1429], [1401], [708, 690], [1387], [1378], [1326], [1319], [1275], [1261], [1247], [637, 603], [1188], [1150], [1144], [1137], [1065], [1022], [997], [997]]
G_BUCKET_ID_list length 30
backpack scheduling spend  0.9915907382965088
len(g_bucket_nids_list)  30
len(local_split_batches_nid_list)  40
current group_mem  1.596117937663403
current group_mem  1.5921340399311468
current group_mem  1.589870625764705
current group_mem  1.5891473550971833
current group_mem  1.5857603736084847
current group_mem  1.5820095418574445
current group_mem  1.5734293513806403
current group_mem  1.503098849221118
current group_mem  1.4919510315025555
current group_mem  1.4902377010672119
current group_mem  1.489771218355281
current group_mem  1.4669528399603706
current group_mem  1.4299614653289316
current group_mem  1.4019953464128971
current group_mem  1.398786105658422
current group_mem  1.3877983983820137
current group_mem  1.378120696771145
current group_mem  1.3265526451140681
current group_mem  1.3195097810560623
current group_mem  1.275594926541009
current group_mem  1.261519346948089
current group_mem  1.247374740324102
current group_mem  1.240614376707236
current group_mem  1.1887666153577383
current group_mem  1.1507276274635794
current group_mem  1.1445336375167028
current group_mem  1.1373269469250744
current group_mem  1.065213040461425
current group_mem  1.0222163350143478
current group_mem  0.9979639436230555
batches output list generation spend  0.0008344650268554688
self.weights_list  [0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.0012535600004398456]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02040839195251465
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.9927928447723389
len local_batched_seeds_list  40
partition total batch output list spend :  1.9844691753387451
self.buckets_partition() spend  sec:  1.0132484436035156
layer  0
 the number of batches:  40
check_connections_block*********************************

the find indices time spent  0.05803251266479492

in edges time spent  0.030422687530517578
local to global src and eids time spent  0.05836939811706543
time gen tails  0.017583370208740234
res  length 40
layer  1
num of batch  40
check_connections_block*********************************

the find indices time spent  0.06702756881713867

in edges time spent  1.0161709785461426
local to global src and eids time spent  1.6590943336486816
time gen tails  0.2459268569946289
res  length 40
layer  2
num of batch  40
check_connections_block*********************************

the find indices time spent  0.28238797187805176

in edges time spent  5.066725015640259
local to global src and eids time spent  8.230679512023926
time gen tails  0.8041727542877197
res  length 40
layer  3
num of batch  40
check_connections_block*********************************

the find indices time spent  0.6389203071594238

in edges time spent  6.7971203327178955
local to global src and eids time spent  9.577540636062622
time gen tails  1.2678194046020508
res  length 40
block collection to dataloader spend  6.580352783203125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.09775972366333008  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.40458869934082  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.387821674346924  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.10152149200439453  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.38292121887207  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.382941246032715  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.11834430694580078  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.165814876556396  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.165834903717041  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.13669776916503906  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.425443649291992  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.425463676452637  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.15569067001342773  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.397258281707764  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.397278308868408  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.17399930953979492  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.463093280792236  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.46311330795288  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.19180822372436523  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.231861114501953  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.231881141662598  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.21066665649414062  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.710062503814697  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.710082530975342  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.2293696403503418  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.422327041625977  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.422347068786621  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.24914884567260742  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.754356384277344  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.754376411437988  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.26777076721191406  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.62346363067627  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.623483657836914  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.28583240509033203  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.174878597259521  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.174898624420166  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.30625247955322266  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.615649223327637  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.615669250488281  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.3258504867553711  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.628841876983643  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.628861904144287  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.3452262878417969  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.524094581604004  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.524114608764648  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.3677330017089844  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.804317951202393  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.804337978363037  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.38470029830932617  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.598039150238037  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.598059177398682  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.4036397933959961  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.690150737762451  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.690170764923096  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.42134714126586914  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.546884536743164  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.546904563903809  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.4405355453491211  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.470328330993652  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.470348358154297  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.46224260330200195  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.85991096496582  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.859930992126465  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.4785122871398926  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.739529132843018  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.739549160003662  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.49634552001953125  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.371838569641113  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.371858596801758  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.5170907974243164  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.761631488800049  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.761651515960693  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.5325169563293457  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.811497211456299  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.811517238616943  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.5527248382568359  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.749352931976318  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.749372959136963  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.5714240074157715  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.980776309967041  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.980796337127686  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.5936036109924316  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.047523021697998  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.047543048858643  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.6099977493286133  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.796180725097656  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.7962007522583  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.6296744346618652  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.704488754272461  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.704508781433105  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.6492934226989746  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.011340618133545  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.01136064529419  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.6686596870422363  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.77103567123413  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.771055698394775  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.6863198280334473  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.954322338104248  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.954342365264893  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7035436630249023  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.742552280426025  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.74257230758667  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7216415405273438  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.884566307067871  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.884586334228516  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7412586212158203  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.991248607635498  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.991268634796143  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7593865394592285  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.911202430725098  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.911222457885742  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7790985107421875  GigaBytes
Max Memory Allocated: 12.187293529510498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.291342735290527  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.291362762451172  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7953543663024902  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.230053901672363  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.230073928833008  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.8139805793762207  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.530825138092041  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.530842781066895  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.831881046295166  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.2002711147069931
pure train time :  16.982738494873047
train time :  20.339930057525635
end to end time :  85.65209865570068
connection check time:  42.99233531951904
block generation time  20.30314016342163
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  261
len(bkt)  300
len(bkt)  273
len(bkt)  261
len(bkt)  231
len(bkt)  200
len(bkt)  226
len(bkt)  196
len(bkt)  186
len(bkt)  200
len(bkt)  5145
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  40
the grouping_fanout_arxiv called successfully
capacity  1599
 
sorted_dict  {37: 1503, 33: 1491, 29: 1490, 34: 1489, 36: 1466, 35: 1429, 38: 1401, 32: 1387, 31: 1378, 30: 1326, 28: 1319, 25: 1275, 27: 1261, 26: 1247, 22: 1188, 21: 1150, 23: 1144, 24: 1137, 0: 1065, 20: 1022, 18: 997, 19: 969, 17: 947, 16: 930, 15: 918, 14: 870, 13: 851, 12: 810, 11: 771, 10: 738, 1: 714, 9: 708, 8: 690, 7: 665, 6: 655, 5: 641, 2: 637, 3: 622, 4: 603}

weights after sort [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
res_tmp  [930 665]

remove bucket_id:  [23, 33]
original bucket_id :,  [16, 7]
remove weights:  [930 665], 		------------sum 1595

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
res_tmp  [969 622]

remove bucket_id:  [21, 35]
original bucket_id :,  [19, 3]
remove weights:  [969 622], 		------------sum 1591

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [851 738]

remove bucket_id:  [24, 27]
original bucket_id :,  [13, 10]
remove weights:  [851 738], 		------------sum 1589

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [947 641]

remove bucket_id:  [21, 30]
original bucket_id :,  [17, 5]
remove weights:  [947 641], 		------------sum 1588

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
res_tmp  [870 714]

remove bucket_id:  [22, 25]
original bucket_id :,  [14, 1]
remove weights:  [870 714], 		------------sum 1584

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
res_tmp  [810 771]

remove bucket_id:  [22, 23]
original bucket_id :,  [12, 11]
remove weights:  [810 771], 		------------sum 1581

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
res_tmp  [918 655]

remove bucket_id:  [21, 24]
original bucket_id :,  [15, 6]
remove weights:  [918 655], 		------------sum 1573

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1503]

remove bucket_id:  [0]
original bucket_id :,  [37]
remove weights:  [1503], 		------------sum 1503

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1491]

remove bucket_id:  [0]
original bucket_id :,  [33]
remove weights:  [1491], 		------------sum 1491

before remove weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1490]

remove bucket_id:  [0]
original bucket_id :,  [29]
remove weights:  [1490], 		------------sum 1490

before remove weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1489]

remove bucket_id:  [0]
original bucket_id :,  [34]
remove weights:  [1489], 		------------sum 1489

before remove weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1466]

remove bucket_id:  [0]
original bucket_id :,  [36]
remove weights:  [1466], 		------------sum 1466

before remove weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [35]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1401]

remove bucket_id:  [0]
original bucket_id :,  [38]
remove weights:  [1401], 		------------sum 1401

before remove weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [708 690]

remove bucket_id:  [14, 15]
original bucket_id :,  [9, 8]
remove weights:  [708 690], 		------------sum 1398

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1387]

remove bucket_id:  [0]
original bucket_id :,  [32]
remove weights:  [1387], 		------------sum 1387

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1378]

remove bucket_id:  [0]
original bucket_id :,  [31]
remove weights:  [1378], 		------------sum 1378

before remove weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1326]

remove bucket_id:  [0]
original bucket_id :,  [30]
remove weights:  [1326], 		------------sum 1326

before remove weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1319]

remove bucket_id:  [0]
original bucket_id :,  [28]
remove weights:  [1319], 		------------sum 1319

before remove weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1275]

remove bucket_id:  [0]
original bucket_id :,  [25]
remove weights:  [1275], 		------------sum 1275

before remove weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1261]

remove bucket_id:  [0]
original bucket_id :,  [27]
remove weights:  [1261], 		------------sum 1261

before remove weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1247]

remove bucket_id:  [0]
original bucket_id :,  [26]
remove weights:  [1247], 		------------sum 1247

before remove weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [637 603]

remove bucket_id:  [7, 8]
original bucket_id :,  [2, 4]
remove weights:  [637 603], 		------------sum 1240

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1188]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1188], 		------------sum 1188

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1150]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [1150], 		------------sum 1150

before remove weights,  [1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1144, 1137, 1065, 1022, 997]
res_tmp  [1144]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1144], 		------------sum 1144

before remove weights,  [1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1137, 1065, 1022, 997]
res_tmp  [1137]

remove bucket_id:  [0]
original bucket_id :,  [24]
remove weights:  [1137], 		------------sum 1137

before remove weights,  [1137, 1065, 1022, 997]
after remove pre pack weights,  [1065, 1022, 997]
res_tmp  [1065]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1065], 		------------sum 1065

before remove weights,  [1065, 1022, 997]
after remove pre pack weights,  [1022, 997]
res_tmp  [1022]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1022], 		------------sum 1022

before remove weights,  [1022, 997]
after remove pre pack weights,  [997]
the last batch value is  997
G_BUCKET_ID_list [[16, 7], [19, 3], [13, 10], [17, 5], [14, 1], [12, 11], [15, 6], [37], [33], [29], [34], [36], [35], [38], [9, 8], [32], [31], [30], [28], [25], [27], [26], [2, 4], [22], [21], [23], [24], [0], [20], [18]]
Groups_mem_list  [[930, 665], [969, 622], [851, 738], [947, 641], [870, 714], [810, 771], [918, 655], [1503], [1491], [1490], [1489], [1466], [1429], [1401], [708, 690], [1387], [1378], [1326], [1319], [1275], [1261], [1247], [637, 603], [1188], [1150], [1144], [1137], [1065], [1022], [997], [997]]
G_BUCKET_ID_list length 30
backpack scheduling spend  0.9735960960388184
len(g_bucket_nids_list)  30
len(local_split_batches_nid_list)  40
current group_mem  1.596117937663403
current group_mem  1.5921340399311468
current group_mem  1.589870625764705
current group_mem  1.5891473550971833
current group_mem  1.5857603736084847
current group_mem  1.5820095418574445
current group_mem  1.5734293513806403
current group_mem  1.503098849221118
current group_mem  1.4919510315025555
current group_mem  1.4902377010672119
current group_mem  1.489771218355281
current group_mem  1.4669528399603706
current group_mem  1.4299614653289316
current group_mem  1.4019953464128971
current group_mem  1.398786105658422
current group_mem  1.3877983983820137
current group_mem  1.378120696771145
current group_mem  1.3265526451140681
current group_mem  1.3195097810560623
current group_mem  1.275594926541009
current group_mem  1.261519346948089
current group_mem  1.247374740324102
current group_mem  1.240614376707236
current group_mem  1.1887666153577383
current group_mem  1.1507276274635794
current group_mem  1.1445336375167028
current group_mem  1.1373269469250744
current group_mem  1.065213040461425
current group_mem  1.0222163350143478
current group_mem  0.9979639436230555
batches output list generation spend  0.0007944107055664062
self.weights_list  [0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.0012535600004398456]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021747827529907227
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.9747109413146973
len local_batched_seeds_list  40
partition total batch output list spend :  1.9751691818237305
self.buckets_partition() spend  sec:  0.9965043067932129
layer  0
 the number of batches:  40
check_connections_block*********************************

the find indices time spent  0.05382823944091797

in edges time spent  0.029868364334106445
local to global src and eids time spent  0.05691242218017578
time gen tails  0.017819881439208984
res  length 40
layer  1
num of batch  40
check_connections_block*********************************

the find indices time spent  0.06639385223388672

in edges time spent  0.768129825592041
local to global src and eids time spent  0.8594584465026855
time gen tails  0.26068615913391113
res  length 40
layer  2
num of batch  40
check_connections_block*********************************

the find indices time spent  0.275571346282959

in edges time spent  5.02763557434082
local to global src and eids time spent  8.138852596282959
time gen tails  0.7954137325286865
res  length 40
layer  3
num of batch  40
check_connections_block*********************************

the find indices time spent  0.6274046897888184

in edges time spent  6.534473896026611
local to global src and eids time spent  8.772168636322021
time gen tails  1.2400639057159424
res  length 40
block collection to dataloader spend  0.0001201629638671875
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.09607410430908203  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.261559009552002  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.244727611541748  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.10228443145751953  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.467122554779053  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.467142581939697  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.12285327911376953  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.484875202178955  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.4848952293396  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.1391897201538086  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.445708274841309  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.445728302001953  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.15958881378173828  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.37189531326294  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.371915340423584  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.17733144760131836  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.268299102783203  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.268319129943848  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.19606971740722656  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.343074321746826  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.34309434890747  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.21559906005859375  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.349667072296143  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.349687099456787  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.23321771621704102  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.291470050811768  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.291490077972412  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.2525782585144043  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.487252712249756  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.4872727394104  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.27135515213012695  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.471878051757812  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.471898078918457  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.2900962829589844  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.465769290924072  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.465789318084717  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.3085494041442871  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.630159854888916  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.63017988204956  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.3272676467895508  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.465766906738281  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.465786933898926  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.3463292121887207  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.646429061889648  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.646449089050293  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.36650753021240234  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.89469051361084  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.894710540771484  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.38512420654296875  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.625187873840332  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.625207901000977  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.4030466079711914  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.485339641571045  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.48535966873169  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.4220280647277832  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.645686149597168  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.645706176757812  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.4406876564025879  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.535814762115479  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.535834789276123  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.4602055549621582  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.716164588928223  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.716184616088867  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.4771556854248047  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.67221450805664  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.672234535217285  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.49669933319091797  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.885120868682861  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.885140895843506  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.5125102996826172  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.763672351837158  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.763692378997803  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.5331211090087891  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.763819217681885  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.76383924484253  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.5512042045593262  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.7527494430542  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.752769470214844  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.5705709457397461  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.717913627624512  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.717933654785156  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.590573787689209  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.918683528900146  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.918703556060791  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.6084871292114258  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.877817153930664  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.877837181091309  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.6283426284790039  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.704957485198975  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.70497751235962  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.6448540687561035  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.685591220855713  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.685611248016357  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.6653909683227539  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.926145076751709  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.926165103912354  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.6836328506469727  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.062853336334229  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.062873363494873  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7025456428527832  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.902913570404053  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 11.902933597564697  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7219009399414062  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.069697380065918  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 12.069717407226562  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.9921875 GB
    Memory Allocated: 0.7409768104553223  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 12.090363502502441  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 12.090383529663086  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.7576045989990234  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.984603881835938  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.984623908996582  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.7755651473999023  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.75683069229126  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.756850719451904  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.7962241172790527  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.950265884399414  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.950285911560059  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.8141670227050781  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.492827892303467  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.49284553527832  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.833587646484375  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.17835724353790283
pure train time :  16.95870566368103
train time :  20.332837104797363
end to end time :  83.28944134712219
connection check time:  40.59845304489136
block generation time  20.35404396057129
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  261
len(bkt)  300
len(bkt)  273
len(bkt)  261
len(bkt)  231
len(bkt)  200
len(bkt)  226
len(bkt)  196
len(bkt)  186
len(bkt)  200
len(bkt)  5145
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  40
the grouping_fanout_arxiv called successfully
capacity  1599
 
sorted_dict  {37: 1503, 33: 1491, 29: 1490, 34: 1489, 36: 1466, 35: 1429, 38: 1401, 32: 1387, 31: 1378, 30: 1326, 28: 1319, 25: 1275, 27: 1261, 26: 1247, 22: 1188, 21: 1150, 23: 1144, 24: 1137, 0: 1065, 20: 1022, 18: 997, 19: 969, 17: 947, 16: 930, 15: 918, 14: 870, 13: 851, 12: 810, 11: 771, 10: 738, 1: 714, 9: 708, 8: 690, 7: 665, 6: 655, 5: 641, 2: 637, 3: 622, 4: 603}

weights after sort [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
res_tmp  [930 665]

remove bucket_id:  [23, 33]
original bucket_id :,  [16, 7]
remove weights:  [930 665], 		------------sum 1595

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
res_tmp  [969 622]

remove bucket_id:  [21, 35]
original bucket_id :,  [19, 3]
remove weights:  [969 622], 		------------sum 1591

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [851 738]

remove bucket_id:  [24, 27]
original bucket_id :,  [13, 10]
remove weights:  [851 738], 		------------sum 1589

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [947 641]

remove bucket_id:  [21, 30]
original bucket_id :,  [17, 5]
remove weights:  [947 641], 		------------sum 1588

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
res_tmp  [870 714]

remove bucket_id:  [22, 25]
original bucket_id :,  [14, 1]
remove weights:  [870 714], 		------------sum 1584

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
res_tmp  [810 771]

remove bucket_id:  [22, 23]
original bucket_id :,  [12, 11]
remove weights:  [810 771], 		------------sum 1581

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
res_tmp  [918 655]

remove bucket_id:  [21, 24]
original bucket_id :,  [15, 6]
remove weights:  [918 655], 		------------sum 1573

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1503]

remove bucket_id:  [0]
original bucket_id :,  [37]
remove weights:  [1503], 		------------sum 1503

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1491]

remove bucket_id:  [0]
original bucket_id :,  [33]
remove weights:  [1491], 		------------sum 1491

before remove weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1490]

remove bucket_id:  [0]
original bucket_id :,  [29]
remove weights:  [1490], 		------------sum 1490

before remove weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1489]

remove bucket_id:  [0]
original bucket_id :,  [34]
remove weights:  [1489], 		------------sum 1489

before remove weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1466]

remove bucket_id:  [0]
original bucket_id :,  [36]
remove weights:  [1466], 		------------sum 1466

before remove weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [35]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1401]

remove bucket_id:  [0]
original bucket_id :,  [38]
remove weights:  [1401], 		------------sum 1401

before remove weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [708 690]

remove bucket_id:  [14, 15]
original bucket_id :,  [9, 8]
remove weights:  [708 690], 		------------sum 1398

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1387]

remove bucket_id:  [0]
original bucket_id :,  [32]
remove weights:  [1387], 		------------sum 1387

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1378]

remove bucket_id:  [0]
original bucket_id :,  [31]
remove weights:  [1378], 		------------sum 1378

before remove weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1326]

remove bucket_id:  [0]
original bucket_id :,  [30]
remove weights:  [1326], 		------------sum 1326

before remove weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1319]

remove bucket_id:  [0]
original bucket_id :,  [28]
remove weights:  [1319], 		------------sum 1319

before remove weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1275]

remove bucket_id:  [0]
original bucket_id :,  [25]
remove weights:  [1275], 		------------sum 1275

before remove weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1261]

remove bucket_id:  [0]
original bucket_id :,  [27]
remove weights:  [1261], 		------------sum 1261

before remove weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1247]

remove bucket_id:  [0]
original bucket_id :,  [26]
remove weights:  [1247], 		------------sum 1247

before remove weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [637 603]

remove bucket_id:  [7, 8]
original bucket_id :,  [2, 4]
remove weights:  [637 603], 		------------sum 1240

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1188]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1188], 		------------sum 1188

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1150]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [1150], 		------------sum 1150

before remove weights,  [1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1144, 1137, 1065, 1022, 997]
res_tmp  [1144]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1144], 		------------sum 1144

before remove weights,  [1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1137, 1065, 1022, 997]
res_tmp  [1137]

remove bucket_id:  [0]
original bucket_id :,  [24]
remove weights:  [1137], 		------------sum 1137

before remove weights,  [1137, 1065, 1022, 997]
after remove pre pack weights,  [1065, 1022, 997]
res_tmp  [1065]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1065], 		------------sum 1065

before remove weights,  [1065, 1022, 997]
after remove pre pack weights,  [1022, 997]
res_tmp  [1022]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1022], 		------------sum 1022

before remove weights,  [1022, 997]
after remove pre pack weights,  [997]
the last batch value is  997
G_BUCKET_ID_list [[16, 7], [19, 3], [13, 10], [17, 5], [14, 1], [12, 11], [15, 6], [37], [33], [29], [34], [36], [35], [38], [9, 8], [32], [31], [30], [28], [25], [27], [26], [2, 4], [22], [21], [23], [24], [0], [20], [18]]
Groups_mem_list  [[930, 665], [969, 622], [851, 738], [947, 641], [870, 714], [810, 771], [918, 655], [1503], [1491], [1490], [1489], [1466], [1429], [1401], [708, 690], [1387], [1378], [1326], [1319], [1275], [1261], [1247], [637, 603], [1188], [1150], [1144], [1137], [1065], [1022], [997], [997]]
G_BUCKET_ID_list length 30
backpack scheduling spend  0.9494130611419678
len(g_bucket_nids_list)  30
len(local_split_batches_nid_list)  40
current group_mem  1.596117937663403
current group_mem  1.5921340399311468
current group_mem  1.589870625764705
current group_mem  1.5891473550971833
current group_mem  1.5857603736084847
current group_mem  1.5820095418574445
current group_mem  1.5734293513806403
current group_mem  1.503098849221118
current group_mem  1.4919510315025555
current group_mem  1.4902377010672119
current group_mem  1.489771218355281
current group_mem  1.4669528399603706
current group_mem  1.4299614653289316
current group_mem  1.4019953464128971
current group_mem  1.398786105658422
current group_mem  1.3877983983820137
current group_mem  1.378120696771145
current group_mem  1.3265526451140681
current group_mem  1.3195097810560623
current group_mem  1.275594926541009
current group_mem  1.261519346948089
current group_mem  1.247374740324102
current group_mem  1.240614376707236
current group_mem  1.1887666153577383
current group_mem  1.1507276274635794
current group_mem  1.1445336375167028
current group_mem  1.1373269469250744
current group_mem  1.065213040461425
current group_mem  1.0222163350143478
current group_mem  0.9979639436230555
batches output list generation spend  0.00078582763671875
self.weights_list  [0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.0012535600004398456]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021352052688598633
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.950657844543457
len local_batched_seeds_list  40
partition total batch output list spend :  2.2008554935455322
self.buckets_partition() spend  sec:  0.9720568656921387
layer  0
 the number of batches:  40
check_connections_block*********************************

the find indices time spent  0.04747343063354492

in edges time spent  0.04686570167541504
local to global src and eids time spent  0.1266345977783203
time gen tails  0.028273344039916992
res  length 40
layer  1
num of batch  40
check_connections_block*********************************

the find indices time spent  0.06804108619689941

in edges time spent  0.7553300857543945
local to global src and eids time spent  0.8106212615966797
time gen tails  0.20127177238464355
res  length 40
layer  2
num of batch  40
check_connections_block*********************************

the find indices time spent  0.26910853385925293

in edges time spent  5.0202202796936035
local to global src and eids time spent  8.150088787078857
time gen tails  0.7948682308197021
res  length 40
layer  3
num of batch  40
check_connections_block*********************************

the find indices time spent  0.588904857635498

in edges time spent  6.722817420959473
local to global src and eids time spent  8.532189130783081
time gen tails  1.2490904331207275
res  length 40
block collection to dataloader spend  0.00011563301086425781
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.09924888610839844  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.377406120300293  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.358385562896729  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.09888219833374023  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.336487770080566  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.336507797241211  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.12046146392822266  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.517545700073242  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.517565727233887  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.1380915641784668  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.316380977630615  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.31640100479126  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.15592670440673828  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.306975364685059  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.306995391845703  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.1780252456665039  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.535026550292969  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.535046577453613  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.1947646141052246  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.199210166931152  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.199230194091797  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.2162919044494629  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.630281925201416  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.63030195236206  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.2344207763671875  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.488177299499512  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.488197326660156  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.25516414642333984  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.624716758728027  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.624736785888672  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.2728109359741211  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.494134426116943  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.494154453277588  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.29047203063964844  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.255354881286621  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.255374908447266  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.3098635673522949  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.50215196609497  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.502171993255615  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.3286166191101074  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.449502944946289  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.449522972106934  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.3461489677429199  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.535350799560547  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.535370826721191  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.3656754493713379  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.761205673217773  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.761225700378418  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.38353490829467773  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.524800777435303  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.524820804595947  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.4010281562805176  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.439030170440674  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.439050197601318  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.4241518974304199  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.799512386322021  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.799532413482666  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.4394254684448242  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.397699356079102  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.397719383239746  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.4608631134033203  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.971185207366943  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.971205234527588  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.47919607162475586  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.766012191772461  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.766032218933105  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.4988870620727539  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.845802307128906  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.84582233428955  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.5169291496276855  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.75455379486084  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.754573822021484  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.5361709594726562  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.871372699737549  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.871392726898193  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.5551638603210449  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.977226257324219  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.977246284484863  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.571871280670166  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.808461666107178  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.808481693267822  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.5910139083862305  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.580257892608643  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.580277919769287  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.6101937294006348  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.887884140014648  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.887904167175293  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.6280832290649414  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.497739791870117  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.497759819030762  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.6489620208740234  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 12.058723449707031  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 12.058743476867676  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.6672077178955078  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.924027919769287  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.924047946929932  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.6849632263183594  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.875622272491455  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.8756422996521  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.7042641639709473  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.892014503479004  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.892034530639648  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.722144603729248  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 12.07303762435913  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 12.073057651519775  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.7411856651306152  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 12.053063869476318  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 12.053083896636963  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.7602815628051758  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 12.063729763031006  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 12.06374979019165  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.779904842376709  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 12.146642208099365  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 12.14666223526001  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.7942905426025391  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.898509979248047  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.898530006408691  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.8132672309875488  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.534329891204834  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.534347534179688  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.832496166229248  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.1627281755208969
pure train time :  16.443695545196533
train time :  19.79207491874695
end to end time :  82.86999917030334
connection check time:  40.47414803504944
block generation time  20.369508504867554
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  261
len(bkt)  300
len(bkt)  273
len(bkt)  261
len(bkt)  231
len(bkt)  200
len(bkt)  226
len(bkt)  196
len(bkt)  186
len(bkt)  200
len(bkt)  5145
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  40
the grouping_fanout_arxiv called successfully
capacity  1599
 
sorted_dict  {37: 1503, 33: 1491, 29: 1490, 34: 1489, 36: 1466, 35: 1429, 38: 1401, 32: 1387, 31: 1378, 30: 1326, 28: 1319, 25: 1275, 27: 1261, 26: 1247, 22: 1188, 21: 1150, 23: 1144, 24: 1137, 0: 1065, 20: 1022, 18: 997, 19: 969, 17: 947, 16: 930, 15: 918, 14: 870, 13: 851, 12: 810, 11: 771, 10: 738, 1: 714, 9: 708, 8: 690, 7: 665, 6: 655, 5: 641, 2: 637, 3: 622, 4: 603}

weights after sort [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
res_tmp  [930 665]

remove bucket_id:  [23, 33]
original bucket_id :,  [16, 7]
remove weights:  [930 665], 		------------sum 1595

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
res_tmp  [969 622]

remove bucket_id:  [21, 35]
original bucket_id :,  [19, 3]
remove weights:  [969 622], 		------------sum 1591

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [851 738]

remove bucket_id:  [24, 27]
original bucket_id :,  [13, 10]
remove weights:  [851 738], 		------------sum 1589

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [947 641]

remove bucket_id:  [21, 30]
original bucket_id :,  [17, 5]
remove weights:  [947 641], 		------------sum 1588

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
res_tmp  [870 714]

remove bucket_id:  [22, 25]
original bucket_id :,  [14, 1]
remove weights:  [870 714], 		------------sum 1584

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
res_tmp  [810 771]

remove bucket_id:  [22, 23]
original bucket_id :,  [12, 11]
remove weights:  [810 771], 		------------sum 1581

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
res_tmp  [918 655]

remove bucket_id:  [21, 24]
original bucket_id :,  [15, 6]
remove weights:  [918 655], 		------------sum 1573

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1503]

remove bucket_id:  [0]
original bucket_id :,  [37]
remove weights:  [1503], 		------------sum 1503

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1491]

remove bucket_id:  [0]
original bucket_id :,  [33]
remove weights:  [1491], 		------------sum 1491

before remove weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1490]

remove bucket_id:  [0]
original bucket_id :,  [29]
remove weights:  [1490], 		------------sum 1490

before remove weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1489]

remove bucket_id:  [0]
original bucket_id :,  [34]
remove weights:  [1489], 		------------sum 1489

before remove weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1466]

remove bucket_id:  [0]
original bucket_id :,  [36]
remove weights:  [1466], 		------------sum 1466

before remove weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [35]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1401]

remove bucket_id:  [0]
original bucket_id :,  [38]
remove weights:  [1401], 		------------sum 1401

before remove weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [708 690]

remove bucket_id:  [14, 15]
original bucket_id :,  [9, 8]
remove weights:  [708 690], 		------------sum 1398

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1387]

remove bucket_id:  [0]
original bucket_id :,  [32]
remove weights:  [1387], 		------------sum 1387

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1378]

remove bucket_id:  [0]
original bucket_id :,  [31]
remove weights:  [1378], 		------------sum 1378

before remove weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1326]

remove bucket_id:  [0]
original bucket_id :,  [30]
remove weights:  [1326], 		------------sum 1326

before remove weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1319]

remove bucket_id:  [0]
original bucket_id :,  [28]
remove weights:  [1319], 		------------sum 1319

before remove weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1275]

remove bucket_id:  [0]
original bucket_id :,  [25]
remove weights:  [1275], 		------------sum 1275

before remove weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1261]

remove bucket_id:  [0]
original bucket_id :,  [27]
remove weights:  [1261], 		------------sum 1261

before remove weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1247]

remove bucket_id:  [0]
original bucket_id :,  [26]
remove weights:  [1247], 		------------sum 1247

before remove weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [637 603]

remove bucket_id:  [7, 8]
original bucket_id :,  [2, 4]
remove weights:  [637 603], 		------------sum 1240

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1188]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1188], 		------------sum 1188

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1150]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [1150], 		------------sum 1150

before remove weights,  [1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1144, 1137, 1065, 1022, 997]
res_tmp  [1144]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1144], 		------------sum 1144

before remove weights,  [1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1137, 1065, 1022, 997]
res_tmp  [1137]

remove bucket_id:  [0]
original bucket_id :,  [24]
remove weights:  [1137], 		------------sum 1137

before remove weights,  [1137, 1065, 1022, 997]
after remove pre pack weights,  [1065, 1022, 997]
res_tmp  [1065]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1065], 		------------sum 1065

before remove weights,  [1065, 1022, 997]
after remove pre pack weights,  [1022, 997]
res_tmp  [1022]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1022], 		------------sum 1022

before remove weights,  [1022, 997]
after remove pre pack weights,  [997]
the last batch value is  997
G_BUCKET_ID_list [[16, 7], [19, 3], [13, 10], [17, 5], [14, 1], [12, 11], [15, 6], [37], [33], [29], [34], [36], [35], [38], [9, 8], [32], [31], [30], [28], [25], [27], [26], [2, 4], [22], [21], [23], [24], [0], [20], [18]]
Groups_mem_list  [[930, 665], [969, 622], [851, 738], [947, 641], [870, 714], [810, 771], [918, 655], [1503], [1491], [1490], [1489], [1466], [1429], [1401], [708, 690], [1387], [1378], [1326], [1319], [1275], [1261], [1247], [637, 603], [1188], [1150], [1144], [1137], [1065], [1022], [997], [997]]
G_BUCKET_ID_list length 30
backpack scheduling spend  0.37580227851867676
len(g_bucket_nids_list)  30
len(local_split_batches_nid_list)  40
current group_mem  1.596117937663403
current group_mem  1.5921340399311468
current group_mem  1.589870625764705
current group_mem  1.5891473550971833
current group_mem  1.5857603736084847
current group_mem  1.5820095418574445
current group_mem  1.5734293513806403
current group_mem  1.503098849221118
current group_mem  1.4919510315025555
current group_mem  1.4902377010672119
current group_mem  1.489771218355281
current group_mem  1.4669528399603706
current group_mem  1.4299614653289316
current group_mem  1.4019953464128971
current group_mem  1.398786105658422
current group_mem  1.3877983983820137
current group_mem  1.378120696771145
current group_mem  1.3265526451140681
current group_mem  1.3195097810560623
current group_mem  1.275594926541009
current group_mem  1.261519346948089
current group_mem  1.247374740324102
current group_mem  1.240614376707236
current group_mem  1.1887666153577383
current group_mem  1.1507276274635794
current group_mem  1.1445336375167028
current group_mem  1.1373269469250744
current group_mem  1.065213040461425
current group_mem  1.0222163350143478
current group_mem  0.9979639436230555
batches output list generation spend  0.000576019287109375
self.weights_list  [0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.0012535600004398456]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02555561065673828
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.376636266708374
len local_batched_seeds_list  40
partition total batch output list spend :  0.7654075622558594
self.buckets_partition() spend  sec:  0.40222930908203125
layer  0
 the number of batches:  40
check_connections_block*********************************

the find indices time spent  0.030997276306152344

in edges time spent  0.02665257453918457
local to global src and eids time spent  0.045360565185546875
time gen tails  0.015142202377319336
res  length 40
layer  1
num of batch  40
check_connections_block*********************************

the find indices time spent  0.04655957221984863

in edges time spent  0.5683836936950684
local to global src and eids time spent  0.8610641956329346
time gen tails  0.21338629722595215
res  length 40
layer  2
num of batch  40
check_connections_block*********************************

the find indices time spent  0.2689673900604248

in edges time spent  4.999091148376465
local to global src and eids time spent  7.536271810531616
time gen tails  0.7401697635650635
res  length 40
layer  3
num of batch  40
check_connections_block*********************************

the find indices time spent  0.6253654956817627

in edges time spent  6.324222087860107
local to global src and eids time spent  8.275144338607788
time gen tails  1.227487564086914
res  length 40
block collection to dataloader spend  6.246566772460938e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.09925174713134766  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.398397445678711  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.379666328430176  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.10040903091430664  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.325222969055176  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.32524299621582  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.11795902252197266  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.24134874343872  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.241368770599365  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.13594818115234375  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.546113967895508  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.546133995056152  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.15405941009521484  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.34022855758667  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.340248584747314  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.17278099060058594  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.29013442993164  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.290154457092285  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.19124746322631836  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.462652683258057  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.462672710418701  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.20999526977539062  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.489716053009033  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.489736080169678  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.2304668426513672  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.572847843170166  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.57286787033081  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.24982643127441406  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.507721424102783  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.507741451263428  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.26868772506713867  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.569476127624512  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.569496154785156  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.28639888763427734  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.428932189941406  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.42895221710205  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.3046722412109375  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.423569202423096  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.42358922958374  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.32314300537109375  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.497518062591553  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.497538089752197  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.3412919044494629  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.64677906036377  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.646799087524414  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.35743236541748047  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.39333963394165  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.393359661102295  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.37932872772216797  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.75796890258789  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.757988929748535  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.396270751953125  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.65438175201416  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.654401779174805  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.41529321670532227  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.51493787765503  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.514957904815674  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.4321589469909668  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.629281997680664  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.629302024841309  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.4509429931640625  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.677784442901611  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.677804470062256  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.4679107666015625  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.702085971832275  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.70210599899292  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.48644208908081055  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.890949249267578  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.890969276428223  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.5042057037353516  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.794131755828857  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.794151782989502  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.5233898162841797  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.811342716217041  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.811362743377686  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.5395588874816895  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.768794059753418  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.768814086914062  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.5587549209594727  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.912096977233887  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.912117004394531  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.5755715370178223  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.683465957641602  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.683485984802246  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.5955166816711426  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.859180450439453  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.859200477600098  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.6135854721069336  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.894780158996582  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.894800186157227  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.6313958168029785  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.822142124176025  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.82216215133667  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.6513495445251465  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 12.030014514923096  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 12.03003454208374  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.6699881553649902  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.965271949768066  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.965291976928711  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.6890926361083984  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.941421031951904  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.941441059112549  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.7068052291870117  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.795822143554688  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.795842170715332  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.7290849685668945  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 12.167692184448242  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 12.167712211608887  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.7469058036804199  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.922819137573242  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.922839164733887  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.7632794380187988  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.883035659790039  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.883055686950684  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.7839875221252441  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 12.116141319274902  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 12.116161346435547  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.7998366355895996  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.469143390655518  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 11.469161033630371  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.3388671875 GB
    Memory Allocated: 0.8178210258483887  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.15229961276054382
pure train time :  16.15588903427124
train time :  19.39047932624817
end to end time :  78.89860796928406
connection check time:  37.95707178115845
block generation time  20.752784967422485
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  261
len(bkt)  300
len(bkt)  273
len(bkt)  261
len(bkt)  231
len(bkt)  200
len(bkt)  226
len(bkt)  196
len(bkt)  186
len(bkt)  200
len(bkt)  5145
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  40
the grouping_fanout_arxiv called successfully
capacity  1599
 
sorted_dict  {37: 1503, 33: 1491, 29: 1490, 34: 1489, 36: 1466, 35: 1429, 38: 1401, 32: 1387, 31: 1378, 30: 1326, 28: 1319, 25: 1275, 27: 1261, 26: 1247, 22: 1188, 21: 1150, 23: 1144, 24: 1137, 0: 1065, 20: 1022, 18: 997, 19: 969, 17: 947, 16: 930, 15: 918, 14: 870, 13: 851, 12: 810, 11: 771, 10: 738, 1: 714, 9: 708, 8: 690, 7: 665, 6: 655, 5: 641, 2: 637, 3: 622, 4: 603}

weights after sort [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
res_tmp  [930 665]

remove bucket_id:  [23, 33]
original bucket_id :,  [16, 7]
remove weights:  [930 665], 		------------sum 1595

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
res_tmp  [969 622]

remove bucket_id:  [21, 35]
original bucket_id :,  [19, 3]
remove weights:  [969 622], 		------------sum 1591

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [851 738]

remove bucket_id:  [24, 27]
original bucket_id :,  [13, 10]
remove weights:  [851 738], 		------------sum 1589

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [947 641]

remove bucket_id:  [21, 30]
original bucket_id :,  [17, 5]
remove weights:  [947 641], 		------------sum 1588

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
res_tmp  [870 714]

remove bucket_id:  [22, 25]
original bucket_id :,  [14, 1]
remove weights:  [870 714], 		------------sum 1584

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
res_tmp  [810 771]

remove bucket_id:  [22, 23]
original bucket_id :,  [12, 11]
remove weights:  [810 771], 		------------sum 1581

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
res_tmp  [918 655]

remove bucket_id:  [21, 24]
original bucket_id :,  [15, 6]
remove weights:  [918 655], 		------------sum 1573

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1503]

remove bucket_id:  [0]
original bucket_id :,  [37]
remove weights:  [1503], 		------------sum 1503

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1491]

remove bucket_id:  [0]
original bucket_id :,  [33]
remove weights:  [1491], 		------------sum 1491

before remove weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1490]

remove bucket_id:  [0]
original bucket_id :,  [29]
remove weights:  [1490], 		------------sum 1490

before remove weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1489]

remove bucket_id:  [0]
original bucket_id :,  [34]
remove weights:  [1489], 		------------sum 1489

before remove weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1466]

remove bucket_id:  [0]
original bucket_id :,  [36]
remove weights:  [1466], 		------------sum 1466

before remove weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [35]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1401]

remove bucket_id:  [0]
original bucket_id :,  [38]
remove weights:  [1401], 		------------sum 1401

before remove weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [708 690]

remove bucket_id:  [14, 15]
original bucket_id :,  [9, 8]
remove weights:  [708 690], 		------------sum 1398

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1387]

remove bucket_id:  [0]
original bucket_id :,  [32]
remove weights:  [1387], 		------------sum 1387

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1378]

remove bucket_id:  [0]
original bucket_id :,  [31]
remove weights:  [1378], 		------------sum 1378

before remove weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1326]

remove bucket_id:  [0]
original bucket_id :,  [30]
remove weights:  [1326], 		------------sum 1326

before remove weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1319]

remove bucket_id:  [0]
original bucket_id :,  [28]
remove weights:  [1319], 		------------sum 1319

before remove weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1275]

remove bucket_id:  [0]
original bucket_id :,  [25]
remove weights:  [1275], 		------------sum 1275

before remove weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1261]

remove bucket_id:  [0]
original bucket_id :,  [27]
remove weights:  [1261], 		------------sum 1261

before remove weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1247]

remove bucket_id:  [0]
original bucket_id :,  [26]
remove weights:  [1247], 		------------sum 1247

before remove weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [637 603]

remove bucket_id:  [7, 8]
original bucket_id :,  [2, 4]
remove weights:  [637 603], 		------------sum 1240

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1188]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1188], 		------------sum 1188

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1150]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [1150], 		------------sum 1150

before remove weights,  [1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1144, 1137, 1065, 1022, 997]
res_tmp  [1144]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1144], 		------------sum 1144

before remove weights,  [1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1137, 1065, 1022, 997]
res_tmp  [1137]

remove bucket_id:  [0]
original bucket_id :,  [24]
remove weights:  [1137], 		------------sum 1137

before remove weights,  [1137, 1065, 1022, 997]
after remove pre pack weights,  [1065, 1022, 997]
res_tmp  [1065]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1065], 		------------sum 1065

before remove weights,  [1065, 1022, 997]
after remove pre pack weights,  [1022, 997]
res_tmp  [1022]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1022], 		------------sum 1022

before remove weights,  [1022, 997]
after remove pre pack weights,  [997]
the last batch value is  997
G_BUCKET_ID_list [[16, 7], [19, 3], [13, 10], [17, 5], [14, 1], [12, 11], [15, 6], [37], [33], [29], [34], [36], [35], [38], [9, 8], [32], [31], [30], [28], [25], [27], [26], [2, 4], [22], [21], [23], [24], [0], [20], [18]]
Groups_mem_list  [[930, 665], [969, 622], [851, 738], [947, 641], [870, 714], [810, 771], [918, 655], [1503], [1491], [1490], [1489], [1466], [1429], [1401], [708, 690], [1387], [1378], [1326], [1319], [1275], [1261], [1247], [637, 603], [1188], [1150], [1144], [1137], [1065], [1022], [997], [997]]
G_BUCKET_ID_list length 30
backpack scheduling spend  0.9749140739440918
len(g_bucket_nids_list)  30
len(local_split_batches_nid_list)  40
current group_mem  1.596117937663403
current group_mem  1.5921340399311468
current group_mem  1.589870625764705
current group_mem  1.5891473550971833
current group_mem  1.5857603736084847
current group_mem  1.5820095418574445
current group_mem  1.5734293513806403
current group_mem  1.503098849221118
current group_mem  1.4919510315025555
current group_mem  1.4902377010672119
current group_mem  1.489771218355281
current group_mem  1.4669528399603706
current group_mem  1.4299614653289316
current group_mem  1.4019953464128971
current group_mem  1.398786105658422
current group_mem  1.3877983983820137
current group_mem  1.378120696771145
current group_mem  1.3265526451140681
current group_mem  1.3195097810560623
current group_mem  1.275594926541009
current group_mem  1.261519346948089
current group_mem  1.247374740324102
current group_mem  1.240614376707236
current group_mem  1.1887666153577383
current group_mem  1.1507276274635794
current group_mem  1.1445336375167028
current group_mem  1.1373269469250744
current group_mem  1.065213040461425
current group_mem  1.0222163350143478
current group_mem  0.9979639436230555
batches output list generation spend  0.0007989406585693359
self.weights_list  [0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.0012535600004398456]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021311044692993164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.9760386943817139
len local_batched_seeds_list  40
partition total batch output list spend :  1.6887023448944092
self.buckets_partition() spend  sec:  0.997398853302002
layer  0
 the number of batches:  40
check_connections_block*********************************

the find indices time spent  0.04754209518432617

in edges time spent  0.04915261268615723
local to global src and eids time spent  0.1322953701019287
time gen tails  0.025294065475463867
res  length 40
layer  1
num of batch  40
check_connections_block*********************************

the find indices time spent  0.06442832946777344

in edges time spent  0.781740665435791
local to global src and eids time spent  0.7931175231933594
time gen tails  0.20363616943359375
res  length 40
layer  2
num of batch  40
check_connections_block*********************************

the find indices time spent  0.26682281494140625

in edges time spent  4.873743295669556
local to global src and eids time spent  6.992132663726807
time gen tails  0.7644927501678467
res  length 40
layer  3
num of batch  40
check_connections_block*********************************

the find indices time spent  0.6238746643066406

in edges time spent  6.624017953872681
local to global src and eids time spent  4.822564125061035
time gen tails  0.7549962997436523
res  length 40
block collection to dataloader spend  4.935264587402344e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.09730291366577148  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.2445387840271  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.226878643035889  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.09905385971069336  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.48671817779541  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.486738204956055  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.11932802200317383  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.401960372924805  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.40198040008545  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.13917970657348633  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.457133769989014  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.457153797149658  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.1583104133605957  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.356613159179688  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.356633186340332  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.17852449417114258  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.56270980834961  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.562729835510254  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.19681835174560547  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.372405052185059  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.372425079345703  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.21873998641967773  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.612302780151367  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.612322807312012  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.23572206497192383  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.608765602111816  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.608785629272461  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.2542304992675781  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.486230373382568  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.486250400543213  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.2711520195007324  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.564109325408936  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.56412935256958  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.29166364669799805  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.669817924499512  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.669837951660156  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.3058948516845703  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.371784210205078  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.371804237365723  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.3279690742492676  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.532709121704102  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.532729148864746  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.34416818618774414  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.685641765594482  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.685661792755127  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.3635740280151367  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.643510818481445  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.64353084564209  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.37858104705810547  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.327855587005615  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.32787561416626  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.4012918472290039  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.898518562316895  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.898538589477539  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.4181818962097168  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.624598503112793  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 11.624618530273438  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.99609375 GB
    Memory Allocated: 0.44147348403930664  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.918508052825928  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.918528079986572  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.45844221115112305  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.92347526550293  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.923495292663574  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.47716236114501953  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.660335540771484  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.660355567932129  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.4945831298828125  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.73407506942749  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.734095096588135  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.5145525932312012  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.836009502410889  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.836029529571533  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.5328407287597656  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.890172004699707  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.890192031860352  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.552060604095459  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.985964298248291  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.985984325408936  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.5679106712341309  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.816448211669922  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.816468238830566  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.5881123542785645  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.746399402618408  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.746419429779053  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.6059060096740723  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.86976671218872  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.869786739349365  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.6252365112304688  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.940987586975098  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.941007614135742  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.645566463470459  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.089142322540283  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.089162349700928  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.6617660522460938  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.884523868560791  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.884543895721436  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.6823678016662598  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.012048721313477  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.012068748474121  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.7007083892822266  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.91287899017334  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.912899017333984  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.7164192199707031  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.01367712020874  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.013697147369385  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.7357196807861328  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.906153202056885  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.90617322921753  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.7548861503601074  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.789751529693604  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.789771556854248  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.7713956832885742  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.073963642120361  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.073983669281006  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.7900915145874023  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.871096134185791  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.871116161346436  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.8054633140563965  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.448071956634521  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.448089599609375  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.8231735229492188  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.14608219265937805
pure train time :  16.209495544433594
train time :  19.594022035598755
end to end time :  71.80540156364441
connection check time:  33.139204025268555
block generation time  17.348305702209473
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  261
len(bkt)  300
len(bkt)  273
len(bkt)  261
len(bkt)  231
len(bkt)  200
len(bkt)  226
len(bkt)  196
len(bkt)  186
len(bkt)  200
len(bkt)  5145
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  40
the grouping_fanout_arxiv called successfully
capacity  1599
 
sorted_dict  {37: 1503, 33: 1491, 29: 1490, 34: 1489, 36: 1466, 35: 1429, 38: 1401, 32: 1387, 31: 1378, 30: 1326, 28: 1319, 25: 1275, 27: 1261, 26: 1247, 22: 1188, 21: 1150, 23: 1144, 24: 1137, 0: 1065, 20: 1022, 18: 997, 19: 969, 17: 947, 16: 930, 15: 918, 14: 870, 13: 851, 12: 810, 11: 771, 10: 738, 1: 714, 9: 708, 8: 690, 7: 665, 6: 655, 5: 641, 2: 637, 3: 622, 4: 603}

weights after sort [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
res_tmp  [930 665]

remove bucket_id:  [23, 33]
original bucket_id :,  [16, 7]
remove weights:  [930 665], 		------------sum 1595

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
res_tmp  [969 622]

remove bucket_id:  [21, 35]
original bucket_id :,  [19, 3]
remove weights:  [969 622], 		------------sum 1591

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [851 738]

remove bucket_id:  [24, 27]
original bucket_id :,  [13, 10]
remove weights:  [851 738], 		------------sum 1589

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [947 641]

remove bucket_id:  [21, 30]
original bucket_id :,  [17, 5]
remove weights:  [947 641], 		------------sum 1588

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
res_tmp  [870 714]

remove bucket_id:  [22, 25]
original bucket_id :,  [14, 1]
remove weights:  [870 714], 		------------sum 1584

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
res_tmp  [810 771]

remove bucket_id:  [22, 23]
original bucket_id :,  [12, 11]
remove weights:  [810 771], 		------------sum 1581

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
res_tmp  [918 655]

remove bucket_id:  [21, 24]
original bucket_id :,  [15, 6]
remove weights:  [918 655], 		------------sum 1573

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1503]

remove bucket_id:  [0]
original bucket_id :,  [37]
remove weights:  [1503], 		------------sum 1503

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1491]

remove bucket_id:  [0]
original bucket_id :,  [33]
remove weights:  [1491], 		------------sum 1491

before remove weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1490]

remove bucket_id:  [0]
original bucket_id :,  [29]
remove weights:  [1490], 		------------sum 1490

before remove weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1489]

remove bucket_id:  [0]
original bucket_id :,  [34]
remove weights:  [1489], 		------------sum 1489

before remove weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1466]

remove bucket_id:  [0]
original bucket_id :,  [36]
remove weights:  [1466], 		------------sum 1466

before remove weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [35]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1401]

remove bucket_id:  [0]
original bucket_id :,  [38]
remove weights:  [1401], 		------------sum 1401

before remove weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [708 690]

remove bucket_id:  [14, 15]
original bucket_id :,  [9, 8]
remove weights:  [708 690], 		------------sum 1398

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1387]

remove bucket_id:  [0]
original bucket_id :,  [32]
remove weights:  [1387], 		------------sum 1387

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1378]

remove bucket_id:  [0]
original bucket_id :,  [31]
remove weights:  [1378], 		------------sum 1378

before remove weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1326]

remove bucket_id:  [0]
original bucket_id :,  [30]
remove weights:  [1326], 		------------sum 1326

before remove weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1319]

remove bucket_id:  [0]
original bucket_id :,  [28]
remove weights:  [1319], 		------------sum 1319

before remove weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1275]

remove bucket_id:  [0]
original bucket_id :,  [25]
remove weights:  [1275], 		------------sum 1275

before remove weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1261]

remove bucket_id:  [0]
original bucket_id :,  [27]
remove weights:  [1261], 		------------sum 1261

before remove weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1247]

remove bucket_id:  [0]
original bucket_id :,  [26]
remove weights:  [1247], 		------------sum 1247

before remove weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [637 603]

remove bucket_id:  [7, 8]
original bucket_id :,  [2, 4]
remove weights:  [637 603], 		------------sum 1240

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1188]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1188], 		------------sum 1188

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1150]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [1150], 		------------sum 1150

before remove weights,  [1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1144, 1137, 1065, 1022, 997]
res_tmp  [1144]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1144], 		------------sum 1144

before remove weights,  [1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1137, 1065, 1022, 997]
res_tmp  [1137]

remove bucket_id:  [0]
original bucket_id :,  [24]
remove weights:  [1137], 		------------sum 1137

before remove weights,  [1137, 1065, 1022, 997]
after remove pre pack weights,  [1065, 1022, 997]
res_tmp  [1065]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1065], 		------------sum 1065

before remove weights,  [1065, 1022, 997]
after remove pre pack weights,  [1022, 997]
res_tmp  [1022]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1022], 		------------sum 1022

before remove weights,  [1022, 997]
after remove pre pack weights,  [997]
the last batch value is  997
G_BUCKET_ID_list [[16, 7], [19, 3], [13, 10], [17, 5], [14, 1], [12, 11], [15, 6], [37], [33], [29], [34], [36], [35], [38], [9, 8], [32], [31], [30], [28], [25], [27], [26], [2, 4], [22], [21], [23], [24], [0], [20], [18]]
Groups_mem_list  [[930, 665], [969, 622], [851, 738], [947, 641], [870, 714], [810, 771], [918, 655], [1503], [1491], [1490], [1489], [1466], [1429], [1401], [708, 690], [1387], [1378], [1326], [1319], [1275], [1261], [1247], [637, 603], [1188], [1150], [1144], [1137], [1065], [1022], [997], [997]]
G_BUCKET_ID_list length 30
backpack scheduling spend  0.978785514831543
len(g_bucket_nids_list)  30
len(local_split_batches_nid_list)  40
current group_mem  1.596117937663403
current group_mem  1.5921340399311468
current group_mem  1.589870625764705
current group_mem  1.5891473550971833
current group_mem  1.5857603736084847
current group_mem  1.5820095418574445
current group_mem  1.5734293513806403
current group_mem  1.503098849221118
current group_mem  1.4919510315025555
current group_mem  1.4902377010672119
current group_mem  1.489771218355281
current group_mem  1.4669528399603706
current group_mem  1.4299614653289316
current group_mem  1.4019953464128971
current group_mem  1.398786105658422
current group_mem  1.3877983983820137
current group_mem  1.378120696771145
current group_mem  1.3265526451140681
current group_mem  1.3195097810560623
current group_mem  1.275594926541009
current group_mem  1.261519346948089
current group_mem  1.247374740324102
current group_mem  1.240614376707236
current group_mem  1.1887666153577383
current group_mem  1.1507276274635794
current group_mem  1.1445336375167028
current group_mem  1.1373269469250744
current group_mem  1.065213040461425
current group_mem  1.0222163350143478
current group_mem  0.9979639436230555
batches output list generation spend  0.0008401870727539062
self.weights_list  [0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.0012535600004398456]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.021688222885131836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.9799761772155762
len local_batched_seeds_list  40
partition total batch output list spend :  1.8197669982910156
self.buckets_partition() spend  sec:  1.0017130374908447
layer  0
 the number of batches:  40
check_connections_block*********************************

the find indices time spent  0.05953073501586914

in edges time spent  0.035832881927490234
local to global src and eids time spent  0.05831146240234375
time gen tails  0.01659083366394043
res  length 40
layer  1
num of batch  40
check_connections_block*********************************

the find indices time spent  0.04252266883850098

in edges time spent  0.8234624862670898
local to global src and eids time spent  1.4084746837615967
time gen tails  0.24006199836730957
res  length 40
layer  2
num of batch  40
check_connections_block*********************************

the find indices time spent  0.27073097229003906

in edges time spent  5.004315614700317
local to global src and eids time spent  8.381950616836548
time gen tails  0.7907078266143799
res  length 40
layer  3
num of batch  40
check_connections_block*********************************

the find indices time spent  0.6306746006011963

in edges time spent  6.650487661361694
local to global src and eids time spent  6.8774330615997314
time gen tails  0.794100284576416
res  length 40
block collection to dataloader spend  0.000133514404296875
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.09811115264892578  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.548734188079834  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.531140327453613  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.09875297546386719  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.316857814788818  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.316877841949463  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.11791849136352539  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.354780673980713  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.354800701141357  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.13544321060180664  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.416489124298096  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.41650915145874  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.15771102905273438  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.62231731414795  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.622337341308594  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.17605113983154297  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.321930885314941  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.321950912475586  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.19618558883666992  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.494487285614014  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.494507312774658  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.21456098556518555  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.443402767181396  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.443422794342041  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.2332172393798828  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.385411739349365  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.38543176651001  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.25295209884643555  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.538951396942139  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.538971424102783  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.27273130416870117  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.76124620437622  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.761266231536865  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.2899646759033203  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.471294403076172  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.471314430236816  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.310636043548584  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.5570387840271  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.557058811187744  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.3298192024230957  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.671629428863525  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.67164945602417  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.3477301597595215  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.526320457458496  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.52634048461914  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.36592721939086914  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.516393661499023  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.516413688659668  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.38494300842285156  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.65198040008545  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.652000427246094  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.4062051773071289  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.899604797363281  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.899624824523926  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.42198801040649414  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.54816198348999  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.548182010650635  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.4411592483520508  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.872291564941406  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.87231159210205  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.45995521545410156  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.704728603363037  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.704748630523682  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.4791555404663086  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.807878494262695  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.80789852142334  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.4953470230102539  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.653905391693115  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.65392541885376  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.5146398544311523  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.950482845306396  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.950502872467041  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.5345535278320312  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.888604640960693  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.888624668121338  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.5535392761230469  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.03055191040039  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.030571937561035  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.5735516548156738  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.048420906066895  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.048440933227539  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.5917177200317383  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.971635341644287  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.971655368804932  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.6108064651489258  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.064034938812256  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.0640549659729  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.6292104721069336  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.733923435211182  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.733943462371826  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.6521801948547363  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.957988262176514  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.958008289337158  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.6711544990539551  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.974627494812012  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.974647521972656  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  32
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.6921281814575195  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.034452438354492  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.034472465515137  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  33
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.7099857330322266  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.776875972747803  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.776895999908447  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  34
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.7293024063110352  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.971577644348145  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.971597671508789  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  35
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.7457151412963867  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.665368556976318  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.665388584136963  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  36
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.7635622024536133  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.981255531311035  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.98127555847168  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  37
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.7829718589782715  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.21471118927002  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.214731216430664  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  38
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.8020987510681152  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.02988576889038  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 12.029905796051025  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

step  39
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.8195805549621582  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.42965316772461  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 11.429670810699463  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 20.369140625 GB
    Memory Allocated: 0.8373794555664062  GigaBytes
Max Memory Allocated: 12.327102184295654  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.14003515243530273
pure train time :  16.761487007141113
train time :  20.116778135299683
end to end time :  76.92936706542969
connection check time:  37.594367265701294
block generation time  17.367550373077393
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  261
len(bkt)  300
len(bkt)  273
len(bkt)  261
len(bkt)  231
len(bkt)  200
len(bkt)  226
len(bkt)  196
len(bkt)  186
len(bkt)  200
len(bkt)  5145
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  40
the grouping_fanout_arxiv called successfully
capacity  1599
 
sorted_dict  {37: 1503, 33: 1491, 29: 1490, 34: 1489, 36: 1466, 35: 1429, 38: 1401, 32: 1387, 31: 1378, 30: 1326, 28: 1319, 25: 1275, 27: 1261, 26: 1247, 22: 1188, 21: 1150, 23: 1144, 24: 1137, 0: 1065, 20: 1022, 18: 997, 19: 969, 17: 947, 16: 930, 15: 918, 14: 870, 13: 851, 12: 810, 11: 771, 10: 738, 1: 714, 9: 708, 8: 690, 7: 665, 6: 655, 5: 641, 2: 637, 3: 622, 4: 603}

weights after sort [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
res_tmp  [930 665]

remove bucket_id:  [23, 33]
original bucket_id :,  [16, 7]
remove weights:  [930 665], 		------------sum 1595

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 930, 918, 870, 851, 810, 771, 738, 714, 708, 690, 665, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
res_tmp  [969 622]

remove bucket_id:  [21, 35]
original bucket_id :,  [19, 3]
remove weights:  [969 622], 		------------sum 1591

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 969, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 622, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [851 738]

remove bucket_id:  [24, 27]
original bucket_id :,  [13, 10]
remove weights:  [851 738], 		------------sum 1589

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 851, 810, 771, 738, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
res_tmp  [947 641]

remove bucket_id:  [21, 30]
original bucket_id :,  [17, 5]
remove weights:  [947 641], 		------------sum 1588

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 947, 918, 870, 810, 771, 714, 708, 690, 655, 641, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
res_tmp  [870 714]

remove bucket_id:  [22, 25]
original bucket_id :,  [14, 1]
remove weights:  [870 714], 		------------sum 1584

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 870, 810, 771, 714, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
res_tmp  [810 771]

remove bucket_id:  [22, 23]
original bucket_id :,  [12, 11]
remove weights:  [810 771], 		------------sum 1581

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 810, 771, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
res_tmp  [918 655]

remove bucket_id:  [21, 24]
original bucket_id :,  [15, 6]
remove weights:  [918 655], 		------------sum 1573

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 918, 708, 690, 655, 637, 603]
after remove pre pack weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1503]

remove bucket_id:  [0]
original bucket_id :,  [37]
remove weights:  [1503], 		------------sum 1503

before remove weights,  [1503, 1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1491]

remove bucket_id:  [0]
original bucket_id :,  [33]
remove weights:  [1491], 		------------sum 1491

before remove weights,  [1491, 1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1490]

remove bucket_id:  [0]
original bucket_id :,  [29]
remove weights:  [1490], 		------------sum 1490

before remove weights,  [1490, 1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1489]

remove bucket_id:  [0]
original bucket_id :,  [34]
remove weights:  [1489], 		------------sum 1489

before remove weights,  [1489, 1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1466]

remove bucket_id:  [0]
original bucket_id :,  [36]
remove weights:  [1466], 		------------sum 1466

before remove weights,  [1466, 1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [35]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [1401]

remove bucket_id:  [0]
original bucket_id :,  [38]
remove weights:  [1401], 		------------sum 1401

before remove weights,  [1401, 1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
res_tmp  [708 690]

remove bucket_id:  [14, 15]
original bucket_id :,  [9, 8]
remove weights:  [708 690], 		------------sum 1398

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 708, 690, 637, 603]
after remove pre pack weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1387]

remove bucket_id:  [0]
original bucket_id :,  [32]
remove weights:  [1387], 		------------sum 1387

before remove weights,  [1387, 1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1378]

remove bucket_id:  [0]
original bucket_id :,  [31]
remove weights:  [1378], 		------------sum 1378

before remove weights,  [1378, 1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1326]

remove bucket_id:  [0]
original bucket_id :,  [30]
remove weights:  [1326], 		------------sum 1326

before remove weights,  [1326, 1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1319]

remove bucket_id:  [0]
original bucket_id :,  [28]
remove weights:  [1319], 		------------sum 1319

before remove weights,  [1319, 1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1275]

remove bucket_id:  [0]
original bucket_id :,  [25]
remove weights:  [1275], 		------------sum 1275

before remove weights,  [1275, 1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1261]

remove bucket_id:  [0]
original bucket_id :,  [27]
remove weights:  [1261], 		------------sum 1261

before remove weights,  [1261, 1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [1247]

remove bucket_id:  [0]
original bucket_id :,  [26]
remove weights:  [1247], 		------------sum 1247

before remove weights,  [1247, 1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
res_tmp  [637 603]

remove bucket_id:  [7, 8]
original bucket_id :,  [2, 4]
remove weights:  [637 603], 		------------sum 1240

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997, 637, 603]
after remove pre pack weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1188]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1188], 		------------sum 1188

before remove weights,  [1188, 1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1150, 1144, 1137, 1065, 1022, 997]
res_tmp  [1150]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [1150], 		------------sum 1150

before remove weights,  [1150, 1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1144, 1137, 1065, 1022, 997]
res_tmp  [1144]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1144], 		------------sum 1144

before remove weights,  [1144, 1137, 1065, 1022, 997]
after remove pre pack weights,  [1137, 1065, 1022, 997]
res_tmp  [1137]

remove bucket_id:  [0]
original bucket_id :,  [24]
remove weights:  [1137], 		------------sum 1137

before remove weights,  [1137, 1065, 1022, 997]
after remove pre pack weights,  [1065, 1022, 997]
res_tmp  [1065]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1065], 		------------sum 1065

before remove weights,  [1065, 1022, 997]
after remove pre pack weights,  [1022, 997]
res_tmp  [1022]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1022], 		------------sum 1022

before remove weights,  [1022, 997]
after remove pre pack weights,  [997]
the last batch value is  997
G_BUCKET_ID_list [[16, 7], [19, 3], [13, 10], [17, 5], [14, 1], [12, 11], [15, 6], [37], [33], [29], [34], [36], [35], [38], [9, 8], [32], [31], [30], [28], [25], [27], [26], [2, 4], [22], [21], [23], [24], [0], [20], [18]]
Groups_mem_list  [[930, 665], [969, 622], [851, 738], [947, 641], [870, 714], [810, 771], [918, 655], [1503], [1491], [1490], [1489], [1466], [1429], [1401], [708, 690], [1387], [1378], [1326], [1319], [1275], [1261], [1247], [637, 603], [1188], [1150], [1144], [1137], [1065], [1022], [997], [997]]
G_BUCKET_ID_list length 30
backpack scheduling spend  0.9732482433319092
len(g_bucket_nids_list)  30
len(local_split_batches_nid_list)  40
current group_mem  1.596117937663403
current group_mem  1.5921340399311468
current group_mem  1.589870625764705
current group_mem  1.5891473550971833
current group_mem  1.5857603736084847
current group_mem  1.5820095418574445
current group_mem  1.5734293513806403
current group_mem  1.503098849221118
current group_mem  1.4919510315025555
current group_mem  1.4902377010672119
current group_mem  1.489771218355281
current group_mem  1.4669528399603706
current group_mem  1.4299614653289316
current group_mem  1.4019953464128971
current group_mem  1.398786105658422
current group_mem  1.3877983983820137
current group_mem  1.378120696771145
current group_mem  1.3265526451140681
current group_mem  1.3195097810560623
current group_mem  1.275594926541009
current group_mem  1.261519346948089
current group_mem  1.247374740324102
current group_mem  1.240614376707236
current group_mem  1.1887666153577383
current group_mem  1.1507276274635794
current group_mem  1.1445336375167028
current group_mem  1.1373269469250744
current group_mem  1.065213040461425
current group_mem  1.0222163350143478
current group_mem  0.9979639436230555
batches output list generation spend  0.0007703304290771484
self.weights_list  [0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.001418502105760878, 0.0012535600004398456]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.022289514541625977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.974337100982666
len local_batched_seeds_list  40
partition total batch output list spend :  1.7912344932556152
self.buckets_partition() spend  sec:  0.9966719150543213
layer  0
 the number of batches:  40
check_connections_block*********************************

the find indices time spent  0.037003517150878906

in edges time spent  0.030631303787231445
local to global src and eids time spent  0.13893651962280273
time gen tails  0.028604507446289062
res  length 40
layer  1
num of batch  40
check_connections_block*********************************

the find indices time spent  0.07055950164794922

in edges time spent  0.9196546077728271
local to global src and eids time spent  0.9412517547607422
time gen tails  0.2033984661102295
res  length 40
layer  2
num of batch  40
check_connections_block*********************************

the find indices time spent  0.2710146903991699

in edges time spent  5.0417211055755615
local to global src and eids time spent  8.14382815361023
time gen tails  0.8019907474517822
res  length 40
layer  3
num of batch  40
check_connections_block*********************************

the find indices time spent  0.6306948661804199

in edges time spent  6.708366632461548
