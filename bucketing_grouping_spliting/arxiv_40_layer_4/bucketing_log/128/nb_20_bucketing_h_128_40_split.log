main start at this time 1690357571.1217518
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  261
len(bkt)  300
len(bkt)  273
len(bkt)  261
len(bkt)  231
len(bkt)  200
len(bkt)  226
len(bkt)  196
len(bkt)  186
len(bkt)  200
len(bkt)  5145
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
G_BUCKET_ID_list length 39
len(g_bucket_nids_list)  39
len(local_split_batches_nid_list)  20
current group_mem  7.541331259903894
current group_mem  5.061138357277836
current group_mem  4.513941983252465
current group_mem  4.405460822207029
current group_mem  4.269168648303187
current group_mem  4.541026571222084
current group_mem  4.639840638519238
current group_mem  4.713729125862847
current group_mem  4.886536553059854
current group_mem  5.016373929477647
current group_mem  5.22704385630489
current group_mem  5.463201338689721
current group_mem  5.736866214283334
current group_mem  6.0286773880470035
current group_mem  6.165483756764532
current group_mem  6.499482203113614
current group_mem  6.586220875293987
current group_mem  6.709574172828771
current group_mem  7.0652314592782695
current group_mem  6.866284593234719
current group_mem  7.236929805411312
current group_mem  8.14674426522888
current group_mem  8.416046834391066
current group_mem  8.102893008967808
current group_mem  8.051872190619996
current group_mem  9.03076054188325
current group_mem  8.830971612913995
current group_mem  8.931110420871427
current group_mem  9.341662166768582
current group_mem  10.55035540578557
current group_mem  9.39152315125004
current group_mem  9.756606702804566
current group_mem  9.825121404474434
current group_mem  10.562485178779154
current group_mem  10.547052873311724
current group_mem  10.123620993479163
current group_mem  10.385506831577846
current group_mem  10.64140778209641
current group_mem  9.925630771064759
batches output list generation spend  0.0010943412780761719
self.weights_list  [0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.002837004211521756, 0.0026720621062007234]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.020087718963623047
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3470027446746826
len local_batched_seeds_list  20
partition total batch output list spend :  0.8311917781829834
self.buckets_partition() spend  sec:  0.3671238422393799
layer  0
 the number of batches:  20
check_connections_block*********************************

the find indices time spent  0.035985708236694336

in edges time spent  0.0423886775970459
local to global src and eids time spent  0.10386443138122559
time gen tails  0.025765657424926758
res  length 20
layer  1
num of batch  20
check_connections_block*********************************

the find indices time spent  0.0686347484588623

in edges time spent  0.7140638828277588
local to global src and eids time spent  1.402911901473999
time gen tails  0.18445396423339844
res  length 20
layer  2
num of batch  20
check_connections_block*********************************

the find indices time spent  0.20881891250610352

in edges time spent  3.370488405227661
local to global src and eids time spent  5.293912649154663
time gen tails  0.44910407066345215
res  length 20
layer  3
num of batch  20
check_connections_block*********************************

the find indices time spent  0.37876176834106445

in edges time spent  3.5291311740875244
local to global src and eids time spent  5.626157283782959
time gen tails  0.6926155090332031
res  length 20
block collection to dataloader spend  6.985664367675781e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.51953125 GB
    Memory Allocated: 0.08112859725952148  GigaBytes
Max Memory Allocated: 0.08112859725952148  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.37890625 GB
    Memory Allocated: 14.405905723571777  GigaBytes
Max Memory Allocated: 14.463133335113525  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.37890625 GB
    Memory Allocated: 14.405945301055908  GigaBytes
Max Memory Allocated: 14.463133335113525  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.234375 GB
    Memory Allocated: 0.11022329330444336  GigaBytes
Max Memory Allocated: 14.463133335113525  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.66015625 GB
    Memory Allocated: 14.527632236480713  GigaBytes
Max Memory Allocated: 14.584073543548584  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.66015625 GB
    Memory Allocated: 14.527671337127686  GigaBytes
Max Memory Allocated: 14.584073543548584  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.51171875 GB
    Memory Allocated: 0.13563919067382812  GigaBytes
Max Memory Allocated: 14.584073543548584  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.51953125 GB
    Memory Allocated: 14.329947471618652  GigaBytes
Max Memory Allocated: 14.584073543548584  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.51953125 GB
    Memory Allocated: 14.329986572265625  GigaBytes
Max Memory Allocated: 14.584073543548584  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.521484375 GB
    Memory Allocated: 0.1609492301940918  GigaBytes
Max Memory Allocated: 14.584073543548584  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.5234375 GB
    Memory Allocated: 14.498639106750488  GigaBytes
Max Memory Allocated: 14.584073543548584  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.5234375 GB
    Memory Allocated: 14.498678207397461  GigaBytes
Max Memory Allocated: 14.584073543548584  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.5234375 GB
    Memory Allocated: 0.1883068084716797  GigaBytes
Max Memory Allocated: 14.584073543548584  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.5234375 GB
    Memory Allocated: 14.577603816986084  GigaBytes
Max Memory Allocated: 14.634175300598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.5234375 GB
    Memory Allocated: 14.577642917633057  GigaBytes
Max Memory Allocated: 14.634175300598145  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.525390625 GB
    Memory Allocated: 0.2120814323425293  GigaBytes
Max Memory Allocated: 14.634175300598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.525390625 GB
    Memory Allocated: 14.172935962677002  GigaBytes
Max Memory Allocated: 14.634175300598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.525390625 GB
    Memory Allocated: 14.172975063323975  GigaBytes
Max Memory Allocated: 14.634175300598145  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.525390625 GB
    Memory Allocated: 0.24009180068969727  GigaBytes
Max Memory Allocated: 14.634175300598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.525390625 GB
    Memory Allocated: 14.456682205200195  GigaBytes
Max Memory Allocated: 14.634175300598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.525390625 GB
    Memory Allocated: 14.456721305847168  GigaBytes
Max Memory Allocated: 14.634175300598145  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.525390625 GB
    Memory Allocated: 0.2652111053466797  GigaBytes
Max Memory Allocated: 14.634175300598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.548828125 GB
    Memory Allocated: 14.521102905273438  GigaBytes
Max Memory Allocated: 14.634175300598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.548828125 GB
    Memory Allocated: 14.52114200592041  GigaBytes
Max Memory Allocated: 14.634175300598145  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.55078125 GB
    Memory Allocated: 0.29024839401245117  GigaBytes
Max Memory Allocated: 14.634175300598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.978515625 GB
    Memory Allocated: 14.677414894104004  GigaBytes
Max Memory Allocated: 14.735879898071289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.978515625 GB
    Memory Allocated: 14.677453994750977  GigaBytes
Max Memory Allocated: 14.735879898071289  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.833984375 GB
    Memory Allocated: 0.3146219253540039  GigaBytes
Max Memory Allocated: 14.735879898071289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.833984375 GB
    Memory Allocated: 14.517970085144043  GigaBytes
Max Memory Allocated: 14.735879898071289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.833984375 GB
    Memory Allocated: 14.518009185791016  GigaBytes
Max Memory Allocated: 14.735879898071289  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.833984375 GB
    Memory Allocated: 0.3414573669433594  GigaBytes
Max Memory Allocated: 14.735879898071289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.841796875 GB
    Memory Allocated: 14.83467721939087  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.841796875 GB
    Memory Allocated: 14.834716320037842  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.841796875 GB
    Memory Allocated: 0.36743927001953125  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.841796875 GB
    Memory Allocated: 14.466678142547607  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.841796875 GB
    Memory Allocated: 14.46671724319458  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.841796875 GB
    Memory Allocated: 0.3935527801513672  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.85546875 GB
    Memory Allocated: 14.638089656829834  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.85546875 GB
    Memory Allocated: 14.638128757476807  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.857421875 GB
    Memory Allocated: 0.41994524002075195  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.857421875 GB
    Memory Allocated: 14.66325569152832  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.857421875 GB
    Memory Allocated: 14.663294792175293  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.857421875 GB
    Memory Allocated: 0.4461331367492676  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.859375 GB
    Memory Allocated: 14.778064250946045  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.859375 GB
    Memory Allocated: 14.778103351593018  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.859375 GB
    Memory Allocated: 0.47149181365966797  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.873046875 GB
    Memory Allocated: 14.780821323394775  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.873046875 GB
    Memory Allocated: 14.780860424041748  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.875 GB
    Memory Allocated: 0.4970865249633789  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.875 GB
    Memory Allocated: 14.47751235961914  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.875 GB
    Memory Allocated: 14.477551460266113  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.875 GB
    Memory Allocated: 0.524724006652832  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.8828125 GB
    Memory Allocated: 14.744288444519043  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.8828125 GB
    Memory Allocated: 14.744327545166016  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.8828125 GB
    Memory Allocated: 0.5510292053222656  GigaBytes
Max Memory Allocated: 14.89108943939209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.892578125 GB
    Memory Allocated: 14.944072246551514  GigaBytes
Max Memory Allocated: 14.998159408569336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.892578125 GB
    Memory Allocated: 14.944111347198486  GigaBytes
Max Memory Allocated: 14.998159408569336  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.892578125 GB
    Memory Allocated: 0.5744161605834961  GigaBytes
Max Memory Allocated: 14.998159408569336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.892578125 GB
    Memory Allocated: 14.50326156616211  GigaBytes
Max Memory Allocated: 14.998159408569336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.892578125 GB
    Memory Allocated: 14.503298282623291  GigaBytes
Max Memory Allocated: 14.998159408569336  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.892578125 GB
    Memory Allocated: 0.6034626960754395  GigaBytes
Max Memory Allocated: 14.998159408569336  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.2737281322479248
pure train time :  10.023752450942993
train time :  12.55952787399292
end to end time :  52.052294969558716
connection check time:  25.567991256713867
block generation time  13.070291519165039
Total (block generation + training)time/epoch nan
pure train time per /epoch  [10.023752450942993]
pure train time average  nan
input num list  [2682361]
