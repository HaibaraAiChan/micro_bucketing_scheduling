main start at this time 1690357742.651382
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  261
len(bkt)  300
len(bkt)  273
len(bkt)  261
len(bkt)  231
len(bkt)  200
len(bkt)  226
len(bkt)  196
len(bkt)  186
len(bkt)  200
len(bkt)  5145
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
G_BUCKET_ID_list length 39
len(g_bucket_nids_list)  39
len(local_split_batches_nid_list)  5
current group_mem  7.541331259903894
current group_mem  5.061138357277836
current group_mem  4.513941983252465
current group_mem  4.405460822207029
current group_mem  4.269168648303187
current group_mem  4.541026571222084
current group_mem  4.639840638519238
current group_mem  4.713729125862847
current group_mem  4.886536553059854
current group_mem  5.016373929477647
current group_mem  5.22704385630489
current group_mem  5.463201338689721
current group_mem  5.736866214283334
current group_mem  6.0286773880470035
current group_mem  6.165483756764532
current group_mem  6.499482203113614
current group_mem  6.586220875293987
current group_mem  6.709574172828771
current group_mem  7.0652314592782695
current group_mem  6.866284593234719
current group_mem  7.236929805411312
current group_mem  8.14674426522888
current group_mem  8.416046834391066
current group_mem  8.102893008967808
current group_mem  8.051872190619996
current group_mem  9.03076054188325
current group_mem  8.830971612913995
current group_mem  8.931110420871427
current group_mem  9.341662166768582
current group_mem  10.55035540578557
current group_mem  9.39152315125004
current group_mem  9.756606702804566
current group_mem  9.825121404474434
current group_mem  10.562485178779154
current group_mem  10.547052873311724
current group_mem  10.123620993479163
current group_mem  10.385506831577846
current group_mem  10.64140778209641
current group_mem  9.925630771064759
batches output list generation spend  0.0011174678802490234
self.weights_list  [0.011315028425022817, 0.011315028425022817, 0.011315028425022817, 0.011315028425022817, 0.011315028425022817]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.020127058029174805
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.34586262702941895
len local_batched_seeds_list  5
partition total batch output list spend :  0.45578885078430176
self.buckets_partition() spend  sec:  0.36602282524108887
layer  0
 the number of batches:  5
check_connections_block*********************************

the find indices time spent  0.02702784538269043

in edges time spent  0.026262760162353516
local to global src and eids time spent  0.0349879264831543
time gen tails  0.010850191116333008
res  length 5
layer  1
num of batch  5
check_connections_block*********************************

the find indices time spent  0.04039168357849121

in edges time spent  0.29120540618896484
local to global src and eids time spent  0.3441500663757324
time gen tails  0.044919729232788086
res  length 5
layer  2
num of batch  5
check_connections_block*********************************

the find indices time spent  0.07045483589172363

in edges time spent  0.6825852394104004
local to global src and eids time spent  0.7702150344848633
time gen tails  0.08474564552307129
res  length 5
layer  3
num of batch  5
check_connections_block*********************************

the find indices time spent  0.08866667747497559

in edges time spent  0.5319066047668457
local to global src and eids time spent  0.6334860324859619
time gen tails  0.10498166084289551
res  length 5
block collection to dataloader spend  1.1682510375976562e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.544921875 GB
    Memory Allocated: 0.09397125244140625  GigaBytes
Max Memory Allocated: 0.09397125244140625  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.5390625 GB
    Memory Allocated: 20.821117877960205  GigaBytes
Max Memory Allocated: 20.870883464813232  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.5390625 GB
    Memory Allocated: 20.821272373199463  GigaBytes
Max Memory Allocated: 20.870883464813232  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.20703125 GB
    Memory Allocated: 0.14112091064453125  GigaBytes
Max Memory Allocated: 20.870883464813232  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.55078125 GB
    Memory Allocated: 20.828126430511475  GigaBytes
Max Memory Allocated: 20.874862670898438  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.55078125 GB
    Memory Allocated: 20.828280448913574  GigaBytes
Max Memory Allocated: 20.874862670898438  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.078125 GB
    Memory Allocated: 0.1855010986328125  GigaBytes
Max Memory Allocated: 20.874862670898438  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.08203125 GB
    Memory Allocated: 20.89861249923706  GigaBytes
Max Memory Allocated: 20.95340061187744  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.08203125 GB
    Memory Allocated: 20.89876651763916  GigaBytes
Max Memory Allocated: 20.95340061187744  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.08203125 GB
    Memory Allocated: 0.23046255111694336  GigaBytes
Max Memory Allocated: 20.95340061187744  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.787109375 GB
    Memory Allocated: 21.0680570602417  GigaBytes
Max Memory Allocated: 21.128968715667725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.787109375 GB
    Memory Allocated: 21.0682110786438  GigaBytes
Max Memory Allocated: 21.128968715667725  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.455078125 GB
    Memory Allocated: 0.27254152297973633  GigaBytes
Max Memory Allocated: 21.128968715667725  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.634765625 GB
    Memory Allocated: 20.921624660491943  GigaBytes
Max Memory Allocated: 21.128968715667725  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.634765625 GB
    Memory Allocated: 20.921778678894043  GigaBytes
Max Memory Allocated: 21.128968715667725  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.162109375 GB
    Memory Allocated: 0.31526803970336914  GigaBytes
Max Memory Allocated: 21.128968715667725  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.2758874297142029
pure train time :  4.261619567871094
train time :  5.126846075057983
end to end time :  13.080066680908203
connection check time:  4.230777740478516
block generation time  3.2466890811920166
Total (block generation + training)time/epoch nan
pure train time per /epoch  [4.261619567871094]
pure train time average  nan
input num list  [745643]
