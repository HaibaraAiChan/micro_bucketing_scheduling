main start at this time 1690357658.6838777
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  483
len(bkt)  409
len(bkt)  390
len(bkt)  370
len(bkt)  329
len(bkt)  261
len(bkt)  300
len(bkt)  273
len(bkt)  261
len(bkt)  231
len(bkt)  200
len(bkt)  226
len(bkt)  196
len(bkt)  186
len(bkt)  200
len(bkt)  5145
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
G_BUCKET_ID_list length 39
len(g_bucket_nids_list)  39
len(local_split_batches_nid_list)  10
current group_mem  7.541331259903894
current group_mem  5.061138357277836
current group_mem  4.513941983252465
current group_mem  4.405460822207029
current group_mem  4.269168648303187
current group_mem  4.541026571222084
current group_mem  4.639840638519238
current group_mem  4.713729125862847
current group_mem  4.886536553059854
current group_mem  5.016373929477647
current group_mem  5.22704385630489
current group_mem  5.463201338689721
current group_mem  5.736866214283334
current group_mem  6.0286773880470035
current group_mem  6.165483756764532
current group_mem  6.499482203113614
current group_mem  6.586220875293987
current group_mem  6.709574172828771
current group_mem  7.0652314592782695
current group_mem  6.866284593234719
current group_mem  7.236929805411312
current group_mem  8.14674426522888
current group_mem  8.416046834391066
current group_mem  8.102893008967808
current group_mem  8.051872190619996
current group_mem  9.03076054188325
current group_mem  8.830971612913995
current group_mem  8.931110420871427
current group_mem  9.341662166768582
current group_mem  10.55035540578557
current group_mem  9.39152315125004
current group_mem  9.756606702804566
current group_mem  9.825121404474434
current group_mem  10.562485178779154
current group_mem  10.547052873311724
current group_mem  10.123620993479163
current group_mem  10.385506831577846
current group_mem  10.64140778209641
current group_mem  9.925630771064759
batches output list generation spend  0.0010633468627929688
self.weights_list  [0.005663012282688776, 0.005663012282688776, 0.005663012282688776, 0.005663012282688776, 0.005663012282688776, 0.005663012282688776, 0.005663012282688776, 0.005663012282688776, 0.005663012282688776, 0.0056080315809150984]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01889777183532715
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3595240116119385
len local_batched_seeds_list  10
partition total batch output list spend :  0.7246644496917725
self.buckets_partition() spend  sec:  0.37845444679260254
layer  0
 the number of batches:  10
check_connections_block*********************************

the find indices time spent  0.03563499450683594

in edges time spent  0.04017448425292969
local to global src and eids time spent  0.09729385375976562
time gen tails  0.02326345443725586
res  length 10
layer  1
num of batch  10
check_connections_block*********************************

the find indices time spent  0.0646669864654541

in edges time spent  0.6155192852020264
local to global src and eids time spent  1.0945992469787598
time gen tails  0.12051129341125488
res  length 10
layer  2
num of batch  10
check_connections_block*********************************

the find indices time spent  0.15500807762145996

in edges time spent  2.1281702518463135
local to global src and eids time spent  3.258528470993042
time gen tails  0.2735595703125
res  length 10
layer  3
num of batch  10
check_connections_block*********************************

the find indices time spent  0.23951148986816406

in edges time spent  1.8716847896575928
local to global src and eids time spent  2.8494861125946045
time gen tails  0.37395787239074707
res  length 10
block collection to dataloader spend  3.62396240234375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.521484375 GB
    Memory Allocated: 0.08805608749389648  GigaBytes
Max Memory Allocated: 0.08805608749389648  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.365234375 GB
    Memory Allocated: 17.599987030029297  GigaBytes
Max Memory Allocated: 17.644638061523438  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.365234375 GB
    Memory Allocated: 17.600064754486084  GigaBytes
Max Memory Allocated: 17.644638061523438  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.400390625 GB
    Memory Allocated: 0.12473058700561523  GigaBytes
Max Memory Allocated: 17.644638061523438  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.955078125 GB
    Memory Allocated: 17.648043632507324  GigaBytes
Max Memory Allocated: 17.69335174560547  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.955078125 GB
    Memory Allocated: 17.648120880126953  GigaBytes
Max Memory Allocated: 17.69335174560547  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.986328125 GB
    Memory Allocated: 0.1597003936767578  GigaBytes
Max Memory Allocated: 17.69335174560547  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.986328125 GB
    Memory Allocated: 17.629281044006348  GigaBytes
Max Memory Allocated: 17.69335174560547  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.986328125 GB
    Memory Allocated: 17.629358291625977  GigaBytes
Max Memory Allocated: 17.69335174560547  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.986328125 GB
    Memory Allocated: 0.1958937644958496  GigaBytes
Max Memory Allocated: 17.69335174560547  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.986328125 GB
    Memory Allocated: 17.720107078552246  GigaBytes
Max Memory Allocated: 17.765356063842773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.986328125 GB
    Memory Allocated: 17.720184326171875  GigaBytes
Max Memory Allocated: 17.765356063842773  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.986328125 GB
    Memory Allocated: 0.2316274642944336  GigaBytes
Max Memory Allocated: 17.765356063842773  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 17.73336887359619  GigaBytes
Max Memory Allocated: 17.799674034118652  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.50390625 GB
    Memory Allocated: 17.73344612121582  GigaBytes
Max Memory Allocated: 17.799674034118652  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 0.2670745849609375  GigaBytes
Max Memory Allocated: 17.799674034118652  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 17.7343430519104  GigaBytes
Max Memory Allocated: 17.799674034118652  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 17.73442029953003  GigaBytes
Max Memory Allocated: 17.799674034118652  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 0.3024787902832031  GigaBytes
Max Memory Allocated: 17.799674034118652  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 17.738940238952637  GigaBytes
Max Memory Allocated: 17.8059983253479  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 17.739017486572266  GigaBytes
Max Memory Allocated: 17.8059983253479  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 0.3377828598022461  GigaBytes
Max Memory Allocated: 17.8059983253479  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 17.908438205718994  GigaBytes
Max Memory Allocated: 17.968347549438477  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 17.908515453338623  GigaBytes
Max Memory Allocated: 17.968347549438477  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 0.3708648681640625  GigaBytes
Max Memory Allocated: 17.968347549438477  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 17.721257209777832  GigaBytes
Max Memory Allocated: 17.968347549438477  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 17.72133445739746  GigaBytes
Max Memory Allocated: 17.968347549438477  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.5390625 GB
    Memory Allocated: 0.40618133544921875  GigaBytes
Max Memory Allocated: 17.968347549438477  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.6015625 GB
    Memory Allocated: 17.840291023254395  GigaBytes
Max Memory Allocated: 17.968347549438477  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.6015625 GB
    Memory Allocated: 17.840367794036865  GigaBytes
Max Memory Allocated: 17.968347549438477  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.6015625 GB
    Memory Allocated: 0.4433255195617676  GigaBytes
Max Memory Allocated: 17.968347549438477  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.27454617619514465
pure train time :  5.997030973434448
train time :  7.5608861446380615
end to end time :  31.415371656417847
connection check time:  15.20761489868164
block generation time  7.898066520690918
Total (block generation + training)time/epoch nan
pure train time per /epoch  [5.997030973434448]
pure train time average  nan
input num list  [1425712]
