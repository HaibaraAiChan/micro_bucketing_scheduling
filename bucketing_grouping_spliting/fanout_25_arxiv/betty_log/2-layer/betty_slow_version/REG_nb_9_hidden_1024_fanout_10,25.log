main start at this time 1691459567.1480558
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
REG start----................................
Convert a graph into a bidirected graph: 1.294 seconds, peak memory: 27.381 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.381 GB
Metis partitioning: 5.908 seconds, peak memory: 27.996 GB
Split the graph: 1.958 seconds
Construct subgraphs: 0.092 seconds
REG metis partition end ----................................
REG construction  time spent:  3.7549290657043457
pure dgl.metis_partition the time spent:  9.287418603897095
connection checking time:  2.3398807048797607
block generation total time  2.0751049518585205
epoch,  0
pure train time  4.683274030685425
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.5078125 GB
    Memory Allocated: 0.1873149871826172  GigaBytes
Max Memory Allocated: 10.576733112335205  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.776543617248535
REG start----................................
Convert a graph into a bidirected graph: 1.307 seconds, peak memory: 64.471 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 64.471 GB
Metis partitioning: 5.994 seconds, peak memory: 65.040 GB
Split the graph: 2.097 seconds
Construct subgraphs: 0.096 seconds
REG metis partition end ----................................
REG construction  time spent:  3.6295101642608643
pure dgl.metis_partition the time spent:  9.511954307556152
connection checking time:  2.2533040046691895
block generation total time  2.0210938453674316
epoch,  1
pure train time  4.284337520599365
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.92578125 GB
    Memory Allocated: 0.1874542236328125  GigaBytes
Max Memory Allocated: 10.79975938796997  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1909804344177246
REG start----................................
Convert a graph into a bidirected graph: 1.333 seconds, peak memory: 68.381 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 68.381 GB
Metis partitioning: 6.238 seconds, peak memory: 69.010 GB
Split the graph: 2.180 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  3.7609002590179443
pure dgl.metis_partition the time spent:  9.7883141040802
connection checking time:  2.366598129272461
block generation total time  2.202829360961914
epoch,  2
pure train time  4.298375129699707
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.92578125 GB
    Memory Allocated: 0.1983475685119629  GigaBytes
Max Memory Allocated: 10.79975938796997  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.6074326038360596
loading full batch data spends  0.06205439567565918
REG start----................................
Convert a graph into a bidirected graph: 1.276 seconds, peak memory: 69.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.227 GB
Metis partitioning: 5.981 seconds, peak memory: 69.227 GB
Split the graph: 2.269 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  3.860316276550293
pure dgl.metis_partition the time spent:  9.56287670135498
connection checking time:  2.313218832015991
block generation total time  2.130807399749756
generate_dataloader_block spend   18.544600248336792
epoch,  3
pure train time  4.267277717590332
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.384765625 GB
    Memory Allocated: 0.18816184997558594  GigaBytes
Max Memory Allocated: 11.144789695739746  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.080578565597534
loading full batch data spends  0.0660858154296875
REG start----................................
Convert a graph into a bidirected graph: 1.309 seconds, peak memory: 69.891 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.891 GB
Metis partitioning: 6.210 seconds, peak memory: 70.494 GB
Split the graph: 2.472 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  3.811335325241089
pure dgl.metis_partition the time spent:  10.022271394729614
connection checking time:  2.3005940914154053
block generation total time  2.103055477142334
generate_dataloader_block spend   18.92197299003601
epoch,  4
pure train time  4.276808500289917
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.384765625 GB
    Memory Allocated: 0.18712472915649414  GigaBytes
Max Memory Allocated: 11.144789695739746  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.066866636276245
loading full batch data spends  0.07044601440429688
REG start----................................
Convert a graph into a bidirected graph: 1.331 seconds, peak memory: 70.863 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.863 GB
Metis partitioning: 6.256 seconds, peak memory: 70.863 GB
Split the graph: 2.536 seconds
Construct subgraphs: 0.024 seconds
REG metis partition end ----................................
REG construction  time spent:  3.932929277420044
pure dgl.metis_partition the time spent:  10.163506984710693
connection checking time:  2.3078501224517822
block generation total time  2.0741348266601562
generate_dataloader_block spend   19.15719747543335
epoch,  5
pure train time  4.262385368347168
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.384765625 GB
    Memory Allocated: 0.18628644943237305  GigaBytes
Max Memory Allocated: 11.144789695739746  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0672101974487305
loading full batch data spends  0.05960988998413086
REG start----................................
Convert a graph into a bidirected graph: 1.351 seconds, peak memory: 70.926 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.926 GB
Metis partitioning: 6.268 seconds, peak memory: 70.926 GB
Split the graph: 2.119 seconds
Construct subgraphs: 0.025 seconds
REG metis partition end ----................................
REG construction  time spent:  3.9856677055358887
pure dgl.metis_partition the time spent:  9.7799654006958
connection checking time:  2.3521616458892822
block generation total time  2.117262840270996
generate_dataloader_block spend   18.934288501739502
epoch,  6
pure train time  4.284952402114868
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.384765625 GB
    Memory Allocated: 0.1871166229248047  GigaBytes
Max Memory Allocated: 11.144789695739746  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0304946899414062
loading full batch data spends  0.060910701751708984
REG start----................................
Convert a graph into a bidirected graph: 1.369 seconds, peak memory: 70.926 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.926 GB
Metis partitioning: 6.231 seconds, peak memory: 70.926 GB
Split the graph: 2.223 seconds
Construct subgraphs: 0.033 seconds
REG metis partition end ----................................
REG construction  time spent:  3.910567283630371
pure dgl.metis_partition the time spent:  9.872488498687744
connection checking time:  2.2998180389404297
block generation total time  2.107482671737671
generate_dataloader_block spend   18.895649671554565
epoch,  7
pure train time  4.281997203826904
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.384765625 GB
    Memory Allocated: 0.19624900817871094  GigaBytes
Max Memory Allocated: 11.144789695739746  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.96077823638916
loading full batch data spends  0.06750130653381348
REG start----................................
Convert a graph into a bidirected graph: 1.292 seconds, peak memory: 70.926 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.926 GB
Metis partitioning: 6.203 seconds, peak memory: 70.926 GB
Split the graph: 2.236 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  3.734726905822754
pure dgl.metis_partition the time spent:  9.764746904373169
connection checking time:  2.2843220233917236
block generation total time  2.106212854385376
generate_dataloader_block spend   18.590782403945923
epoch,  8
pure train time  4.2865095138549805
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.884765625 GB
    Memory Allocated: 0.19480323791503906  GigaBytes
Max Memory Allocated: 11.371118545532227  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8707077503204346
loading full batch data spends  0.06814694404602051
REG start----................................
Convert a graph into a bidirected graph: 1.325 seconds, peak memory: 71.493 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 71.493 GB
Metis partitioning: 6.316 seconds, peak memory: 72.111 GB
Split the graph: 2.410 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  4.027377605438232
pure dgl.metis_partition the time spent:  10.089842796325684
connection checking time:  2.334522247314453
block generation total time  2.1476728916168213
generate_dataloader_block spend   19.336087703704834
epoch,  9
pure train time  4.299563884735107
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.884765625 GB
    Memory Allocated: 0.19575929641723633  GigaBytes
Max Memory Allocated: 11.371118545532227  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.77079176902771
loading full batch data spends  0.05575704574584961
REG start----................................
Convert a graph into a bidirected graph: 1.348 seconds, peak memory: 72.655 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.655 GB
Metis partitioning: 6.482 seconds, peak memory: 72.655 GB
Split the graph: 2.018 seconds
Construct subgraphs: 0.026 seconds
REG metis partition end ----................................
REG construction  time spent:  3.8629767894744873
pure dgl.metis_partition the time spent:  9.890206575393677
connection checking time:  2.3022501468658447
block generation total time  2.13979172706604
generate_dataloader_block spend   18.88538646697998
epoch,  10
pure train time  4.272412538528442
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.884765625 GB
    Memory Allocated: 0.1873760223388672  GigaBytes
Max Memory Allocated: 11.371118545532227  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6762077808380127
loading full batch data spends  0.05316472053527832
REG start----................................
Convert a graph into a bidirected graph: 1.320 seconds, peak memory: 72.655 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.655 GB
Metis partitioning: 6.339 seconds, peak memory: 72.655 GB
Split the graph: 2.434 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  3.9634876251220703
pure dgl.metis_partition the time spent:  10.12959623336792
connection checking time:  2.2884647846221924
block generation total time  2.099029064178467
generate_dataloader_block spend   19.146117687225342
epoch,  11
pure train time  4.28610897064209
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.884765625 GB
    Memory Allocated: 0.18729305267333984  GigaBytes
Max Memory Allocated: 11.371118545532227  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.609436511993408
loading full batch data spends  0.06971287727355957
REG start----................................
Convert a graph into a bidirected graph: 1.304 seconds, peak memory: 72.655 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.655 GB
Metis partitioning: 6.516 seconds, peak memory: 72.655 GB
Split the graph: 1.997 seconds
Construct subgraphs: 0.026 seconds
REG metis partition end ----................................
REG construction  time spent:  4.083380699157715
pure dgl.metis_partition the time spent:  9.861392259597778
connection checking time:  2.299389362335205
block generation total time  2.1178596019744873
generate_dataloader_block spend   19.098620891571045
epoch,  12
pure train time  4.27044677734375
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.884765625 GB
    Memory Allocated: 0.18727350234985352  GigaBytes
Max Memory Allocated: 11.371118545532227  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.5602705478668213
loading full batch data spends  0.07439923286437988
REG start----................................
Convert a graph into a bidirected graph: 1.416 seconds, peak memory: 72.655 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.655 GB
Metis partitioning: 6.593 seconds, peak memory: 72.655 GB
Split the graph: 2.231 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  3.860086441040039
pure dgl.metis_partition the time spent:  10.275782346725464
connection checking time:  2.3338565826416016
block generation total time  2.1281421184539795
generate_dataloader_block spend   19.341283559799194
epoch,  13
pure train time  4.275943994522095
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.884765625 GB
    Memory Allocated: 0.19684839248657227  GigaBytes
Max Memory Allocated: 11.371118545532227  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4751734733581543
loading full batch data spends  0.05544757843017578
REG start----................................
Convert a graph into a bidirected graph: 1.350 seconds, peak memory: 72.655 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.655 GB
Metis partitioning: 6.470 seconds, peak memory: 72.655 GB
Split the graph: 1.943 seconds
Construct subgraphs: 0.024 seconds
REG metis partition end ----................................
REG construction  time spent:  4.046178817749023
pure dgl.metis_partition the time spent:  9.804693698883057
connection checking time:  2.3077189922332764
block generation total time  2.1114141941070557
generate_dataloader_block spend   19.063373565673828
epoch,  14
pure train time  4.312777757644653
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.884765625 GB
    Memory Allocated: 0.19749784469604492  GigaBytes
Max Memory Allocated: 11.371118545532227  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4014217853546143
loading full batch data spends  0.07782578468322754
REG start----................................
Convert a graph into a bidirected graph: 1.369 seconds, peak memory: 72.655 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.655 GB
Metis partitioning: 6.788 seconds, peak memory: 72.655 GB
Split the graph: 2.292 seconds
Construct subgraphs: 0.025 seconds
REG metis partition end ----................................
REG construction  time spent:  3.884726047515869
pure dgl.metis_partition the time spent:  10.491384506225586
connection checking time:  2.298469305038452
block generation total time  2.1337029933929443
generate_dataloader_block spend   19.522310733795166
epoch,  15
pure train time  4.2688868045806885
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.884765625 GB
    Memory Allocated: 0.1881871223449707  GigaBytes
Max Memory Allocated: 11.371118545532227  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.322176218032837
loading full batch data spends  0.07450032234191895
REG start----................................
Convert a graph into a bidirected graph: 1.299 seconds, peak memory: 72.655 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.655 GB
Metis partitioning: 6.623 seconds, peak memory: 72.655 GB
Split the graph: 2.397 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  3.7693445682525635
pure dgl.metis_partition the time spent:  10.357056617736816
connection checking time:  2.28438663482666
block generation total time  2.0935354232788086
generate_dataloader_block spend   19.203688621520996
epoch,  16
pure train time  4.248712062835693
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.884765625 GB
    Memory Allocated: 0.19516277313232422  GigaBytes
Max Memory Allocated: 11.371118545532227  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2507898807525635
loading full batch data spends  0.056935787200927734
REG start----................................
Convert a graph into a bidirected graph: 1.284 seconds, peak memory: 72.655 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.655 GB
Metis partitioning: 6.643 seconds, peak memory: 72.655 GB
Split the graph: 2.144 seconds
Construct subgraphs: 0.011 seconds
REG metis partition end ----................................
REG construction  time spent:  3.8003013134002686
pure dgl.metis_partition the time spent:  10.098387718200684
connection checking time:  2.3480403423309326
block generation total time  2.1107990741729736
generate_dataloader_block spend   19.079180479049683
epoch,  17
pure train time  4.30493950843811
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.884765625 GB
    Memory Allocated: 0.1971449851989746  GigaBytes
Max Memory Allocated: 11.371118545532227  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.195643901824951
loading full batch data spends  0.07052278518676758
REG start----................................
Convert a graph into a bidirected graph: 1.360 seconds, peak memory: 72.655 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.655 GB
Metis partitioning: 6.769 seconds, peak memory: 72.655 GB
Split the graph: 2.389 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  3.88712215423584
pure dgl.metis_partition the time spent:  10.55875039100647
connection checking time:  2.292170524597168
block generation total time  2.112570285797119
generate_dataloader_block spend   19.587923288345337
epoch,  18
pure train time  4.306829929351807
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.884765625 GB
    Memory Allocated: 0.18777704238891602  GigaBytes
Max Memory Allocated: 11.371118545532227  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.147442579269409
loading full batch data spends  0.05596303939819336
REG start----................................
Convert a graph into a bidirected graph: 1.316 seconds, peak memory: 72.655 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 72.655 GB
Metis partitioning: 6.517 seconds, peak memory: 72.655 GB
Split the graph: 2.542 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  3.8412208557128906
pure dgl.metis_partition the time spent:  10.414498090744019
connection checking time:  2.3105032444000244
block generation total time  2.148481845855713
generate_dataloader_block spend   19.435508728027344
epoch,  19
pure train time  4.326350688934326
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.884765625 GB
    Memory Allocated: 0.18779802322387695  GigaBytes
Max Memory Allocated: 11.371118545532227  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.088442802429199
Total (block generation + training)time/epoch 24.323340808644016
pure train time/epoch 4.285921160380045

num_input_list  [445007, 430896, 465574, 451292, 439176, 426525, 444701, 438629, 441575, 433274, 445564, 430340, 434735, 443951, 434749, 441664, 428822, 437086, 434738, 448291]
