main start at this time 1691460065.2082016
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
REG start----................................
Convert a graph into a bidirected graph: 1.290 seconds, peak memory: 27.381 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 27.381 GB
Metis partitioning: 5.972 seconds, peak memory: 27.996 GB
Split the graph: 1.809 seconds
Construct subgraphs: 0.120 seconds
REG metis partition end ----................................
REG construction  time spent:  3.680095672607422
pure dgl.metis_partition the time spent:  9.205706119537354
connection checking time:  2.407590866088867
block generation total time  2.1316163539886475
epoch,  0
pure train time  4.812904596328735
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.494140625 GB
    Memory Allocated: 0.19498920440673828  GigaBytes
Max Memory Allocated: 10.044698715209961  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7759366035461426
REG start----................................
Convert a graph into a bidirected graph: 1.292 seconds, peak memory: 52.287 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 52.287 GB
Metis partitioning: 6.155 seconds, peak memory: 52.920 GB
Split the graph: 1.736 seconds
Construct subgraphs: 0.100 seconds
REG metis partition end ----................................
REG construction  time spent:  3.7342207431793213
pure dgl.metis_partition the time spent:  9.299291849136353
connection checking time:  2.3000199794769287
block generation total time  2.152088165283203
epoch,  1
pure train time  4.404383897781372
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.892578125 GB
    Memory Allocated: 0.18601560592651367  GigaBytes
Max Memory Allocated: 10.12039041519165  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1911890506744385
REG start----................................
Convert a graph into a bidirected graph: 1.287 seconds, peak memory: 62.953 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 62.953 GB
Metis partitioning: 6.083 seconds, peak memory: 63.587 GB
Split the graph: 1.952 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  3.671046257019043
pure dgl.metis_partition the time spent:  9.353241443634033
connection checking time:  2.4909181594848633
block generation total time  2.219468593597412
epoch,  2
pure train time  4.407460927963257
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.892578125 GB
    Memory Allocated: 0.19597911834716797  GigaBytes
Max Memory Allocated: 10.12039041519165  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.612412214279175
loading full batch data spends  0.08987641334533691
REG start----................................
Convert a graph into a bidirected graph: 1.283 seconds, peak memory: 67.072 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 67.072 GB
Metis partitioning: 6.203 seconds, peak memory: 67.625 GB
Split the graph: 2.072 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  3.7787675857543945
pure dgl.metis_partition the time spent:  9.593968391418457
connection checking time:  2.2140402793884277
block generation total time  2.230698585510254
generate_dataloader_block spend   18.416937828063965
epoch,  3
pure train time  4.41216778755188
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.892578125 GB
    Memory Allocated: 0.1676025390625  GigaBytes
Max Memory Allocated: 10.12039041519165  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.078921318054199
loading full batch data spends  0.07200217247009277
REG start----................................
Convert a graph into a bidirected graph: 1.301 seconds, peak memory: 67.938 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 67.938 GB
Metis partitioning: 6.359 seconds, peak memory: 67.938 GB
Split the graph: 2.116 seconds
Construct subgraphs: 0.013 seconds
REG metis partition end ----................................
REG construction  time spent:  3.7924578189849854
pure dgl.metis_partition the time spent:  9.806055068969727
connection checking time:  1.6285128593444824
block generation total time  1.4220714569091797
generate_dataloader_block spend   17.29813241958618
epoch,  4
pure train time  4.379332065582275
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.892578125 GB
    Memory Allocated: 0.1670517921447754  GigaBytes
Max Memory Allocated: 10.12039041519165  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.067620277404785
loading full batch data spends  0.07079505920410156
REG start----................................
Convert a graph into a bidirected graph: 1.290 seconds, peak memory: 68.021 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 68.021 GB
Metis partitioning: 6.210 seconds, peak memory: 68.021 GB
Split the graph: 2.009 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  3.867438554763794
pure dgl.metis_partition the time spent:  9.547346591949463
connection checking time:  2.408677339553833
block generation total time  2.166069984436035
generate_dataloader_block spend   18.670908451080322
epoch,  5
pure train time  4.421852350234985
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.892578125 GB
    Memory Allocated: 0.19281864166259766  GigaBytes
Max Memory Allocated: 10.12039041519165  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0661962032318115
loading full batch data spends  0.09553122520446777
REG start----................................
Convert a graph into a bidirected graph: 1.335 seconds, peak memory: 68.139 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 68.139 GB
Metis partitioning: 6.488 seconds, peak memory: 68.139 GB
Split the graph: 2.076 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  3.944600820541382
pure dgl.metis_partition the time spent:  9.936213970184326
connection checking time:  2.482710123062134
block generation total time  2.2144298553466797
generate_dataloader_block spend   19.21165370941162
epoch,  6
pure train time  4.420197486877441
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.892578125 GB
    Memory Allocated: 0.16718292236328125  GigaBytes
Max Memory Allocated: 10.12039041519165  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0287787914276123
loading full batch data spends  0.05737447738647461
REG start----................................
Convert a graph into a bidirected graph: 1.294 seconds, peak memory: 68.139 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 68.139 GB
Metis partitioning: 6.408 seconds, peak memory: 68.139 GB
Split the graph: 1.811 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  3.93822979927063
pure dgl.metis_partition the time spent:  9.551668167114258
connection checking time:  2.2171621322631836
block generation total time  2.2298123836517334
generate_dataloader_block spend   18.598540782928467
epoch,  7
pure train time  4.415907144546509
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.892578125 GB
    Memory Allocated: 0.18648719787597656  GigaBytes
Max Memory Allocated: 10.12039041519165  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.959254026412964
loading full batch data spends  0.0691835880279541
REG start----................................
Convert a graph into a bidirected graph: 1.362 seconds, peak memory: 68.139 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 68.139 GB
Metis partitioning: 6.710 seconds, peak memory: 68.139 GB
Split the graph: 2.323 seconds
Construct subgraphs: 0.036 seconds
REG metis partition end ----................................
REG construction  time spent:  3.8315703868865967
pure dgl.metis_partition the time spent:  10.449573278427124
connection checking time:  2.273678779602051
block generation total time  2.203087568283081
generate_dataloader_block spend   19.459223985671997
epoch,  8
pure train time  4.3967061042785645
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.22265625 GB
    Memory Allocated: 0.16895437240600586  GigaBytes
Max Memory Allocated: 10.198888778686523  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8681488037109375
loading full batch data spends  0.09505796432495117
REG start----................................
Convert a graph into a bidirected graph: 1.354 seconds, peak memory: 68.536 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 68.536 GB
Metis partitioning: 6.518 seconds, peak memory: 69.153 GB
Split the graph: 1.807 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  3.85669207572937
pure dgl.metis_partition the time spent:  9.709823846817017
connection checking time:  2.2299726009368896
block generation total time  2.2212984561920166
generate_dataloader_block spend   18.654935121536255
epoch,  9
pure train time  4.410713195800781
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.22265625 GB
    Memory Allocated: 0.1947159767150879  GigaBytes
Max Memory Allocated: 10.198888778686523  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7689168453216553
loading full batch data spends  0.08001565933227539
REG start----................................
Convert a graph into a bidirected graph: 1.370 seconds, peak memory: 69.455 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.455 GB
Metis partitioning: 6.759 seconds, peak memory: 69.455 GB
Split the graph: 1.888 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  4.119677543640137
pure dgl.metis_partition the time spent:  10.056213617324829
connection checking time:  2.2046444416046143
block generation total time  2.199819564819336
generate_dataloader_block spend   19.225477695465088
epoch,  10
pure train time  4.390138864517212
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.22265625 GB
    Memory Allocated: 0.16688251495361328  GigaBytes
Max Memory Allocated: 10.198888778686523  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.671602487564087
loading full batch data spends  0.0628044605255127
REG start----................................
Convert a graph into a bidirected graph: 1.334 seconds, peak memory: 69.455 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.455 GB
Metis partitioning: 6.360 seconds, peak memory: 69.463 GB
Split the graph: 1.916 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  3.940000295639038
pure dgl.metis_partition the time spent:  9.647482633590698
connection checking time:  2.2328379154205322
block generation total time  2.220364570617676
generate_dataloader_block spend   18.711414337158203
epoch,  11
pure train time  4.405365467071533
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.22265625 GB
    Memory Allocated: 0.1862320899963379  GigaBytes
Max Memory Allocated: 10.198888778686523  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6069979667663574
loading full batch data spends  0.06401801109313965
REG start----................................
Convert a graph into a bidirected graph: 1.340 seconds, peak memory: 69.541 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.541 GB
Metis partitioning: 6.668 seconds, peak memory: 69.541 GB
Split the graph: 1.952 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  4.179176330566406
pure dgl.metis_partition the time spent:  9.99563217163086
connection checking time:  2.4645187854766846
block generation total time  2.1978185176849365
generate_dataloader_block spend   19.597726821899414
epoch,  12
pure train time  4.41048526763916
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.22265625 GB
    Memory Allocated: 0.16691350936889648  GigaBytes
Max Memory Allocated: 10.198888778686523  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.556544065475464
loading full batch data spends  0.07116293907165527
REG start----................................
Convert a graph into a bidirected graph: 1.398 seconds, peak memory: 69.541 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.541 GB
Metis partitioning: 6.688 seconds, peak memory: 69.541 GB
Split the graph: 2.210 seconds
Construct subgraphs: 0.022 seconds
REG metis partition end ----................................
REG construction  time spent:  4.105302095413208
pure dgl.metis_partition the time spent:  10.33486294746399
connection checking time:  2.411085605621338
block generation total time  2.196082592010498
generate_dataloader_block spend   19.758079051971436
epoch,  13
pure train time  4.406144857406616
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.22265625 GB
    Memory Allocated: 0.18603229522705078  GigaBytes
Max Memory Allocated: 10.198888778686523  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4733738899230957
loading full batch data spends  0.0650177001953125
REG start----................................
Convert a graph into a bidirected graph: 1.355 seconds, peak memory: 69.590 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.590 GB
Metis partitioning: 6.886 seconds, peak memory: 69.590 GB
Split the graph: 2.225 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  4.023815631866455
pure dgl.metis_partition the time spent:  10.501636981964111
connection checking time:  2.340616226196289
block generation total time  2.1324753761291504
generate_dataloader_block spend   19.63537335395813
epoch,  14
pure train time  4.415735721588135
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.576171875 GB
    Memory Allocated: 0.18628978729248047  GigaBytes
Max Memory Allocated: 10.384349822998047  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.395909070968628
loading full batch data spends  0.0702812671661377
REG start----................................
Convert a graph into a bidirected graph: 1.318 seconds, peak memory: 70.109 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.109 GB
Metis partitioning: 6.541 seconds, peak memory: 70.712 GB
Split the graph: 1.803 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  3.959495782852173
pure dgl.metis_partition the time spent:  9.702534675598145
connection checking time:  2.2313618659973145
block generation total time  2.1823689937591553
generate_dataloader_block spend   18.745558977127075
epoch,  15
pure train time  4.417070150375366
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.576171875 GB
    Memory Allocated: 0.19504261016845703  GigaBytes
Max Memory Allocated: 10.384349822998047  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.31980299949646
loading full batch data spends  0.06271839141845703
REG start----................................
Convert a graph into a bidirected graph: 1.360 seconds, peak memory: 70.747 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.747 GB
Metis partitioning: 6.561 seconds, peak memory: 70.747 GB
Split the graph: 1.969 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  3.942279577255249
pure dgl.metis_partition the time spent:  9.923990249633789
connection checking time:  2.130434036254883
block generation total time  2.1249136924743652
generate_dataloader_block spend   18.756784677505493
epoch,  16
pure train time  4.4406397342681885
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.576171875 GB
    Memory Allocated: 0.16539573669433594  GigaBytes
Max Memory Allocated: 10.403369426727295  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.246886968612671
loading full batch data spends  0.08227300643920898
REG start----................................
Convert a graph into a bidirected graph: 1.341 seconds, peak memory: 70.747 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.747 GB
Metis partitioning: 6.843 seconds, peak memory: 70.747 GB
Split the graph: 2.181 seconds
Construct subgraphs: 0.017 seconds
REG metis partition end ----................................
REG construction  time spent:  3.9070427417755127
pure dgl.metis_partition the time spent:  10.39811658859253
connection checking time:  2.438178062438965
block generation total time  2.1768407821655273
generate_dataloader_block spend   19.620962142944336
epoch,  17
pure train time  4.397464275360107
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.576171875 GB
    Memory Allocated: 0.1863269805908203  GigaBytes
Max Memory Allocated: 10.403369426727295  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.1948659420013428
loading full batch data spends  0.06704974174499512
REG start----................................
Convert a graph into a bidirected graph: 1.458 seconds, peak memory: 70.882 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.882 GB
Metis partitioning: 7.024 seconds, peak memory: 70.882 GB
Split the graph: 1.910 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  4.0329883098602295
pure dgl.metis_partition the time spent:  10.42913556098938
connection checking time:  2.1954567432403564
block generation total time  2.132460832595825
generate_dataloader_block spend   19.443833112716675
epoch,  18
pure train time  4.41906476020813
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.576171875 GB
    Memory Allocated: 0.1859898567199707  GigaBytes
Max Memory Allocated: 10.403369426727295  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.144596576690674
loading full batch data spends  0.062161922454833984
REG start----................................
Convert a graph into a bidirected graph: 1.331 seconds, peak memory: 70.994 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 70.994 GB
Metis partitioning: 6.905 seconds, peak memory: 70.994 GB
Split the graph: 1.818 seconds
Construct subgraphs: 0.014 seconds
REG metis partition end ----................................
REG construction  time spent:  3.9514153003692627
pure dgl.metis_partition the time spent:  10.086809873580933
connection checking time:  1.2682363986968994
block generation total time  1.1210322380065918
generate_dataloader_block spend   17.054416179656982
epoch,  19
pure train time  4.345342397689819
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.576171875 GB
    Memory Allocated: 0.1676807403564453  GigaBytes
Max Memory Allocated: 10.403369426727295  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.086066246032715
Total (block generation + training)time/epoch 24.250136333353378
pure train time/epoch 4.407521851857504

num_input_list  [475322, 470699, 486277, 486006, 455913, 459313, 479639, 473839, 460062, 478217, 471648, 470382, 466519, 460427, 458772, 452678, 457464, 474369, 443659, 475185]
