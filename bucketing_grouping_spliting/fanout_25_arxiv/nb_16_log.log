main start at this time 1697673087.2665079
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
the grouping_fanout_arxiv called successfully
capacity  1950
 
sorted_dict  {4: 1237, 5: 1233, 6: 1219, 7: 1211, 3: 1206, 8: 1184, 9: 1176, 2: 1174, 11: 1121, 10: 1116, 1: 1092, 12: 1061, 13: 1035, 14: 1013, 16: 960, 15: 955, 0: 928, 17: 928, 18: 916, 19: 900, 20: 868, 22: 800, 23: 795, 21: 787}

weights after sort [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 1013, 960, 955, 928, 928, 916, 900, 868, 800, 795, 787]
res_tmp  [1013  928]

remove bucket_id:  [13, 16]
original bucket_id :,  [14, 0]
remove weights:  [1013  928], 		------------sum 1941

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 1013, 960, 955, 928, 928, 916, 900, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 960, 955, 928, 916, 900, 868, 800, 795, 787]
res_tmp  [1035  900]

remove bucket_id:  [12, 17]
original bucket_id :,  [13, 19]
remove weights:  [1035  900], 		------------sum 1935

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 960, 955, 928, 916, 900, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 960, 955, 928, 916, 868, 800, 795, 787]
res_tmp  [1061  868]

remove bucket_id:  [11, 16]
original bucket_id :,  [12, 20]
remove weights:  [1061  868], 		------------sum 1929

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 960, 955, 928, 916, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 960, 955, 928, 916, 800, 795, 787]
res_tmp  [1121  800]

remove bucket_id:  [8, 15]
original bucket_id :,  [11, 22]
remove weights:  [1121  800], 		------------sum 1921

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 960, 955, 928, 916, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 960, 955, 928, 916, 795, 787]
res_tmp  [960 955]

remove bucket_id:  [10, 11]
original bucket_id :,  [16, 15]
remove weights:  [960 955], 		------------sum 1915

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 960, 955, 928, 916, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 928, 916, 795, 787]
res_tmp  [1116  795]

remove bucket_id:  [8, 12]
original bucket_id :,  [10, 23]
remove weights:  [1116  795], 		------------sum 1911

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 928, 916, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1092, 928, 916, 787]
res_tmp  [1092  787]

remove bucket_id:  [8, 11]
original bucket_id :,  [1, 21]
remove weights:  [1092  787], 		------------sum 1879

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1092, 928, 916, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 928, 916]
res_tmp  [928 916]

remove bucket_id:  [8, 9]
original bucket_id :,  [0, 18]
remove weights:  [928 916], 		------------sum 1844

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 928, 916]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174]
res_tmp  [1237]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [1237], 		------------sum 1237

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1233, 1219, 1211, 1206, 1184, 1176, 1174]
res_tmp  [1233]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [1233], 		------------sum 1233

before remove weights,  [1233, 1219, 1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1219, 1211, 1206, 1184, 1176, 1174]
res_tmp  [1219]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [1219], 		------------sum 1219

before remove weights,  [1219, 1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1211, 1206, 1184, 1176, 1174]
res_tmp  [1211]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [1211], 		------------sum 1211

before remove weights,  [1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1206, 1184, 1176, 1174]
res_tmp  [1206]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [1206], 		------------sum 1206

before remove weights,  [1206, 1184, 1176, 1174]
after remove pre pack weights,  [1184, 1176, 1174]
res_tmp  [1184]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [1184], 		------------sum 1184

before remove weights,  [1184, 1176, 1174]
after remove pre pack weights,  [1176, 1174]
res_tmp  [1176]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1176], 		------------sum 1176

before remove weights,  [1176, 1174]
after remove pre pack weights,  [1174]
the last batch value is  1174
G_BUCKET_ID_list [[14, 0], [13, 19], [12, 20], [11, 22], [16, 15], [10, 23], [1, 21], [0, 18], [4], [5], [6], [7], [3], [8], [9], [2]]
Groups_mem_list  [[1013, 928], [1035, 900], [1061, 868], [1121, 800], [960, 955], [1116, 795], [1092, 787], [928, 916], [1237], [1233], [1219], [1211], [1206], [1184], [1176], [1174], [1174]]
G_BUCKET_ID_list length 16
len(g_bucket_nids_list)  16
len(local_split_batches_nid_list)  16
current group_mem  1.9422925945071865
current group_mem  1.9362292978608222
current group_mem  1.930091839798956
current group_mem  1.9227115485292474
current group_mem  1.9153257174681322
current group_mem  1.9118156477334174
current group_mem  1.8794975120128465
current group_mem  1.8456433732799606
current group_mem  1.2375349585000666
current group_mem  1.2332499812783622
current group_mem  1.219712377230607
current group_mem  1.2118137788993009
current group_mem  1.2067483835407944
current group_mem  1.184205675680791
current group_mem  1.17600772351804
current group_mem  1.174592981690282
batches output list generation spend  0.0010578632354736328
self.weights_list  [0.16833991269064558, 0.031152065624965638, 0.032603556151790725, 0.033516235801233765, 0.030052451589492088, 0.03650718597772182, 0.14134438811976996, 0.1633586611099504, 0.07492770037716762, 0.060038926336855765, 0.050989102824908455, 0.04468831440164502, 0.08700146248666718, 0.03923422878569622, 0.03508868387196094, 0.1083889554766277]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01376652717590332
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6283168792724609
len local_batched_seeds_list  16
partition total batch output list spend :  1.175719976425171
self.buckets_partition() spend  sec:  0.6421148777008057
layer  0
 the number of batches:  16
check_connections_block*********************************

the find indices time spent  0.04714083671569824

in edges time spent  0.1570277214050293
local to global src and eids time spent  0.33666419982910156
time gen tails  0.09288620948791504
res  length 16
layer  1
num of batch  16
check_connections_block*********************************

the find indices time spent  0.17642927169799805

in edges time spent  0.989898681640625
local to global src and eids time spent  1.6617388725280762
time gen tails  0.31297993659973145
res  length 16
block collection to dataloader spend  2.2172927856445312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.5078125 GB
    Memory Allocated: 0.059021949768066406  GigaBytes
Max Memory Allocated: 0.059021949768066406  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.802734375 GB
    Memory Allocated: 3.130148410797119  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 4.802734375 GB
    Memory Allocated: 3.13250732421875  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 4.861328125 GB
    Memory Allocated: 0.054506778717041016  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.203125 GB
    Memory Allocated: 3.1114397048950195  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.203125 GB
    Memory Allocated: 3.1118626594543457  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.203125 GB
    Memory Allocated: 0.05438852310180664  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.203125 GB
    Memory Allocated: 3.133289337158203  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.203125 GB
    Memory Allocated: 3.1337318420410156  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.203125 GB
    Memory Allocated: 0.055932044982910156  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.349609375 GB
    Memory Allocated: 3.1326894760131836  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.349609375 GB
    Memory Allocated: 3.1331443786621094  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.349609375 GB
    Memory Allocated: 0.055834293365478516  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.349609375 GB
    Memory Allocated: 3.0750527381896973  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.349609375 GB
    Memory Allocated: 3.075460910797119  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.349609375 GB
    Memory Allocated: 0.05853414535522461  GigaBytes
Max Memory Allocated: 3.2020773887634277  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.349609375 GB
    Memory Allocated: 3.1625633239746094  GigaBytes
Max Memory Allocated: 3.2228245735168457  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.349609375 GB
    Memory Allocated: 3.1630587577819824  GigaBytes
Max Memory Allocated: 3.2228245735168457  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.349609375 GB
    Memory Allocated: 0.06916093826293945  GigaBytes
Max Memory Allocated: 3.2228245735168457  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.349609375 GB
    Memory Allocated: 3.1976075172424316  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.349609375 GB
    Memory Allocated: 3.1995859146118164  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.349609375 GB
    Memory Allocated: 0.07071113586425781  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.357421875 GB
    Memory Allocated: 2.9423513412475586  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.357421875 GB
    Memory Allocated: 2.9446096420288086  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 0.06850433349609375  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.965886116027832  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.966935157775879  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 0.06735754013061523  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.896981716156006  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.897796154022217  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 0.06620073318481445  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.8332371711730957  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.8339290618896484  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 0.06614160537719727  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.824160575866699  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.8247666358947754  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 0.07149887084960938  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.866952896118164  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.8681740760803223  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 0.06764650344848633  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.760984420776367  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.761516571044922  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 0.06717157363891602  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.715756416320801  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.7162327766418457  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 0.0751800537109375  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.756560802459717  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 2.75830078125  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 0.08487892150878906  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.357166290283203
pure train time :  1.7061412334442139
train time :  2.7550954818725586
end to end time :  10.449082136154175
connection check time:  4.346684694290161
block generation time  2.15250301361084
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
the grouping_fanout_arxiv called successfully
capacity  1950
 
sorted_dict  {4: 1237, 5: 1233, 6: 1219, 7: 1211, 3: 1206, 8: 1184, 9: 1176, 2: 1174, 11: 1121, 10: 1116, 1: 1092, 12: 1061, 13: 1035, 14: 1013, 16: 960, 15: 955, 0: 928, 17: 928, 18: 916, 19: 900, 20: 868, 22: 800, 23: 795, 21: 787}

weights after sort [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 1013, 960, 955, 928, 928, 916, 900, 868, 800, 795, 787]
res_tmp  [1013  928]

remove bucket_id:  [13, 16]
original bucket_id :,  [14, 0]
remove weights:  [1013  928], 		------------sum 1941

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 1013, 960, 955, 928, 928, 916, 900, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 960, 955, 928, 916, 900, 868, 800, 795, 787]
res_tmp  [1035  900]

remove bucket_id:  [12, 17]
original bucket_id :,  [13, 19]
remove weights:  [1035  900], 		------------sum 1935

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 960, 955, 928, 916, 900, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 960, 955, 928, 916, 868, 800, 795, 787]
res_tmp  [1061  868]

remove bucket_id:  [11, 16]
original bucket_id :,  [12, 20]
remove weights:  [1061  868], 		------------sum 1929

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 960, 955, 928, 916, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 960, 955, 928, 916, 800, 795, 787]
res_tmp  [1121  800]

remove bucket_id:  [8, 15]
original bucket_id :,  [11, 22]
remove weights:  [1121  800], 		------------sum 1921

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 960, 955, 928, 916, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 960, 955, 928, 916, 795, 787]
res_tmp  [960 955]

remove bucket_id:  [10, 11]
original bucket_id :,  [16, 15]
remove weights:  [960 955], 		------------sum 1915

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 960, 955, 928, 916, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 928, 916, 795, 787]
res_tmp  [1116  795]

remove bucket_id:  [8, 12]
original bucket_id :,  [10, 23]
remove weights:  [1116  795], 		------------sum 1911

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 928, 916, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1092, 928, 916, 787]
res_tmp  [1092  787]

remove bucket_id:  [8, 11]
original bucket_id :,  [1, 21]
remove weights:  [1092  787], 		------------sum 1879

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1092, 928, 916, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 928, 916]
res_tmp  [928 916]

remove bucket_id:  [8, 9]
original bucket_id :,  [0, 18]
remove weights:  [928 916], 		------------sum 1844

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 928, 916]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174]
res_tmp  [1237]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [1237], 		------------sum 1237

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1233, 1219, 1211, 1206, 1184, 1176, 1174]
res_tmp  [1233]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [1233], 		------------sum 1233

before remove weights,  [1233, 1219, 1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1219, 1211, 1206, 1184, 1176, 1174]
res_tmp  [1219]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [1219], 		------------sum 1219

before remove weights,  [1219, 1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1211, 1206, 1184, 1176, 1174]
res_tmp  [1211]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [1211], 		------------sum 1211

before remove weights,  [1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1206, 1184, 1176, 1174]
res_tmp  [1206]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [1206], 		------------sum 1206

before remove weights,  [1206, 1184, 1176, 1174]
after remove pre pack weights,  [1184, 1176, 1174]
res_tmp  [1184]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [1184], 		------------sum 1184

before remove weights,  [1184, 1176, 1174]
after remove pre pack weights,  [1176, 1174]
res_tmp  [1176]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1176], 		------------sum 1176

before remove weights,  [1176, 1174]
after remove pre pack weights,  [1174]
the last batch value is  1174
G_BUCKET_ID_list [[14, 0], [13, 19], [12, 20], [11, 22], [16, 15], [10, 23], [1, 21], [0, 18], [4], [5], [6], [7], [3], [8], [9], [2]]
Groups_mem_list  [[1013, 928], [1035, 900], [1061, 868], [1121, 800], [960, 955], [1116, 795], [1092, 787], [928, 916], [1237], [1233], [1219], [1211], [1206], [1184], [1176], [1174], [1174]]
G_BUCKET_ID_list length 16
len(g_bucket_nids_list)  16
len(local_split_batches_nid_list)  16
current group_mem  1.9422925945071865
current group_mem  1.9362292978608222
current group_mem  1.930091839798956
current group_mem  1.9227115485292474
current group_mem  1.9153257174681322
current group_mem  1.9118156477334174
current group_mem  1.8794975120128465
current group_mem  1.8456433732799606
current group_mem  1.2375349585000666
current group_mem  1.2332499812783622
current group_mem  1.219712377230607
current group_mem  1.2118137788993009
current group_mem  1.2067483835407944
current group_mem  1.184205675680791
current group_mem  1.17600772351804
current group_mem  1.174592981690282
batches output list generation spend  0.0007333755493164062
self.weights_list  [0.16833991269064558, 0.031152065624965638, 0.032603556151790725, 0.033516235801233765, 0.030052451589492088, 0.03650718597772182, 0.14134438811976996, 0.1633586611099504, 0.07492770037716762, 0.060038926336855765, 0.050989102824908455, 0.04468831440164502, 0.08700146248666718, 0.03923422878569622, 0.03508868387196094, 0.1083889554766277]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.018198728561401367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.591740608215332
len local_batched_seeds_list  16
partition total batch output list spend :  1.1557855606079102
self.buckets_partition() spend  sec:  0.6099791526794434
layer  0
 the number of batches:  16
check_connections_block*********************************

the find indices time spent  0.05121135711669922

in edges time spent  0.1643080711364746
local to global src and eids time spent  0.3381168842315674
time gen tails  0.08935165405273438
res  length 16
layer  1
num of batch  16
check_connections_block*********************************

the find indices time spent  0.17887639999389648

in edges time spent  1.2828764915466309
local to global src and eids time spent  1.6486051082611084
time gen tails  0.301499605178833
res  length 16
block collection to dataloader spend  2.8371810913085938e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 0.06934547424316406  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 3.1172194480895996  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 3.1187362670898438  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 0.06043100357055664  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 3.11038875579834  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 3.110811710357666  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.359375 GB
    Memory Allocated: 0.06013154983520508  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.361328125 GB
    Memory Allocated: 3.150242805480957  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.361328125 GB
    Memory Allocated: 3.1506853103637695  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.365234375 GB
    Memory Allocated: 0.06167125701904297  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.365234375 GB
    Memory Allocated: 3.1462106704711914  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.365234375 GB
    Memory Allocated: 3.146665573120117  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.365234375 GB
    Memory Allocated: 0.061437129974365234  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.365234375 GB
    Memory Allocated: 3.0867881774902344  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.365234375 GB
    Memory Allocated: 3.0871963500976562  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.365234375 GB
    Memory Allocated: 0.06518888473510742  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.2018165588378906  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.2023119926452637  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07471942901611328  GigaBytes
Max Memory Allocated: 3.267223358154297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.204807758331299  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.206812858581543  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07635784149169922  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.9736251831054688  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.975851058959961  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07398176193237305  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.965137004852295  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.9661598205566406  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07187414169311523  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8819775581359863  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8827919960021973  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07175874710083008  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8374834060668945  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8381752967834473  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07173013687133789  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8319921493530273  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8325982093811035  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07703733444213867  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8678274154663086  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8690295219421387  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.0728154182434082  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.757373332977295  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.7579054832458496  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07234430313110352  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.7070999145507812  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.707576274871826  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.08081340789794922  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.762454032897949  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.7642407417297363  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.08478736877441406  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 4.0897345542907715
pure train time :  1.1413779258728027
train time :  1.5280711650848389
end to end time :  9.483180046081543
connection check time:  4.608592748641968
block generation time  2.164306640625
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
the grouping_fanout_arxiv called successfully
capacity  1950
 
sorted_dict  {4: 1237, 5: 1233, 6: 1219, 7: 1211, 3: 1206, 8: 1184, 9: 1176, 2: 1174, 11: 1121, 10: 1116, 1: 1092, 12: 1061, 13: 1035, 14: 1013, 16: 960, 15: 955, 0: 928, 17: 928, 18: 916, 19: 900, 20: 868, 22: 800, 23: 795, 21: 787}

weights after sort [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 1013, 960, 955, 928, 928, 916, 900, 868, 800, 795, 787]
res_tmp  [1013  928]

remove bucket_id:  [13, 16]
original bucket_id :,  [14, 0]
remove weights:  [1013  928], 		------------sum 1941

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 1013, 960, 955, 928, 928, 916, 900, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 960, 955, 928, 916, 900, 868, 800, 795, 787]
res_tmp  [1035  900]

remove bucket_id:  [12, 17]
original bucket_id :,  [13, 19]
remove weights:  [1035  900], 		------------sum 1935

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 960, 955, 928, 916, 900, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 960, 955, 928, 916, 868, 800, 795, 787]
res_tmp  [1061  868]

remove bucket_id:  [11, 16]
original bucket_id :,  [12, 20]
remove weights:  [1061  868], 		------------sum 1929

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 960, 955, 928, 916, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 960, 955, 928, 916, 800, 795, 787]
res_tmp  [1121  800]

remove bucket_id:  [8, 15]
original bucket_id :,  [11, 22]
remove weights:  [1121  800], 		------------sum 1921

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 960, 955, 928, 916, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 960, 955, 928, 916, 795, 787]
res_tmp  [960 955]

remove bucket_id:  [10, 11]
original bucket_id :,  [16, 15]
remove weights:  [960 955], 		------------sum 1915

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 960, 955, 928, 916, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 928, 916, 795, 787]
res_tmp  [1116  795]

remove bucket_id:  [8, 12]
original bucket_id :,  [10, 23]
remove weights:  [1116  795], 		------------sum 1911

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 928, 916, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1092, 928, 916, 787]
res_tmp  [1092  787]

remove bucket_id:  [8, 11]
original bucket_id :,  [1, 21]
remove weights:  [1092  787], 		------------sum 1879

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1092, 928, 916, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 928, 916]
res_tmp  [928 916]

remove bucket_id:  [8, 9]
original bucket_id :,  [0, 18]
remove weights:  [928 916], 		------------sum 1844

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 928, 916]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174]
res_tmp  [1237]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [1237], 		------------sum 1237

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1233, 1219, 1211, 1206, 1184, 1176, 1174]
res_tmp  [1233]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [1233], 		------------sum 1233

before remove weights,  [1233, 1219, 1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1219, 1211, 1206, 1184, 1176, 1174]
res_tmp  [1219]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [1219], 		------------sum 1219

before remove weights,  [1219, 1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1211, 1206, 1184, 1176, 1174]
res_tmp  [1211]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [1211], 		------------sum 1211

before remove weights,  [1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1206, 1184, 1176, 1174]
res_tmp  [1206]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [1206], 		------------sum 1206

before remove weights,  [1206, 1184, 1176, 1174]
after remove pre pack weights,  [1184, 1176, 1174]
res_tmp  [1184]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [1184], 		------------sum 1184

before remove weights,  [1184, 1176, 1174]
after remove pre pack weights,  [1176, 1174]
res_tmp  [1176]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1176], 		------------sum 1176

before remove weights,  [1176, 1174]
after remove pre pack weights,  [1174]
the last batch value is  1174
G_BUCKET_ID_list [[14, 0], [13, 19], [12, 20], [11, 22], [16, 15], [10, 23], [1, 21], [0, 18], [4], [5], [6], [7], [3], [8], [9], [2]]
Groups_mem_list  [[1013, 928], [1035, 900], [1061, 868], [1121, 800], [960, 955], [1116, 795], [1092, 787], [928, 916], [1237], [1233], [1219], [1211], [1206], [1184], [1176], [1174], [1174]]
G_BUCKET_ID_list length 16
len(g_bucket_nids_list)  16
len(local_split_batches_nid_list)  16
current group_mem  1.9422925945071865
current group_mem  1.9362292978608222
current group_mem  1.930091839798956
current group_mem  1.9227115485292474
current group_mem  1.9153257174681322
current group_mem  1.9118156477334174
current group_mem  1.8794975120128465
current group_mem  1.8456433732799606
current group_mem  1.2375349585000666
current group_mem  1.2332499812783622
current group_mem  1.219712377230607
current group_mem  1.2118137788993009
current group_mem  1.2067483835407944
current group_mem  1.184205675680791
current group_mem  1.17600772351804
current group_mem  1.174592981690282
batches output list generation spend  0.0007736682891845703
self.weights_list  [0.16833991269064558, 0.031152065624965638, 0.032603556151790725, 0.033516235801233765, 0.030052451589492088, 0.03650718597772182, 0.14134438811976996, 0.1633586611099504, 0.07492770037716762, 0.060038926336855765, 0.050989102824908455, 0.04468831440164502, 0.08700146248666718, 0.03923422878569622, 0.03508868387196094, 0.1083889554766277]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016809940338134766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6733660697937012
len local_batched_seeds_list  16
partition total batch output list spend :  1.2115392684936523
self.buckets_partition() spend  sec:  0.6902410984039307
layer  0
 the number of batches:  16
check_connections_block*********************************

the find indices time spent  0.0471649169921875

in edges time spent  0.16418194770812988
local to global src and eids time spent  0.3365616798400879
time gen tails  0.0901939868927002
res  length 16
layer  1
num of batch  16
check_connections_block*********************************

the find indices time spent  0.17478060722351074

in edges time spent  1.2391574382781982
local to global src and eids time spent  1.4844353199005127
time gen tails  0.26152563095092773
res  length 16
block collection to dataloader spend  2.1457672119140625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07002878189086914  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.128805637359619  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.1303229331970215  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.060320377349853516  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.1078362464904785  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.1082592010498047  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.060029029846191406  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.1427745819091797  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.143217086791992  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.06135082244873047  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.126638889312744  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.12709379196167  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.061351776123046875  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.082563877105713  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.0829720497131348  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.06518840789794922  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.203662872314453  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.204158306121826  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07470083236694336  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.177140235900879  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.179145336151123  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07635307312011719  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.939150810241699  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.9413652420043945  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07509040832519531  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.967446804046631  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.968477249145508  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07290029525756836  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.888284683227539  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.88909912109375  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.0717477798461914  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.826096534729004  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8267884254455566  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07169437408447266  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8302760124206543  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8308820724487305  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07699394226074219  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.869046211242676  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8703818321228027  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07314729690551758  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.763740062713623  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.7642722129821777  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07254552841186523  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.7121176719665527  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.7125940322875977  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.08064985275268555  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.7597103118896484  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.7614846229553223  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.08471441268920898  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.8662962913513184
pure train time :  1.1386792659759521
train time :  1.529923439025879
end to end time :  9.281983613967896
connection check time:  4.3662848472595215
block generation time  2.1582400798797607
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  16
the grouping_fanout_arxiv called successfully
capacity  1950
 
sorted_dict  {4: 1237, 5: 1233, 6: 1219, 7: 1211, 3: 1206, 8: 1184, 9: 1176, 2: 1174, 11: 1121, 10: 1116, 1: 1092, 12: 1061, 13: 1035, 14: 1013, 16: 960, 15: 955, 0: 928, 17: 928, 18: 916, 19: 900, 20: 868, 22: 800, 23: 795, 21: 787}

weights after sort [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 1013, 960, 955, 928, 928, 916, 900, 868, 800, 795, 787]
res_tmp  [1013  928]

remove bucket_id:  [13, 16]
original bucket_id :,  [14, 0]
remove weights:  [1013  928], 		------------sum 1941

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 1013, 960, 955, 928, 928, 916, 900, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 960, 955, 928, 916, 900, 868, 800, 795, 787]
res_tmp  [1035  900]

remove bucket_id:  [12, 17]
original bucket_id :,  [13, 19]
remove weights:  [1035  900], 		------------sum 1935

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 1035, 960, 955, 928, 916, 900, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 960, 955, 928, 916, 868, 800, 795, 787]
res_tmp  [1061  868]

remove bucket_id:  [11, 16]
original bucket_id :,  [12, 20]
remove weights:  [1061  868], 		------------sum 1929

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 1061, 960, 955, 928, 916, 868, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 960, 955, 928, 916, 800, 795, 787]
res_tmp  [1121  800]

remove bucket_id:  [8, 15]
original bucket_id :,  [11, 22]
remove weights:  [1121  800], 		------------sum 1921

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1121, 1116, 1092, 960, 955, 928, 916, 800, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 960, 955, 928, 916, 795, 787]
res_tmp  [960 955]

remove bucket_id:  [10, 11]
original bucket_id :,  [16, 15]
remove weights:  [960 955], 		------------sum 1915

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 960, 955, 928, 916, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 928, 916, 795, 787]
res_tmp  [1116  795]

remove bucket_id:  [8, 12]
original bucket_id :,  [10, 23]
remove weights:  [1116  795], 		------------sum 1911

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1116, 1092, 928, 916, 795, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1092, 928, 916, 787]
res_tmp  [1092  787]

remove bucket_id:  [8, 11]
original bucket_id :,  [1, 21]
remove weights:  [1092  787], 		------------sum 1879

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 1092, 928, 916, 787]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 928, 916]
res_tmp  [928 916]

remove bucket_id:  [8, 9]
original bucket_id :,  [0, 18]
remove weights:  [928 916], 		------------sum 1844

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174, 928, 916]
after remove pre pack weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174]
res_tmp  [1237]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [1237], 		------------sum 1237

before remove weights,  [1237, 1233, 1219, 1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1233, 1219, 1211, 1206, 1184, 1176, 1174]
res_tmp  [1233]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [1233], 		------------sum 1233

before remove weights,  [1233, 1219, 1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1219, 1211, 1206, 1184, 1176, 1174]
res_tmp  [1219]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [1219], 		------------sum 1219

before remove weights,  [1219, 1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1211, 1206, 1184, 1176, 1174]
res_tmp  [1211]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [1211], 		------------sum 1211

before remove weights,  [1211, 1206, 1184, 1176, 1174]
after remove pre pack weights,  [1206, 1184, 1176, 1174]
res_tmp  [1206]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [1206], 		------------sum 1206

before remove weights,  [1206, 1184, 1176, 1174]
after remove pre pack weights,  [1184, 1176, 1174]
res_tmp  [1184]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [1184], 		------------sum 1184

before remove weights,  [1184, 1176, 1174]
after remove pre pack weights,  [1176, 1174]
res_tmp  [1176]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1176], 		------------sum 1176

before remove weights,  [1176, 1174]
after remove pre pack weights,  [1174]
the last batch value is  1174
G_BUCKET_ID_list [[14, 0], [13, 19], [12, 20], [11, 22], [16, 15], [10, 23], [1, 21], [0, 18], [4], [5], [6], [7], [3], [8], [9], [2]]
Groups_mem_list  [[1013, 928], [1035, 900], [1061, 868], [1121, 800], [960, 955], [1116, 795], [1092, 787], [928, 916], [1237], [1233], [1219], [1211], [1206], [1184], [1176], [1174], [1174]]
G_BUCKET_ID_list length 16
len(g_bucket_nids_list)  16
len(local_split_batches_nid_list)  16
current group_mem  1.9422925945071865
current group_mem  1.9362292978608222
current group_mem  1.930091839798956
current group_mem  1.9227115485292474
current group_mem  1.9153257174681322
current group_mem  1.9118156477334174
current group_mem  1.8794975120128465
current group_mem  1.8456433732799606
current group_mem  1.2375349585000666
current group_mem  1.2332499812783622
current group_mem  1.219712377230607
current group_mem  1.2118137788993009
current group_mem  1.2067483835407944
current group_mem  1.184205675680791
current group_mem  1.17600772351804
current group_mem  1.174592981690282
batches output list generation spend  0.0007932186126708984
self.weights_list  [0.16833991269064558, 0.031152065624965638, 0.032603556151790725, 0.033516235801233765, 0.030052451589492088, 0.03650718597772182, 0.14134438811976996, 0.1633586611099504, 0.07492770037716762, 0.060038926336855765, 0.050989102824908455, 0.04468831440164502, 0.08700146248666718, 0.03923422878569622, 0.03508868387196094, 0.1083889554766277]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016306638717651367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.6392958164215088
len local_batched_seeds_list  16
partition total batch output list spend :  1.1797666549682617
self.buckets_partition() spend  sec:  0.6556403636932373
layer  0
 the number of batches:  16
check_connections_block*********************************

the find indices time spent  0.04924964904785156

in edges time spent  0.1600806713104248
local to global src and eids time spent  0.3364295959472656
time gen tails  0.0900106430053711
res  length 16
layer  1
num of batch  16
check_connections_block*********************************

the find indices time spent  0.18050432205200195

in edges time spent  1.2004823684692383
local to global src and eids time spent  1.6314935684204102
time gen tails  0.2956395149230957
res  length 16
block collection to dataloader spend  2.9802322387695312e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.06925249099731445  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.1222457885742188  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.123786449432373  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.06012916564941406  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.1438722610473633  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.1442952156066895  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.059978485107421875  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.14793062210083  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.1483731269836426  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.06161975860595703  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.1353816986083984  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.135836601257324  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.061428070068359375  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.0849337577819824  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.0853419303894043  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.06518888473510742  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.2046613693237305  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.2051568031311035  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07470703125  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.2006850242614746  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 3.2026901245117188  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07629251480102539  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.9459896087646484  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.9482321739196777  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07395553588867188  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.9578700065612793  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.958962917327881  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07292556762695312  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8839521408081055  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8847665786743164  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07175636291503906  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8345255851745605  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8352174758911133  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.0716700553894043  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.820549488067627  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.821155548095703  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07711029052734375  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.8790125846862793  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.880197525024414  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07311439514160156  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.7653589248657227  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.7658910751342773  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.07258129119873047  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.716897487640381  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.717373847961426  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.08077049255371094  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.763582229614258  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 2.7653326988220215  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 6.513671875 GB
    Memory Allocated: 0.08478260040283203  GigaBytes
Max Memory Allocated: 3.2743077278137207  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7101874351501465
pure train time :  1.1482481956481934
train time :  1.5982606410980225
end to end time :  9.43112587928772
connection check time:  4.4957921504974365
block generation time  2.134251117706299
end to end time  9.499366998672485
Total (block generation + training)time/epoch 9.499366998672485
pure train time per /epoch  [1.7061412334442139, 1.1413779258728027, 1.1386792659759521, 1.1482481956481934]
pure train time average  nan
