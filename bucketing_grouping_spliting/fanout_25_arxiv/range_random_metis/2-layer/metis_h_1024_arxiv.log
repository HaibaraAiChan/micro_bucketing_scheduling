cc@ysy-rtx-6000-2:~/Betty_baseline/bucketing_grouping_spliting/fanout_25_arxiv$ python Metis.py 
num_batch == 6


WARNING:root:The OGB package is out of date. Your version is 1.3.5, while the latest version is 1.3.6.
main start at this time 1691261367.009948
ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
loading full batch data spends  0.05406761169433594
Convert a graph into a bidirected graph: 0.037 seconds, peak memory: 23.998 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.998 GB
[18:49:33] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 90941 nodes and 738066 edges into 6 parts and get 32223 edge cuts
Metis partitioning: 0.148 seconds, peak memory: 24.028 GB
Split the graph: 0.065 seconds
Construct subgraphs: 0.007 seconds
15163
15158
15154
15157
15150
15159
The batched output nid list before graph partition
connection checking time:  3.9271907806396484
block generation total time  3.486478328704834
generate_dataloader_block spend   8.051499605178833
pure train time  4.333673715591431
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.33984375 GB
    Memory Allocated: 0.22483539581298828  GigaBytes
Max Memory Allocated: 13.058993339538574  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7763924598693848
loading full batch data spends  0.07743501663208008
Convert a graph into a bidirected graph: 0.017 seconds, peak memory: 61.153 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 61.153 GB
[18:49:47] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 90941 nodes and 738066 edges into 6 parts and get 32223 edge cuts
Metis partitioning: 0.145 seconds, peak memory: 61.153 GB
Split the graph: 0.068 seconds
Construct subgraphs: 0.018 seconds
15163
15158
15154
15157
15150
15159
The batched output nid list before graph partition
connection checking time:  3.8472156524658203
block generation total time  3.4967615604400635
generate_dataloader_block spend   7.967193365097046
pure train time  3.9537835121154785
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3828125 GB
    Memory Allocated: 0.22482681274414062  GigaBytes
Max Memory Allocated: 13.166175365447998  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1909584999084473
loading full batch data spends  0.0672602653503418
Convert a graph into a bidirected graph: 0.016 seconds, peak memory: 67.988 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 67.988 GB
[18:50:00] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 90941 nodes and 738066 edges into 6 parts and get 32223 edge cuts
Metis partitioning: 0.159 seconds, peak memory: 67.988 GB
Split the graph: 0.064 seconds
Construct subgraphs: 0.006 seconds
15163
15158
15154
15157
15150
15159
The batched output nid list before graph partition
connection checking time:  3.837350845336914
block generation total time  3.4813687801361084
generate_dataloader_block spend   7.946270942687988
pure train time  3.9657535552978516
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.3828125 GB
    Memory Allocated: 0.22498083114624023  GigaBytes
Max Memory Allocated: 13.166175365447998  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.6141247749328613
loading full batch data spends  0.06607794761657715
Convert a graph into a bidirected graph: 0.020 seconds, peak memory: 68.012 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 68.012 GB
[18:50:13] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 90941 nodes and 738066 edges into 6 parts and get 32223 edge cuts
Metis partitioning: 0.157 seconds, peak memory: 68.012 GB
Split the graph: 0.080 seconds
Construct subgraphs: 0.007 seconds
15163
15158
15154
15157
15150
15159
The batched output nid list before graph partition
connection checking time:  3.87477970123291
block generation total time  3.5610008239746094
generate_dataloader_block spend   8.096012353897095
pure train time  3.9723093509674072
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.82421875 GB
    Memory Allocated: 0.2255253791809082  GigaBytes
Max Memory Allocated: 13.173163414001465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.080289125442505
loading full batch data spends  0.0678720474243164
Convert a graph into a bidirected graph: 0.018 seconds, peak memory: 69.492 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.492 GB
[18:50:26] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 90941 nodes and 738066 edges into 6 parts and get 32223 edge cuts
Metis partitioning: 0.156 seconds, peak memory: 69.492 GB
Split the graph: 0.091 seconds
Construct subgraphs: 0.010 seconds
15163
15158
15154
15157
15150
15159
The batched output nid list before graph partition
connection checking time:  3.857327938079834
block generation total time  3.511803150177002
generate_dataloader_block spend   8.036675930023193
pure train time  3.964235305786133
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.82421875 GB
    Memory Allocated: 0.22540664672851562  GigaBytes
Max Memory Allocated: 13.173163414001465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0677688121795654
loading full batch data spends  0.0528111457824707
Convert a graph into a bidirected graph: 0.017 seconds, peak memory: 69.542 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.542 GB
[18:50:39] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 90941 nodes and 738066 edges into 6 parts and get 32223 edge cuts
Metis partitioning: 0.155 seconds, peak memory: 69.542 GB
Split the graph: 0.076 seconds
Construct subgraphs: 0.008 seconds
15163
15158
15154
15157
15150
15159
The batched output nid list before graph partition
connection checking time:  3.930065631866455
block generation total time  3.631654739379883
generate_dataloader_block spend   8.20727014541626
pure train time  3.963132858276367
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.82421875 GB
    Memory Allocated: 0.22565793991088867  GigaBytes
Max Memory Allocated: 13.173163414001465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0676960945129395
loading full batch data spends  0.059690237045288086
Convert a graph into a bidirected graph: 0.015 seconds, peak memory: 69.547 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.547 GB
[18:50:52] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 90941 nodes and 738066 edges into 6 parts and get 32223 edge cuts
Metis partitioning: 0.147 seconds, peak memory: 69.547 GB
Split the graph: 0.083 seconds
Construct subgraphs: 0.004 seconds
15163
15158
15154
15157
15150
15159
The batched output nid list before graph partition
connection checking time:  3.8078453540802
block generation total time  3.4928133487701416
generate_dataloader_block spend   7.884403467178345
pure train time  3.9809088706970215
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.82421875 GB
    Memory Allocated: 0.2253561019897461  GigaBytes
Max Memory Allocated: 13.173163414001465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0312092304229736
loading full batch data spends  0.05673480033874512
Convert a graph into a bidirected graph: 0.016 seconds, peak memory: 69.557 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.557 GB
[18:51:05] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 90941 nodes and 738066 edges into 6 parts and get 32223 edge cuts
Metis partitioning: 0.157 seconds, peak memory: 69.557 GB
Split the graph: 0.058 seconds
Construct subgraphs: 0.005 seconds
15163
15158
15154
15157
15150
15159
The batched output nid list before graph partition
connection checking time:  3.852659225463867
block generation total time  3.5230979919433594
generate_dataloader_block spend   7.989396095275879
pure train time  3.970379590988159
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.82421875 GB
    Memory Allocated: 0.22564268112182617  GigaBytes
Max Memory Allocated: 13.173163414001465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.960914373397827
loading full batch data spends  0.0482943058013916
Convert a graph into a bidirected graph: 0.014 seconds, peak memory: 69.558 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.558 GB
[18:51:18] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 90941 nodes and 738066 edges into 6 parts and get 32223 edge cuts
Metis partitioning: 0.152 seconds, peak memory: 69.558 GB
Split the graph: 0.081 seconds
Construct subgraphs: 0.005 seconds
15163
15158
15154
15157
15150
15159
The batched output nid list before graph partition
connection checking time:  3.1210410594940186
block generation total time  3.177368402481079
generate_dataloader_block spend   6.827009916305542
pure train time  3.9794440269470215
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.82421875 GB
    Memory Allocated: 0.22533178329467773  GigaBytes
Max Memory Allocated: 13.173163414001465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.870706081390381
loading full batch data spends  0.06281781196594238
Convert a graph into a bidirected graph: 0.019 seconds, peak memory: 69.558 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 69.558 GB
[18:51:30] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 90941 nodes and 738066 edges into 6 parts and get 32223 edge cuts
Metis partitioning: 0.154 seconds, peak memory: 69.558 GB
Split the graph: 0.072 seconds
Construct subgraphs: 0.007 seconds
15163
15158
15154
15157
15150
15159
The batched output nid list before graph partition
connection checking time:  3.8502001762390137
block generation total time  3.541222095489502
generate_dataloader_block spend   8.026153802871704
pure train time  3.9839582443237305
-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.82421875 GB
    Memory Allocated: 0.22517061233520508  GigaBytes
Max Memory Allocated: 13.173163414001465  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7698583602905273
Total (block generation + training)time/epoch 12.933667373657226
pure train time/epoch 3.9736764828364053

num_input_list  [792400, 791803, 792677, 792519, 792746, 792944, 793070, 792242, 792524, 793009]