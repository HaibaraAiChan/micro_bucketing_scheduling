main start at this time 1689056650.8255002
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04589438438415527
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.7818892002105713
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.0008833408355712891
self.weights_list  [0.38857061171528795, 0.26453414851387164, 0.20335162358012338, 0.14354361619071707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014909029006958008
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.783038854598999
len local_batched_seeds_list  4
partition total batch output list spend :  0.9890148639678955
self.buckets_partition() spend  sec:  0.797999382019043
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.556640625 GB
    Memory Allocated: 0.1100163459777832  GigaBytes
Max Memory Allocated: 0.1100163459777832  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.361328125 GB
    Memory Allocated: 15.511442184448242  GigaBytes
Max Memory Allocated: 16.38003969192505  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.361328125 GB
    Memory Allocated: 15.517390251159668  GigaBytes
Max Memory Allocated: 16.38003969192505  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.59375 GB
    Memory Allocated: 0.15134096145629883  GigaBytes
Max Memory Allocated: 16.38003969192505  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.828125 GB
    Memory Allocated: 17.578222274780273  GigaBytes
Max Memory Allocated: 18.501481533050537  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.828125 GB
    Memory Allocated: 17.582037448883057  GigaBytes
Max Memory Allocated: 18.501481533050537  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.31640625 GB
    Memory Allocated: 0.1529855728149414  GigaBytes
Max Memory Allocated: 18.501481533050537  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.4609375 GB
    Memory Allocated: 20.414469718933105  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.4609375 GB
    Memory Allocated: 20.417226314544678  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.953125 GB
    Memory Allocated: 0.15369224548339844  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.955078125 GB
    Memory Allocated: 14.29048490524292  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.955078125 GB
    Memory Allocated: 14.292510986328125  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 0.22575759887695312  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.776103973388672
pure train time :  2.984917402267456
train time :  4.554795742034912
end to end time :  10.585856199264526
connection check time:  2.124983787536621
block generation time  2.8912007808685303
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.030539512634277344
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.3108077049255371
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.00043129920959472656
self.weights_list  [0.38857061171528795, 0.26453414851387164, 0.20335162358012338, 0.14354361619071707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013904571533203125
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.3114173412322998
len local_batched_seeds_list  4
partition total batch output list spend :  0.40277862548828125
self.buckets_partition() spend  sec:  0.3253669738769531
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 0.21491575241088867  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 15.630810737609863  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 15.633048057556152  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 0.21767187118530273  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 17.71289587020874  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 17.716894149780273  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.95703125 GB
    Memory Allocated: 0.21909618377685547  GigaBytes
Max Memory Allocated: 21.490967273712158  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.361328125 GB
    Memory Allocated: 20.46434783935547  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.361328125 GB
    Memory Allocated: 20.46721315383911  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.375 GB
    Memory Allocated: 0.21889019012451172  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.375 GB
    Memory Allocated: 14.311458587646484  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.375 GB
    Memory Allocated: 14.313507556915283  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.376953125 GB
    Memory Allocated: 0.22547435760498047  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.190448760986328
pure train time :  2.583749532699585
train time :  3.6513242721557617
end to end time :  6.7640650272369385
connection check time:  1.173046588897705
block generation time  1.5134289264678955
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04882311820983887
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.7243266105651855
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.0004703998565673828
self.weights_list  [0.38857061171528795, 0.26453414851387164, 0.20335162358012338, 0.14354361619071707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01572895050048828
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.7251114845275879
len local_batched_seeds_list  4
partition total batch output list spend :  0.8507812023162842
self.buckets_partition() spend  sec:  0.7408914566040039
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.376953125 GB
    Memory Allocated: 0.21498680114746094  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.376953125 GB
    Memory Allocated: 15.631972789764404  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.376953125 GB
    Memory Allocated: 15.634257793426514  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.376953125 GB
    Memory Allocated: 0.2176961898803711  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.376953125 GB
    Memory Allocated: 17.69790554046631  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.376953125 GB
    Memory Allocated: 17.701720714569092  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.376953125 GB
    Memory Allocated: 0.21909666061401367  GigaBytes
Max Memory Allocated: 21.54073667526245  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 20.48495054244995  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 20.487815856933594  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 0.21895313262939453  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 14.329368114471436  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 14.33135461807251  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 0.22550582885742188  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.6070051193237305
pure train time :  2.547466516494751
train time :  3.639575481414795
end to end time :  9.561315059661865
connection check time:  2.058746814727783
block generation time  2.984142303466797
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04552960395812988
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.6327424049377441
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.0005211830139160156
self.weights_list  [0.38857061171528795, 0.26453414851387164, 0.20335162358012338, 0.14354361619071707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015779495239257812
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.633521556854248
len local_batched_seeds_list  4
partition total batch output list spend :  0.7595043182373047
self.buckets_partition() spend  sec:  0.6493556499481201
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 0.21503734588623047  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 15.631647109985352  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 15.633885860443115  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 0.21762704849243164  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 17.69300889968872  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 17.696824073791504  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 0.21909618377685547  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 20.46083641052246  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.388671875 GB
    Memory Allocated: 20.463701725006104  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.759765625 GB
    Memory Allocated: 0.21892833709716797  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.330483436584473  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 14.332532405853271  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.22548484802246094  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0807125568389893
pure train time :  2.5878055095672607
train time :  3.659298896789551
end to end time :  9.381512880325317
connection check time:  2.023770570755005
block generation time  2.9064347743988037
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04727959632873535
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.7373886108398438
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.0004601478576660156
self.weights_list  [0.38857061171528795, 0.26453414851387164, 0.20335162358012338, 0.14354361619071707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0174710750579834
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.7380614280700684
len local_batched_seeds_list  4
partition total batch output list spend :  0.8607597351074219
self.buckets_partition() spend  sec:  0.7555797100067139
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.21493959426879883  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 15.608742713928223  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 15.610973834991455  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.21766042709350586  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.70017433166504  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 17.703989505767822  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.763671875 GB
    Memory Allocated: 0.21909570693969727  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 20.475770950317383  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 20.478636264801025  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 0.21901226043701172  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 14.335407257080078  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 14.337454319000244  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 0.2255992889404297  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0672924518585205
pure train time :  2.5522165298461914
train time :  3.6249074935913086
end to end time :  9.342155933380127
connection check time:  1.911611795425415
block generation time  2.9239659309387207
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.03130078315734863
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.7423715591430664
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.00045108795166015625
self.weights_list  [0.38857061171528795, 0.26453414851387164, 0.20335162358012338, 0.14354361619071707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01593327522277832
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.7430336475372314
len local_batched_seeds_list  4
partition total batch output list spend :  0.8485982418060303
self.buckets_partition() spend  sec:  0.7590169906616211
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 0.21491336822509766  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 15.616313457489014  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 15.61846399307251  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 0.21757745742797852  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 17.689268589019775  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 17.69308376312256  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.40234375 GB
    Memory Allocated: 0.21909523010253906  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 20.480680465698242  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 20.483545780181885  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.2195415496826172  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 14.330979824066162  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 14.332995414733887  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.2264699935913086  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.068027973175049
pure train time :  2.559202194213867
train time :  3.62888503074646
end to end time :  8.256653070449829
connection check time:  1.9169745445251465
block generation time  1.8489160537719727
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.054291486740112305
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.8203451633453369
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.0004870891571044922
self.weights_list  [0.38857061171528795, 0.26453414851387164, 0.20335162358012338, 0.14354361619071707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016636133193969727
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.8210635185241699
len local_batched_seeds_list  4
partition total batch output list spend :  1.0354485511779785
self.buckets_partition() spend  sec:  0.8377518653869629
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21489191055297852  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 15.609477519989014  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 15.611670017242432  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21761512756347656  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 17.69197416305542  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 17.695789337158203  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21909570693969727  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 20.473293781280518  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 20.476118564605713  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.2190570831298828  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 14.323520183563232  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 14.325469970703125  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.2262887954711914  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0293924808502197
pure train time :  2.5572426319122314
train time :  3.6211209297180176
end to end time :  9.707274436950684
connection check time:  2.1256449222564697
block generation time  2.898761749267578
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04700064659118652
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.7927272319793701
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.00041556358337402344
self.weights_list  [0.38857061171528795, 0.26453414851387164, 0.20335162358012338, 0.14354361619071707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015640735626220703
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.7933566570281982
len local_batched_seeds_list  4
partition total batch output list spend :  0.9140210151672363
self.buckets_partition() spend  sec:  0.809124231338501
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.2149815559387207  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 15.62966537475586  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 15.631885528564453  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21759510040283203  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 17.694525718688965  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 17.698340892791748  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21909666061401367  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 20.477487564086914  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 20.480352878570557  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21954917907714844  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 14.337166786193848  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 14.339192867279053  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.2265334129333496  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.958228349685669
pure train time :  2.562154531478882
train time :  3.6284947395324707
end to end time :  9.652830362319946
connection check time:  2.1386513710021973
block generation time  2.9505202770233154
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.050641536712646484
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.7858059406280518
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.00046944618225097656
self.weights_list  [0.38857061171528795, 0.26453414851387164, 0.20335162358012338, 0.14354361619071707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016496658325195312
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.786527156829834
len local_batched_seeds_list  4
partition total batch output list spend :  0.9121651649475098
self.buckets_partition() spend  sec:  0.8030781745910645
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21499919891357422  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 15.643553256988525  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 15.64585256576538  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21767711639404297  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 17.678382396697998  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 17.681967735290527  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21918773651123047  GigaBytes
Max Memory Allocated: 21.56196880340576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 20.488988399505615  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 20.491811752319336  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21941232681274414  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 14.326207637786865  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 14.328189849853516  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.22637462615966797  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8694615364074707
pure train time :  2.572967767715454
train time :  3.648012161254883
end to end time :  9.407914161682129
connection check time:  1.9202592372894287
block generation time  2.9031949043273926
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05001068115234375
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  4
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 3, 5, 7, 11, 13]
original bucket_id :,  [1, 7, 9, 11, 16, 17]
remove weights:  [3519  871  787  715  567  541], 		------------sum 7000

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [1, 2, 3, 4, 5, 7, 8, 11, 12]
original bucket_id :,  [5, 8, 10, 12, 13, 15, 18, 22, 23]
remove weights:  [1017  827  716  678  634  560  530  435  433], 		------------sum 5830

before remove weights,  [1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [1168, 623, 506, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [1, 7, 9, 11, 16, 17], [5, 8, 10, 12, 13, 15, 18, 22, 23], [3, 14, 19, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [3519, 871, 787, 715, 567, 541], [1017, 827, 716, 678, 634, 560, 530, 435, 433], [1168, 623, 506, 505, 428]]
G_BUCKET_ID_list length 4
backpack scheduling spend  0.7965919971466064
[0, 2, 4, 6]
current group_mem  7.002414301287581
[1, 7, 9, 11, 16, 17]
current group_mem  7.002974631416949
[5, 8, 10, 12, 13, 15, 18, 22, 23]
current group_mem  5.834143353778922
[3, 14, 19, 20, 21]
current group_mem  3.2316760091562324
batches output list generation spend  0.00043964385986328125
self.weights_list  [0.38857061171528795, 0.26453414851387164, 0.20335162358012338, 0.14354361619071707]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015235424041748047
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.7972679138183594
len local_batched_seeds_list  4
partition total batch output list spend :  0.9392247200012207
self.buckets_partition() spend  sec:  0.812554121017456
layer  0
 the number of batches:  4
check_connections_block*********************************
res  length 4
layer  1
num of batch  4
check_connections_block*********************************
res  length 4
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21555280685424805  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 15.64009141921997  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 15.641630172729492  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21686887741088867  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 17.679102420806885  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 17.682917594909668  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.2185807228088379  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 20.46248435974121  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 20.46526861190796  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.21896028518676758  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 14.340129375457764  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 14.342178344726562  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 23.62890625 GB
    Memory Allocated: 0.22594165802001953  GigaBytes
Max Memory Allocated: 21.567052364349365  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7684593200683594
pure train time :  2.5643773078918457
train time :  3.6290957927703857
end to end time :  9.52290153503418
connection check time:  2.0488455295562744
block generation time  2.8892388343811035
end to end time  9.744996786117554
Total (block generation + training)time/epoch 9.744996786117554
pure train time per /epoch  [2.984917402267456, 2.583749532699585, 2.547466516494751, 2.5878055095672607, 2.5522165298461914, 2.559202194213867, 2.5572426319122314, 2.562154531478882, 2.572967767715454, 2.5643773078918457]
pure train time average  2.5651380675179616
input num list  [564617, 564286, 564452, 564643, 564661, 564572, 564896, 565031, 564265, 564878]
