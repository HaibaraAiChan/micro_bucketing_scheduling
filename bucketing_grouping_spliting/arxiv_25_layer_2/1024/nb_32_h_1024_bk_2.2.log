main start at this time 1690865389.0774052
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
the grouping_fanout_arxiv called successfully
capacity  2199
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2164]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [2164], 		------------sum 2164

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2127]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [2127], 		------------sum 2127

before remove weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2122]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [2122], 		------------sum 2122

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2091]

remove bucket_id:  [0]
original bucket_id :,  [2]
remove weights:  [2091], 		------------sum 2091

before remove weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [2085], 		------------sum 2085

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2056]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [2056], 		------------sum 2056

before remove weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2003]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [2003], 		------------sum 2003

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1983]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1983], 		------------sum 1983

before remove weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1962]

remove bucket_id:  [0]
original bucket_id :,  [1]
remove weights:  [1962], 		------------sum 1962

before remove weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1875]

remove bucket_id:  [0]
original bucket_id :,  [11]
remove weights:  [1875], 		------------sum 1875

before remove weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1874]

remove bucket_id:  [0]
original bucket_id :,  [10]
remove weights:  [1874], 		------------sum 1874

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1773]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1773], 		------------sum 1773

before remove weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1723], 		------------sum 1723

before remove weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1682]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1682], 		------------sum 1682

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1672]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1672], 		------------sum 1672

before remove weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1584]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1584], 		------------sum 1584

before remove weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1579]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1579], 		------------sum 1579

before remove weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1530]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1530], 		------------sum 1530

before remove weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1511]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1511], 		------------sum 1511

before remove weights,  [1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1481, 1429, 1294, 1293, 1283]
res_tmp  [1481]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1481], 		------------sum 1481

before remove weights,  [1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1429, 1294, 1293, 1283]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1294, 1293, 1283]
after remove pre pack weights,  [1294, 1293, 1283]
res_tmp  [1294]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1294], 		------------sum 1294

before remove weights,  [1294, 1293, 1283]
after remove pre pack weights,  [1293, 1283]
res_tmp  [1293]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1293], 		------------sum 1293

before remove weights,  [1293, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[4], [5], [3], [2], [6], [7], [8], [9], [1], [11], [10], [12], [13], [14], [0], [16], [15], [17], [18], [19], [20], [22], [23], [21]]
Groups_mem_list  [[2164], [2127], [2122], [2091], [2085], [2056], [2003], [1983], [1962], [1875], [1874], [1773], [1723], [1682], [1672], [1584], [1579], [1530], [1511], [1481], [1429], [1294], [1293], [1283], [1283]]
G_BUCKET_ID_list length 24
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  32
current group_mem  2.164434594135045
current group_mem  2.1270061419533235
current group_mem  2.1225820131933104
current group_mem  2.091162774761497
current group_mem  2.0853221102618043
current group_mem  2.056020043092527
current group_mem  2.003826841183247
current group_mem  1.9838461929404219
current group_mem  1.9625855842993116
current group_mem  1.8757872602731587
current group_mem  1.8742896464201482
current group_mem  1.7739355233489074
current group_mem  1.7230819912868847
current group_mem  1.6827613338597718
current group_mem  1.6722423737809742
current group_mem  1.5840132793947195
current group_mem  1.5790509384345839
current group_mem  1.5308580965452556
current group_mem  1.511252469938908
current group_mem  1.481189862667495
current group_mem  1.429230435772136
current group_mem  1.2942055601305504
current group_mem  1.2939860083007813
current group_mem  1.2836578043908993
batches output list generation spend  0.001283884048461914
self.weights_list  [0.0716728428321659, 0.05678406879185406, 0.08374660494166547, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.03183382632695924, 0.13197567653753534, 0.024554381412124345, 0.027479354746483983, 0.021464465972443673, 0.019023322813692393, 0.017428882462255747, 0.15091103022838984, 0.014580882110379258, 0.015471569479112832, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.008961854389109422, 0.009027831231237836, 0.009368711582234636, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014721155166625977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7522263526916504
len local_batched_seeds_list  32
partition total batch output list spend :  1.8643367290496826
self.buckets_partition() spend  sec:  0.7669737339019775
layer  0
 the number of batches:  32
check_connections_block*********************************

the find indices time spent  0.05380535125732422

in edges time spent  0.1404569149017334
local to global src and eids time spent  0.1474606990814209
time gen tails  0.06936311721801758
res  length 32
layer  1
num of batch  32
check_connections_block*********************************

the find indices time spent  0.14623308181762695

in edges time spent  1.199500560760498
local to global src and eids time spent  1.9673998355865479
time gen tails  0.39622998237609863
res  length 32
block collection to dataloader spend  6.29425048828125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.51171875 GB
    Memory Allocated: 0.08007526397705078  GigaBytes
Max Memory Allocated: 0.08007526397705078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.263671875 GB
    Memory Allocated: 4.505245685577393  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 6.263671875 GB
    Memory Allocated: 4.506217956542969  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 6.5703125 GB
    Memory Allocated: 0.1127314567565918  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.388671875 GB
    Memory Allocated: 4.352663516998291  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 7.388671875 GB
    Memory Allocated: 4.353433609008789  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 7.388671875 GB
    Memory Allocated: 0.11577701568603516  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.408203125 GB
    Memory Allocated: 4.339505672454834  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.408203125 GB
    Memory Allocated: 4.340822219848633  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.408203125 GB
    Memory Allocated: 0.11690950393676758  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 4.219245910644531  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 4.220940113067627  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 0.11459207534790039  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 4.244107723236084  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 4.244755268096924  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 0.11377954483032227  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 4.186308860778809  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 4.18687105178833  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 0.11335420608520508  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 4.058574199676514  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 4.059062480926514  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 0.11340808868408203  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 3.993286609649658  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 3.9937186241149902  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.69140625 GB
    Memory Allocated: 0.11933612823486328  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.76953125 GB
    Memory Allocated: 3.7887768745422363  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.76953125 GB
    Memory Allocated: 3.7905659675598145  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 0.11414813995361328  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 3.6837267875671387  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 3.6840600967407227  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 0.11360931396484375  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 3.7568445205688477  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 3.7572174072265625  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 0.11262750625610352  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 3.488950729370117  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 3.4892420768737793  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 0.11255311965942383  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 3.346982002258301  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 3.347240447998047  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 0.11247825622558594  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 3.249089241027832  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 3.249326229095459  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.94921875 GB
    Memory Allocated: 0.11858463287353516  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.564453125 GB
    Memory Allocated: 2.862287998199463  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.564453125 GB
    Memory Allocated: 2.8651323318481445  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 0.11414480209350586  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 3.045320987701416  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 3.0455193519592285  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 0.1127328872680664  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 3.067272663116455  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 3.0674829483032227  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 0.11276054382324219  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 2.994015693664551  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 2.99420166015625  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 0.11236095428466797  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 2.8578548431396484  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 2.8580241203308105  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 0.11245203018188477  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 2.92044734954834  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 2.920612335205078  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 0.11272573471069336  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 2.7537760734558105  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 2.753927707672119  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.76953125 GB
    Memory Allocated: 0.11119747161865234  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.4500060081481934  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.4501280784606934  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.11166954040527344  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.479902744293213  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.4800257682800293  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.11219167709350586  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.489741802215576  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.4898695945739746  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.0994572639465332  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.0723066329956055  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.0723514556884766  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.09989547729492188  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.0718984603881836  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.0719432830810547  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.09932470321655273  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.0527172088623047  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.0527620315551758  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.10035324096679688  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.073378086090088  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.073422908782959  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.10014486312866211  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.0634188652038574  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.0634636878967285  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.10066843032836914  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.0663790702819824  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.0664238929748535  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.10056018829345703  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.063035011291504  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.063079833984375  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.10025882720947266  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.038830280303955  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.0388731956481934  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1669754981994629  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.77518892288208
pure train time :  3.072052478790283
train time :  5.849822759628296
end to end time :  15.028207063674927
connection check time:  4.867072105407715
block generation time  2.423955202102661
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
the grouping_fanout_arxiv called successfully
capacity  2199
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2164]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [2164], 		------------sum 2164

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2127]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [2127], 		------------sum 2127

before remove weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2122]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [2122], 		------------sum 2122

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2091]

remove bucket_id:  [0]
original bucket_id :,  [2]
remove weights:  [2091], 		------------sum 2091

before remove weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [2085], 		------------sum 2085

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2056]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [2056], 		------------sum 2056

before remove weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2003]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [2003], 		------------sum 2003

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1983]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1983], 		------------sum 1983

before remove weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1962]

remove bucket_id:  [0]
original bucket_id :,  [1]
remove weights:  [1962], 		------------sum 1962

before remove weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1875]

remove bucket_id:  [0]
original bucket_id :,  [11]
remove weights:  [1875], 		------------sum 1875

before remove weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1874]

remove bucket_id:  [0]
original bucket_id :,  [10]
remove weights:  [1874], 		------------sum 1874

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1773]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1773], 		------------sum 1773

before remove weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1723], 		------------sum 1723

before remove weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1682]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1682], 		------------sum 1682

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1672]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1672], 		------------sum 1672

before remove weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1584]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1584], 		------------sum 1584

before remove weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1579]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1579], 		------------sum 1579

before remove weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1530]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1530], 		------------sum 1530

before remove weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1511]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1511], 		------------sum 1511

before remove weights,  [1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1481, 1429, 1294, 1293, 1283]
res_tmp  [1481]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1481], 		------------sum 1481

before remove weights,  [1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1429, 1294, 1293, 1283]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1294, 1293, 1283]
after remove pre pack weights,  [1294, 1293, 1283]
res_tmp  [1294]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1294], 		------------sum 1294

before remove weights,  [1294, 1293, 1283]
after remove pre pack weights,  [1293, 1283]
res_tmp  [1293]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1293], 		------------sum 1293

before remove weights,  [1293, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[4], [5], [3], [2], [6], [7], [8], [9], [1], [11], [10], [12], [13], [14], [0], [16], [15], [17], [18], [19], [20], [22], [23], [21]]
Groups_mem_list  [[2164], [2127], [2122], [2091], [2085], [2056], [2003], [1983], [1962], [1875], [1874], [1773], [1723], [1682], [1672], [1584], [1579], [1530], [1511], [1481], [1429], [1294], [1293], [1283], [1283]]
G_BUCKET_ID_list length 24
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  32
current group_mem  2.164434594135045
current group_mem  2.1270061419533235
current group_mem  2.1225820131933104
current group_mem  2.091162774761497
current group_mem  2.0853221102618043
current group_mem  2.056020043092527
current group_mem  2.003826841183247
current group_mem  1.9838461929404219
current group_mem  1.9625855842993116
current group_mem  1.8757872602731587
current group_mem  1.8742896464201482
current group_mem  1.7739355233489074
current group_mem  1.7230819912868847
current group_mem  1.6827613338597718
current group_mem  1.6722423737809742
current group_mem  1.5840132793947195
current group_mem  1.5790509384345839
current group_mem  1.5308580965452556
current group_mem  1.511252469938908
current group_mem  1.481189862667495
current group_mem  1.429230435772136
current group_mem  1.2942055601305504
current group_mem  1.2939860083007813
current group_mem  1.2836578043908993
batches output list generation spend  0.0011477470397949219
self.weights_list  [0.0716728428321659, 0.05678406879185406, 0.08374660494166547, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.03183382632695924, 0.13197567653753534, 0.024554381412124345, 0.027479354746483983, 0.021464465972443673, 0.019023322813692393, 0.017428882462255747, 0.15091103022838984, 0.014580882110379258, 0.015471569479112832, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.008961854389109422, 0.009027831231237836, 0.009368711582234636, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014793872833251953
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8222568035125732
len local_batched_seeds_list  32
partition total batch output list spend :  1.9295105934143066
self.buckets_partition() spend  sec:  0.8370842933654785
layer  0
 the number of batches:  32
check_connections_block*********************************

the find indices time spent  0.05535745620727539

in edges time spent  0.14705514907836914
local to global src and eids time spent  0.14855527877807617
time gen tails  0.06816625595092773
res  length 32
layer  1
num of batch  32
check_connections_block*********************************

the find indices time spent  0.14270234107971191

in edges time spent  1.313441276550293
local to global src and eids time spent  1.9298522472381592
time gen tails  0.37508106231689453
res  length 32
block collection to dataloader spend  3.910064697265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17946767807006836  GigaBytes
Max Memory Allocated: 4.70065975189209  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.596200466156006  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.596985816955566  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17880725860595703  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.403329849243164  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.404099941253662  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1818842887878418  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.404629230499268  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.406430244445801  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18290424346923828  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.2612175941467285  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.2626447677612305  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1807541847229004  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.311208248138428  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.311855792999268  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1800680160522461  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.2468791007995605  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.247441291809082  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17959880828857422  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.132129669189453  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.132617950439453  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17954492568969727  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.06294059753418  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.063372611999512  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1855907440185547  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.856442451477051  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.858231544494629  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18023252487182617  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.7430834770202637  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.7434167861938477  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17981576919555664  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.843048095703125  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.84342098236084  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1788797378540039  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.5664892196655273  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.5667805671691895  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17868280410766602  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.4273018836975098  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.427560329437256  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1784048080444336  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.319225788116455  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.319462776184082  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18499326705932617  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9388933181762695  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.941558361053467  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1803569793701172  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.12252140045166  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.1227197647094727  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17861223220825195  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.137589931488037  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.1378002166748047  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1791377067565918  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.0628767013549805  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.0630626678466797  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1783308982849121  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.926453113555908  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9266223907470703  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17837238311767578  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9514036178588867  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.951568603515625  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17883539199829102  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.820713520050049  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.8208651542663574  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17731094360351562  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.522761821746826  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.522883892059326  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1777944564819336  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5716686248779297  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.571791648864746  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17828655242919922  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.529599666595459  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5297274589538574  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1657848358154297  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1404194831848145  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1404643058776855  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16570043563842773  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1279535293579102  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1279983520507812  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16590595245361328  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.137969970703125  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.138014793395996  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16583633422851562  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1271820068359375  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1272268295288086  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16655778884887695  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1297578811645508  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1298027038574219  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16647768020629883  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.130270004272461  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.130314826965332  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1665945053100586  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1376957893371582  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1377406120300293  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16657114028930664  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.106551170349121  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1065940856933594  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16718101501464844  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.191359758377075
pure train time :  2.675082206726074
train time :  4.960871696472168
end to end time :  14.218706607818604
connection check time:  4.835282802581787
block generation time  2.46622371673584
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
the grouping_fanout_arxiv called successfully
capacity  2199
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2164]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [2164], 		------------sum 2164

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2127]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [2127], 		------------sum 2127

before remove weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2122]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [2122], 		------------sum 2122

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2091]

remove bucket_id:  [0]
original bucket_id :,  [2]
remove weights:  [2091], 		------------sum 2091

before remove weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [2085], 		------------sum 2085

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2056]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [2056], 		------------sum 2056

before remove weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2003]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [2003], 		------------sum 2003

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1983]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1983], 		------------sum 1983

before remove weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1962]

remove bucket_id:  [0]
original bucket_id :,  [1]
remove weights:  [1962], 		------------sum 1962

before remove weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1875]

remove bucket_id:  [0]
original bucket_id :,  [11]
remove weights:  [1875], 		------------sum 1875

before remove weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1874]

remove bucket_id:  [0]
original bucket_id :,  [10]
remove weights:  [1874], 		------------sum 1874

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1773]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1773], 		------------sum 1773

before remove weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1723], 		------------sum 1723

before remove weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1682]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1682], 		------------sum 1682

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1672]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1672], 		------------sum 1672

before remove weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1584]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1584], 		------------sum 1584

before remove weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1579]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1579], 		------------sum 1579

before remove weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1530]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1530], 		------------sum 1530

before remove weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1511]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1511], 		------------sum 1511

before remove weights,  [1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1481, 1429, 1294, 1293, 1283]
res_tmp  [1481]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1481], 		------------sum 1481

before remove weights,  [1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1429, 1294, 1293, 1283]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1294, 1293, 1283]
after remove pre pack weights,  [1294, 1293, 1283]
res_tmp  [1294]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1294], 		------------sum 1294

before remove weights,  [1294, 1293, 1283]
after remove pre pack weights,  [1293, 1283]
res_tmp  [1293]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1293], 		------------sum 1293

before remove weights,  [1293, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[4], [5], [3], [2], [6], [7], [8], [9], [1], [11], [10], [12], [13], [14], [0], [16], [15], [17], [18], [19], [20], [22], [23], [21]]
Groups_mem_list  [[2164], [2127], [2122], [2091], [2085], [2056], [2003], [1983], [1962], [1875], [1874], [1773], [1723], [1682], [1672], [1584], [1579], [1530], [1511], [1481], [1429], [1294], [1293], [1283], [1283]]
G_BUCKET_ID_list length 24
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  32
current group_mem  2.164434594135045
current group_mem  2.1270061419533235
current group_mem  2.1225820131933104
current group_mem  2.091162774761497
current group_mem  2.0853221102618043
current group_mem  2.056020043092527
current group_mem  2.003826841183247
current group_mem  1.9838461929404219
current group_mem  1.9625855842993116
current group_mem  1.8757872602731587
current group_mem  1.8742896464201482
current group_mem  1.7739355233489074
current group_mem  1.7230819912868847
current group_mem  1.6827613338597718
current group_mem  1.6722423737809742
current group_mem  1.5840132793947195
current group_mem  1.5790509384345839
current group_mem  1.5308580965452556
current group_mem  1.511252469938908
current group_mem  1.481189862667495
current group_mem  1.429230435772136
current group_mem  1.2942055601305504
current group_mem  1.2939860083007813
current group_mem  1.2836578043908993
batches output list generation spend  0.0011477470397949219
self.weights_list  [0.0716728428321659, 0.05678406879185406, 0.08374660494166547, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.03183382632695924, 0.13197567653753534, 0.024554381412124345, 0.027479354746483983, 0.021464465972443673, 0.019023322813692393, 0.017428882462255747, 0.15091103022838984, 0.014580882110379258, 0.015471569479112832, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.008961854389109422, 0.009027831231237836, 0.009368711582234636, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01789069175720215
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7906255722045898
len local_batched_seeds_list  32
partition total batch output list spend :  1.1959235668182373
self.buckets_partition() spend  sec:  0.8085498809814453
layer  0
 the number of batches:  32
check_connections_block*********************************

the find indices time spent  0.04405379295349121

in edges time spent  0.1033487319946289
local to global src and eids time spent  0.15259742736816406
time gen tails  0.05713534355163574
res  length 32
layer  1
num of batch  32
check_connections_block*********************************

the find indices time spent  0.09720826148986816

in edges time spent  1.3110496997833252
local to global src and eids time spent  1.442028522491455
time gen tails  0.37489795684814453
res  length 32
block collection to dataloader spend  7.152557373046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17946767807006836  GigaBytes
Max Memory Allocated: 4.791130542755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.601953029632568  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.602738380432129  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17869949340820312  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.390162467956543  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.390932559967041  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18188714981079102  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.419445991516113  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.420831203460693  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18285369873046875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.286080360412598  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.2875075340271  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18103885650634766  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.313691139221191  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.314338684082031  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1799015998840332  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.248563289642334  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.2491254806518555  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1796855926513672  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.1315484046936035  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.1320366859436035  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17929506301879883  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.048515319824219  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.048947334289551  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1854701042175293  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.858004093170166  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.859793186187744  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18031883239746094  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.7441086769104004  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.7444419860839844  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1800999641418457  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.851454734802246  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.851827621459961  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17897748947143555  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.5812172889709473  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.5815086364746094  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1784343719482422  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.4037928581237793  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.4040513038635254  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17860078811645508  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.31850004196167  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.318737030029297  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18488264083862305  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9352355003356934  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.937746047973633  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18028497695922852  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.1171116828918457  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.117310047149658  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17876100540161133  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.1327085494995117  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.1329188346862793  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1792283058166504  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.0623888969421387  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.062574863433838  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17849349975585938  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9330716133117676  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9332408905029297  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17853975296020508  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9858503341674805  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9860153198242188  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17884016036987305  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.8264269828796387  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.8265786170959473  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17730093002319336  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5164031982421875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5165252685546875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17780399322509766  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5794405937194824  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.579563617706299  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17829370498657227  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5397520065307617  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.53987979888916  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16564702987670898  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1275334358215332  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1275782585144043  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1656203269958496  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1273465156555176  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1273913383483887  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16613101959228516  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.135389804840088  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.135434627532959  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16616582870483398  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.135241985321045  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.135286808013916  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16613531112670898  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1267423629760742  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1267871856689453  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1669316291809082  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1385931968688965  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1386380195617676  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16664886474609375  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1348443031311035  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1348891258239746  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16665077209472656  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.107191562652588  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1072344779968262  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16726160049438477  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.60444974899292
pure train time :  2.6194546222686768
train time :  4.950602769851685
end to end time :  12.83620810508728
connection check time:  4.267417669296265
block generation time  2.400808572769165
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
the grouping_fanout_arxiv called successfully
capacity  2199
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2164]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [2164], 		------------sum 2164

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2127]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [2127], 		------------sum 2127

before remove weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2122]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [2122], 		------------sum 2122

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2091]

remove bucket_id:  [0]
original bucket_id :,  [2]
remove weights:  [2091], 		------------sum 2091

before remove weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [2085], 		------------sum 2085

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2056]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [2056], 		------------sum 2056

before remove weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2003]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [2003], 		------------sum 2003

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1983]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1983], 		------------sum 1983

before remove weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1962]

remove bucket_id:  [0]
original bucket_id :,  [1]
remove weights:  [1962], 		------------sum 1962

before remove weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1875]

remove bucket_id:  [0]
original bucket_id :,  [11]
remove weights:  [1875], 		------------sum 1875

before remove weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1874]

remove bucket_id:  [0]
original bucket_id :,  [10]
remove weights:  [1874], 		------------sum 1874

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1773]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1773], 		------------sum 1773

before remove weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1723], 		------------sum 1723

before remove weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1682]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1682], 		------------sum 1682

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1672]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1672], 		------------sum 1672

before remove weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1584]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1584], 		------------sum 1584

before remove weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1579]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1579], 		------------sum 1579

before remove weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1530]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1530], 		------------sum 1530

before remove weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1511]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1511], 		------------sum 1511

before remove weights,  [1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1481, 1429, 1294, 1293, 1283]
res_tmp  [1481]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1481], 		------------sum 1481

before remove weights,  [1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1429, 1294, 1293, 1283]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1294, 1293, 1283]
after remove pre pack weights,  [1294, 1293, 1283]
res_tmp  [1294]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1294], 		------------sum 1294

before remove weights,  [1294, 1293, 1283]
after remove pre pack weights,  [1293, 1283]
res_tmp  [1293]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1293], 		------------sum 1293

before remove weights,  [1293, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[4], [5], [3], [2], [6], [7], [8], [9], [1], [11], [10], [12], [13], [14], [0], [16], [15], [17], [18], [19], [20], [22], [23], [21]]
Groups_mem_list  [[2164], [2127], [2122], [2091], [2085], [2056], [2003], [1983], [1962], [1875], [1874], [1773], [1723], [1682], [1672], [1584], [1579], [1530], [1511], [1481], [1429], [1294], [1293], [1283], [1283]]
G_BUCKET_ID_list length 24
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  32
current group_mem  2.164434594135045
current group_mem  2.1270061419533235
current group_mem  2.1225820131933104
current group_mem  2.091162774761497
current group_mem  2.0853221102618043
current group_mem  2.056020043092527
current group_mem  2.003826841183247
current group_mem  1.9838461929404219
current group_mem  1.9625855842993116
current group_mem  1.8757872602731587
current group_mem  1.8742896464201482
current group_mem  1.7739355233489074
current group_mem  1.7230819912868847
current group_mem  1.6827613338597718
current group_mem  1.6722423737809742
current group_mem  1.5840132793947195
current group_mem  1.5790509384345839
current group_mem  1.5308580965452556
current group_mem  1.511252469938908
current group_mem  1.481189862667495
current group_mem  1.429230435772136
current group_mem  1.2942055601305504
current group_mem  1.2939860083007813
current group_mem  1.2836578043908993
batches output list generation spend  0.0007450580596923828
self.weights_list  [0.0716728428321659, 0.05678406879185406, 0.08374660494166547, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.03183382632695924, 0.13197567653753534, 0.024554381412124345, 0.027479354746483983, 0.021464465972443673, 0.019023322813692393, 0.017428882462255747, 0.15091103022838984, 0.014580882110379258, 0.015471569479112832, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.008961854389109422, 0.009027831231237836, 0.009368711582234636, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01673412322998047
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.20421576499938965
len local_batched_seeds_list  32
partition total batch output list spend :  0.5551271438598633
self.buckets_partition() spend  sec:  0.22097039222717285
layer  0
 the number of batches:  32
check_connections_block*********************************

the find indices time spent  0.06290531158447266

in edges time spent  0.14934015274047852
local to global src and eids time spent  0.1500401496887207
time gen tails  0.07210946083068848
res  length 32
layer  1
num of batch  32
check_connections_block*********************************

the find indices time spent  0.14335918426513672

in edges time spent  1.0727322101593018
local to global src and eids time spent  1.9870600700378418
time gen tails  0.7680439949035645
res  length 32
block collection to dataloader spend  6.604194641113281e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1794571876525879  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.592107772827148  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.592893123626709  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1784801483154297  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.386101245880127  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.386871337890625  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18189239501953125  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.431069374084473  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.432204723358154  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18308258056640625  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.2877631187438965  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.289190292358398  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1806788444519043  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.293325424194336  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.293972969055176  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18004608154296875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.258115768432617  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.258677959442139  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1795816421508789  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.126650333404541  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.127138614654541  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1793537139892578  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.042174816131592  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.042606830596924  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.185546875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.8657779693603516  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.8675670623779297  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18048954010009766  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.753683090209961  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.754016399383545  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18002748489379883  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.8493146896362305  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.8496875762939453  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1788463592529297  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.567862033843994  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.5681533813476562  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17856073379516602  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.4134039878845215  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.4136624336242676  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1783599853515625  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.318777084350586  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.319014072418213  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1850419044494629  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.935237407684326  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9376564025878906  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18016338348388672  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.1173195838928223  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.1175179481506348  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17847347259521484  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.129728317260742  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.1299386024475098  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17919492721557617  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.061121940612793  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.061307907104492  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17819690704345703  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.928600788116455  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.928770065307617  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17872905731201172  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.959764003753662  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9599289894104004  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17883539199829102  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.8220925331115723  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.822244167327881  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17730236053466797  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5226778984069824  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5227999687194824  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17778778076171875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5690784454345703  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5692014694213867  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17829036712646484  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.548191547393799  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5483193397521973  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16572809219360352  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1408891677856445  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1409339904785156  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16586923599243164  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1386499404907227  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1386947631835938  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16594600677490234  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1259703636169434  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1260151863098145  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16627836227416992  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1416535377502441  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1416983604431152  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16614532470703125  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.134892463684082  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1349372863769531  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16642379760742188  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1410293579101562  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1410741806030273  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1665811538696289  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1359319686889648  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.135976791381836  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16661787033081055  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1046814918518066  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.104724407196045  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16723346710205078  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0835487842559814
pure train time :  2.6282262802124023
train time :  4.977609395980835
end to end time :  13.025182485580444
connection check time:  5.027216911315918
block generation time  2.4464852809906006
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
the grouping_fanout_arxiv called successfully
capacity  2199
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2164]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [2164], 		------------sum 2164

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2127]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [2127], 		------------sum 2127

before remove weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2122]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [2122], 		------------sum 2122

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2091]

remove bucket_id:  [0]
original bucket_id :,  [2]
remove weights:  [2091], 		------------sum 2091

before remove weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [2085], 		------------sum 2085

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2056]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [2056], 		------------sum 2056

before remove weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2003]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [2003], 		------------sum 2003

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1983]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1983], 		------------sum 1983

before remove weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1962]

remove bucket_id:  [0]
original bucket_id :,  [1]
remove weights:  [1962], 		------------sum 1962

before remove weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1875]

remove bucket_id:  [0]
original bucket_id :,  [11]
remove weights:  [1875], 		------------sum 1875

before remove weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1874]

remove bucket_id:  [0]
original bucket_id :,  [10]
remove weights:  [1874], 		------------sum 1874

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1773]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1773], 		------------sum 1773

before remove weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1723], 		------------sum 1723

before remove weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1682]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1682], 		------------sum 1682

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1672]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1672], 		------------sum 1672

before remove weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1584]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1584], 		------------sum 1584

before remove weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1579]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1579], 		------------sum 1579

before remove weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1530]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1530], 		------------sum 1530

before remove weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1511]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1511], 		------------sum 1511

before remove weights,  [1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1481, 1429, 1294, 1293, 1283]
res_tmp  [1481]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1481], 		------------sum 1481

before remove weights,  [1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1429, 1294, 1293, 1283]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1294, 1293, 1283]
after remove pre pack weights,  [1294, 1293, 1283]
res_tmp  [1294]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1294], 		------------sum 1294

before remove weights,  [1294, 1293, 1283]
after remove pre pack weights,  [1293, 1283]
res_tmp  [1293]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1293], 		------------sum 1293

before remove weights,  [1293, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[4], [5], [3], [2], [6], [7], [8], [9], [1], [11], [10], [12], [13], [14], [0], [16], [15], [17], [18], [19], [20], [22], [23], [21]]
Groups_mem_list  [[2164], [2127], [2122], [2091], [2085], [2056], [2003], [1983], [1962], [1875], [1874], [1773], [1723], [1682], [1672], [1584], [1579], [1530], [1511], [1481], [1429], [1294], [1293], [1283], [1283]]
G_BUCKET_ID_list length 24
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  32
current group_mem  2.164434594135045
current group_mem  2.1270061419533235
current group_mem  2.1225820131933104
current group_mem  2.091162774761497
current group_mem  2.0853221102618043
current group_mem  2.056020043092527
current group_mem  2.003826841183247
current group_mem  1.9838461929404219
current group_mem  1.9625855842993116
current group_mem  1.8757872602731587
current group_mem  1.8742896464201482
current group_mem  1.7739355233489074
current group_mem  1.7230819912868847
current group_mem  1.6827613338597718
current group_mem  1.6722423737809742
current group_mem  1.5840132793947195
current group_mem  1.5790509384345839
current group_mem  1.5308580965452556
current group_mem  1.511252469938908
current group_mem  1.481189862667495
current group_mem  1.429230435772136
current group_mem  1.2942055601305504
current group_mem  1.2939860083007813
current group_mem  1.2836578043908993
batches output list generation spend  0.001077890396118164
self.weights_list  [0.0716728428321659, 0.05678406879185406, 0.08374660494166547, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.03183382632695924, 0.13197567653753534, 0.024554381412124345, 0.027479354746483983, 0.021464465972443673, 0.019023322813692393, 0.017428882462255747, 0.15091103022838984, 0.014580882110379258, 0.015471569479112832, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.008961854389109422, 0.009027831231237836, 0.009368711582234636, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.02006816864013672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7786362171173096
len local_batched_seeds_list  32
partition total batch output list spend :  1.1890764236450195
self.buckets_partition() spend  sec:  0.7987351417541504
layer  0
 the number of batches:  32
check_connections_block*********************************

the find indices time spent  0.06347298622131348

in edges time spent  0.16936445236206055
local to global src and eids time spent  0.3758399486541748
time gen tails  0.11516499519348145
res  length 32
layer  1
num of batch  32
check_connections_block*********************************

the find indices time spent  0.14680075645446777

in edges time spent  1.3532965183258057
local to global src and eids time spent  1.9592628479003906
time gen tails  0.3718142509460449
res  length 32
block collection to dataloader spend  3.8623809814453125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17947053909301758  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.5953049659729  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.596090316772461  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1788339614868164  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.388123512268066  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.3888936042785645  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18187236785888672  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.395843029022217  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.3971099853515625  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18294239044189453  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.280884265899658  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.282654762268066  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18079280853271484  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.296479225158691  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.297126770019531  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17993497848510742  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.253872394561768  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.254434585571289  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17973661422729492  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.132627964019775  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.133116245269775  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1793537139892578  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.059703826904297  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.060135841369629  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18550682067871094  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.8542542457580566  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.856372356414795  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18036603927612305  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.746581554412842  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.746914863586426  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18004989624023438  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.84731388092041  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.847686767578125  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17884540557861328  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.559581756591797  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.559873104095459  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17857789993286133  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.4264092445373535  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.4266676902770996  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17833423614501953  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.315553665161133  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.3157906532287598  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18491172790527344  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.936790943145752  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9394617080688477  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18071556091308594  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.1293439865112305  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.129542350769043  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17875289916992188  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.1346778869628906  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.134888172149658  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17838811874389648  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.0650172233581543  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.0652031898498535  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17855453491210938  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9311084747314453  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9312777519226074  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17952203750610352  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.987177848815918  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9873428344726562  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17884254455566406  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.828948497772217  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.8291001319885254  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17731380462646484  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5243868827819824  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5245089530944824  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17778301239013672  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5538477897644043  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5539708137512207  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17829370498657227  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.5486440658569336  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.548771858215332  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16556406021118164  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1258506774902344  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1258955001831055  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1658940315246582  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1307549476623535  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1307997703552246  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16576194763183594  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1273069381713867  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1273517608642578  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1664128303527832  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1338205337524414  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1338653564453125  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16643714904785156  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.129204273223877  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.129249095916748  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1666550636291504  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1314330101013184  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1314778327941895  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1669306755065918  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1381492614746094  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1381940841674805  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16679906845092773  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1049246788024902  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 1.1049675941467285  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.16741561889648438  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.067509889602661
pure train time :  2.6716668605804443
train time :  5.030842542648315
end to end time :  13.943110466003418
connection check time:  5.213294267654419
block generation time  2.489576816558838
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
the grouping_fanout_arxiv called successfully
capacity  2199
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2164]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [2164], 		------------sum 2164

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2127]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [2127], 		------------sum 2127

before remove weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2122]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [2122], 		------------sum 2122

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2091]

remove bucket_id:  [0]
original bucket_id :,  [2]
remove weights:  [2091], 		------------sum 2091

before remove weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [2085], 		------------sum 2085

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2056]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [2056], 		------------sum 2056

before remove weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2003]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [2003], 		------------sum 2003

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1983]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1983], 		------------sum 1983

before remove weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1962]

remove bucket_id:  [0]
original bucket_id :,  [1]
remove weights:  [1962], 		------------sum 1962

before remove weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1875]

remove bucket_id:  [0]
original bucket_id :,  [11]
remove weights:  [1875], 		------------sum 1875

before remove weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1874]

remove bucket_id:  [0]
original bucket_id :,  [10]
remove weights:  [1874], 		------------sum 1874

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1773]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1773], 		------------sum 1773

before remove weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1723], 		------------sum 1723

before remove weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1682]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1682], 		------------sum 1682

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1672]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1672], 		------------sum 1672

before remove weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1584]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1584], 		------------sum 1584

before remove weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1579]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1579], 		------------sum 1579

before remove weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1530]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1530], 		------------sum 1530

before remove weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1511]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1511], 		------------sum 1511

before remove weights,  [1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1481, 1429, 1294, 1293, 1283]
res_tmp  [1481]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1481], 		------------sum 1481

before remove weights,  [1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1429, 1294, 1293, 1283]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1294, 1293, 1283]
after remove pre pack weights,  [1294, 1293, 1283]
res_tmp  [1294]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1294], 		------------sum 1294

before remove weights,  [1294, 1293, 1283]
after remove pre pack weights,  [1293, 1283]
res_tmp  [1293]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1293], 		------------sum 1293

before remove weights,  [1293, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[4], [5], [3], [2], [6], [7], [8], [9], [1], [11], [10], [12], [13], [14], [0], [16], [15], [17], [18], [19], [20], [22], [23], [21]]
Groups_mem_list  [[2164], [2127], [2122], [2091], [2085], [2056], [2003], [1983], [1962], [1875], [1874], [1773], [1723], [1682], [1672], [1584], [1579], [1530], [1511], [1481], [1429], [1294], [1293], [1283], [1283]]
G_BUCKET_ID_list length 24
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  32
current group_mem  2.164434594135045
current group_mem  2.1270061419533235
current group_mem  2.1225820131933104
current group_mem  2.091162774761497
current group_mem  2.0853221102618043
current group_mem  2.056020043092527
current group_mem  2.003826841183247
current group_mem  1.9838461929404219
current group_mem  1.9625855842993116
current group_mem  1.8757872602731587
current group_mem  1.8742896464201482
current group_mem  1.7739355233489074
current group_mem  1.7230819912868847
current group_mem  1.6827613338597718
current group_mem  1.6722423737809742
current group_mem  1.5840132793947195
current group_mem  1.5790509384345839
current group_mem  1.5308580965452556
current group_mem  1.511252469938908
current group_mem  1.481189862667495
current group_mem  1.429230435772136
current group_mem  1.2942055601305504
current group_mem  1.2939860083007813
current group_mem  1.2836578043908993
batches output list generation spend  0.0010499954223632812
self.weights_list  [0.0716728428321659, 0.05678406879185406, 0.08374660494166547, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.03183382632695924, 0.13197567653753534, 0.024554381412124345, 0.027479354746483983, 0.021464465972443673, 0.019023322813692393, 0.017428882462255747, 0.15091103022838984, 0.014580882110379258, 0.015471569479112832, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.008961854389109422, 0.009027831231237836, 0.009368711582234636, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016803264617919922
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.827202320098877
len local_batched_seeds_list  32
partition total batch output list spend :  1.8491542339324951
self.buckets_partition() spend  sec:  0.8440368175506592
layer  0
 the number of batches:  32
check_connections_block*********************************

the find indices time spent  0.06461048126220703

in edges time spent  0.13321232795715332
local to global src and eids time spent  0.15260004997253418
time gen tails  0.07202410697937012
res  length 32
layer  1
num of batch  32
check_connections_block*********************************

the find indices time spent  0.1494302749633789

in edges time spent  1.3093438148498535
local to global src and eids time spent  1.9419686794281006
time gen tails  0.36963629722595215
res  length 32
block collection to dataloader spend  3.7670135498046875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17946290969848633  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.597240924835205  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.598026275634766  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17866802215576172  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.39639139175415  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.397161483764648  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1818838119506836  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.406190872192383  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.4073262214660645  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1834721565246582  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.260600566864014  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.262426376342773  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18085002899169922  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.305410861968994  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.306058406829834  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1799325942993164  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.250892639160156  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.251454830169678  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17936420440673828  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.118866920471191  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.119355201721191  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17935466766357422  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.045433044433594  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 4.045865058898926  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1855483055114746  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.8578310012817383  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.8596200942993164  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1801433563232422  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.7479214668273926  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.7482547760009766  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18001890182495117  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.853023052215576  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.853395938873291  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17889404296875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.566277027130127  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.566568374633789  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17852067947387695  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.4172544479370117  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.417512893676758  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17826414108276367  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.3150887489318848  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.3153257369995117  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.18487787246704102  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9321861267089844  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.934950351715088  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1806497573852539  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.1158204078674316  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.116018772125244  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17867565155029297  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.1316328048706055  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.131843090057373  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17934083938598633  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.064077854156494  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 3.0642638206481934  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.1785869598388672  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9331960678100586  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9333653450012207  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17850685119628906  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9864039421081543  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.9865689277648926  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17884206771850586  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.8273401260375977  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 2.8274917602539062  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.828125 GB
    Memory Allocated: 0.17731142044067383  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.5213770866394043  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.5214991569519043  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.1777796745300293  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.547513008117676  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.547636032104492  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17829370498657227  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.550436496734619  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.5505642890930176  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.1657848358154297  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1285452842712402  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1285901069641113  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.1658954620361328  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1288995742797852  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1289443969726562  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16599416732788086  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1300177574157715  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1300625801086426  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.1664438247680664  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1327829360961914  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1328277587890625  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16659307479858398  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.13411283493042  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.134157657623291  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16647768020629883  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1376314163208008  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1376762390136719  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16659832000732422  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1362366676330566  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1362814903259277  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16628646850585938  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.102402687072754  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1024456024169922  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16689348220825195  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0677497386932373
pure train time :  2.637493371963501
train time :  5.003046751022339
end to end time :  14.181008577346802
connection check time:  4.851178884506226
block generation time  2.4549529552459717
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
the grouping_fanout_arxiv called successfully
capacity  2199
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2164]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [2164], 		------------sum 2164

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2127]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [2127], 		------------sum 2127

before remove weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2122]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [2122], 		------------sum 2122

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2091]

remove bucket_id:  [0]
original bucket_id :,  [2]
remove weights:  [2091], 		------------sum 2091

before remove weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [2085], 		------------sum 2085

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2056]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [2056], 		------------sum 2056

before remove weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2003]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [2003], 		------------sum 2003

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1983]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1983], 		------------sum 1983

before remove weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1962]

remove bucket_id:  [0]
original bucket_id :,  [1]
remove weights:  [1962], 		------------sum 1962

before remove weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1875]

remove bucket_id:  [0]
original bucket_id :,  [11]
remove weights:  [1875], 		------------sum 1875

before remove weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1874]

remove bucket_id:  [0]
original bucket_id :,  [10]
remove weights:  [1874], 		------------sum 1874

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1773]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1773], 		------------sum 1773

before remove weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1723], 		------------sum 1723

before remove weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1682]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1682], 		------------sum 1682

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1672]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1672], 		------------sum 1672

before remove weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1584]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1584], 		------------sum 1584

before remove weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1579]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1579], 		------------sum 1579

before remove weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1530]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1530], 		------------sum 1530

before remove weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1511]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1511], 		------------sum 1511

before remove weights,  [1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1481, 1429, 1294, 1293, 1283]
res_tmp  [1481]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1481], 		------------sum 1481

before remove weights,  [1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1429, 1294, 1293, 1283]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1294, 1293, 1283]
after remove pre pack weights,  [1294, 1293, 1283]
res_tmp  [1294]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1294], 		------------sum 1294

before remove weights,  [1294, 1293, 1283]
after remove pre pack weights,  [1293, 1283]
res_tmp  [1293]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1293], 		------------sum 1293

before remove weights,  [1293, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[4], [5], [3], [2], [6], [7], [8], [9], [1], [11], [10], [12], [13], [14], [0], [16], [15], [17], [18], [19], [20], [22], [23], [21]]
Groups_mem_list  [[2164], [2127], [2122], [2091], [2085], [2056], [2003], [1983], [1962], [1875], [1874], [1773], [1723], [1682], [1672], [1584], [1579], [1530], [1511], [1481], [1429], [1294], [1293], [1283], [1283]]
G_BUCKET_ID_list length 24
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  32
current group_mem  2.164434594135045
current group_mem  2.1270061419533235
current group_mem  2.1225820131933104
current group_mem  2.091162774761497
current group_mem  2.0853221102618043
current group_mem  2.056020043092527
current group_mem  2.003826841183247
current group_mem  1.9838461929404219
current group_mem  1.9625855842993116
current group_mem  1.8757872602731587
current group_mem  1.8742896464201482
current group_mem  1.7739355233489074
current group_mem  1.7230819912868847
current group_mem  1.6827613338597718
current group_mem  1.6722423737809742
current group_mem  1.5840132793947195
current group_mem  1.5790509384345839
current group_mem  1.5308580965452556
current group_mem  1.511252469938908
current group_mem  1.481189862667495
current group_mem  1.429230435772136
current group_mem  1.2942055601305504
current group_mem  1.2939860083007813
current group_mem  1.2836578043908993
batches output list generation spend  0.001050710678100586
self.weights_list  [0.0716728428321659, 0.05678406879185406, 0.08374660494166547, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.03183382632695924, 0.13197567653753534, 0.024554381412124345, 0.027479354746483983, 0.021464465972443673, 0.019023322813692393, 0.017428882462255747, 0.15091103022838984, 0.014580882110379258, 0.015471569479112832, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.008961854389109422, 0.009027831231237836, 0.009368711582234636, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015741348266601562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8263120651245117
len local_batched_seeds_list  32
partition total batch output list spend :  1.8869657516479492
self.buckets_partition() spend  sec:  0.8420798778533936
layer  0
 the number of batches:  32
check_connections_block*********************************

the find indices time spent  0.0558934211730957

in edges time spent  0.16440558433532715
local to global src and eids time spent  0.35596275329589844
time gen tails  0.09761357307434082
res  length 32
layer  1
num of batch  32
check_connections_block*********************************

the find indices time spent  0.1485757827758789

in edges time spent  1.3244519233703613
local to global src and eids time spent  1.9244954586029053
time gen tails  0.37243056297302246
res  length 32
block collection to dataloader spend  4.76837158203125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17946434020996094  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.598418235778809  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.599204063415527  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17860746383666992  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.388221740722656  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.388991832733154  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18189287185668945  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.425271034240723  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.426406383514404  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.1830902099609375  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.293039321899414  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.294466495513916  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18078851699829102  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.308377265930176  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.309024810791016  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18001413345336914  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.248991012573242  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.249553203582764  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17933225631713867  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.121892929077148  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.122381210327148  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.1793503761291504  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.048509120941162  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.048941135406494  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18563413619995117  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.856853485107422  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.858642578125  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18027162551879883  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.7494826316833496  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.7498159408569336  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17992639541625977  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.843219757080078  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.843592643737793  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17904186248779297  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.5698747634887695  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.5701661109924316  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17837142944335938  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.413304328918457  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.413562774658203  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.1784987449645996  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.330780029296875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.331017017364502  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18490076065063477  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.9368433952331543  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.9394664764404297  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18041610717773438  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.1187338829040527  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.1189322471618652  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17865228652954102  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.138111114501953  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.1383213996887207  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.1792464256286621  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.064119815826416  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.0643057823181152  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17830944061279297  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.9255151748657227  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.9256844520568848  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17870044708251953  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.987264633178711  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.987429618835449  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17883825302124023  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.8234739303588867  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.8236255645751953  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17731094360351562  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.5212817192077637  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.5214037895202637  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17778873443603516  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.5664448738098145  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.566567897796631  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.1782979965209961  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.5583395957946777  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.558467388153076  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16598939895629883  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1392908096313477  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1393356323242188  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16594266891479492  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1398215293884277  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1398663520812988  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16597509384155273  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1299424171447754  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1299872398376465  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16594648361206055  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1295356750488281  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1295804977416992  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16640329360961914  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1316747665405273  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1317195892333984  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16662979125976562  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1304669380187988  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.13051176071167  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16655349731445312  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1370768547058105  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1371216773986816  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16628313064575195  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.100569248199463  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 1.1006121635437012  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.16688823699951172  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0291385650634766
pure train time :  2.6795151233673096
train time :  5.041810989379883
end to end time :  14.48795461654663
connection check time:  5.101484775543213
block generation time  2.4396917819976807
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
the grouping_fanout_arxiv called successfully
capacity  2199
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2164]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [2164], 		------------sum 2164

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2127]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [2127], 		------------sum 2127

before remove weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2122]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [2122], 		------------sum 2122

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2091]

remove bucket_id:  [0]
original bucket_id :,  [2]
remove weights:  [2091], 		------------sum 2091

before remove weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [2085], 		------------sum 2085

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2056]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [2056], 		------------sum 2056

before remove weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2003]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [2003], 		------------sum 2003

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1983]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1983], 		------------sum 1983

before remove weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1962]

remove bucket_id:  [0]
original bucket_id :,  [1]
remove weights:  [1962], 		------------sum 1962

before remove weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1875]

remove bucket_id:  [0]
original bucket_id :,  [11]
remove weights:  [1875], 		------------sum 1875

before remove weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1874]

remove bucket_id:  [0]
original bucket_id :,  [10]
remove weights:  [1874], 		------------sum 1874

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1773]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1773], 		------------sum 1773

before remove weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1723], 		------------sum 1723

before remove weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1682]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1682], 		------------sum 1682

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1672]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1672], 		------------sum 1672

before remove weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1584]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1584], 		------------sum 1584

before remove weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1579]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1579], 		------------sum 1579

before remove weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1530]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1530], 		------------sum 1530

before remove weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1511]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1511], 		------------sum 1511

before remove weights,  [1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1481, 1429, 1294, 1293, 1283]
res_tmp  [1481]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1481], 		------------sum 1481

before remove weights,  [1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1429, 1294, 1293, 1283]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1294, 1293, 1283]
after remove pre pack weights,  [1294, 1293, 1283]
res_tmp  [1294]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1294], 		------------sum 1294

before remove weights,  [1294, 1293, 1283]
after remove pre pack weights,  [1293, 1283]
res_tmp  [1293]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1293], 		------------sum 1293

before remove weights,  [1293, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[4], [5], [3], [2], [6], [7], [8], [9], [1], [11], [10], [12], [13], [14], [0], [16], [15], [17], [18], [19], [20], [22], [23], [21]]
Groups_mem_list  [[2164], [2127], [2122], [2091], [2085], [2056], [2003], [1983], [1962], [1875], [1874], [1773], [1723], [1682], [1672], [1584], [1579], [1530], [1511], [1481], [1429], [1294], [1293], [1283], [1283]]
G_BUCKET_ID_list length 24
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  32
current group_mem  2.164434594135045
current group_mem  2.1270061419533235
current group_mem  2.1225820131933104
current group_mem  2.091162774761497
current group_mem  2.0853221102618043
current group_mem  2.056020043092527
current group_mem  2.003826841183247
current group_mem  1.9838461929404219
current group_mem  1.9625855842993116
current group_mem  1.8757872602731587
current group_mem  1.8742896464201482
current group_mem  1.7739355233489074
current group_mem  1.7230819912868847
current group_mem  1.6827613338597718
current group_mem  1.6722423737809742
current group_mem  1.5840132793947195
current group_mem  1.5790509384345839
current group_mem  1.5308580965452556
current group_mem  1.511252469938908
current group_mem  1.481189862667495
current group_mem  1.429230435772136
current group_mem  1.2942055601305504
current group_mem  1.2939860083007813
current group_mem  1.2836578043908993
batches output list generation spend  0.0010061264038085938
self.weights_list  [0.0716728428321659, 0.05678406879185406, 0.08374660494166547, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.03183382632695924, 0.13197567653753534, 0.024554381412124345, 0.027479354746483983, 0.021464465972443673, 0.019023322813692393, 0.017428882462255747, 0.15091103022838984, 0.014580882110379258, 0.015471569479112832, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.008961854389109422, 0.009027831231237836, 0.009368711582234636, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01502847671508789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8108055591583252
len local_batched_seeds_list  32
partition total batch output list spend :  1.8645498752593994
self.buckets_partition() spend  sec:  0.8258616924285889
layer  0
 the number of batches:  32
check_connections_block*********************************

the find indices time spent  0.058327674865722656

in edges time spent  0.14564275741577148
local to global src and eids time spent  0.1485145092010498
time gen tails  0.0708775520324707
res  length 32
layer  1
num of batch  32
check_connections_block*********************************

the find indices time spent  0.14858794212341309

in edges time spent  1.2799737453460693
local to global src and eids time spent  1.9278438091278076
time gen tails  0.36980271339416504
res  length 32
block collection to dataloader spend  3.910064697265625e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17946434020996094  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.595736980438232  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.596522808074951  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.1785907745361328  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.396047592163086  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.396817684173584  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18189144134521484  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.430285930633545  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.432305335998535  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18352890014648438  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.259120941162109  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.261072635650635  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18181228637695312  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.302338600158691  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.302986145019531  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18001508712768555  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.24668550491333  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.247247695922852  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17931604385375977  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.135777473449707  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.136265754699707  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.1795949935913086  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.065620422363281  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 4.066052436828613  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18570756912231445  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.863530158996582  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.865720272064209  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18017244338989258  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.750833511352539  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.751166820526123  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17980003356933594  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.8332605361938477  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.8336334228515625  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17886924743652344  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.5553483963012695  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.5556397438049316  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17871952056884766  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.4220046997070312  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.4222631454467773  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17829465866088867  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.315004348754883  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.3152413368225098  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18494796752929688  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.932858467102051  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.935515880584717  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.18046903610229492  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.1207642555236816  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.120962619781494  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17876291275024414  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.140465259552002  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.1406755447387695  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.1792607307434082  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.062760353088379  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 3.062946319580078  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17828655242919922  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.925018787384033  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.9251880645751953  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17845582962036133  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.9514966011047363  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.9516615867614746  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17884397506713867  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.830449104309082  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.8306007385253906  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17729902267456055  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.5164289474487305  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 2.5165510177612305  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.830078125 GB
    Memory Allocated: 0.17779064178466797  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.560305595397949  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.5604286193847656  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17829370498657227  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.5489773750305176  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.549105167388916  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1657881736755371  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1407694816589355  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1408143043518066  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1657242774963379  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1284980773925781  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1285429000854492  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16614675521850586  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1395378112792969  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.139582633972168  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16591882705688477  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1330766677856445  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1331214904785156  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16619873046875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1275100708007812  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1275548934936523  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16678857803344727  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.141500473022461  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.141545295715332  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16718673706054688  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1447038650512695  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1447486877441406  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1666259765625  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1078076362609863  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1078505516052246  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16723871231079102  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.960465908050537
pure train time :  2.6673550605773926
train time :  4.959461450576782
end to end time :  14.085592269897461
connection check time:  4.800508499145508
block generation time  2.4400534629821777
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
the grouping_fanout_arxiv called successfully
capacity  2199
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2164]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [2164], 		------------sum 2164

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2127]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [2127], 		------------sum 2127

before remove weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2122]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [2122], 		------------sum 2122

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2091]

remove bucket_id:  [0]
original bucket_id :,  [2]
remove weights:  [2091], 		------------sum 2091

before remove weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [2085], 		------------sum 2085

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2056]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [2056], 		------------sum 2056

before remove weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2003]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [2003], 		------------sum 2003

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1983]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1983], 		------------sum 1983

before remove weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1962]

remove bucket_id:  [0]
original bucket_id :,  [1]
remove weights:  [1962], 		------------sum 1962

before remove weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1875]

remove bucket_id:  [0]
original bucket_id :,  [11]
remove weights:  [1875], 		------------sum 1875

before remove weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1874]

remove bucket_id:  [0]
original bucket_id :,  [10]
remove weights:  [1874], 		------------sum 1874

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1773]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1773], 		------------sum 1773

before remove weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1723], 		------------sum 1723

before remove weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1682]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1682], 		------------sum 1682

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1672]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1672], 		------------sum 1672

before remove weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1584]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1584], 		------------sum 1584

before remove weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1579]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1579], 		------------sum 1579

before remove weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1530]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1530], 		------------sum 1530

before remove weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1511]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1511], 		------------sum 1511

before remove weights,  [1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1481, 1429, 1294, 1293, 1283]
res_tmp  [1481]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1481], 		------------sum 1481

before remove weights,  [1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1429, 1294, 1293, 1283]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1294, 1293, 1283]
after remove pre pack weights,  [1294, 1293, 1283]
res_tmp  [1294]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1294], 		------------sum 1294

before remove weights,  [1294, 1293, 1283]
after remove pre pack weights,  [1293, 1283]
res_tmp  [1293]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1293], 		------------sum 1293

before remove weights,  [1293, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[4], [5], [3], [2], [6], [7], [8], [9], [1], [11], [10], [12], [13], [14], [0], [16], [15], [17], [18], [19], [20], [22], [23], [21]]
Groups_mem_list  [[2164], [2127], [2122], [2091], [2085], [2056], [2003], [1983], [1962], [1875], [1874], [1773], [1723], [1682], [1672], [1584], [1579], [1530], [1511], [1481], [1429], [1294], [1293], [1283], [1283]]
G_BUCKET_ID_list length 24
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  32
current group_mem  2.164434594135045
current group_mem  2.1270061419533235
current group_mem  2.1225820131933104
current group_mem  2.091162774761497
current group_mem  2.0853221102618043
current group_mem  2.056020043092527
current group_mem  2.003826841183247
current group_mem  1.9838461929404219
current group_mem  1.9625855842993116
current group_mem  1.8757872602731587
current group_mem  1.8742896464201482
current group_mem  1.7739355233489074
current group_mem  1.7230819912868847
current group_mem  1.6827613338597718
current group_mem  1.6722423737809742
current group_mem  1.5840132793947195
current group_mem  1.5790509384345839
current group_mem  1.5308580965452556
current group_mem  1.511252469938908
current group_mem  1.481189862667495
current group_mem  1.429230435772136
current group_mem  1.2942055601305504
current group_mem  1.2939860083007813
current group_mem  1.2836578043908993
batches output list generation spend  0.0009875297546386719
self.weights_list  [0.0716728428321659, 0.05678406879185406, 0.08374660494166547, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.03183382632695924, 0.13197567653753534, 0.024554381412124345, 0.027479354746483983, 0.021464465972443673, 0.019023322813692393, 0.017428882462255747, 0.15091103022838984, 0.014580882110379258, 0.015471569479112832, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.008961854389109422, 0.009027831231237836, 0.009368711582234636, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015453815460205078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7958786487579346
len local_batched_seeds_list  32
partition total batch output list spend :  1.832641839981079
self.buckets_partition() spend  sec:  0.8113596439361572
layer  0
 the number of batches:  32
check_connections_block*********************************

the find indices time spent  0.05303192138671875

in edges time spent  0.16274595260620117
local to global src and eids time spent  0.35677599906921387
time gen tails  0.0970146656036377
res  length 32
layer  1
num of batch  32
check_connections_block*********************************

the find indices time spent  0.14438605308532715

in edges time spent  1.2933881282806396
local to global src and eids time spent  1.9238126277923584
time gen tails  0.2998361587524414
res  length 32
block collection to dataloader spend  6.222724914550781e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17947053909301758  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.594444751739502  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.5952301025390625  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17884302139282227  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.388138771057129  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.388908863067627  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1818838119506836  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.408515453338623  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.410041809082031  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.18297863006591797  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.263286113739014  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.264713287353516  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1807713508605957  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.300127983093262  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.300775527954102  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17996835708618164  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.249924182891846  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.250486373901367  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17948007583618164  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.126389026641846  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.126877307891846  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17959356307983398  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.059729099273682  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.060161113739014  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1856088638305664  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.8610219955444336  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.8628110885620117  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.18036699295043945  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.7464208602905273  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.7467541694641113  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1799302101135254  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.8471407890319824  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.8475136756896973  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17884063720703125  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.561068058013916  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.561359405517578  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17856740951538086  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.4181222915649414  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.4183807373046875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17838811874389648  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.316880226135254  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.317117214202881  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.18494176864624023  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.9405040740966797  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.9432015419006348  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.18042898178100586  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.1170501708984375  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.11724853515625  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17866802215576172  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.1353759765625  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.1355862617492676  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1791830062866211  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.0593690872192383  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.0595550537109375  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17842721939086914  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.932249069213867  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.9324183464050293  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17861652374267578  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.9599766731262207  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.960141658782959  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1788463592529297  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.857560157775879  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.8577117919921875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17730998992919922  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.5228805541992188  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.5230026245117188  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1777801513671875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.553554058074951  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.5536770820617676  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17828702926635742  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.5333304405212402  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.5334582328796387  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16558456420898438  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.138418197631836  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.138463020324707  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16565227508544922  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1332745552062988  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.13331937789917  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16582345962524414  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1371355056762695  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1371803283691406  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16603755950927734  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1394705772399902  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1395153999328613  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16631031036376953  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1260385513305664  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1260833740234375  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16633129119873047  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1356186866760254  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1356635093688965  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16683626174926758  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1326870918273926  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1327319145202637  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1667804718017578  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.108090877532959  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1081337928771973  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16739511489868164  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.869112253189087
pure train time :  2.586193323135376
train time :  4.936046600341797
end to end time :  14.245020627975464
connection check time:  5.001476049423218
block generation time  2.4517767429351807
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  32
the grouping_fanout_arxiv called successfully
capacity  2199
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2164]

remove bucket_id:  [0]
original bucket_id :,  [4]
remove weights:  [2164], 		------------sum 2164

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2127]

remove bucket_id:  [0]
original bucket_id :,  [5]
remove weights:  [2127], 		------------sum 2127

before remove weights,  [2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2122]

remove bucket_id:  [0]
original bucket_id :,  [3]
remove weights:  [2122], 		------------sum 2122

before remove weights,  [2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2091]

remove bucket_id:  [0]
original bucket_id :,  [2]
remove weights:  [2091], 		------------sum 2091

before remove weights,  [2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085]

remove bucket_id:  [0]
original bucket_id :,  [6]
remove weights:  [2085], 		------------sum 2085

before remove weights,  [2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2056]

remove bucket_id:  [0]
original bucket_id :,  [7]
remove weights:  [2056], 		------------sum 2056

before remove weights,  [2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2003]

remove bucket_id:  [0]
original bucket_id :,  [8]
remove weights:  [2003], 		------------sum 2003

before remove weights,  [2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1983]

remove bucket_id:  [0]
original bucket_id :,  [9]
remove weights:  [1983], 		------------sum 1983

before remove weights,  [1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1962]

remove bucket_id:  [0]
original bucket_id :,  [1]
remove weights:  [1962], 		------------sum 1962

before remove weights,  [1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1875]

remove bucket_id:  [0]
original bucket_id :,  [11]
remove weights:  [1875], 		------------sum 1875

before remove weights,  [1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1874]

remove bucket_id:  [0]
original bucket_id :,  [10]
remove weights:  [1874], 		------------sum 1874

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1773]

remove bucket_id:  [0]
original bucket_id :,  [12]
remove weights:  [1773], 		------------sum 1773

before remove weights,  [1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1723]

remove bucket_id:  [0]
original bucket_id :,  [13]
remove weights:  [1723], 		------------sum 1723

before remove weights,  [1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1682]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [1682], 		------------sum 1682

before remove weights,  [1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1672]

remove bucket_id:  [0]
original bucket_id :,  [0]
remove weights:  [1672], 		------------sum 1672

before remove weights,  [1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1584]

remove bucket_id:  [0]
original bucket_id :,  [16]
remove weights:  [1584], 		------------sum 1584

before remove weights,  [1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1579]

remove bucket_id:  [0]
original bucket_id :,  [15]
remove weights:  [1579], 		------------sum 1579

before remove weights,  [1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1530]

remove bucket_id:  [0]
original bucket_id :,  [17]
remove weights:  [1530], 		------------sum 1530

before remove weights,  [1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [1511]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [1511], 		------------sum 1511

before remove weights,  [1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1481, 1429, 1294, 1293, 1283]
res_tmp  [1481]

remove bucket_id:  [0]
original bucket_id :,  [19]
remove weights:  [1481], 		------------sum 1481

before remove weights,  [1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [1429, 1294, 1293, 1283]
res_tmp  [1429]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [1429], 		------------sum 1429

before remove weights,  [1429, 1294, 1293, 1283]
after remove pre pack weights,  [1294, 1293, 1283]
res_tmp  [1294]

remove bucket_id:  [0]
original bucket_id :,  [22]
remove weights:  [1294], 		------------sum 1294

before remove weights,  [1294, 1293, 1283]
after remove pre pack weights,  [1293, 1283]
res_tmp  [1293]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [1293], 		------------sum 1293

before remove weights,  [1293, 1283]
after remove pre pack weights,  [1283]
the last batch value is  1283
G_BUCKET_ID_list [[4], [5], [3], [2], [6], [7], [8], [9], [1], [11], [10], [12], [13], [14], [0], [16], [15], [17], [18], [19], [20], [22], [23], [21]]
Groups_mem_list  [[2164], [2127], [2122], [2091], [2085], [2056], [2003], [1983], [1962], [1875], [1874], [1773], [1723], [1682], [1672], [1584], [1579], [1530], [1511], [1481], [1429], [1294], [1293], [1283], [1283]]
G_BUCKET_ID_list length 24
len(g_bucket_nids_list)  24
len(local_split_batches_nid_list)  32
current group_mem  2.164434594135045
current group_mem  2.1270061419533235
current group_mem  2.1225820131933104
current group_mem  2.091162774761497
current group_mem  2.0853221102618043
current group_mem  2.056020043092527
current group_mem  2.003826841183247
current group_mem  1.9838461929404219
current group_mem  1.9625855842993116
current group_mem  1.8757872602731587
current group_mem  1.8742896464201482
current group_mem  1.7739355233489074
current group_mem  1.7230819912868847
current group_mem  1.6827613338597718
current group_mem  1.6722423737809742
current group_mem  1.5840132793947195
current group_mem  1.5790509384345839
current group_mem  1.5308580965452556
current group_mem  1.511252469938908
current group_mem  1.481189862667495
current group_mem  1.429230435772136
current group_mem  1.2942055601305504
current group_mem  1.2939860083007813
current group_mem  1.2836578043908993
batches output list generation spend  0.0007388591766357422
self.weights_list  [0.0716728428321659, 0.05678406879185406, 0.08374660494166547, 0.10526605161588283, 0.04773424527990675, 0.04143345685664332, 0.035979371240694516, 0.03183382632695924, 0.13197567653753534, 0.024554381412124345, 0.027479354746483983, 0.021464465972443673, 0.019023322813692393, 0.017428882462255747, 0.15091103022838984, 0.014580882110379258, 0.015471569479112832, 0.013679198601290948, 0.012447630881560572, 0.012128742811273243, 0.011139090179347048, 0.008961854389109422, 0.009027831231237836, 0.009368711582234636, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0032548575450017042, 0.0031229038607448784]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014777183532714844
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.31825900077819824
len local_batched_seeds_list  32
partition total batch output list spend :  0.7639915943145752
self.buckets_partition() spend  sec:  0.33306050300598145
layer  0
 the number of batches:  32
check_connections_block*********************************

the find indices time spent  0.06111335754394531

in edges time spent  0.15261459350585938
local to global src and eids time spent  0.15052199363708496
time gen tails  0.0767359733581543
res  length 32
layer  1
num of batch  32
check_connections_block*********************************

the find indices time spent  0.14867138862609863

in edges time spent  1.3149960041046143
local to global src and eids time spent  1.9553112983703613
time gen tails  0.36580848693847656
res  length 32
block collection to dataloader spend  5.984306335449219e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17946481704711914  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.59553861618042  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.5963239669799805  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1788768768310547  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.408628940582275  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.409399032592773  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.18189191818237305  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.424495220184326  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.425630569458008  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.18353033065795898  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.258469581604004  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.260376930236816  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.18093013763427734  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.300931453704834  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.301578998565674  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1799759864807129  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.2515645027160645  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.252126693725586  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17958831787109375  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.12504768371582  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.12553596496582  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17962169647216797  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.0642290115356445  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 4.064661026000977  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.18546152114868164  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.857344627380371  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.8592796325683594  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.18013477325439453  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.7473177909851074  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.7476511001586914  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1799335479736328  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.847433090209961  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.847805976867676  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17878246307373047  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.5652222633361816  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.5655136108398438  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17863225936889648  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.4231863021850586  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.4234447479248047  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17853307723999023  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.3217382431030273  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.3219752311706543  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.18509674072265625  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.9354352951049805  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.9379191398620605  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.18004465103149414  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.1150193214416504  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.115217685699463  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17885351181030273  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.1378087997436523  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.13801908493042  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17900896072387695  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.064002513885498  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 3.0641884803771973  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1786189079284668  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.9326329231262207  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.932802200317383  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17871952056884766  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.9522881507873535  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.952453136444092  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1788344383239746  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.8180813789367676  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.818233013153076  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17729949951171875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.5113115310668945  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.5114336013793945  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.17779207229614258  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.5690088272094727  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.569131851196289  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1782841682434082  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.52919864654541  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 2.5293264389038086  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16558599472045898  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.136446475982666  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.136491298675537  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1658482551574707  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1390986442565918  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.139143466949463  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16600561141967773  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1299619674682617  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1300067901611328  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16605901718139648  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1301774978637695  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1302223205566406  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16657209396362305  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1313791275024414  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1314239501953125  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16650724411010742  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.13905668258667  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.139101505279541  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.1666550636291504  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1348800659179688  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1349248886108398  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.166473388671875  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1034908294677734  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 1.1035337448120117  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.85546875 GB
    Memory Allocated: 0.16707658767700195  GigaBytes
Max Memory Allocated: 4.7974019050598145  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7693707942962646
pure train time :  2.5375425815582275
train time :  4.9367265701293945
end to end time :  13.093713521957397
connection check time:  4.896904468536377
block generation time  2.4790492057800293
end to end time  13.150957107543945
Total (block generation + training)time/epoch 13.150957107543945
pure train time per /epoch  [3.072052478790283, 2.675082206726074, 2.6194546222686768, 2.6282262802124023, 2.6716668605804443, 2.637493371963501, 2.6795151233673096, 2.6673550605773926, 2.586193323135376, 2.5375425815582275]
pure train time average  2.629713228770665
input num list  [2036532, 2038335, 2038636, 2038081, 2040798, 2037494, 2037683, 2037983, 2038563, 2038430]
