main start at this time 1689056872.739115
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04147911071777344
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  6
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 5, 7, 11, 13]
original bucket_id :,  [7, 9, 11, 16, 17]
remove weights:  [871 787 715 567 541], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 7, 8, 9, 10, 12]
original bucket_id :,  [8, 14, 15, 18, 19, 22]
remove weights:  [827 623 560 530 506 435], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]

remove bucket_id:  [2, 3, 4, 5, 7]
original bucket_id :,  [5, 10, 12, 13, 23]
remove weights:  [1017  716  678  634  433], 		------------sum 3478

before remove weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]
after remove pre pack weights,  [3519, 1168, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [7, 9, 11, 16, 17], [8, 14, 15, 18, 19, 22], [5, 10, 12, 13, 23], [1, 3, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [871, 787, 715, 567, 541], [827, 623, 560, 530, 506, 435], [1017, 716, 678, 634, 433], [3519, 1168, 505, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.8301191329956055
[0, 2, 4, 6]
current group_mem  7.002414301287581
[7, 9, 11, 16, 17]
current group_mem  3.4831153387154754
[8, 14, 15, 18, 19, 22]
current group_mem  3.483911046416721
[5, 10, 12, 13, 23]
current group_mem  3.4802257804945933
[1, 3, 20, 21]
current group_mem  5.621541828725314
batches output list generation spend  0.0009212493896484375
self.weights_list  [0.37990565311575636, 0.12714837092180645, 0.10022981933341397, 0.13484566917012128, 0.24055156640019354, 0.017318921058708393]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016348838806152344
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.8313045501708984
len local_batched_seeds_list  6
partition total batch output list spend :  0.9673359394073486
self.buckets_partition() spend  sec:  0.8477015495300293
layer  0
 the number of batches:  6
check_connections_block*********************************
res  length 6
layer  1
num of batch  6
check_connections_block*********************************
res  length 6
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.5546875 GB
    Memory Allocated: 0.10787677764892578  GigaBytes
Max Memory Allocated: 0.10787677764892578  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.54296875 GB
    Memory Allocated: 13.857303619384766  GigaBytes
Max Memory Allocated: 14.646989345550537  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.54296875 GB
    Memory Allocated: 13.862507820129395  GigaBytes
Max Memory Allocated: 14.646989345550537  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.623046875 GB
    Memory Allocated: 0.1411724090576172  GigaBytes
Max Memory Allocated: 14.646989345550537  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.203125 GB
    Memory Allocated: 14.00942850112915  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.203125 GB
    Memory Allocated: 14.011269092559814  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.357421875 GB
    Memory Allocated: 0.13965702056884766  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.365234375 GB
    Memory Allocated: 13.67374324798584  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.365234375 GB
    Memory Allocated: 13.675218105316162  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.365234375 GB
    Memory Allocated: 0.14696025848388672  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.365234375 GB
    Memory Allocated: 13.827558040618896  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.365234375 GB
    Memory Allocated: 13.829527378082275  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.365234375 GB
    Memory Allocated: 0.1540989875793457  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.3671875 GB
    Memory Allocated: 12.122894287109375  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.3671875 GB
    Memory Allocated: 12.12617540359497  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.369140625 GB
    Memory Allocated: 0.12527227401733398  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 4.5368194580078125  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 4.537055015563965  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 0.1910405158996582  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.777465343475342
pure train time :  2.845756769180298
train time :  4.728974342346191
end to end time :  11.325960874557495
connection check time:  2.2837162017822266
block generation time  3.3234827518463135
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04533267021179199
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  6
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 5, 7, 11, 13]
original bucket_id :,  [7, 9, 11, 16, 17]
remove weights:  [871 787 715 567 541], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 7, 8, 9, 10, 12]
original bucket_id :,  [8, 14, 15, 18, 19, 22]
remove weights:  [827 623 560 530 506 435], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]

remove bucket_id:  [2, 3, 4, 5, 7]
original bucket_id :,  [5, 10, 12, 13, 23]
remove weights:  [1017  716  678  634  433], 		------------sum 3478

before remove weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]
after remove pre pack weights,  [3519, 1168, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [7, 9, 11, 16, 17], [8, 14, 15, 18, 19, 22], [5, 10, 12, 13, 23], [1, 3, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [871, 787, 715, 567, 541], [827, 623, 560, 530, 506, 435], [1017, 716, 678, 634, 433], [3519, 1168, 505, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.7806649208068848
[0, 2, 4, 6]
current group_mem  7.002414301287581
[7, 9, 11, 16, 17]
current group_mem  3.4831153387154754
[8, 14, 15, 18, 19, 22]
current group_mem  3.483911046416721
[5, 10, 12, 13, 23]
current group_mem  3.4802257804945933
[1, 3, 20, 21]
current group_mem  5.621541828725314
batches output list generation spend  0.0005633831024169922
self.weights_list  [0.37990565311575636, 0.12714837092180645, 0.10022981933341397, 0.13484566917012128, 0.24055156640019354, 0.017318921058708393]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015073537826538086
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.781435489654541
len local_batched_seeds_list  6
partition total batch output list spend :  0.9308528900146484
self.buckets_partition() spend  sec:  0.7965617179870605
layer  0
 the number of batches:  6
check_connections_block*********************************
res  length 6
layer  1
num of batch  6
check_connections_block*********************************
res  length 6
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 0.20838069915771484  GigaBytes
Max Memory Allocated: 14.699676990509033  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 14.00294303894043  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 14.007211208343506  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 0.20735692977905273  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 14.08849573135376  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 14.090291976928711  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 0.20573186874389648  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 13.747955799102783  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 13.749375343322754  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 0.21153020858764648  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 13.878233909606934  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 13.880101680755615  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 0.22009992599487305  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 12.175354957580566  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 12.178636074066162  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.43359375 GB
    Memory Allocated: 0.19104433059692383  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.573105335235596  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.573340892791748  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.19068479537963867  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1914889812469482
pure train time :  2.4500696659088135
train time :  3.8851206302642822
end to end time :  10.726485013961792
connection check time:  2.512742519378662
block generation time  3.375112533569336
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04945540428161621
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  6
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 5, 7, 11, 13]
original bucket_id :,  [7, 9, 11, 16, 17]
remove weights:  [871 787 715 567 541], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 7, 8, 9, 10, 12]
original bucket_id :,  [8, 14, 15, 18, 19, 22]
remove weights:  [827 623 560 530 506 435], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]

remove bucket_id:  [2, 3, 4, 5, 7]
original bucket_id :,  [5, 10, 12, 13, 23]
remove weights:  [1017  716  678  634  433], 		------------sum 3478

before remove weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]
after remove pre pack weights,  [3519, 1168, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [7, 9, 11, 16, 17], [8, 14, 15, 18, 19, 22], [5, 10, 12, 13, 23], [1, 3, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [871, 787, 715, 567, 541], [827, 623, 560, 530, 506, 435], [1017, 716, 678, 634, 433], [3519, 1168, 505, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.8184075355529785
[0, 2, 4, 6]
current group_mem  7.002414301287581
[7, 9, 11, 16, 17]
current group_mem  3.4831153387154754
[8, 14, 15, 18, 19, 22]
current group_mem  3.483911046416721
[5, 10, 12, 13, 23]
current group_mem  3.4802257804945933
[1, 3, 20, 21]
current group_mem  5.621541828725314
batches output list generation spend  0.0006315708160400391
self.weights_list  [0.37990565311575636, 0.12714837092180645, 0.10022981933341397, 0.13484566917012128, 0.24055156640019354, 0.017318921058708393]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01557469367980957
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.8192605972290039
len local_batched_seeds_list  6
partition total batch output list spend :  0.9719343185424805
self.buckets_partition() spend  sec:  0.834885835647583
layer  0
 the number of batches:  6
check_connections_block*********************************
res  length 6
layer  1
num of batch  6
check_connections_block*********************************
res  length 6
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20937728881835938  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.998203754425049  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.002472877502441  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20741033554077148  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.083068370819092  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.084885120391846  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20574951171875  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.747574806213379  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.749059200286865  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.21161794662475586  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.887280941009521  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.889258861541748  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.22014236450195312  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.170990943908691  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.174272060394287  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.19074392318725586  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.563907623291016  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.564143180847168  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.19037389755249023  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.6083359718322754
pure train time :  2.4400618076324463
train time :  3.829724073410034
end to end time :  10.751531600952148
connection check time:  2.5135538578033447
block generation time  3.411734104156494
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05067610740661621
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  6
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 5, 7, 11, 13]
original bucket_id :,  [7, 9, 11, 16, 17]
remove weights:  [871 787 715 567 541], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 7, 8, 9, 10, 12]
original bucket_id :,  [8, 14, 15, 18, 19, 22]
remove weights:  [827 623 560 530 506 435], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]

remove bucket_id:  [2, 3, 4, 5, 7]
original bucket_id :,  [5, 10, 12, 13, 23]
remove weights:  [1017  716  678  634  433], 		------------sum 3478

before remove weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]
after remove pre pack weights,  [3519, 1168, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [7, 9, 11, 16, 17], [8, 14, 15, 18, 19, 22], [5, 10, 12, 13, 23], [1, 3, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [871, 787, 715, 567, 541], [827, 623, 560, 530, 506, 435], [1017, 716, 678, 634, 433], [3519, 1168, 505, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.7212204933166504
[0, 2, 4, 6]
current group_mem  7.002414301287581
[7, 9, 11, 16, 17]
current group_mem  3.4831153387154754
[8, 14, 15, 18, 19, 22]
current group_mem  3.483911046416721
[5, 10, 12, 13, 23]
current group_mem  3.4802257804945933
[1, 3, 20, 21]
current group_mem  5.621541828725314
batches output list generation spend  0.0006003379821777344
self.weights_list  [0.37990565311575636, 0.12714837092180645, 0.10022981933341397, 0.13484566917012128, 0.24055156640019354, 0.017318921058708393]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015540838241577148
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.7221188545227051
len local_batched_seeds_list  6
partition total batch output list spend :  1.0017211437225342
self.buckets_partition() spend  sec:  0.7377135753631592
layer  0
 the number of batches:  6
check_connections_block*********************************
res  length 6
layer  1
num of batch  6
check_connections_block*********************************
res  length 6
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20936870574951172  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.966794967651367  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.971065044403076  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.207427978515625  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.08803415298462  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.089827060699463  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20582866668701172  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.754906177520752  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.756390571594238  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.2116551399230957  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.87113618850708  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.873478889465332  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.22054100036621094  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.16864824295044  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.171929359436035  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.1909804344177246  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.590490341186523  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.590725898742676  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.19063043594360352  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.081376552581787
pure train time :  2.4451093673706055
train time :  3.812035083770752
end to end time :  10.714103698730469
connection check time:  2.5211925506591797
block generation time  3.3514513969421387
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05449724197387695
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  6
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 5, 7, 11, 13]
original bucket_id :,  [7, 9, 11, 16, 17]
remove weights:  [871 787 715 567 541], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 7, 8, 9, 10, 12]
original bucket_id :,  [8, 14, 15, 18, 19, 22]
remove weights:  [827 623 560 530 506 435], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]

remove bucket_id:  [2, 3, 4, 5, 7]
original bucket_id :,  [5, 10, 12, 13, 23]
remove weights:  [1017  716  678  634  433], 		------------sum 3478

before remove weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]
after remove pre pack weights,  [3519, 1168, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [7, 9, 11, 16, 17], [8, 14, 15, 18, 19, 22], [5, 10, 12, 13, 23], [1, 3, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [871, 787, 715, 567, 541], [827, 623, 560, 530, 506, 435], [1017, 716, 678, 634, 433], [3519, 1168, 505, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.924091100692749
[0, 2, 4, 6]
current group_mem  7.002414301287581
[7, 9, 11, 16, 17]
current group_mem  3.4831153387154754
[8, 14, 15, 18, 19, 22]
current group_mem  3.483911046416721
[5, 10, 12, 13, 23]
current group_mem  3.4802257804945933
[1, 3, 20, 21]
current group_mem  5.621541828725314
batches output list generation spend  0.0005736351013183594
self.weights_list  [0.37990565311575636, 0.12714837092180645, 0.10022981933341397, 0.13484566917012128, 0.24055156640019354, 0.017318921058708393]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01503896713256836
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.9249300956726074
len local_batched_seeds_list  6
partition total batch output list spend :  1.2035901546478271
self.buckets_partition() spend  sec:  0.9400234222412109
layer  0
 the number of batches:  6
check_connections_block*********************************
res  length 6
layer  1
num of batch  6
check_connections_block*********************************
res  length 6
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.2083144187927246  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.944197654724121  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.948466777801514  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20749521255493164  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.096768379211426  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.098519325256348  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.205657958984375  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.746609210968018  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.748093605041504  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.21168136596679688  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.893069744110107  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.89541244506836  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.22021770477294922  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.183804035186768  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.187085151672363  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.1912221908569336  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.589123725891113  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.589359283447266  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.1908731460571289  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.067304849624634
pure train time :  2.459385871887207
train time :  3.8352553844451904
end to end time :  10.875725984573364
connection check time:  2.487942934036255
block generation time  3.327139377593994
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.04974079132080078
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  6
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 5, 7, 11, 13]
original bucket_id :,  [7, 9, 11, 16, 17]
remove weights:  [871 787 715 567 541], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 7, 8, 9, 10, 12]
original bucket_id :,  [8, 14, 15, 18, 19, 22]
remove weights:  [827 623 560 530 506 435], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]

remove bucket_id:  [2, 3, 4, 5, 7]
original bucket_id :,  [5, 10, 12, 13, 23]
remove weights:  [1017  716  678  634  433], 		------------sum 3478

before remove weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]
after remove pre pack weights,  [3519, 1168, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [7, 9, 11, 16, 17], [8, 14, 15, 18, 19, 22], [5, 10, 12, 13, 23], [1, 3, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [871, 787, 715, 567, 541], [827, 623, 560, 530, 506, 435], [1017, 716, 678, 634, 433], [3519, 1168, 505, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.8964087963104248
[0, 2, 4, 6]
current group_mem  7.002414301287581
[7, 9, 11, 16, 17]
current group_mem  3.4831153387154754
[8, 14, 15, 18, 19, 22]
current group_mem  3.483911046416721
[5, 10, 12, 13, 23]
current group_mem  3.4802257804945933
[1, 3, 20, 21]
current group_mem  5.621541828725314
batches output list generation spend  0.0004980564117431641
self.weights_list  [0.37990565311575636, 0.12714837092180645, 0.10022981933341397, 0.13484566917012128, 0.24055156640019354, 0.017318921058708393]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016448259353637695
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.8971521854400635
len local_batched_seeds_list  6
partition total batch output list spend :  1.0448591709136963
self.buckets_partition() spend  sec:  0.9136483669281006
layer  0
 the number of batches:  6
check_connections_block*********************************
res  length 6
layer  1
num of batch  6
check_connections_block*********************************
res  length 6
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20937681198120117  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.992562770843506  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.99683141708374  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20743465423583984  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.072456359863281  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.074284076690674  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.2058091163635254  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.74120807647705  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.742570400238037  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.21153020858764648  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.887785911560059  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.89012861251831  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.22019481658935547  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.157119274139404  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.160400390625  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.19103288650512695  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.5900983810424805  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.590333938598633  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.19068288803100586  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0655925273895264
pure train time :  2.4462873935699463
train time :  3.818572998046875
end to end time :  10.752455949783325
connection check time:  2.500431537628174
block generation time  3.368051528930664
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.053096771240234375
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  6
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 5, 7, 11, 13]
original bucket_id :,  [7, 9, 11, 16, 17]
remove weights:  [871 787 715 567 541], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 7, 8, 9, 10, 12]
original bucket_id :,  [8, 14, 15, 18, 19, 22]
remove weights:  [827 623 560 530 506 435], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]

remove bucket_id:  [2, 3, 4, 5, 7]
original bucket_id :,  [5, 10, 12, 13, 23]
remove weights:  [1017  716  678  634  433], 		------------sum 3478

before remove weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]
after remove pre pack weights,  [3519, 1168, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [7, 9, 11, 16, 17], [8, 14, 15, 18, 19, 22], [5, 10, 12, 13, 23], [1, 3, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [871, 787, 715, 567, 541], [827, 623, 560, 530, 506, 435], [1017, 716, 678, 634, 433], [3519, 1168, 505, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.9250059127807617
[0, 2, 4, 6]
current group_mem  7.002414301287581
[7, 9, 11, 16, 17]
current group_mem  3.4831153387154754
[8, 14, 15, 18, 19, 22]
current group_mem  3.483911046416721
[5, 10, 12, 13, 23]
current group_mem  3.4802257804945933
[1, 3, 20, 21]
current group_mem  5.621541828725314
batches output list generation spend  0.0005812644958496094
self.weights_list  [0.37990565311575636, 0.12714837092180645, 0.10022981933341397, 0.13484566917012128, 0.24055156640019354, 0.017318921058708393]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015024662017822266
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.9258372783660889
len local_batched_seeds_list  6
partition total batch output list spend :  1.1995000839233398
self.buckets_partition() spend  sec:  0.9409134387969971
layer  0
 the number of batches:  6
check_connections_block*********************************
res  length 6
layer  1
num of batch  6
check_connections_block*********************************
res  length 6
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20936918258666992  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.959731578826904  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.964000225067139  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.207427978515625  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.08020305633545  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.082058906555176  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20595455169677734  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.753437519073486  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.754841804504395  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.21152591705322266  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.88532543182373  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.887231349945068  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.22015094757080078  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.189111232757568  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.192392349243164  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.19083690643310547  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.564485549926758  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.56472110748291  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.19046688079833984  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0294013023376465
pure train time :  2.438908576965332
train time :  3.808288097381592
end to end time :  11.120281219482422
connection check time:  2.5367794036865234
block generation time  3.554354190826416
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.03038167953491211
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  6
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 5, 7, 11, 13]
original bucket_id :,  [7, 9, 11, 16, 17]
remove weights:  [871 787 715 567 541], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 7, 8, 9, 10, 12]
original bucket_id :,  [8, 14, 15, 18, 19, 22]
remove weights:  [827 623 560 530 506 435], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]

remove bucket_id:  [2, 3, 4, 5, 7]
original bucket_id :,  [5, 10, 12, 13, 23]
remove weights:  [1017  716  678  634  433], 		------------sum 3478

before remove weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]
after remove pre pack weights,  [3519, 1168, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [7, 9, 11, 16, 17], [8, 14, 15, 18, 19, 22], [5, 10, 12, 13, 23], [1, 3, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [871, 787, 715, 567, 541], [827, 623, 560, 530, 506, 435], [1017, 716, 678, 634, 433], [3519, 1168, 505, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.3615729808807373
[0, 2, 4, 6]
current group_mem  7.002414301287581
[7, 9, 11, 16, 17]
current group_mem  3.4831153387154754
[8, 14, 15, 18, 19, 22]
current group_mem  3.483911046416721
[5, 10, 12, 13, 23]
current group_mem  3.4802257804945933
[1, 3, 20, 21]
current group_mem  5.621541828725314
batches output list generation spend  0.000469207763671875
self.weights_list  [0.37990565311575636, 0.12714837092180645, 0.10022981933341397, 0.13484566917012128, 0.24055156640019354, 0.017318921058708393]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013894796371459961
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.36228203773498535
len local_batched_seeds_list  6
partition total batch output list spend :  0.4733874797821045
self.buckets_partition() spend  sec:  0.3762199878692627
layer  0
 the number of batches:  6
check_connections_block*********************************
res  length 6
layer  1
num of batch  6
check_connections_block*********************************
res  length 6
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.2083721160888672  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.949188232421875  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.953457832336426  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20750093460083008  GigaBytes
Max Memory Allocated: 14.792445182800293  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.111997604370117  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.113876342773438  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.2057194709777832  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.744520664215088  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.746005058288574  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.2126765251159668  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.881758689880371  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.883643627166748  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.22012758255004883  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.188128471374512  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.191409587860107  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.1910719871520996  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.591508865356445  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.591744422912598  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.1907191276550293  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9603140354156494
pure train time :  2.451920509338379
train time :  3.805629014968872
end to end time :  9.453197717666626
connection check time:  2.1437368392944336
block generation time  3.0083250999450684
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.05107235908508301
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  6
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 5, 7, 11, 13]
original bucket_id :,  [7, 9, 11, 16, 17]
remove weights:  [871 787 715 567 541], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 7, 8, 9, 10, 12]
original bucket_id :,  [8, 14, 15, 18, 19, 22]
remove weights:  [827 623 560 530 506 435], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]

remove bucket_id:  [2, 3, 4, 5, 7]
original bucket_id :,  [5, 10, 12, 13, 23]
remove weights:  [1017  716  678  634  433], 		------------sum 3478

before remove weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]
after remove pre pack weights,  [3519, 1168, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [7, 9, 11, 16, 17], [8, 14, 15, 18, 19, 22], [5, 10, 12, 13, 23], [1, 3, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [871, 787, 715, 567, 541], [827, 623, 560, 530, 506, 435], [1017, 716, 678, 634, 433], [3519, 1168, 505, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.868931770324707
[0, 2, 4, 6]
current group_mem  7.002414301287581
[7, 9, 11, 16, 17]
current group_mem  3.4831153387154754
[8, 14, 15, 18, 19, 22]
current group_mem  3.483911046416721
[5, 10, 12, 13, 23]
current group_mem  3.4802257804945933
[1, 3, 20, 21]
current group_mem  5.621541828725314
batches output list generation spend  0.0005908012390136719
self.weights_list  [0.37990565311575636, 0.12714837092180645, 0.10022981933341397, 0.13484566917012128, 0.24055156640019354, 0.017318921058708393]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014265060424804688
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.869767427444458
len local_batched_seeds_list  6
partition total batch output list spend :  1.1412353515625
self.buckets_partition() spend  sec:  0.884077787399292
layer  0
 the number of batches:  6
check_connections_block*********************************
res  length 6
layer  1
num of batch  6
check_connections_block*********************************
res  length 6
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.2083587646484375  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.995186805725098  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.99945592880249  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20748424530029297  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.075992584228516  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.077821731567383  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.2057948112487793  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.7478609085083  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.749250888824463  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.21145391464233398  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.895412921905518  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.89775562286377  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.22019243240356445  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.163472652435303  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.166753768920898  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.1911163330078125  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.598856449127197  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.59909200668335  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.19077491760253906  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8680503368377686
pure train time :  2.4519689083099365
train time :  3.8199260234832764
end to end time :  10.75832748413086
connection check time:  2.416388988494873
block generation time  3.3625640869140625
generate_dataloader_bucket_block=======
self.global_to_local() spend sec:  0.0518794059753418
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

sum(estimated_mem)
23.07120829563968
24
self.K  6
the grouping_fanout_arxiv called successfully
capacity  7000
sorted_dict  {0: 3637, 1: 3519, 2: 1313, 3: 1168, 4: 1111, 5: 1017, 6: 939, 7: 871, 8: 827, 9: 787, 10: 716, 11: 715, 12: 678, 13: 634, 14: 623, 16: 567, 15: 560, 17: 541, 18: 530, 19: 506, 20: 505, 22: 435, 23: 433, 21: 428}

weights after sort [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [0, 2, 4, 6]
original bucket_id :,  [0, 2, 4, 6]
remove weights:  [3637 1313 1111  939], 		------------sum 7000

before remove weights,  [3637, 3519, 1313, 1168, 1111, 1017, 939, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 5, 7, 11, 13]
original bucket_id :,  [7, 9, 11, 16, 17]
remove weights:  [871 787 715 567 541], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 871, 827, 787, 716, 715, 678, 634, 623, 567, 560, 541, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]

remove bucket_id:  [3, 7, 8, 9, 10, 12]
original bucket_id :,  [8, 14, 15, 18, 19, 22]
remove weights:  [827 623 560 530 506 435], 		------------sum 3481

before remove weights,  [3519, 1168, 1017, 827, 716, 678, 634, 623, 560, 530, 506, 505, 435, 433, 428]
after remove pre pack weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]

remove bucket_id:  [2, 3, 4, 5, 7]
original bucket_id :,  [5, 10, 12, 13, 23]
remove weights:  [1017  716  678  634  433], 		------------sum 3478

before remove weights,  [3519, 1168, 1017, 716, 678, 634, 505, 433, 428]
after remove pre pack weights,  [3519, 1168, 505, 428]
G_BUCKET_ID_list [[0, 2, 4, 6], [7, 9, 11, 16, 17], [8, 14, 15, 18, 19, 22], [5, 10, 12, 13, 23], [1, 3, 20, 21]]
Groups_mem_list  [[3637, 1313, 1111, 939], [871, 787, 715, 567, 541], [827, 623, 560, 530, 506, 435], [1017, 716, 678, 634, 433], [3519, 1168, 505, 428]]
G_BUCKET_ID_list length 5
backpack scheduling spend  0.9117000102996826
[0, 2, 4, 6]
current group_mem  7.002414301287581
[7, 9, 11, 16, 17]
current group_mem  3.4831153387154754
[8, 14, 15, 18, 19, 22]
current group_mem  3.483911046416721
[5, 10, 12, 13, 23]
current group_mem  3.4802257804945933
[1, 3, 20, 21]
current group_mem  5.621541828725314
batches output list generation spend  0.0005655288696289062
self.weights_list  [0.37990565311575636, 0.12714837092180645, 0.10022981933341397, 0.13484566917012128, 0.24055156640019354, 0.017318921058708393]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014648199081420898
self.gen_batches_seeds_list(bkt_dst_nodes_list) spend  0.9125452041625977
len local_batched_seeds_list  6
partition total batch output list spend :  1.1872150897979736
self.buckets_partition() spend  sec:  0.9272470474243164
layer  0
 the number of batches:  6
check_connections_block*********************************
res  length 6
layer  1
num of batch  6
check_connections_block*********************************
res  length 6
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20832586288452148  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.952672481536865  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.9569411277771  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20747041702270508  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.095998764038086  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 14.097748279571533  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.20562219619750977  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.746058464050293  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.747458457946777  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.2125864028930664  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.880629539489746  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 13.882745265960693  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.22021007537841797  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.183002471923828  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 12.186283588409424  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.19119691848754883  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.591080188751221  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 4.591315746307373  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 19.435546875 GB
    Memory Allocated: 0.19084882736206055  GigaBytes
Max Memory Allocated: 14.803309917449951  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.768908739089966
pure train time :  2.442959785461426
train time :  3.796647310256958
end to end time :  10.639182567596436
connection check time:  2.311788320541382
block generation time  3.324955940246582
end to end time  10.813323020935059
Total (block generation + training)time/epoch 10.813323020935059
pure train time per /epoch  [2.845756769180298, 2.4500696659088135, 2.4400618076324463, 2.4451093673706055, 2.459385871887207, 2.4462873935699463, 2.438908576965332, 2.451920509338379, 2.4519689083099365, 2.442959785461426]
pure train time average  2.4480772018432617
input num list  [739032, 738093, 737407, 738471, 738522, 738384, 738502, 738571, 738054, 738617]
