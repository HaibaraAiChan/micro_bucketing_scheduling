main start at this time 1690859362.2390466
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  10
the grouping_fanout_arxiv called successfully
capacity  4900
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085 1530 1283]

remove bucket_id:  [4, 17, 23]
original bucket_id :,  [6, 17, 21]
remove weights:  [2085 1530 1283], 		------------sum 4898

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
res_tmp  [2122 1481 1294]

remove bucket_id:  [2, 17, 19]
original bucket_id :,  [3, 19, 22]
remove weights:  [2122 1481 1294], 		------------sum 4897

before remove weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
after remove pre pack weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
res_tmp  [2091 1511 1293]

remove bucket_id:  [2, 15, 17]
original bucket_id :,  [2, 18, 23]
remove weights:  [2091 1511 1293], 		------------sum 4895

before remove weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
res_tmp  [1875 1584 1429]

remove bucket_id:  [6, 12, 14]
original bucket_id :,  [11, 16, 20]
remove weights:  [1875 1584 1429], 		------------sum 4888

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2056 2003]

remove bucket_id:  [0, 1]
original bucket_id :,  [7, 8]
remove weights:  [2056 2003], 		------------sum 4059

before remove weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1983 1962]

remove bucket_id:  [0, 1]
original bucket_id :,  [9, 1]
remove weights:  [1983 1962], 		------------sum 3945

before remove weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1723, 1682, 1672, 1579]
res_tmp  [1723 1682]

remove bucket_id:  [0, 1]
original bucket_id :,  [13, 14]
remove weights:  [1723 1682], 		------------sum 3405

before remove weights,  [1723, 1682, 1672, 1579]
after remove pre pack weights,  [1672, 1579]
G_BUCKET_ID_list [[6, 17, 21], [3, 19, 22], [2, 18, 23], [11, 16, 20], [4, 5], [7, 8], [9, 1], [10, 12], [13, 14], [0, 15]]
Groups_mem_list  [[2085, 1530, 1283], [2122, 1481, 1294], [2091, 1511, 1293], [1875, 1584, 1429], [2164, 2127], [2056, 2003], [1983, 1962], [1874, 1773], [1723, 1682], [1672, 1579]]
G_BUCKET_ID_list length 10
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  10
current group_mem  4.899838011197959
current group_mem  4.897977435991356
current group_mem  4.896401253001186
current group_mem  4.889030975440014
current group_mem  4.291440736088369
current group_mem  4.059846884275775
current group_mem  3.9464317772397335
current group_mem  3.6482251697690558
current group_mem  3.405843325146656
current group_mem  3.251293312215558
batches output list generation spend  0.0008568763732910156
self.weights_list  [0.07141993160400699, 0.1054749782826228, 0.1273792898692559, 0.05091212984242531, 0.13234954530959633, 0.0813054617829142, 0.16770213655007093, 0.05283645440450402, 0.04034483896152451, 0.17027523339307904]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0158233642578125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8281080722808838
len local_batched_seeds_list  10
partition total batch output list spend :  1.043968915939331
self.buckets_partition() spend  sec:  0.8439593315124512
layer  0
 the number of batches:  10
check_connections_block*********************************

the find indices time spent  0.05286741256713867

in edges time spent  0.15588116645812988
local to global src and eids time spent  0.32589077949523926
time gen tails  0.07900333404541016
res  length 10
layer  1
num of batch  10
check_connections_block*********************************

the find indices time spent  0.12914729118347168

in edges time spent  0.8377830982208252
local to global src and eids time spent  1.3911912441253662
time gen tails  0.24326133728027344
res  length 10
block collection to dataloader spend  2.3365020751953125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 1.5390625 GB
    Memory Allocated: 0.09017086029052734  GigaBytes
Max Memory Allocated: 0.09017086029052734  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.66796875 GB
    Memory Allocated: 8.49245548248291  GigaBytes
Max Memory Allocated: 8.870482921600342  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.66796875 GB
    Memory Allocated: 8.493424415588379  GigaBytes
Max Memory Allocated: 8.870482921600342  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.298828125 GB
    Memory Allocated: 0.12997198104858398  GigaBytes
Max Memory Allocated: 8.870482921600342  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.44921875 GB
    Memory Allocated: 8.619000434875488  GigaBytes
Max Memory Allocated: 8.999719619750977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.44921875 GB
    Memory Allocated: 8.62048864364624  GigaBytes
Max Memory Allocated: 8.999719619750977  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.759765625 GB
    Memory Allocated: 0.13409852981567383  GigaBytes
Max Memory Allocated: 8.999719619750977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.19140625 GB
    Memory Allocated: 8.578740119934082  GigaBytes
Max Memory Allocated: 8.999719619750977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.19140625 GB
    Memory Allocated: 8.58057689666748  GigaBytes
Max Memory Allocated: 8.999719619750977  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.498046875 GB
    Memory Allocated: 0.1279430389404297  GigaBytes
Max Memory Allocated: 8.999719619750977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.498046875 GB
    Memory Allocated: 8.228332996368408  GigaBytes
Max Memory Allocated: 8.999719619750977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.498046875 GB
    Memory Allocated: 8.229023456573486  GigaBytes
Max Memory Allocated: 8.999719619750977  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.498046875 GB
    Memory Allocated: 0.13630056381225586  GigaBytes
Max Memory Allocated: 8.999719619750977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.91015625 GB
    Memory Allocated: 8.869263648986816  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.91015625 GB
    Memory Allocated: 8.871144771575928  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.55078125 GB
    Memory Allocated: 0.13522768020629883  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.55078125 GB
    Memory Allocated: 8.280805110931396  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.55078125 GB
    Memory Allocated: 8.281953811645508  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.55078125 GB
    Memory Allocated: 0.14172649383544922  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.55078125 GB
    Memory Allocated: 8.064552783966064  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.55078125 GB
    Memory Allocated: 8.06704044342041  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.55078125 GB
    Memory Allocated: 0.13593196868896484  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.599609375 GB
    Memory Allocated: 7.416038990020752  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.599609375 GB
    Memory Allocated: 7.416755676269531  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.599609375 GB
    Memory Allocated: 0.13272809982299805  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 6.787731647491455  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 6.788279056549072  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 0.1418290138244629  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 6.44235897064209  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 6.4449381828308105  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 0.21388006210327148  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.775031805038452
pure train time :  2.661464214324951
train time :  4.929883241653442
end to end time :  11.608211994171143
connection check time:  3.7187552452087402
block generation time  1.892463207244873
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  10
the grouping_fanout_arxiv called successfully
capacity  4900
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085 1530 1283]

remove bucket_id:  [4, 17, 23]
original bucket_id :,  [6, 17, 21]
remove weights:  [2085 1530 1283], 		------------sum 4898

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
res_tmp  [2122 1481 1294]

remove bucket_id:  [2, 17, 19]
original bucket_id :,  [3, 19, 22]
remove weights:  [2122 1481 1294], 		------------sum 4897

before remove weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
after remove pre pack weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
res_tmp  [2091 1511 1293]

remove bucket_id:  [2, 15, 17]
original bucket_id :,  [2, 18, 23]
remove weights:  [2091 1511 1293], 		------------sum 4895

before remove weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
res_tmp  [1875 1584 1429]

remove bucket_id:  [6, 12, 14]
original bucket_id :,  [11, 16, 20]
remove weights:  [1875 1584 1429], 		------------sum 4888

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2056 2003]

remove bucket_id:  [0, 1]
original bucket_id :,  [7, 8]
remove weights:  [2056 2003], 		------------sum 4059

before remove weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1983 1962]

remove bucket_id:  [0, 1]
original bucket_id :,  [9, 1]
remove weights:  [1983 1962], 		------------sum 3945

before remove weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1723, 1682, 1672, 1579]
res_tmp  [1723 1682]

remove bucket_id:  [0, 1]
original bucket_id :,  [13, 14]
remove weights:  [1723 1682], 		------------sum 3405

before remove weights,  [1723, 1682, 1672, 1579]
after remove pre pack weights,  [1672, 1579]
G_BUCKET_ID_list [[6, 17, 21], [3, 19, 22], [2, 18, 23], [11, 16, 20], [4, 5], [7, 8], [9, 1], [10, 12], [13, 14], [0, 15]]
Groups_mem_list  [[2085, 1530, 1283], [2122, 1481, 1294], [2091, 1511, 1293], [1875, 1584, 1429], [2164, 2127], [2056, 2003], [1983, 1962], [1874, 1773], [1723, 1682], [1672, 1579]]
G_BUCKET_ID_list length 10
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  10
current group_mem  4.899838011197959
current group_mem  4.897977435991356
current group_mem  4.896401253001186
current group_mem  4.889030975440014
current group_mem  4.291440736088369
current group_mem  4.059846884275775
current group_mem  3.9464317772397335
current group_mem  3.6482251697690558
current group_mem  3.405843325146656
current group_mem  3.251293312215558
batches output list generation spend  0.0005438327789306641
self.weights_list  [0.07141993160400699, 0.1054749782826228, 0.1273792898692559, 0.05091212984242531, 0.13234954530959633, 0.0813054617829142, 0.16770213655007093, 0.05283645440450402, 0.04034483896152451, 0.17027523339307904]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.027413368225097656
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8775451183319092
len local_batched_seeds_list  10
partition total batch output list spend :  1.2516961097717285
self.buckets_partition() spend  sec:  0.9050009250640869
layer  0
 the number of batches:  10
check_connections_block*********************************

the find indices time spent  0.05585455894470215

in edges time spent  0.16203641891479492
local to global src and eids time spent  0.3286616802215576
time gen tails  0.07938957214355469
res  length 10
layer  1
num of batch  10
check_connections_block*********************************

the find indices time spent  0.13114404678344727

in edges time spent  0.8223228454589844
local to global src and eids time spent  1.3738040924072266
time gen tails  0.23554491996765137
res  length 10
block collection to dataloader spend  1.6450881958007812e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 0.19336318969726562  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.60590410232544  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.605393409729004  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 0.19608259201049805  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.692415237426758  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.69390344619751  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 0.20015573501586914  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.65235948562622  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.654211521148682  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 0.1941971778869629  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.30743932723999  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.308129787445068  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 0.2035355567932129  GigaBytes
Max Memory Allocated: 9.27952527999878  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.958950519561768  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.960826396942139  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 0.20125961303710938  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.352718353271484  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.353909015655518  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 0.20778417587280273  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.124887466430664  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 8.12737512588501  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 0.20202207565307617  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 7.481388568878174  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 7.482105255126953  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.64453125 GB
    Memory Allocated: 0.19883060455322266  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.835991382598877  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.836538791656494  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2078866958618164  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.4820637702941895  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.484543800354004  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2135143280029297  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1907894611358643
pure train time :  2.2780325412750244
train time :  4.0638344287872314
end to end time :  10.916140794754028
connection check time:  3.635526657104492
block generation time  1.9466333389282227
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  10
the grouping_fanout_arxiv called successfully
capacity  4900
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085 1530 1283]

remove bucket_id:  [4, 17, 23]
original bucket_id :,  [6, 17, 21]
remove weights:  [2085 1530 1283], 		------------sum 4898

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
res_tmp  [2122 1481 1294]

remove bucket_id:  [2, 17, 19]
original bucket_id :,  [3, 19, 22]
remove weights:  [2122 1481 1294], 		------------sum 4897

before remove weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
after remove pre pack weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
res_tmp  [2091 1511 1293]

remove bucket_id:  [2, 15, 17]
original bucket_id :,  [2, 18, 23]
remove weights:  [2091 1511 1293], 		------------sum 4895

before remove weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
res_tmp  [1875 1584 1429]

remove bucket_id:  [6, 12, 14]
original bucket_id :,  [11, 16, 20]
remove weights:  [1875 1584 1429], 		------------sum 4888

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2056 2003]

remove bucket_id:  [0, 1]
original bucket_id :,  [7, 8]
remove weights:  [2056 2003], 		------------sum 4059

before remove weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1983 1962]

remove bucket_id:  [0, 1]
original bucket_id :,  [9, 1]
remove weights:  [1983 1962], 		------------sum 3945

before remove weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1723, 1682, 1672, 1579]
res_tmp  [1723 1682]

remove bucket_id:  [0, 1]
original bucket_id :,  [13, 14]
remove weights:  [1723 1682], 		------------sum 3405

before remove weights,  [1723, 1682, 1672, 1579]
after remove pre pack weights,  [1672, 1579]
G_BUCKET_ID_list [[6, 17, 21], [3, 19, 22], [2, 18, 23], [11, 16, 20], [4, 5], [7, 8], [9, 1], [10, 12], [13, 14], [0, 15]]
Groups_mem_list  [[2085, 1530, 1283], [2122, 1481, 1294], [2091, 1511, 1293], [1875, 1584, 1429], [2164, 2127], [2056, 2003], [1983, 1962], [1874, 1773], [1723, 1682], [1672, 1579]]
G_BUCKET_ID_list length 10
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  10
current group_mem  4.899838011197959
current group_mem  4.897977435991356
current group_mem  4.896401253001186
current group_mem  4.889030975440014
current group_mem  4.291440736088369
current group_mem  4.059846884275775
current group_mem  3.9464317772397335
current group_mem  3.6482251697690558
current group_mem  3.405843325146656
current group_mem  3.251293312215558
batches output list generation spend  0.0005462169647216797
self.weights_list  [0.07141993160400699, 0.1054749782826228, 0.1273792898692559, 0.05091212984242531, 0.13234954530959633, 0.0813054617829142, 0.16770213655007093, 0.05283645440450402, 0.04034483896152451, 0.17027523339307904]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0187835693359375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8229973316192627
len local_batched_seeds_list  10
partition total batch output list spend :  1.1695420742034912
self.buckets_partition() spend  sec:  0.8418166637420654
layer  0
 the number of batches:  10
check_connections_block*********************************

the find indices time spent  0.05590081214904785

in edges time spent  0.16112065315246582
local to global src and eids time spent  0.328350305557251
time gen tails  0.08126091957092285
res  length 10
layer  1
num of batch  10
check_connections_block*********************************

the find indices time spent  0.12764906883239746

in edges time spent  0.8360955715179443
local to global src and eids time spent  1.368652582168579
time gen tails  0.23381996154785156
res  length 10
block collection to dataloader spend  1.5735626220703125e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.1931896209716797  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.591987609863281  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.591477870941162  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19608402252197266  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.687955856323242  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.689444065093994  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2001504898071289  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.646053314208984  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.647915840148926  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19391965866088867  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.294398784637451  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.29508924484253  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20253419876098633  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.949979305267334  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.951892852783203  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20150470733642578  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.356736660003662  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.357881546020508  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20779800415039062  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.109302043914795  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.111713409423828  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20192909240722656  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.4954447746276855  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.496161460876465  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19882917404174805  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.836886405944824  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.837433815002441  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20790481567382812  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.500825881958008  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.50322961807251  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.21370172500610352  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.6073920726776123
pure train time :  2.2697010040283203
train time :  4.019071578979492
end to end time :  10.753729820251465
connection check time:  3.6344478130340576
block generation time  1.9028716087341309
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  10
the grouping_fanout_arxiv called successfully
capacity  4900
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085 1530 1283]

remove bucket_id:  [4, 17, 23]
original bucket_id :,  [6, 17, 21]
remove weights:  [2085 1530 1283], 		------------sum 4898

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
res_tmp  [2122 1481 1294]

remove bucket_id:  [2, 17, 19]
original bucket_id :,  [3, 19, 22]
remove weights:  [2122 1481 1294], 		------------sum 4897

before remove weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
after remove pre pack weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
res_tmp  [2091 1511 1293]

remove bucket_id:  [2, 15, 17]
original bucket_id :,  [2, 18, 23]
remove weights:  [2091 1511 1293], 		------------sum 4895

before remove weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
res_tmp  [1875 1584 1429]

remove bucket_id:  [6, 12, 14]
original bucket_id :,  [11, 16, 20]
remove weights:  [1875 1584 1429], 		------------sum 4888

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2056 2003]

remove bucket_id:  [0, 1]
original bucket_id :,  [7, 8]
remove weights:  [2056 2003], 		------------sum 4059

before remove weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1983 1962]

remove bucket_id:  [0, 1]
original bucket_id :,  [9, 1]
remove weights:  [1983 1962], 		------------sum 3945

before remove weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1723, 1682, 1672, 1579]
res_tmp  [1723 1682]

remove bucket_id:  [0, 1]
original bucket_id :,  [13, 14]
remove weights:  [1723 1682], 		------------sum 3405

before remove weights,  [1723, 1682, 1672, 1579]
after remove pre pack weights,  [1672, 1579]
G_BUCKET_ID_list [[6, 17, 21], [3, 19, 22], [2, 18, 23], [11, 16, 20], [4, 5], [7, 8], [9, 1], [10, 12], [13, 14], [0, 15]]
Groups_mem_list  [[2085, 1530, 1283], [2122, 1481, 1294], [2091, 1511, 1293], [1875, 1584, 1429], [2164, 2127], [2056, 2003], [1983, 1962], [1874, 1773], [1723, 1682], [1672, 1579]]
G_BUCKET_ID_list length 10
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  10
current group_mem  4.899838011197959
current group_mem  4.897977435991356
current group_mem  4.896401253001186
current group_mem  4.889030975440014
current group_mem  4.291440736088369
current group_mem  4.059846884275775
current group_mem  3.9464317772397335
current group_mem  3.6482251697690558
current group_mem  3.405843325146656
current group_mem  3.251293312215558
batches output list generation spend  0.0005390644073486328
self.weights_list  [0.07141993160400699, 0.1054749782826228, 0.1273792898692559, 0.05091212984242531, 0.13234954530959633, 0.0813054617829142, 0.16770213655007093, 0.05283645440450402, 0.04034483896152451, 0.17027523339307904]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015098810195922852
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.7997047901153564
len local_batched_seeds_list  10
partition total batch output list spend :  1.1431217193603516
self.buckets_partition() spend  sec:  0.8148350715637207
layer  0
 the number of batches:  10
check_connections_block*********************************

the find indices time spent  0.06988096237182617

in edges time spent  0.16892528533935547
local to global src and eids time spent  0.31711626052856445
time gen tails  0.04561567306518555
res  length 10
layer  1
num of batch  10
check_connections_block*********************************

the find indices time spent  0.08053946495056152

in edges time spent  0.4691898822784424
local to global src and eids time spent  0.8944323062896729
time gen tails  0.2452089786529541
res  length 10
block collection to dataloader spend  1.7881393432617188e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19321918487548828  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.593454360961914  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.592944145202637  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19608736038208008  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.689809322357178  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.69129753112793  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2001633644104004  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.650494575500488  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.652402400970459  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19406652450561523  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.313380718231201  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.31407117843628  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20252561569213867  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.931445121765137  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.933356761932373  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20118188858032227  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.327302932739258  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.328493595123291  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20786190032958984  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.11086130142212  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.113348960876465  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2020573616027832  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.492415904998779  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.493132591247559  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19882535934448242  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.832822799682617  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.833370208740234  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20809507369995117  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.52742338180542  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.529872894287109  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.21375560760498047  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0832784175872803
pure train time :  2.2779312133789062
train time :  4.057393789291382
end to end time :  9.83462643623352
connection check time:  2.7955777645111084
block generation time  1.8149216175079346
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  10
the grouping_fanout_arxiv called successfully
capacity  4900
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085 1530 1283]

remove bucket_id:  [4, 17, 23]
original bucket_id :,  [6, 17, 21]
remove weights:  [2085 1530 1283], 		------------sum 4898

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
res_tmp  [2122 1481 1294]

remove bucket_id:  [2, 17, 19]
original bucket_id :,  [3, 19, 22]
remove weights:  [2122 1481 1294], 		------------sum 4897

before remove weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
after remove pre pack weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
res_tmp  [2091 1511 1293]

remove bucket_id:  [2, 15, 17]
original bucket_id :,  [2, 18, 23]
remove weights:  [2091 1511 1293], 		------------sum 4895

before remove weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
res_tmp  [1875 1584 1429]

remove bucket_id:  [6, 12, 14]
original bucket_id :,  [11, 16, 20]
remove weights:  [1875 1584 1429], 		------------sum 4888

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2056 2003]

remove bucket_id:  [0, 1]
original bucket_id :,  [7, 8]
remove weights:  [2056 2003], 		------------sum 4059

before remove weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1983 1962]

remove bucket_id:  [0, 1]
original bucket_id :,  [9, 1]
remove weights:  [1983 1962], 		------------sum 3945

before remove weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1723, 1682, 1672, 1579]
res_tmp  [1723 1682]

remove bucket_id:  [0, 1]
original bucket_id :,  [13, 14]
remove weights:  [1723 1682], 		------------sum 3405

before remove weights,  [1723, 1682, 1672, 1579]
after remove pre pack weights,  [1672, 1579]
G_BUCKET_ID_list [[6, 17, 21], [3, 19, 22], [2, 18, 23], [11, 16, 20], [4, 5], [7, 8], [9, 1], [10, 12], [13, 14], [0, 15]]
Groups_mem_list  [[2085, 1530, 1283], [2122, 1481, 1294], [2091, 1511, 1293], [1875, 1584, 1429], [2164, 2127], [2056, 2003], [1983, 1962], [1874, 1773], [1723, 1682], [1672, 1579]]
G_BUCKET_ID_list length 10
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  10
current group_mem  4.899838011197959
current group_mem  4.897977435991356
current group_mem  4.896401253001186
current group_mem  4.889030975440014
current group_mem  4.291440736088369
current group_mem  4.059846884275775
current group_mem  3.9464317772397335
current group_mem  3.6482251697690558
current group_mem  3.405843325146656
current group_mem  3.251293312215558
batches output list generation spend  0.0005407333374023438
self.weights_list  [0.07141993160400699, 0.1054749782826228, 0.1273792898692559, 0.05091212984242531, 0.13234954530959633, 0.0813054617829142, 0.16770213655007093, 0.05283645440450402, 0.04034483896152451, 0.17027523339307904]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017203092575073242
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8939447402954102
len local_batched_seeds_list  10
partition total batch output list spend :  1.0864334106445312
self.buckets_partition() spend  sec:  0.9111793041229248
layer  0
 the number of batches:  10
check_connections_block*********************************

the find indices time spent  0.052787065505981445

in edges time spent  0.14504337310791016
local to global src and eids time spent  0.32831525802612305
time gen tails  0.08181595802307129
res  length 10
layer  1
num of batch  10
check_connections_block*********************************

the find indices time spent  0.1314680576324463

in edges time spent  0.8412675857543945
local to global src and eids time spent  1.1895437240600586
time gen tails  0.19887733459472656
res  length 10
block collection to dataloader spend  1.5020370483398438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19321966171264648  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.58795976638794  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.587449073791504  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.1960768699645996  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.685454845428467  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.686943054199219  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2002105712890625  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.648047924041748  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.649896621704102  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.193817138671875  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.300542831420898  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.301233291625977  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20353317260742188  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.944472789764404  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.946331977844238  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20130252838134766  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.352967262268066  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.354121685028076  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20784425735473633  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.12949514389038  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.131833553314209  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2010059356689453  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.467953681945801  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.46867036819458  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19883394241333008  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.841606616973877  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.842154026031494  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2080221176147461  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.524315357208252  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.526894569396973  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2136549949645996  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0680792331695557
pure train time :  2.2699930667877197
train time :  4.029583215713501
end to end time :  10.448208093643188
connection check time:  3.409080743789673
block generation time  1.903519868850708
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  10
the grouping_fanout_arxiv called successfully
capacity  4900
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085 1530 1283]

remove bucket_id:  [4, 17, 23]
original bucket_id :,  [6, 17, 21]
remove weights:  [2085 1530 1283], 		------------sum 4898

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
res_tmp  [2122 1481 1294]

remove bucket_id:  [2, 17, 19]
original bucket_id :,  [3, 19, 22]
remove weights:  [2122 1481 1294], 		------------sum 4897

before remove weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
after remove pre pack weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
res_tmp  [2091 1511 1293]

remove bucket_id:  [2, 15, 17]
original bucket_id :,  [2, 18, 23]
remove weights:  [2091 1511 1293], 		------------sum 4895

before remove weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
res_tmp  [1875 1584 1429]

remove bucket_id:  [6, 12, 14]
original bucket_id :,  [11, 16, 20]
remove weights:  [1875 1584 1429], 		------------sum 4888

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2056 2003]

remove bucket_id:  [0, 1]
original bucket_id :,  [7, 8]
remove weights:  [2056 2003], 		------------sum 4059

before remove weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1983 1962]

remove bucket_id:  [0, 1]
original bucket_id :,  [9, 1]
remove weights:  [1983 1962], 		------------sum 3945

before remove weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1723, 1682, 1672, 1579]
res_tmp  [1723 1682]

remove bucket_id:  [0, 1]
original bucket_id :,  [13, 14]
remove weights:  [1723 1682], 		------------sum 3405

before remove weights,  [1723, 1682, 1672, 1579]
after remove pre pack weights,  [1672, 1579]
G_BUCKET_ID_list [[6, 17, 21], [3, 19, 22], [2, 18, 23], [11, 16, 20], [4, 5], [7, 8], [9, 1], [10, 12], [13, 14], [0, 15]]
Groups_mem_list  [[2085, 1530, 1283], [2122, 1481, 1294], [2091, 1511, 1293], [1875, 1584, 1429], [2164, 2127], [2056, 2003], [1983, 1962], [1874, 1773], [1723, 1682], [1672, 1579]]
G_BUCKET_ID_list length 10
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  10
current group_mem  4.899838011197959
current group_mem  4.897977435991356
current group_mem  4.896401253001186
current group_mem  4.889030975440014
current group_mem  4.291440736088369
current group_mem  4.059846884275775
current group_mem  3.9464317772397335
current group_mem  3.6482251697690558
current group_mem  3.405843325146656
current group_mem  3.251293312215558
batches output list generation spend  0.0005326271057128906
self.weights_list  [0.07141993160400699, 0.1054749782826228, 0.1273792898692559, 0.05091212984242531, 0.13234954530959633, 0.0813054617829142, 0.16770213655007093, 0.05283645440450402, 0.04034483896152451, 0.17027523339307904]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.017497777938842773
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8793258666992188
len local_batched_seeds_list  10
partition total batch output list spend :  1.0177419185638428
self.buckets_partition() spend  sec:  0.8968555927276611
layer  0
 the number of batches:  10
check_connections_block*********************************

the find indices time spent  0.04038047790527344

in edges time spent  0.09698987007141113
local to global src and eids time spent  0.3006095886230469
time gen tails  0.08058643341064453
res  length 10
layer  1
num of batch  10
check_connections_block*********************************

the find indices time spent  0.13257193565368652

in edges time spent  0.8021433353424072
local to global src and eids time spent  1.3575668334960938
time gen tails  0.2351224422454834
res  length 10
block collection to dataloader spend  1.5497207641601562e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19314050674438477  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.604194164276123  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.603683471679688  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.1960768699645996  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.681447505950928  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.68293571472168  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20016813278198242  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.649201393127441  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.651082515716553  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19440221786499023  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.294337272644043  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.295027732849121  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2025308609008789  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.935951232910156  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.93776273727417  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20127201080322266  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.345749378204346  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.346915245056152  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20783424377441406  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.110060214996338  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.112451553344727  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20193243026733398  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.4718804359436035  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.472597122192383  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19884061813354492  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.849513053894043  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.85006046295166  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20789337158203125  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.490482330322266  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.493061542510986  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.21362876892089844  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0669169425964355
pure train time :  2.279935121536255
train time :  4.064836263656616
end to end time :  10.468946695327759
connection check time:  3.4808549880981445
block generation time  1.886397123336792
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  10
the grouping_fanout_arxiv called successfully
capacity  4900
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085 1530 1283]

remove bucket_id:  [4, 17, 23]
original bucket_id :,  [6, 17, 21]
remove weights:  [2085 1530 1283], 		------------sum 4898

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
res_tmp  [2122 1481 1294]

remove bucket_id:  [2, 17, 19]
original bucket_id :,  [3, 19, 22]
remove weights:  [2122 1481 1294], 		------------sum 4897

before remove weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
after remove pre pack weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
res_tmp  [2091 1511 1293]

remove bucket_id:  [2, 15, 17]
original bucket_id :,  [2, 18, 23]
remove weights:  [2091 1511 1293], 		------------sum 4895

before remove weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
res_tmp  [1875 1584 1429]

remove bucket_id:  [6, 12, 14]
original bucket_id :,  [11, 16, 20]
remove weights:  [1875 1584 1429], 		------------sum 4888

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2056 2003]

remove bucket_id:  [0, 1]
original bucket_id :,  [7, 8]
remove weights:  [2056 2003], 		------------sum 4059

before remove weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1983 1962]

remove bucket_id:  [0, 1]
original bucket_id :,  [9, 1]
remove weights:  [1983 1962], 		------------sum 3945

before remove weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1723, 1682, 1672, 1579]
res_tmp  [1723 1682]

remove bucket_id:  [0, 1]
original bucket_id :,  [13, 14]
remove weights:  [1723 1682], 		------------sum 3405

before remove weights,  [1723, 1682, 1672, 1579]
after remove pre pack weights,  [1672, 1579]
G_BUCKET_ID_list [[6, 17, 21], [3, 19, 22], [2, 18, 23], [11, 16, 20], [4, 5], [7, 8], [9, 1], [10, 12], [13, 14], [0, 15]]
Groups_mem_list  [[2085, 1530, 1283], [2122, 1481, 1294], [2091, 1511, 1293], [1875, 1584, 1429], [2164, 2127], [2056, 2003], [1983, 1962], [1874, 1773], [1723, 1682], [1672, 1579]]
G_BUCKET_ID_list length 10
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  10
current group_mem  4.899838011197959
current group_mem  4.897977435991356
current group_mem  4.896401253001186
current group_mem  4.889030975440014
current group_mem  4.291440736088369
current group_mem  4.059846884275775
current group_mem  3.9464317772397335
current group_mem  3.6482251697690558
current group_mem  3.405843325146656
current group_mem  3.251293312215558
batches output list generation spend  0.0005249977111816406
self.weights_list  [0.07141993160400699, 0.1054749782826228, 0.1273792898692559, 0.05091212984242531, 0.13234954530959633, 0.0813054617829142, 0.16770213655007093, 0.05283645440450402, 0.04034483896152451, 0.17027523339307904]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016890287399291992
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.9104483127593994
len local_batched_seeds_list  10
partition total batch output list spend :  1.2546234130859375
self.buckets_partition() spend  sec:  0.9273698329925537
layer  0
 the number of batches:  10
check_connections_block*********************************

the find indices time spent  0.05768465995788574

in edges time spent  0.1589488983154297
local to global src and eids time spent  0.34060049057006836
time gen tails  0.08053827285766602
res  length 10
layer  1
num of batch  10
check_connections_block*********************************

the find indices time spent  0.1271967887878418

in edges time spent  0.8511660099029541
local to global src and eids time spent  1.3575975894927979
time gen tails  0.23666882514953613
res  length 10
block collection to dataloader spend  1.5020370483398438e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19333934783935547  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.594970703125  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.59446096420288  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19607925415039062  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.688963890075684  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.690452098846436  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20020627975463867  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.650343894958496  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.652254104614258  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19401168823242188  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.30358600616455  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.304276466369629  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20353460311889648  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.957537174224854  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.959558486938477  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2012934684753418  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.34220838546753  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.343368530273438  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20782804489135742  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.104691505432129  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.10699987411499  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2010641098022461  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.487203598022461  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.48792028427124  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19882965087890625  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.840975284576416  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.841522693634033  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20797443389892578  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.499495983123779  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.5018463134765625  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.21364736557006836  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0300943851470947
pure train time :  2.2829532623291016
train time :  4.045963525772095
end to end time :  10.867372274398804
connection check time:  3.6495327949523926
block generation time  1.8949580192565918
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  10
the grouping_fanout_arxiv called successfully
capacity  4900
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085 1530 1283]

remove bucket_id:  [4, 17, 23]
original bucket_id :,  [6, 17, 21]
remove weights:  [2085 1530 1283], 		------------sum 4898

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
res_tmp  [2122 1481 1294]

remove bucket_id:  [2, 17, 19]
original bucket_id :,  [3, 19, 22]
remove weights:  [2122 1481 1294], 		------------sum 4897

before remove weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
after remove pre pack weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
res_tmp  [2091 1511 1293]

remove bucket_id:  [2, 15, 17]
original bucket_id :,  [2, 18, 23]
remove weights:  [2091 1511 1293], 		------------sum 4895

before remove weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
res_tmp  [1875 1584 1429]

remove bucket_id:  [6, 12, 14]
original bucket_id :,  [11, 16, 20]
remove weights:  [1875 1584 1429], 		------------sum 4888

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2056 2003]

remove bucket_id:  [0, 1]
original bucket_id :,  [7, 8]
remove weights:  [2056 2003], 		------------sum 4059

before remove weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1983 1962]

remove bucket_id:  [0, 1]
original bucket_id :,  [9, 1]
remove weights:  [1983 1962], 		------------sum 3945

before remove weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1723, 1682, 1672, 1579]
res_tmp  [1723 1682]

remove bucket_id:  [0, 1]
original bucket_id :,  [13, 14]
remove weights:  [1723 1682], 		------------sum 3405

before remove weights,  [1723, 1682, 1672, 1579]
after remove pre pack weights,  [1672, 1579]
G_BUCKET_ID_list [[6, 17, 21], [3, 19, 22], [2, 18, 23], [11, 16, 20], [4, 5], [7, 8], [9, 1], [10, 12], [13, 14], [0, 15]]
Groups_mem_list  [[2085, 1530, 1283], [2122, 1481, 1294], [2091, 1511, 1293], [1875, 1584, 1429], [2164, 2127], [2056, 2003], [1983, 1962], [1874, 1773], [1723, 1682], [1672, 1579]]
G_BUCKET_ID_list length 10
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  10
current group_mem  4.899838011197959
current group_mem  4.897977435991356
current group_mem  4.896401253001186
current group_mem  4.889030975440014
current group_mem  4.291440736088369
current group_mem  4.059846884275775
current group_mem  3.9464317772397335
current group_mem  3.6482251697690558
current group_mem  3.405843325146656
current group_mem  3.251293312215558
batches output list generation spend  0.0005083084106445312
self.weights_list  [0.07141993160400699, 0.1054749782826228, 0.1273792898692559, 0.05091212984242531, 0.13234954530959633, 0.0813054617829142, 0.16770213655007093, 0.05283645440450402, 0.04034483896152451, 0.17027523339307904]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01552438735961914
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.862708330154419
len local_batched_seeds_list  10
partition total batch output list spend :  1.2109432220458984
self.buckets_partition() spend  sec:  0.878262996673584
layer  0
 the number of batches:  10
check_connections_block*********************************

the find indices time spent  0.05756402015686035

in edges time spent  0.1584796905517578
local to global src and eids time spent  0.34700798988342285
time gen tails  0.08273911476135254
res  length 10
layer  1
num of batch  10
check_connections_block*********************************

the find indices time spent  0.13335847854614258

in edges time spent  0.8505885601043701
local to global src and eids time spent  1.3890652656555176
time gen tails  0.23907065391540527
res  length 10
block collection to dataloader spend  2.0503997802734375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19296932220458984  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.590548992156982  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.590038776397705  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19607925415039062  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.683717250823975  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.685205459594727  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20018625259399414  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.655691623687744  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.657463073730469  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19399309158325195  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.308000087738037  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.308690547943115  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20242595672607422  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.91204309463501  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.913880825042725  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20116806030273438  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.332608699798584  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.333799362182617  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20784854888916016  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.120831489562988  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.123178958892822  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.201080322265625  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.49334192276001  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.494058609008789  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19883346557617188  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.834578990936279  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.8351263999938965  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.2081470489501953  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.543325901031494  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 6.545851707458496  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.21385860443115234  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.9601078033447266
pure train time :  2.2917118072509766
train time :  4.055739164352417
end to end time :  10.896032094955444
connection check time:  3.7119386196136475
block generation time  1.8969995975494385
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  10
the grouping_fanout_arxiv called successfully
capacity  4900
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085 1530 1283]

remove bucket_id:  [4, 17, 23]
original bucket_id :,  [6, 17, 21]
remove weights:  [2085 1530 1283], 		------------sum 4898

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
res_tmp  [2122 1481 1294]

remove bucket_id:  [2, 17, 19]
original bucket_id :,  [3, 19, 22]
remove weights:  [2122 1481 1294], 		------------sum 4897

before remove weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
after remove pre pack weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
res_tmp  [2091 1511 1293]

remove bucket_id:  [2, 15, 17]
original bucket_id :,  [2, 18, 23]
remove weights:  [2091 1511 1293], 		------------sum 4895

before remove weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
res_tmp  [1875 1584 1429]

remove bucket_id:  [6, 12, 14]
original bucket_id :,  [11, 16, 20]
remove weights:  [1875 1584 1429], 		------------sum 4888

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2056 2003]

remove bucket_id:  [0, 1]
original bucket_id :,  [7, 8]
remove weights:  [2056 2003], 		------------sum 4059

before remove weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1983 1962]

remove bucket_id:  [0, 1]
original bucket_id :,  [9, 1]
remove weights:  [1983 1962], 		------------sum 3945

before remove weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1723, 1682, 1672, 1579]
res_tmp  [1723 1682]

remove bucket_id:  [0, 1]
original bucket_id :,  [13, 14]
remove weights:  [1723 1682], 		------------sum 3405

before remove weights,  [1723, 1682, 1672, 1579]
after remove pre pack weights,  [1672, 1579]
G_BUCKET_ID_list [[6, 17, 21], [3, 19, 22], [2, 18, 23], [11, 16, 20], [4, 5], [7, 8], [9, 1], [10, 12], [13, 14], [0, 15]]
Groups_mem_list  [[2085, 1530, 1283], [2122, 1481, 1294], [2091, 1511, 1293], [1875, 1584, 1429], [2164, 2127], [2056, 2003], [1983, 1962], [1874, 1773], [1723, 1682], [1672, 1579]]
G_BUCKET_ID_list length 10
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  10
current group_mem  4.899838011197959
current group_mem  4.897977435991356
current group_mem  4.896401253001186
current group_mem  4.889030975440014
current group_mem  4.291440736088369
current group_mem  4.059846884275775
current group_mem  3.9464317772397335
current group_mem  3.6482251697690558
current group_mem  3.405843325146656
current group_mem  3.251293312215558
batches output list generation spend  0.0005283355712890625
self.weights_list  [0.07141993160400699, 0.1054749782826228, 0.1273792898692559, 0.05091212984242531, 0.13234954530959633, 0.0813054617829142, 0.16770213655007093, 0.05283645440450402, 0.04034483896152451, 0.17027523339307904]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014917135238647461
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.924302339553833
len local_batched_seeds_list  10
partition total batch output list spend :  1.2642302513122559
self.buckets_partition() spend  sec:  0.9392526149749756
layer  0
 the number of batches:  10
check_connections_block*********************************

the find indices time spent  0.05536174774169922

in edges time spent  0.1574077606201172
local to global src and eids time spent  0.32714152336120605
time gen tails  0.08061003684997559
res  length 10
layer  1
num of batch  10
check_connections_block*********************************

the find indices time spent  0.13043522834777832

in edges time spent  0.8228545188903809
local to global src and eids time spent  1.3611648082733154
time gen tails  0.23391032218933105
res  length 10
block collection to dataloader spend  1.4781951904296875e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19338035583496094  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.594183921813965  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.593672275543213  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19608163833618164  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.687430381774902  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.688916206359863  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20016002655029297  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.651134967803955  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.653000354766846  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.19400262832641602  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.28848123550415  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.289171695709229  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20250272750854492  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.931105136871338  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.933009147644043  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20129680633544922  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.334372520446777  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.335555076599121  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20781517028808594  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.131171226501465  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 8.13365888595581  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.20189905166625977  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.475509166717529  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 7.476225852966309  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.6484375 GB
    Memory Allocated: 0.1988372802734375  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 6.8403496742248535  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 6.840897083282471  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.20801210403442383  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 6.515335559844971  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 6.517693519592285  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.21366024017333984  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8694069385528564
pure train time :  2.281895875930786
train time :  4.031536817550659
end to end time :  10.831806182861328
connection check time:  3.60713529586792
block generation time  1.9067747592926025
generate_dataloader_bucket_block=======
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  10
the grouping_fanout_arxiv called successfully
capacity  4900
 
sorted_dict  {4: 2164, 5: 2127, 3: 2122, 2: 2091, 6: 2085, 7: 2056, 8: 2003, 9: 1983, 1: 1962, 11: 1875, 10: 1874, 12: 1773, 13: 1723, 14: 1682, 0: 1672, 16: 1584, 15: 1579, 17: 1530, 18: 1511, 19: 1481, 20: 1429, 22: 1294, 23: 1293, 21: 1283}

weights after sort [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
res_tmp  [2085 1530 1283]

remove bucket_id:  [4, 17, 23]
original bucket_id :,  [6, 17, 21]
remove weights:  [2085 1530 1283], 		------------sum 4898

before remove weights,  [2164, 2127, 2122, 2091, 2085, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1530, 1511, 1481, 1429, 1294, 1293, 1283]
after remove pre pack weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
res_tmp  [2122 1481 1294]

remove bucket_id:  [2, 17, 19]
original bucket_id :,  [3, 19, 22]
remove weights:  [2122 1481 1294], 		------------sum 4897

before remove weights,  [2164, 2127, 2122, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1481, 1429, 1294, 1293]
after remove pre pack weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
res_tmp  [2091 1511 1293]

remove bucket_id:  [2, 15, 17]
original bucket_id :,  [2, 18, 23]
remove weights:  [2091 1511 1293], 		------------sum 4895

before remove weights,  [2164, 2127, 2091, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1511, 1429, 1293]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
res_tmp  [1875 1584 1429]

remove bucket_id:  [6, 12, 14]
original bucket_id :,  [11, 16, 20]
remove weights:  [1875 1584 1429], 		------------sum 4888

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1875, 1874, 1773, 1723, 1682, 1672, 1584, 1579, 1429]
after remove pre pack weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2164 2127]

remove bucket_id:  [0, 1]
original bucket_id :,  [4, 5]
remove weights:  [2164 2127], 		------------sum 4291

before remove weights,  [2164, 2127, 2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [2056 2003]

remove bucket_id:  [0, 1]
original bucket_id :,  [7, 8]
remove weights:  [2056 2003], 		------------sum 4059

before remove weights,  [2056, 2003, 1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1983 1962]

remove bucket_id:  [0, 1]
original bucket_id :,  [9, 1]
remove weights:  [1983 1962], 		------------sum 3945

before remove weights,  [1983, 1962, 1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1874, 1773, 1723, 1682, 1672, 1579]
res_tmp  [1874 1773]

remove bucket_id:  [0, 1]
original bucket_id :,  [10, 12]
remove weights:  [1874 1773], 		------------sum 3647

before remove weights,  [1874, 1773, 1723, 1682, 1672, 1579]
after remove pre pack weights,  [1723, 1682, 1672, 1579]
res_tmp  [1723 1682]

remove bucket_id:  [0, 1]
original bucket_id :,  [13, 14]
remove weights:  [1723 1682], 		------------sum 3405

before remove weights,  [1723, 1682, 1672, 1579]
after remove pre pack weights,  [1672, 1579]
G_BUCKET_ID_list [[6, 17, 21], [3, 19, 22], [2, 18, 23], [11, 16, 20], [4, 5], [7, 8], [9, 1], [10, 12], [13, 14], [0, 15]]
Groups_mem_list  [[2085, 1530, 1283], [2122, 1481, 1294], [2091, 1511, 1293], [1875, 1584, 1429], [2164, 2127], [2056, 2003], [1983, 1962], [1874, 1773], [1723, 1682], [1672, 1579]]
G_BUCKET_ID_list length 10
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  10
current group_mem  4.899838011197959
current group_mem  4.897977435991356
current group_mem  4.896401253001186
current group_mem  4.889030975440014
current group_mem  4.291440736088369
current group_mem  4.059846884275775
current group_mem  3.9464317772397335
current group_mem  3.6482251697690558
current group_mem  3.405843325146656
current group_mem  3.251293312215558
batches output list generation spend  0.0005257129669189453
self.weights_list  [0.07141993160400699, 0.1054749782826228, 0.1273792898692559, 0.05091212984242531, 0.13234954530959633, 0.0813054617829142, 0.16770213655007093, 0.05283645440450402, 0.04034483896152451, 0.17027523339307904]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01454019546508789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.8602821826934814
len local_batched_seeds_list  10
partition total batch output list spend :  1.2007465362548828
self.buckets_partition() spend  sec:  0.8748526573181152
layer  0
 the number of batches:  10
check_connections_block*********************************

the find indices time spent  0.05713796615600586

in edges time spent  0.1551821231842041
local to global src and eids time spent  0.3286468982696533
time gen tails  0.0820767879486084
res  length 10
layer  1
num of batch  10
check_connections_block*********************************

the find indices time spent  0.12811756134033203

in edges time spent  0.8456718921661377
local to global src and eids time spent  1.4369373321533203
time gen tails  0.24549484252929688
res  length 10
block collection to dataloader spend  2.09808349609375e-05
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.19323396682739258  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.595467567443848  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.594956874847412  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.19608020782470703  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.691262245178223  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.692750453948975  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.2001791000366211  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.653074264526367  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.654853343963623  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.1939530372619629  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.302562713623047  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.303253173828125  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.20351696014404297  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.922779560089111  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.924653053283691  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.20132970809936523  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.344651222229004  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.34578275680542  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.20779037475585938  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.099045276641846  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 8.101472854614258  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.2019033432006836  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 7.4823384284973145  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 7.483055114746094  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.19883298873901367  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 6.841826438903809  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 6.842373847961426  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.20799589157104492  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 6.521183967590332  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 6.5235724449157715  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 14.650390625 GB
    Memory Allocated: 0.21368980407714844  GigaBytes
Max Memory Allocated: 9.369259357452393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.768463134765625
pure train time :  2.2841694355010986
train time :  4.04623818397522
end to end time :  10.9609375
connection check time:  3.7936789989471436
block generation time  1.9015159606933594
end to end time  11.1002037525177
Total (block generation + training)time/epoch 11.1002037525177
pure train time per /epoch  [2.661464214324951, 2.2780325412750244, 2.2697010040283203, 2.2779312133789062, 2.2699930667877197, 2.279935121536255, 2.2829532623291016, 2.2917118072509766, 2.281895875930786, 2.2841694355010986]
pure train time average  2.2812271118164062
input num list  [1127071, 1127815, 1126602, 1127584, 1127603, 1126240, 1126925, 1127201, 1127962, 1127205]
